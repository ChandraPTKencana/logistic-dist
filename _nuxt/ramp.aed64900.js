import P from"./Header.472e87f6.js";import{_ as S}from"./client-only.9fe42a96.js";import I from"./PrinterEye.005b0201.js";import N from"./Table2Column.a05f0375.js";import{_ as U}from"./PDFView.vue.535e43ad.js";import{r as u,g as G,h as L,I as R,c as p,a as t,b as r,w as V,t as v,l as s,k as Z,A as q,m as H,F as A,D as Q,C as T,q as X,o as w,x as d,y as x,G as J}from"./entry.e12e06c3.js";import{u as g}from"./useMyFetch.0add3b72.js";import{u as K}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.8af2c57c.js";const W={class:"w-full h-full flex flex-col"},ee={class:"w-full flex grow flex-col overflow-auto h-0 bg-gray-200 justify-center items-center p-2"},te={class:"bg-white p-2"},oe={action:"#",class:"w-full flex flex-col sm:flex-row flex-wrap text-xs"},se={class:"w-full p-1 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col"},le=t("div",{class:"font-bold"}," Tgl Dari ",-1),ae={class:"text-red-500"},ne={class:"w-full p-1 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col"},re=t("div",{class:"font-bold"}," Tgl Sampai ",-1),ie={class:"text-red-500"},ce={class:"w-full p-1 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col"},ue=t("div",{class:"font-bold"}," Lokasi ",-1),de={id:"locations"},me=["value"],fe={class:"w-full p-1 sm:w-12/12 md:w-12/12 lg:w-3/12 flex items-end justify-end"},_e=t("div",{class:"text-left m-1"},"Download PDF",-1),pe=t("div",{class:"text-left m-1"},"Download Excel",-1),Ae={__name:"ramp",async setup(ve){let m,y;const{$moment:h}=J(),l={};l._TimeZoneOffset=new Date().getTimezoneOffset(),l.sort="tanggal:desc";const D=u({}),_=G("token"),a=u({from:"",to:""}),{data:$}=([m,y]=L(async()=>X(async()=>{d().loading_full=!0;let n=[];const[e,c]=await Promise.all([g("/report/ramp/get_locations",{method:"get",headers:{Authorization:`Bearer ${_.value}`,Accept:"application/json"},retry:0})]);return e.status.value!=="error"&&(n=e.data.value.list_xto),e.status.value==="error"?(x().trigger(e.error),{locations:n}):(d().loading_full=!1,{locations:n})},"$SQhImG8ywX")),m=await m,y(),m),j=u($.value.locations||[]),f=u(""),b=()=>{l._TimeZoneOffset=new Date().getTimezoneOffset(),l.date_from=a.value.from?h(a.value.from).format("YYYY-MM-DD"):"",l.date_to=a.value.to?h(a.value.to).format("YYYY-MM-DD"):"",l.location=f.value},{downloadFile:Y,viewFile:we}=K(),i=u(!1),C=u({}),F=async()=>{if(i.value==!0){i.value=!1;return}b(),d().loading_full=!0;const{data:n,error:e,status:c}=await g("/report/ramp/pdf_preview",{method:"get",headers:{Authorization:`Bearer ${_.value}`,Accept:"application/json"},params:l,retry:0});if(d().loading_full=!1,c.value==="error"){x().trigger(e);return}C.value=n.value,i.value=!0},B=async()=>{b(),d().loading_full=!0;const{data:n,error:e,status:c}=await g("/report/ramp/excel_download",{method:"get",headers:{Authorization:`Bearer ${_.value}`,Accept:"application/json"},params:l,retry:0});if(d().loading_full=!1,c.value==="error"){x().trigger(e);return}Y(n.value)};return(n,e)=>{const c=P,k=R("vue-date-picker"),M=S,z=I,E=N,O=U;return w(),p(A,null,[t("div",W,[r(c,{title:"Report Transaction"}),t("div",ee,[t("div",te,[t("form",oe,[t("div",se,[le,r(M,null,{default:V(()=>[r(k,{modelValue:s(a).from,"onUpdate:modelValue":e[0]||(e[0]=o=>s(a).from=o),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"",class:"flex-grow"},null,8,["modelValue"])]),_:1}),t("p",ae,v(s(D).date_from),1)]),t("div",ne,[re,r(M,null,{default:V(()=>[r(k,{modelValue:s(a).to,"onUpdate:modelValue":e[1]||(e[1]=o=>s(a).to=o),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"",class:"flex-grow"},null,8,["modelValue"])]),_:1}),t("p",ie,v(s(D).date_to),1)]),t("div",ce,[ue,Z(t("input",{type:"text",list:"locations","onUpdate:modelValue":e[2]||(e[2]=o=>H(f)?f.value=o:null)},null,512),[[q,s(f)]]),t("datalist",de,[(w(!0),p(A,null,Q(s(j),o=>(w(),p("option",{value:o},v(o),9,me))),256))])]),t("div",fe,[t("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:e[3]||(e[3]=T(o=>F(),["prevent"]))},[t("div",null,[r(z,{class:"text-2xl"})]),_e]),t("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:e[4]||(e[4]=T(o=>B(),["prevent"]))},[t("div",null,[r(E,{class:"text-2xl"})]),pe])])])])])]),r(O,{show:s(i),pdfContent:s(C),onClose:e[5]||(e[5]=o=>i.value=!s(i))},null,8,["show","pdfContent"])],64)}}};export{Ae as default};
