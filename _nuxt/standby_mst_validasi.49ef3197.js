import{_ as $}from"./HeaderPopup.vue.3737b028.js";import{r as w,g as q,i as D,f as I,k as z,J as H,o as d,c as r,a as e,b as E,t as a,l as t,d as S,F as Y,D as P,E as v,n as m,C as R,G as U,x,y as j,p as G,e as J}from"./entry.2c6f7c1f.js";import{u as L}from"./useUtils.8be4dd3c.js";import{u as F}from"./useMyFetch.d8156c5d.js";import{_ as O}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.24a44e7a.js";const o=n=>(G("data-v-1a084bee"),n=n(),J(),n),K={class:"box-fixed"},Q={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},W={class:"w-full flex flex-col items-center grow overflow-auto"},X={class:"w-full flex flex-row flex-wrap"},Z={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ee=o(()=>e("label",{for:""},"Name",-1)),te={class:"card-border"},se={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ae=o(()=>e("label",{for:""},"Tipe",-1)),le={class:"card-border"},oe={class:"w-full sm:w-4/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},ie=o(()=>e("label",{for:""},"Amount",-1)),ce={class:"card-border"},ne={class:"w-1/2 sm:w-4/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},de=o(()=>e("label",{for:""},"Peralihan?",-1)),re={class:"card-border !flex flex-row items-center"},_e=["checked"],ue={class:"w-full ml-1"},fe={class:"text-red-500"},me={class:"w-1/2 sm:w-4/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},pe=o(()=>e("label",{for:""},"Trip?",-1)),ve={class:"card-border !flex flex-row items-center"},he=["checked"],we={class:"w-full ml-1"},xe={class:"text-red-500"},be={class:"w-full flex grow p-1 2xl:overflow-hidden justify-between flex-wrap"},ye={class:"w-full",role:"sticky"},ge={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},ke=o(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"7",class:"!bg-slate-800 text-white font-bold"}," Detail PVR ")],-1)),Ae={class:"sticky top-8 !z-[2]"},Ce=o(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),De=o(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),Se=o(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),Ye=o(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),je=o(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),Fe={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Ne=o(()=>e("br",null,null,-1)),Ve={class:"text-sm"},Be=o(()=>e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"For",-1)),Me={ref:"to_move"},Te=["data-index"],$e={class:"w-full h-auto flex items-center justify-center"},qe={class:"w-full h-auto flex items-center justify-center"},Ie={class:"w-full h-auto flex items-center justify-center"},ze={key:0,class:"cell"},He={class:"w-full h-auto flex items-center justify-center"},Ee={class:"w-full h-auto flex items-center justify-center"},Pe={class:"w-full flex items-center justify-end"},Re={class:"w-full flex flex-wrap p-3 items-center"},Ue=o(()=>e("div",null," Di Validasi oleh : ",-1)),Ge={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},Je={key:0},Le={key:1},Oe={__name:"standby_mst_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(n){const _=n,{$moment:g}=U(),{pointFormat:b}=L(),s=w({...{id:-1,name:"",tipe:"",is_transition:!1,amount:0,details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:""}}),k=q("token"),h=w({}),A=w(null),y=w([]),N=async()=>{x().loading_full=!0,h.value={};const i=new FormData;let c="post",f=_.id;f==0||(i.append("id",f),i.append("_method","PUT"));const{data:l,error:p,status:M}=await F("/standby_mst_validasi",{method:c,headers:{Authorization:`Bearer ${k.value}`,Accept:"application/json"},body:i,retry:0});if(x().loading_full=!1,M.value==="error"){j().trigger(p,h);return}s.value.val=l.value.val,s.value.val_user=l.value.val_user,s.value.val_by=l.value.val_by,s.value.val_at=l.value.val_at,s.value.val1=l.value.val1,s.value.val1_user=l.value.val1_user,s.value.val1_by=l.value.val1_by,s.value.val1_at=l.value.val1_at;let C=_.p_data.map(T=>T.id).indexOf(_.id);C>=-1&&_.p_data.splice(C,1,{...s.value}),_.fnClose()},V=async()=>{x().loading_full=!0;const{data:i,error:c,status:f}=await F("/standby_mst",{method:"get",headers:{Authorization:`Bearer ${k.value}`,Accept:"application/json"},params:{id:_.id},retry:0});if(x().loading_full=!1,f.value==="error"){j().trigger(c);return}s.value=i.value.data,y.value=i.value.data.details},B=D(()=>{let i=0;return y.value.forEach(c=>{c.p_status!="Remove"&&(i+=parseInt(c.amount))}),i}),u=D(()=>!1);return I(()=>_.show,(i,c)=>{i==!0&&(_.is_view==!1&&setTimeout(()=>{A.value.focus()},1),V())},{immediate:!0}),(i,c)=>{const f=$;return z((d(),r("section",K,[e("div",null,[E(f,{title:"Form Master Standby Validation",fn:n.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",Q,[e("div",W,[e("div",X,[e("div",Z,[ee,e("div",te,a(t(s).name),1)]),e("div",se,[ae,e("div",le,a(t(s).tipe),1)]),e("div",oe,[ie,e("div",ce,a(t(b)(t(s).amount||0)),1)]),e("div",ne,[de,e("div",re,[e("input",{checked:t(s).is_transition,disabled:"disabled",type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded"},null,8,_e),e("label",ue,a(t(s).is_transition?"Ya":"Tidak"),1)]),e("p",fe,a(t(h).is_transition),1)]),e("div",me,[pe,e("div",ve,[e("input",{checked:t(s).is_trip,disabled:"disabled",type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded"},null,8,he),e("label",we,a(t(s).is_trip?"Ya":"Tidak"),1)]),e("p",xe,a(t(h).is_trip),1)])]),e("div",be,[e("div",ye,[e("table",ge,[e("thead",null,[ke,e("tr",Ae,[Ce,De,Se,Ye,je,e("th",Fe,[S("Amount "),Ne,S(),e("span",Ve,"("+a(t(b)(t(B)))+")",1)]),Be])]),e("tbody",Me,[(d(!0),r(Y,null,P(t(y),(l,p)=>(d(),r(Y,{key:p},[l.p_status!="Remove"?(d(),r("tr",{key:0,"data-index":p},[e("td",null,a(p+1)+".",1),e("td",{class:v(["cell bold",t(u)?"unselectable":""])},[e("div",$e,a(l.ac_account_id),1)],2),e("td",{class:v(["cell bold",t(u)?"unselectable":""])},[e("div",qe,a(l.ac_account_code),1)],2),e("td",{class:v(["cell bold",t(u)?"unselectable":""])},[e("div",Ie,a(l.ac_account_name),1)],2),t(u)?m("",!0):(d(),r("td",ze,[e("div",He,a(l.description),1)])),e("td",{class:v(["cell bold",t(u)?"unselectable":""])},[e("div",Ee,a(t(b)(l.amount||0)),1)],2),e("td",{class:v(["cell",t(u)?"unselectable":""])},a(l.xfor),3)],8,Te)):m("",!0)],64))),128))],512)])])])]),e("div",Pe,[e("div",Re,[Ue,t(s).val||t(s).val1?(d(),r("div",Ge,[t(s).val?(d(),r("div",Je," App 1 : "+a(t(s).val_by.username)+" ( "+a(t(s).val_at?t(g)(t(s).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0),t(s).val1?(d(),r("div",Le," App 2 : "+a(t(s).val1_by.username)+" ( "+a(t(s).val1_at?t(g)(t(s).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0)])):m("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:c[0]||(c[0]=l=>n.fnClose())}," Cancel "),n.is_view==0?(d(),r("button",{key:0,ref_key:"it_val",ref:A,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:c[1]||(c[1]=R(l=>N(),["prevent"]))}," Validasi ",512)):m("",!0)])])])],512)),[[H,n.show]])}}},st=O(Oe,[["__scopeId","data-v-1a084bee"]]);export{st as default};
