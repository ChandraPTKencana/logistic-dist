import{_ as R}from"./HeaderPopup.vue.f75d51fc.js";import{r as w,g as $,i as p,f as P,k as V,L as M,o as d,c as f,a as t,b as Y,t as l,l as i,d as r,F as z,E as H,D as N,n as v,H as L,x,y as E,p as K,e as U}from"./entry.d41fcb1c.js";import{u as J}from"./useUtils.281ed599.js";import{u as q}from"./useMyFetch.a91bf453.js";import{_ as G}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.920dae2e.js";const o=c=>(K("data-v-d2193c45"),c=c(),U(),c),O={class:"box-fixed"},Q={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},W={class:"w-full flex flex-col items-center grow overflow-auto"},X={class:"w-full flex p-2"},Z={class:"w-full flex p-1 2xl:overflow-hidden justify-between flex-wrap"},tt={class:"w-full",role:"sticky"},et={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},st=o(()=>t("tr",{class:"sticky top-0 !z-[2]"},[t("td",{colspan:18,class:"!bg-slate-800 text-white font-bold"}," List Transaksi ")],-1)),lt={class:"sticky top-7 !z-[2]"},at=o(()=>t("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),ot=o(()=>t("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"ID",-1)),nt=o(()=>t("th",null,"No Trx",-1)),it=o(()=>t("th",null,"Tujuan",-1)),ct=o(()=>t("th",null,"Produk",-1)),_t=o(()=>t("th",{class:"min-w-[75px] !w-[75px] max-w-[75px]"},"No Pol",-1)),rt=o(()=>t("th",null,"Jabatan",-1)),ut=o(()=>t("th",null,"Nama",-1)),dt=o(()=>t("br",null,null,-1)),ft=o(()=>t("br",null,null,-1)),ht=o(()=>t("br",null,null,-1)),pt=o(()=>t("th",null,null,-1)),mt=o(()=>t("th",null,"No Rek",-1)),vt=o(()=>t("th",null,"Nama Di Bank",-1)),xt=o(()=>t("br",null,null,-1)),wt=o(()=>t("th",null,"Status ",-1)),yt=o(()=>t("th",null,"Aksi ",-1)),bt=o(()=>t("th",null,"Alasan Gagal ",-1)),jt={ref:"to_move"},gt={class:"cell min-w-[50px] !w-[50px] max-w-[50px]"},kt={class:"w-full h-full flex items-center justify-center"},Nt={class:"cell min-w-[50px] !w-[50px] max-w-[50px]"},Et={class:"w-full h-full flex items-center justify-center"},qt={class:"cell"},Dt={class:"w-full h-full flex items-center justify-center p-2"},It={class:"pointer p-0 bg-red-500 text-white rounded flex items-center justify-center"},Ct={class:"px-2"},At={class:"cell min-w-[150px] !w-[150px] max-w-[150px]"},St={class:"w-full h-full flex items-center justify-center"},Bt={class:"cell"},Ft={class:"w-full h-full flex items-center justify-center"},Tt={class:"cell"},Rt={class:"w-full h-full flex items-center justify-center"},$t={class:"cell"},Pt={class:"w-full h-full flex items-center justify-center"},Vt={class:"cell"},Mt={class:"w-full h-full flex items-center justify-center"},Yt={class:"cell"},zt={class:"w-full h-full flex items-center justify-end p-2"},Ht={class:"cell"},Lt={class:"w-full h-full flex items-center justify-end p-2"},Kt={class:"cell"},Ut={class:"w-full h-full flex items-center justify-end p-2"},Jt=o(()=>t("td",null,[t("div",{class:"w-full h-full flex items-center justify-end p-2"})],-1)),Gt={class:"cell"},Ot={class:"w-full h-full flex items-center justify-center"},Qt={class:"cell"},Wt={class:"w-full h-full flex items-center justify-center"},Xt={class:"cell"},Zt={class:"w-full h-full flex items-center justify-end p-1"},te={class:"cell"},ee={class:"w-full h-full flex items-center justify-end p-1"},se={class:"cell"},le={class:"w-full h-full flex items-center justify-end p-1"},ae=["onClick"],oe={class:"cell"},ne={class:"w-full h-full flex items-center justify-end p-1"},ie={class:"w-full flex items-center justify-end"},ce={class:"w-full flex flex-wrap p-3 items-center"},_e=o(()=>t("div",null," Di Validasi oleh : ",-1)),re={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},ue={key:0},de={__name:"fin_payment_req_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(c){const u=c,{$moment:D}=L(),{pointFormat:_}=J(),a=w({...{details:[],val:0,val_by:{username:""},val_at:""}}),y=$("token"),b=w({}),j=w([]),I=async()=>{x().loading_full=!0,b.value={};const s=new FormData;let n="post",h=u.id;h==0||(s.append("id",h),s.append("_method","PUT"));const{data:e,error:m,status:g}=await q("/fin_payment_req_validasi",{method:n,headers:{Authorization:`Bearer ${y.value}`,Accept:"application/json"},body:s,retry:0});if(x().loading_full=!1,g.value==="error"){E().trigger(m,b);return}a.value.val=e.value.val,a.value.val_user=e.value.val_user,a.value.val_by=e.value.val_by,a.value.val_at=e.value.val_at,a.value.val1=e.value.val1,a.value.val1_user=e.value.val1_user,a.value.val1_by=e.value.val1_by,a.value.val1_at=e.value.val1_at;let k=u.p_data.map(T=>T.id).indexOf(u.id);k>-1&&u.p_data.splice(k,1,{...a.value}),u.fnClose()},C=async()=>{x().loading_full=!0;const{data:s,error:n,status:h}=await q("/fin_payment_req",{method:"get",headers:{Authorization:`Bearer ${y.value}`,Accept:"application/json"},params:{id:u.id},retry:0});if(x().loading_full=!1,h.value==="error"){E().trigger(n);return}a.value=s.value.data,j.value=s.value.data.details};p(()=>{let s=0;return j.value.forEach(n=>{n.p_status!="Remove"&&(s+=parseInt(n.amount))}),s}),p(()=>!1),P(()=>u.show,(s,n)=>{s==!0&&C()},{immediate:!0});const A=p(()=>{let s=0;return a.value.details.forEach(n=>{s+=parseInt(n.nominal)}),s}),S=p(()=>{let s=0;return a.value.details.forEach(n=>{s+=parseInt(n.potongan_trx_ttl)}),s}),B=p(()=>{let s=0;return a.value.details.forEach(n=>{s+=parseInt(n.extra_money_trx_ttl)}),s}),F=p(()=>{let s=0;return a.value.details.forEach(n=>{s+=parseInt(n.jumlah)}),s});return(s,n)=>{const h=R;return V((d(),f("section",O,[t("div",null,[Y(h,{title:"Finance Payment Request",fn:c.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",Q,[t("div",W,[t("div",X," Batch No : "+l(i(a).batch_no),1),t("div",Z,[t("div",tt,[t("table",et,[t("thead",null,[st,t("tr",lt,[at,ot,nt,it,ct,_t,rt,ut,t("th",null,[r("Jumlah "),dt,r(" ("+l(i(_)(i(A)||0))+") ",1)]),t("th",null,[r("Potongan "),ft,r(" ("+l(i(_)(i(S)))+")",1)]),t("th",null,[r("ExtraMoney "),ht,r(" ("+l(i(_)(i(B)))+")",1)]),pt,mt,vt,t("th",null,[r("Nominal Transfer "),xt,r(" ("+l(i(_)(i(F)||0))+")",1)]),wt,yt,bt])]),t("tbody",jt,[(d(!0),f(z,null,H(i(a).details,(e,m)=>(d(),f("tr",{key:m},[t("td",gt,[t("div",kt,l(e.no),1)]),t("td",Nt,[t("div",Et,l(e.id),1)]),t("td",qt,[t("div",Dt,[t("div",It,[t("span",Ct,l(e.trx_trp_id),1)])])]),t("td",At,[t("div",St,l(e.jabatan!="KERNET"?e.tujuan:""),1)]),t("td",Bt,[t("div",Ft,l(e.jabatan!="KERNET"?e.produk:""),1)]),t("td",Tt,[t("div",Rt,l(e.jabatan!="KERNET"?e.no_pol:""),1)]),t("td",$t,[t("div",Pt,l(e.jabatan),1)]),t("td",Vt,[t("div",Mt,l(e.nama),1)]),t("td",Yt,[t("div",zt,l(i(_)(e.jumlah||0)),1)]),t("td",Ht,[t("div",Lt,l(i(_)(e.potongan_trx_ttl)),1)]),t("td",Kt,[t("div",Ut,l(i(_)(e.extra_money_trx_ttl)),1)]),Jt,t("td",Gt,[t("div",Ot,l(e.rek_no),1)]),t("td",Qt,[t("div",Wt,l(e.rek_name),1)]),t("td",Xt,[t("div",Zt,l(i(_)(e.jumlah||0)),1)]),t("td",te,[t("div",ee,l(e.status),1)]),t("td",se,[t("div",le,[e.status=="INQUIRY_FAILED"?(d(),f("button",{key:0,class:"bg-yellow-400 rounded",onClick:N(g=>s.renewData(e.id,m),["prevent"])}," Renew Data ",8,ae)):v("",!0)])]),t("td",oe,[t("div",ne,l(e.failed_reason),1)])]))),128))],512)])])])]),t("div",ie,[t("div",ce,[_e,i(a).val?(d(),f("div",re,[i(a).val?(d(),f("div",ue," App 1 : "+l(i(a).val_by.username)+" ( "+l(i(a).val_at?i(D)(i(a).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):v("",!0)])):v("",!0)]),t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:n[0]||(n[0]=e=>c.fnClose())}," Cancel "),c.is_view==0?(d(),f("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:n[1]||(n[1]=N(e=>I(),["prevent"]))}," Validasi ")):v("",!0)])])])],512)),[[M,c.show]])}}},ye=G(de,[["__scopeId","data-v-d2193c45"]]);export{ye as default};
