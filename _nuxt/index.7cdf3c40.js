import{g as Q,h as W,r as o,C as X,j as R,s as Y,f as ee,c as u,b as p,a as e,l as a,n as D,k as A,A as te,m as se,v as B,D as oe,F as ae,E as le,q as ne,o as c,G as ie,t as z,B as re,x as w,y as I,_ as ue}from"./entry.12334995.js";import ce from"./Header.479496c0.js";import _e from"./Copy.f7fcfd70.js";import de from"./Plus.e3caf944.js";import fe from"./Edit.3a6750c5.js";import pe from"./Search.d5edfe43.js";import{u as S}from"./useUtils.4456ff4d.js";import{u as M}from"./useMyFetch.b8c93418.js";import"./_plugin-vue_export-helper.c27b6911.js";const me=re(()=>ue(()=>import("./permission_group.1eb07c69.js"),["./permission_group.1eb07c69.js","./HeaderPopup.vue.39a3d3fe.js","./Times.2c7e61c7.js","./_plugin-vue_export-helper.c27b6911.js","./entry.12334995.js","./entry.7cb82c40.css","./useMyFetch.b8c93418.js"],import.meta.url).then(b=>b.default||b)),ve={class:"w-full h-full flex flex-col"},he={class:"w-full flex grow flex-col overflow-auto h-0"},ye={class:"w-full flex"},ge={action:"#",class:"w-full flex p-1"},ke={class:"grow"},we=e("div",{class:"font-bold"}," Keyword ",-1),be={class:"pl-1"},xe=e("div",{class:"font-bold"}," Sort By ",-1),Ce=e("option",{value:""},null,-1),De=e("option",{value:"id"},"ID",-1),Ae=e("option",{value:"name"},"Name",-1),Se=e("option",{value:"tipe"},"Tipe",-1),$e=[Ce,De,Ae,Se],Pe={class:"pl-1"},Te=e("div",{class:"font-bold"}," Sort Order ",-1),Le=e("option",{value:"asc"},"Asc",-1),Ue=e("option",{value:"desc"},"Desc",-1),Re=[Le,Ue],Be={class:"flex items-end pl-1"},ze={class:"w-full flex justify-center items-center grow h-0 p-1"},Ie={key:0,class:""},Me={class:"tacky"},Oe=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"ID"),e("th",null,"Name")])],-1),Ve=["onClick"],Ee={class:"bold"},We={__name:"index",async setup(b){let h,$;const l={};l._TimeZoneOffset=new Date().getTimezoneOffset(),l.sort="created_at:desc";const P=Q("token"),{data:O}=([h,$]=W(async()=>ne(async()=>{let t=[];w().loading_full=!0;const{data:s,error:v,status:x}=await M("/permission_groups",{method:"get",headers:{Authorization:`Bearer ${P.value}`,Accept:"application/json"},params:l,retry:0});return w().loading_full=!1,x.value==="error"?(I().trigger(v),{permission_groups:t}):(t=s.value.data,{permission_groups:t})},"$RBOosuv6RL")),h=await h,$(),h),r=o(O.value.permission_groups),_=o(""),d=o({field:"created_at",by:"desc"}),f=o(-1),n=o({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),V=()=>{l.like="",_.value!=""&&(l.like=`id:%${_.value}%,name:%${_.value}%,amount:%${_.value}%`),l.sort="",d.value.field&&(l.sort=d.value.field+":"+d.value.by)},y=o(null),T=async()=>{w().loading_full=!0,n.value.may_get_data=!1,l.page=n.value.page,l.page==1&&(r.value=[]),l.first_row&&delete l.first_row,l.page>1&&(l.first_row=JSON.stringify(r.value[0]));const{data:t,error:s,status:v}=await M("/permission_groups",{method:"get",headers:{Authorization:`Bearer ${P.value}`,Accept:"application/json"},params:l,retry:0});if(w().loading_full=!1,n.value.may_get_data=!0,v.value==="error"){I().trigger(s);return}n.value.page==1?(r.value=t.value.data,y.value&&(y.value.scrollTop=0)):n.value.page>1&&(r.value=[...r.value,...t.value.data]),t.value.data.length==0&&(n.value.is_last_record=!0)},E=async()=>{if(!n.value.may_get_data)return;let t=y.value;if(t.scrollLeft!=n.value.scrollLeft){n.value.scrollLeft=t.scrollLeft;return}n.value.is_last_record||!(Math.round(t.scrollTop)+t.clientHeight>=t.scrollHeight-1)||(n.value.page++,await T())},F=()=>{n.value.page=1,n.value.is_last_record=!1,V(),T()};X();const m=o(!1),g=o(0),k=o(0),N=()=>{g.value=0,m.value=!0,k.value=!1},{display:L}=R();Y(R());const j=()=>{f.value==-1?L({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(g.value=r.value[f.value].id,m.value=!0,k.value=!1)},G=()=>{f.value==-1?L({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(g.value=r.value[f.value].id,m.value=!0,k.value=!0)};o(!1),o(0),o(!1);const U=o(!1);o({}),o(!1);const H=o("");return ee(()=>H.value,t=>{t.trim().length>0?U.value=!0:U.value=!1},{immediate:!1}),(t,s)=>{const v=ce,x=_e,K=de,q=fe,J=pe,Z=me;return c(),u("div",ve,[p(v,{title:"List Permission Group"}),e("div",he,[e("div",ye,[("useUtils"in t?t.useUtils:a(S))().checkPermission("permission_group.create")?(c(),u("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[0]||(s[0]=i=>G())},[p(x)])):D("",!0),("useUtils"in t?t.useUtils:a(S))().checkPermission("permission_group.create")?(c(),u("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[1]||(s[1]=i=>N())},[p(K)])):D("",!0),("useUtils"in t?t.useUtils:a(S))().checkPermission("permission_group.modify")?(c(),u("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[2]||(s[2]=i=>j())},[p(q)])):D("",!0)]),e("form",ge,[e("div",ke,[we,A(e("input",{class:"",type:"text","onUpdate:modelValue":s[3]||(s[3]=i=>se(_)?_.value=i:null),name:"search",placeholder:"Keyword"},null,512),[[te,a(_)]])]),e("div",be,[xe,A(e("select",{class:"","onUpdate:modelValue":s[4]||(s[4]=i=>a(d).field=i)},$e,512),[[B,a(d).field]])]),e("div",Pe,[Te,A(e("select",{class:"","onUpdate:modelValue":s[5]||(s[5]=i=>a(d).by=i)},Re,512),[[B,a(d).by]])]),e("div",Be,[e("button",{class:"",type:"submit",name:"button",onClick:s[6]||(s[6]=oe(i=>F(),["prevent"]))},[p(J,{class:"text-2xl"})])])]),e("div",ze,[a(r).length==0?(c(),u("div",Ie," Maaf Tidak Ada Record ")):(c(),u("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:y,onScroll:E},[e("table",Me,[Oe,e("tbody",null,[(c(!0),u(ae,null,le(a(r),(i,C)=>(c(),u("tr",{key:C,onClick:Fe=>f.value=C,class:ie(a(f)==C?"active":"")},[e("td",Ee,z(i.id),1),e("td",null,z(i.name),1)],10,Ve))),128))])])],544))])]),p(Z,{show:a(m),fnClose:()=>{m.value=!1},id:a(g),p_data:a(r),is_copy:a(k)},null,8,["show","fnClose","id","p_data","is_copy"])])}}};export{We as default};
