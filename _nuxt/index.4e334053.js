import re from"./Header.fc6df3b2.js";import ue from"./Plus.0defd98c.js";import ie from"./Edit.e952385d.js";import ce from"./Eyes.faa799e1.js";import de from"./Delete.211d72a2.js";import _e from"./Signature.31d280de.js";import me from"./CheckList.3ce36a5c.js";import fe from"./Table2Column.8f403715.js";import pe from"./Search.914e4a0e.js";import{_ as ve}from"./PopupMini.vue.c7e795ad.js";import he from"./summary.19f6ffd7.js";import{h as ye,k as ge,r as d,i as be,z as F,A as xe,c as p,b as _,a as e,m as a,J as j,G as ke,n as we,q as $e,B as Ce,s as De,F as Ae,D as Te,l as qe,x as v,y as q,o as m,E as Se,t as i,H as Me}from"./entry.f2e433ad.js";import"./useUtils.7a797e50.js";import{u as S}from"./useMyFetch.04b8e4b6.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.ab10e003.js";import"./Exclamation.d5d43ff9.js";import"./HeaderPopup.vue.a0078f0a.js";import"./client-only.47dc31b8.js";import"./summary_detail.3994bd6c.js";const Be={class:"w-full h-full flex flex-col"},Ne={class:"w-full flex grow flex-col overflow-auto h-0"},Ie={class:"w-full flex"},Le=["disabled"],Re={class:"text-sm absolute top-0 right-0 flex justify-end"},Ee={key:0,class:"w-2 h-2 rounded-full bg-red-700 border-2 border-solid border-red-950"},He={action:"#",class:"w-full flex p-1"},ze={class:"grow"},Fe=e("div",{class:"font-bold"}," Keyword ",-1),je={class:"flex items-end pl-1"},Pe={class:"w-full flex justify-center items-center grow h-0 p-1"},Ve={key:0,class:""},Oe={class:"tacky"},We=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"ID"),e("th",null,"Input At"),e("th",null,"Warehouse Name"),e("th",null,"Note"),e("th",null,"Status"),e("th",null,"Type"),e("th",null,"Warehouse Source Name"),e("th",null,"Warehouse Target Name"),e("th",null,"Confirmed At"),e("th",null,"Confirmed By"),e("th",null,"Requested At"),e("th",null,"Requested By")])],-1),Ye=["onClick"],Je={class:"bold"},vt={__name:"index",async setup(Ke){let g,M;const{$moment:k}=Me(),r={};r._TimeZoneOffset=new Date().getTimezoneOffset();const w=ye("token"),{data:B}=([g,M]=ge(async()=>qe(async()=>{v().loading_full=!0;const{data:s,error:o,status:f}=await S("/transactions",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:r,retry:0});if(v().loading_full=!1,f.value==="error")return q().trigger(o),[];let y=s.value.data,A=s.value.request_notif;return{transactions:y,request_notif:A}},"$45iBZgNANe")),g=await g,M(),g),n=d(B.value.transactions),P=d(B.value.request_notif),c=d(""),$=d({field:"updated_at",by:"desc"}),l=d(-1),u=d({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),V=()=>{r.like="",c.value!=""&&(r.like=`id:%${c.value}%,warehouse_name:%${c.value}%,warehouse_source_name:%${c.value}%,warehouse_target_name:%${c.value}%,item_name:%${c.value}%,status:%${c.value}%,type:%${c.value}%`),r.sort="",$.value.field&&(r.sort=$.value.field+":"+$.value.by)},b=d(null),N=async()=>{v().loading_full=!0,u.value.may_get_data=!1,r.page=u.value.page,r.page==1&&(n.value=[]),r.first_row&&delete r.first_row,r.page>1&&(r.first_row=JSON.stringify(n.value[0]));const{data:s,error:o,status:f}=await S("/transactions",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:r,retry:0});if(v().loading_full=!1,u.value.may_get_data=!0,f.value==="error"){q().trigger(o);return}u.value.page==1?(n.value=s.value.data,b.value&&(b.value.scrollTop=0)):u.value.page>1&&(n.value=[...n.value,...s.value.data]),s.value.data.length==0&&(u.value.is_last_record=!0)},O=async()=>{if(!u.value.may_get_data)return;let s=b.value;if(s.scrollLeft!=u.value.scrollLeft){u.value.scrollLeft=s.scrollLeft;return}u.value.is_last_record||!(Math.round(s.scrollTop)+s.clientHeight>=s.scrollHeight-1)||(u.value.page++,await N())},W=()=>{u.value.page=1,u.value.is_last_record=!1,V(),N()},x=be(),Y=()=>{x.push({name:"data_transaksi-form",query:{id:""}})},{display:C}=F();xe(F());const J=()=>{l.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):x.push({name:"data_transaksi-form",query:{id:n.value[l.value].id}})},K=()=>{l.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):x.push({name:"data_transaksi-confirm",query:{id:n.value[l.value].id}})},Z=()=>{x.push({name:"data_transaksi-request"})},I=d({}),h=d(!1),G=async()=>{h.value&&(h.value=!1)},U=()=>{l.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(I.value={id:n.value[l.value].id},h.value=!0)},Q=async()=>{v().loading_full=!0;const s=new FormData;s.append("id",n.value[l.value].id),s.append("_method","DELETE");const{data:o,error:f,status:y}=await S("/transaction",{method:"post",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},body:s,retry:0});if(v().loading_full=!1,y.value==="error"){q().trigger(f);return}n.value.splice(l.value,1),l.value=-1,h.value=!1},D=d(!1);return(s,o)=>{const f=re,y=ue,A=ie,X=ce,ee=de,te=_e,oe=me,ae=fe,se=pe,le=ve,ne=he;return m(),p("div",Be,[_(f,{title:"List Transaction"}),e("div",Ne,[e("div",Ie,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:o[0]||(o[0]=t=>Y())},[_(y)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:o[1]||(o[1]=t=>J())},[a(l)==-1||a(n)[a(l)].ref_id==null&&a(n)[a(l)].confirmed_by==null?(m(),j(A,{key:0})):(m(),j(X,{key:1}))]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:o[2]||(o[2]=t=>U())},[_(ee)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",disabled:a(l)==-1||a(n)[a(l)].confirmed_by,onClick:o[3]||(o[3]=t=>K())},[_(te)],8,Le),e("button",{type:"button",name:"button",class:"m-1 text-2xl relative",onClick:o[4]||(o[4]=t=>Z())},[_(oe),e("div",Re,[a(P)>0?(m(),p("div",Ee)):ke("",!0)])]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:o[5]||(o[5]=t=>D.value=!0)},[_(ae)])]),e("form",He,[e("div",ze,[Fe,we(e("input",{class:"",type:"text","onUpdate:modelValue":o[6]||(o[6]=t=>Ce(c)?c.value=t:null),name:"search",placeholder:"Keyword"},null,512),[[$e,a(c)]])]),e("div",je,[e("button",{class:"",type:"submit",name:"button",onClick:o[7]||(o[7]=De(t=>W(),["prevent"]))},[_(se,{class:"text-2xl"})])])]),e("div",Pe,[a(n).length==0?(m(),p("div",Ve," Maaf Tidak Ada Record ")):(m(),p("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:O},[e("table",Oe,[We,e("tbody",null,[(m(!0),p(Ae,null,Te(a(n),(t,T)=>{var L,R,E,H,z;return m(),p("tr",{key:T,onClick:Ze=>l.value=T,class:Se(a(l)==T?"active":"")},[e("td",Je,i(t.id),1),e("td",null,i(t.input_at?a(k)(t.input_at).format("DD-MM-Y"):""),1),e("td",null,i((L=t.warehouse)==null?void 0:L.name),1),e("td",null,i(t.note),1),e("td",null,i(t.status),1),e("td",null,i(t.type),1),e("td",null,i((R=t.warehouse_source)==null?void 0:R.name),1),e("td",null,i((E=t.warehouse_target)==null?void 0:E.name),1),e("td",null,i(t.confirmed_at?a(k)(t.confirmed_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,i((H=t.confirmer)==null?void 0:H.username),1),e("td",null,i(a(k)(t.requested_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,i((z=t.requester)==null?void 0:z.username),1)],10,Ye)}),128))])])],544))])]),_(le,{type:"delete",show:a(h),data:a(I),fnClose:G,fnConfirm:Q},null,8,["show","data"]),_(ne,{show:a(D),fnClose:()=>{D.value=!1}},null,8,["show","fnClose"])])}}};export{vt as default};
