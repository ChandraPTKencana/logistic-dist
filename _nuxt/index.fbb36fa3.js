import{_ as Pe}from"./Header.906a4f14.js";import{_ as ve}from"./_plugin-vue_export-helper.c27b6911.js";import{o,c as u,a as e,f as _e,r as _,g as ge,h as M,v as ke,b as S,i as Se,j as ue,k as t,l as pe,m as he,F as Q,n as de,q as L,t as i,p as je,e as Ae,x as F,y as te,L as re,G as I,d as ee,N as X,s as De,D as Ue,B as Ne,H as Te,I as Ve,E as Re,O as Fe}from"./entry.1eda34e7.js";import{_ as qe}from"./Plus.22473df7.js";import{_ as Be}from"./Edit.f3618f76.js";import{_ as ze}from"./Eyes.a81dc71e.js";import{_ as He}from"./Delete.ca110e1d.js";import{_ as Le}from"./Signature.549016fe.js";import{_ as Ie,u as ne}from"./useUtils.0499e5ee.js";import{_ as Me,a as Ee}from"./Check.6f177a22.js";import{_ as Oe}from"./PopupMini.vue.543b41b7.js";import{_ as Ce}from"./HeaderPopup.vue.34b1c300.js";import{_ as Ye,a as Je}from"./ToolsPopup.e72cafef.js";import{_ as Ke}from"./InputPointFormat.vue.ce96e53f.js";import{_ as Qe}from"./Times.1d70f46d.js";import{u as se}from"./useMyFetch.c9dacd92.js";const Ge={name:"MaterialSymbolsContentCopy"},Xe={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Ze=e("path",{fill:"currentColor",d:"M9 18q-.825 0-1.412-.587T7 16V4q0-.825.588-1.412T9 2h9q.825 0 1.413.588T20 4v12q0 .825-.587 1.413T18 18zm-4 4q-.825 0-1.412-.587T3 20V6h2v14h11v2z"},null,-1),We=[Ze];function et(h,w,z,N,p,a){return o(),u("svg",Xe,We)}const tt=ve(Ge,[["render",et]]);const Z=h=>(je("data-v-99d23942"),h=h(),Ae(),h),st={class:"box-fixed"},lt={action:"#",class:"w-full flex p-1"},ot={class:"grow"},at=Z(()=>e("div",{class:"font-bold"}," Keyword ",-1)),nt={class:"pl-1"},ct=Z(()=>e("div",{class:"font-bold"}," Sort By ",-1)),it=Z(()=>e("option",{value:"AccountID"},"ID",-1)),ut=Z(()=>e("option",{value:"AccountCode"},"Code",-1)),dt=Z(()=>e("option",{value:"AccountName"},"Nama",-1)),rt=[it,ut,dt],_t={class:"pl-1"},pt=Z(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),ft=Z(()=>e("option",{value:"asc"},"Asc",-1)),vt=Z(()=>e("option",{value:"desc"},"Desc",-1)),ht=[ft,vt],mt={class:"flex items-end pl-1"},wt={class:"w-full flex justify-center items-center grow h-0 p-1"},xt={key:0,class:""},yt={class:"tacky w-full"},bt=Z(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No."),e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"ID"),e("th",null,"Code"),e("th",null,"Name")])],-1)),$t=["onClick"],gt={class:"bold"},kt={class:"whitespace-normal break-words"},jt={class:"flex",style:{"justify-content":"end",padding:"5px"}},At={__name:"ac_accs",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1}},setup(h){const w=h,{countClickListFn:z}=ne(),N=_e("token"),p=_([]),a=_(""),A=_({field:"AccountID",by:"desc"}),J=_(-1),l=_({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),n={};n._TimeZoneOffset=new Date().getTimezoneOffset();const H=()=>{n.like="",a.value!=""&&(n.like=`AccountID:%${a.value}%,AccountCode:%${a.value}%,AccountName:%${a.value}%`),n.sort="",A.value.field&&(n.sort=A.value.field+":"+A.value.by)},x=_(null),D=async()=>{F().loading_full=!0,l.value.may_get_data=!1,n.page=l.value.page,n.page==1&&(p.value=[]),n.first_row&&delete n.first_row,n.page>1&&(n.first_row=JSON.stringify(p.value[0]));const{data:y,error:v,status:g}=await se("/ujalan/ac_accounts",{method:"get",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},params:n,retry:0});if(F().loading_full=!1,l.value.may_get_data=!0,g.value==="error"){te().trigger(v);return}l.value.page==1?(p.value=y.value.data,x.value&&(x.value.scrollTop=0)):l.value.page>1&&(p.value=[...p.value,...y.value.data]),y.value.data.length==0&&(l.value.is_last_record=!0)},B=async()=>{if(!l.value.may_get_data)return;let y=x.value;if(y.scrollLeft!=l.value.scrollLeft){l.value.scrollLeft=y.scrollLeft;return}l.value.is_last_record||!(Math.round(y.scrollTop)+y.clientHeight>=y.scrollHeight-1)||(l.value.page++,await D())},k=()=>{l.value.page=1,l.value.is_last_record=!1,H(),D()},C=()=>{J.value>-1?w.fnSelect(p.value[J.value]):w.fnSelect({ac_account_id:"",ac_account_code:"",ac_account_name:""})},Y=y=>{z(y,()=>{J.value=y},C)},f=_(null);let T=null;const K=y=>{T&&clearTimeout(T),T=setTimeout(()=>{k()},500)};return ge(()=>w.show,(y,v)=>{y==!0&&(k(),setTimeout(()=>{f.value.focus()},100))},{immediate:!0}),(y,v)=>{const g=Ce,W=Ie;return M((o(),u("section",st,[e("div",null,[S(g,{title:"Search And Select Ac Account",fn:h.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",lt,[e("div",ot,[at,M(e("input",{ref_key:"ref_keyword",ref:f,class:"",type:"text","onUpdate:modelValue":v[0]||(v[0]=R=>Se(a)?a.value=R:null),name:"search",placeholder:"Keyword",onKeyup:v[1]||(v[1]=R=>K())},null,544),[[ue,t(a)]])]),e("div",nt,[ct,M(e("select",{class:"","onUpdate:modelValue":v[2]||(v[2]=R=>t(A).field=R)},rt,512),[[pe,t(A).field]])]),e("div",_t,[pt,M(e("select",{class:"","onUpdate:modelValue":v[3]||(v[3]=R=>t(A).by=R)},ht,512),[[pe,t(A).by]])]),e("div",mt,[e("button",{class:"",type:"submit",name:"button",onClick:v[4]||(v[4]=he(R=>k(),["prevent"]))},[S(W,{class:"text-2xl"})])])]),e("div",wt,[t(p).length==0?(o(),u("div",xt," Maaf Tidak Ada Record ")):(o(),u("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:x,onScroll:B},[e("table",yt,[bt,e("tbody",null,[(o(!0),u(Q,null,de(t(p),(R,E)=>(o(),u("tr",{key:E,onClick:ce=>Y(E),class:L(t(J)==E?"active":"")},[e("td",null,i(E+1)+".",1),e("td",gt,i(R.ac_account_id),1),e("td",null,i(R.ac_account_code),1),e("td",kt,i(R.ac_account_name),1)],10,$t))),128))])])],544))]),e("div",jt,[e("button",{onClick:v[5]||(v[5]=R=>C()),class:"w-36 m-1 bg-blue-600 text-white rounded-sm"}," Select ")])])],512)),[[ke,h.show]])}}},Ct=ve(At,[["__scopeId","data-v-99d23942"]]);const P=h=>(je("data-v-9c2451a0"),h=h(),Ae(),h),Tt={class:"box-fixed"},St={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},Dt={class:"w-full flex flex-col items-center justify-center grow overflow-auto"},qt={class:"w-full flex flex-row flex-wrap"},It={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Pt=P(()=>e("label",{for:""},"To",-1)),Ut=["disabled"],Nt={class:"text-red-500"},Vt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Rt=P(()=>e("label",{for:""},"Tipe",-1)),Ft=["disabled"],Bt={class:"text-red-500"},zt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ht=P(()=>e("label",{for:""},"Jenis",-1)),Lt=["disabled"],Mt=P(()=>e("option",{value:"PK"},"PK",-1)),Et=P(()=>e("option",{value:"CPO"},"CPO",-1)),Ot=P(()=>e("option",{value:"TBS"},"TBS",-1)),Yt=[Mt,Et,Ot],Jt={class:"text-red-500"},Kt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Qt=P(()=>e("label",{for:""},"Harga",-1)),Gt={class:"card-border disabled"},Xt={class:"text-red-500"},Zt={class:"w-full flex grow p-1 overflow-auto 2xl:overflow-hidden justify-between flex-wrap"},Wt={class:"w-full p-0 2xl:pr-1 2xl:w-1/2 2xl:h-full 2xl:overflow-auto"},es={class:"w-full",role:"sticky"},ts={class:"tacky w-full",style:{"white-space":"normal"}},ss={class:"sticky -top-1 !z-[2]"},ls=["colspan"],os={class:"sticky top-7 !z-[2]"},as={key:0,class:"min-w-[50px] !w-[50px] max-w-[50px]"},ns=P(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),cs=P(()=>e("th",null,"Desc",-1)),is=P(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Harga @",-1)),us=P(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"Qty",-1)),ds={class:"min-w-[100px] !w-[100px] max-w-[100px]"},rs=P(()=>e("br",null,null,-1)),_s={class:"text-sm"},ps={ref:"to_move"},fs=["data-index"],vs={key:0,class:"tools cell"},hs={class:"w-full h-full flex items-center justify-center"},ms=["onClick"],ws={class:"cell"},xs={class:"w-full h-full flex items-center justify-center"},ys=["disabled","onUpdate:modelValue"],bs={class:"w-full h-full flex items-center justify-center"},$s={class:"w-full h-full flex items-center justify-center"},gs={class:"cell"},ks={class:"w-full h-full flex items-center justify-center unselectable"},js={key:0},As={class:"tools cell"},Cs={class:"w-full px-0 py-2 2xl:pl-1 2xl:py-0 2xl:w-1/2 2xl:h-full 2xl:overflow-auto"},Ts={class:"w-full",role:"sticky"},Ss={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},Ds={class:"sticky -top-1 !z-[2]"},qs=["colspan"],Is={class:"sticky top-7 !z-[2]"},Ps={key:0,class:"min-w-[30px] !w-[30px] max-w-[30px]"},Us=P(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),Ns={key:1,class:"min-w-[30px] !w-[30px] max-w-[30px]"},Vs=P(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),Rs=P(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),Fs=P(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),Bs=P(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),zs=P(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Amount",-1)),Hs=P(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Qty",-1)),Ls={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Ms=P(()=>e("br",null,null,-1)),Es={class:"text-sm"},Os={ref:"to_move"},Ys=["data-index"],Js={key:0,class:"tools cell"},Ks={class:"w-full h-full flex items-center justify-center"},Qs=["onClick"],Gs={key:1,class:"cell"},Xs={class:"w-full h-full flex items-center justify-center"},Zs=["onClick"],Ws=["onClick","disabled"],el={class:"w-full h-full flex items-center justify-center"},tl={class:"w-full h-full flex items-center justify-center"},sl={class:"w-full h-full flex items-center justify-center"},ll={class:"cell"},ol={class:"w-full h-full flex items-center justify-center"},al=["disabled","onUpdate:modelValue"],nl={class:"w-full h-full flex items-center justify-center"},cl={class:"w-full h-full flex items-center justify-center"},il={class:"cell"},ul={class:"w-full h-full flex items-center justify-center unselectable"},dl={key:0},rl={class:"tools cell"},_l={class:"w-full flex items-center justify-end"},pl={__name:"ujalan",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(h){const w=h,{pointFormat:z}=ne(),N={id:-1,xto:"",tipe:"",jenis:"",harga:0,details:[],details2:[]},p=_({...N}),a=_e("token"),A=_({}),J=_([{xdesc:"Timbangan",qty:1,harga:55e3},{xdesc:"Retribusi TPR",qty:1,harga:23e3},{xdesc:"Parkir & Nginap",qty:1,harga:1e4},{xdesc:"Penitipan Alat (Dongkrak)",qty:1,harga:5e3},{xdesc:"Ikas Danau",qty:1,harga:1e4},{xdesc:"U.Bongkar + Ambil surat",qty:1,harga:35e3},{xdesc:"Perbaikan Jalan Pujut",qty:1,harga:1e4},{xdesc:"Gaji Supir",qty:1,harga:0},{xdesc:"Gaji Kernet",qty:1,harga:0},{xdesc:"U.Extrafooding",qty:1,harga:2e4}]);_([]);const l=_([]),n=_([]),H=_({ordinal:0,id:-1,xdesc:"",qty:1,harga:0,p_status:""}),x=_({ordinal:0,id:-1,ac_account_id:"",ac_account_name:"",ac_account_code:"",description:"",qty:1,amount:0,p_status:""}),D=()=>{J.value.forEach(c=>{l.value.filter(s=>s.xdesc==c.xdesc).length==0&&l.value.push({...c,ordinal:0,id:-1,p_status:"Add"})})},B=_(!1),k=()=>{B.value=!1},C=c=>{n.value[g.value].ac_account_id=c.ac_account_id,n.value[g.value].ac_account_code=c.ac_account_code,n.value[g.value].ac_account_name=c.ac_account_name,B.value=!1},Y=(c,s)=>{g.value=s,B.value=!0},f=(c,s)=>{n.value[s].ac_account_id="",n.value[s].ac_account_code="",n.value[s].ac_account_name=""},T=async()=>{F().loading_full=!0,A.value={};const c=new FormData;c.append("xto",p.value.xto),c.append("tipe",p.value.tipe),c.append("jenis",p.value.jenis),c.append("harga",p.value.harga),c.append("details",JSON.stringify(l.value)),c.append("details2",JSON.stringify(n.value));let s="post",G=w.is_copy?0:w.id;G==0||(c.append("id",G),c.append("_method","PUT"));const{data:O,error:V,status:oe}=await se("/ujalan",{method:s,headers:{Authorization:`Bearer ${a.value}`,Accept:"application/json"},body:c,retry:0});if(F().loading_full=!1,oe.value==="error"){te().trigger(V,A);return}if(G<=0)p.value.id=O.value.id,p.value.created_at=O.value.created_at,p.value.updated_at=O.value.updated_at,w.p_data.unshift(p.value);else{p.value.updated_at=O.value.updated_at;let ae=w.p_data.map(ie=>ie.id).indexOf(G);ae>=-1&&w.p_data.splice(ae,1,{...p.value})}w.fnClose()},K=re(()=>{let c=0;return l.value.forEach(s=>{s.p_status!="Remove"&&(c+=s.qty*s.harga)}),p.value.harga=c,c}),y=re(()=>{let c=0;return n.value.forEach(s=>{s.p_status!="Remove"&&(c+=s.qty*s.amount)}),c}),v=_(-1),g=_(-1),W=_(!1),R=_({left:0,top:0}),E=_(!1),ce=_({left:0,top:0}),me=(c,s)=>{v.value=s,W.value=!0,R.value={left:c.clientX,top:c.clientY}},fe=(c,s)=>{g.value=s,E.value=!0,ce.value={left:c.clientX,top:c.clientY}},le=()=>{l.value.push({...H.value,p_status:"Add"})},we=()=>{n.value.push({...x.value,p_status:"Add"})},xe=()=>{W.value=!1},ye=()=>{E.value=!1},b=(c="")=>{if(c=="insert")l.value.splice(v.value,0,{...H.value,p_status:"Add"});else if(c=="delete")l.value[v.value].p_status=="Edit"?l.value[v.value].p_status="Remove":l.value.splice(v.value,1);else if(c=="move_top"){let s=l.value[v.value];l.value.splice(v.value,1),l.value.splice(v.value-1,0,{...s})}else if(c=="move_bottom"){let s=l.value[v.value];l.value.splice(v.value,1),l.value.splice(v.value+1,0,{...s})}W.value=!1},$=(c="")=>{if(c=="insert")n.value.splice(g.value,0,{...x.value,p_status:"Add"});else if(c=="delete")n.value[g.value].p_status=="Edit"?n.value[g.value].p_status="Remove":n.value.splice(g.value,1);else if(c=="move_top"){let s=n.value[g.value];n.value.splice(g.value,1),n.value.splice(g.value-1,0,{...s})}else if(c=="move_bottom"){let s=n.value[g.value];n.value.splice(g.value,1),n.value.splice(g.value+1,0,{...s})}E.value=!1},q=_e("role"),m=re(()=>p.value.val&&p.value.val1||q.value=="Logistic"&&p.value.val||q.value=="PabrikTransport"&&p.value.val1),be=async()=>{F().loading_full=!0;const{data:c,error:s,status:G}=await se("/ujalan_",{method:"get",headers:{Authorization:`Bearer ${a.value}`,Accept:"application/json"},params:{id:w.id},retry:0});if(F().loading_full=!1,G.value==="error"){te().trigger(s);return}p.value=c.value.data;let O="Edit";w.is_copy&&(O="Add"),l.value=c.value.data.details.map(V=>(V.p_status=O,V.key=V.ordinal,V)),n.value=c.value.data.details2.map(V=>(V.p_status=O,V.key=V.ordinal,V))};return ge(()=>w.show,(c,s)=>{c==!0&&(p.value={...N},l.value=[],n.value=[],w.id!=0&&be())},{immediate:!0}),(c,s)=>{const G=Ce,O=Ye,V=Ke,oe=qe,ae=Qe,ie=Je,$e=Ct;return o(),u(Q,null,[M(e("section",Tt,[e("div",null,[S(G,{title:"Form Ujalan",fn:h.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",St,[e("div",Dt,[e("div",qt,[e("div",It,[Pt,M(e("input",{"onUpdate:modelValue":s[0]||(s[0]=d=>t(p).xto=d),disabled:t(q)=="PabrikTransport"||t(m)},null,8,Ut),[[ue,t(p).xto]]),e("p",Nt,i(t(A).xto),1)]),e("div",Vt,[Rt,M(e("textarea",{"onUpdate:modelValue":s[1]||(s[1]=d=>t(p).tipe=d),disabled:t(q)=="PabrikTransport"||t(m)},null,8,Ft),[[ue,t(p).tipe]]),e("p",Bt,i(t(A).tipe),1)]),e("div",zt,[Ht,M(e("select",{"onUpdate:modelValue":s[2]||(s[2]=d=>t(p).jenis=d),disabled:t(q)=="PabrikTransport"||t(m)},Yt,8,Lt),[[pe,t(p).jenis]]),e("p",Jt,i(t(A).jenis),1)]),e("div",Kt,[Qt,e("div",Gt,i(t(z)(t(K))),1),e("p",Xt,i(t(A).harga),1)])]),e("div",Zt,[e("div",Wt,[e("div",es,[e("table",ts,[e("thead",null,[e("tr",ss,[e("td",{colspan:t(q)!="PabrikTransport"&&!t(m)?6:5,class:"!bg-slate-800 text-white font-bold"}," Detail Uang Jalan ",8,ls)]),e("tr",os,[t(q)!="PabrikTransport"&&!t(m)?(o(),u("th",as,[e("button",{type:"button",name:"button",class:"bg-yellow-600",onClick:s[3]||(s[3]=d=>D())}," Default In ")])):I("",!0),ns,cs,is,us,e("th",ds,[ee("Total "),rs,ee(),e("span",_s,"("+i(t(z)(t(K)))+")",1)])])]),e("tbody",ps,[(o(!0),u(Q,null,de(t(l),(d,r)=>(o(),u(Q,{key:r},[d.p_status!="Remove"?(o(),u("tr",{key:0,"data-index":r},[t(q)!="PabrikTransport"&&!t(m)?(o(),u("td",vs,[e("div",hs,[e("button",{type:"button",name:"button",onClick:j=>me(j,r)},[S(O)],8,ms)])])):I("",!0),e("td",null,i(r+1)+".",1),e("td",ws,[e("div",xs,[M(e("textarea",{disabled:t(q)=="PabrikTransport"||t(m),class:"p-1 w-full","onUpdate:modelValue":j=>d.xdesc=j,cols:"7",rows:"2"},null,8,ys),[[ue,d.xdesc]])])]),e("td",{class:L(["cell bold",t(q)=="PabrikTransport"||t(m)?"unselectable":""])},[e("div",bs,[(o(),X(V,{key:r,class:"w-full h-full p-1",type:"text",value:d.harga||0,onInput:j=>d.harga=j,show:h.show},null,8,["value","onInput","show"]))])],2),e("td",{class:L(["cell",t(q)=="PabrikTransport"||t(m)?"unselectable":""])},[e("div",$s,[(o(),X(V,{key:r,class:"w-full h-full p-1",type:"text",value:d.qty||0,onInput:j=>d.qty=j,show:h.show},null,8,["value","onInput","show"]))])],2),e("td",gs,[e("div",ks,i(t(z)(d.qty*d.harga||0)),1)])],8,fs)):I("",!0)],64))),128)),t(q)!="PabrikTransport"&&!t(m)?(o(),u("tr",js,[e("td",As,[e("button",{type:"button",name:"button",onClick:s[4]||(s[4]=d=>le())},[S(oe)])])])):I("",!0)],512)])])]),e("div",Cs,[e("div",Ts,[e("table",Ss,[e("thead",null,[e("tr",Ds,[e("td",{colspan:t(m)?8:10,class:"!bg-slate-800 text-white font-bold"}," Detail PVR ",8,qs)]),e("tr",Is,[t(m)?I("",!0):(o(),u("th",Ps)),Us,t(m)?I("",!0):(o(),u("th",Ns)),Vs,Rs,Fs,Bs,zs,Hs,e("th",Ls,[ee("Total "),Ms,ee(),e("span",Es,"("+i(t(z)(t(y)))+")",1)])])]),e("tbody",Os,[(o(!0),u(Q,null,de(t(n),(d,r)=>(o(),u(Q,{key:r},[d.p_status!="Remove"?(o(),u("tr",{key:0,"data-index":r},[t(m)?I("",!0):(o(),u("td",Js,[e("div",Ks,[e("button",{type:"button",name:"button",onClick:j=>fe(j,r)},[S(O)],8,Qs)])])),e("td",null,i(r+1)+".",1),t(m)?I("",!0):(o(),u("td",Gs,[e("div",Xs,[d.ac_account_id?(o(),u("button",{key:1,type:"button",onClick:j=>f(j,r),disabled:d.confirm_by},[S(ae,{class:"font-bold text-2xl"})],8,Ws)):(o(),u("button",{key:0,type:"button",name:"button",onClick:j=>Y(j,r)}," ... ",8,Zs))])])),e("td",{class:L(["cell bold",t(m)?"unselectable":""])},[e("div",el,i(d.ac_account_id),1)],2),e("td",{class:L(["cell bold",t(m)?"unselectable":""])},[e("div",tl,i(d.ac_account_code),1)],2),e("td",{class:L(["cell bold",t(m)?"unselectable":""])},[e("div",sl,i(d.ac_account_name),1)],2),e("td",ll,[e("div",ol,[M(e("textarea",{disabled:t(m),class:"p-1 w-full","onUpdate:modelValue":j=>d.description=j,cols:"7",rows:"2"},null,8,al),[[ue,d.description]])])]),e("td",{class:L(["cell bold",t(m)?"unselectable":""])},[e("div",nl,[(o(),X(V,{key:r,class:"w-full h-full p-1",type:"text",value:d.amount||0,onInput:j=>d.amount=j,show:h.show},null,8,["value","onInput","show"]))])],2),e("td",{class:L(["cell",t(m)?"unselectable":""])},[e("div",cl,[(o(),X(V,{key:r,class:"w-full h-full p-1",type:"text",value:d.qty||0,onInput:j=>d.qty=j,show:h.show},null,8,["value","onInput","show"]))])],2),e("td",il,[e("div",ul,i(t(z)(d.qty*d.amount||0)),1)])],8,Ys)):I("",!0)],64))),128)),t(m)?I("",!0):(o(),u("tr",dl,[e("td",rl,[e("button",{type:"button",name:"button",onClick:s[5]||(s[5]=d=>we())},[S(oe)])])]))],512)])])])])]),e("div",_l,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:s[6]||(s[6]=d=>h.fnClose())}," Cancel "),t(m)?I("",!0):(o(),u("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:s[7]||(s[7]=he(d=>T(),["prevent"]))}," Save "))])])])],512),[[ke,h.show]]),S(ie,{show:t(W),coor:t(R),fn:xe,data:t(l),data_index:t(v),onReplyAct:s[8]||(s[8]=d=>b(d))},null,8,["show","coor","data","data_index"]),S(ie,{show:t(E),coor:t(ce),fn:ye,data:t(n),data_index:t(g),onReplyAct:s[9]||(s[9]=d=>$(d))},null,8,["show","coor","data","data_index"]),S($e,{show:t(B),fnClose:k,fnSelect:C},null,8,["show"])],64)}}},fl=ve(pl,[["__scopeId","data-v-9c2451a0"]]);const U=h=>(je("data-v-cd69c5e0"),h=h(),Ae(),h),vl={class:"box-fixed"},hl={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},ml={class:"w-full flex flex-col items-center justify-center grow overflow-auto"},wl={class:"w-full flex flex-row flex-wrap"},xl={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},yl=U(()=>e("label",{for:""},"To",-1)),bl={class:"card-border"},$l={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},gl=U(()=>e("label",{for:""},"Tipe",-1)),kl={class:"card-border"},jl={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Al=U(()=>e("label",{for:""},"Jenis",-1)),Cl={class:"card-border"},Tl={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Sl=U(()=>e("label",{for:""},"Harga",-1)),Dl={class:"card-border"},ql={class:"w-full flex grow p-1 overflow-auto 2xl:overflow-hidden justify-between flex-wrap"},Il={class:"w-full p-0 2xl:pr-1 2xl:w-1/2 2xl:h-full 2xl:overflow-auto"},Pl={class:"w-full",role:"sticky"},Ul={class:"tacky w-full",style:{"white-space":"normal"}},Nl=U(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"5",class:"!bg-slate-800 text-white font-bold"}," Detail Uang Jalan ")],-1)),Vl={class:"sticky top-8 !z-[2]"},Rl=U(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),Fl=U(()=>e("th",null,"Desc",-1)),Bl=U(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Harga @",-1)),zl=U(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"Qty",-1)),Hl={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Ll=U(()=>e("br",null,null,-1)),Ml={class:"text-sm"},El={ref:"to_move"},Ol=["data-index"],Yl={class:"cell"},Jl={class:"w-full h-full flex items-center justify-center"},Kl={class:"cell bold"},Ql={class:"w-full h-full flex items-center justify-center"},Gl={class:"cell"},Xl={class:"w-full h-full flex items-center justify-center"},Zl={class:"cell"},Wl={class:"w-full h-full flex items-center justify-center"},eo={class:"w-full px-0 py-2 2xl:pl-1 2xl:py-0 2xl:w-1/2 2xl:h-full 2xl:overflow-auto"},to={class:"w-full",role:"sticky"},so={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},lo=U(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"8",class:"!bg-slate-800 text-white font-bold"}," Detail PVR ")],-1)),oo={class:"sticky top-8 !z-[2]"},ao=U(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),no=U(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),co=U(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),io=U(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),uo=U(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),ro=U(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Amount",-1)),_o=U(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Qty",-1)),po={class:"min-w-[100px] !w-[100px] max-w-[100px]"},fo=U(()=>e("br",null,null,-1)),vo={class:"text-sm"},ho={ref:"to_move"},mo=["data-index"],wo={class:"w-full h-full flex items-center justify-center"},xo={class:"w-full h-full flex items-center justify-center"},yo={class:"w-full h-full flex items-center justify-center"},bo={key:0,class:"cell"},$o={class:"w-full h-full flex items-center justify-center"},go={class:"w-full h-full flex items-center justify-center"},ko={class:"cell"},jo={class:"w-full h-full flex items-center justify-center"},Ao={class:"w-full flex items-center justify-end"},Co={class:"w-full flex flex-wrap p-3 items-center"},To=U(()=>e("div",null," Di Validasi oleh : ",-1)),So={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},Do={key:0},qo={key:1},Io={__name:"ujalan_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},setup(h){const w=h,{$moment:z}=De(),{pointFormat:N}=ne(),a=_({...{id:-1,xto:"",tipe:"",jenis:"",harga:0,details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:""}}),A=_e("token"),J=_({}),l=_([]),n=_([]),H=async()=>{F().loading_full=!0,J.value={};const k=new FormData;let C="post",Y=w.id;Y==0||(k.append("id",Y),k.append("_method","PUT"));const{data:f,error:T,status:K}=await se("/ujalan_validasi",{method:C,headers:{Authorization:`Bearer ${A.value}`,Accept:"application/json"},body:k,retry:0});if(F().loading_full=!1,K.value==="error"){te().trigger(T,J);return}a.value.val=f.value.val,a.value.val_user=f.value.val_user,a.value.val_by=f.value.val_by,a.value.val_at=f.value.val_at,a.value.val1=f.value.val1,a.value.val1_user=f.value.val1_user,a.value.val1_by=f.value.val1_by,a.value.val1_at=f.value.val1_at;let y=w.p_data.map(v=>v.id).indexOf(w.id);y>=-1&&w.p_data.splice(y,1,{...a.value}),w.fnClose()},x=async()=>{F().loading_full=!0;const{data:k,error:C,status:Y}=await se("/ujalan_",{method:"get",headers:{Authorization:`Bearer ${A.value}`,Accept:"application/json"},params:{id:w.id},retry:0});if(F().loading_full=!1,Y.value==="error"){te().trigger(C);return}a.value=k.value.data,l.value=k.value.data.details,n.value=k.value.data.details2},D=re(()=>{let k=0;return n.value.forEach(C=>{C.p_status!="Remove"&&(k+=C.qty*C.amount)}),k}),B=re(()=>!1);return ge(()=>w.show,(k,C)=>{k==!0&&x()},{immediate:!0}),(k,C)=>{const Y=Ce;return M((o(),u("section",vl,[e("div",null,[S(Y,{title:"Form Ujalan Validation",fn:h.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",hl,[e("div",ml,[e("div",wl,[e("div",xl,[yl,e("div",bl,i(t(a).xto),1)]),e("div",$l,[gl,e("div",kl,i(t(a).tipe),1)]),e("div",jl,[Al,e("div",Cl,i(t(a).jenis),1)]),e("div",Tl,[Sl,e("div",Dl,i(t(N)(t(a).harga||0)),1)])]),e("div",ql,[e("div",Il,[e("div",Pl,[e("table",Ul,[e("thead",null,[Nl,e("tr",Vl,[Rl,Fl,Bl,zl,e("th",Hl,[ee("Total "),Ll,ee(),e("span",Ml,"("+i(t(N)(t(a).harga||0))+")",1)])])]),e("tbody",El,[(o(!0),u(Q,null,de(t(l),(f,T)=>(o(),u(Q,{key:T},[f.p_status!="Remove"?(o(),u("tr",{key:0,"data-index":T},[e("td",null,i(T+1)+".",1),e("td",Yl,[e("div",Jl,i(f.xdesc),1)]),e("td",Kl,[e("div",Ql,i(t(N)(f.harga||0)),1)]),e("td",Gl,[e("div",Xl,i(t(N)(f.qty||0)),1)]),e("td",Zl,[e("div",Wl,i(t(N)(f.qty*f.harga||0)),1)])],8,Ol)):I("",!0)],64))),128))],512)])])]),e("div",eo,[e("div",to,[e("table",so,[e("thead",null,[lo,e("tr",oo,[ao,no,co,io,uo,ro,_o,e("th",po,[ee("Total "),fo,ee(),e("span",vo,"("+i(t(N)(t(D)))+")",1)])])]),e("tbody",ho,[(o(!0),u(Q,null,de(t(n),(f,T)=>(o(),u(Q,{key:T},[f.p_status!="Remove"?(o(),u("tr",{key:0,"data-index":T},[e("td",null,i(T+1)+".",1),e("td",{class:L(["cell bold",t(B)?"unselectable":""])},[e("div",wo,i(f.ac_account_id),1)],2),e("td",{class:L(["cell bold",t(B)?"unselectable":""])},[e("div",xo,i(f.ac_account_code),1)],2),e("td",{class:L(["cell bold",t(B)?"unselectable":""])},[e("div",yo,i(f.ac_account_name),1)],2),t(B)?I("",!0):(o(),u("td",bo,[e("div",$o,i(f.description),1)])),e("td",{class:L(["cell bold",t(B)?"unselectable":""])},[e("div",go,i(t(N)(f.amount||0)),1)],2),e("td",{class:L(["cell",t(B)?"unselectable":""])},i(t(N)(f.qty||0)),3),e("td",ko,[e("div",jo,i(t(N)(f.qty*f.amount||0)),1)])],8,mo)):I("",!0)],64))),128))],512)])])])])]),e("div",Ao,[e("div",Co,[To,t(a).val||t(a).val1?(o(),u("div",So,[t(a).val?(o(),u("div",Do," App 1 : "+i(t(a).val_by.username)+" ( "+i(t(a).val_at?t(z)(t(a).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):I("",!0),t(a).val1?(o(),u("div",qo," App 2 : "+i(t(a).val1_by.username)+" ( "+i(t(a).val1_at?t(z)(t(a).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):I("",!0)])):I("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:C[0]||(C[0]=f=>h.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:C[1]||(C[1]=he(f=>H(),["prevent"]))}," Validasi ")])])])],512)),[[ke,h.show]])}}},Po=ve(Io,[["__scopeId","data-v-cd69c5e0"]]),Uo={class:"w-full h-full flex flex-col"},No={class:"w-full flex grow flex-col overflow-auto h-0"},Vo={class:"w-full flex"},Ro={action:"#",class:"w-full flex p-1"},Fo={class:"grow"},Bo=e("div",{class:"font-bold"}," Keyword ",-1),zo={class:"pl-1"},Ho=e("div",{class:"font-bold"}," Sort By ",-1),Lo=Fe('<option value=""></option><option value="id">ID</option><option value="xto">To</option><option value="jenis">Jenis</option><option value="tipe">Tipe</option>',5),Mo=[Lo],Eo={class:"pl-1"},Oo=e("div",{class:"font-bold"}," Sort Order ",-1),Yo=e("option",{value:"asc"},"Asc",-1),Jo=e("option",{value:"desc"},"Desc",-1),Ko=[Yo,Jo],Qo={class:"flex items-end pl-1"},Go={class:"w-full flex justify-center items-center grow h-0 p-1"},Xo={key:0,class:""},Zo={class:"tacky"},Wo=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"App 2"),e("th",null,"ID"),e("th",null,"To"),e("th",null,"Tipe"),e("th",null,"Jenis"),e("th",null,"Harga"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),ea=["onClick"],ta={class:"flex items-center justify-center"},sa={class:"flex items-center justify-center"},la={class:"bold"},ba={__name:"index",async setup(h){let w,z;const{$moment:N}=De(),{pointFormat:p}=ne(),a={};a._TimeZoneOffset=new Date().getTimezoneOffset(),a.sort="created_at:desc";const A=_e("token"),{data:J}=([w,z]=Ue(async()=>Re(async()=>{let b=[];F().loading_full=!0;const{data:$,error:q,status:m}=await se("/ujalan",{method:"get",headers:{Authorization:`Bearer ${A.value}`,Accept:"application/json"},params:a,retry:0});return F().loading_full=!1,m.value==="error"?(te().trigger(q),{ujalans:b}):(b=$.value.data,{ujalans:b})},"$SN3C927rLk")),w=await w,z(),w),l=_(J.value.ujalans),n=_(""),H=_({field:"created_at",by:"desc"}),x=_(-1),D=_({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),B=()=>{a.like="",n.value!=""&&(a.like=`id:%${n.value}%,xto:%${n.value}%,tipe:%${n.value}%,jenis:%${n.value}%,harga:%${n.value}%`),a.sort="",H.value.field&&(a.sort=H.value.field+":"+H.value.by)},k=_(null),C=async()=>{F().loading_full=!0,D.value.may_get_data=!1,a.page=D.value.page,a.page==1&&(l.value=[]),a.first_row&&delete a.first_row,a.page>1&&(a.first_row=JSON.stringify(l.value[0]));const{data:b,error:$,status:q}=await se("/ujalan",{method:"get",headers:{Authorization:`Bearer ${A.value}`,Accept:"application/json"},params:a,retry:0});if(F().loading_full=!1,D.value.may_get_data=!0,q.value==="error"){te().trigger($);return}D.value.page==1?(l.value=b.value.data,k.value&&(k.value.scrollTop=0)):D.value.page>1&&(l.value=[...l.value,...b.value.data]),b.value.data.length==0&&(D.value.is_last_record=!0)},Y=async()=>{if(!D.value.may_get_data)return;let b=k.value;if(b.scrollLeft!=D.value.scrollLeft){D.value.scrollLeft=b.scrollLeft;return}D.value.is_last_record||!(Math.round(b.scrollTop)+b.clientHeight>=b.scrollHeight-1)||(D.value.page++,await C())},f=()=>{D.value.page=1,D.value.is_last_record=!1,B(),C()};Ne();const T=_(!1),K=_(0),y=_(0),v=()=>{K.value=0,T.value=!0,y.value=!1},{display:g}=Te();Ve(Te());const W=()=>{x.value==-1?g({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(K.value=l.value[x.value].id,T.value=!0,y.value=!1)},R=()=>{x.value==-1?g({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(K.value=l.value[x.value].id,T.value=!0,y.value=!0)},E=_(!1),ce=_(0),me=()=>{x.value==-1?g({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(ce.value=l.value[x.value].id,E.value=!0)},fe=_({}),le=_(!1),we=async()=>{le.value&&(le.value=!1)},xe=()=>{x.value==-1?g({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(fe.value={id:l.value[x.value].id},le.value=!0)},ye=async()=>{F().loading_full=!0;const b=new FormData;b.append("id",l.value[x.value].id),b.append("_method","DELETE");const{data:$,error:q,status:m}=await se("/ujalan",{method:"post",headers:{Authorization:`Bearer ${A.value}`,Accept:"application/json"},body:b,retry:0});if(F().loading_full=!1,m.value==="error"){te().trigger(q);return}l.value.splice(x.value,1),x.value=-1,le.value=!1};return(b,$)=>{const q=Pe,m=tt,be=qe,c=Be,s=ze,G=He,O=Le,V=Ie,oe=Me,ae=Ee,ie=Oe,$e=fl,d=Po;return o(),u("div",Uo,[S(q,{title:"List Ujalan"}),e("div",No,[e("div",Vo,[("useUtils"in b?b.useUtils:t(ne))().checkRole(["PabrikTransport"])?I("",!0):(o(),u("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:$[0]||($[0]=r=>R())},[S(m)])),("useUtils"in b?b.useUtils:t(ne))().checkRole(["PabrikTransport"])?I("",!0):(o(),u("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:$[1]||($[1]=r=>v())},[S(be)])),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:$[2]||($[2]=r=>W())},[t(x)==-1||t(l)[t(x)].ref_id==null&&t(l)[t(x)].confirmed_by==null?(o(),X(c,{key:0})):(o(),X(s,{key:1}))]),("useUtils"in b?b.useUtils:t(ne))().checkRole(["PabrikTransport"])?I("",!0):(o(),u("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:$[3]||($[3]=r=>xe())},[S(G)])),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:$[4]||($[4]=r=>me())},[S(O)])]),e("form",Ro,[e("div",Fo,[Bo,M(e("input",{class:"",type:"text","onUpdate:modelValue":$[5]||($[5]=r=>Se(n)?n.value=r:null),name:"search",placeholder:"Keyword"},null,512),[[ue,t(n)]])]),e("div",zo,[Ho,M(e("select",{class:"","onUpdate:modelValue":$[6]||($[6]=r=>t(H).field=r)},Mo,512),[[pe,t(H).field]])]),e("div",Eo,[Oo,M(e("select",{class:"","onUpdate:modelValue":$[7]||($[7]=r=>t(H).by=r)},Ko,512),[[pe,t(H).by]])]),e("div",Qo,[e("button",{class:"",type:"submit",name:"button",onClick:$[8]||($[8]=he(r=>f(),["prevent"]))},[S(V,{class:"text-2xl"})])])]),e("div",Go,[t(l).length==0?(o(),u("div",Xo," Maaf Tidak Ada Record ")):(o(),u("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:k,onScroll:Y},[e("table",Zo,[Wo,e("tbody",null,[(o(!0),u(Q,null,de(t(l),(r,j)=>(o(),u("tr",{key:j,onClick:oa=>x.value=j,class:L(t(x)==j?"active":"")},[e("td",null,[e("div",ta,[r.val?(o(),X(ae,{key:1})):(o(),X(oe,{key:0}))])]),e("td",null,[e("div",sa,[r.val1?(o(),X(ae,{key:1})):(o(),X(oe,{key:0}))])]),e("td",la,i(r.id),1),e("td",null,i(r.xto),1),e("td",null,i(r.tipe),1),e("td",null,i(r.jenis),1),e("td",null,i(t(p)(r.harga)),1),e("td",null,i(r.created_at?t(N)(r.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,i(r.updated_at?t(N)(r.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,ea))),128))])])],544))])]),S(ie,{type:"delete",show:t(le),data:t(fe),fnClose:we,fnConfirm:ye},null,8,["show","data"]),S($e,{show:t(T),fnClose:()=>{T.value=!1},id:t(K),p_data:t(l),is_copy:t(y)},null,8,["show","fnClose","id","p_data","is_copy"]),S(d,{show:t(E),fnClose:()=>{E.value=!1},id:t(ce),p_data:t(l)},null,8,["show","fnClose","id","p_data"])])}}};export{ba as default};
