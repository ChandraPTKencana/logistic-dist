import{_ as G}from"./HeaderPopup.vue.3ed81de8.js";import{_ as K}from"./WidthMiniPart.vue.e64b7a82.js";import W from"./AttachmentSingle.b235eb2a.js";import Q from"./CaretTop.bdb39f13.js";import X from"./CaretDown.885193a1.js";import{r as p,f as Z,P as ee,G as O,j as te,m as se,J as ae,o as d,c as _,a as e,b as h,t as o,k as s,F as L,y as le,l as m,x as oe,d as ne,E as ie,A as S,B as q,p as re,e as de}from"./entry.bfc4a585.js";import{u as _e}from"./useUtils.e5d08feb.js";import{u as J}from"./useMyFetch.f0cb27d3.js";import{_ as ce}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.0568650d.js";import"./PDFJsView.d7228ffe.js";const n=c=>(re("data-v-e4561e5a"),c=c(),de(),c),ve={class:"box-fixed"},ue={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},fe={class:"w-full flex flex-col items-center grow overflow-auto"},pe={class:"w-full flex flex-row flex-wrap"},me={class:"w-full sm:w-9/12 flex px-2 py-3"},we={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},xe=n(()=>e("div",{class:"absolute bg-white -top-3"}," Standby ",-1)),he={class:"w-6/12 sm:w-2/12 flex flex-col flex-wrap p-1"},be=n(()=>e("label",{for:""},"ID",-1)),ye={class:"card-border"},ke={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},ge=n(()=>e("label",{for:""},"Name",-1)),Se={class:"card-border"},De={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Ne=n(()=>e("label",{for:""},"Type",-1)),Ie={class:"card-border"},Ce={class:"w-6/12 sm:w-2/12 flex flex-col flex-wrap p-1"},Ae=n(()=>e("label",{for:""},"Amount",-1)),Ye={class:"card-border"},Te={class:"w-full sm:w-3/12 flex px-2 py-3"},$e={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative items-end"},Fe=n(()=>e("div",{class:"absolute bg-white -top-3"}," Peralihan ",-1)),Pe={class:"w-6/12 flex flex-col flex-wrap p-1"},Be={class:"card-border"},Me={class:"w-6/12 flex flex-col flex-wrap p-1"},Ve={class:"card-border"},Ee={class:"w-full flex flex-wrap"},Re={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},je=n(()=>e("label",{for:""},"Supir",-1)),He={class:"card-border"},Oe={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Le=n(()=>e("label",{for:""},"Kernet",-1)),qe={class:"card-border"},Je={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ze=n(()=>e("label",{for:""},"No Pol",-1)),Ue={class:"card-border"},Ge={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ke=n(()=>e("label",{for:""},"Tujuan",-1)),We={class:"card-border"},Qe={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Xe=n(()=>e("label",{for:""},"Note For Remarks",-1)),Ze={class:"card-border"},et={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},tt=n(()=>e("label",{for:""},"Referensi",-1)),st={class:"card-border"},at={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},lt={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},ot=n(()=>e("div",{class:"absolute bg-white -top-3"}," Cost Center ",-1)),nt={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},it=n(()=>e("label",{for:""}," Code",-1)),rt={class:"card-border"},dt={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},_t=n(()=>e("label",{for:""},"Desc",-1)),ct={class:"card-border disabled"},vt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},ut={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},ft=n(()=>e("div",{class:"absolute bg-white -top-3"}," PVR ",-1)),pt={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},mt=n(()=>e("label",{for:""},"No",-1)),wt={class:"card-border disabled"},xt={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},ht=n(()=>e("label",{for:""},"Total",-1)),bt={class:"card-border disabled"},yt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},kt={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},gt=n(()=>e("div",{class:"absolute bg-white -top-3"}," PV ",-1)),St={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},Dt=n(()=>e("label",{for:""},"No",-1)),Nt={class:"card-border disabled"},It={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Ct=n(()=>e("label",{for:""},"Total",-1)),At={class:"card-border disabled"},Yt={class:"w-full flex grow p-1 overflow-auto 2xl:overflow-hidden justify-between flex-wrap"},Tt={class:"w-full",role:"sticky"},$t={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},Ft={class:"sticky -top-1 !z-[2]"},Pt=["colspan"],Bt=n(()=>e("tr",{class:"sticky top-7 !z-[2]"},[e("th",{class:"!min-w-[50px] !w-[50px] !max-w-[50px]"},"No"),e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Tanggal"),e("th",{class:"!min-w-[200px] !w-[200px] !max-w-[200px]"},"Foto")],-1)),Mt={ref:"to_move"},Vt=["data-index"],Et={class:"cell"},Rt={class:"w-full h-full flex items-center justify-center relative"},jt={class:"cell"},Ht={style:{width:"70vw"},class:"h-full flex items-center justify-center"},Ot={class:"w-full flex items-center justify-end"},Lt={class:"w-full flex flex-wrap p-3 items-center"},qt=n(()=>e("div",null," Di Validasi oleh : ",-1)),Jt={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},zt={key:0},Ut={key:1},Gt={key:2},Kt={key:0,class:"text-xs font-bold"},Wt={__name:"standby_trx_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},emits:["setID","setIndex"],setup(c,{emit:b}){const r=c,{$moment:y}=ie(),{pointFormat:D}=_e(),F={id:-1,transition_target:"",transition_type:"",standby_mst_id:"",standby_mst_:{name:"",tipe:"",amount:0},supir:"",kernet:"",no_pol:"",xto:"",note_for_remarks:"",ref:"",cost_center_code:"",cost_center_desc:"",pvr_id:"",pvr_no:"",pvr_total:0,pvr_had_detail:0,pv_id:"",pv_no:"",pv_total:0,pv_datetime:"",rv_id:"",rv_no:"",rv_total:0,rv_had_detail:"",details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:""},t=p({...F}),P=Z("token"),B=p({}),M=p(null),N=p([]),V={_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:-1,name:"",title:""};let I=l=>{l.key=="ArrowUp"&&R(),l.key=="ArrowDown"&&E()};ee(()=>{document.removeEventListener("keydown",I)});const u=p(JSON.parse(JSON.stringify(V))),f=p(JSON.parse(JSON.stringify(V))),w=p(""),z=async()=>{w.value="PROSES...",S().loading_full=!0,B.value={};const l=new FormData;let i="post",x=r.id;x==0||(l.append("id",x),l.append("_method","PUT"));const{data:a,error:A,status:Y}=await J("/standby_trx_validasi",{method:i,headers:{Authorization:`Bearer ${P.value}`,Accept:"application/json"},body:l,retry:0});if(S().loading_full=!1,Y.value==="error"){w.value="GAGAL",q().trigger(A,B);return}t.value.val=a.value.val,t.value.val_user=a.value.val_user,t.value.val_by=a.value.val_by,t.value.val_at=a.value.val_at,t.value.val1=a.value.val1,t.value.val1_user=a.value.val1_user,t.value.val1_by=a.value.val1_by,t.value.val1_at=a.value.val1_at,t.value.val2=a.value.val2,t.value.val2_user=a.value.val2_user,t.value.val2_by=a.value.val2_by,t.value.val2_at=a.value.val2_at;let k=r.p_data.map(g=>g.id).indexOf(r.id);k>=-1&&r.p_data.splice(k,1,{...t.value}),w.value="BERHASIL"},C=async()=>{w.value="",S().loading_full=!0;const{data:l,error:i,status:x}=await J("/standby_trx",{method:"get",headers:{Authorization:`Bearer ${P.value}`,Accept:"application/json"},params:{id:r.id},retry:0});if(S().loading_full=!1,x.value==="error"){q().trigger(i);return}let a=l.value.data;t.value=a,u.value._.id.val=a.supir_id,u.value._.name.val=a.supir,u.value._.rek_no.val=a.supir_rek_no,u.value._.rek_name.val=a.supir_rek_name,u.value.id=a.supir_id,u.value.name=a.supir,u.value.rek_no=(a.supir_rek_no||"")+" "+(a.supir_rek_name||""),f.value._.id.val=a.kernet_id,f.value._.name.val=a.kernet,f.value._.rek_no.val=a.kernet_rek_no,f.value._.rek_name.val=a.kernet_rek_name,f.value.id=a.kernet_id,f.value.name=a.kernet,f.value.rek_no=(a.kernet_rek_no||"")+" "+(a.kernet_rek_name||""),N.value=l.value.data.details};O(()=>{let l=0;return N.value.forEach(i=>{i.p_status!="Remove"&&(l+=i.amount)}),l});const U=O(()=>!1);te(()=>r.show,(l,i)=>{l==!0?(document.addEventListener("keydown",I),t.value={...F},r.is_view==!1&&setTimeout(()=>{M.value.focus()},1),C()):document.removeEventListener("keydown",I)},{immediate:!0});const E=()=>{let l=r.p_data.map(i=>i.id).indexOf(r.id);l!=r.p_data.length-1&&(l++,b("setID",r.p_data[l].id),b("setIndex",l),setTimeout(()=>{C()},100))},R=()=>{let l=r.p_data.map(i=>i.id).indexOf(r.id);l!=0&&(l--,b("setID",r.p_data[l].id),b("setIndex",l),setTimeout(()=>{C()},100))};return(l,i)=>{var g,j,H;const x=G,a=K,A=W,Y=Q,k=X;return se((d(),_("section",ve,[e("div",null,[h(x,{title:"Form Transaction Standby Validation",fn:c.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",ue,[e("div",fe,[e("div",pe,[e("div",me,[e("div",we,[xe,e("div",he,[be,e("div",ye,o(s(t).standby_mst_id),1)]),e("div",ke,[ge,e("div",Se,o((g=s(t).standby_mst_)==null?void 0:g.name),1)]),e("div",De,[Ne,e("div",Ie,o((j=s(t).standby_mst_)==null?void 0:j.tipe),1)]),e("div",Ce,[Ae,e("div",Ye,o(s(D)((H=s(t).standby_mst_)==null?void 0:H.amount)),1)])])]),e("div",Te,[e("div",$e,[Fe,e("div",Pe,[e("div",Be,o(s(t).transition_type),1)]),e("div",Me,[e("div",Ve,o(s(t).transition_target),1)])])]),e("div",Ee,[e("div",Re,[je,e("div",He,[h(a,{selected:s(u)},null,8,["selected"])])]),e("div",Oe,[Le,e("div",qe,[h(a,{selected:s(f)},null,8,["selected"])])]),e("div",Je,[ze,e("div",Ue,o(s(t).no_pol),1)]),e("div",Ge,[Ke,e("div",We,o(s(t).xto),1)]),e("div",Qe,[Xe,e("div",Ze,o(s(t).note_for_remarks),1)]),e("div",et,[tt,e("div",st,o(s(t).ref),1)])]),e("div",at,[e("div",lt,[ot,e("div",nt,[it,e("div",rt,o(s(t).cost_center_code),1)]),e("div",dt,[_t,e("div",ct,o(s(t).cost_center_desc),1)])])]),e("div",vt,[e("div",ut,[ft,e("div",pt,[mt,e("div",wt,o(s(t).pvr_no),1)]),e("div",xt,[ht,e("div",bt,o(s(D)(s(t).pvr_total||0)),1)])])]),e("div",yt,[e("div",kt,[gt,e("div",St,[Dt,e("div",Nt,o(s(t).pv_no),1)]),e("div",It,[Ct,e("div",At,o(s(D)(s(t).pv_total)),1)])])]),e("div",Yt,[e("div",Tt,[e("table",$t,[e("thead",null,[e("tr",Ft,[e("td",{colspan:s(U)?3:4,class:"!bg-slate-800 text-white font-bold"}," Detail Transaction ",8,Pt)]),Bt]),e("tbody",Mt,[(d(!0),_(L,null,le(s(N),(v,T)=>(d(),_(L,{key:T},[v.p_status!="Remove"?(d(),_("tr",{key:0,"data-index":T},[e("td",null,o(T+1)+".",1),e("td",Et,[e("div",Rt,o(s(y)(v.tanggal).format("DD-MM-YYYY")),1)]),e("td",jt,[e("div",Ht,[h(A,{value:v.attachment_1_preview,onSetFile:$=>v.attachment_1=$,onSetPreview:$=>v.attachment_1_preview=$},null,8,["value","onSetFile","onSetPreview"])])])],8,Vt)):m("",!0)],64))),128))],512)])])])])]),e("div",Ot,[e("div",Lt,[qt,s(t).val||s(t).val1||s(t).val2?(d(),_("div",Jt,[s(t).val?(d(),_("div",zt," App 1 : "+o(s(t).val_by.username)+" ( "+o(s(t).val_at?s(y)(s(t).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0),s(t).val1?(d(),_("div",Ut," App 2 : "+o(s(t).val1_by.username)+" ( "+o(s(t).val1_at?s(y)(s(t).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0),s(t).val2?(d(),_("div",Gt," App 3 : "+o(s(t).val2_by.username)+" ( "+o(s(t).val2_at?s(y)(s(t).val2_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0)])):m("",!0)]),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:i[0]||(i[0]=v=>R())},[h(Y,{class:"black"})]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:i[1]||(i[1]=v=>c.fnClose())}," Cancel "),c.is_view==0?(d(),_("button",{key:0,ref_key:"it_val",ref:M,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:i[2]||(i[2]=oe(v=>z(),["prevent"]))},[ne(" Validasi "),s(w)!=""?(d(),_("div",Kt,o(s(w)),1)):m("",!0)],512)):m("",!0),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:i[3]||(i[3]=v=>E())},[h(k,{class:"black"})])])])])],512)),[[ae,c.show]])}}},rs=ce(Wt,[["__scopeId","data-v-e4561e5a"]]);export{rs as default};
