import{_ as R}from"./HeaderPopup.vue.b19d26e8.js";import P from"./Times.cb5a38a5.js";import E from"./Check.1e1ad8aa.js";import{r as w,g as J,i as z,f as K,k as O,K as Q,o as r,c as u,a as e,b as G,t as a,l as t,d as k,F as j,D as B,E as x,z as S,n as m,C as U,G as L,x as y,y as q,p as W,e as X}from"./entry.19c3f304.js";import{u as Z}from"./useUtils.cb2458f0.js";import{u as F}from"./useMyFetch.24b221a4.js";import{_ as ee}from"./_plugin-vue_export-helper.c27b6911.js";const o=f=>(W("data-v-5b5d2859"),f=f(),X(),f),te={class:"box-fixed"},se={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},le={class:"w-full flex flex-col items-center grow overflow-auto"},ae={class:"w-full flex flex-row flex-wrap"},oe={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ne=o(()=>e("label",{for:""},"To",-1)),ce={class:"card-border"},ie={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},re=o(()=>e("label",{for:""},"Jenis",-1)),de={class:"card-border"},_e={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ue=o(()=>e("label",{for:""},"Harga",-1)),fe={class:"card-border"},ve={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},pe=o(()=>e("label",{for:""},"Asal Peralihan",-1)),me={class:"card-border"},he={class:"w-full sm:w-4/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},xe=o(()=>e("label",{for:""},"Tipe",-1)),we={class:"card-border"},ye={class:"w-full sm:w-4/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},be=o(()=>e("label",{for:""},"Ket. Untuk Remarks",-1)),ge={class:"card-border"},ke={class:"w-full flex flex-col sm:flex-row grow p-1 justify-between flex-wrap 2xl:overflow-hidden"},je={class:"w-full p-0 2xl:pr-1 2xl:w-1/2 2xl:h-full 2xl:overflow-auto"},Ce={class:"w-full",role:"sticky"},De={class:"tacky w-full",style:{"white-space":"normal"}},Ae=o(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"6",class:"!bg-slate-800 text-white font-bold"}," Detail Uang Jalan ")],-1)),qe={class:"sticky top-8 !z-[2]"},Fe=o(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),Ve=o(()=>e("th",null,"Desc",-1)),Ne=o(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Harga @",-1)),Te=o(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"Qty",-1)),$e={class:"min-w-[100px] !w-[100px] max-w-[100px]"},ze=o(()=>e("br",null,null,-1)),Be={class:"text-sm"},Se=o(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"For Remarks",-1)),Ue={ref:"to_move"},Ye=["data-index"],He={class:"cell"},Ie={class:"w-full h-auto flex items-center justify-center"},Me={class:"cell bold"},Re={class:"w-full h-auto flex items-center justify-center"},Pe={class:"cell"},Ee={class:"w-full h-auto flex items-center justify-center"},Je={class:"cell"},Ke={class:"w-full h-auto flex items-center justify-center"},Oe={class:"cell"},Qe={class:"w-full h-auto flex items-center justify-center"},Ge={class:"w-full px-0 py-2 2xl:pl-1 2xl:py-0 2xl:w-1/2 2xl:h-full 2xl:overflow-auto"},Le={class:"w-full",role:"sticky"},We={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},Xe=o(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"9",class:"!bg-slate-800 text-white font-bold"}," Detail PVR ")],-1)),Ze={class:"sticky top-8 !z-[2]"},et=o(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),tt=o(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),st=o(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),lt=o(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),at=o(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),ot=o(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Amount",-1)),nt=o(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Qty",-1)),ct=o(()=>e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"For",-1)),it={class:"min-w-[100px] !w-[100px] max-w-[100px]"},rt=o(()=>e("br",null,null,-1)),dt={class:"text-sm"},_t={ref:"to_move"},ut=["data-index"],ft={class:"w-full h-auto flex items-center justify-center"},vt={class:"w-full h-auto flex items-center justify-center"},pt={class:"w-full h-auto flex items-center justify-center"},mt={key:0,class:"cell"},ht={class:"w-full h-auto flex items-center justify-center"},xt={class:"w-full h-auto flex items-center justify-center"},wt={class:"cell"},yt={class:"w-full h-auto flex items-center justify-center"},bt={class:"w-full flex items-center justify-end"},gt={class:"w-full flex flex-wrap p-3 items-center"},kt=o(()=>e("div",null," Di Validasi oleh : ",-1)),jt={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},Ct={key:0},Dt={key:1},At={__name:"ujalan_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},it_state:{type:Number,required:!1,default:-1}},setup(f){const d=f,{$moment:V}=L(),{pointFormat:v}=Z(),s=w({...{id:-1,xto:"",tipe:"",jenis:"",harga:0,note_for_remarks:0,details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:""}}),C=J("token"),g=w({}),N=w(null),T=w(null),$=w([]),D=w([]),Y=async()=>{y().loading_full=!0,g.value={};const c=new FormData;let i="post",p=d.id;p==0||(c.append("id",p),c.append("_method","PUT"));const{data:n,error:b,status:l}=await F("/ujalan_validasi",{method:i,headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},body:c,retry:0});if(y().loading_full=!1,l.value==="error"){q().trigger(b,g);return}s.value.val=n.value.val,s.value.val_user=n.value.val_user,s.value.val_by=n.value.val_by,s.value.val_at=n.value.val_at,s.value.val1=n.value.val1,s.value.val1_user=n.value.val1_user,s.value.val1_by=n.value.val1_by,s.value.val1_at=n.value.val1_at;let _=d.p_data.map(A=>A.id).indexOf(d.id);_>=-1&&d.p_data.splice(_,1,{...s.value}),d.fnClose()},H=async()=>{y().loading_full=!0,g.value={};const c=new FormData;let i="post",p=d.id;p==0||(c.append("id",p),c.append("_method","PUT"));const{data:n,error:b,status:l}=await F("/ujalan_unvalidasi",{method:i,headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},body:c,retry:0});if(y().loading_full=!1,l.value==="error"){q().trigger(b,g);return}s.value.val=n.value.val,s.value.val_user=n.value.val_user,s.value.val_by=n.value.val_by,s.value.val_at=n.value.val_at,s.value.val1=n.value.val1,s.value.val1_user=n.value.val1_user,s.value.val1_by=n.value.val1_by,s.value.val1_at=n.value.val1_at;let _=d.p_data.map(A=>A.id).indexOf(d.id);_>=-1&&d.p_data.splice(_,1,{...s.value}),d.fnClose()},I=async()=>{y().loading_full=!0;const{data:c,error:i,status:p}=await F("/ujalan_",{method:"get",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},params:{id:d.id},retry:0});if(y().loading_full=!1,p.value==="error"){q().trigger(i);return}s.value=c.value.data,$.value=c.value.data.details,D.value=c.value.data.details2},M=z(()=>{let c=0;return D.value.forEach(i=>{i.p_status!="Remove"&&(c+=i.qty*i.amount)}),c}),h=z(()=>!1);return K(()=>d.show,(c,i)=>{c==!0&&(d.it_state==1&&setTimeout(()=>{N.value.focus()},1),d.it_state==0&&setTimeout(()=>{T.value.focus()},1),I())},{immediate:!0}),(c,i)=>{const p=R,n=P,b=E;return O((r(),u("section",te,[e("div",null,[G(p,{title:"Form Ujalan Validation",fn:f.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",se,[e("div",le,[e("div",ae,[e("div",oe,[ne,e("div",ce,a(t(s).xto),1)]),e("div",ie,[re,e("div",de,a(t(s).jenis),1)]),e("div",_e,[ue,e("div",fe,a(t(v)(t(s).harga||0)),1)]),e("div",ve,[pe,e("div",me,a(t(s).transition_from),1)]),e("div",he,[xe,e("div",we,a(t(s).tipe),1)]),e("div",ye,[be,e("div",ge,a(t(s).note_for_remarks),1)])]),e("div",ke,[e("div",je,[e("div",Ce,[e("table",De,[e("thead",null,[Ae,e("tr",qe,[Fe,Ve,Ne,Te,e("th",$e,[k("Total "),ze,k(),e("span",Be,"("+a(t(v)(t(s).harga||0))+")",1)]),Se])]),e("tbody",Ue,[(r(!0),u(j,null,B(t($),(l,_)=>(r(),u(j,{key:_},[l.p_status!="Remove"?(r(),u("tr",{key:0,"data-index":_},[e("td",null,a(_+1)+".",1),e("td",He,[e("div",Ie,a(l.xdesc),1)]),e("td",Me,[e("div",Re,a(t(v)(l.harga||0)),1)]),e("td",Pe,[e("div",Ee,a(t(v)(l.qty||0)),1)]),e("td",Je,[e("div",Ke,a(t(v)(l.qty*l.harga||0)),1)]),e("td",Oe,[e("div",Qe,[e("div",{class:x(["text-white rounded text-xl w-5 h-5",l.for_remarks?"bg-green-600":"bg-red-600"])},[l.for_remarks==0?(r(),S(n,{key:0})):(r(),S(b,{key:1}))],2)])])],8,Ye)):m("",!0)],64))),128))],512)])])]),e("div",Ge,[e("div",Le,[e("table",We,[e("thead",null,[Xe,e("tr",Ze,[et,tt,st,lt,at,ot,nt,ct,e("th",it,[k("Total "),rt,k(),e("span",dt,"("+a(t(v)(t(M)))+")",1)])])]),e("tbody",_t,[(r(!0),u(j,null,B(t(D),(l,_)=>(r(),u(j,{key:_},[l.p_status!="Remove"?(r(),u("tr",{key:0,"data-index":_},[e("td",null,a(_+1)+".",1),e("td",{class:x(["cell bold",t(h)?"unselectable":""])},[e("div",ft,a(l.ac_account_id),1)],2),e("td",{class:x(["cell bold",t(h)?"unselectable":""])},[e("div",vt,a(l.ac_account_code),1)],2),e("td",{class:x(["cell bold",t(h)?"unselectable":""])},[e("div",pt,a(l.ac_account_name),1)],2),t(h)?m("",!0):(r(),u("td",mt,[e("div",ht,a(l.description),1)])),e("td",{class:x(["cell bold",t(h)?"unselectable":""])},[e("div",xt,a(t(v)(l.amount||0)),1)],2),e("td",{class:x(["cell",t(h)?"unselectable":""])},a(t(v)(l.qty||0)),3),e("td",{class:x(["cell",t(h)?"unselectable":""])},a(l.xfor),3),e("td",wt,[e("div",yt,a(t(v)(l.qty*l.amount||0)),1)])],8,ut)):m("",!0)],64))),128))],512)])])])])]),e("div",bt,[e("div",gt,[kt,t(s).val||t(s).val1?(r(),u("div",jt,[t(s).val?(r(),u("div",Ct," App 1 : "+a(t(s).val_by.username)+" ( "+a(t(s).val_at?t(V)(t(s).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0),t(s).val1?(r(),u("div",Dt," App 2 : "+a(t(s).val1_by.username)+" ( "+a(t(s).val1_at?t(V)(t(s).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0)])):m("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:i[0]||(i[0]=l=>f.fnClose())}," Cancel "),f.it_state==1?(r(),u("button",{key:0,ref_key:"it_val",ref:N,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:i[1]||(i[1]=U(l=>Y(),["prevent"]))}," Validasi ",512)):m("",!0),f.it_state==0?(r(),u("button",{key:1,ref_key:"it_unval",ref:T,type:"submit",name:"button",class:"w-36 m-1 bg-yellow-600 text-white rounded-sm",onClick:i[2]||(i[2]=U(l=>H(),["prevent"]))}," Unvalidasi ",512)):m("",!0)])])])],512)),[[Q,f.show]])}}},St=ee(At,[["__scopeId","data-v-5b5d2859"]]);export{St as default};
