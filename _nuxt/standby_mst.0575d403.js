import{_ as oe}from"./HeaderPopup.vue.ff9da216.js";import le from"./Tools.6d48a1a7.js";import ae from"./Times.75e4d24e.js";import{_ as ne}from"./InputPointFormat.vue.7d62a7a6.js";import ce from"./Plus.e9db1a54.js";import ie from"./ToolsPopup.369707be.js";import ue from"./ac_accs.83031d48.js";import{r as h,h as z,K,I as de,o as u,c as _,n as g,v as _e,a as e,b as S,m as t,q as F,t as p,O as re,G as y,d as R,F as T,D as pe,E as C,J as me,C as fe,s as ve,x as j,y as L,p as he,e as we}from"./entry.026e5532.js";import{u as xe}from"./useUtils.7a44f3e9.js";import{u as O}from"./useMyFetch.f0db4149.js";import{_ as be}from"./_plugin-vue_export-helper.c27b6911.js";import"./Search.014ca2ec.js";const d=f=>(he("data-v-80fc7397"),f=f(),we(),f),ye={class:"box-fixed"},ke={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},ge={class:"w-full flex flex-col items-center grow overflow-auto"},Se={class:"w-full flex flex-row flex-wrap"},Ce={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ae=d(()=>e("label",{for:""},"Name",-1)),Ie=["disabled"],Ne={class:"text-red-500"},je={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ve=d(()=>e("label",{for:""},"Tipe",-1)),qe=["disabled"],Fe={class:"text-red-500"},Te={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ue=d(()=>e("label",{for:""},"Amount",-1)),Be={class:"card-border disabled"},De={class:"text-red-500"},Pe={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},$e=d(()=>e("label",{for:""},"Peralihan?",-1)),Ee={class:"card-border !flex flex-row items-center"},Me=["checked"],ze={for:"checkbox",class:"w-full ml-1"},Ke={class:"text-red-500"},Re={class:"w-full flex p-1 2xl:overflow-hidden justify-between flex-wrap"},Le={class:"w-full",role:"sticky"},Oe={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},Ge={class:"sticky -top-1 !z-[2]"},Je=["colspan"],Ye={class:"sticky top-7 !z-[2]"},He={key:0,class:"min-w-[30px] !w-[30px] max-w-[30px]"},Xe=d(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),Qe={key:1,class:"min-w-[30px] !w-[30px] max-w-[30px]"},We=d(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),Ze=d(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),et=d(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),tt=d(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),st={class:"min-w-[100px] !w-[100px] max-w-[100px]"},ot=d(()=>e("br",null,null,-1)),lt={class:"text-sm"},at=d(()=>e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"For",-1)),nt={ref:"to_move"},ct=["data-index"],it={key:0,class:"tools cell"},ut={class:"w-full h-full flex items-center justify-center"},dt=["onClick"],_t={key:1,class:"cell"},rt={class:"w-full h-full flex items-center justify-center"},pt=["onClick"],mt=["onClick","disabled"],ft={class:"w-full h-full flex items-center justify-center"},vt={class:"w-full h-full flex items-center justify-center"},ht={class:"w-full h-full flex items-center justify-center"},wt={class:"cell"},xt={class:"w-full h-full flex items-center justify-center"},bt=["disabled","onUpdate:modelValue"],yt={class:"w-full h-full flex items-center justify-center"},kt={class:"w-full h-full flex items-center justify-center"},gt=["onUpdate:modelValue","disabled"],St=d(()=>e("option",{value:"Supir"},"Supir",-1)),Ct=d(()=>e("option",{value:"Kernet"},"Kernet",-1)),At=[St,Ct],It={key:0},Nt={class:"tools cell"},jt={class:"w-full flex items-center justify-end"},Vt={__name:"standby_mst",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(f){const m=f,{pointFormat:U}=xe(),B={id:-1,name:"",tipe:"",amount:0,is_transition:0,details:[]},l=h({...B}),D=z("token"),k=h({});h([{xdesc:"Gaji Kernet",qty:1,harga:0},{xdesc:"U.Extrafooding",qty:1,harga:2e4}]);const a=h([]),P=h({ordinal:0,id:-1,ac_account_id:"",ac_account_name:"",ac_account_code:"",description:"",amount:0,xfor:"",p_status:""}),A=h(!1),G=()=>{A.value=!1},J=o=>{a.value[i.value].ac_account_id=o.ac_account_id,a.value[i.value].ac_account_code=o.ac_account_code,a.value[i.value].ac_account_name=o.ac_account_name,A.value=!1},Y=(o,s)=>{i.value=s,A.value=!0},H=(o,s)=>{a.value[s].ac_account_id="",a.value[s].ac_account_code="",a.value[s].ac_account_name=""},X=async()=>{j().loading_full=!0,k.value={};const o=new FormData;o.append("name",l.value.name),o.append("tipe",l.value.tipe),o.append("is_transition",l.value.is_transition),o.append("amount",l.value.amount),o.append("details",JSON.stringify(a.value));let s="post",w=m.is_copy?0:m.id;w==0||(o.append("id",w),o.append("_method","PUT"));const{data:v,error:x,status:V}=await O("/standby_mst",{method:s,headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},body:o,retry:0});if(j().loading_full=!1,V.value==="error"){L().trigger(x,k);return}if(w<=0)l.value.id=v.value.id,l.value.created_at=v.value.created_at,l.value.updated_at=v.value.updated_at,m.p_data.unshift(l.value);else{l.value.updated_at=v.value.updated_at;let N=m.p_data.map(q=>q.id).indexOf(w);N>=-1&&m.p_data.splice(N,1,{...l.value})}m.fnClose()},$=K(()=>{let o=0;return a.value.forEach(s=>{s.p_status!="Remove"&&(o+=1*s.amount)}),l.value.amount=o,o}),i=h(-1),I=h(!1),E=h({left:0,top:0}),Q=(o,s)=>{i.value=s,I.value=!0,E.value={left:o.clientX,top:o.clientY}},W=()=>{a.value.push({...P.value,p_status:"Add"})},Z=()=>{I.value=!1},ee=(o="")=>{if(o=="insert")a.value.splice(i.value,0,{...P.value,p_status:"Add"});else if(o=="delete")a.value[i.value].p_status=="Edit"?a.value[i.value].p_status="Remove":a.value.splice(i.value,1);else if(o=="move_top"){let s=a.value[i.value];a.value.splice(i.value,1),a.value.splice(i.value-1,0,{...s})}else if(o=="move_bottom"){let s=a.value[i.value];a.value.splice(i.value,1),a.value.splice(i.value+1,0,{...s})}I.value=!1},M=z("role"),c=K(()=>l.value.val&&l.value.val1||M.value=="Logistic"&&l.value.val||M.value=="PabrikTransport"&&l.value.val1),te=async()=>{j().loading_full=!0;const{data:o,error:s,status:w}=await O("/standby_mst",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},params:{id:m.id},retry:0});if(j().loading_full=!1,w.value==="error"){L().trigger(s);return}l.value=o.value.data;let v="Edit";m.is_copy&&(v="Add",l.value.val=0,l.value.val1=0),a.value=o.value.data.details.map(x=>(x.p_status=v,x.key=x.ordinal,x))};return de(()=>m.show,(o,s)=>{o==!0&&(l.value={...B},a.value=[],m.id!=0&&te())},{immediate:!0}),(o,s)=>{const w=oe,v=le,x=ae,V=ne,N=ce,q=ie,se=ue;return u(),_(T,null,[g(e("section",ye,[e("div",null,[S(w,{title:"Form StandBy Mst",fn:f.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",ke,[e("div",ge,[e("div",Se,[e("div",Ce,[Ae,g(e("input",{"onUpdate:modelValue":s[0]||(s[0]=n=>t(l).name=n),disabled:t(c)},null,8,Ie),[[F,t(l).name]]),e("p",Ne,p(t(k).name),1)]),e("div",je,[Ve,g(e("input",{"onUpdate:modelValue":s[1]||(s[1]=n=>t(l).tipe=n),disabled:t(c)},null,8,qe),[[F,t(l).tipe]]),e("p",Fe,p(t(k).tipe),1)]),e("div",Te,[Ue,e("div",Be,p(t(U)(t($))),1),e("p",De,p(t(k).amount),1)]),e("div",Pe,[$e,e("div",Ee,[g(e("input",{id:"checkbox",checked:t(l).is_transition,"onUpdate:modelValue":s[2]||(s[2]=n=>t(l).is_transition=n),type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded"},null,8,Me),[[re,t(l).is_transition]]),e("label",ze,p(t(l).is_transition?"Ya":"Tidak"),1)]),e("p",Ke,p(t(k).is_transition),1)])]),e("div",Re,[e("div",Le,[e("table",Oe,[e("thead",null,[e("tr",Ge,[e("td",{colspan:t(c)?7:9,class:"!bg-slate-800 text-white font-bold"}," Detail ",8,Je)]),e("tr",Ye,[t(c)?y("",!0):(u(),_("th",He)),Xe,t(c)?y("",!0):(u(),_("th",Qe)),We,Ze,et,tt,e("th",st,[R("Amount "),ot,R(),e("span",lt,"("+p(t(U)(t($)))+")",1)]),at])]),e("tbody",nt,[(u(!0),_(T,null,pe(t(a),(n,b)=>(u(),_(T,{key:b},[n.p_status!="Remove"?(u(),_("tr",{key:0,"data-index":b},[t(c)?y("",!0):(u(),_("td",it,[e("div",ut,[e("button",{type:"button",name:"button",onClick:r=>Q(r,b)},[S(v)],8,dt)])])),e("td",null,p(b+1)+".",1),t(c)?y("",!0):(u(),_("td",_t,[e("div",rt,[n.ac_account_id?(u(),_("button",{key:1,type:"button",onClick:r=>H(r,b),disabled:n.confirm_by},[S(x,{class:"font-bold text-2xl"})],8,mt)):(u(),_("button",{key:0,type:"button",name:"button",onClick:r=>Y(r,b)}," ... ",8,pt))])])),e("td",{class:C(["cell bold",t(c)?"unselectable":""])},[e("div",ft,p(n.ac_account_id),1)],2),e("td",{class:C(["cell bold",t(c)?"unselectable":""])},[e("div",vt,p(n.ac_account_code),1)],2),e("td",{class:C(["cell bold",t(c)?"unselectable":""])},[e("div",ht,p(n.ac_account_name),1)],2),e("td",wt,[e("div",xt,[g(e("textarea",{disabled:t(c),class:"p-1 w-full","onUpdate:modelValue":r=>n.description=r,cols:"7",rows:"2"},null,8,bt),[[F,n.description]])])]),e("td",{class:C(["cell bold",t(c)?"unselectable":""])},[e("div",yt,[(u(),me(V,{key:b,class:"w-full h-full p-1",type:"text",value:n.amount||0,onInput:r=>n.amount=r,show:f.show,disabled:t(c)},null,8,["value","onInput","show","disabled"]))])],2),e("td",{class:C(["cell",t(c)?"unselectable":""])},[e("div",kt,[g(e("select",{"onUpdate:modelValue":r=>n.xfor=r,disabled:t(c)},At,8,gt),[[fe,n.xfor]])])],2)],8,ct)):y("",!0)],64))),128)),t(c)?y("",!0):(u(),_("tr",It,[e("td",Nt,[e("button",{type:"button",name:"button",onClick:s[3]||(s[3]=n=>W())},[S(N)])])]))],512)])])])]),e("div",jt,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:s[4]||(s[4]=n=>f.fnClose())}," Cancel "),t(c)?y("",!0):(u(),_("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:s[5]||(s[5]=ve(n=>X(),["prevent"]))}," Save "))])])])],512),[[_e,f.show]]),S(q,{show:t(I),coor:t(E),fn:Z,data:t(a),data_index:t(i),onReplyAct:s[6]||(s[6]=n=>ee(n))},null,8,["show","coor","data","data_index"]),S(se,{show:t(A),fnClose:G,fnSelect:J},null,8,["show"])],64)}}},Rt=be(Vt,[["__scopeId","data-v-80fc7397"]]);export{Rt as default};
