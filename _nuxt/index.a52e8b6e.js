import{_ as Ue}from"./Header.5fbd8f30.js";import{_ as Re,a as Ve}from"./ac_accs.2b61c7cc.js";import{_ as Ce}from"./Plus.f2a25127.js";import{_ as Fe}from"./Edit.38855a37.js";import{_ as Ne}from"./Delete.a755823d.js";import{_ as Be}from"./Signature.bd936493.js";import{u as ne,_ as He}from"./useUtils.5b9b0dfc.js";import{a as be,_ as ze}from"./Check.b78aa396.js";import{_ as Me}from"./PopupMini.vue.69a784f2.js";import{_ as Ae}from"./HeaderPopup.vue.ebfeb482.js";import{_ as Ee,a as Le}from"./ToolsPopup.4b980b70.js";import{_ as Oe}from"./InputPointFormat.vue.81d61d21.js";import{_ as Te}from"./Times.f1b07ed7.js";import{r as f,f as fe,J as ue,g as ke,o,c as d,h as z,v as De,a as e,b as j,k as t,j as te,t as c,l as ye,G as $,d as K,F as Y,n as re,q as I,K as V,m as ge,x as F,y as se,p as Pe,e as Se,s as Ie,D as Ye,B as Je,H as $e,I as Ke,i as je,w as Qe,E as Ge,M as Xe}from"./entry.62cbfe04.js";import{u as le}from"./useMyFetch.227e87ef.js";import{_ as qe}from"./_plugin-vue_export-helper.c27b6911.js";const y=x=>(Pe("data-v-fce284ae"),x=x(),Se(),x),Ze={class:"box-fixed"},We={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},et={class:"w-full flex flex-col items-center justify-center grow overflow-auto"},tt={class:"w-full flex flex-row flex-wrap"},st={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},lt=y(()=>e("label",{for:""},"To",-1)),at=["disabled"],ot={class:"text-red-500"},nt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ct=y(()=>e("label",{for:""},"Tipe",-1)),it=["disabled"],ut={class:"text-red-500"},rt={class:"w-full sm:w-4/12 md:w-2/12 lg:w-1/12 flex flex-col flex-wrap p-1"},dt=y(()=>e("label",{for:""},"Jenis",-1)),_t=["disabled"],pt=y(()=>e("option",{value:"PK"},"PK",-1)),ft=y(()=>e("option",{value:"CPO"},"CPO",-1)),vt=y(()=>e("option",{value:"TBS"},"TBS",-1)),ht=[pt,ft,vt],mt={class:"text-red-500"},wt={class:"w-full sm:w-4/12 md:w-2/12 lg:w-1/12 flex flex-col flex-wrap p-1"},xt=y(()=>e("label",{for:""},"Harga",-1)),yt={class:"card-border disabled"},bt={class:"text-red-500"},kt={class:"w-full sm:w-4/12 md:w-2/12 lg:w-4/12 flex flex-col flex-wrap p-1"},gt=y(()=>e("label",{for:""},"Ket. Untuk Remarks",-1)),$t=["disabled"],jt={class:"text-red-500"},Ct={class:"w-full flex grow p-1 overflow-auto 2xl:overflow-hidden justify-between flex-wrap"},At={class:"w-full p-0 2xl:pr-1 2xl:w-1/2 2xl:h-full 2xl:overflow-auto"},Tt={class:"w-full",role:"sticky"},Dt={class:"tacky w-full",style:{"white-space":"normal"}},Pt={class:"sticky -top-1 !z-[2]"},St=["colspan"],It={class:"sticky top-7 !z-[2]"},qt={key:0,class:"min-w-[50px] !w-[50px] max-w-[50px]"},Ut=y(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),Rt=y(()=>e("th",null,"Desc",-1)),Vt=y(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Harga @",-1)),Ft=y(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"Qty",-1)),Nt={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Bt=y(()=>e("br",null,null,-1)),Ht={class:"text-sm"},zt=y(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"For Remarks",-1)),Mt={ref:"to_move"},Et=["data-index"],Lt={key:0,class:"tools cell"},Ot={class:"w-full h-full flex items-center justify-center"},Yt=["onClick"],Jt={class:"cell"},Kt={class:"w-full h-full flex items-center justify-center"},Qt=["disabled","onUpdate:modelValue"],Gt={class:"w-full h-full flex items-center justify-center"},Xt={class:"w-full h-full flex items-center justify-center"},Zt={class:"cell"},Wt={class:"w-full h-full flex items-center justify-center unselectable"},es={class:"w-full h-full flex items-center justify-center"},ts={key:0,class:"text-3xl"},ss=["onClick"],ls={key:0},as={class:"tools cell"},os={class:"w-full px-0 py-2 2xl:pl-1 2xl:py-0 2xl:w-1/2 2xl:h-full 2xl:overflow-auto"},ns={class:"w-full",role:"sticky"},cs={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},is={class:"sticky -top-1 !z-[2]"},us=["colspan"],rs={class:"sticky top-7 !z-[2]"},ds={key:0,class:"min-w-[30px] !w-[30px] max-w-[30px]"},_s=y(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),ps={key:1,class:"min-w-[30px] !w-[30px] max-w-[30px]"},fs=y(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),vs=y(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),hs=y(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),ms=y(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),ws=y(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Amount",-1)),xs=y(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Qty",-1)),ys={class:"min-w-[100px] !w-[100px] max-w-[100px]"},bs=y(()=>e("br",null,null,-1)),ks={class:"text-sm"},gs={ref:"to_move"},$s=["data-index"],js={key:0,class:"tools cell"},Cs={class:"w-full h-full flex items-center justify-center"},As=["onClick"],Ts={key:1,class:"cell"},Ds={class:"w-full h-full flex items-center justify-center"},Ps=["onClick"],Ss=["onClick","disabled"],Is={class:"w-full h-full flex items-center justify-center"},qs={class:"w-full h-full flex items-center justify-center"},Us={class:"w-full h-full flex items-center justify-center"},Rs={class:"cell"},Vs={class:"w-full h-full flex items-center justify-center"},Fs=["disabled","onUpdate:modelValue"],Ns={class:"w-full h-full flex items-center justify-center"},Bs={class:"w-full h-full flex items-center justify-center"},Hs={class:"cell"},zs={class:"w-full h-full flex items-center justify-center unselectable"},Ms={key:0},Es={class:"tools cell"},Ls={class:"w-full flex items-center justify-end"},Os={__name:"ujalan",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(x){const w=x,{pointFormat:M}=ne(),q={id:-1,xto:"",tipe:"",jenis:"",harga:0,note_for_remarks:"",details:[],details2:[]},v=f({...q}),i=fe("token"),U=f({}),ae=f([{xdesc:"Timbangan",qty:1,harga:55e3},{xdesc:"Retribusi TPR",qty:1,harga:23e3},{xdesc:"Parkir & Nginap",qty:1,harga:1e4},{xdesc:"Penitipan Alat (Dongkrak)",qty:1,harga:5e3},{xdesc:"Ikas Danau",qty:1,harga:1e4},{xdesc:"U.Bongkar + Ambil surat",qty:1,harga:35e3},{xdesc:"Perbaikan Jalan Pujut",qty:1,harga:1e4},{xdesc:"Gaji Supir",qty:1,harga:0},{xdesc:"Gaji Kernet",qty:1,harga:0},{xdesc:"U.Extrafooding",qty:1,harga:2e4}]);f([]);const _=f([]),p=f([]),H=f({ordinal:0,id:-1,xdesc:"",qty:1,harga:0,for_remarks:0,p_status:""}),C=f({ordinal:0,id:-1,ac_account_id:"",ac_account_name:"",ac_account_code:"",description:"",qty:1,amount:0,p_status:""}),D=()=>{ae.value.forEach(l=>{_.value.filter(s=>s.xdesc==l.xdesc).length==0&&_.value.push({...l,ordinal:0,id:-1,p_status:"Add"})})},N=f(!1),g=()=>{N.value=!1},A=l=>{p.value[k.value].ac_account_id=l.ac_account_id,p.value[k.value].ac_account_code=l.ac_account_code,p.value[k.value].ac_account_name=l.ac_account_name,N.value=!1},L=(l,s)=>{k.value=s,N.value=!0},R=(l,s)=>{p.value[s].ac_account_id="",p.value[s].ac_account_code="",p.value[s].ac_account_name=""},E=async()=>{F().loading_full=!0,U.value={};const l=new FormData;l.append("xto",v.value.xto),l.append("tipe",v.value.tipe),l.append("jenis",v.value.jenis),l.append("harga",v.value.harga),l.append("note_for_remarks",v.value.note_for_remarks),l.append("details",JSON.stringify(_.value)),l.append("details2",JSON.stringify(p.value));let s="post",O=w.is_copy?0:w.id;O==0||(l.append("id",O),l.append("_method","PUT"));const{data:B,error:T,status:W}=await le("/ujalan",{method:s,headers:{Authorization:`Bearer ${i.value}`,Accept:"application/json"},body:l,retry:0});if(F().loading_full=!1,W.value==="error"){se().trigger(T,U);return}if(O<=0)v.value.id=B.value.id,v.value.created_at=B.value.created_at,v.value.updated_at=B.value.updated_at,w.p_data.unshift(v.value);else{v.value.updated_at=B.value.updated_at;let X=w.p_data.map(ee=>ee.id).indexOf(O);X>=-1&&w.p_data.splice(X,1,{...v.value})}w.fnClose()},h=ue(()=>{let l=0;return _.value.forEach(s=>{s.p_status!="Remove"&&(l+=s.qty*s.harga)}),v.value.harga=l,l}),P=ue(()=>{let l=0;return p.value.forEach(s=>{s.p_status!="Remove"&&(l+=s.qty*s.amount)}),l}),S=f(-1),k=f(-1),oe=f(!1),de=f({left:0,top:0}),Q=f(!1),ce=f({left:0,top:0}),ve=(l,s)=>{S.value=s,oe.value=!0,de.value={left:l.clientX,top:l.clientY}},ie=(l,s)=>{k.value=s,Q.value=!0,ce.value={left:l.clientX,top:l.clientY}},_e=()=>{_.value.push({...H.value,p_status:"Add"})},Z=()=>{p.value.push({...C.value,p_status:"Add"})},G=()=>{oe.value=!1},he=()=>{Q.value=!1},me=(l="")=>{if(l=="insert")_.value.splice(S.value,0,{...H.value,p_status:"Add"});else if(l=="delete")_.value[S.value].p_status=="Edit"?_.value[S.value].p_status="Remove":_.value.splice(S.value,1);else if(l=="move_top"){let s=_.value[S.value];_.value.splice(S.value,1),_.value.splice(S.value-1,0,{...s})}else if(l=="move_bottom"){let s=_.value[S.value];_.value.splice(S.value,1),_.value.splice(S.value+1,0,{...s})}oe.value=!1},we=(l="")=>{if(l=="insert")p.value.splice(k.value,0,{...C.value,p_status:"Add"});else if(l=="delete")p.value[k.value].p_status=="Edit"?p.value[k.value].p_status="Remove":p.value.splice(k.value,1);else if(l=="move_top"){let s=p.value[k.value];p.value.splice(k.value,1),p.value.splice(k.value-1,0,{...s})}else if(l=="move_bottom"){let s=p.value[k.value];p.value.splice(k.value,1),p.value.splice(k.value+1,0,{...s})}Q.value=!1},u=fe("role"),a=ue(()=>v.value.val&&v.value.val1||u.value=="Logistic"&&v.value.val||u.value=="PabrikTransport"&&v.value.val1),J=async()=>{F().loading_full=!0;const{data:l,error:s,status:O}=await le("/ujalan_",{method:"get",headers:{Authorization:`Bearer ${i.value}`,Accept:"application/json"},params:{id:w.id},retry:0});if(F().loading_full=!1,O.value==="error"){se().trigger(s);return}v.value=l.value.data;let B="Edit";w.is_copy&&(B="Add",v.value.val=0,v.value.val1=0),_.value=l.value.data.details.map(T=>(T.p_status=B,T.key=T.ordinal,T)),p.value=l.value.data.details2.map(T=>(T.p_status=B,T.key=T.ordinal,T))};return ke(()=>w.show,(l,s)=>{l==!0&&(v.value={...q},_.value=[],p.value=[],w.id!=0&&J())},{immediate:!0}),(l,s)=>{const O=Ae,B=Ee,T=Oe,W=Te,X=be,ee=Ce,pe=Le,xe=Re;return o(),d(Y,null,[z(e("section",Ze,[e("div",null,[j(O,{title:"Form Ujalan",fn:x.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",We,[e("div",et,[e("div",tt,[e("div",st,[lt,z(e("input",{"onUpdate:modelValue":s[0]||(s[0]=n=>t(v).xto=n),disabled:t(u)=="PabrikTransport"||t(a)},null,8,at),[[te,t(v).xto]]),e("p",ot,c(t(U).xto),1)]),e("div",nt,[ct,z(e("textarea",{"onUpdate:modelValue":s[1]||(s[1]=n=>t(v).tipe=n),disabled:t(u)=="PabrikTransport"||t(a)},null,8,it),[[te,t(v).tipe]]),e("p",ut,c(t(U).tipe),1)]),e("div",rt,[dt,z(e("select",{"onUpdate:modelValue":s[2]||(s[2]=n=>t(v).jenis=n),disabled:t(u)=="PabrikTransport"||t(a)},ht,8,_t),[[ye,t(v).jenis]]),e("p",mt,c(t(U).jenis),1)]),e("div",wt,[xt,e("div",yt,c(t(M)(t(h))),1),e("p",bt,c(t(U).harga),1)]),e("div",kt,[gt,z(e("textarea",{"onUpdate:modelValue":s[3]||(s[3]=n=>t(v).note_for_remarks=n),disabled:t(u)=="PabrikTransport"||t(a)},null,8,$t),[[te,t(v).note_for_remarks]]),e("p",jt,c(t(U).note_for_remarks),1)])]),e("div",Ct,[e("div",At,[e("div",Tt,[e("table",Dt,[e("thead",null,[e("tr",Pt,[e("td",{colspan:t(u)!="PabrikTransport"&&!t(a)?7:6,class:"!bg-slate-800 text-white font-bold"}," Detail Uang Jalan ",8,St)]),e("tr",It,[t(u)!="PabrikTransport"&&!t(a)?(o(),d("th",qt,[e("button",{type:"button",name:"button",class:"bg-yellow-600",onClick:s[4]||(s[4]=n=>D())}," Default In ")])):$("",!0),Ut,Rt,Vt,Ft,e("th",Nt,[K("Total "),Bt,K(),e("span",Ht,"("+c(t(M)(t(h)))+")",1)]),zt])]),e("tbody",Mt,[(o(!0),d(Y,null,re(t(_),(n,r)=>(o(),d(Y,{key:r},[n.p_status!="Remove"?(o(),d("tr",{key:0,"data-index":r},[t(u)!="PabrikTransport"&&!t(a)?(o(),d("td",Lt,[e("div",Ot,[e("button",{type:"button",name:"button",onClick:m=>ve(m,r)},[j(B)],8,Yt)])])):$("",!0),e("td",null,c(r+1)+".",1),e("td",Jt,[e("div",Kt,[z(e("textarea",{disabled:t(u)=="PabrikTransport"||t(a),class:"p-1 w-full","onUpdate:modelValue":m=>n.xdesc=m,cols:"7",rows:"2"},null,8,Qt),[[te,n.xdesc]])])]),e("td",{class:I(["cell bold",t(u)=="PabrikTransport"||t(a)?"unselectable":""])},[e("div",Gt,[(o(),V(T,{key:r,class:"w-full h-full p-1",type:"text",value:n.harga||0,onInput:m=>n.harga=m,show:x.show},null,8,["value","onInput","show"]))])],2),e("td",{class:I(["cell",t(u)=="PabrikTransport"||t(a)?"unselectable":""])},[e("div",Xt,[(o(),V(T,{key:r,class:"w-full h-full p-1",type:"text",value:n.qty||0,onInput:m=>n.qty=m,show:x.show},null,8,["value","onInput","show"]))])],2),e("td",Zt,[e("div",Wt,c(t(M)(n.qty*n.harga||0)),1)]),e("td",{class:I(["cell",t(u)=="PabrikTransport"||t(a)?"unselectable":""])},[e("div",es,[t(u)=="PabrikTransport"||t(a)?(o(),d("div",ts,[n.for_remarks==0?(o(),V(W,{key:0,class:"text-red-800"})):(o(),V(X,{key:1,class:"text-green-800"}))])):(o(),d("button",{key:1,type:"button",onClick:m=>n.for_remarks=n.for_remarks?0:1,class:I(["text-white w-auto rounded text-xl",n.for_remarks?"bg-green-600":"bg-red-600"])},[n.for_remarks==0?(o(),V(W,{key:0})):(o(),V(X,{key:1}))],10,ss))])],2)],8,Et)):$("",!0)],64))),128)),t(u)!="PabrikTransport"&&!t(a)?(o(),d("tr",ls,[e("td",as,[e("button",{type:"button",name:"button",onClick:s[5]||(s[5]=n=>_e())},[j(ee)])])])):$("",!0)],512)])])]),e("div",os,[e("div",ns,[e("table",cs,[e("thead",null,[e("tr",is,[e("td",{colspan:t(a)?8:10,class:"!bg-slate-800 text-white font-bold"}," Detail PVR ",8,us)]),e("tr",rs,[t(a)?$("",!0):(o(),d("th",ds)),_s,t(a)?$("",!0):(o(),d("th",ps)),fs,vs,hs,ms,ws,xs,e("th",ys,[K("Total "),bs,K(),e("span",ks,"("+c(t(M)(t(P)))+")",1)])])]),e("tbody",gs,[(o(!0),d(Y,null,re(t(p),(n,r)=>(o(),d(Y,{key:r},[n.p_status!="Remove"?(o(),d("tr",{key:0,"data-index":r},[t(a)?$("",!0):(o(),d("td",js,[e("div",Cs,[e("button",{type:"button",name:"button",onClick:m=>ie(m,r)},[j(B)],8,As)])])),e("td",null,c(r+1)+".",1),t(a)?$("",!0):(o(),d("td",Ts,[e("div",Ds,[n.ac_account_id?(o(),d("button",{key:1,type:"button",onClick:m=>R(m,r),disabled:n.confirm_by},[j(W,{class:"font-bold text-2xl"})],8,Ss)):(o(),d("button",{key:0,type:"button",name:"button",onClick:m=>L(m,r)}," ... ",8,Ps))])])),e("td",{class:I(["cell bold",t(a)?"unselectable":""])},[e("div",Is,c(n.ac_account_id),1)],2),e("td",{class:I(["cell bold",t(a)?"unselectable":""])},[e("div",qs,c(n.ac_account_code),1)],2),e("td",{class:I(["cell bold",t(a)?"unselectable":""])},[e("div",Us,c(n.ac_account_name),1)],2),e("td",Rs,[e("div",Vs,[z(e("textarea",{disabled:t(a),class:"p-1 w-full","onUpdate:modelValue":m=>n.description=m,cols:"7",rows:"2"},null,8,Fs),[[te,n.description]])])]),e("td",{class:I(["cell bold",t(a)?"unselectable":""])},[e("div",Ns,[(o(),V(T,{key:r,class:"w-full h-full p-1",type:"text",value:n.amount||0,onInput:m=>n.amount=m,show:x.show},null,8,["value","onInput","show"]))])],2),e("td",{class:I(["cell",t(a)?"unselectable":""])},[e("div",Bs,[(o(),V(T,{key:r,class:"w-full h-full p-1",type:"text",value:n.qty||0,onInput:m=>n.qty=m,show:x.show},null,8,["value","onInput","show"]))])],2),e("td",Hs,[e("div",zs,c(t(M)(n.qty*n.amount||0)),1)])],8,$s)):$("",!0)],64))),128)),t(a)?$("",!0):(o(),d("tr",Ms,[e("td",Es,[e("button",{type:"button",name:"button",onClick:s[6]||(s[6]=n=>Z())},[j(ee)])])]))],512)])])])])]),e("div",Ls,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:s[7]||(s[7]=n=>x.fnClose())}," Cancel "),t(a)?$("",!0):(o(),d("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:s[8]||(s[8]=ge(n=>E(),["prevent"]))}," Save "))])])])],512),[[De,x.show]]),j(pe,{show:t(oe),coor:t(de),fn:G,data:t(_),data_index:t(S),onReplyAct:s[9]||(s[9]=n=>me(n))},null,8,["show","coor","data","data_index"]),j(pe,{show:t(Q),coor:t(ce),fn:he,data:t(p),data_index:t(k),onReplyAct:s[10]||(s[10]=n=>we(n))},null,8,["show","coor","data","data_index"]),j(xe,{show:t(N),fnClose:g,fnSelect:A},null,8,["show"])],64)}}},Ys=qe(Os,[["__scopeId","data-v-fce284ae"]]);const b=x=>(Pe("data-v-8085a74d"),x=x(),Se(),x),Js={class:"box-fixed"},Ks={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},Qs={class:"w-full flex flex-col items-center grow overflow-auto"},Gs={class:"w-full flex flex-row flex-wrap"},Xs={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Zs=b(()=>e("label",{for:""},"To",-1)),Ws={class:"card-border"},el={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},tl=b(()=>e("label",{for:""},"Tipe",-1)),sl={class:"card-border"},ll={class:"w-full sm:w-4/12 md:w-2/12 lg:w-1/12 flex flex-col flex-wrap p-1"},al=b(()=>e("label",{for:""},"Jenis",-1)),ol={class:"card-border"},nl={class:"w-full sm:w-4/12 md:w-2/12 lg:w-1/12 flex flex-col flex-wrap p-1"},cl=b(()=>e("label",{for:""},"Harga",-1)),il={class:"card-border"},ul={class:"w-full sm:w-4/12 md:w-2/12 lg:w-4/12 flex flex-col flex-wrap p-1"},rl=b(()=>e("label",{for:""},"Ket. Untuk Remarks",-1)),dl={class:"card-border"},_l={class:"w-full flex grow p-1 overflow-auto 2xl:overflow-hidden justify-between flex-wrap"},pl={class:"w-full p-0 2xl:pr-1 2xl:w-1/2 2xl:h-full 2xl:overflow-auto"},fl={class:"w-full",role:"sticky"},vl={class:"tacky w-full",style:{"white-space":"normal"}},hl=b(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"6",class:"!bg-slate-800 text-white font-bold"}," Detail Uang Jalan ")],-1)),ml={class:"sticky top-8 !z-[2]"},wl=b(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),xl=b(()=>e("th",null,"Desc",-1)),yl=b(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Harga @",-1)),bl=b(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"Qty",-1)),kl={class:"min-w-[100px] !w-[100px] max-w-[100px]"},gl=b(()=>e("br",null,null,-1)),$l={class:"text-sm"},jl=b(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"For Remarks",-1)),Cl={ref:"to_move"},Al=["data-index"],Tl={class:"cell"},Dl={class:"w-full h-full flex items-center justify-center"},Pl={class:"cell bold"},Sl={class:"w-full h-full flex items-center justify-center"},Il={class:"cell"},ql={class:"w-full h-full flex items-center justify-center"},Ul={class:"cell"},Rl={class:"w-full h-full flex items-center justify-center"},Vl={class:"cell"},Fl={class:"w-full h-full flex items-center justify-center"},Nl={class:"w-full px-0 py-2 2xl:pl-1 2xl:py-0 2xl:w-1/2 2xl:h-full 2xl:overflow-auto"},Bl={class:"w-full",role:"sticky"},Hl={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},zl=b(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"8",class:"!bg-slate-800 text-white font-bold"}," Detail PVR ")],-1)),Ml={class:"sticky top-8 !z-[2]"},El=b(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),Ll=b(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),Ol=b(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),Yl=b(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),Jl=b(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),Kl=b(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Amount",-1)),Ql=b(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Qty",-1)),Gl={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Xl=b(()=>e("br",null,null,-1)),Zl={class:"text-sm"},Wl={ref:"to_move"},ea=["data-index"],ta={class:"w-full h-full flex items-center justify-center"},sa={class:"w-full h-full flex items-center justify-center"},la={class:"w-full h-full flex items-center justify-center"},aa={key:0,class:"cell"},oa={class:"w-full h-full flex items-center justify-center"},na={class:"w-full h-full flex items-center justify-center"},ca={class:"cell"},ia={class:"w-full h-full flex items-center justify-center"},ua={class:"w-full flex items-center justify-end"},ra={class:"w-full flex flex-wrap p-3 items-center"},da=b(()=>e("div",null," Di Validasi oleh : ",-1)),_a={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},pa={key:0},fa={key:1},va={__name:"ujalan_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},setup(x){const w=x,{$moment:M}=Ie(),{pointFormat:q}=ne(),i=f({...{id:-1,xto:"",tipe:"",jenis:"",harga:0,note_for_remarks:0,details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:""}}),U=fe("token"),ae=f({}),_=f([]),p=f([]),H=async()=>{F().loading_full=!0,ae.value={};const g=new FormData;let A="post",L=w.id;L==0||(g.append("id",L),g.append("_method","PUT"));const{data:R,error:E,status:h}=await le("/ujalan_validasi",{method:A,headers:{Authorization:`Bearer ${U.value}`,Accept:"application/json"},body:g,retry:0});if(F().loading_full=!1,h.value==="error"){se().trigger(E,ae);return}i.value.val=R.value.val,i.value.val_user=R.value.val_user,i.value.val_by=R.value.val_by,i.value.val_at=R.value.val_at,i.value.val1=R.value.val1,i.value.val1_user=R.value.val1_user,i.value.val1_by=R.value.val1_by,i.value.val1_at=R.value.val1_at;let P=w.p_data.map(S=>S.id).indexOf(w.id);P>=-1&&w.p_data.splice(P,1,{...i.value}),w.fnClose()},C=async()=>{F().loading_full=!0;const{data:g,error:A,status:L}=await le("/ujalan_",{method:"get",headers:{Authorization:`Bearer ${U.value}`,Accept:"application/json"},params:{id:w.id},retry:0});if(F().loading_full=!1,L.value==="error"){se().trigger(A);return}i.value=g.value.data,_.value=g.value.data.details,p.value=g.value.data.details2},D=ue(()=>{let g=0;return p.value.forEach(A=>{A.p_status!="Remove"&&(g+=A.qty*A.amount)}),g}),N=ue(()=>!1);return ke(()=>w.show,(g,A)=>{g==!0&&C()},{immediate:!0}),(g,A)=>{const L=Ae,R=Te,E=be;return z((o(),d("section",Js,[e("div",null,[j(L,{title:"Form Ujalan Validation",fn:x.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",Ks,[e("div",Qs,[e("div",Gs,[e("div",Xs,[Zs,e("div",Ws,c(t(i).xto),1)]),e("div",el,[tl,e("div",sl,c(t(i).tipe),1)]),e("div",ll,[al,e("div",ol,c(t(i).jenis),1)]),e("div",nl,[cl,e("div",il,c(t(q)(t(i).harga||0)),1)]),e("div",ul,[rl,e("div",dl,c(t(i).note_for_remarks),1)])]),e("div",_l,[e("div",pl,[e("div",fl,[e("table",vl,[e("thead",null,[hl,e("tr",ml,[wl,xl,yl,bl,e("th",kl,[K("Total "),gl,K(),e("span",$l,"("+c(t(q)(t(i).harga||0))+")",1)]),jl])]),e("tbody",Cl,[(o(!0),d(Y,null,re(t(_),(h,P)=>(o(),d(Y,{key:P},[h.p_status!="Remove"?(o(),d("tr",{key:0,"data-index":P},[e("td",null,c(P+1)+".",1),e("td",Tl,[e("div",Dl,c(h.xdesc),1)]),e("td",Pl,[e("div",Sl,c(t(q)(h.harga||0)),1)]),e("td",Il,[e("div",ql,c(t(q)(h.qty||0)),1)]),e("td",Ul,[e("div",Rl,c(t(q)(h.qty*h.harga||0)),1)]),e("td",Vl,[e("div",Fl,[e("div",{class:I(["text-white rounded text-xl w-5 h-5",h.for_remarks?"bg-green-600":"bg-red-600"])},[h.for_remarks==0?(o(),V(R,{key:0})):(o(),V(E,{key:1}))],2)])])],8,Al)):$("",!0)],64))),128))],512)])])]),e("div",Nl,[e("div",Bl,[e("table",Hl,[e("thead",null,[zl,e("tr",Ml,[El,Ll,Ol,Yl,Jl,Kl,Ql,e("th",Gl,[K("Total "),Xl,K(),e("span",Zl,"("+c(t(q)(t(D)))+")",1)])])]),e("tbody",Wl,[(o(!0),d(Y,null,re(t(p),(h,P)=>(o(),d(Y,{key:P},[h.p_status!="Remove"?(o(),d("tr",{key:0,"data-index":P},[e("td",null,c(P+1)+".",1),e("td",{class:I(["cell bold",t(N)?"unselectable":""])},[e("div",ta,c(h.ac_account_id),1)],2),e("td",{class:I(["cell bold",t(N)?"unselectable":""])},[e("div",sa,c(h.ac_account_code),1)],2),e("td",{class:I(["cell bold",t(N)?"unselectable":""])},[e("div",la,c(h.ac_account_name),1)],2),t(N)?$("",!0):(o(),d("td",aa,[e("div",oa,c(h.description),1)])),e("td",{class:I(["cell bold",t(N)?"unselectable":""])},[e("div",na,c(t(q)(h.amount||0)),1)],2),e("td",{class:I(["cell",t(N)?"unselectable":""])},c(t(q)(h.qty||0)),3),e("td",ca,[e("div",ia,c(t(q)(h.qty*h.amount||0)),1)])],8,ea)):$("",!0)],64))),128))],512)])])])])]),e("div",ua,[e("div",ra,[da,t(i).val||t(i).val1?(o(),d("div",_a,[t(i).val?(o(),d("div",pa," App 1 : "+c(t(i).val_by.username)+" ( "+c(t(i).val_at?t(M)(t(i).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):$("",!0),t(i).val1?(o(),d("div",fa," App 2 : "+c(t(i).val1_by.username)+" ( "+c(t(i).val1_at?t(M)(t(i).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):$("",!0)])):$("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:A[0]||(A[0]=h=>x.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:A[1]||(A[1]=ge(h=>H(),["prevent"]))}," Validasi ")])])])],512)),[[De,x.show]])}}},ha=qe(va,[["__scopeId","data-v-8085a74d"]]),ma={class:"w-full h-full flex flex-col"},wa={class:"w-full flex grow flex-col overflow-auto h-0"},xa={class:"w-full flex"},ya={action:"#",class:"w-full flex p-1"},ba={class:"grow"},ka=e("div",{class:"font-bold"}," Keyword ",-1),ga={class:"pl-1"},$a=e("div",{class:"font-bold"}," Sort By ",-1),ja=Xe('<option value=""></option><option value="id">ID</option><option value="xto">To</option><option value="jenis">Jenis</option><option value="tipe">Tipe</option>',5),Ca=[ja],Aa={class:"pl-1"},Ta=e("div",{class:"font-bold"}," Sort Order ",-1),Da=e("option",{value:"asc"},"Asc",-1),Pa=e("option",{value:"desc"},"Desc",-1),Sa=[Da,Pa],Ia={class:"flex items-end pl-1"},qa={class:"w-full flex justify-center items-center grow h-0 p-1"},Ua={key:0,class:""},Ra={class:"tacky"},Va=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"App 2"),e("th",null,"ID"),e("th",null,"To"),e("th",null,"Tipe"),e("th",null,"Jenis"),e("th",null,"Harga"),e("th",null,"Ket.U.Remarks"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),Fa=["onClick"],Na={class:"flex items-center justify-center"},Ba={class:"flex items-center justify-center"},Ha={class:"bold"},za={class:"grow mb-5"},oo={__name:"index",async setup(x){let w,M;const{$moment:q}=Ie(),{pointFormat:v}=ne(),i={};i._TimeZoneOffset=new Date().getTimezoneOffset(),i.sort="created_at:desc";const U=fe("token"),{data:ae}=([w,M]=Ye(async()=>Ge(async()=>{let u=[];F().loading_full=!0;const{data:a,error:J,status:l}=await le("/ujalan",{method:"get",headers:{Authorization:`Bearer ${U.value}`,Accept:"application/json"},params:i,retry:0});return F().loading_full=!1,l.value==="error"?(se().trigger(J),{ujalans:u}):(u=a.value.data,{ujalans:u})},"$SN3C927rLk")),w=await w,M(),w),_=f(ae.value.ujalans),p=f(""),H=f({field:"created_at",by:"desc"}),C=f(-1),D=f({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),N=()=>{i.like="",p.value!=""&&(i.like=`id:%${p.value}%,xto:%${p.value}%,tipe:%${p.value}%,jenis:%${p.value}%,harga:%${p.value}%`),i.sort="",H.value.field&&(i.sort=H.value.field+":"+H.value.by)},g=f(null),A=async()=>{F().loading_full=!0,D.value.may_get_data=!1,i.page=D.value.page,i.page==1&&(_.value=[]),i.first_row&&delete i.first_row,i.page>1&&(i.first_row=JSON.stringify(_.value[0]));const{data:u,error:a,status:J}=await le("/ujalan",{method:"get",headers:{Authorization:`Bearer ${U.value}`,Accept:"application/json"},params:i,retry:0});if(F().loading_full=!1,D.value.may_get_data=!0,J.value==="error"){se().trigger(a);return}D.value.page==1?(_.value=u.value.data,g.value&&(g.value.scrollTop=0)):D.value.page>1&&(_.value=[..._.value,...u.value.data]),u.value.data.length==0&&(D.value.is_last_record=!0)},L=async()=>{if(!D.value.may_get_data)return;let u=g.value;if(u.scrollLeft!=D.value.scrollLeft){D.value.scrollLeft=u.scrollLeft;return}D.value.is_last_record||!(Math.round(u.scrollTop)+u.clientHeight>=u.scrollHeight-1)||(D.value.page++,await A())},R=()=>{D.value.page=1,D.value.is_last_record=!1,N(),A()};Je();const E=f(!1),h=f(0),P=f(0),S=()=>{h.value=0,E.value=!0,P.value=!1},{display:k}=$e();Ke($e());const oe=()=>{C.value==-1?k({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(h.value=_.value[C.value].id,E.value=!0,P.value=!1)},de=()=>{C.value==-1?k({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(h.value=_.value[C.value].id,E.value=!0,P.value=!0)},Q=f(!1),ce=f(0),ve=()=>{C.value==-1?k({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(ce.value=_.value[C.value].id,Q.value=!0)},ie=f(!1),_e=f({}),Z=f(!1),G=f(""),he=async()=>{Z.value&&(Z.value=!1)},me=()=>{C.value==-1?k({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(G.value="",_e.value={id:_.value[C.value].id},Z.value=!0)};ke(()=>G.value,u=>{u.trim().length>0?ie.value=!0:ie.value=!1},{immediate:!1});const we=async()=>{F().loading_full=!0;const u=new FormData;u.append("id",_.value[C.value].id),u.append("deleted_reason",G.value),u.append("_method","DELETE");const{data:a,error:J,status:l}=await le("/ujalan",{method:"post",headers:{Authorization:`Bearer ${U.value}`,Accept:"application/json"},body:u,retry:0});if(F().loading_full=!1,l.value==="error"){se().trigger(J);return}_.value.splice(C.value,1),C.value=-1,Z.value=!1};return(u,a)=>{const J=Ue,l=Ve,s=Ce,O=Fe,B=Ne,T=Be,W=He,X=ze,ee=be,pe=Me,xe=Ys,n=ha;return o(),d("div",ma,[j(J,{title:"List Ujalan"}),e("div",wa,[e("div",xa,[("useUtils"in u?u.useUtils:t(ne))().checkRole(["PabrikTransport"])?$("",!0):(o(),d("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[0]||(a[0]=r=>de())},[j(l)])),("useUtils"in u?u.useUtils:t(ne))().checkRole(["PabrikTransport"])?$("",!0):(o(),d("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[1]||(a[1]=r=>S())},[j(s)])),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:a[2]||(a[2]=r=>oe())},[j(O)]),("useUtils"in u?u.useUtils:t(ne))().checkRole(["PabrikTransport"])?$("",!0):(o(),d("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[3]||(a[3]=r=>me())},[j(B)])),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:a[4]||(a[4]=r=>ve())},[j(T)])]),e("form",ya,[e("div",ba,[ka,z(e("input",{class:"",type:"text","onUpdate:modelValue":a[5]||(a[5]=r=>je(p)?p.value=r:null),name:"search",placeholder:"Keyword"},null,512),[[te,t(p)]])]),e("div",ga,[$a,z(e("select",{class:"","onUpdate:modelValue":a[6]||(a[6]=r=>t(H).field=r)},Ca,512),[[ye,t(H).field]])]),e("div",Aa,[Ta,z(e("select",{class:"","onUpdate:modelValue":a[7]||(a[7]=r=>t(H).by=r)},Sa,512),[[ye,t(H).by]])]),e("div",Ia,[e("button",{class:"",type:"submit",name:"button",onClick:a[8]||(a[8]=ge(r=>R(),["prevent"]))},[j(W,{class:"text-2xl"})])])]),e("div",qa,[t(_).length==0?(o(),d("div",Ua," Maaf Tidak Ada Record ")):(o(),d("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:g,onScroll:L},[e("table",Ra,[Va,e("tbody",null,[(o(!0),d(Y,null,re(t(_),(r,m)=>(o(),d("tr",{key:m,onClick:Ma=>C.value=m,class:I(t(C)==m?"active":"")},[e("td",null,[e("div",Na,[r.val?(o(),V(ee,{key:1})):(o(),V(X,{key:0}))])]),e("td",null,[e("div",Ba,[r.val1?(o(),V(ee,{key:1})):(o(),V(X,{key:0}))])]),e("td",Ha,c(r.id),1),e("td",null,c(r.xto),1),e("td",null,c(r.tipe),1),e("td",null,c(r.jenis),1),e("td",null,c(t(v)(r.harga)),1),e("td",null,c(r.note_for_remarks),1),e("td",null,c(r.created_at?t(q)(r.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,c(r.updated_at?t(q)(r.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,Fa))),128))])])],544))])]),j(pe,{type:"delete",show:t(Z),data:t(_e),fnClose:he,fnConfirm:we,enabledOk:t(ie)},{footer:Qe(()=>[K(" Masukkan Alasan Penghapusan: "),e("div",za,[z(e("textarea",{"onUpdate:modelValue":a[9]||(a[9]=r=>je(G)?G.value=r:null)},null,512),[[te,t(G)]])])]),_:1},8,["show","data","enabledOk"]),j(xe,{show:t(E),fnClose:()=>{E.value=!1},id:t(h),p_data:t(_),is_copy:t(P)},null,8,["show","fnClose","id","p_data","is_copy"]),j(n,{show:t(Q),fnClose:()=>{Q.value=!1},id:t(ce),p_data:t(_)},null,8,["show","fnClose","id","p_data"])])}}};export{oo as default};
