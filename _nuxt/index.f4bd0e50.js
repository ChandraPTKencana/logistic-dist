import me from"./Header.fb341aba.js";import fe from"./Copy.804d1098.js";import ve from"./Plus.2e58e061.js";import he from"./Edit.45987746.js";import ye from"./Delete.11dc6b97.js";import ge from"./Signature.13770967.js";import ke from"./Search.8f5cdfdd.js";import be from"./Line.034ea1c7.js";import we from"./Check.15585167.js";import{_ as xe}from"./PopupMini.vue.48719ae4.js";import Ce from"./ujalan.554ea42d.js";import De from"./ujalan_validasi.ee5f24f4.js";import{h as $e,k as Te,r as n,i as Ae,z as O,A as Se,I as Ue,c as m,b as d,a as e,m as l,G as I,n as T,q as J,B as K,C as Y,s as Me,F as je,D as Fe,w as Ie,l as Le,x as y,y as L,o as c,E as Pe,J as A,t as p,d as Be,L as Re,H as Ve}from"./entry.ef147d81.js";import{u as S}from"./useUtils.7d7bf96c.js";import{u as P}from"./useMyFetch.519debed.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.9c12f483.js";import"./Exclamation.fc3a3871.js";import"./HeaderPopup.vue.e2bec324.js";import"./Tools.f69a7785.js";import"./InputPointFormat.vue.7c67050b.js";import"./ToolsPopup.043558e9.js";import"./ac_accs.d362d2d6.js";const He={class:"w-full h-full flex flex-col"},Ne={class:"w-full flex grow flex-col overflow-auto h-0"},ze={class:"w-full flex"},Ee={action:"#",class:"w-full flex p-1"},Oe={class:"grow"},Je=e("div",{class:"font-bold"}," Keyword ",-1),Ke={class:"pl-1"},Ye=e("div",{class:"font-bold"}," Sort By ",-1),qe=Re('<option value=""></option><option value="id">ID</option><option value="xto">To</option><option value="jenis">Jenis</option><option value="tipe">Tipe</option>',5),Ge=[qe],Ze={class:"pl-1"},Qe=e("div",{class:"font-bold"}," Sort Order ",-1),We=e("option",{value:"asc"},"Asc",-1),Xe=e("option",{value:"desc"},"Desc",-1),et=[We,Xe],tt={class:"flex items-end pl-1"},ot={class:"w-full flex justify-center items-center grow h-0 p-1"},at={key:0,class:""},lt={class:"tacky"},st=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"App 2"),e("th",null,"ID"),e("th",null,"To"),e("th",null,"Tipe"),e("th",null,"Jenis"),e("th",null,"Harga"),e("th",null,"Ket.U.Remarks"),e("th",null,"Asal Peralihan"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),nt=["onClick"],it={class:"flex items-center justify-center"},rt={class:"flex items-center justify-center"},ut={class:"bold"},ct={class:"grow mb-5"},Pt={__name:"index",async setup(dt){let w,B;const{$moment:R}=Ve(),{pointFormat:q}=S(),i={};i._TimeZoneOffset=new Date().getTimezoneOffset(),i.sort="created_at:desc";const U=$e("token"),{data:G}=([w,B]=Te(async()=>Le(async()=>{let t=[];y().loading_full=!0;const{data:a,error:v,status:b}=await P("/ujalan",{method:"get",headers:{Authorization:`Bearer ${U.value}`,Accept:"application/json"},params:i,retry:0});return y().loading_full=!1,b.value==="error"?(L().trigger(v),{ujalans:t}):(t=a.value.data,{ujalans:t})},"$SN3C927rLk")),w=await w,B(),w),s=n(G.value.ujalans),_=n(""),f=n({field:"created_at",by:"desc"}),r=n(-1),u=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),Z=()=>{i.like="",_.value!=""&&(i.like=`id:%${_.value}%,xto:%${_.value}%,tipe:%${_.value}%,jenis:%${_.value}%,harga:%${_.value}%`),i.sort="",f.value.field&&(i.sort=f.value.field+":"+f.value.by)},x=n(null),V=async()=>{y().loading_full=!0,u.value.may_get_data=!1,i.page=u.value.page,i.page==1&&(s.value=[]),i.first_row&&delete i.first_row,i.page>1&&(i.first_row=JSON.stringify(s.value[0]));const{data:t,error:a,status:v}=await P("/ujalan",{method:"get",headers:{Authorization:`Bearer ${U.value}`,Accept:"application/json"},params:i,retry:0});if(y().loading_full=!1,u.value.may_get_data=!0,v.value==="error"){L().trigger(a);return}u.value.page==1?(s.value=t.value.data,x.value&&(x.value.scrollTop=0)):u.value.page>1&&(s.value=[...s.value,...t.value.data]),t.value.data.length==0&&(u.value.is_last_record=!0)},Q=async()=>{if(!u.value.may_get_data)return;let t=x.value;if(t.scrollLeft!=u.value.scrollLeft){u.value.scrollLeft=t.scrollLeft;return}u.value.is_last_record||!(Math.round(t.scrollTop)+t.clientHeight>=t.scrollHeight-1)||(u.value.page++,await V())},W=()=>{u.value.page=1,u.value.is_last_record=!1,Z(),V()};Ae();const g=n(!1),C=n(0),D=n(0),X=()=>{C.value=0,g.value=!0,D.value=!1},{display:$}=O();Se(O());const ee=()=>{r.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(C.value=s.value[r.value].id,g.value=!0,D.value=!1)},te=()=>{r.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(C.value=s.value[r.value].id,g.value=!0,D.value=!0)},M=n(!1),H=n(0),oe=()=>{r.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(H.value=s.value[r.value].id,M.value=!0)},j=n(!1),N=n({}),k=n(!1),h=n(""),ae=async()=>{k.value&&(k.value=!1)},le=()=>{r.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(h.value="",N.value={id:s.value[r.value].id},k.value=!0)};Ue(()=>h.value,t=>{t.trim().length>0?j.value=!0:j.value=!1},{immediate:!1});const se=async()=>{y().loading_full=!0;const t=new FormData;t.append("id",s.value[r.value].id),t.append("deleted_reason",h.value),t.append("_method","DELETE");const{data:a,error:v,status:b}=await P("/ujalan",{method:"post",headers:{Authorization:`Bearer ${U.value}`,Accept:"application/json"},body:t,retry:0});if(y().loading_full=!1,b.value==="error"){L().trigger(v);return}s.value.splice(r.value,1),r.value=-1,k.value=!1};return(t,a)=>{const v=me,b=fe,ne=ve,ie=he,re=ye,ue=ge,ce=ke,z=be,E=we,de=xe,_e=Ce,pe=De;return c(),m("div",He,[d(v,{title:"List Ujalan"}),e("div",Ne,[e("div",ze,[("useUtils"in t?t.useUtils:l(S))().checkRole(["PabrikTransport"])?I("",!0):(c(),m("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[0]||(a[0]=o=>te())},[d(b)])),("useUtils"in t?t.useUtils:l(S))().checkRole(["PabrikTransport"])?I("",!0):(c(),m("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[1]||(a[1]=o=>X())},[d(ne)])),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:a[2]||(a[2]=o=>ee())},[d(ie)]),("useUtils"in t?t.useUtils:l(S))().checkRole(["PabrikTransport"])?I("",!0):(c(),m("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[3]||(a[3]=o=>le())},[d(re)])),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:a[4]||(a[4]=o=>oe())},[d(ue)])]),e("form",Ee,[e("div",Oe,[Je,T(e("input",{class:"",type:"text","onUpdate:modelValue":a[5]||(a[5]=o=>K(_)?_.value=o:null),name:"search",placeholder:"Keyword"},null,512),[[J,l(_)]])]),e("div",Ke,[Ye,T(e("select",{class:"","onUpdate:modelValue":a[6]||(a[6]=o=>l(f).field=o)},Ge,512),[[Y,l(f).field]])]),e("div",Ze,[Qe,T(e("select",{class:"","onUpdate:modelValue":a[7]||(a[7]=o=>l(f).by=o)},et,512),[[Y,l(f).by]])]),e("div",tt,[e("button",{class:"",type:"submit",name:"button",onClick:a[8]||(a[8]=Me(o=>W(),["prevent"]))},[d(ce,{class:"text-2xl"})])])]),e("div",ot,[l(s).length==0?(c(),m("div",at," Maaf Tidak Ada Record ")):(c(),m("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:x,onScroll:Q},[e("table",lt,[st,e("tbody",null,[(c(!0),m(je,null,Fe(l(s),(o,F)=>(c(),m("tr",{key:F,onClick:_t=>r.value=F,class:Pe(l(r)==F?"active":"")},[e("td",null,[e("div",it,[o.val?(c(),A(E,{key:1})):(c(),A(z,{key:0}))])]),e("td",null,[e("div",rt,[o.val1?(c(),A(E,{key:1})):(c(),A(z,{key:0}))])]),e("td",ut,p(o.id),1),e("td",null,p(o.xto),1),e("td",null,p(o.tipe),1),e("td",null,p(o.jenis),1),e("td",null,p(l(q)(o.harga)),1),e("td",null,p(o.note_for_remarks),1),e("td",null,p(o.transition_from),1),e("td",null,p(o.created_at?l(R)(o.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,p(o.updated_at?l(R)(o.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,nt))),128))])])],544))])]),d(de,{type:"delete",show:l(k),data:l(N),fnClose:ae,fnConfirm:se,enabledOk:l(j)},{footer:Ie(()=>[Be(" Masukkan Alasan Penghapusan: "),e("div",ct,[T(e("textarea",{"onUpdate:modelValue":a[9]||(a[9]=o=>K(h)?h.value=o:null)},null,512),[[J,l(h)]])])]),_:1},8,["show","data","enabledOk"]),d(_e,{show:l(g),fnClose:()=>{g.value=!1},id:l(C),p_data:l(s),is_copy:l(D)},null,8,["show","fnClose","id","p_data","is_copy"]),d(pe,{show:l(M),fnClose:()=>{M.value=!1},id:l(H),p_data:l(s)},null,8,["show","fnClose","id","p_data"])])}}};export{Pt as default};
