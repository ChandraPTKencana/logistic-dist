import{_ as M}from"./HeaderPopup.vue.84d65bd6.js";import{_ as z}from"./WidthMiniList.vue.b736552e.js";import{_ as K}from"./InputPointFormat.vue.2a2fb126.js";import{r as v,g as E,i as L,f as H,k as m,J as Q,o as w,c as x,a as e,b,l as a,A as D,F as I,D as O,t as _,v as N,x as p,C as W,y as S,p as G,e as R}from"./entry.fa6a43a6.js";import{u as X}from"./useUtils.e43caca5.js";import{u as A}from"./useMyFetch.e44aed2a.js";import{_ as Y}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.abdf3177.js";import"./WidthMiniPart.vue.beda00e2.js";const i=f=>(G("data-v-0ee0b561"),f=f(),R(),f),Z={class:"box-fixed"},ee={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},te={class:"w-full flex flex-col items-center grow overflow-auto"},oe={class:"w-full flex flex-row flex-wrap"},ae={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},le=i(()=>e("label",{for:""},"Tujuan",-1)),se={id:"xto"},ne={class:"text-red-500"},ie={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},re=i(()=>e("label",{for:""},"Jenis",-1)),ce=i(()=>e("option",{value:"PK"},"PK",-1)),de=i(()=>e("option",{value:"CPO"},"CPO",-1)),ue=i(()=>e("option",{value:"TBS"},"TBS",-1)),_e=i(()=>e("option",{value:"TBS"},"TBSK",-1)),pe=[ce,de,ue,_e],fe={class:"text-red-500"},ve={class:"w-full sm:w-3/12 flex px-2 py-3"},me={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative items-end"},we=i(()=>e("div",{class:"absolute bg-white -top-3"}," Peralihan ",-1)),xe={class:"w-6/12 flex flex-col flex-wrap p-1"},he=i(()=>e("option",{value:""},null,-1)),ye=i(()=>e("option",{value:"From"},"Dari",-1)),ge=i(()=>e("option",{value:"To"},"Ke",-1)),be=[he,ye,ge],Se={class:"text-red-500"},Ae={class:"w-6/12 flex flex-col flex-wrap p-1"},Ne=i(()=>e("option",{value:""},null,-1)),Ce=["value"],qe={class:"text-red-500"},Be={class:"w-full sm:w-12/12 flex px-2 py-3"},je={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative items-start"},De=i(()=>e("div",{class:"absolute bg-white -top-3"}," Account ",-1)),Ie={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Oe=i(()=>e("label",{for:""},"Info",-1)),Te={class:"text-red-500"},ke={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Je=i(()=>e("label",{for:""},"Deskripsi",-1)),$e={class:"text-red-500"},Fe={class:"w-full sm:w-4/12 md:w-4/12 lg:w-4/12 flex flex-col flex-wrap p-1"},Pe=i(()=>e("label",{for:""},"Nominal",-1)),Ve={class:"w-full"},Ue={class:"text-red-500"},Me={class:"w-full sm:w-4/12 md:w-4/12 lg:w-4/12 flex flex-col flex-wrap p-1"},ze=i(()=>e("label",{for:""},"Qty",-1)),Ke={class:"w-full"},Ee={class:"text-red-500"},Le={class:"w-full sm:w-4/12 md:w-4/12 lg:w-4/12 flex flex-col flex-wrap p-1"},He=i(()=>e("label",{for:""},"Total",-1)),Qe={class:"w-full card-border"},We={class:"w-full flex items-center justify-end"},Ge={__name:"extra_money",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(f){const d=f,{pointFormat:T}=X(),C={id:-1,xto:"",jenis:"",transition_target:"",transition_type:"",ac_account_id:"",ac_account_code:"",ac_account_name:"",description:"",nominal:0,qty:1},k=v([]);v({ordinal:0,id:"",tanggal:new Date,note:"",p_status:""});const o=v({...C}),h=E("token"),u=v({}),J=async()=>{p().loading_full=!0,u.value={};const s=new FormData;s.append("xto",o.value.xto),s.append("jenis",o.value.jenis),s.append("transition_target",o.value.transition_target),s.append("transition_type",o.value.transition_type),s.append("ac_account_id",r.value.id),s.append("description",o.value.description),s.append("nominal",o.value.nominal),s.append("qty",o.value.qty);let t="post",c=d.is_copy?0:d.id;c==0||(s.append("id",c),s.append("_method","PUT"));const{data:n,error:g,status:l}=await A("/extra_money",{method:t,headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},body:s,retry:0});if(p().loading_full=!1,l.value==="error"){S().trigger(g,u);return}if(o.value.ac_account_id=r.value._.id.val,o.value.ac_account_name=r.value._.name.val,o.value.ac_account_code=r.value._.code.val,o.value.updated_at=n.value.updated_at,c<=0)o.value.id=n.value.id,o.value.created_at=n.value.created_at,d.p_data.unshift(o.value);else{let j=d.p_data.map(U=>U.id).indexOf(d.id);j>=-1&&d.p_data.splice(j,1,{...o.value})}d.fnClose()},y={_:{id:{tcon:"",text:"ID",val:""},code:{tcon:"",text:"Code",val:""},name:{tcon:"",text:"Name",val:""}},id:"",name:"",title:""},r=v(JSON.parse(JSON.stringify(y))),$=L(()=>{let s=[];return B.value.forEach((t,c)=>{let n=JSON.parse(JSON.stringify(y));n._.id.val=t.AccountID,n._.name.val=t.AccountName,n._.code.val=t.AccountCode,n.id=t.AccountID,n.name=t.AccountCode,n.title=t.AccountName,s.push(JSON.parse(JSON.stringify(n)))}),s}),F=async()=>{p().loading_full=!0;const{data:s,error:t,status:c}=await A("/extra_money",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},params:{id:d.id},retry:0});if(p().loading_full=!1,c.value==="error"){S().trigger(t);return}d.is_copy&&(o.value.val=0,o.value.val1=0);let n=s.value.data;o.value=n,{...n},r.value._.id.val=n.ac_account_id,r.value._.name.val=n.ac_account_name,r.value._.code.val=n.ac_account_code,r.value.id=n.ac_account_id,r.value.name=n.ac_account_code,r.value.title=n.ac_account_name},q=v([]),B=v([]),P=async()=>{p().loading_full=!0;const{data:s,error:t,status:c}=await A("/extra_money_load_local",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},retry:0});if(p().loading_full=!1,c.value==="error"){S().trigger(t);return}q.value=s.value.list_xto},V=async()=>{p().loading_full=!0;const{data:s,error:t,status:c}=await A("/extra_money_load_sqlsrv",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},retry:0});if(p().loading_full=!1,c.value==="error"){S().trigger(t);return}B.value=s.value.list_accs};return H(()=>d.show,async(s,t)=>{s==!0&&(await P(),await V(),o.value={...C},r.value=JSON.parse(JSON.stringify(y)),k.value=[],u.value={},d.id!=0&&F())},{immediate:!0}),(s,t)=>{const c=M,n=z,g=K;return m((w(),x("section",Z,[e("div",null,[b(c,{title:"Form Transaction",fn:f.fnClose,class:"w-full flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",ee,[e("div",te,[e("div",oe,[e("div",ae,[le,m(e("input",{type:"text",list:"xto","onUpdate:modelValue":t[0]||(t[0]=l=>a(o).xto=l)},null,512),[[D,a(o).xto]]),e("datalist",se,[(w(!0),x(I,null,O(a(q),l=>(w(),x("option",null,_(l),1))),256))]),e("p",ne,_(a(u).xto),1)]),e("div",ie,[re,m(e("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>a(o).jenis=l)},pe,512),[[N,a(o).jenis]]),e("p",fe,_(a(u).jenis),1)]),e("div",ve,[e("div",me,[we,e("div",xe,[m(e("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>a(o).transition_type=l)},be,512),[[N,a(o).transition_type]]),e("p",Se,_(a(u).transition_type),1)]),e("div",Ae,[m(e("select",{"onUpdate:modelValue":t[3]||(t[3]=l=>a(o).transition_target=l)},[Ne,(w(!0),x(I,null,O(a(p)().list_pabrik,l=>(w(),x("option",{value:l},_(l),9,Ce))),256))],512),[[N,a(o).transition_target]]),e("p",qe,_(a(u).transition_target),1)])])]),e("div",Be,[e("div",je,[De,e("div",Ie,[Oe,b(n,{arr:a($),selected:a(r),pure:y,onSetSelected:t[4]||(t[4]=l=>r.value=l)},null,8,["arr","selected"]),e("p",Te,_(a(u).ac_account_id),1)]),e("div",ke,[Je,m(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=l=>a(o).description=l)},null,512),[[D,a(o).description]]),e("p",$e,_(a(u).description),1)]),e("div",Fe,[Pe,e("div",Ve,[b(g,{class:"w-full h-full p-1",type:"text",value:a(o).nominal||0,onInput:t[6]||(t[6]=l=>a(o).nominal=l)},null,8,["value"])]),e("p",Ue,_(a(u).nominal),1)]),e("div",Me,[ze,e("div",Ke,[b(g,{class:"w-full h-full p-1",type:"text",value:a(o).qty||0,onInput:t[7]||(t[7]=l=>a(o).qty=l)},null,8,["value"])]),e("p",Ee,_(a(u).qty),1)]),e("div",Le,[He,e("div",Qe,_(a(T)(a(o).nominal*a(o).qty)),1)])])])])]),e("div",We,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:t[8]||(t[8]=l=>f.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:t[9]||(t[9]=W(l=>J(),["prevent"]))}," Save ")])])])],512)),[[Q,f.show]])}}},st=Y(Ge,[["__scopeId","data-v-0ee0b561"]]);export{st as default};
