import{_ as I}from"./HeaderPopup.vue.b96455aa.js";import{r as x,f as P,G as k,j as T,m as z,J as R,o as r,c as i,a as e,b as U,t as s,k as a,d as N,F as E,y as G,l as c,x as J,E as K,A as g,B as H,p as L,e as O}from"./entry.b6ec899e.js";import{u as Q}from"./useUtils.46099be3.js";import{u as $}from"./useMyFetch.df73de97.js";import{_ as W}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.9309cce2.js";const u=_=>(L("data-v-2ad37faa"),_=_(),O(),_),X={class:"box-fixed"},Z={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},ee={class:"w-full flex flex-col items-center grow overflow-auto"},ae={class:"w-full flex flex-row flex-wrap"},te={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},le=u(()=>e("label",{for:""},"Period End",-1)),se={class:"card-border"},oe={key:0,class:"w-full flex p-1 2xl:overflow-hidden justify-between flex-wrap"},ne={class:"w-full",role:"sticky"},re={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},ie=u(()=>e("tr",{class:"sticky -top-1 !z-[2]"},[e("td",{colspan:"10",class:"!bg-slate-800 text-white font-bold"}," Detail ")],-1)),ue={class:"sticky top-7 !z-[2]"},_e=u(()=>e("th",null,"No",-1)),de=u(()=>e("th",null,"Nama Pekerja",-1)),ce=u(()=>e("th",null,"No KTP",-1)),ve=u(()=>e("th",null,"No SIM",-1)),me=u(()=>e("th",null,"Rek No",-1)),pe=u(()=>e("th",null,"Rek Nama",-1)),fe=u(()=>e("th",null,"Bank Name",-1)),ye={class:"text-sm"},he={class:"text-sm"},be={class:"text-sm"},we={ref:"to_move"},xe=["data-index"],ke={class:"w-full flex items-center justify-end"},ge={class:"w-full flex flex-wrap p-3 items-center"},Ne=u(()=>e("div",null," Di Validasi oleh : ",-1)),Ye={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},De={key:0},Fe={key:1},Me={key:2},Se={__name:"salary_paid_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(_){const d=_,{$moment:h}=K(),{pointFormat:v}=Q(),t=x({...{id:-1,name:"",tipe:"",is_transition:!1,amount:0,details:[],val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:"",val3:0,val3_by:{username:""},val3_at:""}}),Y=P("token"),D=x({}),F=x(null),m=x([]),j=async()=>{g().loading_full=!0,D.value={};const o=new FormData;let n="post",p=d.id;p==0||(o.append("id",p),o.append("_method","PUT"));const{data:l,error:f,status:b}=await $("/salary_paid_validasi",{method:n,headers:{Authorization:`Bearer ${Y.value}`,Accept:"application/json"},body:o,retry:0});if(g().loading_full=!1,b.value==="error"){H().trigger(f,D);return}t.value.val1=l.value.val1,t.value.val1_user=l.value.val1_user,t.value.val1_by=l.value.val1_by,t.value.val1_at=l.value.val1_at,t.value.val2=l.value.val2,t.value.val2_user=l.value.val2_user,t.value.val2_by=l.value.val2_by,t.value.val2_at=l.value.val2_at,t.value.val3=l.value.val3,t.value.val3_user=l.value.val3_user,t.value.val3_by=l.value.val3_by,t.value.val3_at=l.value.val3_at;let y=d.p_data.map(w=>w.id).indexOf(d.id);y>=-1&&d.p_data.splice(y,1,{...t.value}),d.fnClose()},M=k(()=>{let o=0;return m.value.forEach(n=>{o+=parseFloat(n.standby_nominal)}),o}),S=k(()=>{let o=0;return m.value.forEach(n=>{o+=parseFloat(n.salary_bonus_nominal)}),o}),q=async()=>{g().loading_full=!0;const{data:o,error:n,status:p}=await $("/salary_paid",{method:"get",headers:{Authorization:`Bearer ${Y.value}`,Accept:"application/json"},params:{id:d.id},retry:0});if(g().loading_full=!1,p.value==="error"){H().trigger(n);return}t.value=o.value.data,m.value=o.value.data.details};return k(()=>{let o=0;return m.value.forEach(n=>{n.p_status!="Remove"&&(o+=parseInt(n.amount))}),o}),k(()=>!1),T(()=>d.show,(o,n)=>{o==!0&&(d.is_view==!1&&setTimeout(()=>{F.value.focus()},1),q())},{immediate:!0}),(o,n)=>{const p=I;return z((r(),i("section",X,[e("div",null,[U(p,{title:"Form Master Standby Validation",fn:_.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",Z,[e("div",ee,[e("div",ae,[e("div",te,[le,e("div",se,s(a(h)(a(t).period_end).format("MM-Y")),1)])]),a(m).length?(r(),i("div",oe,[e("div",ne,[e("table",re,[e("thead",null,[ie,e("tr",ue,[_e,de,ce,ve,me,pe,fe,e("th",null,[N("Nominal Standby "),e("span",ye,"("+s(a(v)(a(M)||0))+")",1)]),e("th",null,[N("Nominal Bonus "),e("span",he,"("+s(a(v)(a(S)||0))+")",1)]),e("th",null,[N("Total "),e("span",be,"("+s(a(v)(a(M)+a(S)||0))+")",1)])])]),e("tbody",we,[(r(!0),i(E,null,G(a(m),(l,f)=>{var b,y,w,A,B,C,V;return r(),i(E,{key:f},[l.p_status!="Remove"?(r(),i("tr",{key:0,"data-index":f},[e("td",null,s(f+1)+".",1),e("td",null,s((b=l.employee)==null?void 0:b.name),1),e("td",null,s((y=l.employee)==null?void 0:y.ktp_no),1),e("td",null,s((w=l.employee)==null?void 0:w.sim_no),1),e("td",null,s((A=l.employee)==null?void 0:A.rek_no),1),e("td",null,s((B=l.employee)==null?void 0:B.rek_name),1),e("td",null,s((V=(C=l.employee)==null?void 0:C.bank)==null?void 0:V.code),1),e("td",null,s(a(v)(l.standby_nominal)),1),e("td",null,s(a(v)(l.salary_bonus_nominal)),1),e("td",null,s(a(v)(parseFloat(l.standby_nominal)+parseFloat(l.salary_bonus_nominal))),1)],8,xe)):c("",!0)],64)}),128))],512)])])])):c("",!0)]),e("div",ke,[e("div",ge,[Ne,a(t).val1||a(t).val2||a(t).val3?(r(),i("div",Ye,[a(t).val1?(r(),i("div",De," App 1 : "+s(a(t).val1_by.username)+" ( "+s(a(t).val1_at?a(h)(a(t).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):c("",!0),a(t).val2?(r(),i("div",Fe," App 2 : "+s(a(t).val2_by.username)+" ( "+s(a(t).val2_at?a(h)(a(t).val2_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):c("",!0),a(t).val3?(r(),i("div",Me," App 3 : "+s(a(t).val3_by.username)+" ( "+s(a(t).val3_at?a(h)(a(t).val3_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):c("",!0)])):c("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:n[0]||(n[0]=l=>_.fnClose())}," Cancel "),_.is_view==0?(r(),i("button",{key:0,ref_key:"it_val",ref:F,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:n[1]||(n[1]=J(l=>j(),["prevent"]))}," Validasi ",512)):c("",!0)])])])],512)),[[R,_.show]])}}},je=W(Se,[["__scopeId","data-v-2ad37faa"]]);export{je as default};
