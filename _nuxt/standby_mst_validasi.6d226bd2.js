import{_ as q}from"./HeaderPopup.vue.9b4798a3.js";import{r as w,f as I,G as D,j as z,m as H,J as T,o as d,c as r,a as e,b as E,t as l,k as t,d as j,F as S,y as P,C as v,l as m,x as R,E as U,A as h,B as F,p as G,e as J}from"./entry.c23774bf.js";import{u as L}from"./useUtils.fc8ffcf7.js";import{u as N}from"./useMyFetch.f406b52d.js";import{_ as O}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.f61f7a80.js";const o=c=>(G("data-v-4f875e27"),c=c(),J(),c),K={class:"box-fixed"},Q={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},W={class:"w-full flex flex-col items-center grow overflow-auto"},X={class:"w-full flex flex-row flex-wrap"},Z={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ee=o(()=>e("label",{for:""},"Name",-1)),te={class:"card-border"},se={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ae=o(()=>e("label",{for:""},"Tipe",-1)),le={class:"card-border"},oe={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ie=o(()=>e("label",{for:""},"Amount",-1)),ne={class:"card-border"},ce={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},de=o(()=>e("label",{for:""},"Peralihan?",-1)),re={class:"card-border !flex flex-row items-center"},_e=["checked"],ue={class:"w-full ml-1"},fe={class:"text-red-500"},me={class:"w-full flex grow p-1 2xl:overflow-hidden justify-between flex-wrap"},pe={class:"w-full",role:"sticky"},ve={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},we=o(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"7",class:"!bg-slate-800 text-white font-bold"}," Detail PVR ")],-1)),he={class:"sticky top-8 !z-[2]"},xe=o(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),be=o(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),ye=o(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),ge=o(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),ke=o(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),Ae={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Ce=o(()=>e("br",null,null,-1)),De={class:"text-sm"},je=o(()=>e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"For",-1)),Se={ref:"to_move"},Fe=["data-index"],Ne={class:"w-full h-full flex items-center justify-center"},Ve={class:"w-full h-full flex items-center justify-center"},Ye={class:"w-full h-full flex items-center justify-center"},Be={key:0,class:"cell"},Me={class:"w-full h-full flex items-center justify-center"},$e={class:"w-full h-full flex items-center justify-center"},qe={class:"w-full flex items-center justify-end"},Ie={class:"w-full flex flex-wrap p-3 items-center"},ze=o(()=>e("div",null," Di Validasi oleh : ",-1)),He={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},Te={key:0},Ee={key:1},Pe={__name:"standby_mst_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(c){const _=c,{$moment:g}=U(),{pointFormat:x}=L(),s=w({...{id:-1,name:"",tipe:"",is_transition:!1,amount:0,details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:""}}),k=I("token"),b=w({}),A=w(null),y=w([]),V=async()=>{h().loading_full=!0,b.value={};const i=new FormData;let n="post",f=_.id;f==0||(i.append("id",f),i.append("_method","PUT"));const{data:a,error:p,status:M}=await N("/standby_mst_validasi",{method:n,headers:{Authorization:`Bearer ${k.value}`,Accept:"application/json"},body:i,retry:0});if(h().loading_full=!1,M.value==="error"){F().trigger(p,b);return}s.value.val=a.value.val,s.value.val_user=a.value.val_user,s.value.val_by=a.value.val_by,s.value.val_at=a.value.val_at,s.value.val1=a.value.val1,s.value.val1_user=a.value.val1_user,s.value.val1_by=a.value.val1_by,s.value.val1_at=a.value.val1_at;let C=_.p_data.map($=>$.id).indexOf(_.id);C>=-1&&_.p_data.splice(C,1,{...s.value}),_.fnClose()},Y=async()=>{h().loading_full=!0;const{data:i,error:n,status:f}=await N("/standby_mst",{method:"get",headers:{Authorization:`Bearer ${k.value}`,Accept:"application/json"},params:{id:_.id},retry:0});if(h().loading_full=!1,f.value==="error"){F().trigger(n);return}s.value=i.value.data,y.value=i.value.data.details},B=D(()=>{let i=0;return y.value.forEach(n=>{n.p_status!="Remove"&&(i+=parseInt(n.amount))}),i}),u=D(()=>!1);return z(()=>_.show,(i,n)=>{i==!0&&(_.is_view==!1&&setTimeout(()=>{A.value.focus()},1),Y())},{immediate:!0}),(i,n)=>{const f=q;return H((d(),r("section",K,[e("div",null,[E(f,{title:"Form Master Standby Validation",fn:c.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",Q,[e("div",W,[e("div",X,[e("div",Z,[ee,e("div",te,l(t(s).name),1)]),e("div",se,[ae,e("div",le,l(t(s).tipe),1)]),e("div",oe,[ie,e("div",ne,l(t(x)(t(s).amount||0)),1)]),e("div",ce,[de,e("div",re,[e("input",{checked:t(s).is_transition,disabled:"disabled",type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded"},null,8,_e),e("label",ue,l(t(s).is_transition?"Ya":"Tidak"),1)]),e("p",fe,l(t(b).is_transition),1)])]),e("div",me,[e("div",pe,[e("table",ve,[e("thead",null,[we,e("tr",he,[xe,be,ye,ge,ke,e("th",Ae,[j("Amount "),Ce,j(),e("span",De,"("+l(t(x)(t(B)))+")",1)]),je])]),e("tbody",Se,[(d(!0),r(S,null,P(t(y),(a,p)=>(d(),r(S,{key:p},[a.p_status!="Remove"?(d(),r("tr",{key:0,"data-index":p},[e("td",null,l(p+1)+".",1),e("td",{class:v(["cell bold",t(u)?"unselectable":""])},[e("div",Ne,l(a.ac_account_id),1)],2),e("td",{class:v(["cell bold",t(u)?"unselectable":""])},[e("div",Ve,l(a.ac_account_code),1)],2),e("td",{class:v(["cell bold",t(u)?"unselectable":""])},[e("div",Ye,l(a.ac_account_name),1)],2),t(u)?m("",!0):(d(),r("td",Be,[e("div",Me,l(a.description),1)])),e("td",{class:v(["cell bold",t(u)?"unselectable":""])},[e("div",$e,l(t(x)(a.amount||0)),1)],2),e("td",{class:v(["cell",t(u)?"unselectable":""])},l(a.xfor),3)],8,Fe)):m("",!0)],64))),128))],512)])])])]),e("div",qe,[e("div",Ie,[ze,t(s).val||t(s).val1?(d(),r("div",He,[t(s).val?(d(),r("div",Te," App 1 : "+l(t(s).val_by.username)+" ( "+l(t(s).val_at?t(g)(t(s).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0),t(s).val1?(d(),r("div",Ee," App 2 : "+l(t(s).val1_by.username)+" ( "+l(t(s).val1_at?t(g)(t(s).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0)])):m("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:n[0]||(n[0]=a=>c.fnClose())}," Cancel "),c.is_view==0?(d(),r("button",{key:0,ref_key:"it_val",ref:A,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:n[1]||(n[1]=R(a=>V(),["prevent"]))}," Validasi ",512)):m("",!0)])])])],512)),[[T,c.show]])}}},Qe=O(Pe,[["__scopeId","data-v-4f875e27"]]);export{Qe as default};
