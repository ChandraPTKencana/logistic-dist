import{_ as V}from"./HeaderPopup.vue.efc68b23.js";import{r as c,g as $,f as q,k as F,L as H,o as v,c as m,a as l,b as P,t as d,l as t,n as y,D as j,H as O,x,y as I,p as T,e as U}from"./entry.36c38a87.js";import{u as z}from"./useUtils.a0510d7f.js";import{u as A}from"./useMyFetch.933fc75d.js";import{_ as E}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.1c210fa8.js";const h=s=>(T("data-v-5bfbca47"),s=s(),U(),s),J={class:"box-fixed"},R={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},K={class:"w-full flex flex-col items-center grow overflow-auto"},L={class:"w-full p-1"},G={class:"w-full flex flex-row flex-wrap bg-white"},Q={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},W=h(()=>l("label",{for:""},"Tanggal",-1)),X={class:"card-border"},Z={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ee=h(()=>l("label",{for:""},"Nominal Potong",-1)),ae={class:"card-border"},te={class:"w-full flex flex-col flex-wrap p-1"},le=h(()=>l("label",{for:""},"Keterangan",-1)),oe={class:"card-border"},se={class:"w-full flex items-center justify-end"},ne={class:"w-full flex flex-wrap p-3 items-center"},ie=h(()=>l("div",null," Di Validasi oleh : ",-1)),re={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},de={key:0},_e={key:1},ue={__name:"trx_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(s){const i=s,{$moment:b}=O(),e=c({...{id:-1,kejadian:"",employee:{id:-1,name:""},no_pol:"",nominal:0,nominal_cut:0,remaining_cut:0,status:"Open",val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:""}}),g=$("token"),k=c({}),D=c(null);c([]);const r=c(JSON.parse(JSON.stringify({_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:-1,name:"",title:""}))),B=async()=>{x().loading_full=!0,k.value={};const o=new FormData;let n="post",_=i.id;_==0||(o.append("id",_),o.append("_method","PUT"));const{data:a,error:f,status:p}=await A("/potongan_trx_validasi",{method:n,headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},body:o,retry:0});if(x().loading_full=!1,p.value==="error"){I().trigger(f,k);return}e.value.val=a.value.val,e.value.val_user=a.value.val_user,e.value.val_by=a.value.val_by,e.value.val_at=a.value.val_at,e.value.val1=a.value.val1,e.value.val1_user=a.value.val1_user,e.value.val1_by=a.value.val1_by,e.value.val1_at=a.value.val1_at;let u=i.p_data.map(w=>w.id).indexOf(i.id);u>-1&&i.p_data.splice(u,1,{...e.value}),i.fnClose()},M=async()=>{var f,p,u,w,N,C,S,Y;x().loading_full=!0;const{data:o,error:n,status:_}=await A("/potongan_trx",{method:"get",headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},params:{id:i.id},retry:0});if(x().loading_full=!1,_.value==="error"){I().trigger(n);return}let a=o.value.data;e.value=a,r.value._.id.val=(f=a.employee)==null?void 0:f.id,r.value._.name.val=(p=a.employee)==null?void 0:p.name,r.value._.rek_no.val=(u=a.employee)==null?void 0:u.rek_no,r.value._.rek_name.val=(w=a.employee)==null?void 0:w.rek_name,r.value.id=(N=a.employee)==null?void 0:N.id,r.value.name=(C=a.employee)==null?void 0:C.name,r.value.rek_no=(((S=a.employee)==null?void 0:S.rek_no)||"")+" "+(((Y=a.employee)==null?void 0:Y.rek_name)||"")};return q(()=>i.show,(o,n)=>{o==!0&&(i.is_view==!1&&setTimeout(()=>{D.value.focus()},1),M())},{immediate:!0}),(o,n)=>{const _=V;return F((v(),m("section",J,[l("div",null,[P(_,{title:"Form Transaction Standby Validation",fn:s.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),l("form",R,[l("div",K,[l("div",L,[l("div",G,[l("div",Q,[W,l("div",X,d(t(e).tanggal?t(b)(t(e).tanggal).format("DD-MM-YYYY"):""),1)]),l("div",Z,[ee,l("div",ae,d(("useUtils"in o?o.useUtils:t(z))().pointFormat(t(e).nominal_cut)),1)]),l("div",te,[le,l("div",oe,d(t(e).note),1)])])])]),l("div",se,[l("div",ne,[ie,t(e).val||t(e).val1||t(e).val2?(v(),m("div",re,[t(e).val?(v(),m("div",de," App 1 : "+d(t(e).val_by.username)+" ( "+d(t(e).val_at?t(b)(t(e).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):y("",!0),t(e).val1?(v(),m("div",_e," App 2 : "+d(t(e).val1_by.username)+" ( "+d(t(e).val1_at?t(b)(t(e).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):y("",!0)])):y("",!0)]),l("button",{type:"button",name:"button",class:"w-36 m-1",onClick:n[0]||(n[0]=a=>s.fnClose())}," Cancel "),s.is_view==0?(v(),m("button",{key:0,ref_key:"it_val",ref:D,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:n[1]||(n[1]=j(a=>B(),["prevent"]))}," Validasi ",512)):y("",!0)])])])],512)),[[H,s.show]])}}},he=E(ue,[["__scopeId","data-v-5bfbca47"]]);export{he as default};
