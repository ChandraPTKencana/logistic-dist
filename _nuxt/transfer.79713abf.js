import{g as _t,h as ut,r as f,f as W,j as ft,i as xt,c as i,b as x,a as t,k as Y,A as pt,l as e,m as ht,F as N,E as $,L as P,t as o,n as u,d as S,q as mt,x as v,y as j,o as c,B as vt,H as gt,_ as bt}from"./entry.2e7ccff6.js";import yt from"./Header.75641c4b.js";import wt from"./Table2Column.66de0aee.js";import kt from"./Calendar.2c075cd0.js";import Tt from"./CarTag.1d51f5f8.js";import Dt from"./TruckDriver.9dd07dff.js";import Yt from"./TruckDriverOutline.d3826197.js";import jt from"./LocationOn.3192e4ac.js";import{_ as At}from"./HeaderPopup.vue.564c0726.js";import Mt from"./Image.cff7b5d9.js";import{u as Ct}from"./useUtils.fc5372ab.js";import{u as A}from"./useMyFetch.34128b6b.js";import{u as Lt}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.4d587d62.js";const Ht=vt(()=>bt(()=>import("./GAPIN.e98fe2ab.js"),["./GAPIN.e98fe2ab.js","./entry.2e7ccff6.js","./entry.493f9183.css","./useMyFetch.34128b6b.js"],import.meta.url).then(M=>M.default||M)),It={class:"w-full h-full flex flex-col relative"},Nt={class:"grow flex flex-col"},$t={class:"w-full flex items-center p-1"},Pt={class:"grow"},St={class:"grow overflow-auto h-0"},Bt={class:"p-1 grow"},zt={class:"bg-white flex py-2 justify-between"},Ft={class:"flex flex-wrap"},Rt={class:"flex items-center justify-center m-2 text-xs"},Vt={class:"bg-blue-400 p-2 font-bold text-white"},Et={class:"flex flex-col m-2"},Kt=t("span",{class:"text-xs"}," Tgl Terima U.Jalan ",-1),Ut={class:"flex items-center justify-center"},qt={class:"flex flex-col m-2"},Ot=t("span",{class:"text-xs"}," Nomor Kendaraan ",-1),Jt={class:"flex items-center justify-center"},Wt=["data-real"],Gt={class:"flex flex-col m-2"},Qt=t("span",{class:"text-xs"}," Nama Supir ",-1),Xt={class:"flex items-center justify-center"},Zt=["data-real"],te={key:0,class:"flex flex-col m-2"},ee=t("span",{class:"text-xs"}," Nama Kernet ",-1),se={class:"flex items-center justify-center"},oe=["data-real"],le={class:"flex flex-col m-2"},ne=t("span",{class:"text-xs"}," Tujuan ",-1),ae={class:"flex items-center justify-center"},re=["onClick"],ie={class:"w-full h-full fixed top-0 left-0 bg-gray-100 bg-opacity-80 flex items-center justify-center z-10"},ce={class:"w-full sm:w-10/12 md:w-10/12 lg:w-8/12 bg-white flex flex-col border-solid border-gray-200 max-w-full max-h-full overflow-auto",style:{"border-width":"1px"}},de={class:"p-1 flex flex-wrap overflow-auto items-start"},_e={class:"w-full flex flex-wrap"},ue={class:"w-full flex flex-wrap"},fe={class:"flex flex-col m-2 border-solid border-l-4 border-blue-400 px-2 bg-gray-200"},xe=t("span",{class:"text-xs font-bold"}," ID ",-1),pe={class:""},he={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},me=t("span",{class:"text-xs font-bold"}," Tgl Terima U.Jalan ",-1),ve={class:""},ge={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},be=t("span",{class:"text-xs font-bold"}," Nomor Kendaraan ",-1),ye={class:""},we={class:"flex flex-row flex-wrap m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},ke={class:"flex flex-col"},Te=t("span",{class:"text-xs font-bold"}," Nama Supir ",-1),De={class:""},Ye={class:"flex flex-col pl-2"},je=t("span",{class:"text-xs font-bold"}," No rek ",-1),Ae={class:""},Me={key:0,class:"flex flex-row flex-wrap m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},Ce={class:"flex flex-col"},Le=t("span",{class:"text-xs font-bold"}," Nama Kernet ",-1),He={class:""},Ie={class:"flex flex-col pl-2"},Ne=t("span",{class:"text-xs font-bold"}," No rek ",-1),$e={class:""},Pe={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},Se=t("span",{class:"text-xs font-bold"}," Tujuan ",-1),Be={class:""},ze={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},Fe=t("span",{class:"text-xs font-bold"}," Info ",-1),Re={class:""},Ve={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},Ee=t("span",{class:"text-xs font-bold"}," Tipe ",-1),Ke={class:""},Ue={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},qe=t("span",{class:"text-xs font-bold"}," Jenis ",-1),Oe={class:""},Je={key:1,class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},We=t("span",{class:"text-xs font-bold"}," Pengalihan ",-1),Ge={class:""},Qe={class:"w-full flex flex-wrap justify-center"},Xe={key:0,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},Ze=t("span",{class:"text-xs font-bold"}," App Kasir ",-1),ts={class:"text-xs"},es={key:1,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},ss=t("span",{class:"text-xs font-bold"}," App Mandor ",-1),os={class:"text-xs"},ls={key:2,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},ns=t("span",{class:"text-xs font-bold"}," App KTU/W ",-1),as={class:"text-xs"},rs={key:3,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},is=t("span",{class:"text-xs font-bold"}," App Marketing ",-1),cs={class:"text-xs"},ds={key:4,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},_s=t("span",{class:"text-xs font-bold"}," App Logistik ",-1),us={class:"text-xs"},fs={key:5,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},xs=t("span",{class:"text-xs font-bold"}," App SPV Logistik ",-1),ps={class:"text-xs"},hs={class:"w-full sm:w-1/2 text-sm flex justify-center"},ms={class:"border border-collapse border-black"},vs=t("tr",null,[t("th",{colspan:"4",class:"bg-blue-400"}," List Uang Jalan ")],-1),gs={class:"p-1"},bs={class:"p-1"},ys=t("td",{class:"p-1"},"= Rp.",-1),ws={class:"text-right p-1"},ks={class:"border-t-black border-dashed",style:{"border-top-width":"1px"}},Ts=t("th",{colspan:"2",class:"text-right"},"Total",-1),Ds=t("th",{class:"p-1 text-right"},"Rp.",-1),Ys={class:"p-1 text-right"},js={key:0,class:"text-red-500 font-bold"},As=t("td",{colspan:"2",class:"text-right"},"Potongan Supir",-1),Ms=t("td",{class:"p-1 text-right"},"Rp.",-1),Cs={class:"p-1 text-right"},Ls={key:1,class:"text-red-500 font-bold"},Hs=t("td",{colspan:"2",class:"text-right"},"Potongan Kernet",-1),Is=t("td",{class:"p-1 text-right"},"Rp.",-1),Ns={class:"p-1 text-right"},$s={key:2,class:"text-red-500 font-bold"},Ps=t("td",{colspan:"2",class:"text-right"},"Total Potongan",-1),Ss=t("td",{class:"p-1 text-right"},"Rp.",-1),Bs={class:"p-1 text-right"},zs={key:3,class:"font-bold"},Fs=t("td",{colspan:"2",class:"text-right"},"Total Diterima",-1),Rs=t("td",{class:"p-1 text-right"},"Rp.",-1),Vs={class:"p-1 text-right"},Es={class:"w-full sm:w-1/2 h-full"},Ks=["src"],Us={key:1,class:"flex flex-col justify-center items-center px-2 py-8 border border-gray-700 bg-gray-300"},qs={class:"w-full border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200 mt-2 flex flex-row flex-wrap"},Os={class:"flex flex-col mr-5"},Js=t("span",{class:"text-xs font-bold"}," EM#ID ",-1),Ws={class:""},Gs={class:"flex flex-col mr-5"},Qs=t("span",{class:"text-xs font-bold"}," Nama Penerima ",-1),Xs={class:""},Zs={class:"flex flex-col mr-5"},to=t("span",{class:"text-xs font-bold"}," No rek ",-1),eo={class:""},so={class:"flex flex-col mr-5"},oo=t("span",{class:"text-xs font-bold"}," Tanggal ",-1),lo={class:""},no={class:"flex flex-col mr-5"},ao=t("span",{class:"text-xs font-bold"}," Tujuan ",-1),ro={class:""},io={class:"flex flex-col mr-5"},co=t("span",{class:"text-xs font-bold"}," Desc ",-1),_o={class:""},uo={class:"flex flex-col mr-5"},fo=t("span",{class:"text-xs font-bold"}," Total ",-1),xo={class:""},po={class:"flex p-1 justify-end flex-wrap"},ho={class:"flex p-1 justify-center flex-wrap bg-yellow-100"},mo=t("div",{class:"w-full text-center"}," Akan dilakukan Transfer dengan data diatas. Apakah Informasi Diatas Sudah Benar Dan Tepat? ",-1),No={__name:"transfer",async setup(M){let y,B;const{$moment:h}=gt(),{pointFormat:p}=Ct(),w=_t("token");new Date().getTimezoneOffset();const{data:G}=([y,B]=ut(async()=>mt(async()=>{v().loading_full=!0;let l=[];const[n,d]=await Promise.all([A("/trx_trp/transfers",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},retry:0})]);return n.status.value==="error"?(j().trigger(n.error),{trx_trps:l}):(v().loading_full=!1,l=n.data.value.data,{trx_trps:l})},{lazy:!0,server:!1,default:()=>({trx_trps:[]})},"$pIgiM26TjW")),y=await y,B(),y),k=f([]);W(()=>{var l;return(l=G.value)==null?void 0:l.trx_trps},l=>{l&&(k.value=[...l])},{immediate:!0});const C=f({}),s=f({id:-1,tanggal:new Date,xto:"",tipe:"",jenis:"",amount:0,supir:"",kernet:"",no_pol:"",details_uj:[]}),L=f(-1),m=f(""),Q=async l=>{v().loading_full=!0;const{data:n,error:d,status:r}=await A("/trx_trp/transfer/detail",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:{id:l.id},retry:0});if(v().loading_full=!1,r.value==="error"){j().trigger(d,C);return}s.value=n.value.data},H=f(!1),X=async()=>{if(H.value)return;H.value=!0,v().loading_full=!0,C.value={};const l=new FormData;l.append("id",s.value.id),l.append("_method","PUT");let n="post";const{data:d,error:r,status:_}=await A("/trx_trp/transfer",{method:n,headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},body:l,retry:0});if(v().loading_full=!1,H.value=!1,_.value==="error"){j().trigger(r,C);return}k.value.splice(L.value,1),L.value=-1,b.value=!1,g.value=!1},g=f(!1),Z=f(0),b=f(!1);ft();const tt=(l,n)=>{L.value=l,Z.value=n,g.value=!0,Q(n)},z=xt(()=>m.value!=""?k.value.filter(l=>l.no_pol.toLowerCase().includes(m.value.toLowerCase())||l.supir.toLowerCase().includes(m.value.toLowerCase())||l.kernet.toLowerCase().includes(m.value.toLowerCase())):k.value),T=l=>l.potongan&&l.potongan.length>0?l.potongan.map(n=>parseInt(n.nominal_cut)).reduce((n,d)=>(n+=d,n)):0,F=l=>{if(l.potongan&&l.potongan.length>0){let n=l.potongan.filter(r=>r.potongan_mst.employee_id==l.supir_id);if(n.length==0)return 0;let d=n.map(r=>parseInt(r.nominal_cut));return d.length==0?0:d.reduce((r,_)=>(r+=_,r))}return 0},R=l=>{if(l.potongan&&l.potongan.length>0){let n=l.potongan.filter(r=>r.potongan_mst.employee_id==l.kernet_id);if(n.length==0)return 0;let d=n.map(r=>parseInt(r.nominal_cut));return d.length==0?0:d.reduce((r,_)=>(r+=_,r))}return 0},et=()=>{let l=m.value;document.querySelectorAll(".to_hl").forEach(n=>{let d=n.dataset.real;var r=n.innerHTML,_=d.toLowerCase().indexOf(l.toLowerCase());_>-1&&l!=""?(r=d.substring(0,_)+"<span class='highlight'>"+d.substring(_,_+l.length)+"</span>"+d.substring(_+l.length),n.innerHTML=r):n.innerHTML=r=d})};W(()=>z,(l,n)=>{setTimeout(()=>{et()},0)},{deep:!0,immediate:!0});const{downloadFile:st,viewFile:vo}=Lt(),ot=async()=>{v().loading_full=!0;const{data:l,error:n,status:d}=await A("/trx_trp/manual_tf",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:{},retry:0});if(v().loading_full=!1,d.value==="error"){j().trigger(n);return}st(l.value)},V=f(0);return(l,n)=>{var E,K;const d=yt,r=wt,_=kt,lt=Tt,nt=Dt,at=Yt,rt=jt,it=At,ct=Mt,dt=Ht;return c(),i("div",It,[x(d,{title:"List Transaction"}),t("section",Nt,[t("div",$t,[t("div",Pt,[Y(t("input",{class:"flex-grow",type:"text","onUpdate:modelValue":n[0]||(n[0]=a=>ht(m)?m.value=a:null),name:"search",placeholder:"Keyword"},null,512),[[pt,e(m)]])]),t("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:n[1]||(n[1]=a=>ot())},[x(r)])]),t("div",St,[(c(!0),i(N,null,$(e(z),(a,D)=>(c(),i("div",Bt,[t("div",zt,[t("div",Ft,[t("div",Rt,[t("div",Vt,o(a.id),1)]),t("div",Et,[Kt,t("div",Ut,[x(_,{class:"mr-1"}),S(" "+o(e(h)(a.tanggal).format("DD-MM-YYYY")),1)])]),t("div",qt,[Ot,t("div",Jt,[x(lt,{class:"mr-1"}),t("span",{class:"to_hl","data-real":a.no_pol},o(a.no_pol),9,Wt)])]),t("div",Gt,[Qt,t("div",Xt,[x(nt,{class:"mr-1"}),t("span",{class:"to_hl","data-real":a.supir},o(a.supir),9,Zt)])]),a.kernet?(c(),i("div",te,[ee,t("div",se,[x(at,{class:"mr-1"}),t("span",{class:"to_hl","data-real":a.kernet},o(a.kernet),9,oe)])])):u("",!0),t("div",le,[ne,t("div",ae,[x(rt,{class:"mr-1"}),S(" "+o(a.xto),1)])])]),t("button",{class:"bg-blue-500 text-white rounded",onClick:I=>tt(D,a)}," Detail ",8,re)])]))),256))])]),Y(t("div",ie,[t("div",ce,[x(it,{title:"Detail Information",fn:()=>{g.value=!1,b.value=!1},class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("div",de,[t("div",_e,[t("div",ue,[t("div",fe,[xe,t("div",pe,o(e(s).id),1)]),t("div",he,[me,t("div",ve,o(e(h)(e(s).tanggal).format("DD-MM-YYYY")),1)]),t("div",ge,[be,t("div",ye,o(e(s).no_pol),1)]),t("div",we,[t("div",ke,[Te,t("div",De,o(e(s).supir),1)]),t("div",Ye,[je,t("div",Ae,o(e(s).supir_rek_no),1)])]),e(s).kernet?(c(),i("div",Me,[t("div",Ce,[Le,t("div",He,o(e(s).kernet),1)]),t("div",Ie,[Ne,t("div",$e,o(e(s).kernet_rek_no),1)])])):u("",!0),t("div",Pe,[Se,t("div",Be,o(e(s).xto),1)]),t("div",ze,[Fe,t("div",Re,o((E=e(s).uj)==null?void 0:E.asst_opt),1)]),t("div",Ve,[Ee,t("div",Ke,o(e(s).tipe),1)]),t("div",Ue,[qe,t("div",Oe,o(e(s).jenis),1)]),e(s).transition_type=="From"?(c(),i("div",Je,[We,t("div",Ge,o(e(s).transition_target),1)])):u("",!0)]),t("div",Qe,[e(s).val?(c(),i("div",Xe,[Ze,t("div",null," ( "+o(e(s).val_by.username)+" ) ",1),t("div",ts,o(e(h)(e(s).val_at).format("DD-MM-YYYY HH:mm:ss")),1)])):u("",!0),e(s).val1?(c(),i("div",es,[ss,t("div",null," ( "+o(e(s).val1_by.username)+" ) ",1),t("div",os,o(e(h)(e(s).val1_at).format("DD-MM-YYYY HH:mm:ss")),1)])):u("",!0),e(s).val2?(c(),i("div",ls,[ns,t("div",null," ( "+o(e(s).val2_by.username)+" ) ",1),t("div",as,o(e(h)(e(s).val2_at).format("DD-MM-YYYY HH:mm:ss")),1)])):u("",!0),e(s).val3?(c(),i("div",rs,[is,t("div",null," ( "+o(e(s).val3_by.username)+" ) ",1),t("div",cs,o(e(h)(e(s).val3_at).format("DD-MM-YYYY HH:mm:ss")),1)])):u("",!0),e(s).val4?(c(),i("div",ds,[_s,t("div",null," ( "+o(e(s).val4_by.username)+" ) ",1),t("div",us,o(e(h)(e(s).val4_at).format("DD-MM-YYYY HH:mm:ss")),1)])):u("",!0),e(s).val5?(c(),i("div",fs,[xs,t("div",null," ( "+o(e(s).val5_by.username)+" ) ",1),t("div",ps,o(e(h)(e(s).val5_at).format("DD-MM-YYYY HH:mm:ss")),1)])):u("",!0)])]),t("div",hs,[t("table",ms,[vs,(c(!0),i(N,null,$(e(s).details_uj,a=>(c(),i("tr",null,[t("td",gs,o(a.ordinal)+". ",1),t("td",bs,o(a.xdesc)+" "+o(a.qty<=1?"":e(p)(a.qty||0)+" x Rp."+e(p)(a.harga||0)),1),ys,t("td",ws,o(e(p)(a.qty*a.harga)),1)]))),256)),t("tr",ks,[Ts,Ds,t("th",Ys,o(e(p)(e(s).amount)),1)]),F(e(s))>0?(c(),i("tr",js,[As,Ms,t("td",Cs,o(e(p)(F(e(s)))),1)])):u("",!0),R(e(s))>0?(c(),i("tr",Ls,[Hs,Is,t("td",Ns,o(e(p)(R(e(s)))),1)])):u("",!0),T(e(s))>0?(c(),i("tr",$s,[Ps,Ss,t("td",Bs,o(e(p)(T(e(s)))),1)])):u("",!0),T(e(s))>0?(c(),i("tr",zs,[Fs,Rs,t("td",Vs,o(e(p)(e(s).amount-T(e(s)))),1)])):u("",!0)])]),t("div",Es,[((K=e(s).trx_absens)==null?void 0:K.length)>0?(c(),i("img",{key:0,class:"w-full",src:e(s).trx_absens[0].gambar},null,8,Ks)):(c(),i("div",Us,[x(ct),S(" Tidak Ada Foto Berangkat ")]))]),(c(!0),i(N,null,$(e(s).extra_money_trxs,a=>{var D,I,U,q,O,J;return c(),i("div",qs,[t("div",Os,[Js,t("div",Ws,o(a.id),1)]),t("div",Gs,[Qs,t("div",Xs,o((D=a.employee)==null?void 0:D.name),1)]),t("div",Zs,[to,t("div",eo,o((I=a.employee)==null?void 0:I.rek_no),1)]),t("div",so,[oo,t("div",lo,o(a.tanggal),1)]),t("div",no,[ao,t("div",ro,o((U=a.extra_money)==null?void 0:U.xto),1)]),t("div",io,[co,t("div",_o,o((q=a.extra_money)==null?void 0:q.description),1)]),t("div",uo,[fo,t("div",xo,o(e(p)(((O=a.extra_money)==null?void 0:O.nominal)*((J=a.extra_money)==null?void 0:J.qty))),1)])])}),256))]),Y(t("div",po,[t("button",{class:"rounded m-1",onClick:n[2]||(n[2]=a=>g.value=!1)}," Cancel "),t("button",{class:"rounded m-1 text-white bg-blue-500",onClick:n[3]||(n[3]=a=>b.value=!0)}," Transfer ")],512),[[P,!e(b)]]),Y(t("div",ho,[mo,t("button",{class:"rounded m-1 bg-white",onClick:n[4]||(n[4]=a=>(b.value=!1,g.value=!1))}," Tidak "),t("button",{class:"rounded m-1 text-white bg-blue-500",onClick:n[5]||(n[5]=a=>X())}," Ya ")],512),[[P,e(b)]])])],512),[[P,e(g)]]),x(dt,{show:e(V),onSetTimeout:n[6]||(n[6]=a=>V.value=a)},null,8,["show"])])}}};export{No as default};
