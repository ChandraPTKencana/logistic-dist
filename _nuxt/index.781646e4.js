import it from"./Header.2a5a484f.js";import _t from"./PrinterEye.88709eba.js";import ct from"./Table2Column.725dfa51.js";import ut from"./Line.ff6a0590.js";import dt from"./Check.be55d134.js";import pt from"./TableView.b51c068b.js";import ft from"./Times.920dae2e.js";import{_ as bt}from"./HeaderPopup.vue.f75d51fc.js";import{r as u,f as G,g as mt,h as yt,x as d,i as kt,c as k,b as h,a as s,k as Z,v as ht,l as o,m as vt,d as c,w as i,n as gt,L as xt,t as l,F as Q,E as W,q as wt,y as T,o as f,G as Dt,z as $,I as Tt,H as $t}from"./entry.d41fcb1c.js";import{u as X}from"./useUtils.281ed599.js";import{u as N}from"./useMyFetch.a91bf453.js";import{u as Nt}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.4df42733.js";import"./Adjust.36f8edd0.js";import"./TableHeaderEye.68235bcc.js";import"./ClearAll.3a60bd9c.js";import"./client-only.04332497.js";import"./ClearEach.511d2ba0.js";import"./CaretLeftDoubleBold.dceb6b0d.js";import"./CaretLeftBold.026531d0.js";import"./CaretRightBold.e478bf13.js";import"./CaretRightDoubleBold.39aa48e8.js";const At={class:"w-full h-full flex flex-col"},St={class:"w-full flex grow flex-col overflow-auto h-0"},Ct={class:"w-full flex"},Mt={class:"m-1"},Pt=Tt('<option value="ticket_not_done">Undone</option><option value="ticket_done">Done</option><option value="deleted">Trash</option><option value="all">All</option><option value="req_deleted">Req Delete</option>',5),Bt=[Pt],Ft=s("span",{class:"text-xs ml-1"}," PDF ",-1),Ht=s("span",{class:"text-xs ml-1"}," Excel ",-1),Rt={key:0,class:"w-full h-full flex items-center justify-center fixed top-0 left-0 z-20 p-3",style:{"background-color":"rgba(255,255,255,0.9)"}},Yt={class:"relative",style:{width:"95%",height:"90%"}},Et={class:"absolute -top-7 right-0 bg-white",style:{position:"absolute",padding:"5px 10px",border:"solid 1px #ccc","border-bottom":"none","border-top-right-radius":"5px","border-top-left-radius":"5px"}},zt=["src"],It={class:"w-full h-full fixed top-0 left-0 bg-gray-100 bg-opacity-80 flex items-center justify-center z-10"},jt={class:"w-full sm:w-10/12 md:w-8/12 lg:w-6/12 bg-white flex flex-col border-solid border-gray-200 max-w-full max-h-full",style:{"border-width":"1px"}},qt={class:"p-1 flex flex-wrap overflow-auto items-start"},Ot={class:"w-full sm:w-1/2 flex flex-wrap"},Ut={class:"flex flex-col m-2"},Vt=s("span",{class:"text-xs"}," To ",-1),Kt={class:""},Jt={class:"flex flex-col m-2"},Lt=s("span",{class:"text-xs"}," Tipe ",-1),Gt={class:""},Zt={class:"flex flex-col m-2"},Qt=s("span",{class:"text-xs"}," Jenis ",-1),Wt={class:""},Xt={class:"flex flex-col m-2"},te=s("span",{class:"text-xs"}," Ket. Untuk Remarks ",-1),ee={class:""},se={class:"w-full sm:w-1/2 text-sm flex justify-center"},ae={class:"border border-collapse border-black"},oe=s("tr",null,[s("th",{colspan:"4",class:"bg-blue-400"}," List Uang Jalan ")],-1),le={class:"p-1"},re={class:"p-1"},ne=s("td",{class:"p-1"},"= Rp.",-1),ie={class:"text-right p-1"},_e={class:"border-t-black border-dashed",style:{"border-top-width":"1px"}},ce=s("th",{colspan:"2",class:"text-right"},"Total",-1),ue=s("th",{class:"p-1 text-right"},"Rp.",-1),de={class:"p-1 text-right"},pe={class:"w-full mt-2 text-sm flex justify-center"},fe={class:"border border-collapse border-black"},be=s("tr",null,[s("th",{colspan:"5",class:"bg-blue-400"}," List PVR ")],-1),me={class:"p-1"},ye={class:"p-1"},ke={class:"p-1"},he=s("td",{class:"p-1"},"= Rp.",-1),ve={class:"text-right p-1"},ge={class:"border-t-black border-dashed",style:{"border-top-width":"1px"}},xe=s("th",{colspan:"2",class:"text-right"},"Total",-1),we=s("th",{class:"p-1 text-right"},"Rp.",-1),De={class:"p-1 text-right"},Te={class:"flex p-1 justify-end flex-wrap"},We={__name:"index",async setup($e){let g,R;const{$moment:Y}=$t(),{pointFormat:n}=X(),A=e=>e.deleted==1?"!bg-red-400":e.req_deleted==1?"!bg-yellow-300":e.val_ticket==1?"!bg-blue-300":"",S=e=>(e.map(a=>{a.class_h=A(a)}),e),b=u("ticket_not_done");G(()=>b.value,e=>{q()},{immediate:!1});const r={};r._TimeZoneOffset=new Date().getTimezoneOffset(),r.sort="tanggal:desc";const E=u({}),x=mt("token"),w=u({from:"",to:""}),{data:tt}=([g,R]=yt(async()=>wt(async()=>{d().loading_full=!0;let e=[];const[a,_]=await Promise.all([N("/trx_trp_susuts/data",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:{filter_status:b},retry:0})]);return a.status.value!=="error"&&(e=S(a.data.value.data)),a.status.value==="error"?(T().trigger(a.error),{trx_trps:e}):(d().loading_full=!1,{trx_trps:e})},{lazy:!0,server:!1,default:()=>({trx_trps:[]})},"$8KmJHfPiB5")),g=await g,R(),g),y=u([]);G(()=>{var e;return(e=tt.value)==null?void 0:e.trx_trps},e=>{e&&(y.value=[...e])},{immediate:!0});const C=u({field:"tanggal",by:"desc"}),z=u(-1),p=u({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),M=()=>{r.like="";let e=JSON.parse(JSON.stringify(d()._tv.global_keyword));e!=""&&(r.like=`id:%${e}%,xto:%${e}%,jenis:%${e}%,pv_no:%${e}%,ticket_a_no:%${e}%,ticket_b_no:%${e}%,no_pol:%${e}%,supir:%${e}%,kernet:%${e}%,cost_center_code:%${e}%,cost_center_desc:%${e}%,pvr_no:%${e}%,tanggal:%${e}%,transition_target:%${e}%,uj_asst_opt:%${e}%`),r.sort="",C.value.field&&(r.sort=C.value.field+":"+C.value.by),r._TimeZoneOffset=new Date().getTimezoneOffset(),r.date_from=w.value.from?Y(w.value.from).format("YYYY-MM-DD"):"",r.date_to=w.value.to?Y(w.value.to).format("YYYY-MM-DD"):"",r.filter_model=JSON.stringify(d()._tv.filter_model),r.filter_status=b.value},I=u(null),j=async()=>{d().loading_full=!0,E.value={},p.value.may_get_data=!1,r.page=p.value.page,r.page==1&&(y.value=[]),r.first_row&&delete r.first_row,r.page>1&&(r.first_row=JSON.stringify(y.value[0])),r.filter_status=b.value;const{data:e,error:a,status:_}=await N("/trx_trp_susuts/data",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:r,retry:0});if(d().loading_full=!1,p.value.may_get_data=!0,_.value==="error"){T().trigger(a,E);return}p.value.page==1?(y.value=S(e.value.data),I.value&&(I.value.scrollTop=0)):p.value.page>1&&(y.value=[...y.value,...S(e.value.data)]),e.value.data.length==0&&(p.value.is_last_record=!0),d()._tv.filter_box=!1},q=()=>{p.value.page=1,p.value.is_last_record=!1,M(),j()},{downloadFile:O,viewFile:Ne}=Nt(),D=u(!1),P=u(""),U=async()=>{if(D.value==!0){D.value=!1;return}M(),d().loading_full=!0;const{data:e,error:a,status:_}=await N("/trx_trp_susuts/report_PDF",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:r,retry:0});if(d().loading_full=!1,_.value==="error"){T().trigger(a);return}P.value=e.value,D.value=!0},et=async()=>{M(),d().loading_full=!0,r.filter_status=b.value;const{data:e,error:a,status:_}=await N("/trx_trp_susuts/report_Excel",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:r,retry:0});if(d().loading_full=!1,_.value==="error"){T().trigger(a);return}O(e.value)},st=()=>{O(P.value)},at=u([{key:"no",label:"No",isai:!0},{key:"val_ticket",label:"App",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"tanggal",label:"U.Jalan Per",type:"date",dateformat:"DD-MM-Y",filter_on:1,sort:{priority:1,type:"desc"}},{key:"no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"xto",label:"Tujuan",filter_on:1,type:"string"},{key:"uj_asst_opt",label:"Info",filter_on:1,type:"select",select_item:["DENGAN KERNET","TANPA KERNET"]},{key:"tipe",label:"Tipe",filter_on:1,type:"string"},{key:"jenis",label:"Jenis",filter_on:1,type:"select",select_item:["TBS","TBSK","CPO","PK","LAIN","TUNGGU"]},{key:"amount",label:"Amount",class:" justify-end",filter_on:1,type:"number"},{key:"cost_center",label:"Cost Center",childs:[{key:"cost_center_code",label:"Code",class:" justify-start",filter_on:1,type:"string"},{key:"cost_center_desc",label:"Desc",filter_on:1,type:"string"}]},{key:"pvr",label:"PVR",childs:[{key:"pvr_no",label:"No",filter_on:1,type:"string"},{key:"pvr_total",label:"Total",filter_on:1,type:"number"},{key:"pvr_had_detail",label:"Completed",filter_on:1,type:"select",select_item:[{k:"1",v:"Completed"},{k:"0",v:"Uncompleted"}]}]},{key:"pv",label:"PV",childs:[{key:"pv_datetime",label:"Date",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"pv_no",label:"No",filter_on:1,type:"string"},{key:"pv_total",label:"Total",filter_on:1,type:"number"}]},{key:"transition",label:"Peralihan",childs:[{key:"transition_type",label:"Type",type:"select",filter_on:1,select_item:["To","From"]},{key:"transition_target",label:"Target",type:"select",filter_on:1,select_item:d().list_pabrik}]},{key:"ticket_a",label:"Ticket A",childs:[{key:"ticket_a_no",label:"No",filter_on:1,type:"string"},{key:"ticket_a_bruto",label:"Bruto",filter_on:1,type:"number"},{key:"ticket_a_tara",label:"Tara",filter_on:1,type:"number"},{key:"ticket_a_netto",label:"Netto",filter_on:1,type:"number"},{key:"ticket_a_supir",label:"Supir",filter_on:1,type:"string"},{key:"ticket_a_no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"ticket_a_in_at",label:"In At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"ticket_a_out_at",label:"Out At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1}]},{key:"ticket_b",label:"Ticket B",childs:[{key:"ticket_b_no",label:"No",filter_on:1,type:"string"},{key:"ticket_b_bruto",label:"Bruto",filter_on:1,type:"number"},{key:"ticket_b_tara",label:"Tara",filter_on:1,type:"number"},{key:"ticket_b_netto",label:"Netto",filter_on:1,type:"number"},{key:"ticket_b_supir",label:"Supir",filter_on:1,type:"string"},{key:"ticket_b_no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"ticket_b_in_at",label:"In At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"ticket_b_out_at",label:"Out At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1}]},{key:"susut",label:"Susut",childs:[{key:"susut_bruto",label:"Bruto",childs:[{key:"susut_bruto_a",label:"Berangkat"},{key:"susut_bruto_b",label:"Kembali"},{key:"susut_bruto_b_a",label:"Selisih"},{key:"susut_bruto_b_a_persen",label:"%"}]},{key:"susut_tara",label:"Tara",childs:[{key:"susut_tara_a",label:"Berangkat"},{key:"susut_tara_b",label:"Kembali"},{key:"susut_tara_b_a",label:"Selisih"},{key:"susut_tara_b_a_persen",label:"%"}]},{key:"susut_netto",label:"Netto",childs:[{key:"susut_netto_a",label:"Berangkat"},{key:"susut_netto_b",label:"Kembali"},{key:"susut_netto_b_a",label:"Selisih"},{key:"susut_netto_b_a_persen",label:"%"}]}]},{key:"supir",label:"Supir",filter_on:1,type:"string"},{key:"kernet",label:"Kernet",filter_on:1,type:"string"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1}]),B=(e,a)=>{e=parseFloat(e)||0,a=parseFloat(a)||0;let _=parseFloat(a-e);if((_>0?a:e)==0)return 0;let v=X().round(_/e*100,2);return v<0?"("+Math.abs(v*100)/100+")":v},F=(e,a)=>{e=parseFloat(e)||0,a=parseFloat(a)||0;let _=parseFloat(a-e);return _<0?"("+n(Math.abs(_))+")":n(_)},H=u(!1),m=u({...{id:-1,xto:"",tipe:"",jenis:"",harga:0,note_for_remarks:"",details:[],details2:[]}}),ot=kt(()=>{let e=0;return m.value.details2.forEach(a=>{a.p_status!="Remove"&&(e+=a.qty*a.amount)}),e});return(e,a)=>{const _=it,V=_t,v=ct,K=ut,J=dt,lt=pt,rt=ft,nt=bt;return f(),k("div",At,[h(_,{title:"Report Transaction"}),s("div",St,[s("div",Ct,[s("div",Mt,[Z(s("select",{class:"","onUpdate:modelValue":a[0]||(a[0]=t=>vt(b)?b.value=t:null)},Bt,512),[[ht,o(b)]])]),s("button",{type:"button",name:"button",class:"m-1 text-2xl flex items-center",onClick:a[1]||(a[1]=t=>U())},[h(V),c(),Ft]),s("button",{type:"button",name:"button",class:"m-1 text-2xl flex items-center",onClick:a[2]||(a[2]=t=>et())},[h(v),c(),Ht])]),h(lt,{thead:o(at),selected:o(z),onSetSelected:a[3]||(a[3]=t=>z.value=t),tbody:o(y),fnCallData:j,scrolling:o(p),onSetScrollingPage:a[4]||(a[4]=t=>o(p).page=t),onDoFilter:a[5]||(a[5]=t=>q())},{status:i(({item:t})=>[s("div",{class:Dt(["text-white text-xs px-2 py-1 rounded-lg",A(t)?"bg-green-600":"bg-red-600"])},l(A(t)?"Done":"Not Done"),3)]),val_ticket:i(({item:t})=>[t.val_ticket?(f(),$(J,{key:1})):(f(),$(K,{key:0}))]),uj_asst_opt:i(({item:t})=>{var L;return[c(l((L=t.uj)==null?void 0:L.asst_opt),1)]}),pvr_had_detail:i(({item:t})=>[t.pvr_had_detail?(f(),$(J,{key:1})):(f(),$(K,{key:0}))]),susut_bruto_a:i(({item:t})=>[c(l(o(n)(t.ticket_a_bruto)),1)]),susut_tara_a:i(({item:t})=>[c(l(o(n)(t.ticket_a_tara)),1)]),susut_netto_a:i(({item:t})=>[c(l(o(n)(t.ticket_a_netto)),1)]),susut_bruto_b:i(({item:t})=>[c(l(o(n)(t.ticket_b_bruto)),1)]),susut_tara_b:i(({item:t})=>[c(l(o(n)(t.ticket_b_tara)),1)]),susut_netto_b:i(({item:t})=>[c(l(o(n)(t.ticket_b_netto)),1)]),susut_bruto_b_a:i(({item:t})=>[c(l(F(t.ticket_a_bruto,t.ticket_b_bruto)),1)]),susut_tara_b_a:i(({item:t})=>[c(l(F(t.ticket_a_tara,t.ticket_b_tara)),1)]),susut_netto_b_a:i(({item:t})=>[c(l(F(t.ticket_a_netto,t.ticket_b_netto)),1)]),susut_bruto_b_a_persen:i(({item:t})=>[c(l(B(t.ticket_a_bruto,t.ticket_b_bruto)),1)]),susut_tara_b_a_persen:i(({item:t})=>[c(l(B(t.ticket_a_tara,t.ticket_b_tara)),1)]),susut_netto_b_a_persen:i(({item:t})=>[c(l(B(t.ticket_a_netto,t.ticket_b_netto)),1)]),_:2},1032,["thead","selected","tbody","scrolling"])]),o(D)?(f(),k("div",Rt,[s("div",Yt,[s("div",Et,[h(rt,{style:{color:"black",cursor:"pointer"},onClick:a[6]||(a[6]=t=>U())})]),s("iframe",{ref:"iframe",width:"100%",height:"100%",src:o(P).dataBase64},null,8,zt),s("div",{style:{position:"absolute",top:"12px",right:"88px","background-color":"rgba(255,255,255,0)",width:"37px",height:"36px","z-index":"1",cursor:"pointer"},onClick:a[7]||(a[7]=t=>st())})])])):gt("",!0),Z(s("div",It,[s("div",jt,[h(nt,{title:"Detail Information",fn:()=>{H.value=!1,e.show_confirm=!1},class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),s("div",qt,[s("div",Ot,[s("div",Ut,[Vt,s("div",Kt,l(o(m).xto)+" ",1)]),s("div",Jt,[Lt,s("div",Gt,l(o(m).tipe),1)]),s("div",Zt,[Qt,s("div",Wt,l(o(m).jenis),1)]),s("div",Xt,[te,s("div",ee,l(o(m).note_for_remarks),1)])]),s("div",se,[s("table",ae,[oe,(f(!0),k(Q,null,W(o(m).details,t=>(f(),k("tr",null,[s("td",le,l(t.ordinal)+". ",1),s("td",re,l(t.xdesc)+" "+l(t.qty<=1?"":o(n)(t.qty||0)+" x Rp."+o(n)(t.harga||0)),1),ne,s("td",ie,l(o(n)(t.qty*t.harga)),1)]))),256)),s("tr",_e,[ce,ue,s("th",de,l(o(n)(o(m).harga)),1)])])]),s("div",pe,[s("table",fe,[be,(f(!0),k(Q,null,W(o(m).details2,t=>(f(),k("tr",null,[s("td",me,l(t.ordinal)+". ",1),s("td",ye,l(t.ac_account_code),1),s("td",ke,l(t.description)+" "+l(t.qty<=1?"":o(n)(t.qty||0)+" x Rp."+o(n)(t.amount||0)),1),he,s("td",ve,l(o(n)(t.qty*t.amount)),1)]))),256)),s("tr",ge,[xe,we,s("th",De,l(o(n)(o(ot))),1)])])])]),s("div",Te,[s("button",{class:"rounded m-1",onClick:a[8]||(a[8]=t=>H.value=!1)}," Cancel ")])])],512),[[xt,o(H)]])])}}};export{We as default};
