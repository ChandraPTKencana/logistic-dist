import{_ as K}from"./HeaderPopup.vue.9b650b3a.js";import{_ as H}from"./WidthMiniList.vue.ec9db9ac.js";import{_ as W}from"./InputPointFormat.vue.8a0c1ea5.js";import G from"./AttachmentSingle.7ee282e0.js";import Q from"./part.87e4da49.js";import{r as c,g as X,i as P,f as Y,k as N,K as Z,o as y,c as b,a as t,b as h,l as a,A as D,t as u,F as ee,D as te,v as ae,C as le,n as V,x as g,y as j,p as oe,e as se}from"./entry.9a576ab4.js";import{u as J}from"./useMyFetch.584d3068.js";import{u as ne}from"./useUtils.f8596025.js";import{_ as ie}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.78a8d7b1.js";import"./WidthMiniPart.vue.50b72916.js";import"./PDFJsView.ab396d56.js";import"./Plus.2ed06c78.js";import"./Edit.7d028291.js";import"./Delete.e8cc0a50.js";import"./Signature.320cd194.js";import"./Calculator.de6dfd25.js";import"./Search.c4d9dc68.js";import"./Line.218916ab.js";import"./Check.725ed637.js";import"./trx.e90afd00.js";import"./trx_validasi.6ecbc38a.js";const m=i=>(oe("data-v-8d953dd7"),i=i(),se(),i),re={class:"box-fixed"},de={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-slate-200"},_e={class:"w-full flex flex-col items-center grow overflow-auto"},ue={class:"w-full p-1"},me={class:"w-full flex flex-row flex-wrap bg-white"},pe={class:"w-full flex flex-col flex-wrap p-1"},ce=m(()=>t("label",{for:""},"Kejadian",-1)),ve=["disabled"],fe={class:"text-red-500"},we={class:"w-full sm:w-9/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},he=m(()=>t("label",{for:""},"Pekerja",-1)),xe={class:"text-red-500"},ge={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ye=m(()=>t("label",{for:""},"No Pol",-1)),be=["disabled"],ke={id:"vehicle"},Se=["value"],Ne={class:"text-red-500"},Ce={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Oe=m(()=>t("label",{for:""},"Nominal",-1)),Pe={class:"w-full"},je={class:"text-red-500"},Je={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ie=m(()=>t("label",{for:""},"Nominal Potong",-1)),Fe={class:"w-full"},$e={class:"text-red-500"},Ue={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ae=m(()=>t("label",{for:""},"Sisa Potongan",-1)),Be={class:"card-border"},De={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ve=m(()=>t("label",{for:""},"Status",-1)),Le=["disabled"],qe=m(()=>t("option",{value:"Open"},"Open",-1)),Me=m(()=>t("option",{value:"Close Clear"},"Close Clear",-1)),ze=m(()=>t("option",{value:"Close UnClear"},"Close UnClear",-1)),Ee=[qe,Me,ze],Re={class:"text-red-500"},Te={class:"w-full flex flex-col flex-wrap p-1"},Ke={class:"text-red-500"},He={class:"w-full flex flex-col flex-wrap p-1"},We={class:"text-red-500"},Ge={class:"w-full flex flex-row flex-wrap p-1 justify-end"},Qe={key:0,class:"w-full h-full p-1"},Xe={class:"w-full flex items-center justify-end bg-white"},Ye={__name:"mst",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(i){const r=i,C={id:-1,kejadian:"",employee:{id:-1,name:""},no_pol:"",nominal:0,nominal_cut:0,remaining_cut:0,status:"Open",attachment_1:"",attachment_1_preview:"",attachment_2:"",attachment_2_preview:"",val_at:"",val:0,val1:0},L=c([]);c({ordinal:0,id:"",tanggal:new Date,note:"",p_status:""}),JSON.parse(JSON.stringify(C));const l=c(JSON.parse(JSON.stringify(C))),O=X("token"),_=c({}),q=async()=>{g().loading_full=!0,_.value={};const s=new FormData;s.append("kejadian",l.value.kejadian),s.append("nominal",l.value.nominal),s.append("nominal_cut",l.value.nominal_cut),s.append("status",l.value.status),s.append("employee_id",d.value.id),s.append("no_pol",l.value.no_pol),s.append("attachment_1",l.value.attachment_1),s.append("attachment_1_preview",l.value.attachment_1_preview),s.append("attachment_2",l.value.attachment_2),s.append("attachment_2_preview",l.value.attachment_2_preview);let e="post",p=r.id;p==0||(s.append("id",p),s.append("_method","PUT"));const{data:n,error:v,status:f}=await J("/potongan_mst",{method:e,headers:{Authorization:`Bearer ${O.value}`,Accept:"application/json"},body:s,retry:0});if(g().loading_full=!1,f.value==="error"){j().trigger(v,_);return}if(l.value.employee.id=d.value.id,l.value.employee.name=d.value.name,l.value.remaining_cut=n.value.remaining_cut,l.value.updated_at=n.value.updated_at,r.id<=0)l.value.id=n.value.id,l.value.created_at=n.value.created_at,r.p_data.unshift(l.value);else{let w=r.p_data.map(o=>o.id).indexOf(r.id);w>-1&&r.p_data.splice(w,1,{...l.value})}r.fnClose()},k={_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:"",name:"",title:""},d=c(JSON.parse(JSON.stringify(k))),M=P(()=>{let s=[];return F.value.forEach((e,p)=>{let n=JSON.parse(JSON.stringify(k));n._.id.val=e.id,n._.name.val=e.name,n._.rek_no.val=e.rek_no,n._.rek_name.val=e.rek_name,n.id=e.id,n.name=e.name,n.title=(e.rek_no||"")+" "+(e.rek_name||""),s.push(JSON.parse(JSON.stringify(n)))}),s}),x=P(()=>l.value.val1==1||r.is_view),S=P(()=>l.value.val_at!=""||r.is_view),z=async()=>{var v,f,w,o,$,U,A,B;g().loading_full=!0;const{data:s,error:e,status:p}=await J("/potongan_mst",{method:"get",headers:{Authorization:`Bearer ${O.value}`,Accept:"application/json"},params:{id:r.id},retry:0});if(g().loading_full=!1,p.value==="error"){j().trigger(e);return}let n=s.value.data;l.value=n,{...n},d.value._.id.val=(v=n.employee)==null?void 0:v.id,d.value._.name.val=(f=n.employee)==null?void 0:f.name,d.value._.rek_no.val=(w=n.employee)==null?void 0:w.rek_no,d.value._.rek_name.val=(o=n.employee)==null?void 0:o.rek_name,d.value.id=($=n.employee)==null?void 0:$.id,d.value.name=(U=n.employee)==null?void 0:U.name,d.value.rek_no=(((A=n.employee)==null?void 0:A.rek_no)||"")+" "+(((B=n.employee)==null?void 0:B.rek_name)||"")},E=c([]),R=c([]),I=c([]),F=c([]),T=async()=>{g().loading_full=!0;const{data:s,error:e,status:p}=await J("/potongan_mst_load_local",{method:"get",headers:{Authorization:`Bearer ${O.value}`,Accept:"application/json"},retry:0});if(g().loading_full=!1,p.value==="error"){j().trigger(e);return}E.value=s.value.list_potongan_mst,R.value=s.value.list_xto,I.value=s.value.list_vehicle,F.value=s.value.list_employee};return Y(()=>r.show,async(s,e)=>{s==!0&&(r.is_view||await T(),l.value=JSON.parse(JSON.stringify(C)),d.value=JSON.parse(JSON.stringify(k)),L.value=[],_.value={},r.id!=0&&z())},{immediate:!0}),(s,e)=>{const p=K,n=H,v=W,f=G,w=Q;return N((y(),b("section",re,[t("div",null,[h(p,{title:"Form Potongan",fn:i.fnClose,class:"w-full flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",de,[t("div",_e,[t("div",ue,[t("div",me,[t("div",pe,[ce,N(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=o=>a(l).kejadian=o),rows:"10",disabled:a(x)}," ",8,ve),[[D,a(l).kejadian]]),t("p",fe,u(a(_).kejadian),1)]),t("div",we,[he,h(n,{arr:a(M),selected:a(d),pure:k,onSetSelected:e[1]||(e[1]=o=>d.value=o),disabled:a(S)},null,8,["arr","selected","disabled"]),t("p",xe,u(a(_).employee_id),1)]),t("div",ge,[ye,N(t("input",{type:"text",list:"vehicle","onUpdate:modelValue":e[2]||(e[2]=o=>a(l).no_pol=o),disabled:a(S)},null,8,be),[[D,a(l).no_pol]]),t("datalist",ke,[(y(!0),b(ee,null,te(a(I),o=>(y(),b("option",{value:o.no_pol},u(o.no_pol),9,Se))),256))]),t("p",Ne,u(a(_).no_pol),1)]),t("div",Ce,[Oe,t("div",Pe,[h(v,{class:"w-full h-full",type:"text",value:a(l).nominal||0,onInput:e[3]||(e[3]=o=>a(l).nominal=o),show:i.show,disabled:a(S)},null,8,["value","show","disabled"])]),t("p",je,u(a(_).ref),1)]),t("div",Je,[Ie,t("div",Fe,[h(v,{class:"w-full h-full",type:"text",value:a(l).nominal_cut||0,onInput:e[4]||(e[4]=o=>a(l).nominal_cut=o),show:i.show,disabled:a(x)},null,8,["value","show","disabled"])]),t("p",$e,u(a(_).ref),1)]),t("div",Ue,[Ae,t("div",Be,u(("useUtils"in s?s.useUtils:a(ne))().pointFormat(a(l).remaining_cut)),1)]),t("div",De,[Ve,N(t("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>a(l).status=o),disabled:a(x)},Ee,8,Le),[[ae,a(l).status]]),t("p",Re,u(a(_).ref),1)]),t("div",Te,[h(f,{label:"Lampiran Pertama",value:a(l).attachment_1_preview,onSetFile:e[6]||(e[6]=o=>a(l).attachment_1=o),onSetPreview:e[7]||(e[7]=o=>a(l).attachment_1_preview=o),can_remove:!a(S)},null,8,["value","can_remove"]),t("p",Ke,u(a(_).attachment_1),1)]),t("div",He,[h(f,{label:"Lampiran Lanjutan",value:a(l).attachment_2_preview,onSetFile:e[8]||(e[8]=o=>a(l).attachment_2=o),onSetPreview:e[9]||(e[9]=o=>a(l).attachment_2_preview=o),can_remove:!a(x)},null,8,["value","can_remove"]),t("p",We,u(a(_).attachment_2),1)]),t("div",Ge,[a(x)?V("",!0):(y(),b("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:e[10]||(e[10]=le(o=>q(),["prevent"]))}," Save "))])])]),a(x)?(y(),b("div",Qe,[h(w,{id:i.id,show:i.show,onUpdateRemainingCut:e[11]||(e[11]=o=>a(l).remaining_cut=o),is_view:i.is_view},null,8,["id","show","is_view"])])):V("",!0)]),t("div",Xe,[t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:e[12]||(e[12]=o=>i.fnClose())}," Close ")])])])],512)),[[Z,i.show]])}}},yt=ie(Ye,[["__scopeId","data-v-8d953dd7"]]);export{yt as default};
