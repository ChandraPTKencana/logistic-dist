import{_ as te}from"./Header.a59fe3eb.js";import{_ as oe}from"./Plus.17b44d1f.js";import{_ as le}from"./Edit.92ee67ee.js";import{_ as se}from"./Delete.91e02814.js";import{_ as ae}from"./Search.7c0ebb94.js";import{_ as ne}from"./PopupMini.vue.848a5f4b.js";import{_ as re}from"./Times.fc3b9cb1.js";import{G as ue,o as _,c as f,a as e,b as d,M as j,u as ie,K as ce,r as c,I as de,N as F,O as _e,n as B,s as fe,x as s,q as pe,y as V,z as me,F as ve,A as he,L as ye,D as g,E as M,B as ge,t as u,C as be}from"./entry.35da92b8.js";import{u as xe}from"./useUtils.100f5b4a.js";import{u as T}from"./useMyFetch.fee40aee.js";import"./_plugin-vue_export-helper.c27b6911.js";const we={key:0,class:"flex items-center justify-center fixed top-0 left-0 z-10 p-3 w-full h-full bg-black bg-opacity-80"},ke={class:"flex items-center max-w-xs w-full relative bg-white border-solid border-gray-600 border-2 p-3 flex-col flex-wrap"},Ce={class:"absolute -top-7 right-0 py-1 px-2 bg-white border-solid border-2 border-gray-600 border-b-0 rounded-tl-md"},$e={key:0,class:"mx-0 my-2 text-justify"},De=["src"],Ae={class:"flex w-full justify-between mt-5"},Se=ue({__name:"PopupSingleImage",props:{show:{type:Boolean,required:!0},photo:{type:String,required:!1,default:""},fnClose:{type:Function,required:!0}},setup(y){return(b,p)=>{const w=re;return y.show?(_(),f("div",we,[e("div",ke,[e("div",Ce,[d(w,{class:"text-2xl text-black cursor-pointer",onClick:p[0]||(p[0]=$=>y.fnClose())})]),y.photo?(_(),f("div",$e,[e("img",{src:y.photo,alt:"",class:"max-w-full max-h-full"},null,8,De)])):j("",!0),e("div",Ae,[e("button",{onClick:p[1]||(p[1]=$=>y.fnClose()),class:"w-full bg-blue-500 border-blue-500 border-solid border-2 p-1 text-white mr-2"}," Tutup ")])])])):j("",!0)}}}),Be={class:"w-full h-full flex flex-col"},Me={class:"w-full flex grow flex-col overflow-auto h-0"},Te={class:"w-full flex"},je={action:"#",class:"w-full flex p-1"},Ie={class:"grow"},Ne=e("div",{class:"font-bold"}," Keyword ",-1),Le={class:"pl-1"},ze=e("div",{class:"font-bold"}," Sort By ",-1),Ee=e("option",{value:"created_at"},"Created At",-1),Fe=e("option",{value:"name"},"Name",-1),Ve=e("option",{value:"value"},"Value",-1),He=[Ee,Fe,Ve],Pe={class:"pl-1"},Ue=e("div",{class:"font-bold"}," Sort Order ",-1),qe=e("option",{value:"asc"},"Asc",-1),Re=e("option",{value:"desc"},"Desc",-1),Oe=[qe,Re],Ke={class:"flex items-end pl-1"},Ye={class:"w-full flex justify-center items-center grow h-0 p-1"},Ge={key:0,class:""},Je={class:"tacky"},Ze=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"ID"),e("th",null,"Photo"),e("th",null,"Name"),e("th",null,"Unit"),e("th",null,"Value"),e("th",null,"Note"),e("th",null,"Created At"),e("th",null,"Created By"),e("th",null,"Updated At"),e("th",null,"Updated By")])],-1),Qe=["onClick"],We={class:"bold"},Xe={class:"p-0"},et=["onClick"],tt=["src"],ft={__name:"index",async setup(y){let b,p;const{$moment:w}=be(),{pointFormat:$}=xe(),a={};a._TimeZoneOffset=new Date().getTimezoneOffset(),a.sort="created_at:desc";const D=ie("token"),{data:r}=([b,p]=ce(async()=>ye(async()=>{g().loading_full=!0;const{data:l,error:o,status:h}=await T("/items",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},params:a,retry:0});return g().loading_full=!1,h.value==="error"?(M().trigger(o),[]):l.value.data},"$hEoAojBvbD")),b=await b,p(),b),m=c(""),v=c({field:"created_at",by:"desc"}),i=c(-1),n=c({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),H=()=>{a.like="",m.value!=""&&(a.like=`id:%${m.value}%,name:%${m.value}%,value:%${m.value}%`),a.sort="",v.value.field&&(a.sort=v.value.field+":"+v.value.by)},k=c(null),I=async()=>{g().loading_full=!0,n.value.may_get_data=!1,a.page=n.value.page,a.page==1&&(r.value=[]),a.first_row&&delete a.first_row,a.page>1&&(a.first_row=JSON.stringify(r.value[0]));const{data:l,error:o,status:h}=await T("/items",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},params:a,retry:0});if(g().loading_full=!1,n.value.may_get_data=!0,h.value==="error"){M().trigger(o);return}n.value.page==1?(r.value=l.value.data,k.value&&(k.value.scrollTop=0)):n.value.page>1&&(r.value=[...r.value,...l.value.data]),l.value.data.length==0&&(n.value.is_last_record=!0)},P=async()=>{if(!n.value.may_get_data)return;let l=k.value;if(l.scrollLeft!=n.value.scrollLeft){n.value.scrollLeft=l.scrollLeft;return}n.value.is_last_record||!(Math.round(l.scrollTop)+l.clientHeight>=l.scrollHeight-1)||(n.value.page++,await I())},U=()=>{n.value.page=1,n.value.is_last_record=!1,H(),I()},N=de(),q=()=>{N.push({name:"data_item-form",query:{id:""}})},{display:L}=F();_e(F());const R=()=>{i.value==-1?L({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):N.push({name:"data_item-form",query:{id:r.value[i.value].id}})},z=c({}),x=c(!1),O=async()=>{x.value&&(x.value=!1)},K=()=>{i.value==-1?L({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(z.value={id:r.value[i.value].id},x.value=!0)},Y=async()=>{g().loading_full=!0;const l=new FormData;l.append("id",r.value[i.value].id),l.append("_method","DELETE");const{data:o,error:h,status:S}=await T("/item",{method:"post",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},body:l,retry:0});if(g().loading_full=!1,S.value==="error"){M().trigger(h);return}r.value.splice(i.value,1),i.value=-1,x.value=!1},A=c(!1),E=c(""),G=l=>{A.value=!0,E.value=l};return(l,o)=>{const h=te,S=oe,J=le,Z=se,Q=ae,W=ne,X=Se;return _(),f("div",Be,[d(h,{title:"List Item"}),e("div",Me,[e("div",Te,[e("button",{type:"button",name:"button",class:"p-1 m-1 text-2xl",onClick:o[0]||(o[0]=t=>q())},[d(S)]),e("button",{type:"button",name:"button",class:"p-1 m-1 text-2xl",onClick:o[1]||(o[1]=t=>R())},[d(J)]),e("button",{type:"button",name:"button",class:"p-1 m-1 text-2xl",onClick:o[2]||(o[2]=t=>K())},[d(Z)])]),e("form",je,[e("div",Ie,[Ne,B(e("input",{class:"",type:"text","onUpdate:modelValue":o[3]||(o[3]=t=>pe(m)?m.value=t:null),name:"search",placeholder:"Keyword"},null,512),[[fe,s(m)]])]),e("div",Le,[ze,B(e("select",{class:"","onUpdate:modelValue":o[4]||(o[4]=t=>s(v).field=t)},He,512),[[V,s(v).field]])]),e("div",Pe,[Ue,B(e("select",{class:"","onUpdate:modelValue":o[5]||(o[5]=t=>s(v).by=t)},Oe,512),[[V,s(v).by]])]),e("div",Ke,[e("button",{class:"",type:"submit",name:"button",onClick:o[6]||(o[6]=me(t=>U(),["prevent"]))},[d(Q,{class:"text-2xl"})])])]),e("div",Ye,[s(r).length==0?(_(),f("div",Ge," Maaf Tidak Ada Record ")):(_(),f("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:k,onScroll:P},[e("table",Je,[Ze,e("tbody",null,[(_(!0),f(ve,null,he(s(r),(t,C)=>(_(),f("tr",{key:C,onClick:ee=>i.value=C,class:ge(s(i)==C?"active":"")},[e("td",null,u(C+1)+".",1),e("td",We,u(t.id),1),e("td",Xe,[t.photo?(_(),f("div",{key:0,class:"absolute w-full h-full flex items-center justify-center cursor-pointer",onClick:ee=>G(t.photo)},[e("img",{src:t.photo||"/logistik/user-default.png",alt:"",class:"max-w-full max-h-full"},null,8,tt)],8,et)):j("",!0)]),e("td",null,u(t.name),1),e("td",null,u(t.unit.name),1),e("td",null,u(s($)(t.value)),1),e("td",null,u(t.note),1),e("td",null,u(s(w)(t.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,u(t.creator.username),1),e("td",null,u(s(w)(t.updated_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,u(t.updator.username),1)],10,Qe))),128))])])],544))])]),d(W,{type:"delete",show:s(x),data:s(z),fnClose:O,fnConfirm:Y},null,8,["show","data"]),d(X,{show:s(A),photo:s(E),fnClose:()=>{A.value=!1}},null,8,["show","photo","fnClose"])])}}};export{ft as default};
