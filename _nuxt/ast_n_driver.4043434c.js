import Z from"./Header.49f6bab0.js";import{_ as H}from"./client-only.131605cb.js";import{_ as R}from"./SelectMulti.vue.ff9c8563.js";import q from"./PrinterEye.089d691b.js";import L from"./Table2Column.bd3120d6.js";import{_ as G}from"./PDFView.vue.5308932a.js";import{r as d,f as K,g as Q,I as W,c as X,a as e,b as n,m as E,q as T,k as l,n as Y,w as B,t as N,x as O,F as ee,z as te,o as oe,p as le,e as se,A as f,B as S,E as ae}from"./entry.35634b8f.js";import{u as C}from"./useMyFetch.6cd47c90.js";import{u as ne}from"./useDownload.174f4da2.js";import{_ as ie}from"./_plugin-vue_export-helper.c27b6911.js";import"./Check.cdfe7eaf.js";import"./Times.91251ff3.js";const s=p=>(le("data-v-33327679"),p=p(),se(),p),re={class:"w-full h-full flex flex-col"},de={class:"w-full flex grow flex-col overflow-auto h-0 bg-gray-200 justify-center items-center p-2"},ce={class:"bg-white p-2 max-w-[350px] max-h-full overflow-auto"},_e={action:"#",class:"w-full flex flex-col sm:flex-row flex-wrap text-xs"},ue={class:"w-full p-1 flex flex-col"},fe=s(()=>e("div",{class:"font-bold"}," Tipe ",-1)),pe=s(()=>e("option",{value:"header"},"Header",-1)),me=s(()=>e("option",{value:"detail"},"Detail",-1)),ve=[pe,me],xe={class:"w-full p-1 flex flex-col"},he=s(()=>e("div",{class:"font-bold"}," Jenis ",-1)),we=s(()=>e("option",{value:""},null,-1)),ye=s(()=>e("option",{value:"UJ"},"Uang Jalan",-1)),ge=s(()=>e("option",{value:"SB"},"Uang Standby",-1)),be=[we,ye,ge],ke={class:"w-full sm:w-1/2 p-1 flex flex-col"},De=s(()=>e("div",{class:"font-bold"}," Tgl Dari ",-1)),Se={class:"text-red-500"},Ce={class:"w-full sm:w-1/2 p-1 flex flex-col"},Me=s(()=>e("div",{class:"font-bold"}," Tgl Sampai ",-1)),Ve={class:"text-red-500"},je={class:"w-full p-1 flex flex-col"},Ae=s(()=>e("div",{class:"font-bold"}," Lokasi ",-1)),$e={class:"w-full p-1 flex flex-col"},Ee=s(()=>e("div",{class:"font-bold"}," Nama ",-1)),Te={class:"w-full p-1 flex flex-col"},Ye=s(()=>e("div",{class:"font-bold"}," No Pol ",-1)),Be={class:"w-full p-1 flex items-end justify-end"},Ne=s(()=>e("div",{class:"text-left m-1"},"Download PDF",-1)),Oe=s(()=>e("div",{class:"text-left m-1"},"Download Excel",-1)),Fe={__name:"ast_n_driver",async setup(p){let m,M;const{$moment:V}=ae(),a={};a._TimeZoneOffset=new Date().getTimezoneOffset(),a.sort="tanggal:desc";const j=d({}),h=K("token"),c=d({from:"",to:""}),{data:w}=([m,M]=Q(async()=>te(async()=>{f().loading_full=!0;let t=[],o=[],_=[];const[r,k]=await Promise.all([C("/report/ast_n_driver/load_data",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},retry:0})]);return r.status.value!=="error"&&(t=r.data.value.list_xto,_=r.data.value.list_employee,o=r.data.value.list_vehicle),r.status.value==="error"&&S().trigger(r.error),f().loading_full=!1,{list_xto:t,list_employee:_,list_vehicle:o}},"$Aw9scsfjYZ")),m=await m,M(),m),y=d([]),g=d([]),b=d([]);w.value.list_xto.forEach(t=>{y.value.push({id:t,name:t,title:"",checked:!1})}),w.value.list_employee.forEach(t=>{g.value.push({id:t.id,name:t.name,title:t.role,checked:!1})}),w.value.list_vehicle.forEach(t=>{b.value.push({id:t.id,name:t.no_pol,title:"",checked:!1})});const v=d("header"),x=d(""),A=()=>{a._TimeZoneOffset=new Date().getTimezoneOffset(),a.date_from=c.value.from?V(c.value.from).format("YYYY-MM-DD"):"",a.date_to=c.value.to?V(c.value.to).format("YYYY-MM-DD"):"",a.list_xto=JSON.stringify(y.value.filter(t=>t.checked).map(t=>t.id)),a.list_employee=JSON.stringify(g.value.filter(t=>t.checked).map(t=>t.id)),a.list_vehicle=JSON.stringify(b.value.filter(t=>t.checked).map(t=>t.id)),a.type=v.value,a.jenis=x.value},{downloadFile:F,viewFile:Ie}=ne(),u=d(!1),$=d({}),I=async()=>{if(u.value==!0){u.value=!1;return}A(),f().loading_full=!0;const{data:t,error:o,status:_}=await C("/report/ast_n_driver/pdf_preview",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},params:a,retry:0});if(f().loading_full=!1,_.value==="error"){S().trigger(o);return}$.value=t.value,u.value=!0},U=async()=>{A(),f().loading_full=!0;const{data:t,error:o,status:_}=await C("/report/ast_n_driver/excel_download",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},params:a,retry:0});if(f().loading_full=!1,_.value==="error"){S().trigger(o);return}F(t.value)};return(t,o)=>{const _=Z,r=W("vue-date-picker"),k=H,D=R,z=q,J=L,P=G;return oe(),X(ee,null,[e("div",re,[n(_,{title:"Report Transaction"}),e("div",de,[e("div",ce,[e("form",_e,[e("div",ue,[fe,E(e("select",{"onUpdate:modelValue":o[0]||(o[0]=i=>Y(v)?v.value=i:null)},ve,512),[[T,l(v)]])]),e("div",xe,[he,E(e("select",{"onUpdate:modelValue":o[1]||(o[1]=i=>Y(x)?x.value=i:null)},be,512),[[T,l(x)]])]),e("div",ke,[De,n(k,null,{default:B(()=>[n(r,{modelValue:l(c).from,"onUpdate:modelValue":o[2]||(o[2]=i=>l(c).from=i),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1}),e("p",Se,N(l(j).date_from),1)]),e("div",Ce,[Me,n(k,null,{default:B(()=>[n(r,{modelValue:l(c).to,"onUpdate:modelValue":o[3]||(o[3]=i=>l(c).to=i),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1}),e("p",Ve,N(l(j).date_to),1)]),e("div",je,[Ae,n(D,{arr:l(y)},null,8,["arr"])]),e("div",$e,[Ee,n(D,{arr:l(g)},null,8,["arr"])]),e("div",Te,[Ye,n(D,{arr:l(b)},null,8,["arr"])]),e("div",Be,[e("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:o[4]||(o[4]=O(i=>I(),["prevent"]))},[e("div",null,[n(z,{class:"text-2xl"})]),Ne]),e("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:o[5]||(o[5]=O(i=>U(),["prevent"]))},[e("div",null,[n(J,{class:"text-2xl"})]),Oe])])])])])]),n(P,{show:l(u),pdfContent:l($),onClose:o[6]||(o[6]=i=>u.value=!l(u))},null,8,["show","pdfContent"])],64)}}},We=ie(Fe,[["__scopeId","data-v-33327679"]]);export{We as default};
