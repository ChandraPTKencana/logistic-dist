import{_ as V}from"./HeaderPopup.vue.2a23fcec.js";import{_ as B}from"./client-only.e68ff8ea.js";import{_ as N}from"./InputPointFormat.vue.368c6b68.js";import{r as y,g as P,f as S,J as q,k as b,L as F,o as g,c as w,a as t,b as c,l as o,t as p,w as Y,A as T,D as j,H as U,x as f,y as C}from"./entry.72ad639a.js";import{u as k}from"./useMyFetch.f486e350.js";import"./Times.55fb13ee.js";import"./_plugin-vue_export-helper.c27b6911.js";const z={class:"box-fixed"},E={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},H={class:"w-full flex flex-col items-center grow overflow-auto"},I={class:"w-full flex flex-row flex-wrap"},O={class:"w-6/12 sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},R=t("label",{for:""},"Tanggal",-1),J={key:0,class:"grow card-border"},K={key:1,class:"grow"},L={class:"text-red-500"},G={class:"w-6/12 sm:w-3/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Q=t("label",{for:""},"Nominal Potong",-1),W={class:"w-full"},X={class:"text-red-500"},Z={class:"w-full flex flex-col flex-wrap p-1"},ee=t("label",{for:""},"Keterangan",-1),te={class:"text-red-500"},ae={class:"w-full flex items-center justify-end"},ue={__name:"trx",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},potongan_mst_id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},emits:["updateRemainingCut"],setup(u,{emit:D}){const n=u,{$moment:v}=U(),x={id:-1,note:"",nominal_cut:"",tanggal:new Date},e=y({...x}),h=P("token"),i=y({}),M=async()=>{f().loading_full=!0,i.value={};const l=new FormData;l.append("tanggal",v(e.value.tanggal).format("Y-MM-DD")),l.append("potongan_mst_id",n.potongan_mst_id),l.append("note",e.value.note),l.append("nominal_cut",e.value.nominal_cut);let a="post",r=n.id;r==0||(l.append("id",r),l.append("_method","PUT"));const{data:d,error:_,status:m}=await k("/potongan_trx",{method:a,headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},body:l,retry:0});if(f().loading_full=!1,m.value==="error"){C().trigger(_,i);return}if(e.value.updated_at=d.value.updated_at,n.id<=0)e.value.id=d.value.id,e.value.created_at=d.value.created_at,n.p_data.unshift(e.value);else{let s=n.p_data.map(A=>A.id).indexOf(n.id);s>-1&&n.p_data.splice(s,1,{...e.value})}D("updateRemainingCut",d.value.remaining_cut),n.fnClose()},$=async()=>{f().loading_full=!0;const{data:l,error:a,status:r}=await k("/potongan_trx",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},params:{id:n.id},retry:0});if(f().loading_full=!1,r.value==="error"){C().trigger(a);return}e.value=l.value.data};return S(()=>n.show,(l,a)=>{l==!0&&(e.value={...x},i.value={},n.id!=0&&$())},{immediate:!0}),(l,a)=>{const r=V,d=q("vue-date-picker"),_=B,m=N;return b((g(),w("section",z,[t("div",null,[c(r,{title:"Form Potongan Trx",fn:u.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",E,[t("div",H,[t("div",I,[t("div",O,[R,o(e).trx_trp_id?(g(),w("div",J,[t("div",null,p(o(v)(o(e).tanggal).format("DD-MM-YYYY")),1)])):(g(),w("div",K,[c(_,null,{default:Y(()=>[c(d,{modelValue:o(e).tanggal,"onUpdate:modelValue":a[0]||(a[0]=s=>o(e).tanggal=s),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1})])),t("p",L,p(o(i).tanggal),1)]),t("div",G,[Q,t("div",W,[c(m,{class:"w-full h-full",type:"text",value:o(e).nominal_cut||0,onInput:a[1]||(a[1]=s=>o(e).nominal_cut=s),show:u.show,disabled:o(e).trx_trp_id},null,8,["value","show","disabled"])]),t("p",X,p(o(i).ref),1)]),t("div",Z,[ee,b(t("textarea",{"onUpdate:modelValue":a[2]||(a[2]=s=>o(e).note=s),rows:"10"}," ",512),[[T,o(e).note]]),t("p",te,p(o(i).note),1)])])]),t("div",ae,[t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:a[3]||(a[3]=s=>u.fnClose())}," Cancel "),t("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:a[4]||(a[4]=j(s=>M(),["prevent"]))}," Save ")])])])],512)),[[F,u.show]])}}};export{ue as default};
