import ae from"./Header.3ab42273.js";import se from"./Plus.c5a011d1.js";import oe from"./Edit.6bb58c2c.js";import le from"./Delete.eaa72127.js";import ne from"./Search.790ff312.js";import{_ as re}from"./PopupMini.vue.66ad9cdd.js";import ue from"./user.8fb44a23.js";import{_ as ie}from"./GAQR.vue.bc805a32.js";import{f as ce,g as de,r as i,h as _e,i as I,s as fe,c as g,a as e,b as _,m as F,v as pe,k as s,n as me,q as R,F as j,y as ve,z as he,A as f,B as C,o as y,C as ge,t as v,p as ye,e as ke,E as we}from"./entry.b8f45e1d.js";import{u as S}from"./useMyFetch.882d4718.js";import{_ as xe}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.eee7fe9a.js";import"./Exclamation.19df92dd.js";import"./HeaderPopup.vue.e89b6351.js";import"./useUtils.02680300.js";const c=k=>(ye("data-v-4c31444e"),k=k(),ke(),k),be={class:"w-full h-full flex flex-col"},De={class:"w-full flex grow flex-col overflow-auto h-0"},Ae={class:"w-full flex"},Ce={class:"w-full flex p-1"},Se={class:"grow"},$e=c(()=>e("div",{class:"font-bold"}," Keyword ",-1)),Te={class:"pl-1"},Me=c(()=>e("div",{class:"font-bold"}," Sort By ",-1)),Be=c(()=>e("option",{value:""},null,-1)),Fe=c(()=>e("option",{value:"username"},"Username",-1)),Ue=c(()=>e("option",{value:"hak_akses"},"Hak Akses",-1)),He=c(()=>e("option",{value:"is_active"},"Status",-1)),Le=[Be,Fe,Ue,He],ze={class:"pl-1"},Ee=c(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),Ie=c(()=>e("option",{value:"asc"},"Asc",-1)),Re=c(()=>e("option",{value:"desc"},"Desc",-1)),je=[Ie,Re],qe={class:"flex items-end pl-1"},Ne={class:"w-full flex justify-center items-center grow h-0 p-1"},Pe={key:0,class:""},Ve={class:"tacky"},Oe=c(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"Username"),e("th",null,"Hak Akses"),e("th",null,"Status"),e("th",null,"Tanggal Dibuat"),e("th",null,"Tanggal Diubah")])],-1)),Ye=["onClick"],Ke={class:"bold"},Qe={__name:"index",async setup(k){let w,U;const{$moment:H}=we(),r={};r._TimeZoneOffset=new Date().getTimezoneOffset();const x=ce("token"),{data:n}=([w,U]=de(async()=>he(async()=>{f().loading_full=!0;const{data:a,error:t,status:d}=await S("/users",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:r,retry:0});return f().loading_full=!1,d.value==="error"?(C().trigger(t),[]):a.value.data},"$4SJ9UL5Y8i")),w=await w,U(),w),m=i(""),p=i({field:"",by:"desc"}),u=i(-1),l=i({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),q=()=>{r.like="",m.value!=""&&(r.like=`id:%${m.value}%,username:%${m.value}%`),r.sort="",p.value.field&&(r.sort=p.value.field+":"+p.value.by)},b=i(null),L=async()=>{f().loading_full=!0,l.value.may_get_data=!1,r.page=l.value.page,r.page==1&&(n.value=[]);const{data:a,error:t,status:d}=await S("/users",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:r,retry:0});if(f().loading_full=!1,l.value.may_get_data=!0,d.value==="error"){C().trigger(t);return}l.value.page==1?(n.value=a.value.data,b.value&&(b.value.scrollTop=0)):l.value.page>1&&(n.value=[...n.value,...a.value.data]),a.value.data.length==0&&(l.value.is_last_record=!0)},N=async()=>{if(!l.value.may_get_data)return;let a=b.value;if(a.scrollLeft!=l.value.scrollLeft){l.value.scrollLeft=a.scrollLeft;return}l.value.is_last_record||!(Math.round(a.scrollTop)+a.clientHeight>=a.scrollHeight-1)||(l.value.page++,await L())},P=()=>{l.value.page=1,l.value.is_last_record=!1,q(),L()};_e();const D=i(!1),$=i(0),V=()=>{$.value=0,D.value=!0},{display:T}=I();fe(I());const O=()=>{u.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):($.value=n.value[u.value].id,D.value=!0)},z=i({}),h=i(!1),Y=async()=>{h.value&&(h.value=!1)},K=()=>{u.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(z.value={id:n.value[u.value].id},h.value=!0)},Q=async()=>{f().loading_full=!0;const a=new FormData;a.append("id",n.value[u.value].id),a.append("_method","DELETE");const{data:t,error:d,status:B}=await S("/user",{method:"post",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},body:a,retry:0});if(f().loading_full=!1,B.value==="error"){C().trigger(d);return}n.value.splice(u.value,1),u.value=-1,h.value=!1},E=i(""),M=i(!1),G=async()=>{if(u.value==-1){T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"});return}r.id=n.value[u.value].id,f().loading_full=!0;const{data:a,error:t,status:d}=await S("/ga_qr",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:r,retry:0});if(f().loading_full=!1,d.value==="error"){C().trigger(t);return}E.value=a.value,M.value=!0};return(a,t)=>{const d=ae,B=se,J=oe,Z=le,W=ne,X=re,ee=ue,te=ie;return y(),g(j,null,[e("div",be,[_(d,{title:"List User"}),e("div",De,[e("div",Ae,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[0]||(t[0]=o=>V())},[_(B)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=o=>O())},[_(J)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=o=>K())},[_(Z)]),e("button",{type:"button",name:"button",class:"m-1 text-xs",onClick:t[3]||(t[3]=o=>G())}," SET 2FA ")]),e("div",Ce,[e("div",Se,[$e,F(e("input",{class:"",type:"text","onUpdate:modelValue":t[4]||(t[4]=o=>me(m)?m.value=o:null),name:"search",placeholder:"Keyword"},null,512),[[pe,s(m)]])]),e("div",Te,[Me,F(e("select",{class:"","onUpdate:modelValue":t[5]||(t[5]=o=>s(p).field=o)},Le,512),[[R,s(p).field]])]),e("div",ze,[Ee,F(e("select",{class:"","onUpdate:modelValue":t[6]||(t[6]=o=>s(p).by=o)},je,512),[[R,s(p).by]])]),e("div",qe,[e("button",{class:"",type:"button",name:"button",onClick:t[7]||(t[7]=o=>P())},[_(W,{class:"text-2xl"})])])]),e("div",Ne,[s(n).length==0?(y(),g("div",Pe," Maaf Tidak Ada Record ")):(y(),g("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:N},[e("table",Ve,[Oe,e("tbody",null,[(y(!0),g(j,null,ve(s(n),(o,A)=>(y(),g("tr",{key:A,onClick:Ge=>u.value=A,class:ge(s(u)==A?"active":"")},[e("td",null,v(A+1)+".",1),e("td",Ke,v(o.username),1),e("td",null,v(o.hak_akses),1),e("td",null,v(o.is_active?"Aktif":"Nonaktif"),1),e("td",null,v(s(H)(o.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,v(s(H)(o.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,Ye))),128))])])],544))])])]),_(X,{type:"delete",show:s(h),data:s(z),fnClose:Y,fnConfirm:Q},null,8,["show","data"]),_(ee,{show:s(D),fnClose:()=>{D.value=!1},id:s($),p_data:s(n)},null,8,["show","fnClose","id","p_data"]),_(te,{show:s(M),fnClose:()=>{M.value=!1},qrCodeUrl:s(E)},null,8,["show","fnClose","qrCodeUrl"])],64)}}},dt=xe(Qe,[["__scopeId","data-v-4c31444e"]]);export{dt as default};
