import{r as o,f as F,g as pe,h as fe,i as c,C as ve,j as L,s as ye,c as x,b as d,a as _,k as ge,v as be,l,m as ke,n as C,w as A,q as he,x as p,y as U,o as u,z as S,d as R,t as J,B as q,_ as K}from"./entry.80f9400f.js";import we from"./Header.d832b074.js";import xe from"./Plus.ff7cfb63.js";import De from"./Edit.8ba83185.js";import Pe from"./Eyes.35a34929.js";import Ce from"./Signature.b3ac5cb1.js";import Ae from"./Line.0d89352b.js";import Se from"./Check.2d47ab0b.js";import Oe from"./TableView.85942596.js";import{u as f}from"./useUtils.4905e334.js";import{u as Y}from"./useMyFetch.a3705501.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.e94f12c9.js";import"./Adjust.bbeeda20.js";import"./TableHeaderEye.75695600.js";import"./Times.533e4a65.js";import"./ClearAll.84555876.js";import"./client-only.b5fd6b3a.js";import"./ClearEach.3dd0da5e.js";import"./CaretLeftDoubleBold.8dc8d473.js";import"./CaretLeftBold.1ba5db7b.js";import"./CaretRightBold.b313526e.js";import"./CaretRightDoubleBold.22e21eb5.js";const $e=q(()=>K(()=>import("./mst.4c1aba83.js"),["./mst.4c1aba83.js","./HeaderPopup.vue.def29a01.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./WidthMiniList.vue.0c640245.js","./WidthMiniPart.vue.1a42f0c4.js","./InputPointFormat.vue.53b3b8a4.js","./AttachmentSingle.62897b4d.js","./PDFJsView.4b00c268.js","./PDFJsView.4e9fad9f.css","./part.327cc64a.js","./Plus.ff7cfb63.js","./Edit.8ba83185.js","./Delete.fbe43ce9.js","./Signature.b3ac5cb1.js","./Calculator.45ac52f7.js","./Search.e94f12c9.js","./Line.0d89352b.js","./Check.2d47ab0b.js","./trx.e30634db.js","./useMyFetch.a3705501.js","./trx_validasi.54894e66.js","./useUtils.4905e334.js"],import.meta.url).then(v=>v.default||v)),je=q(()=>K(()=>import("./validasi.99cf9439.js"),["./validasi.99cf9439.js","./HeaderPopup.vue.def29a01.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./WidthMiniPart.vue.1a42f0c4.js","./AttachmentSingle.62897b4d.js","./PDFJsView.4b00c268.js","./PDFJsView.4e9fad9f.css","./useUtils.4905e334.js","./useMyFetch.a3705501.js"],import.meta.url).then(v=>v.default||v)),Ne={class:"w-full h-full flex flex-col"},Te={class:"w-full flex grow flex-col overflow-auto h-0"},ze={class:"w-full flex justify-between flex-wrap"},Be={class:"grow flex"},Ie={class:"m-1"},Me=_("option",{value:"undone"},"Undone",-1),Ve=_("option",{value:"done"},"Done",-1),Ee=_("option",{value:"deleted"},"Trash",-1),He=_("option",{value:"all"},"All",-1),Fe=[Me,Ve,Ee,He],dt={__name:"index",async setup(v){let D,T;const Z=e=>e.deleted==1?"!bg-red-400":e.val>0&&e.val1>0&&e.remaining_cut==0?"!bg-blue-300":"",m=o("undone");F(()=>m.value,e=>{I()},{immediate:!1});const n={};n._TimeZoneOffset=new Date().getTimezoneOffset(),n.sort="created_at:desc";const z=pe("token"),{data:G}=([D,T]=fe(async()=>he(async()=>{let e=[];p().loading_full=!0;const{data:t,error:h,status:N}=await Y("/potongan_msts",{method:"get",headers:{Authorization:`Bearer ${z.value}`,Accept:"application/json"},params:{filter_status:m},retry:0});return p().loading_full=!1,N.value==="error"?(U().trigger(h),{potongan_msts:e}):(e=t.value.data,{potongan_msts:e})},"$4H5grU4zhJ")),D=await D,T(),D),r=o(G.value.potongan_msts);o("");const O=o({field:"created_at",by:"desc"}),s=o(-1),i=o({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),y=c(()=>r.value[s.value]),Q=()=>{n.like="";let e=JSON.parse(JSON.stringify(p()._tv.global_keyword));e!=""&&(n.like=`id:%${e}%,employee_name:%${e}%,no_pol:%${e}%,kejadian:%${e}%,status:%${e}%`),n.sort="",O.value.field&&(n.sort=O.value.field+":"+O.value.by),n.filter_model=JSON.stringify(p()._tv.filter_model)};o(null);const B=async()=>{p().loading_full=!0,i.value.may_get_data=!1,n.page=i.value.page,n.page==1&&(r.value=[]),n.first_row&&delete n.first_row,n.page>1&&(n.first_row=JSON.stringify(r.value[0])),n.filter_status=m.value;const{data:e,error:t,status:h}=await Y("/potongan_msts",{method:"get",headers:{Authorization:`Bearer ${z.value}`,Accept:"application/json"},params:n,retry:0});if(p().loading_full=!1,i.value.may_get_data=!0,h.value==="error"){U().trigger(t);return}i.value.page==1?r.value=e.value.data:i.value.page>1&&(r.value=[...r.value,...e.value.data]),e.value.data.length==0&&(i.value.is_last_record=!0),p()._tv.filter_box=!1},I=()=>{s.value=-1,i.value.page=1,i.value.is_last_record=!1,Q(),B()};ve();const g=o(!1),P=o(0),b=o(0),k=o(!1),W=()=>{P.value=0,k.value=!1,b.value=!1,g.value=!0},{display:$}=L();ye(L());const X=()=>{s.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=r.value[s.value].id,k.value=!1,b.value=!1,g.value=!0)},j=o(!1),M=o(0),ee=()=>{s.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(M.value=r.value[s.value].id,k.value=!0,b.value=!1,j.value=!0)},te=()=>{s.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=r.value[s.value].id,k.value=!0,b.value=!1,g.value=!0)},V=o(!1);o({}),o(!1);const ae=o("");F(()=>ae.value,e=>{e.trim().length>0?V.value=!0:V.value=!1},{immediate:!1});const oe=o([{key:"no",label:"No",isai:!0},{key:"valx",label:"APP",childs:[{key:"val",label:"App 1",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val1",label:"App 2",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]}]},{key:"id",label:"ID",filter_on:1,type:"number",sort:{priority:1,type:"desc"}},{key:"employee_name",label:"Nama Pekerja",freeze:1,filter_on:1,type:"string"},{key:"no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"kejadian",label:"Kejadian",filter_on:1,type:"string"},{key:"nominal",label:"Nominal",class:" justify-end",type:"number"},{key:"nominal_cut",label:"Nominal Potongan",class:" justify-end",type:"number"},{key:"remaining_cut",label:"Sisa Potongan",class:" justify-end",type:"number"},{key:"status",label:"Status",class:" justify-end",type:"number"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]);c(()=>s.value>-1&&[void 0,0].indexOf(y.value.deleted)>-1&&f().checkPermission("potongan_mst.create"));const le=c(()=>["undone","done","deleted","all"].indexOf(m.value)>-1&&f().checkPermission("potongan_mst.create")),ne=c(()=>s.value>-1&&f().checkPermission("potongan_mst.view")),se=c(()=>s.value>-1&&[void 0,0].indexOf(y.value.deleted)>-1&&f().checkPermissions(["potongan_mst.modify","potongan_trx.create","potongan_trx.modify","potongan_trx.remove"])),re=c(()=>s.value>-1&&[void 0,0].indexOf(y.value.deleted)>-1&&(f().checkPermission("potongan_mst.val")&&[void 0,0].indexOf(y.value.val)>-1||f().checkPermission("potongan_mst.val1")&&[void 0,0].indexOf(y.value.val1)>-1));return c(()=>s.value>-1&&f().checkPermission("potongan_mst.remove")&&[void 0,0].indexOf(y.value.deleted)>-1),(e,t)=>{const h=we,N=xe,ie=De,ue=Pe,_e=Ce,E=Ae,H=Se,de=Oe,me=$e,ce=je;return u(),x("div",Ne,[d(h,{title:"List Potongan"}),_("div",Te,[_("div",ze,[_("div",Be,[_("div",Ie,[ge(_("select",{class:"","onUpdate:modelValue":t[0]||(t[0]=a=>ke(m)?m.value=a:null)},Fe,512),[[be,l(m)]])]),l(le)?(u(),x("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=a=>W())},[d(N)])):C("",!0),l(se)?(u(),x("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=a=>X())},[d(ie)])):C("",!0),l(ne)?(u(),x("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[3]||(t[3]=a=>te())},[d(ue)])):C("",!0),l(re)?(u(),x("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[4]||(t[4]=a=>ee())},[d(_e)])):C("",!0)])]),d(de,{thead:l(oe),selected:l(s),onSetSelected:t[5]||(t[5]=a=>s.value=a),tbody:l(r),fnCallData:B,scrolling:l(i),onSetScrollingPage:t[6]||(t[6]=a=>l(i).page=a),onDoFilter:t[7]||(t[7]=a=>I()),rowBgColor:Z},{val:A(({item:a})=>[a.val?(u(),S(H,{key:1})):(u(),S(E,{key:0}))]),val1:A(({item:a})=>[a.val1?(u(),S(H,{key:1})):(u(),S(E,{key:0}))]),employee_name:A(({item:a})=>{var w;return[R(J((w=a.employee)==null?void 0:w.name),1)]}),deleted_by_username:A(({item:a})=>{var w;return[R(J((w=a.deleted_by)==null?void 0:w.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])]),d(me,{show:l(g),fnClose:()=>{g.value=!1},id:l(P),p_data:l(r),is_copy:l(b),is_view:l(k)},null,8,["show","fnClose","id","p_data","is_copy","is_view"]),d(ce,{show:l(j),fnClose:()=>{j.value=!1},id:l(M),p_data:l(r)},null,8,["show","fnClose","id","p_data"])])}}};export{dt as default};
