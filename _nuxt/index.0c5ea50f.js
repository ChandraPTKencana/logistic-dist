import{_ as Re}from"./Header.03011c32.js";import{_ as Ve,a as Fe}from"./ac_accs.aaae9e19.js";import{_ as Te}from"./Plus.5c4fb5d7.js";import{_ as Ne}from"./Edit.d556bcc7.js";import{_ as Be}from"./Delete.7412e1f4.js";import{_ as He}from"./Signature.fa631486.js";import{_ as ze}from"./Search.06448cc3.js";import{_ as Me}from"./Line.ef2a08c0.js";import{_ as ge}from"./Check.e1435bcb.js";import{_ as Ee}from"./PopupMini.vue.627fde59.js";import{_ as Ae}from"./HeaderPopup.vue.3dbe1371.js";import{_ as Le,a as Oe}from"./ToolsPopup.2e2c1f3c.js";import{_ as Ye}from"./InputPointFormat.vue.f5325e02.js";import{_ as Pe}from"./Times.f09ef1bc.js";import{r as f,f as he,H as ke,J as _e,g as $e,o,c as r,h as B,v as De,a as e,b as $,k as t,j as te,t as n,l as pe,F as O,n as re,x as V,G as g,d as K,q as S,L as H,m as je,y as se,p as Se,e as Ie,s as qe,D as Je,B as Ke,I as Qe,i as Ce,w as Ge,E as Xe,N as Ze}from"./entry.1e961bb7.js";import{u as ue}from"./useUtils.0b7c2619.js";import{u as le}from"./useMyFetch.a26a0131.js";import{_ as Ue}from"./_plugin-vue_export-helper.c27b6911.js";const h=b=>(Se("data-v-94ce5a47"),b=b(),Ie(),b),We={class:"box-fixed"},et={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},tt={class:"w-full flex flex-col items-center grow overflow-auto"},st={class:"w-full flex flex-row flex-wrap"},lt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ot=h(()=>e("label",{for:""},"To",-1)),at=["disabled"],nt={class:"text-red-500"},ct={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},it=h(()=>e("label",{for:""},"Jenis",-1)),ut=["disabled"],rt=h(()=>e("option",{value:"PK"},"PK",-1)),dt=h(()=>e("option",{value:"CPO"},"CPO",-1)),_t=h(()=>e("option",{value:"TBS"},"TBS",-1)),pt=[rt,dt,_t],ft={class:"text-red-500"},vt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},mt=h(()=>e("label",{for:""},"Harga",-1)),ht={class:"card-border disabled"},xt={class:"text-red-500"},wt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},yt=h(()=>e("label",{for:""},"Asal Peralihan",-1)),bt=["disabled"],kt=h(()=>e("option",{value:""},null,-1)),gt=["value"],$t={class:"text-red-500"},jt={class:"w-full sm:w-4/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Ct=h(()=>e("label",{for:""},"Tipe",-1)),Tt=["disabled"],At={class:"text-red-500"},Pt={class:"w-full sm:w-4/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Dt=h(()=>e("label",{for:""},"Ket. Untuk Remarks",-1)),St=["disabled"],It={class:"text-red-500"},qt={class:"w-full flex flex-col sm:flex-row grow p-1 justify-between flex-wrap 2xl:overflow-hidden"},Ut={class:"w-full max-w-full p-0 2xl:pr-1 2xl:w-1/2 2xl:max-h-full 2xl:overflow-auto"},Rt={class:"w-full",role:"sticky"},Vt={class:"tacky w-full",style:{"white-space":"normal"}},Ft={class:"sticky -top-1 !z-[2]"},Nt=["colspan"],Bt={class:"sticky top-7 !z-[2]"},Ht={key:0,class:"min-w-[50px] !w-[50px] max-w-[50px]"},zt=h(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),Mt=h(()=>e("th",null,"Desc",-1)),Et=h(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Harga @",-1)),Lt=h(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"Qty",-1)),Ot={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Yt=h(()=>e("br",null,null,-1)),Jt={class:"text-sm"},Kt=h(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"For Remarks",-1)),Qt={ref:"to_move"},Gt=["data-index"],Xt={key:0,class:"tools cell"},Zt={class:"w-full h-full flex items-center justify-center"},Wt=["onClick"],es={class:"cell"},ts={class:"w-full h-full flex items-center justify-center"},ss=["disabled","onUpdate:modelValue"],ls={class:"w-full h-full flex items-center justify-center"},os={class:"w-full h-full flex items-center justify-center"},as={class:"cell"},ns={class:"w-full h-full flex items-center justify-center unselectable"},cs={class:"w-full h-full flex items-center justify-center"},is={key:0,class:"text-3xl"},us=["onClick"],rs={key:0},ds={class:"tools cell"},_s={class:"w-full max-w-full max-h-full px-0 py-2 2xl:pl-1 2xl:py-0 2xl:w-1/2 2xl:overflow-auto"},ps={class:"w-full",role:"sticky"},fs={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},vs={class:"sticky -top-1 !z-[2]"},ms=["colspan"],hs={class:"sticky top-7 !z-[2]"},xs={key:0,class:"min-w-[30px] !w-[30px] max-w-[30px]"},ws=h(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),ys={key:1,class:"min-w-[30px] !w-[30px] max-w-[30px]"},bs=h(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),ks=h(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),gs=h(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),$s=h(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),js=h(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Amount",-1)),Cs=h(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Qty",-1)),Ts=h(()=>e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"For",-1)),As={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Ps=h(()=>e("br",null,null,-1)),Ds={class:"text-sm"},Ss={ref:"to_move"},Is=["data-index"],qs={key:0,class:"tools cell"},Us={class:"w-full h-full flex items-center justify-center"},Rs=["onClick"],Vs={key:1,class:"cell"},Fs={class:"w-full h-full flex items-center justify-center"},Ns=["onClick"],Bs=["onClick","disabled"],Hs={class:"w-full h-full flex items-center justify-center"},zs={class:"w-full h-full flex items-center justify-center"},Ms={class:"w-full h-full flex items-center justify-center"},Es={class:"cell"},Ls={class:"w-full h-full flex items-center justify-center"},Os=["disabled","onUpdate:modelValue"],Ys={class:"w-full h-full flex items-center justify-center"},Js={class:"w-full h-full flex items-center justify-center"},Ks={class:"w-full h-full flex items-center justify-center"},Qs=["onUpdate:modelValue","disabled"],Gs=h(()=>e("option",{value:"Supir"},"Supir",-1)),Xs=h(()=>e("option",{value:"Kernet"},"Kernet",-1)),Zs=[Gs,Xs],Ws={class:"cell"},el={class:"w-full h-full flex items-center justify-center unselectable"},tl={key:0},sl={class:"tools cell"},ll={class:"w-full flex items-center justify-end"},ol={__name:"ujalan",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(b){const w=b,{pointFormat:E}=ue(),U={id:-1,xto:"",tipe:"",jenis:"",harga:0,note_for_remarks:"",transition_from:"",details:[],details2:[]},p=f({...U}),c=he("token"),R=f({}),oe=f([{xdesc:"Timbangan",qty:1,harga:55e3},{xdesc:"Retribusi TPR",qty:1,harga:23e3},{xdesc:"Parkir & Nginap",qty:1,harga:1e4},{xdesc:"Penitipan Alat (Dongkrak)",qty:1,harga:5e3},{xdesc:"Ikas Danau",qty:1,harga:1e4},{xdesc:"U.Bongkar + Ambil surat",qty:1,harga:35e3},{xdesc:"Perbaikan Jalan Pujut",qty:1,harga:1e4},{xdesc:"Gaji Supir",qty:1,harga:0},{xdesc:"Gaji Kernet",qty:1,harga:0},{xdesc:"U.Extrafooding",qty:1,harga:2e4}]);f([]);const d=f([]),_=f([]),M=f({ordinal:0,id:-1,xdesc:"",qty:1,harga:0,for_remarks:0,p_status:""}),T=f({ordinal:0,id:-1,ac_account_id:"",ac_account_name:"",ac_account_code:"",description:"",qty:1,amount:0,xfor:"",p_status:""}),I=()=>{oe.value.forEach(a=>{d.value.filter(l=>l.xdesc==a.xdesc).length==0&&d.value.push({...a,ordinal:0,id:-1,p_status:"Add"})})},F=f(!1),k=()=>{F.value=!1},A=a=>{_.value[P.value].ac_account_id=a.ac_account_id,_.value[P.value].ac_account_code=a.ac_account_code,_.value[P.value].ac_account_name=a.ac_account_name,F.value=!1},Y=(a,l)=>{P.value=l,F.value=!0},N=(a,l)=>{_.value[l].ac_account_id="",_.value[l].ac_account_code="",_.value[l].ac_account_name=""},{display:L}=ke(),v=async()=>{if(_.value.length>0&&j.value!=ae.value){L({show:!0,status:"Failed",message:"Total tidak cocok"});return}V().loading_full=!0,R.value={};const a=new FormData;a.append("xto",p.value.xto),a.append("tipe",p.value.tipe),a.append("jenis",p.value.jenis),a.append("harga",p.value.harga),a.append("note_for_remarks",p.value.note_for_remarks),a.append("transition_from",p.value.transition_from),a.append("details",JSON.stringify(d.value)),a.append("details2",JSON.stringify(_.value));let l="post",J=w.is_copy?0:w.id;J==0||(a.append("id",J),a.append("_method","PUT"));const{data:z,error:D,status:G}=await le("/ujalan",{method:l,headers:{Authorization:`Bearer ${c.value}`,Accept:"application/json"},body:a,retry:0});if(V().loading_full=!1,G.value==="error"){se().trigger(D,R);return}if(J<=0)p.value.id=z.value.id,p.value.created_at=z.value.created_at,p.value.updated_at=z.value.updated_at,w.p_data.unshift(p.value);else{p.value.updated_at=z.value.updated_at;let X=w.p_data.map(ie=>ie.id).indexOf(J);X>=-1&&w.p_data.splice(X,1,{...p.value})}w.fnClose()},j=_e(()=>{let a=0;return d.value.forEach(l=>{l.p_status!="Remove"&&(a+=l.qty*l.harga)}),p.value.harga=a,a}),ae=_e(()=>{let a=0;return _.value.forEach(l=>{l.p_status!="Remove"&&(a+=l.qty*l.amount)}),a}),q=f(-1),P=f(-1),ne=f(!1),ce=f({left:0,top:0}),Z=f(!1),fe=f({left:0,top:0}),de=(a,l)=>{q.value=l,ne.value=!0,ce.value={left:a.clientX,top:a.clientY}},ve=(a,l)=>{P.value=l,Z.value=!0,fe.value={left:a.clientX,top:a.clientY}},W=()=>{d.value.push({...M.value,p_status:"Add"})},Q=()=>{_.value.push({...T.value,p_status:"Add"})},xe=()=>{ne.value=!1},we=()=>{Z.value=!1},ye=(a="")=>{if(a=="insert")d.value.splice(q.value,0,{...M.value,p_status:"Add"});else if(a=="delete")d.value[q.value].p_status=="Edit"?d.value[q.value].p_status="Remove":d.value.splice(q.value,1);else if(a=="move_top"){let l=d.value[q.value];d.value.splice(q.value,1),d.value.splice(q.value-1,0,{...l})}else if(a=="move_bottom"){let l=d.value[q.value];d.value.splice(q.value,1),d.value.splice(q.value+1,0,{...l})}ne.value=!1},m=(a="")=>{if(a=="insert")_.value.splice(P.value,0,{...T.value,p_status:"Add"});else if(a=="delete")_.value[P.value].p_status=="Edit"?_.value[P.value].p_status="Remove":_.value.splice(P.value,1);else if(a=="move_top"){let l=_.value[P.value];_.value.splice(P.value,1),_.value.splice(P.value-1,0,{...l})}else if(a=="move_bottom"){let l=_.value[P.value];_.value.splice(P.value,1),_.value.splice(P.value+1,0,{...l})}Z.value=!1},i=he("role"),u=_e(()=>p.value.val&&p.value.val1||i.value=="Logistic"&&p.value.val||i.value=="PabrikTransport"&&p.value.val1),ee=async()=>{V().loading_full=!0;const{data:a,error:l,status:J}=await le("/ujalan_",{method:"get",headers:{Authorization:`Bearer ${c.value}`,Accept:"application/json"},params:{id:w.id},retry:0});if(V().loading_full=!1,J.value==="error"){se().trigger(l);return}p.value=a.value.data;let z="Edit";w.is_copy&&(z="Add",p.value.val=0,p.value.val1=0),d.value=a.value.data.details.map(D=>(D.p_status=z,D.key=D.ordinal,D)),_.value=a.value.data.details2.map(D=>(D.p_status=z,D.key=D.ordinal,D))};return $e(()=>w.show,(a,l)=>{a==!0&&(p.value={...U},d.value=[],_.value=[],w.id!=0&&ee())},{immediate:!0}),(a,l)=>{const J=Ae,z=Le,D=Ye,G=Pe,X=ge,ie=Te,me=Oe,be=Ve;return o(),r(O,null,[B(e("section",We,[e("div",null,[$(J,{title:"Form Ujalan",fn:b.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",et,[e("div",tt,[e("div",st,[e("div",lt,[ot,B(e("input",{"onUpdate:modelValue":l[0]||(l[0]=s=>t(p).xto=s),disabled:t(i)=="PabrikTransport"||t(u)},null,8,at),[[te,t(p).xto]]),e("p",nt,n(t(R).xto),1)]),e("div",ct,[it,B(e("select",{"onUpdate:modelValue":l[1]||(l[1]=s=>t(p).jenis=s),disabled:t(i)=="PabrikTransport"||t(u)},pt,8,ut),[[pe,t(p).jenis]]),e("p",ft,n(t(R).jenis),1)]),e("div",vt,[mt,e("div",ht,n(t(E)(t(j))),1),e("p",xt,n(t(R).harga),1)]),e("div",wt,[yt,B(e("select",{"onUpdate:modelValue":l[2]||(l[2]=s=>t(p).transition_from=s),disabled:t(i)=="PabrikTransport"||t(u)},[kt,(o(!0),r(O,null,re(t(V)().list_pabrik,s=>(o(),r("option",{value:s},n(s),9,gt))),256))],8,bt),[[pe,t(p).transition_from]]),e("p",$t,n(t(R).transition_from),1)]),e("div",jt,[Ct,B(e("textarea",{"onUpdate:modelValue":l[3]||(l[3]=s=>t(p).tipe=s),disabled:t(i)=="PabrikTransport"||t(u)},null,8,Tt),[[te,t(p).tipe]]),e("p",At,n(t(R).tipe),1)]),e("div",Pt,[Dt,B(e("textarea",{"onUpdate:modelValue":l[4]||(l[4]=s=>t(p).note_for_remarks=s),disabled:t(i)=="PabrikTransport"||t(u)},null,8,St),[[te,t(p).note_for_remarks]]),e("p",It,n(t(R).note_for_remarks),1)])]),e("div",qt,[e("div",Ut,[e("div",Rt,[e("table",Vt,[e("thead",null,[e("tr",Ft,[e("td",{colspan:t(i)!="PabrikTransport"&&!t(u)?7:6,class:"!bg-slate-800 text-white font-bold"}," Detail Uang Jalan ",8,Nt)]),e("tr",Bt,[t(i)!="PabrikTransport"&&!t(u)?(o(),r("th",Ht,[e("button",{type:"button",name:"button",class:"bg-yellow-600",onClick:l[5]||(l[5]=s=>I())}," Default In ")])):g("",!0),zt,Mt,Et,Lt,e("th",Ot,[K("Total "),Yt,K(),e("span",Jt,"("+n(t(E)(t(j)))+")",1)]),Kt])]),e("tbody",Qt,[(o(!0),r(O,null,re(t(d),(s,C)=>(o(),r(O,{key:C},[s.p_status!="Remove"?(o(),r("tr",{key:0,"data-index":C},[t(i)!="PabrikTransport"&&!t(u)?(o(),r("td",Xt,[e("div",Zt,[e("button",{type:"button",name:"button",onClick:y=>de(y,C)},[$(z)],8,Wt)])])):g("",!0),e("td",null,n(C+1)+".",1),e("td",es,[e("div",ts,[B(e("textarea",{disabled:t(i)=="PabrikTransport"||t(u),class:"p-1 w-full","onUpdate:modelValue":y=>s.xdesc=y,cols:"7",rows:"2"},null,8,ss),[[te,s.xdesc]])])]),e("td",{class:S(["cell bold",t(i)=="PabrikTransport"||t(u)?"unselectable":""])},[e("div",ls,[(o(),H(D,{key:C,class:"w-full h-full p-1",type:"text",value:s.harga||0,onInput:y=>s.harga=y,show:b.show,disabled:t(i)=="PabrikTransport"||t(u)},null,8,["value","onInput","show","disabled"]))])],2),e("td",{class:S(["cell",t(i)=="PabrikTransport"||t(u)?"unselectable":""])},[e("div",os,[(o(),H(D,{key:C,class:"w-full h-full p-1",type:"text",value:s.qty||0,onInput:y=>s.qty=y,show:b.show,disabled:t(i)=="PabrikTransport"||t(u)},null,8,["value","onInput","show","disabled"]))])],2),e("td",as,[e("div",ns,n(t(E)(s.qty*s.harga||0)),1)]),e("td",{class:S(["cell",t(i)=="PabrikTransport"||t(u)?"unselectable":""])},[e("div",cs,[t(i)=="PabrikTransport"||t(u)?(o(),r("div",is,[s.for_remarks==0?(o(),H(G,{key:0,class:"text-red-800"})):(o(),H(X,{key:1,class:"text-green-800"}))])):(o(),r("button",{key:1,type:"button",onClick:y=>s.for_remarks=s.for_remarks?0:1,class:S(["text-white w-auto rounded text-xl",s.for_remarks?"bg-green-600":"bg-red-600"])},[s.for_remarks==0?(o(),H(G,{key:0})):(o(),H(X,{key:1}))],10,us))])],2)],8,Gt)):g("",!0)],64))),128)),t(i)!="PabrikTransport"&&!t(u)?(o(),r("tr",rs,[e("td",ds,[e("button",{type:"button",name:"button",onClick:l[6]||(l[6]=s=>W())},[$(ie)])])])):g("",!0)],512)])])]),e("div",_s,[e("div",ps,[e("table",fs,[e("thead",null,[e("tr",vs,[e("td",{colspan:t(u)?9:11,class:"!bg-slate-800 text-white font-bold"}," Detail PVR ",8,ms)]),e("tr",hs,[t(u)?g("",!0):(o(),r("th",xs)),ws,t(u)?g("",!0):(o(),r("th",ys)),bs,ks,gs,$s,js,Cs,Ts,e("th",As,[K("Total "),Ps,K(),e("span",Ds,"("+n(t(E)(t(ae)))+")",1)])])]),e("tbody",Ss,[(o(!0),r(O,null,re(t(_),(s,C)=>(o(),r(O,{key:C},[s.p_status!="Remove"?(o(),r("tr",{key:0,"data-index":C},[t(u)?g("",!0):(o(),r("td",qs,[e("div",Us,[e("button",{type:"button",name:"button",onClick:y=>ve(y,C)},[$(z)],8,Rs)])])),e("td",null,n(C+1)+".",1),t(u)?g("",!0):(o(),r("td",Vs,[e("div",Fs,[s.ac_account_id?(o(),r("button",{key:1,type:"button",onClick:y=>N(y,C),disabled:s.confirm_by},[$(G,{class:"font-bold text-2xl"})],8,Bs)):(o(),r("button",{key:0,type:"button",name:"button",onClick:y=>Y(y,C)}," ... ",8,Ns))])])),e("td",{class:S(["cell bold",t(u)?"unselectable":""])},[e("div",Hs,n(s.ac_account_id),1)],2),e("td",{class:S(["cell bold",t(u)?"unselectable":""])},[e("div",zs,n(s.ac_account_code),1)],2),e("td",{class:S(["cell bold",t(u)?"unselectable":""])},[e("div",Ms,n(s.ac_account_name),1)],2),e("td",Es,[e("div",Ls,[B(e("textarea",{disabled:t(u),class:"p-1 w-full","onUpdate:modelValue":y=>s.description=y,cols:"7",rows:"2"},null,8,Os),[[te,s.description]])])]),e("td",{class:S(["cell bold",t(u)?"unselectable":""])},[e("div",Ys,[(o(),H(D,{key:C,class:"w-full h-full p-1",type:"text",value:s.amount||0,onInput:y=>s.amount=y,show:b.show,disabled:t(u)},null,8,["value","onInput","show","disabled"]))])],2),e("td",{class:S(["cell",t(u)?"unselectable":""])},[e("div",Js,[(o(),H(D,{key:C,class:"w-full h-full p-1",type:"text",value:s.qty||0,onInput:y=>s.qty=y,show:b.show,disabled:t(u)},null,8,["value","onInput","show","disabled"]))])],2),e("td",{class:S(["cell",t(u)?"unselectable":""])},[e("div",Ks,[B(e("select",{class:"h-full","onUpdate:modelValue":y=>s.xfor=y,disabled:t(u)},Zs,8,Qs),[[pe,s.xfor]])])],2),e("td",Ws,[e("div",el,n(t(E)(s.qty*s.amount||0)),1)])],8,Is)):g("",!0)],64))),128)),t(u)?g("",!0):(o(),r("tr",tl,[e("td",sl,[e("button",{type:"button",name:"button",onClick:l[7]||(l[7]=s=>Q())},[$(ie)])])]))],512)])])])])]),e("div",ll,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:l[8]||(l[8]=s=>b.fnClose())}," Cancel "),t(u)?g("",!0):(o(),r("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:l[9]||(l[9]=je(s=>v(),["prevent"]))}," Save "))])])])],512),[[De,b.show]]),$(me,{show:t(ne),coor:t(ce),fn:xe,data:t(d),data_index:t(q),onReplyAct:l[10]||(l[10]=s=>ye(s))},null,8,["show","coor","data","data_index"]),$(me,{show:t(Z),coor:t(fe),fn:we,data:t(_),data_index:t(P),onReplyAct:l[11]||(l[11]=s=>m(s))},null,8,["show","coor","data","data_index"]),$(be,{show:t(F),fnClose:k,fnSelect:A},null,8,["show"])],64)}}},al=Ue(ol,[["__scopeId","data-v-94ce5a47"]]);const x=b=>(Se("data-v-77e05035"),b=b(),Ie(),b),nl={class:"box-fixed"},cl={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},il={class:"w-full flex flex-col items-center grow overflow-auto"},ul={class:"w-full flex flex-row flex-wrap"},rl={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},dl=x(()=>e("label",{for:""},"To",-1)),_l={class:"card-border"},pl={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},fl=x(()=>e("label",{for:""},"Jenis",-1)),vl={class:"card-border"},ml={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},hl=x(()=>e("label",{for:""},"Harga",-1)),xl={class:"card-border"},wl={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},yl=x(()=>e("label",{for:""},"Asal Peralihan",-1)),bl={class:"card-border"},kl={class:"w-full sm:w-4/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},gl=x(()=>e("label",{for:""},"Tipe",-1)),$l={class:"card-border"},jl={class:"w-full sm:w-4/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Cl=x(()=>e("label",{for:""},"Ket. Untuk Remarks",-1)),Tl={class:"card-border"},Al={class:"w-full flex flex-col sm:flex-row grow p-1 justify-between flex-wrap 2xl:overflow-hidden"},Pl={class:"w-full p-0 2xl:pr-1 2xl:w-1/2 2xl:h-full 2xl:overflow-auto"},Dl={class:"w-full",role:"sticky"},Sl={class:"tacky w-full",style:{"white-space":"normal"}},Il=x(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"6",class:"!bg-slate-800 text-white font-bold"}," Detail Uang Jalan ")],-1)),ql={class:"sticky top-8 !z-[2]"},Ul=x(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),Rl=x(()=>e("th",null,"Desc",-1)),Vl=x(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Harga @",-1)),Fl=x(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"Qty",-1)),Nl={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Bl=x(()=>e("br",null,null,-1)),Hl={class:"text-sm"},zl=x(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"For Remarks",-1)),Ml={ref:"to_move"},El=["data-index"],Ll={class:"cell"},Ol={class:"w-full h-full flex items-center justify-center"},Yl={class:"cell bold"},Jl={class:"w-full h-full flex items-center justify-center"},Kl={class:"cell"},Ql={class:"w-full h-full flex items-center justify-center"},Gl={class:"cell"},Xl={class:"w-full h-full flex items-center justify-center"},Zl={class:"cell"},Wl={class:"w-full h-full flex items-center justify-center"},eo={class:"w-full px-0 py-2 2xl:pl-1 2xl:py-0 2xl:w-1/2 2xl:h-full 2xl:overflow-auto"},to={class:"w-full",role:"sticky"},so={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},lo=x(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"9",class:"!bg-slate-800 text-white font-bold"}," Detail PVR ")],-1)),oo={class:"sticky top-8 !z-[2]"},ao=x(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),no=x(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),co=x(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),io=x(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),uo=x(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),ro=x(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Amount",-1)),_o=x(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Qty",-1)),po=x(()=>e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"For",-1)),fo={class:"min-w-[100px] !w-[100px] max-w-[100px]"},vo=x(()=>e("br",null,null,-1)),mo={class:"text-sm"},ho={ref:"to_move"},xo=["data-index"],wo={class:"w-full h-full flex items-center justify-center"},yo={class:"w-full h-full flex items-center justify-center"},bo={class:"w-full h-full flex items-center justify-center"},ko={key:0,class:"cell"},go={class:"w-full h-full flex items-center justify-center"},$o={class:"w-full h-full flex items-center justify-center"},jo={class:"cell"},Co={class:"w-full h-full flex items-center justify-center"},To={class:"w-full flex items-center justify-end"},Ao={class:"w-full flex flex-wrap p-3 items-center"},Po=x(()=>e("div",null," Di Validasi oleh : ",-1)),Do={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},So={key:0},Io={key:1},qo={__name:"ujalan_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},setup(b){const w=b,{$moment:E}=qe(),{pointFormat:U}=ue(),c=f({...{id:-1,xto:"",tipe:"",jenis:"",harga:0,note_for_remarks:0,details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:""}}),R=he("token"),oe=f({}),d=f([]),_=f([]),M=async()=>{V().loading_full=!0,oe.value={};const k=new FormData;let A="post",Y=w.id;Y==0||(k.append("id",Y),k.append("_method","PUT"));const{data:N,error:L,status:v}=await le("/ujalan_validasi",{method:A,headers:{Authorization:`Bearer ${R.value}`,Accept:"application/json"},body:k,retry:0});if(V().loading_full=!1,v.value==="error"){se().trigger(L,oe);return}c.value.val=N.value.val,c.value.val_user=N.value.val_user,c.value.val_by=N.value.val_by,c.value.val_at=N.value.val_at,c.value.val1=N.value.val1,c.value.val1_user=N.value.val1_user,c.value.val1_by=N.value.val1_by,c.value.val1_at=N.value.val1_at;let j=w.p_data.map(ae=>ae.id).indexOf(w.id);j>=-1&&w.p_data.splice(j,1,{...c.value}),w.fnClose()},T=async()=>{V().loading_full=!0;const{data:k,error:A,status:Y}=await le("/ujalan_",{method:"get",headers:{Authorization:`Bearer ${R.value}`,Accept:"application/json"},params:{id:w.id},retry:0});if(V().loading_full=!1,Y.value==="error"){se().trigger(A);return}c.value=k.value.data,d.value=k.value.data.details,_.value=k.value.data.details2},I=_e(()=>{let k=0;return _.value.forEach(A=>{A.p_status!="Remove"&&(k+=A.qty*A.amount)}),k}),F=_e(()=>!1);return $e(()=>w.show,(k,A)=>{k==!0&&T()},{immediate:!0}),(k,A)=>{const Y=Ae,N=Pe,L=ge;return B((o(),r("section",nl,[e("div",null,[$(Y,{title:"Form Ujalan Validation",fn:b.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",cl,[e("div",il,[e("div",ul,[e("div",rl,[dl,e("div",_l,n(t(c).xto),1)]),e("div",pl,[fl,e("div",vl,n(t(c).jenis),1)]),e("div",ml,[hl,e("div",xl,n(t(U)(t(c).harga||0)),1)]),e("div",wl,[yl,e("div",bl,n(t(c).transition_from),1)]),e("div",kl,[gl,e("div",$l,n(t(c).tipe),1)]),e("div",jl,[Cl,e("div",Tl,n(t(c).note_for_remarks),1)])]),e("div",Al,[e("div",Pl,[e("div",Dl,[e("table",Sl,[e("thead",null,[Il,e("tr",ql,[Ul,Rl,Vl,Fl,e("th",Nl,[K("Total "),Bl,K(),e("span",Hl,"("+n(t(U)(t(c).harga||0))+")",1)]),zl])]),e("tbody",Ml,[(o(!0),r(O,null,re(t(d),(v,j)=>(o(),r(O,{key:j},[v.p_status!="Remove"?(o(),r("tr",{key:0,"data-index":j},[e("td",null,n(j+1)+".",1),e("td",Ll,[e("div",Ol,n(v.xdesc),1)]),e("td",Yl,[e("div",Jl,n(t(U)(v.harga||0)),1)]),e("td",Kl,[e("div",Ql,n(t(U)(v.qty||0)),1)]),e("td",Gl,[e("div",Xl,n(t(U)(v.qty*v.harga||0)),1)]),e("td",Zl,[e("div",Wl,[e("div",{class:S(["text-white rounded text-xl w-5 h-5",v.for_remarks?"bg-green-600":"bg-red-600"])},[v.for_remarks==0?(o(),H(N,{key:0})):(o(),H(L,{key:1}))],2)])])],8,El)):g("",!0)],64))),128))],512)])])]),e("div",eo,[e("div",to,[e("table",so,[e("thead",null,[lo,e("tr",oo,[ao,no,co,io,uo,ro,_o,po,e("th",fo,[K("Total "),vo,K(),e("span",mo,"("+n(t(U)(t(I)))+")",1)])])]),e("tbody",ho,[(o(!0),r(O,null,re(t(_),(v,j)=>(o(),r(O,{key:j},[v.p_status!="Remove"?(o(),r("tr",{key:0,"data-index":j},[e("td",null,n(j+1)+".",1),e("td",{class:S(["cell bold",t(F)?"unselectable":""])},[e("div",wo,n(v.ac_account_id),1)],2),e("td",{class:S(["cell bold",t(F)?"unselectable":""])},[e("div",yo,n(v.ac_account_code),1)],2),e("td",{class:S(["cell bold",t(F)?"unselectable":""])},[e("div",bo,n(v.ac_account_name),1)],2),t(F)?g("",!0):(o(),r("td",ko,[e("div",go,n(v.description),1)])),e("td",{class:S(["cell bold",t(F)?"unselectable":""])},[e("div",$o,n(t(U)(v.amount||0)),1)],2),e("td",{class:S(["cell",t(F)?"unselectable":""])},n(t(U)(v.qty||0)),3),e("td",{class:S(["cell",t(F)?"unselectable":""])},n(v.xfor),3),e("td",jo,[e("div",Co,n(t(U)(v.qty*v.amount||0)),1)])],8,xo)):g("",!0)],64))),128))],512)])])])])]),e("div",To,[e("div",Ao,[Po,t(c).val||t(c).val1?(o(),r("div",Do,[t(c).val?(o(),r("div",So," App 1 : "+n(t(c).val_by.username)+" ( "+n(t(c).val_at?t(E)(t(c).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):g("",!0),t(c).val1?(o(),r("div",Io," App 2 : "+n(t(c).val1_by.username)+" ( "+n(t(c).val1_at?t(E)(t(c).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):g("",!0)])):g("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:A[0]||(A[0]=v=>b.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:A[1]||(A[1]=je(v=>M(),["prevent"]))}," Validasi ")])])])],512)),[[De,b.show]])}}},Uo=Ue(qo,[["__scopeId","data-v-77e05035"]]),Ro={class:"w-full h-full flex flex-col"},Vo={class:"w-full flex grow flex-col overflow-auto h-0"},Fo={class:"w-full flex"},No={action:"#",class:"w-full flex p-1"},Bo={class:"grow"},Ho=e("div",{class:"font-bold"}," Keyword ",-1),zo={class:"pl-1"},Mo=e("div",{class:"font-bold"}," Sort By ",-1),Eo=Ze('<option value=""></option><option value="id">ID</option><option value="xto">To</option><option value="jenis">Jenis</option><option value="tipe">Tipe</option>',5),Lo=[Eo],Oo={class:"pl-1"},Yo=e("div",{class:"font-bold"}," Sort Order ",-1),Jo=e("option",{value:"asc"},"Asc",-1),Ko=e("option",{value:"desc"},"Desc",-1),Qo=[Jo,Ko],Go={class:"flex items-end pl-1"},Xo={class:"w-full flex justify-center items-center grow h-0 p-1"},Zo={key:0,class:""},Wo={class:"tacky"},ea=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"App 2"),e("th",null,"ID"),e("th",null,"To"),e("th",null,"Tipe"),e("th",null,"Jenis"),e("th",null,"Harga"),e("th",null,"Ket.U.Remarks"),e("th",null,"Asal Peralihan"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),ta=["onClick"],sa={class:"flex items-center justify-center"},la={class:"flex items-center justify-center"},oa={class:"bold"},aa={class:"grow mb-5"},$a={__name:"index",async setup(b){let w,E;const{$moment:U}=qe(),{pointFormat:p}=ue(),c={};c._TimeZoneOffset=new Date().getTimezoneOffset(),c.sort="created_at:desc";const R=he("token"),{data:oe}=([w,E]=Je(async()=>Xe(async()=>{let m=[];V().loading_full=!0;const{data:i,error:u,status:ee}=await le("/ujalan",{method:"get",headers:{Authorization:`Bearer ${R.value}`,Accept:"application/json"},params:c,retry:0});return V().loading_full=!1,ee.value==="error"?(se().trigger(u),{ujalans:m}):(m=i.value.data,{ujalans:m})},"$SN3C927rLk")),w=await w,E(),w),d=f(oe.value.ujalans),_=f(""),M=f({field:"created_at",by:"desc"}),T=f(-1),I=f({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),F=()=>{c.like="",_.value!=""&&(c.like=`id:%${_.value}%,xto:%${_.value}%,tipe:%${_.value}%,jenis:%${_.value}%,harga:%${_.value}%`),c.sort="",M.value.field&&(c.sort=M.value.field+":"+M.value.by)},k=f(null),A=async()=>{V().loading_full=!0,I.value.may_get_data=!1,c.page=I.value.page,c.page==1&&(d.value=[]),c.first_row&&delete c.first_row,c.page>1&&(c.first_row=JSON.stringify(d.value[0]));const{data:m,error:i,status:u}=await le("/ujalan",{method:"get",headers:{Authorization:`Bearer ${R.value}`,Accept:"application/json"},params:c,retry:0});if(V().loading_full=!1,I.value.may_get_data=!0,u.value==="error"){se().trigger(i);return}I.value.page==1?(d.value=m.value.data,k.value&&(k.value.scrollTop=0)):I.value.page>1&&(d.value=[...d.value,...m.value.data]),m.value.data.length==0&&(I.value.is_last_record=!0)},Y=async()=>{if(!I.value.may_get_data)return;let m=k.value;if(m.scrollLeft!=I.value.scrollLeft){I.value.scrollLeft=m.scrollLeft;return}I.value.is_last_record||!(Math.round(m.scrollTop)+m.clientHeight>=m.scrollHeight-1)||(I.value.page++,await A())},N=()=>{I.value.page=1,I.value.is_last_record=!1,F(),A()};Ke();const L=f(!1),v=f(0),j=f(0),ae=()=>{v.value=0,L.value=!0,j.value=!1},{display:q}=ke();Qe(ke());const P=()=>{T.value==-1?q({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(v.value=d.value[T.value].id,L.value=!0,j.value=!1)},ne=()=>{T.value==-1?q({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(v.value=d.value[T.value].id,L.value=!0,j.value=!0)},ce=f(!1),Z=f(0),fe=()=>{T.value==-1?q({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(Z.value=d.value[T.value].id,ce.value=!0)},de=f(!1),ve=f({}),W=f(!1),Q=f(""),xe=async()=>{W.value&&(W.value=!1)},we=()=>{T.value==-1?q({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(Q.value="",ve.value={id:d.value[T.value].id},W.value=!0)};$e(()=>Q.value,m=>{m.trim().length>0?de.value=!0:de.value=!1},{immediate:!1});const ye=async()=>{V().loading_full=!0;const m=new FormData;m.append("id",d.value[T.value].id),m.append("deleted_reason",Q.value),m.append("_method","DELETE");const{data:i,error:u,status:ee}=await le("/ujalan",{method:"post",headers:{Authorization:`Bearer ${R.value}`,Accept:"application/json"},body:m,retry:0});if(V().loading_full=!1,ee.value==="error"){se().trigger(u);return}d.value.splice(T.value,1),T.value=-1,W.value=!1};return(m,i)=>{const u=Re,ee=Fe,a=Te,l=Ne,J=Be,z=He,D=ze,G=Me,X=ge,ie=Ee,me=al,be=Uo;return o(),r("div",Ro,[$(u,{title:"List Ujalan"}),e("div",Vo,[e("div",Fo,[("useUtils"in m?m.useUtils:t(ue))().checkRole(["PabrikTransport"])?g("",!0):(o(),r("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:i[0]||(i[0]=s=>ne())},[$(ee)])),("useUtils"in m?m.useUtils:t(ue))().checkRole(["PabrikTransport"])?g("",!0):(o(),r("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:i[1]||(i[1]=s=>ae())},[$(a)])),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:i[2]||(i[2]=s=>P())},[$(l)]),("useUtils"in m?m.useUtils:t(ue))().checkRole(["PabrikTransport"])?g("",!0):(o(),r("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:i[3]||(i[3]=s=>we())},[$(J)])),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:i[4]||(i[4]=s=>fe())},[$(z)])]),e("form",No,[e("div",Bo,[Ho,B(e("input",{class:"",type:"text","onUpdate:modelValue":i[5]||(i[5]=s=>Ce(_)?_.value=s:null),name:"search",placeholder:"Keyword"},null,512),[[te,t(_)]])]),e("div",zo,[Mo,B(e("select",{class:"","onUpdate:modelValue":i[6]||(i[6]=s=>t(M).field=s)},Lo,512),[[pe,t(M).field]])]),e("div",Oo,[Yo,B(e("select",{class:"","onUpdate:modelValue":i[7]||(i[7]=s=>t(M).by=s)},Qo,512),[[pe,t(M).by]])]),e("div",Go,[e("button",{class:"",type:"submit",name:"button",onClick:i[8]||(i[8]=je(s=>N(),["prevent"]))},[$(D,{class:"text-2xl"})])])]),e("div",Xo,[t(d).length==0?(o(),r("div",Zo," Maaf Tidak Ada Record ")):(o(),r("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:k,onScroll:Y},[e("table",Wo,[ea,e("tbody",null,[(o(!0),r(O,null,re(t(d),(s,C)=>(o(),r("tr",{key:C,onClick:y=>T.value=C,class:S(t(T)==C?"active":"")},[e("td",null,[e("div",sa,[s.val?(o(),H(X,{key:1})):(o(),H(G,{key:0}))])]),e("td",null,[e("div",la,[s.val1?(o(),H(X,{key:1})):(o(),H(G,{key:0}))])]),e("td",oa,n(s.id),1),e("td",null,n(s.xto),1),e("td",null,n(s.tipe),1),e("td",null,n(s.jenis),1),e("td",null,n(t(p)(s.harga)),1),e("td",null,n(s.note_for_remarks),1),e("td",null,n(s.transition_from),1),e("td",null,n(s.created_at?t(U)(s.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,n(s.updated_at?t(U)(s.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,ta))),128))])])],544))])]),$(ie,{type:"delete",show:t(W),data:t(ve),fnClose:xe,fnConfirm:ye,enabledOk:t(de)},{footer:Ge(()=>[K(" Masukkan Alasan Penghapusan: "),e("div",aa,[B(e("textarea",{"onUpdate:modelValue":i[9]||(i[9]=s=>Ce(Q)?Q.value=s:null)},null,512),[[te,t(Q)]])])]),_:1},8,["show","data","enabledOk"]),$(me,{show:t(L),fnClose:()=>{L.value=!1},id:t(v),p_data:t(d),is_copy:t(j)},null,8,["show","fnClose","id","p_data","is_copy"]),$(be,{show:t(ce),fnClose:()=>{ce.value=!1},id:t(Z),p_data:t(d)},null,8,["show","fnClose","id","p_data"])])}}};export{$a as default};
