import H from"./Header.fb341aba.js";import{_ as Z}from"./client-only.e33e7f38.js";import{_ as R}from"./SelectMulti.vue.c8764ca4.js";import L from"./PrinterEye.a4c5366e.js";import q from"./Table2Column.be213523.js";import{_ as G}from"./PDFView.vue.2d9e66db.js";import{r as c,h as K,k as Q,M as W,c as X,a as e,b as n,n as T,C as Y,m as l,B,w as E,t as N,s as O,F as ee,l as te,o as oe,p as le,e as se,x as f,y as C,H as ae}from"./entry.ef147d81.js";import{u as S}from"./useMyFetch.519debed.js";import{u as ne}from"./useDownload.737fa5e3.js";import{_ as ie}from"./_plugin-vue_export-helper.c27b6911.js";import"./Check.15585167.js";import"./Times.9c12f483.js";const s=p=>(le("data-v-78c571c1"),p=p(),se(),p),re={class:"w-full h-full flex flex-col"},ce={class:"w-full flex grow flex-col overflow-auto h-0 bg-gray-200 justify-center items-center p-2"},de={class:"bg-white p-2 max-w-[350px] max-h-full overflow-auto"},_e={action:"#",class:"w-full flex flex-col sm:flex-row flex-wrap text-xs"},ue={class:"w-full p-1 flex flex-col"},fe=s(()=>e("div",{class:"font-bold"}," Tipe ",-1)),pe=s(()=>e("option",{value:"header"},"Header",-1)),me=s(()=>e("option",{value:"detail"},"Detail",-1)),ve=[pe,me],xe={class:"w-full p-1 flex flex-col"},he=s(()=>e("div",{class:"font-bold"}," Jenis ",-1)),we=s(()=>e("option",{value:""},null,-1)),ye=s(()=>e("option",{value:"UJ"},"Uang Jalan",-1)),ge=s(()=>e("option",{value:"SB"},"Uang Standby",-1)),be=[we,ye,ge],ke={class:"w-full sm:w-1/2 p-1 flex flex-col"},De=s(()=>e("div",{class:"font-bold"}," Tgl Dari ",-1)),Ce={class:"text-red-500"},Se={class:"w-full sm:w-1/2 p-1 flex flex-col"},Me=s(()=>e("div",{class:"font-bold"}," Tgl Sampai ",-1)),Ve={class:"text-red-500"},je={class:"w-full p-1 flex flex-col"},$e=s(()=>e("div",{class:"font-bold"}," Lokasi ",-1)),Ae={class:"w-full p-1 flex flex-col"},Te=s(()=>e("div",{class:"font-bold"}," Nama ",-1)),Ye={class:"w-full p-1 flex flex-col"},Be=s(()=>e("div",{class:"font-bold"}," No Pol ",-1)),Ee={class:"w-full p-1 flex items-end justify-end"},Ne=s(()=>e("div",{class:"text-left m-1"},"Download PDF",-1)),Oe=s(()=>e("div",{class:"text-left m-1"},"Download Excel",-1)),Fe={__name:"ast_n_driver",async setup(p){let m,M;const{$moment:V}=ae(),a={};a._TimeZoneOffset=new Date().getTimezoneOffset(),a.sort="tanggal:desc";const j=c({}),h=K("token"),d=c({from:"",to:""}),{data:w}=([m,M]=Q(async()=>te(async()=>{f().loading_full=!0;let t=[],o=[],_=[];const[r,k]=await Promise.all([S("/report/ast_n_driver/load_data",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},retry:0})]);return r.status.value!=="error"&&(t=r.data.value.list_xto,_=r.data.value.list_employee,o=r.data.value.list_vehicle),r.status.value==="error"&&C().trigger(r.error),f().loading_full=!1,{list_xto:t,list_employee:_,list_vehicle:o}},"$Aw9scsfjYZ")),m=await m,M(),m),y=c([]),g=c([]),b=c([]);w.value.list_xto.forEach(t=>{y.value.push({id:t,name:t,title:"",checked:!1})}),w.value.list_employee.forEach(t=>{g.value.push({id:t.id,name:t.name,title:t.role,checked:!1})}),w.value.list_vehicle.forEach(t=>{b.value.push({id:t.id,name:t.no_pol,title:"",checked:!1})});const v=c("header"),x=c(""),$=()=>{a._TimeZoneOffset=new Date().getTimezoneOffset(),a.date_from=d.value.from?V(d.value.from).format("YYYY-MM-DD"):"",a.date_to=d.value.to?V(d.value.to).format("YYYY-MM-DD"):"",a.list_xto=JSON.stringify(y.value.filter(t=>t.checked).map(t=>t.id)),a.list_employee=JSON.stringify(g.value.filter(t=>t.checked).map(t=>t.id)),a.list_vehicle=JSON.stringify(b.value.filter(t=>t.checked).map(t=>t.id)),a.type=v.value,a.jenis=x.value},{downloadFile:F,viewFile:Ue}=ne(),u=c(!1),A=c({}),U=async()=>{if(u.value==!0){u.value=!1;return}$(),f().loading_full=!0;const{data:t,error:o,status:_}=await S("/report/ast_n_driver/pdf_preview",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},params:a,retry:0});if(f().loading_full=!1,_.value==="error"){C().trigger(o);return}A.value=t.value,u.value=!0},I=async()=>{$(),f().loading_full=!0;const{data:t,error:o,status:_}=await S("/report/ast_n_driver/excel_download",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},params:a,retry:0});if(f().loading_full=!1,_.value==="error"){C().trigger(o);return}F(t.value)};return(t,o)=>{const _=H,r=W("vue-date-picker"),k=Z,D=R,J=L,P=q,z=G;return oe(),X(ee,null,[e("div",re,[n(_,{title:"Report Transaction"}),e("div",ce,[e("div",de,[e("form",_e,[e("div",ue,[fe,T(e("select",{"onUpdate:modelValue":o[0]||(o[0]=i=>B(v)?v.value=i:null)},ve,512),[[Y,l(v)]])]),e("div",xe,[he,T(e("select",{"onUpdate:modelValue":o[1]||(o[1]=i=>B(x)?x.value=i:null)},be,512),[[Y,l(x)]])]),e("div",ke,[De,n(k,null,{default:E(()=>[n(r,{modelValue:l(d).from,"onUpdate:modelValue":o[2]||(o[2]=i=>l(d).from=i),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1}),e("p",Ce,N(l(j).date_from),1)]),e("div",Se,[Me,n(k,null,{default:E(()=>[n(r,{modelValue:l(d).to,"onUpdate:modelValue":o[3]||(o[3]=i=>l(d).to=i),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1}),e("p",Ve,N(l(j).date_to),1)]),e("div",je,[$e,n(D,{arr:l(y)},null,8,["arr"])]),e("div",Ae,[Te,n(D,{arr:l(g)},null,8,["arr"])]),e("div",Ye,[Be,n(D,{arr:l(b)},null,8,["arr"])]),e("div",Ee,[e("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:o[4]||(o[4]=O(i=>U(),["prevent"]))},[e("div",null,[n(J,{class:"text-2xl"})]),Ne]),e("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:o[5]||(o[5]=O(i=>I(),["prevent"]))},[e("div",null,[n(P,{class:"text-2xl"})]),Oe])])])])])]),n(z,{show:l(u),pdfContent:l(A),onClose:o[6]||(o[6]=i=>u.value=!l(u))},null,8,["show","pdfContent"])],64)}}},We=ie(Fe,[["__scopeId","data-v-78c571c1"]]);export{We as default};
