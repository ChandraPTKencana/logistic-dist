import{_ as P}from"./HeaderPopup.vue.8167e3af.js";import B from"./uj.c3409a9a.js";import J from"./emt.51497b59.js";import A from"./absen.c712016b.js";import E from"./ticket.587e655b.js";import q from"./stt.767924c8.js";import L from"./CaretTop.e92d2e1a.js";import U from"./CaretDown.071625c4.js";import{Q as V,r as l,g as M,f as R,k as z,K as H,o as K,c as Q,a as m,b as s,l as c,x as N,y as G}from"./entry.f6b0e5cc.js";import{u as y}from"./useUtils.c9a24de7.js";import{u as W}from"./useMyFetch.20a381b7.js";import"./Times.88f1d7df.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./ClockAnalog.520cdbae.js";import"./Calendar.238a2016.js";import"./Truck.f1a1f8c7.js";import"./LocationOn.262b1082.js";import"./TruckDriver.ef063197.js";import"./Person.57a4a0dd.js";import"./AttachmentSingle.87f05d64.js";import"./PDFJsView.915b9516.js";import"./Check.e95b8b8a.js";const X={class:"box-fixed"},Y={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white p-1"},Z={class:"w-full flex items-center justify-end"},he={__name:"trx_trp_full",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},it_state:{type:Number,required:!1,default:-1}},emits:["setID","setIndex"],setup(v,{emit:d}){const n=v,{pointFormat:b}=y();let f=e=>{e.key=="ArrowUp"&&I(),e.key=="ArrowDown"&&h()};V(()=>{document.removeEventListener("keydown",f)});const _=l({...{id:-1,tanggal:new Date,payment_method:{name:""},id_uj:-1,xto:"",tipe:"",jenis:"",amount:0,pv_id:-1,pv_no:"",pv_total:0,supir:"",kernet:"",no_pol:"",val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:"",val3:0,val3_by:{username:""},val3_at:"",val4:0,val4_by:{username:""},val4_at:"",val5:0,val5_by:{username:""},val5_at:"",val6:0,val6_by:{username:""},val6_at:"",ritase_val:0,ritase_val_by:{username:""},ritase_val_at:"",ritase_val1:0,ritase_val1_by:{username:""},ritase_val1_at:"",ritase_val2:0,ritase_val2_by:{username:""},ritase_val2_at:"",cost_center_code:"",cost_center_desc:"",pvr_id:"",pvr_no:"",pvr_total:"",pvr_had_detail:"",uj_combine:{supir:[],kernet:[]}}}),F=M("token");l(null),l(null);const $=l(""),w={_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:-1,name:"",title:"",note:""},r=l(JSON.parse(JSON.stringify(w))),o=l(JSON.parse(JSON.stringify(w))),g={_raw:{},_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},xto:{tcon:"IconsLocationOn",text:"Tujuan",val:""},asst_opt:{tcon:"IconsPerson",text:"Info",val:""},tipe:{tcon:"",text:"Tipe",val:""},harga:{tcon:"IconsMoney",text:"Amount",val:""}},id:"",name:"",title:"",note:""},C=l(JSON.parse(JSON.stringify(g))),D=e=>{let t=JSON.parse(JSON.stringify(g));return t._.id.val=e.id,t._.xto.val=e.xto,t._.asst_opt.val=e.asst_opt,t._.tipe.val=e.tipe,t._.harga.val=b(e.harga),t.id=e.id,t.name=e.xto,t.title=(e.asst_opt||"")+" "+(e.tipe||"")+" "+(b(e.harga)||""),t._raw=e,t},x=async()=>{$.value="",N().loading_full=!0;const{data:e,error:t,status:k}=await W("/trx_trp/full_view",{method:"get",headers:{Authorization:`Bearer ${F.value}`,Accept:"application/json"},params:{id:n.id},retry:0});if(N().loading_full=!1,k.value==="error"){G().trigger(t);return}let a=e.value.data;_.value=a,r.value._.id.val=a.supir_id,r.value._.name.val=a.supir,r.value._.rek_no.val=a.supir_rek_no,r.value._.rek_name.val=a.supir_rek_name,r.value.id=a.supir_id,r.value.name=a.supir,r.value.rek_no=(a.supir_rek_no||"")+" "+(a.supir_rek_name||""),o.value._.id.val=a.kernet_id,o.value._.name.val=a.kernet,o.value._.rek_no.val=a.kernet_rek_no,o.value._.rek_name.val=a.kernet_rek_name,o.value.id=a.kernet_id,o.value.name=a.kernet,o.value.rek_no=(a.kernet_rek_no||"")+" "+(a.kernet_rek_name||""),C.value=D(a.uj);let u=0,p=0;a.potongan.forEach(i=>{i.potongan_mst.employee_id==a.supir_id&&(u+=parseInt(i.nominal_cut)),i.potongan_mst.employee_id==a.kernet_id&&(p+=parseInt(i.nominal_cut))}),r.value.note="",o.value.note="",u>0&&(r.value.note="Telah di potong sebesar :"+y().pointFormat(u)),p>0&&(o.value.note="Telah di potong sebesar :"+y().pointFormat(p))};R(()=>n.show,(e,t)=>{e==!0?(document.addEventListener("keydown",f),x()):document.removeEventListener("keydown",f)},{immediate:!0});const h=()=>{let e=n.p_data.map(t=>t.id).indexOf(n.id);e!=n.p_data.length-1&&(e++,d("setID",n.p_data[e].id),d("setIndex",e),setTimeout(()=>{x()},100))},I=()=>{let e=n.p_data.map(t=>t.id).indexOf(n.id);e!=0&&(e--,d("setID",n.p_data[e].id),d("setIndex",e),setTimeout(()=>{x()},100))};return(e,t)=>{const k=P,a=B,u=J,p=A,i=E,S=q,j=L,O=U;return z((K(),Q("section",X,[m("div",null,[s(k,{title:"Form Full Transaction",fn:v.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),m("form",Y,[s(a,{trx_trp:c(_)},null,8,["trx_trp"]),s(u,{extra_money_trxs:c(_).extra_money_trxs},null,8,["extra_money_trxs"]),s(p,{trx_trp:c(_)},null,8,["trx_trp"]),s(i,{trx_trp:c(_)},null,8,["trx_trp"]),s(S,{standby_trxs:c(_).standby_trxs},null,8,["standby_trxs"]),m("div",Z,[m("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:t[0]||(t[0]=T=>I())},[s(j,{class:"black"})]),m("button",{type:"button",name:"button",class:"w-36 m-1",onClick:t[1]||(t[1]=T=>v.fnClose())}," Cancel "),m("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:t[2]||(t[2]=T=>h())},[s(O,{class:"black"})])])])])],512)),[[H,v.show]])}}};export{he as default};
