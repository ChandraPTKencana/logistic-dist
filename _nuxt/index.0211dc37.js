import{_ as Me}from"./Header.03011c32.js";import{_ as Ne,a as Ve}from"./ac_accs.aaae9e19.js";import{_ as xe}from"./Plus.5c4fb5d7.js";import{_ as Be}from"./Edit.d556bcc7.js";import{_ as qe}from"./Eyes.12ef4f12.js";import{_ as Re}from"./Delete.7412e1f4.js";import{_ as ze}from"./Signature.fa631486.js";import{_ as Le}from"./Search.06448cc3.js";import{_ as He}from"./Line.ef2a08c0.js";import{_ as Ye}from"./Check.e1435bcb.js";import{_ as Ee}from"./PopupMini.vue.627fde59.js";import{_ as ye}from"./HeaderPopup.vue.3dbe1371.js";import{_ as Oe,a as Ke}from"./ToolsPopup.2e2c1f3c.js";import{_ as Je}from"./Times.f09ef1bc.js";import{_ as Ge}from"./InputPointFormat.vue.f5325e02.js";import{r,f as ie,J as ce,g as _e,o as i,c as u,h as N,v as be,a as e,b as k,k as t,j as ae,t as n,K as Xe,G as C,d as oe,F as ee,n as fe,q as V,L as le,l as re,m as pe,x as I,y as X,p as $e,e as ge,s as ke,D as Ze,B as Qe,H as he,I as We,i as we,w as et,E as tt}from"./entry.1e961bb7.js";import{u as G}from"./useUtils.0b7c2619.js";import{u as Z}from"./useMyFetch.a26a0131.js";import{_ as Ae}from"./_plugin-vue_export-helper.c27b6911.js";const j=x=>($e("data-v-80fc7397"),x=x(),ge(),x),st={class:"box-fixed"},lt={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},at={class:"w-full flex flex-col items-center grow overflow-auto"},ot={class:"w-full flex flex-row flex-wrap"},nt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},it=j(()=>e("label",{for:""},"Name",-1)),ct=["disabled"],ut={class:"text-red-500"},dt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},rt=j(()=>e("label",{for:""},"Tipe",-1)),_t=["disabled"],ft={class:"text-red-500"},pt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},mt=j(()=>e("label",{for:""},"Amount",-1)),vt={class:"card-border disabled"},ht={class:"text-red-500"},wt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},xt=j(()=>e("label",{for:""},"Peralihan?",-1)),yt={class:"card-border !flex flex-row items-center"},bt=["checked"],$t={for:"checkbox",class:"w-full ml-1"},gt={class:"text-red-500"},kt={class:"w-full flex p-1 2xl:overflow-hidden justify-between flex-wrap"},At={class:"w-full",role:"sticky"},Ct={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},St={class:"sticky -top-1 !z-[2]"},Dt=["colspan"],It={class:"sticky top-7 !z-[2]"},Tt={key:0,class:"min-w-[30px] !w-[30px] max-w-[30px]"},jt=j(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),Ft={key:1,class:"min-w-[30px] !w-[30px] max-w-[30px]"},Ut=j(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),Pt=j(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),Mt=j(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),Nt=j(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),Vt={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Bt=j(()=>e("br",null,null,-1)),qt={class:"text-sm"},Rt=j(()=>e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"For",-1)),zt={ref:"to_move"},Lt=["data-index"],Ht={key:0,class:"tools cell"},Yt={class:"w-full h-full flex items-center justify-center"},Et=["onClick"],Ot={key:1,class:"cell"},Kt={class:"w-full h-full flex items-center justify-center"},Jt=["onClick"],Gt=["onClick","disabled"],Xt={class:"w-full h-full flex items-center justify-center"},Zt={class:"w-full h-full flex items-center justify-center"},Qt={class:"w-full h-full flex items-center justify-center"},Wt={class:"cell"},es={class:"w-full h-full flex items-center justify-center"},ts=["disabled","onUpdate:modelValue"],ss={class:"w-full h-full flex items-center justify-center"},ls={class:"w-full h-full flex items-center justify-center"},as=["onUpdate:modelValue","disabled"],os=j(()=>e("option",{value:"Supir"},"Supir",-1)),ns=j(()=>e("option",{value:"Kernet"},"Kernet",-1)),is=[os,ns],cs={key:0},us={class:"tools cell"},ds={class:"w-full flex items-center justify-end"},rs={__name:"standby_mst",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(x){const h=x,{pointFormat:E}=G(),L={id:-1,name:"",tipe:"",amount:0,is_transition:0,details:[]},c=r({...L}),s=ie("token"),T=r({});r([{xdesc:"Gaji Kernet",qty:1,harga:0},{xdesc:"U.Extrafooding",qty:1,harga:2e4}]);const d=r([]),w=r({ordinal:0,id:-1,ac_account_id:"",ac_account_name:"",ac_account_code:"",description:"",amount:0,xfor:"",p_status:""}),S=r(!1),P=()=>{S.value=!1},y=o=>{d.value[p.value].ac_account_id=o.ac_account_id,d.value[p.value].ac_account_code=o.ac_account_code,d.value[p.value].ac_account_name=o.ac_account_name,S.value=!1},A=(o,a)=>{p.value=a,S.value=!0},B=(o,a)=>{d.value[a].ac_account_id="",d.value[a].ac_account_code="",d.value[a].ac_account_name=""},b=async()=>{I().loading_full=!0,T.value={};const o=new FormData;o.append("name",c.value.name),o.append("tipe",c.value.tipe),o.append("is_transition",c.value.is_transition),o.append("amount",c.value.amount),o.append("details",JSON.stringify(d.value));let a="post",q=h.is_copy?0:h.id;q==0||(o.append("id",q),o.append("_method","PUT"));const{data:M,error:U,status:W}=await Z("/standby_mst",{method:a,headers:{Authorization:`Bearer ${s.value}`,Accept:"application/json"},body:o,retry:0});if(I().loading_full=!1,W.value==="error"){X().trigger(U,T);return}if(q<=0)c.value.id=M.value.id,c.value.created_at=M.value.created_at,c.value.updated_at=M.value.updated_at,h.p_data.unshift(c.value);else{c.value.updated_at=M.value.updated_at;let R=h.p_data.map(z=>z.id).indexOf(q);R>=-1&&h.p_data.splice(R,1,{...c.value})}h.fnClose()},g=ce(()=>{let o=0;return d.value.forEach(a=>{a.p_status!="Remove"&&(o+=1*a.amount)}),c.value.amount=o,o}),p=r(-1),m=r(!1),D=r({left:0,top:0}),O=(o,a)=>{p.value=a,m.value=!0,D.value={left:o.clientX,top:o.clientY}},H=()=>{d.value.push({...w.value,p_status:"Add"})},te=()=>{m.value=!1},K=(o="")=>{if(o=="insert")d.value.splice(p.value,0,{...w.value,p_status:"Add"});else if(o=="delete")d.value[p.value].p_status=="Edit"?d.value[p.value].p_status="Remove":d.value.splice(p.value,1);else if(o=="move_top"){let a=d.value[p.value];d.value.splice(p.value,1),d.value.splice(p.value-1,0,{...a})}else if(o=="move_bottom"){let a=d.value[p.value];d.value.splice(p.value,1),d.value.splice(p.value+1,0,{...a})}m.value=!1},ne=ie("role"),$=ce(()=>c.value.val&&c.value.val1||ne.value=="Logistic"&&c.value.val||ne.value=="PabrikTransport"&&c.value.val1),Q=async()=>{I().loading_full=!0;const{data:o,error:a,status:q}=await Z("/standby_mst",{method:"get",headers:{Authorization:`Bearer ${s.value}`,Accept:"application/json"},params:{id:h.id},retry:0});if(I().loading_full=!1,q.value==="error"){X().trigger(a);return}c.value=o.value.data;let M="Edit";h.is_copy&&(M="Add",c.value.val=0,c.value.val1=0),d.value=o.value.data.details.map(U=>(U.p_status=M,U.key=U.ordinal,U))};return _e(()=>h.show,(o,a)=>{o==!0&&(c.value={...L},d.value=[],h.id!=0&&Q())},{immediate:!0}),(o,a)=>{const q=ye,M=Oe,U=Je,W=Ge,R=xe,z=Ke,ue=Ne;return i(),u(ee,null,[N(e("section",st,[e("div",null,[k(q,{title:"Form StandBy Mst",fn:x.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",lt,[e("div",at,[e("div",ot,[e("div",nt,[it,N(e("input",{"onUpdate:modelValue":a[0]||(a[0]=v=>t(c).name=v),disabled:t($)},null,8,ct),[[ae,t(c).name]]),e("p",ut,n(t(T).name),1)]),e("div",dt,[rt,N(e("input",{"onUpdate:modelValue":a[1]||(a[1]=v=>t(c).tipe=v),disabled:t($)},null,8,_t),[[ae,t(c).tipe]]),e("p",ft,n(t(T).tipe),1)]),e("div",pt,[mt,e("div",vt,n(t(E)(t(g))),1),e("p",ht,n(t(T).amount),1)]),e("div",wt,[xt,e("div",yt,[N(e("input",{id:"checkbox",checked:t(c).is_transition,"onUpdate:modelValue":a[2]||(a[2]=v=>t(c).is_transition=v),type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded"},null,8,bt),[[Xe,t(c).is_transition]]),e("label",$t,n(t(c).is_transition?"Ya":"Tidak"),1)]),e("p",gt,n(t(T).is_transition),1)])]),e("div",kt,[e("div",At,[e("table",Ct,[e("thead",null,[e("tr",St,[e("td",{colspan:t($)?7:9,class:"!bg-slate-800 text-white font-bold"}," Detail ",8,Dt)]),e("tr",It,[t($)?C("",!0):(i(),u("th",Tt)),jt,t($)?C("",!0):(i(),u("th",Ft)),Ut,Pt,Mt,Nt,e("th",Vt,[oe("Amount "),Bt,oe(),e("span",qt,"("+n(t(E)(t(g)))+")",1)]),Rt])]),e("tbody",zt,[(i(!0),u(ee,null,fe(t(d),(v,Y)=>(i(),u(ee,{key:Y},[v.p_status!="Remove"?(i(),u("tr",{key:0,"data-index":Y},[t($)?C("",!0):(i(),u("td",Ht,[e("div",Yt,[e("button",{type:"button",name:"button",onClick:l=>O(l,Y)},[k(M)],8,Et)])])),e("td",null,n(Y+1)+".",1),t($)?C("",!0):(i(),u("td",Ot,[e("div",Kt,[v.ac_account_id?(i(),u("button",{key:1,type:"button",onClick:l=>B(l,Y),disabled:v.confirm_by},[k(U,{class:"font-bold text-2xl"})],8,Gt)):(i(),u("button",{key:0,type:"button",name:"button",onClick:l=>A(l,Y)}," ... ",8,Jt))])])),e("td",{class:V(["cell bold",t($)?"unselectable":""])},[e("div",Xt,n(v.ac_account_id),1)],2),e("td",{class:V(["cell bold",t($)?"unselectable":""])},[e("div",Zt,n(v.ac_account_code),1)],2),e("td",{class:V(["cell bold",t($)?"unselectable":""])},[e("div",Qt,n(v.ac_account_name),1)],2),e("td",Wt,[e("div",es,[N(e("textarea",{disabled:t($),class:"p-1 w-full","onUpdate:modelValue":l=>v.description=l,cols:"7",rows:"2"},null,8,ts),[[ae,v.description]])])]),e("td",{class:V(["cell bold",t($)?"unselectable":""])},[e("div",ss,[(i(),le(W,{key:Y,class:"w-full h-full p-1",type:"text",value:v.amount||0,onInput:l=>v.amount=l,show:x.show,disabled:t($)},null,8,["value","onInput","show","disabled"]))])],2),e("td",{class:V(["cell",t($)?"unselectable":""])},[e("div",ls,[N(e("select",{"onUpdate:modelValue":l=>v.xfor=l,disabled:t($)},is,8,as),[[re,v.xfor]])])],2)],8,Lt)):C("",!0)],64))),128)),t($)?C("",!0):(i(),u("tr",cs,[e("td",us,[e("button",{type:"button",name:"button",onClick:a[3]||(a[3]=v=>H())},[k(R)])])]))],512)])])])]),e("div",ds,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:a[4]||(a[4]=v=>x.fnClose())}," Cancel "),t($)?C("",!0):(i(),u("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:a[5]||(a[5]=pe(v=>b(),["prevent"]))}," Save "))])])])],512),[[be,x.show]]),k(z,{show:t(m),coor:t(D),fn:te,data:t(d),data_index:t(p),onReplyAct:a[6]||(a[6]=v=>K(v))},null,8,["show","coor","data","data_index"]),k(ue,{show:t(S),fnClose:P,fnSelect:y},null,8,["show"])],64)}}},_s=Ae(rs,[["__scopeId","data-v-80fc7397"]]);const F=x=>($e("data-v-4f875e27"),x=x(),ge(),x),fs={class:"box-fixed"},ps={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},ms={class:"w-full flex flex-col items-center grow overflow-auto"},vs={class:"w-full flex flex-row flex-wrap"},hs={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ws=F(()=>e("label",{for:""},"Name",-1)),xs={class:"card-border"},ys={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},bs=F(()=>e("label",{for:""},"Tipe",-1)),$s={class:"card-border"},gs={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ks=F(()=>e("label",{for:""},"Amount",-1)),As={class:"card-border"},Cs={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ss=F(()=>e("label",{for:""},"Peralihan?",-1)),Ds={class:"card-border !flex flex-row items-center"},Is=["checked"],Ts={class:"w-full ml-1"},js={class:"text-red-500"},Fs={class:"w-full flex grow p-1 2xl:overflow-hidden justify-between flex-wrap"},Us={class:"w-full",role:"sticky"},Ps={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},Ms=F(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"7",class:"!bg-slate-800 text-white font-bold"}," Detail PVR ")],-1)),Ns={class:"sticky top-8 !z-[2]"},Vs=F(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),Bs=F(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),qs=F(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),Rs=F(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),zs=F(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),Ls={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Hs=F(()=>e("br",null,null,-1)),Ys={class:"text-sm"},Es=F(()=>e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"For",-1)),Os={ref:"to_move"},Ks=["data-index"],Js={class:"w-full h-full flex items-center justify-center"},Gs={class:"w-full h-full flex items-center justify-center"},Xs={class:"w-full h-full flex items-center justify-center"},Zs={key:0,class:"cell"},Qs={class:"w-full h-full flex items-center justify-center"},Ws={class:"w-full h-full flex items-center justify-center"},el={class:"w-full flex items-center justify-end"},tl={class:"w-full flex flex-wrap p-3 items-center"},sl=F(()=>e("div",null," Di Validasi oleh : ",-1)),ll={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},al={key:0},ol={key:1},nl={__name:"standby_mst_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(x){const h=x,{$moment:E}=ke(),{pointFormat:L}=G(),s=r({...{id:-1,name:"",tipe:"",is_transition:!1,amount:0,details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:""}}),T=ie("token"),d=r({}),w=r(null),S=r([]),P=async()=>{I().loading_full=!0,d.value={};const b=new FormData;let g="post",p=h.id;p==0||(b.append("id",p),b.append("_method","PUT"));const{data:m,error:D,status:O}=await Z("/standby_mst_validasi",{method:g,headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},body:b,retry:0});if(I().loading_full=!1,O.value==="error"){X().trigger(D,d);return}s.value.val=m.value.val,s.value.val_user=m.value.val_user,s.value.val_by=m.value.val_by,s.value.val_at=m.value.val_at,s.value.val1=m.value.val1,s.value.val1_user=m.value.val1_user,s.value.val1_by=m.value.val1_by,s.value.val1_at=m.value.val1_at;let H=h.p_data.map(te=>te.id).indexOf(h.id);H>=-1&&h.p_data.splice(H,1,{...s.value}),h.fnClose()},y=async()=>{I().loading_full=!0;const{data:b,error:g,status:p}=await Z("/standby_mst",{method:"get",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},params:{id:h.id},retry:0});if(I().loading_full=!1,p.value==="error"){X().trigger(g);return}s.value=b.value.data,S.value=b.value.data.details},A=ce(()=>{let b=0;return S.value.forEach(g=>{g.p_status!="Remove"&&(b+=parseInt(g.amount))}),b}),B=ce(()=>!1);return _e(()=>h.show,(b,g)=>{b==!0&&(h.is_view==!1&&setTimeout(()=>{w.value.focus()},1),y())},{immediate:!0}),(b,g)=>{const p=ye;return N((i(),u("section",fs,[e("div",null,[k(p,{title:"Form Master Standby Validation",fn:x.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",ps,[e("div",ms,[e("div",vs,[e("div",hs,[ws,e("div",xs,n(t(s).name),1)]),e("div",ys,[bs,e("div",$s,n(t(s).tipe),1)]),e("div",gs,[ks,e("div",As,n(t(L)(t(s).amount||0)),1)]),e("div",Cs,[Ss,e("div",Ds,[e("input",{checked:t(s).is_transition,disabled:"disabled",type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded"},null,8,Is),e("label",Ts,n(t(s).is_transition?"Ya":"Tidak"),1)]),e("p",js,n(t(d).is_transition),1)])]),e("div",Fs,[e("div",Us,[e("table",Ps,[e("thead",null,[Ms,e("tr",Ns,[Vs,Bs,qs,Rs,zs,e("th",Ls,[oe("Amount "),Hs,oe(),e("span",Ys,"("+n(t(L)(t(A)))+")",1)]),Es])]),e("tbody",Os,[(i(!0),u(ee,null,fe(t(S),(m,D)=>(i(),u(ee,{key:D},[m.p_status!="Remove"?(i(),u("tr",{key:0,"data-index":D},[e("td",null,n(D+1)+".",1),e("td",{class:V(["cell bold",t(B)?"unselectable":""])},[e("div",Js,n(m.ac_account_id),1)],2),e("td",{class:V(["cell bold",t(B)?"unselectable":""])},[e("div",Gs,n(m.ac_account_code),1)],2),e("td",{class:V(["cell bold",t(B)?"unselectable":""])},[e("div",Xs,n(m.ac_account_name),1)],2),t(B)?C("",!0):(i(),u("td",Zs,[e("div",Qs,n(m.description),1)])),e("td",{class:V(["cell bold",t(B)?"unselectable":""])},[e("div",Ws,n(t(L)(m.amount||0)),1)],2),e("td",{class:V(["cell",t(B)?"unselectable":""])},n(m.xfor),3)],8,Ks)):C("",!0)],64))),128))],512)])])])]),e("div",el,[e("div",tl,[sl,t(s).val||t(s).val1?(i(),u("div",ll,[t(s).val?(i(),u("div",al," App 1 : "+n(t(s).val_by.username)+" ( "+n(t(s).val_at?t(E)(t(s).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):C("",!0),t(s).val1?(i(),u("div",ol," App 2 : "+n(t(s).val1_by.username)+" ( "+n(t(s).val1_at?t(E)(t(s).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):C("",!0)])):C("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:g[0]||(g[0]=m=>x.fnClose())}," Cancel "),x.is_view==0?(i(),u("button",{key:0,ref_key:"it_val",ref:w,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:g[1]||(g[1]=pe(m=>P(),["prevent"]))}," Validasi ",512)):C("",!0)])])])],512)),[[be,x.show]])}}},il=Ae(nl,[["__scopeId","data-v-4f875e27"]]),cl={class:"w-full h-full flex flex-col"},ul={class:"w-full flex grow flex-col overflow-auto h-0"},dl={class:"w-full flex"},rl={action:"#",class:"w-full flex p-1"},_l={class:"grow"},fl=e("div",{class:"font-bold"}," Keyword ",-1),pl={class:"pl-1"},ml=e("div",{class:"font-bold"}," Sort By ",-1),vl=e("option",{value:""},null,-1),hl=e("option",{value:"id"},"ID",-1),wl=e("option",{value:"name"},"Name",-1),xl=e("option",{value:"tipe"},"Tipe",-1),yl=[vl,hl,wl,xl],bl={class:"pl-1"},$l=e("div",{class:"font-bold"}," Sort Order ",-1),gl=e("option",{value:"asc"},"Asc",-1),kl=e("option",{value:"desc"},"Desc",-1),Al=[gl,kl],Cl={class:"flex items-end pl-1"},Sl={class:"w-full flex justify-center items-center grow h-0 p-1"},Dl={key:0,class:""},Il={class:"tacky"},Tl=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"App 2"),e("th",null,"ID"),e("th",null,"Name"),e("th",null,"Tipe"),e("th",null,"Amount"),e("th",null,"Peralihan"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),jl=["onClick"],Fl={class:"flex items-center justify-center"},Ul={class:"flex items-center justify-center"},Pl={class:"bold"},Ml={class:"grow mb-5"},sa={__name:"index",async setup(x){let h,E;const{$moment:L}=ke(),{pointFormat:c}=G(),s={};s._TimeZoneOffset=new Date().getTimezoneOffset(),s.sort="created_at:desc";const T=ie("token"),{data:d}=([h,E]=Ze(async()=>tt(async()=>{let l=[];I().loading_full=!0;const{data:_,error:J,status:se}=await Z("/standby_msts",{method:"get",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},params:s,retry:0});return I().loading_full=!1,se.value==="error"?(X().trigger(J),{standby_msts:l}):(l=_.value.data,{standby_msts:l})},"$rczbThuP8g")),h=await h,E(),h),w=r(d.value.standby_msts),S=r(""),P=r({field:"created_at",by:"desc"}),y=r(-1),A=r({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),B=()=>{s.like="",S.value!=""&&(s.like=`id:%${S.value}%,name:%${S.value}%,amount:%${S.value}%`),s.sort="",P.value.field&&(s.sort=P.value.field+":"+P.value.by)},b=r(null),g=async()=>{I().loading_full=!0,A.value.may_get_data=!1,s.page=A.value.page,s.page==1&&(w.value=[]),s.first_row&&delete s.first_row,s.page>1&&(s.first_row=JSON.stringify(w.value[0]));const{data:l,error:_,status:J}=await Z("/standby_msts",{method:"get",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},params:s,retry:0});if(I().loading_full=!1,A.value.may_get_data=!0,J.value==="error"){X().trigger(_);return}A.value.page==1?(w.value=l.value.data,b.value&&(b.value.scrollTop=0)):A.value.page>1&&(w.value=[...w.value,...l.value.data]),l.value.data.length==0&&(A.value.is_last_record=!0)},p=async()=>{if(!A.value.may_get_data)return;let l=b.value;if(l.scrollLeft!=A.value.scrollLeft){A.value.scrollLeft=l.scrollLeft;return}A.value.is_last_record||!(Math.round(l.scrollTop)+l.clientHeight>=l.scrollHeight-1)||(A.value.page++,await g())},m=()=>{A.value.page=1,A.value.is_last_record=!1,B(),g()};Qe();const D=r(!1),O=r(0),H=r(0),te=()=>{O.value=0,D.value=!0,H.value=!1},{display:K}=he();We(he());const ne=()=>{y.value==-1?K({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(O.value=w.value[y.value].id,D.value=!0,H.value=!1)},$=()=>{y.value==-1?K({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(O.value=w.value[y.value].id,D.value=!0,H.value=!0)},Q=r(!1),o=r(0),a=r(!1),q=()=>{y.value==-1?K({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(o.value=w.value[y.value].id,Q.value=!0,a.value=!1)},M=()=>{y.value==-1?K({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(o.value=w.value[y.value].id,Q.value=!0,a.value=!0)},U=r(!1),W=r({}),R=r(!1),z=r(""),ue=async()=>{R.value&&(R.value=!1)},v=()=>{y.value==-1?K({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(z.value="",W.value={id:w.value[y.value].id},R.value=!0)};_e(()=>z.value,l=>{l.trim().length>0?U.value=!0:U.value=!1},{immediate:!1});const Y=async()=>{I().loading_full=!0;const l=new FormData;l.append("id",w.value[y.value].id),l.append("deleted_reason",z.value),l.append("_method","DELETE");const{data:_,error:J,status:se}=await Z("/standby_mst",{method:"post",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},body:l,retry:0});if(I().loading_full=!1,se.value==="error"){X().trigger(J);return}w.value.splice(y.value,1),y.value=-1,R.value=!1};return(l,_)=>{const J=Me,se=Ve,Ce=xe,Se=Be,De=qe,Ie=Re,Te=ze,je=Le,me=He,ve=Ye,Fe=Ee,Ue=_s,Pe=il;return i(),u("div",cl,[k(J,{title:"List Standby"}),e("div",ul,[e("div",dl,[("useUtils"in l?l.useUtils:t(G))().checkRole(["Logistic"])?C("",!0):(i(),u("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:_[0]||(_[0]=f=>$())},[k(se)])),("useUtils"in l?l.useUtils:t(G))().checkRole(["Logistic"])?C("",!0):(i(),u("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:_[1]||(_[1]=f=>te())},[k(Ce)])),("useUtils"in l?l.useUtils:t(G))().checkRole(["Logistic"])?C("",!0):(i(),u("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:_[2]||(_[2]=f=>ne())},[k(Se)])),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:_[3]||(_[3]=f=>M())},[k(De)]),("useUtils"in l?l.useUtils:t(G))().checkRole(["PabrikTransport"])?C("",!0):(i(),u("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:_[4]||(_[4]=f=>v())},[k(Ie)])),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:_[5]||(_[5]=f=>q())},[k(Te)])]),e("form",rl,[e("div",_l,[fl,N(e("input",{class:"",type:"text","onUpdate:modelValue":_[6]||(_[6]=f=>we(S)?S.value=f:null),name:"search",placeholder:"Keyword"},null,512),[[ae,t(S)]])]),e("div",pl,[ml,N(e("select",{class:"","onUpdate:modelValue":_[7]||(_[7]=f=>t(P).field=f)},yl,512),[[re,t(P).field]])]),e("div",bl,[$l,N(e("select",{class:"","onUpdate:modelValue":_[8]||(_[8]=f=>t(P).by=f)},Al,512),[[re,t(P).by]])]),e("div",Cl,[e("button",{class:"",type:"submit",name:"button",onClick:_[9]||(_[9]=pe(f=>m(),["prevent"]))},[k(je,{class:"text-2xl"})])])]),e("div",Sl,[t(w).length==0?(i(),u("div",Dl," Maaf Tidak Ada Record ")):(i(),u("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:p},[e("table",Il,[Tl,e("tbody",null,[(i(!0),u(ee,null,fe(t(w),(f,de)=>(i(),u("tr",{key:de,onClick:Nl=>y.value=de,class:V(t(y)==de?"active":"")},[e("td",null,[e("div",Fl,[f.val?(i(),le(ve,{key:1})):(i(),le(me,{key:0}))])]),e("td",null,[e("div",Ul,[f.val1?(i(),le(ve,{key:1})):(i(),le(me,{key:0}))])]),e("td",Pl,n(f.id),1),e("td",null,n(f.name),1),e("td",null,n(f.tipe),1),e("td",null,n(t(c)(f.amount)),1),e("td",null,n(f.is_transition?"Ya":"Tidak"),1),e("td",null,n(f.created_at?t(L)(f.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,n(f.updated_at?t(L)(f.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,jl))),128))])])],544))])]),k(Fe,{type:"delete",show:t(R),data:t(W),fnClose:ue,fnConfirm:Y,enabledOk:t(U)},{footer:et(()=>[oe(" Masukkan Alasan Penghapusan: "),e("div",Ml,[N(e("textarea",{"onUpdate:modelValue":_[10]||(_[10]=f=>we(z)?z.value=f:null)},null,512),[[ae,t(z)]])])]),_:1},8,["show","data","enabledOk"]),k(Ue,{show:t(D),fnClose:()=>{D.value=!1},id:t(O),p_data:t(w),is_copy:t(H)},null,8,["show","fnClose","id","p_data","is_copy"]),k(Pe,{show:t(Q),fnClose:()=>{Q.value=!1},id:t(o),p_data:t(w),is_view:t(a)},null,8,["show","fnClose","id","p_data","is_view"])])}}};export{sa as default};
