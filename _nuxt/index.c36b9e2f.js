import Z from"./Header.9ac1304c.js";import Q from"./Copy.9cf5afde.js";import W from"./Plus.d18b4668.js";import X from"./Edit.908721bc.js";import Y from"./Search.a38e5a4d.js";import ee from"./permission_group.1213db6f.js";import{g as te,h as se,r as o,B as oe,j as B,s as ae,f as le,c as u,b as p,a as e,l as a,n as C,k as D,A as ne,m as ie,v as L,C as re,F as ue,D as ce,q as de,o as c,E as _e,t as R,x as w,y as M}from"./entry.e181b2a0.js";import{u as $}from"./useUtils.311d317f.js";import{u as F}from"./useMyFetch.dcf65f79.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./HeaderPopup.vue.3a900691.js";import"./Times.3821d6e4.js";const fe={class:"w-full h-full flex flex-col"},pe={class:"w-full flex grow flex-col overflow-auto h-0"},me={class:"w-full flex"},ve={action:"#",class:"w-full flex p-1"},he={class:"grow"},ge=e("div",{class:"font-bold"}," Keyword ",-1),ye={class:"pl-1"},ke=e("div",{class:"font-bold"}," Sort By ",-1),we=e("option",{value:""},null,-1),be=e("option",{value:"id"},"ID",-1),xe=e("option",{value:"name"},"Name",-1),Ce=e("option",{value:"tipe"},"Tipe",-1),De=[we,be,xe,Ce],$e={class:"pl-1"},Se=e("div",{class:"font-bold"}," Sort Order ",-1),Ae=e("option",{value:"asc"},"Asc",-1),Te=e("option",{value:"desc"},"Desc",-1),Ue=[Ae,Te],Pe={class:"flex items-end pl-1"},Be={class:"w-full flex justify-center items-center grow h-0 p-1"},Le={key:0,class:""},Re={class:"tacky"},Me=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"ID"),e("th",null,"Name")])],-1),Fe=["onClick"],Ie={class:"bold"},Xe={__name:"index",async setup(Ne){let h,S;const l={};l._TimeZoneOffset=new Date().getTimezoneOffset(),l.sort="created_at:desc";const A=te("token"),{data:I}=([h,S]=se(async()=>de(async()=>{let t=[];w().loading_full=!0;const{data:s,error:v,status:b}=await F("/permission_groups",{method:"get",headers:{Authorization:`Bearer ${A.value}`,Accept:"application/json"},params:l,retry:0});return w().loading_full=!1,b.value==="error"?(M().trigger(v),{permission_groups:t}):(t=s.value.data,{permission_groups:t})},"$RBOosuv6RL")),h=await h,S(),h),r=o(I.value.permission_groups),d=o(""),_=o({field:"created_at",by:"desc"}),f=o(-1),n=o({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),N=()=>{l.like="",d.value!=""&&(l.like=`id:%${d.value}%,name:%${d.value}%,amount:%${d.value}%`),l.sort="",_.value.field&&(l.sort=_.value.field+":"+_.value.by)},g=o(null),T=async()=>{w().loading_full=!0,n.value.may_get_data=!1,l.page=n.value.page,l.page==1&&(r.value=[]),l.first_row&&delete l.first_row,l.page>1&&(l.first_row=JSON.stringify(r.value[0]));const{data:t,error:s,status:v}=await F("/permission_groups",{method:"get",headers:{Authorization:`Bearer ${A.value}`,Accept:"application/json"},params:l,retry:0});if(w().loading_full=!1,n.value.may_get_data=!0,v.value==="error"){M().trigger(s);return}n.value.page==1?(r.value=t.value.data,g.value&&(g.value.scrollTop=0)):n.value.page>1&&(r.value=[...r.value,...t.value.data]),t.value.data.length==0&&(n.value.is_last_record=!0)},O=async()=>{if(!n.value.may_get_data)return;let t=g.value;if(t.scrollLeft!=n.value.scrollLeft){n.value.scrollLeft=t.scrollLeft;return}n.value.is_last_record||!(Math.round(t.scrollTop)+t.clientHeight>=t.scrollHeight-1)||(n.value.page++,await T())},V=()=>{n.value.page=1,n.value.is_last_record=!1,N(),T()};oe();const m=o(!1),y=o(0),k=o(0),j=()=>{y.value=0,m.value=!0,k.value=!1},{display:U}=B();ae(B());const z=()=>{f.value==-1?U({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(y.value=r.value[f.value].id,m.value=!0,k.value=!1)},E=()=>{f.value==-1?U({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(y.value=r.value[f.value].id,m.value=!0,k.value=!0)};o(!1),o(0),o(!1);const P=o(!1);o({}),o(!1);const H=o("");return le(()=>H.value,t=>{t.trim().length>0?P.value=!0:P.value=!1},{immediate:!1}),(t,s)=>{const v=Z,b=Q,G=W,K=X,q=Y,J=ee;return c(),u("div",fe,[p(v,{title:"List Permission Group"}),e("div",pe,[e("div",me,[("useUtils"in t?t.useUtils:a($))().checkPermission("permission_group.create")?(c(),u("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[0]||(s[0]=i=>E())},[p(b)])):C("",!0),("useUtils"in t?t.useUtils:a($))().checkPermission("permission_group.create")?(c(),u("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[1]||(s[1]=i=>j())},[p(G)])):C("",!0),("useUtils"in t?t.useUtils:a($))().checkPermission("permission_group.modify")?(c(),u("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[2]||(s[2]=i=>z())},[p(K)])):C("",!0)]),e("form",ve,[e("div",he,[ge,D(e("input",{class:"",type:"text","onUpdate:modelValue":s[3]||(s[3]=i=>ie(d)?d.value=i:null),name:"search",placeholder:"Keyword"},null,512),[[ne,a(d)]])]),e("div",ye,[ke,D(e("select",{class:"","onUpdate:modelValue":s[4]||(s[4]=i=>a(_).field=i)},De,512),[[L,a(_).field]])]),e("div",$e,[Se,D(e("select",{class:"","onUpdate:modelValue":s[5]||(s[5]=i=>a(_).by=i)},Ue,512),[[L,a(_).by]])]),e("div",Pe,[e("button",{class:"",type:"submit",name:"button",onClick:s[6]||(s[6]=re(i=>V(),["prevent"]))},[p(q,{class:"text-2xl"})])])]),e("div",Be,[a(r).length==0?(c(),u("div",Le," Maaf Tidak Ada Record ")):(c(),u("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:g,onScroll:O},[e("table",Re,[Me,e("tbody",null,[(c(!0),u(ue,null,ce(a(r),(i,x)=>(c(),u("tr",{key:x,onClick:Oe=>f.value=x,class:_e(a(f)==x?"active":"")},[e("td",Ie,R(i.id),1),e("td",null,R(i.name),1)],10,Fe))),128))])])],544))])]),p(J,{show:a(m),fnClose:()=>{m.value=!1},id:a(y),p_data:a(r),is_copy:a(k)},null,8,["show","fnClose","id","p_data","is_copy"])])}}};export{Xe as default};
