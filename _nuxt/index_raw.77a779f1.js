import{g as ye,h as ge,r as n,f as Y,C as ke,j as q,s as we,c as d,b as _,a as e,l,n as D,k as $,A as G,m as X,v as Z,D as be,F as xe,E as De,w as Ce,q as Ae,x as g,y as E,o as u,G as je,z as P,t as p,d as Ue,B as V,I as Te,H as $e,_ as B}from"./entry.5e58972d.js";import Pe from"./Header.9fc95eb9.js";import Se from"./Copy.99e9ebd4.js";import Le from"./Plus.70aa9993.js";import ze from"./Edit.6f94f8c7.js";import Ie from"./Delete.3fd1712a.js";import Ee from"./Signature.3215bfb1.js";import Me from"./Search.a2a07351.js";import Ve from"./Line.2cdecc58.js";import Be from"./Check.56e57c9d.js";import{u as k}from"./useUtils.6430647d.js";import{u as M}from"./useMyFetch.cc5d2385.js";import"./_plugin-vue_export-helper.c27b6911.js";const Fe=V(()=>B(()=>import("./PopupMini.47f22e55.js"),["./PopupMini.47f22e55.js","./PopupMini.vue.f594f34d.js","./Times.e3604660.js","./_plugin-vue_export-helper.c27b6911.js","./entry.5e58972d.js","./entry.f59c56d0.css","./Exclamation.35616f2b.js"],import.meta.url).then(m=>m.default||m)),Oe=V(()=>B(()=>import("./ujalan.ac3df7fc.js"),["./ujalan.ac3df7fc.js","./HeaderPopup.vue.40947de1.js","./Times.e3604660.js","./_plugin-vue_export-helper.c27b6911.js","./entry.5e58972d.js","./entry.f59c56d0.css","./InputPointFormat.vue.a9ced51e.js","./Tools.6861c2c5.js","./Check.56e57c9d.js","./Plus.70aa9993.js","./ToolsPopup.19898b3c.js","./ToolsPopup.13c08491.css","./ac_accs.3cf6eaa0.js","./Search.a2a07351.js","./useUtils.6430647d.js","./useMyFetch.cc5d2385.js","./ac_accs.2900e1e1.css"],import.meta.url).then(m=>m.default||m)),Re=V(()=>B(()=>import("./ujalan_validasi.7989d957.js"),["./ujalan_validasi.7989d957.js","./HeaderPopup.vue.40947de1.js","./Times.e3604660.js","./_plugin-vue_export-helper.c27b6911.js","./entry.5e58972d.js","./entry.f59c56d0.css","./Check.56e57c9d.js","./useUtils.6430647d.js","./useMyFetch.cc5d2385.js"],import.meta.url).then(m=>m.default||m)),He={class:"w-full h-full flex flex-col"},Ne={class:"w-full flex grow flex-col overflow-auto h-0"},Je={class:"w-full flex"},Ke={action:"#",class:"w-full flex p-1"},Ye={class:"grow"},qe=e("div",{class:"font-bold"}," Keyword ",-1),Ge={class:"pl-1"},Xe=e("div",{class:"font-bold"}," Sort By ",-1),Ze=Te('<option value=""></option><option value="id">ID</option><option value="xto">To</option><option value="jenis">Jenis</option><option value="tipe">Tipe</option>',5),Qe=[Ze],We={class:"pl-1"},et=e("div",{class:"font-bold"}," Sort Order ",-1),tt=e("option",{value:"asc"},"Asc",-1),at=e("option",{value:"desc"},"Desc",-1),lt=[tt,at],ot={class:"flex items-end pl-1"},st={class:"w-full flex justify-center items-center grow h-0 p-1"},nt={key:0,class:""},it={class:"tacky"},ut=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"App 2"),e("th",null,"ID"),e("th",null,"To"),e("th",null,"Tipe"),e("th",null,"Jenis"),e("th",null,"Harga"),e("th",null,"Ket.U.Remarks"),e("th",null,"Asal Peralihan"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),rt=["onClick"],ct={class:"flex items-center justify-center"},dt={class:"flex items-center justify-center"},_t={class:"bold"},mt={class:"grow mb-5"},Ut={__name:"index_raw",async setup(m){let C,F;const{$moment:O}=$e(),{pointFormat:Q}=k(),i={};i._TimeZoneOffset=new Date().getTimezoneOffset(),i.sort="created_at:desc";const S=ye("token"),{data:W}=([C,F]=ge(async()=>Ae(async()=>{let t=[];g().loading_full=!0;const{data:o,error:h,status:x}=await M("/ujalan",{method:"get",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},params:i,retry:0});return g().loading_full=!1,x.value==="error"?(E().trigger(h),{ujalans:t}):(t=o.value.data,{ujalans:t})},{lazy:!0,server:!1,default:()=>({ujalans:[]})},"$XlCU6SukAB")),C=await C,F(),C),s=n([]);Y(()=>{var t;return(t=W.value)==null?void 0:t.ujalans},t=>{t&&(s.value=[...t])},{immediate:!0});const f=n(""),v=n({field:"created_at",by:"desc"}),r=n(-1),c=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),ee=()=>{i.like="",f.value!=""&&(i.like=`id:%${f.value}%,xto:%${f.value}%,tipe:%${f.value}%,jenis:%${f.value}%,harga:%${f.value}%`),i.sort="",v.value.field&&(i.sort=v.value.field+":"+v.value.by)},A=n(null),R=async()=>{g().loading_full=!0,c.value.may_get_data=!1,i.page=c.value.page,i.page==1&&(s.value=[]),i.first_row&&delete i.first_row,i.page>1&&(i.first_row=JSON.stringify(s.value[0]));const{data:t,error:o,status:h}=await M("/ujalan",{method:"get",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},params:i,retry:0});if(g().loading_full=!1,c.value.may_get_data=!0,h.value==="error"){E().trigger(o);return}c.value.page==1?(s.value=t.value.data,A.value&&(A.value.scrollTop=0)):c.value.page>1&&(s.value=[...s.value,...t.value.data]),t.value.data.length==0&&(c.value.is_last_record=!0)},te=async()=>{if(!c.value.may_get_data)return;let t=A.value;if(t.scrollLeft!=c.value.scrollLeft){c.value.scrollLeft=t.scrollLeft;return}c.value.is_last_record||!(Math.round(t.scrollTop)+t.clientHeight>=t.scrollHeight-1)||(c.value.page++,await R())},ae=()=>{c.value.page=1,c.value.is_last_record=!1,ee(),R()};ke();const w=n(!1),j=n(0),U=n(0),le=()=>{j.value=0,w.value=!0,U.value=!1},{display:T}=q();we(q());const oe=()=>{r.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(j.value=s.value[r.value].id,w.value=!0,U.value=!1)},se=()=>{r.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(j.value=s.value[r.value].id,w.value=!0,U.value=!0)},L=n(!1),H=n(0),ne=()=>{r.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(H.value=s.value[r.value].id,L.value=!0)},z=n(!1),N=n({}),b=n(!1),y=n(""),ie=async()=>{b.value&&(b.value=!1)},ue=()=>{r.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(y.value="",N.value={id:s.value[r.value].id},b.value=!0)};Y(()=>y.value,t=>{t.trim().length>0?z.value=!0:z.value=!1},{immediate:!1});const re=async()=>{g().loading_full=!0;const t=new FormData;t.append("id",s.value[r.value].id),t.append("deleted_reason",y.value),t.append("_method","DELETE");const{data:o,error:h,status:x}=await M("/ujalan",{method:"post",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},body:t,retry:0});if(g().loading_full=!1,x.value==="error"){E().trigger(h);return}s.value.splice(r.value,1),r.value=-1,b.value=!1};return(t,o)=>{const h=Pe,x=Se,ce=Le,de=ze,_e=Ie,me=Ee,fe=Me,J=Ve,K=Be,pe=Fe,ve=Oe,he=Re;return u(),d("div",He,[_(h,{title:"List Ujalan"}),e("div",Ne,[e("div",Je,[("useUtils"in t?t.useUtils:l(k))().checkPermission("ujalan.create")?(u(),d("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[0]||(o[0]=a=>se())},[_(x)])):D("",!0),("useUtils"in t?t.useUtils:l(k))().checkPermission("ujalan.create")?(u(),d("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[1]||(o[1]=a=>le())},[_(ce)])):D("",!0),("useUtils"in t?t.useUtils:l(k))().checkPermissions(["ujalan.modify","ujalan.detail.modify","ujalan.detail2.modify"])?(u(),d("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[2]||(o[2]=a=>oe())},[_(de)])):D("",!0),("useUtils"in t?t.useUtils:l(k))().checkPermission("ujalan.remove")?(u(),d("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[3]||(o[3]=a=>ue())},[_(_e)])):D("",!0),("useUtils"in t?t.useUtils:l(k))().checkPermissions(["ujalan.val","ujalan.val1"])?(u(),d("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[4]||(o[4]=a=>ne())},[_(me)])):D("",!0)]),e("form",Ke,[e("div",Ye,[qe,$(e("input",{class:"",type:"text","onUpdate:modelValue":o[5]||(o[5]=a=>X(f)?f.value=a:null),name:"search",placeholder:"Keyword"},null,512),[[G,l(f)]])]),e("div",Ge,[Xe,$(e("select",{class:"","onUpdate:modelValue":o[6]||(o[6]=a=>l(v).field=a)},Qe,512),[[Z,l(v).field]])]),e("div",We,[et,$(e("select",{class:"","onUpdate:modelValue":o[7]||(o[7]=a=>l(v).by=a)},lt,512),[[Z,l(v).by]])]),e("div",ot,[e("button",{class:"",type:"submit",name:"button",onClick:o[8]||(o[8]=be(a=>ae(),["prevent"]))},[_(fe,{class:"text-2xl"})])])]),e("div",st,[l(s).length==0?(u(),d("div",nt," Maaf Tidak Ada Record ")):(u(),d("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:A,onScroll:te},[e("table",it,[ut,e("tbody",null,[(u(!0),d(xe,null,De(l(s),(a,I)=>(u(),d("tr",{key:I,onClick:ft=>r.value=I,class:je(l(r)==I?"active":"")},[e("td",null,[e("div",ct,[a.val?(u(),P(K,{key:1})):(u(),P(J,{key:0}))])]),e("td",null,[e("div",dt,[a.val1?(u(),P(K,{key:1})):(u(),P(J,{key:0}))])]),e("td",_t,p(a.id),1),e("td",null,p(a.xto),1),e("td",null,p(a.tipe),1),e("td",null,p(a.jenis),1),e("td",null,p(l(Q)(a.harga)),1),e("td",null,p(a.note_for_remarks),1),e("td",null,p(a.transition_from),1),e("td",null,p(a.created_at?l(O)(a.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,p(a.updated_at?l(O)(a.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,rt))),128))])])],544))])]),_(pe,{type:"delete",show:l(b),data:l(N),fnClose:ie,fnConfirm:re,enabledOk:l(z)},{footer:Ce(()=>[Ue(" Masukkan Alasan Penghapusan: "),e("div",mt,[$(e("textarea",{"onUpdate:modelValue":o[9]||(o[9]=a=>X(y)?y.value=a:null)},null,512),[[G,l(y)]])])]),_:1},8,["show","data","enabledOk"]),_(ve,{show:l(w),fnClose:()=>{w.value=!1},id:l(j),p_data:l(s),is_copy:l(U)},null,8,["show","fnClose","id","p_data","is_copy"]),_(he,{show:l(L),fnClose:()=>{L.value=!1},id:l(H),p_data:l(s)},null,8,["show","fnClose","id","p_data"])])}}};export{Ut as default};
