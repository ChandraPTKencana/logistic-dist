import ae from"./Header.30e1a5da.js";import oe from"./Plus.3160fffc.js";import se from"./Edit.5a0aca02.js";import le from"./Delete.0466811e.js";import ne from"./Search.a2e29539.js";import{_ as re}from"./PopupMini.vue.15f692f3.js";import ie from"./vehicle.66c5d863.js";import{g as ue,h as ce,r,B as de,j as H,s as _e,f as fe,c as g,a as e,b as f,k as C,A as N,l as o,m as j,v as z,C as pe,F as O,D as ve,w as me,q as he,x as m,y as B,o as y,E as ge,t as A,d as ye,p as xe,e as we,G as be}from"./entry.b1607c16.js";import{u as I}from"./useMyFetch.d189f369.js";import{_ as ke}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.7f9ccf9f.js";import"./Exclamation.89820026.js";import"./HeaderPopup.vue.40cda0b2.js";import"./useUtils.a1e46544.js";const c=x=>(xe("data-v-7d704cd8"),x=x(),we(),x),De={class:"w-full h-full flex flex-col"},Ce={class:"w-full flex grow flex-col overflow-auto h-0"},Ae={class:"w-full flex"},Se={action:"#",class:"w-full flex p-1"},Me={class:"grow"},Te=c(()=>e("div",{class:"font-bold"}," Keyword ",-1)),$e={class:"pl-1"},Be=c(()=>e("div",{class:"font-bold"}," Sort By ",-1)),Ie=c(()=>e("option",{value:""},null,-1)),Ve=c(()=>e("option",{value:"no_pol"},"No Pol",-1)),Le=[Ie,Ve],Pe={class:"pl-1"},Ee=c(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),Fe=c(()=>e("option",{value:"asc"},"Asc",-1)),He=c(()=>e("option",{value:"desc"},"Desc",-1)),Ne=[Fe,He],je={class:"flex items-end pl-1"},ze={class:"w-full flex justify-center items-center grow h-0 p-1"},Oe={key:0,class:""},Re={class:"tacky"},Ue=c(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"No Pol"),e("th",null,"Tanggal Dibuat"),e("th",null,"Tanggal Diubah")])],-1)),Ke=["onClick"],Xe={class:"bold"},Ye={class:"grow mb-5"},qe={__name:"indextrash",async setup(x){let w,V;const{$moment:L}=be(),i={};i._TimeZoneOffset=new Date().getTimezoneOffset();const S=ue("token"),{data:n}=([w,V]=ce(async()=>he(async()=>{m().loading_full=!0;const{data:a,error:t,status:_}=await I("/vehicles",{method:"get",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},params:i,retry:0});return m().loading_full=!1,_.value==="error"?(B().trigger(t),[]):a.value.data},"$XsXP82IAD8")),w=await w,V(),w),p=r(""),d=r({field:"",by:"desc"}),u=r(-1),l=r({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),R=()=>{i.like="",p.value!=""&&(i.like=`id:%${p.value}%,no_pol:%${p.value}%`),i.sort="",d.value.field&&(i.sort=d.value.field+":"+d.value.by)},b=r(null),P=async()=>{m().loading_full=!0,l.value.may_get_data=!1,i.page=l.value.page,i.page==1&&(n.value=[]);const{data:a,error:t,status:_}=await I("/vehicles",{method:"get",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},params:i,retry:0});if(m().loading_full=!1,l.value.may_get_data=!0,_.value==="error"){B().trigger(t);return}l.value.page==1?(n.value=a.value.data,b.value&&(b.value.scrollTop=0)):l.value.page>1&&(n.value=[...n.value,...a.value.data]),a.value.data.length==0&&(l.value.is_last_record=!0)},U=async()=>{if(!l.value.may_get_data)return;let a=b.value;if(a.scrollLeft!=l.value.scrollLeft){l.value.scrollLeft=a.scrollLeft;return}l.value.is_last_record||!(Math.round(a.scrollTop)+a.clientHeight>=a.scrollHeight-1)||(l.value.page++,await P())},K=()=>{l.value.page=1,l.value.is_last_record=!1,R(),P()};de();const k=r(!1),M=r(0),X=()=>{M.value=0,k.value=!0},{display:E}=H();_e(H());const Y=()=>{u.value==-1?E({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(M.value=n.value[u.value].id,k.value=!0)},T=r(!1),F=r({}),h=r(!1),v=r(""),q=async()=>{h.value&&(h.value=!1)},G=()=>{u.value==-1?E({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(v.value="",F.value={id:n.value[u.value].id},h.value=!0)};fe(()=>v.value,a=>{a.trim().length>0?T.value=!0:T.value=!1},{immediate:!1});const Z=async()=>{m().loading_full=!0;const a=new FormData;a.append("id",n.value[u.value].id),a.append("deleted_reason",v.value),a.append("_method","DELETE");const{data:t,error:_,status:$}=await I("/vehicle",{method:"post",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},body:a,retry:0});if(m().loading_full=!1,$.value==="error"){B().trigger(_);return}n.value.splice(u.value,1),u.value=-1,h.value=!1};return(a,t)=>{const _=ae,$=oe,J=se,Q=le,W=ne,ee=re,te=ie;return y(),g(O,null,[e("div",De,[f(_,{title:"List Vehicle"}),e("div",Ce,[e("div",Ae,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[0]||(t[0]=s=>X())},[f($)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=s=>Y())},[f(J)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=s=>G())},[f(Q)])]),e("form",Se,[e("div",Me,[Te,C(e("input",{class:"",type:"text","onUpdate:modelValue":t[3]||(t[3]=s=>j(p)?p.value=s:null),name:"search",placeholder:"Keyword"},null,512),[[N,o(p)]])]),e("div",$e,[Be,C(e("select",{class:"","onUpdate:modelValue":t[4]||(t[4]=s=>o(d).field=s)},Le,512),[[z,o(d).field]])]),e("div",Pe,[Ee,C(e("select",{class:"","onUpdate:modelValue":t[5]||(t[5]=s=>o(d).by=s)},Ne,512),[[z,o(d).by]])]),e("div",je,[e("button",{class:"",type:"submit",name:"button",onClick:t[6]||(t[6]=pe(s=>K(),["prevent"]))},[f(W,{class:"text-2xl"})])])]),e("div",ze,[o(n).length==0?(y(),g("div",Oe," Maaf Tidak Ada Record ")):(y(),g("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:U},[e("table",Re,[Ue,e("tbody",null,[(y(!0),g(O,null,ve(o(n),(s,D)=>(y(),g("tr",{key:D,onClick:Ge=>u.value=D,class:ge(o(u)==D?"active":"")},[e("td",null,A(D+1)+".",1),e("td",Xe,A(s.no_pol),1),e("td",null,A(o(L)(s.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,A(o(L)(s.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,Ke))),128))])])],544))])])]),f(ee,{type:"delete",show:o(h),data:o(F),fnClose:q,fnConfirm:Z,enabledOk:o(T)},{footer:me(()=>[ye(" Masukkan Alasan Penghapusan: "),e("div",Ye,[C(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=s=>j(v)?v.value=s:null)},null,512),[[N,o(v)]])])]),_:1},8,["show","data","enabledOk"]),f(te,{show:o(k),fnClose:()=>{k.value=!1},id:o(M),p_data:o(n)},null,8,["show","fnClose","id","p_data"])],64)}}},ct=ke(qe,[["__scopeId","data-v-7d704cd8"]]);export{ct as default};
