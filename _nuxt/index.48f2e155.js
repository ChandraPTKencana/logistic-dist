import ie from"./Header.10161cb9.js";import re from"./Plus.edef8342.js";import ue from"./Edit.ca194242.js";import ce from"./Eyes.52ca6953.js";import _e from"./Signature.26ed836c.js";import de from"./Search.ba6d34f4.js";import me from"./Line.034bf4e8.js";import pe from"./Check.efc6cff4.js";import fe from"./mst.ae020758.js";import ve from"./validasi.17ad0c9a.js";import{f as he,g as ye,r as a,h as ge,i as R,s as ke,j as we,c as m,b as p,a as e,k as t,l as b,m as T,v as xe,n as be,q as E,x as Ce,F as De,y as Se,z as $e,o as r,C as Ae,D as C,t as c,H as Pe,E as Ue,A as D,B as O}from"./entry.0c87e920.js";import{u as y}from"./useUtils.e6bf8d11.js";import{u as J}from"./useMyFetch.3ae8d196.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./HeaderPopup.vue.0516f5d4.js";import"./Times.5a73ce15.js";import"./WidthMiniList.vue.625d0b97.js";import"./WidthMiniPart.vue.cace8665.js";import"./InputPointFormat.vue.91773e97.js";import"./AttachmentSingle.b3dc5d9d.js";import"./PDFJsView.048b3893.js";import"./part.fc4df2a0.js";import"./Calculator.5c61dd95.js";import"./trx.e308783d.js";import"./trx_validasi.27d552b8.js";const Me={class:"w-full h-full flex flex-col"},Te={class:"w-full flex grow flex-col overflow-auto h-0"},je={class:"w-full flex"},Ne={action:"#",class:"w-full flex p-1"},Fe={class:"grow"},He=e("div",{class:"font-bold"}," Keyword ",-1),Ie={class:"pl-1"},Be=e("div",{class:"font-bold"}," Sort By ",-1),Le=Pe('<option value=""></option><option value="id">ID</option><option value="xto">To</option><option value="jenis">Jenis</option><option value="tipe">Tipe</option>',5),Ve=[Le],ze={class:"pl-1"},Re=e("div",{class:"font-bold"}," Sort Order ",-1),Ee=e("option",{value:"asc"},"Asc",-1),Oe=e("option",{value:"desc"},"Desc",-1),Je=[Ee,Oe],Ke={class:"flex items-end pl-1"},Ye={class:"w-full flex justify-center items-center grow h-0 p-1"},qe={key:0,class:""},Ze={class:"tacky"},Ge=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"App 2"),e("th",null,"ID"),e("th",null,"Nama Pekerja"),e("th",null,"No Pol"),e("th",null,"Kejadian"),e("th",null,"Nominal"),e("th",null,"Nominal Potongan"),e("th",null,"Sisa Potongan"),e("th",null,"Status"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),Qe=["onClick"],We={class:"flex items-center justify-center"},Xe={class:"flex items-center justify-center"},et={class:"bold"},At={__name:"index",async setup(tt){let g,j;const{$moment:N}=Ue(),{pointFormat:S}=y(),n={};n._TimeZoneOffset=new Date().getTimezoneOffset(),n.sort="created_at:desc";const F=he("token"),{data:K}=([g,j]=ye(async()=>$e(async()=>{let s=[];D().loading_full=!0;const{data:l,error:h,status:U}=await J("/potongan_msts",{method:"get",headers:{Authorization:`Bearer ${F.value}`,Accept:"application/json"},params:n,retry:0});return D().loading_full=!1,U.value==="error"?(O().trigger(h),{potongan_msts:s}):(s=l.value.data,{potongan_msts:s})},"$4H5grU4zhJ")),g=await g,j(),g),u=a(K.value.potongan_msts),_=a(""),f=a({field:"created_at",by:"desc"}),d=a(-1),i=a({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),Y=()=>{n.like="",_.value!=""&&(n.like=`id:%${_.value}%,employee_name:%${_.value}%,no_pol:%${_.value}%,info:%${_.value}%,status:%${_.value}%`),n.sort="",f.value.field&&(n.sort=f.value.field+":"+f.value.by)},k=a(null),H=async()=>{D().loading_full=!0,i.value.may_get_data=!1,n.page=i.value.page,n.page==1&&(u.value=[]),n.first_row&&delete n.first_row,n.page>1&&(n.first_row=JSON.stringify(u.value[0]));const{data:s,error:l,status:h}=await J("/potongan_msts",{method:"get",headers:{Authorization:`Bearer ${F.value}`,Accept:"application/json"},params:n,retry:0});if(D().loading_full=!1,i.value.may_get_data=!0,h.value==="error"){O().trigger(l);return}i.value.page==1?(u.value=s.value.data,k.value&&(k.value.scrollTop=0)):i.value.page>1&&(u.value=[...u.value,...s.value.data]),s.value.data.length==0&&(i.value.is_last_record=!0)},q=async()=>{if(!i.value.may_get_data)return;let s=k.value;if(s.scrollLeft!=i.value.scrollLeft){i.value.scrollLeft=s.scrollLeft;return}i.value.is_last_record||!(Math.round(s.scrollTop)+s.clientHeight>=s.scrollHeight-1)||(i.value.page++,await H())},Z=()=>{i.value.page=1,i.value.is_last_record=!1,Y(),H()};ge();const v=a(!1),w=a(0),$=a(0),G=()=>{w.value=0,v.value=!0,$.value=!1},{display:A}=R();ke(R());const x=a(!1),Q=()=>{d.value==-1?A({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(w.value=u.value[d.value].id,v.value=!0,$.value=!1,x.value=!1)},P=a(!1),I=a(0),W=()=>{d.value==-1?A({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(I.value=u.value[d.value].id,P.value=!0,x.value=!0)},X=()=>{d.value==-1?A({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(w.value=u.value[d.value].id,v.value=!0,x.value=!0)},B=a(!1);a({}),a(!1);const ee=a("");return we(()=>ee.value,s=>{s.trim().length>0?B.value=!0:B.value=!1},{immediate:!1}),(s,l)=>{const h=ie,U=re,te=ue,oe=ce,se=_e,le=de,L=me,V=pe,ae=fe,ne=ve;return r(),m("div",Me,[p(h,{title:"List Potongan"}),e("div",Te,[e("div",je,[("useUtils"in s?s.useUtils:t(y))().checkPermission("potongan_mst.create")?(r(),m("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:l[0]||(l[0]=o=>G())},[p(U)])):b("",!0),("useUtils"in s?s.useUtils:t(y))().checkPermissions(["potongan_mst.modify","potongan_trx.create","potongan_trx.modify","potongan_trx.remove"])?(r(),m("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:l[1]||(l[1]=o=>Q())},[p(te)])):b("",!0),t(d)>-1&&("useUtils"in s?s.useUtils:t(y))().checkPermission("potongan_mst.view")?(r(),m("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:l[2]||(l[2]=o=>X())},[p(oe)])):b("",!0),("useUtils"in s?s.useUtils:t(y))().checkPermissions(["potongan_mst.val","potongan_mst.val1","potongan_trx.val","potongan_trx.val1"])?(r(),m("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:l[3]||(l[3]=o=>W())},[p(se)])):b("",!0)]),e("form",Ne,[e("div",Fe,[He,T(e("input",{class:"",type:"text","onUpdate:modelValue":l[4]||(l[4]=o=>be(_)?_.value=o:null),name:"search",placeholder:"Keyword"},null,512),[[xe,t(_)]])]),e("div",Ie,[Be,T(e("select",{class:"","onUpdate:modelValue":l[5]||(l[5]=o=>t(f).field=o)},Ve,512),[[E,t(f).field]])]),e("div",ze,[Re,T(e("select",{class:"","onUpdate:modelValue":l[6]||(l[6]=o=>t(f).by=o)},Je,512),[[E,t(f).by]])]),e("div",Ke,[e("button",{class:"",type:"submit",name:"button",onClick:l[7]||(l[7]=Ce(o=>Z(),["prevent"]))},[p(le,{class:"text-2xl"})])])]),e("div",Ye,[t(u).length==0?(r(),m("div",qe," Maaf Tidak Ada Record ")):(r(),m("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:k,onScroll:q},[e("table",Ze,[Ge,e("tbody",null,[(r(!0),m(De,null,Se(t(u),(o,M)=>{var z;return r(),m("tr",{key:M,onClick:ot=>d.value=M,class:Ae(t(d)==M?"active":"")},[e("td",null,[e("div",We,[o.val?(r(),C(V,{key:1})):(r(),C(L,{key:0}))])]),e("td",null,[e("div",Xe,[o.val1?(r(),C(V,{key:1})):(r(),C(L,{key:0}))])]),e("td",et,c(o.id),1),e("td",null,c((z=o.employee)==null?void 0:z.name),1),e("td",null,c(o.no_pol),1),e("td",null,c(o.kejadian),1),e("td",null,c(t(S)(o.nominal)),1),e("td",null,c(t(S)(o.nominal_cut)),1),e("td",null,c(t(S)(o.remaining_cut)),1),e("td",null,c(o.status),1),e("td",null,c(o.created_at?t(N)(o.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,c(o.updated_at?t(N)(o.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,Qe)}),128))])])],544))])]),p(ae,{show:t(v),fnClose:()=>{v.value=!1},id:t(w),p_data:t(u),is_copy:t($),is_view:t(x)},null,8,["show","fnClose","id","p_data","is_copy","is_view"]),p(ne,{show:t(P),fnClose:()=>{P.value=!1},id:t(I),p_data:t(u)},null,8,["show","fnClose","id","p_data"])])}}};export{At as default};
