import{r as u,g as S,h as I,J as L,c as v,a as t,b as r,w as M,t as w,l as s,k as N,A as R,m as U,F as T,E as H,D as $,q as Z,o as x,B as q,x as d,y,_ as G,H as J}from"./entry.80f9400f.js";import Q from"./Header.d832b074.js";import{_ as X}from"./client-only.b5fd6b3a.js";import K from"./PrinterEye.45c84bee.js";import W from"./Table2Column.1f2f6325.js";import{u as g}from"./useMyFetch.a3705501.js";import{u as ee}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";const te=q(()=>G(()=>import("./PDFView.095cf9d0.js"),["./PDFView.095cf9d0.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./useDownload.174f4da2.js"],import.meta.url).then(f=>f.default||f)),oe={class:"w-full h-full flex flex-col"},se={class:"w-full flex grow flex-col overflow-auto h-0 bg-gray-200 justify-center items-center p-2"},le={class:"bg-white p-2"},ae={action:"#",class:"w-full flex flex-col sm:flex-row flex-wrap text-xs"},ne={class:"w-full p-1 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col"},re=t("div",{class:"font-bold"}," Tgl Dari ",-1),ie={class:"text-red-500"},ce={class:"w-full p-1 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col"},ue=t("div",{class:"font-bold"}," Tgl Sampai ",-1),de={class:"text-red-500"},me={class:"w-full p-1 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col"},_e=t("div",{class:"font-bold"}," Lokasi ",-1),fe={id:"locations"},pe=["value"],ve={class:"w-full p-1 sm:w-12/12 md:w-12/12 lg:w-3/12 flex items-end justify-end"},we=t("div",{class:"text-left m-1"},"Download PDF",-1),xe=t("div",{class:"text-left m-1"},"Download Excel",-1),Me={__name:"ramp",async setup(f){let m,h;const{$moment:D}=J(),l={};l._TimeZoneOffset=new Date().getTimezoneOffset(),l.sort="tanggal:desc";const b=u({}),p=S("token"),a=u({from:"",to:""}),{data:j}=([m,h]=I(async()=>Z(async()=>{d().loading_full=!0;let n=[];const[e,c]=await Promise.all([g("/report/ramp/get_locations",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},retry:0})]);return e.status.value!=="error"&&(n=e.data.value.list_xto),e.status.value==="error"?(y().trigger(e.error),{locations:n}):(d().loading_full=!1,{locations:n})},"$SQhImG8ywX")),m=await m,h(),m),E=u(j.value.locations||[]),_=u(""),C=()=>{l._TimeZoneOffset=new Date().getTimezoneOffset(),l.date_from=a.value.from?D(a.value.from).format("YYYY-MM-DD"):"",l.date_to=a.value.to?D(a.value.to).format("YYYY-MM-DD"):"",l.location=_.value},{downloadFile:P,viewFile:ye}=ee(),i=u(!1),k=u({}),Y=async()=>{if(i.value==!0){i.value=!1;return}C(),d().loading_full=!0;const{data:n,error:e,status:c}=await g("/report/ramp/pdf_preview",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:l,retry:0});if(d().loading_full=!1,c.value==="error"){y().trigger(e);return}k.value=n.value,i.value=!0},z=async()=>{C(),d().loading_full=!0;const{data:n,error:e,status:c}=await g("/report/ramp/excel_download",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:l,retry:0});if(d().loading_full=!1,c.value==="error"){y().trigger(e);return}P(n.value)};return(n,e)=>{const c=Q,A=L("vue-date-picker"),V=X,B=K,F=W,O=te;return x(),v(T,null,[t("div",oe,[r(c,{title:"Report Transaction"}),t("div",se,[t("div",le,[t("form",ae,[t("div",ne,[re,r(V,null,{default:M(()=>[r(A,{modelValue:s(a).from,"onUpdate:modelValue":e[0]||(e[0]=o=>s(a).from=o),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"",class:"flex-grow"},null,8,["modelValue"])]),_:1}),t("p",ie,w(s(b).date_from),1)]),t("div",ce,[ue,r(V,null,{default:M(()=>[r(A,{modelValue:s(a).to,"onUpdate:modelValue":e[1]||(e[1]=o=>s(a).to=o),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"",class:"flex-grow"},null,8,["modelValue"])]),_:1}),t("p",de,w(s(b).date_to),1)]),t("div",me,[_e,N(t("input",{type:"text",list:"locations","onUpdate:modelValue":e[2]||(e[2]=o=>U(_)?_.value=o:null)},null,512),[[R,s(_)]]),t("datalist",fe,[(x(!0),v(T,null,H(s(E),o=>(x(),v("option",{value:o},w(o),9,pe))),256))])]),t("div",ve,[t("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:e[3]||(e[3]=$(o=>Y(),["prevent"]))},[t("div",null,[r(B,{class:"text-2xl"})]),we]),t("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:e[4]||(e[4]=$(o=>z(),["prevent"]))},[t("div",null,[r(F,{class:"text-2xl"})]),xe])])])])])]),r(O,{show:s(i),pdfContent:s(k),onClose:e[5]||(e[5]=o=>i.value=!s(i))},null,8,["show","pdfContent"])],64)}}};export{Me as default};
