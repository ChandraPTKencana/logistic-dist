import we from"./Header.30e1a5da.js";import De from"./Copy.161fa137.js";import Se from"./Edit.5a0aca02.js";import Ce from"./Eyes.74772ee2.js";import $e from"./Delete.0466811e.js";import Ae from"./Signature.15fb7a79.js";import Te from"./Line.d8cf64c3.js";import Me from"./Check.641b0fcd.js";import Oe from"./TypeIcon.2599ef7b.js";import Pe from"./TableView.2e3cf35a.js";import{_ as Ne}from"./PopupMini.vue.15f692f3.js";import Ie from"./employee.208807de.js";import Be from"./employee_validasi.3d817ce8.js";import{r as n,f as G,g as Fe,h as Ee,i as k,B as je,j as Q,s as ze,c as g,a as r,b as i,k as W,v as Ve,l as o,m as X,n as C,w as h,F as He,q as Re,x as m,y as V,o as _,z as P,d as H,t as ee,A as Le,p as Ue,e as Ye}from"./entry.b1607c16.js";import{u as R}from"./useMyFetch.d189f369.js";import{u as v}from"./useUtils.a1e46544.js";import{_ as Je}from"./_plugin-vue_export-helper.c27b6911.js";import"./DocJPEG.f10c1bd2.js";import"./DocJPG.37bc1f05.js";import"./DocPNG.96384c2b.js";import"./DocPDF.d467e434.js";import"./Search.a2e29539.js";import"./Adjust.36f91f50.js";import"./TableHeaderEye.5de352cd.js";import"./Times.7f9ccf9f.js";import"./ClearAll.99f0b7d4.js";import"./client-only.4153054f.js";import"./ClearEach.71f6b782.js";import"./CaretLeftDoubleBold.94adf3cc.js";import"./CaretLeftBold.818f5489.js";import"./CaretRightBold.7263df3f.js";import"./CaretRightDoubleBold.d795262b.js";import"./Exclamation.89820026.js";import"./HeaderPopup.vue.40cda0b2.js";import"./AttachmentSingle.0225b657.js";import"./PDFJsView.f4f4a869.js";const N=$=>(Ue("data-v-9170b2ea"),$=$(),Ye(),$),Ke={class:"w-full h-full flex flex-col"},qe={class:"w-full flex grow flex-col overflow-auto h-0"},Ze={class:"w-full flex justify-between flex-wrap"},Ge={class:"grow flex"},Qe={class:"m-1"},We=N(()=>r("option",{value:"available"},"Available",-1)),Xe=N(()=>r("option",{value:"unapprove"},"Unapprove",-1)),et=N(()=>r("option",{value:"deleted"},"Trash",-1)),tt=N(()=>r("option",{value:"all"},"All",-1)),lt=[We,Xe,et,tt],at={class:"grow mb-5"},ot={__name:"index",async setup($){let A,L;const te=e=>e.deleted==1?"!bg-red-400":e.val==0||e.val1==0?"!bg-gray-300":"",p=n("available");G(()=>p.value,e=>{J()},{immediate:!1});const u={};u._TimeZoneOffset=new Date().getTimezoneOffset();const I=Fe("token"),{data:s}=([A,L]=Ee(async()=>Re(async()=>{m().loading_full=!0;const{data:e,error:t,status:y}=await R("/employees",{method:"get",headers:{Authorization:`Bearer ${I.value}`,Accept:"application/json"},params:{filter_status:p},retry:0});return m().loading_full=!1,y.value==="error"?(V().trigger(t),[]):e.value.data},"$p5jj5crAgd")),A=await A,L(),A),B=n({field:"",by:"desc"}),l=n(-1),d=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),c=k(()=>s.value[l.value]),le=()=>{u.like="";let e=JSON.parse(JSON.stringify(m()._tv.global_keyword));e!=""&&(u.like=`id:%${e}%,name:%${e}%,ktp_no:%${e}%,sim_no:%${e}%,phone_number:%${e}%,rek_no:%${e}%`),u.sort="",B.value.field&&(u.sort=B.value.field+":"+B.value.by),u.filter_model=JSON.stringify(m()._tv.filter_model)},U=n(null),Y=async()=>{m().loading_full=!0,d.value.may_get_data=!1,u.page=d.value.page,u.page==1&&(s.value=[]),u.filter_status=p.value;const{data:e,error:t,status:y}=await R("/employees",{method:"get",headers:{Authorization:`Bearer ${I.value}`,Accept:"application/json"},params:u,retry:0});if(m().loading_full=!1,d.value.may_get_data=!0,y.value==="error"){V().trigger(t);return}d.value.page==1?(s.value=e.value.data,U.value&&(U.value.scrollTop=0)):d.value.page>1&&(s.value=[...s.value,...e.value.data]),e.value.data.length==0&&(d.value.is_last_record=!0),m()._tv.filter_box=!1},J=()=>{l.value=-1,d.value.page=1,d.value.is_last_record=!1,le(),Y()};je();const T=n(!1),F=n(0),x=n(0),M=n(!1),{display:w}=Q();ze(Q());const ae=()=>{l.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=s.value[l.value].id,M.value=!1,x.value=!1,T.value=!0)},oe=()=>{l.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=s.value[l.value].id,M.value=!1,x.value=!0,T.value=!0)},O=n(!1),E=n(0),se=()=>{l.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(E.value=s.value[l.value].id,M.value=!1,x.value=!1,O.value=!0)},ne=()=>{l.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(E.value=s.value[l.value].id,M.value=!0,x.value=!1,O.value=!0)},j=n(!1),K=n({}),D=n(!1),b=n(""),re=async()=>{D.value&&(D.value=!1)},ie=()=>{l.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(b.value="",K.value={id:s.value[l.value].id},D.value=!0)};G(()=>b.value,e=>{e.trim().length>0?j.value=!0:j.value=!1},{immediate:!1});const ue=async()=>{m().loading_full=!0;const e=new FormData;e.append("id",s.value[l.value].id),e.append("deleted_reason",b.value),e.append("_method","DELETE");const{data:t,error:y,status:z}=await R("/employee",{method:"post",headers:{Authorization:`Bearer ${I.value}`,Accept:"application/json"},body:e,retry:0});if(m().loading_full=!1,z.value==="error"){V().trigger(y);return}let f={...s.value[l.value]};f.deleted=t.value.deleted,f.deleted_user=t.value.deleted_user,f.deleted_at=t.value.deleted_at,f.deleted_by=t.value.deleted_by,f.deleted_reason=t.value.deleted_reason,p.value!="all"?s.value.splice(l.value,1):s.value.splice(l.value,1,{...f}),l.value=-1,D.value=!1},de=n([{key:"no",label:"No",isai:!0},{key:"val",label:"App 1",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"id",label:"ID",freeze:1,filter_on:1,type:"number"},{key:"name",label:"Nama",freeze:1,freeze_left:"44px",filter_on:1,type:"string",sort:{priority:1,type:"asc"}},{key:"role",label:"Jabatan",filter_on:1,type:"string"},{key:"ktp_no",label:"No KTP",filter_on:1,type:"string"},{key:"sim_no",label:"No SIM",filter_on:1,type:"string"},{key:"bank_code",label:"Nama Bank",filter_on:1,type:"string"},{key:"rek_no",label:"No Rek",filter_on:1,type:"string"},{key:"rek_name",label:"Nama Rek",filter_on:1,type:"string"},{key:"phone_number",label:"No Tlp",filter_on:1,type:"string"},{key:"birth_place",label:"Tempat Lahir",filter_on:1,type:"string"},{key:"birth_date",label:"Tanggal Lahir",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"tmk",label:"TMK",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"address",label:"Alamat",filter_on:1,type:"string"},{key:"status",label:"Status",filter_on:1,type:"string"},{key:"attachment_1_type",label:"File",type:"string"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]),_e=k(()=>l.value>-1&&[void 0,0].indexOf(c.value.deleted)>-1&&v().checkPermission("employee.create"));k(()=>["available","all","unapprove"].indexOf(p.value)>-1&&v().checkPermission("employee.create"));const me=k(()=>l.value>-1&&[void 0,0].indexOf(c.value.deleted)>-1&&(v().checkPermission("employee.val")&&[void 0,0].indexOf(c.value.val)>-1||v().checkPermission("employee.val1")&&[void 0,0].indexOf(c.value.val1)>-1)&&v().checkPermissions(["employee.modify","employee.detail.modify","employee.detail2.modify"])),pe=k(()=>l.value>-1&&[void 0,0].indexOf(c.value.deleted)>-1&&(v().checkPermission("employee.val")&&[void 0,0].indexOf(c.value.val)>-1||v().checkPermission("employee.val1")&&[void 0,0].indexOf(c.value.val1)>-1)),ce=k(()=>l.value>-1&&v().checkPermission("employee.remove")&&[void 0,0].indexOf(c.value.deleted)>-1);return(e,t)=>{const y=we,z=De,f=Se,fe=Ce,ve=$e,ye=Ae,q=Te,Z=Me,be=Oe,ke=Pe,ge=Ne,he=Ie,xe=Be;return _(),g(He,null,[r("div",Ke,[i(y,{title:"List Employee"}),r("div",qe,[r("div",Ze,[r("div",Ge,[r("div",Qe,[W(r("select",{class:"","onUpdate:modelValue":t[0]||(t[0]=a=>X(p)?p.value=a:null)},lt,512),[[Ve,o(p)]])]),o(_e)?(_(),g("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=a=>oe())},[i(z)])):C("",!0),o(me)?(_(),g("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=a=>ae())},[i(f)])):C("",!0),o(l)>-1?(_(),g("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[3]||(t[3]=a=>ne())},[i(fe)])):C("",!0),o(ce)?(_(),g("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[4]||(t[4]=a=>ie())},[i(ve)])):C("",!0),o(pe)?(_(),g("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[5]||(t[5]=a=>se())},[i(ye)])):C("",!0)])]),i(ke,{thead:o(de),selected:o(l),onSetSelected:t[6]||(t[6]=a=>l.value=a),tbody:o(s),fnCallData:Y,scrolling:o(d),onSetScrollingPage:t[7]||(t[7]=a=>o(d).page=a),onDoFilter:t[8]||(t[8]=a=>J()),rowBgColor:te},{val:h(({item:a})=>[a.val?(_(),P(Z,{key:1})):(_(),P(q,{key:0}))]),val1:h(({item:a})=>[a.val1?(_(),P(Z,{key:1})):(_(),P(q,{key:0}))]),bank_code:h(({item:a})=>{var S;return[H(ee((S=a.bank)==null?void 0:S.code),1)]}),attachment_1_type:h(({item:a})=>[i(be,{value:a.attachment_1_type},null,8,["value"])]),deleted_by_username:h(({item:a})=>{var S;return[H(ee((S=a.deleted_by)==null?void 0:S.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])])]),i(ge,{type:"delete",show:o(D),data:o(K),fnClose:re,fnConfirm:ue,enabledOk:o(j)},{footer:h(()=>[H(" Masukkan Alasan Penghapusan: "),r("div",at,[W(r("textarea",{"onUpdate:modelValue":t[9]||(t[9]=a=>X(b)?b.value=a:null)},null,512),[[Le,o(b)]])])]),_:1},8,["show","data","enabledOk"]),i(he,{show:o(T),fnClose:()=>{T.value=!1},id:o(F),p_data:o(s),is_copy:o(x)},null,8,["show","fnClose","id","p_data","is_copy"]),i(xe,{show:o(O),fnClose:()=>{O.value=!1},id:o(E),p_data:o(s)},null,8,["show","fnClose","id","p_data"])],64)}}},Ht=Je(ot,[["__scopeId","data-v-9170b2ea"]]);export{Ht as default};
