import{_ as Q}from"./HeaderPopup.vue.86045a0c.js";import{_ as W}from"./client-only.9e4c3a6c.js";import{r as B,f as X,G as i,j as Z,I as tt,m as z,J as et,o as c,c as p,a as t,b as T,k as e,t as o,w as st,v as at,l as j,d as u,F as J,y as ot,x as lt,E as nt,A as F,B as L}from"./entry.d4a712ce.js";import{u as A}from"./useUtils.ac7bdcb3.js";import{u as U}from"./useMyFetch.59570776.js";import"./Times.d7261ee5.js";import"./_plugin-vue_export-helper.c27b6911.js";const rt={class:"box-fixed"},_t={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},ut={class:"w-full flex flex-col items-center grow overflow-auto"},it={class:"w-full flex flex-row flex-wrap"},ct={class:"w-1/2 sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},pt=t("label",{for:""},"Period End",-1),dt={key:0,class:"card-border"},mt={key:1},ht={class:"text-red-500"},ft={key:0,class:"w-full p-1"},vt=t("div",{class:"font-bold"}," Filter Nama ",-1),yt={key:1,class:"w-full flex p-1 justify-between flex-wrap"},bt={class:"w-full",role:"sticky"},wt={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},kt=t("tr",{class:"sticky -top-1 !z-[2]"},[t("td",{colspan:"27",class:"!bg-slate-800 text-white font-bold"}," Detail ")],-1),xt={class:"sticky top-7 !z-[2]"},jt=t("th",{rowspan:"2"},"No",-1),Ft=t("th",{rowspan:"2"},"ID",-1),gt=t("th",{rowspan:"2"},"Nama Pekerja",-1),Et=t("th",{rowspan:"2"},"Jabatan",-1),Mt=t("th",{rowspan:"2"},"Tmpt Lahir",-1),Ct=t("th",{rowspan:"2"},"Tgl Lahir",-1),Dt=t("th",{rowspan:"2"},"TMK",-1),Nt=t("th",{rowspan:"2"},"No KTP",-1),St=t("th",{rowspan:"2"},"Alamat",-1),Pt=t("th",{rowspan:"2"},"Status",-1),Bt=t("th",{rowspan:"2"},"No Rek",-1),Tt=t("th",{rowspan:"2"},"Nama Bank",-1),At={colspan:"3"},Vt={class:"text-sm"},qt={colspan:"3"},$t={class:"text-sm"},Gt={colspan:"3"},zt={class:"text-sm"},Jt={rowspan:"2"},Lt={class:"text-sm"},Ut={rowspan:"2"},Kt={class:"text-sm"},Yt={rowspan:"2"},It={class:"text-sm"},Ot={rowspan:"2"},Rt={class:"text-sm"},Ht={rowspan:"2"},Qt={class:"text-sm"},Wt={rowspan:"2"},Xt={class:"text-sm"},Zt={class:"sticky top-[60px] !z-[2]"},te={class:"text-sm"},ee={class:"text-sm"},se={class:"text-sm"},ae={class:"text-sm"},oe={class:"text-sm"},le={class:"text-sm"},ne={class:"text-sm"},re={class:"text-sm"},_e={class:"text-sm"},ue={ref:"to_move"},ie=["data-index"],ce={class:"w-full flex items-center justify-end"},be={__name:"rpt_salary",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(v){const m=v,{$moment:y}=nt(),{pointFormat:n}=A(),V={id:"",period_end:new Date},r=B({...V}),q=X("token"),b=B({}),_=B([]),K=async()=>{F().loading_full=!0,b.value={};const s=new FormData;s.append("period_end",r.value.period_end?y(r.value.period_end).format("Y-MM"):"");let l="post",d=r.value.id;d==""||(s.append("id",d),s.append("_method","PUT"));const{data:h,error:P,status:a}=await U("/rpt_salary",{method:l,headers:{Authorization:`Bearer ${q.value}`,Accept:"application/json"},body:s,retry:0});if(F().loading_full=!1,a.value==="error"){L().trigger(P,b);return}if(_.value=h.value.details,d<=0)r.value.id=h.value.id,r.value.created_at=h.value.created_at,r.value.updated_at=h.value.updated_at,m.p_data.unshift(r.value);else{r.value.updated_at=h.value.updated_at;let f=m.p_data.map(H=>H.id).indexOf(d);f>=-1&&m.p_data.splice(f,1,{...r.value})}};i(()=>{let s=0;return _.value.forEach(l=>{s+=parseFloat(l.standby_nominal)}),s});const g=i(()=>{let s=0;return _.value.forEach(l=>{s+=parseFloat(l.sb_gaji)}),s}),E=i(()=>{let s=0;return _.value.forEach(l=>{s+=parseFloat(l.sb_makan)}),s}),M=i(()=>{let s=0;return _.value.forEach(l=>{s+=parseFloat(l.sb_dinas)}),s}),w=i(()=>{let s=0;return _.value.forEach(l=>{s+=parseFloat(l.sb_gaji_2)}),s}),k=i(()=>{let s=0;return _.value.forEach(l=>{s+=parseFloat(l.sb_makan_2)}),s}),x=i(()=>{let s=0;return _.value.forEach(l=>{s+=parseFloat(l.sb_dinas_2)}),s}),C=i(()=>{let s=0;return _.value.forEach(l=>{s+=parseFloat(l.uj_gaji)}),s}),D=i(()=>{let s=0;return _.value.forEach(l=>{s+=parseFloat(l.uj_makan)}),s}),N=i(()=>{let s=0;return _.value.forEach(l=>{s+=parseFloat(l.uj_dinas)}),s}),Y=i(()=>{let s=0;return _.value.forEach(l=>{s+=parseFloat(l.employee_bpjs_kesehatan)}),s}),I=i(()=>{let s=0;return _.value.forEach(l=>{s+=parseFloat(l.employee_bpjs_jamsos)}),s}),$=i(()=>{let s=0;return _.value.forEach(l=>{s+=parseFloat(l.nominal_cut)}),s}),S=i(()=>{let s=0;return _.value.forEach(l=>{s+=parseFloat(l.salary_bonus_nominal)}),s}),O=i(()=>r.value.val&&r.value.val1||A().checkPermission("rpt_salary.val")&&r.value.val||A().checkPermission("rpt_salary.val1")&&r.value.val1),R=async()=>{F().loading_full=!0;const{data:s,error:l,status:d}=await U("/rpt_salary",{method:"get",headers:{Authorization:`Bearer ${q.value}`,Accept:"application/json"},params:{id:m.id},retry:0});if(F().loading_full=!1,d.value==="error"){L().trigger(l);return}r.value=s.value.data,m.is_copy&&(r.value.val=0,r.value.val1=0),_.value=s.value.data.details},G=i(()=>search.value!=""?_.value.filter(s=>s.employee.name.toLowerCase().includes(search.value.toLowerCase())):_.value);return Z(()=>m.show,(s,l)=>{s==!0&&(r.value={...V},_.value=[],b.value={},m.id!=0&&R())},{immediate:!0}),(s,l)=>{const d=Q,h=tt("vue-date-picker"),P=W;return z((c(),p("section",rt,[t("div",null,[T(d,{title:"Form Salary Paid",fn:v.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",_t,[t("div",ut,[t("div",it,[t("div",ct,[pt,e(r).id?(c(),p("div",dt,o(e(y)(e(r).period_end).format("MM-Y")),1)):(c(),p("div",mt,[T(P,null,{default:st(()=>[T(h,{modelValue:e(r).period_end,"onUpdate:modelValue":l[0]||(l[0]=a=>e(r).period_end=a),format:"MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"","month-picker":""},null,8,["modelValue"])]),_:1})])),t("p",ht,o(e(b).period_end),1)])]),e(_).length?(c(),p("div",ft,[vt,z(t("input",{class:"",type:"text","onUpdate:modelValue":l[1]||(l[1]=a=>s.search=a),name:"search",placeholder:"Nama"},null,512),[[at,s.search]])])):j("",!0),e(G).length?(c(),p("div",yt,[t("div",bt,[t("table",wt,[t("thead",null,[kt,t("tr",xt,[jt,Ft,gt,Et,Mt,Ct,Dt,Nt,St,Pt,Bt,Tt,t("th",At,[u("Standby 1 "),t("span",Vt,"("+o(e(n)(e(g)+e(E)+e(M)||0))+")",1)]),t("th",qt,[u("Standby 2 "),t("span",$t,"("+o(e(n)(e(w)+e(k)+e(x)||0))+")",1)]),t("th",Gt,[u("Trip "),t("span",zt,"("+o(e(n)(e(C)+e(D)+e(N)||0))+")",1)]),t("th",Jt,[u("Potongan "),t("span",Lt,"("+o(e(n)(e($)||0))+")",1)]),t("th",Ut,[u("U.Kerajinan "),t("span",Kt,"("+o(e(n)(e(S)||0))+")",1)]),t("th",Yt,[u("BPJS Kesehatan "),t("span",It,"("+o(e(n)(e(Y)||0))+")",1)]),t("th",Ot,[u("BPJS Jamsos "),t("span",Rt,"("+o(e(n)(e(I)||0))+")",1)]),t("th",Ht,[u("Grand Total "),t("span",Qt,"("+o(e(n)(e(g)+e(E)+e(M)+e(w)+e(k)+e(x)+e(C)+e(D)+e(N)-e($)+e(S)||0))+")",1)]),t("th",Wt,[u("Total Periode 2 "),t("span",Xt,"("+o(e(n)(e(w)+e(k)+e(x)+e(S)||0))+")",1)])]),t("tr",Zt,[t("th",null,[u("Gaji "),t("span",te,"("+o(e(n)(e(g)||0))+")",1)]),t("th",null,[u("Makan "),t("span",ee,"("+o(e(n)(e(E)||0))+")",1)]),t("th",null,[u("Dinas "),t("span",se,"("+o(e(n)(e(M)||0))+")",1)]),t("th",null,[u("Gaji "),t("span",ae,"("+o(e(n)(e(w)||0))+")",1)]),t("th",null,[u("Makan "),t("span",oe,"("+o(e(n)(e(k)||0))+")",1)]),t("th",null,[u("Dinas "),t("span",le,"("+o(e(n)(e(x)||0))+")",1)]),t("th",null,[u("Gaji "),t("span",ne,"("+o(e(n)(e(C)||0))+")",1)]),t("th",null,[u("Makan "),t("span",re,"("+o(e(n)(e(D)||0))+")",1)]),t("th",null,[u("Dinas "),t("span",_e,"("+o(e(n)(e(N)||0))+")",1)])])]),t("tbody",ue,[(c(!0),p(J,null,ot(e(G),(a,f)=>(c(),p(J,{key:f},[a.p_status!="Remove"?(c(),p("tr",{key:0,"data-index":f},[t("td",null,o(f+1)+".",1),t("td",null,o(a.employee_id),1),t("td",null,o(a.employee_name),1),t("td",null,o(a.employee_role),1),t("td",null,o(a.employee_birth_place),1),t("td",null,o(a.employee_birth_date?e(y)(a.employee_birth_date).format("DD-MM-Y"):""),1),t("td",null,o(a.employee_tmk?e(y)(a.employee_tmk).format("DD-MM-Y"):""),1),t("td",null,o(a.employee_ktp_no),1),t("td",null,o(a.employee_address),1),t("td",null,o(a.employee_status),1),t("td",null,o(a.employee_rek_no),1),t("td",null,o(a.employee_bank_name),1),t("td",null,o(e(n)(a.sb_gaji)),1),t("td",null,o(e(n)(a.sb_makan)),1),t("td",null,o(e(n)(a.sb_dinas)),1),t("td",null,o(e(n)(a.sb_gaji_2)),1),t("td",null,o(e(n)(a.sb_makan_2)),1),t("td",null,o(e(n)(a.sb_dinas_2)),1),t("td",null,o(e(n)(a.uj_gaji)),1),t("td",null,o(e(n)(a.uj_makan)),1),t("td",null,o(e(n)(a.uj_dinas)),1),t("td",null,o(e(n)(a.nominal_cut)),1),t("td",null,o(e(n)(a.employee_bpjs_kesehatan)),1),t("td",null,o(e(n)(a.employee_bpjs_jamsos)),1),t("td",null,o(e(n)(a.salary_bonus_nominal)),1),t("td",null,o(e(n)(parseFloat(a.sb_gaji)+parseFloat(a.sb_makan)+parseFloat(a.sb_dinas)+parseFloat(a.sb_gaji_2)+parseFloat(a.sb_makan_2)+parseFloat(a.sb_dinas_2)+parseFloat(a.uj_gaji)+parseFloat(a.uj_makan)+parseFloat(a.uj_dinas)-parseFloat(a.nominal_cut)+parseFloat(a.salary_bonus_nominal))),1),t("td",null,o(e(n)(parseFloat(a.sb_gaji_2)+parseFloat(a.sb_makan_2)+parseFloat(a.sb_dinas_2)+parseFloat(a.salary_bonus_nominal))),1)],8,ie)):j("",!0)],64))),128))],512)])])])):j("",!0)]),t("div",ce,[t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:l[2]||(l[2]=a=>v.fnClose())}," Cancel "),e(O)?j("",!0):(c(),p("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:l[3]||(l[3]=lt(a=>K(),["prevent"]))}," Generate "+o(e(r).id==""?"& Save":""),1))])])])],512)),[[et,v.show]])}}};export{be as default};
