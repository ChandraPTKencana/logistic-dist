import Ce from"./Header.4e772c53.js";import Se from"./Copy.86663f63.js";import Ae from"./Plus.5f9f548a.js";import Te from"./Edit.ea302e18.js";import Pe from"./Eyes.35017366.js";import Me from"./Delete.d295b312.js";import Oe from"./Signature.28edaa90.js";import Ie from"./Line.2e76aa10.js";import Ne from"./Check.2743db0b.js";import Be from"./TypeIcon.7f39c03c.js";import Fe from"./TableView.5c67115d.js";import{_ as Ee}from"./PopupMini.vue.393adbce.js";import je from"./employee.5d9884e1.js";import ze from"./employee_validasi.4cb9a180.js";import{r as s,j as Z,f as Ve,g as He,G as h,h as Re,i as Q,s as Le,c as b,a as i,b as r,m as W,q as Ue,k as o,n as X,l as x,w,F as Ye,z as Je,A as m,B as V,o as u,D as O,d as H,t as ee,v as Ke,p as qe,e as Ge}from"./entry.5c8858ab.js";import{u as R}from"./useMyFetch.f6def584.js";import{u as v}from"./useUtils.146c08c5.js";import{_ as Ze}from"./_plugin-vue_export-helper.c27b6911.js";import"./DocJPEG.185e793b.js";import"./DocJPG.0b2a1c55.js";import"./DocPNG.d2eb3c88.js";import"./DocPDF.f75c87f8.js";import"./Search.f8b4b87f.js";import"./Adjust.95402bc3.js";import"./TableHeaderEye.a667e97b.js";import"./Times.dfbe592b.js";import"./ClearAll.4b5dad98.js";import"./client-only.96445a07.js";import"./ClearEach.fa1e0c0a.js";import"./CaretLeftDoubleBold.cde34a6e.js";import"./CaretLeftBold.3e31e5ba.js";import"./CaretRightBold.e3ea3c76.js";import"./CaretRightDoubleBold.a7d0e32e.js";import"./Exclamation.87de8664.js";import"./HeaderPopup.vue.9016828c.js";import"./AttachmentSingle.ffdc8a9e.js";import"./PDFJsView.48c17618.js";const I=S=>(qe("data-v-5b856773"),S=S(),Ge(),S),Qe={class:"w-full h-full flex flex-col"},We={class:"w-full flex grow flex-col overflow-auto h-0"},Xe={class:"w-full flex justify-between flex-wrap"},et={class:"grow flex"},tt={class:"m-1"},lt=I(()=>i("option",{value:"available"},"Available",-1)),at=I(()=>i("option",{value:"unapprove"},"Unapprove",-1)),ot=I(()=>i("option",{value:"deleted"},"Trash",-1)),nt=I(()=>i("option",{value:"all"},"All",-1)),st=[lt,at,ot,nt],rt={class:"grow mb-5"},it={__name:"index",async setup(S){let A,L;const te=t=>t.deleted==1?"!bg-red-400":t.val==0||t.val1==0?"!bg-gray-300":"",p=s("available");Z(()=>p.value,t=>{J()},{immediate:!1});const d={};d._TimeZoneOffset=new Date().getTimezoneOffset();const N=Ve("token"),{data:n}=([A,L]=He(async()=>Je(async()=>{m().loading_full=!0;const{data:t,error:e,status:y}=await R("/employees",{method:"get",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},params:{filter_status:p},retry:0});return m().loading_full=!1,y.value==="error"?(V().trigger(e),[]):t.value.data},"$p5jj5crAgd")),A=await A,L(),A),B=s({field:"",by:"desc"}),a=s(-1),_=s({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),c=h(()=>n.value[a.value]),le=()=>{d.like="";let t=JSON.parse(JSON.stringify(m()._tv.global_keyword));t!=""&&(d.like=`id:%${t}%,name:%${t}%,ktp_no:%${t}%,sim_no:%${t}%,phone_number:%${t}%,rek_no:%${t}%`),d.sort="",B.value.field&&(d.sort=B.value.field+":"+B.value.by),d.filter_model=JSON.stringify(m()._tv.filter_model)},U=s(null),Y=async()=>{m().loading_full=!0,_.value.may_get_data=!1,d.page=_.value.page,d.page==1&&(n.value=[]),d.filter_status=p.value;const{data:t,error:e,status:y}=await R("/employees",{method:"get",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},params:d,retry:0});if(m().loading_full=!1,_.value.may_get_data=!0,y.value==="error"){V().trigger(e);return}_.value.page==1?(n.value=t.value.data,U.value&&(U.value.scrollTop=0)):_.value.page>1&&(n.value=[...n.value,...t.value.data]),t.value.data.length==0&&(_.value.is_last_record=!0),m()._tv.filter_box=!1},J=()=>{_.value.page=1,_.value.is_last_record=!1,le(),Y()};Re();const k=s(!1),T=s(0),F=s(0),P=s(!1),ae=()=>{T.value=0,k.value=!0,F.value=!1,k.value=!0},{display:D}=Q();Le(Q());const oe=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(T.value=n.value[a.value].id,P.value=!1,F.value=!1,k.value=!0)},ne=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(T.value=n.value[a.value].id,P.value=!1,F.value=!0,k.value=!0)},M=s(!1),E=s(0),se=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(E.value=n.value[a.value].id,P.value=!1,M.value=!0)},re=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(E.value=n.value[a.value].id,P.value=!0,M.value=!0)},j=s(!1),K=s({}),$=s(!1),g=s(""),ie=async()=>{$.value&&($.value=!1)},ue=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(g.value="",K.value={id:n.value[a.value].id},$.value=!0)};Z(()=>g.value,t=>{t.trim().length>0?j.value=!0:j.value=!1},{immediate:!1});const de=async()=>{m().loading_full=!0;const t=new FormData;t.append("id",n.value[a.value].id),t.append("deleted_reason",g.value),t.append("_method","DELETE");const{data:e,error:y,status:z}=await R("/employee",{method:"post",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},body:t,retry:0});if(m().loading_full=!1,z.value==="error"){V().trigger(y);return}let f={...n.value[a.value]};f.deleted=e.value.deleted,f.deleted_user=e.value.deleted_user,f.deleted_at=e.value.deleted_at,f.deleted_by=e.value.deleted_by,f.deleted_reason=e.value.deleted_reason,p.value!="all"?n.value.splice(a.value,1):n.value.splice(a.value,1,{...f}),a.value=-1,$.value=!1},_e=s([{key:"no",label:"No",isai:!0},{key:"val",label:"App 1",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"id",label:"ID",freeze:1,filter_on:1,type:"number"},{key:"name",label:"Nama",freeze:1,freeze_left:"44px",filter_on:1,type:"string",sort:{priority:1,type:"asc"}},{key:"role",label:"Jabatan",filter_on:1,type:"string"},{key:"ktp_no",label:"No KTP",filter_on:1,type:"string"},{key:"sim_no",label:"No SIM",filter_on:1,type:"string"},{key:"bank_code",label:"Nama Bank",filter_on:1,type:"string"},{key:"rek_no",label:"No Rek",filter_on:1,type:"string"},{key:"rek_name",label:"Nama Rek",filter_on:1,type:"string"},{key:"phone_number",label:"No Tlp",filter_on:1,type:"string"},{key:"birth_place",label:"Tempat Lahir",filter_on:1,type:"string"},{key:"birth_date",label:"Tanggal Lahir",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"tmk",label:"TMK",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"address",label:"Alamat",filter_on:1,type:"string"},{key:"status",label:"Status",filter_on:1,type:"string"},{key:"attachment_1_type",label:"File",type:"string"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]),me=h(()=>a.value>-1&&[void 0,0].indexOf(c.value.deleted)>-1&&v().checkPermission("employee.create")),pe=h(()=>["available","all","unapprove"].indexOf(p.value)>-1&&v().checkPermission("employee.create")),ce=h(()=>a.value>-1&&[void 0,0].indexOf(c.value.deleted)>-1&&(v().checkPermission("employee.val")&&[void 0,0].indexOf(c.value.val)>-1||v().checkPermission("employee.val1")&&[void 0,0].indexOf(c.value.val1)>-1)&&v().checkPermissions(["employee.modify","employee.detail.modify","employee.detail2.modify"])),fe=h(()=>a.value>-1&&[void 0,0].indexOf(c.value.deleted)>-1&&(v().checkPermission("employee.val")&&[void 0,0].indexOf(c.value.val)>-1||v().checkPermission("employee.val1")&&[void 0,0].indexOf(c.value.val1)>-1)),ve=h(()=>a.value>-1&&v().checkPermission("employee.remove")&&[void 0,0].indexOf(c.value.deleted)>-1);return(t,e)=>{const y=Ce,z=Se,f=Ae,ye=Te,be=Pe,ke=Me,ge=Oe,q=Ie,G=Ne,he=Be,xe=Fe,we=Ee,De=je,$e=ze;return u(),b(Ye,null,[i("div",Qe,[r(y,{title:"List Employee"}),i("div",We,[i("div",Xe,[i("div",et,[i("div",tt,[W(i("select",{class:"","onUpdate:modelValue":e[0]||(e[0]=l=>X(p)?p.value=l:null)},st,512),[[Ue,o(p)]])]),o(me)?(u(),b("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[1]||(e[1]=l=>ne())},[r(z)])):x("",!0),o(pe)?(u(),b("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[2]||(e[2]=l=>ae())},[r(f)])):x("",!0),o(ce)?(u(),b("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[3]||(e[3]=l=>oe())},[r(ye)])):x("",!0),o(a)>-1?(u(),b("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[4]||(e[4]=l=>re())},[r(be)])):x("",!0),o(ve)?(u(),b("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[5]||(e[5]=l=>ue())},[r(ke)])):x("",!0),o(fe)?(u(),b("button",{key:5,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[6]||(e[6]=l=>se())},[r(ge)])):x("",!0)])]),r(xe,{thead:o(_e),selected:o(a),onSetSelected:e[7]||(e[7]=l=>a.value=l),tbody:o(n),fnCallData:Y,scrolling:o(_),onSetScrollingPage:e[8]||(e[8]=l=>o(_).page=l),onDoFilter:e[9]||(e[9]=l=>J()),rowBgColor:te},{val:w(({item:l})=>[l.val?(u(),O(G,{key:1})):(u(),O(q,{key:0}))]),val1:w(({item:l})=>[l.val1?(u(),O(G,{key:1})):(u(),O(q,{key:0}))]),bank_code:w(({item:l})=>{var C;return[H(ee((C=l.bank)==null?void 0:C.code),1)]}),attachment_1_type:w(({item:l})=>[r(he,{value:l.attachment_1_type},null,8,["value"])]),deleted_by_username:w(({item:l})=>{var C;return[H(ee((C=l.deleted_by)==null?void 0:C.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])])]),r(we,{type:"delete",show:o($),data:o(K),fnClose:ie,fnConfirm:de,enabledOk:o(j)},{footer:w(()=>[H(" Masukkan Alasan Penghapusan: "),i("div",rt,[W(i("textarea",{"onUpdate:modelValue":e[10]||(e[10]=l=>X(g)?g.value=l:null)},null,512),[[Ke,o(g)]])])]),_:1},8,["show","data","enabledOk"]),r(De,{show:o(k),fnClose:()=>{k.value=!1},id:o(T),p_data:o(n)},null,8,["show","fnClose","id","p_data"]),r($e,{show:o(M),fnClose:()=>{M.value=!1},id:o(E),p_data:o(n)},null,8,["show","fnClose","id","p_data"])],64)}}},Jt=Ze(it,[["__scopeId","data-v-5b856773"]]);export{Jt as default};
