import ue from"./Header.3b7de3c0.js";import ce from"./Copy.3099fe52.js";import de from"./Plus.0e8db38d.js";import _e from"./Edit.a3f584b7.js";import me from"./Delete.57ec22b4.js";import pe from"./Signature.c40dfa32.js";import fe from"./Search.0fbb0fe2.js";import ve from"./Line.2062a520.js";import he from"./Check.97a7a142.js";import ye from"./mst.1fc5e6f2.js";import{f as ge,g as ke,r as a,h as be,i as z,s as xe,j as we,c as d,b as p,a as e,k as l,l as g,m as A,v as De,n as Ce,q as V,x as Se,F as $e,y as Pe,z as Ue,o as i,C as Ae,D as C,t as _,H as Te,E as Me,A as S,B as R}from"./entry.90f7e7d0.js";import{u as v}from"./useUtils.607571cd.js";import{u as O}from"./useMyFetch.ffe077f5.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./HeaderPopup.vue.2b313006.js";import"./Times.e420182d.js";import"./WidthMiniList.vue.0dd6a9cb.js";import"./WidthMiniPart.vue.f91cecf8.js";import"./InputPointFormat.vue.dade0de4.js";import"./part.ec5d10ec.js";import"./Calculator.ec79ed3f.js";import"./trx.34746a1c.js";const je={class:"w-full h-full flex flex-col"},Ie={class:"w-full flex grow flex-col overflow-auto h-0"},Ne={class:"w-full flex"},Fe={action:"#",class:"w-full flex p-1"},He={class:"grow"},Be=e("div",{class:"font-bold"}," Keyword ",-1),Le={class:"pl-1"},ze=e("div",{class:"font-bold"}," Sort By ",-1),Ve=Te('<option value=""></option><option value="id">ID</option><option value="xto">To</option><option value="jenis">Jenis</option><option value="tipe">Tipe</option>',5),Re=[Ve],Oe={class:"pl-1"},Ee=e("div",{class:"font-bold"}," Sort Order ",-1),Je=e("option",{value:"asc"},"Asc",-1),Ke=e("option",{value:"desc"},"Desc",-1),Ye=[Je,Ke],qe={class:"flex items-end pl-1"},Ze={class:"w-full flex justify-center items-center grow h-0 p-1"},Ge={key:0,class:""},Qe={class:"tacky"},We=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"App 2"),e("th",null,"ID"),e("th",null,"Nama Pekerja"),e("th",null,"No Pol"),e("th",null,"Kejadian"),e("th",null,"Nominal"),e("th",null,"Nominal Potongan"),e("th",null,"Sisa Potongan"),e("th",null,"Status"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),Xe=["onClick"],et={class:"flex items-center justify-center"},tt={class:"flex items-center justify-center"},ot={class:"bold"},$t={__name:"index",async setup(st){let k,T;const{$moment:M}=Me(),{pointFormat:$}=v(),n={};n._TimeZoneOffset=new Date().getTimezoneOffset(),n.sort="created_at:desc";const j=ge("token"),{data:E}=([k,T]=ke(async()=>Ue(async()=>{let t=[];S().loading_full=!0;const{data:s,error:y,status:P}=await O("/potongan_msts",{method:"get",headers:{Authorization:`Bearer ${j.value}`,Accept:"application/json"},params:n,retry:0});return S().loading_full=!1,P.value==="error"?(R().trigger(y),{potongan_msts:t}):(t=s.value.data,{potongan_msts:t})},"$4H5grU4zhJ")),k=await k,T(),k),u=a(E.value.potongan_msts),m=a(""),f=a({field:"created_at",by:"desc"}),c=a(-1),r=a({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),J=()=>{n.like="",m.value!=""&&(n.like=`id:%${m.value}%,employee_name:%${m.value}%,no_pol:%${m.value}%,info:%${m.value}%,status:%${m.value}%`),n.sort="",f.value.field&&(n.sort=f.value.field+":"+f.value.by)},b=a(null),I=async()=>{S().loading_full=!0,r.value.may_get_data=!1,n.page=r.value.page,n.page==1&&(u.value=[]),n.first_row&&delete n.first_row,n.page>1&&(n.first_row=JSON.stringify(u.value[0]));const{data:t,error:s,status:y}=await O("/potongan_msts",{method:"get",headers:{Authorization:`Bearer ${j.value}`,Accept:"application/json"},params:n,retry:0});if(S().loading_full=!1,r.value.may_get_data=!0,y.value==="error"){R().trigger(s);return}r.value.page==1?(u.value=t.value.data,b.value&&(b.value.scrollTop=0)):r.value.page>1&&(u.value=[...u.value,...t.value.data]),t.value.data.length==0&&(r.value.is_last_record=!0)},K=async()=>{if(!r.value.may_get_data)return;let t=b.value;if(t.scrollLeft!=r.value.scrollLeft){r.value.scrollLeft=t.scrollLeft;return}r.value.is_last_record||!(Math.round(t.scrollTop)+t.clientHeight>=t.scrollHeight-1)||(r.value.page++,await I())},Y=()=>{r.value.page=1,r.value.is_last_record=!1,J(),I()};be();const h=a(!1),x=a(0),w=a(0),q=()=>{x.value=0,h.value=!0,w.value=!1},{display:D}=z();xe(z());const Z=()=>{c.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(x.value=u.value[c.value].id,h.value=!0,w.value=!1)},G=()=>{c.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(x.value=u.value[c.value].id,h.value=!0,w.value=!0)},Q=a(!1),W=a(0),X=()=>{c.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(W.value=u.value[c.value].id,Q.value=!0)},N=a(!1),ee=a({}),te=a(!1),F=a(""),oe=()=>{c.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value="",ee.value={id:u.value[c.value].id},te.value=!0)};return we(()=>F.value,t=>{t.trim().length>0?N.value=!0:N.value=!1},{immediate:!1}),(t,s)=>{const y=ue,P=ce,se=de,le=_e,ae=me,ne=pe,ie=fe,H=ve,B=he,re=ye;return i(),d("div",je,[p(y,{title:"List Potongan"}),e("div",Ie,[e("div",Ne,[("useUtils"in t?t.useUtils:l(v))().checkPermission("potongan_mst.create")?(i(),d("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[0]||(s[0]=o=>G())},[p(P)])):g("",!0),("useUtils"in t?t.useUtils:l(v))().checkPermission("potongan_mst.create")?(i(),d("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[1]||(s[1]=o=>q())},[p(se)])):g("",!0),("useUtils"in t?t.useUtils:l(v))().checkPermissions(["potongan_mst.modify","potongan_trx.create","potongan_trx.modify","potongan_trx.remove"])?(i(),d("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[2]||(s[2]=o=>Z())},[p(le)])):g("",!0),("useUtils"in t?t.useUtils:l(v))().checkPermission("potongan_mst.remove")?(i(),d("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[3]||(s[3]=o=>oe())},[p(ae)])):g("",!0),("useUtils"in t?t.useUtils:l(v))().checkPermissions(["potongan_mst.val","potongan_mst.val1","potongan_trx.val","potongan_trx.val1"])?(i(),d("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[4]||(s[4]=o=>X())},[p(ne)])):g("",!0)]),e("form",Fe,[e("div",He,[Be,A(e("input",{class:"",type:"text","onUpdate:modelValue":s[5]||(s[5]=o=>Ce(m)?m.value=o:null),name:"search",placeholder:"Keyword"},null,512),[[De,l(m)]])]),e("div",Le,[ze,A(e("select",{class:"","onUpdate:modelValue":s[6]||(s[6]=o=>l(f).field=o)},Re,512),[[V,l(f).field]])]),e("div",Oe,[Ee,A(e("select",{class:"","onUpdate:modelValue":s[7]||(s[7]=o=>l(f).by=o)},Ye,512),[[V,l(f).by]])]),e("div",qe,[e("button",{class:"",type:"submit",name:"button",onClick:s[8]||(s[8]=Se(o=>Y(),["prevent"]))},[p(ie,{class:"text-2xl"})])])]),e("div",Ze,[l(u).length==0?(i(),d("div",Ge," Maaf Tidak Ada Record ")):(i(),d("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:K},[e("table",Qe,[We,e("tbody",null,[(i(!0),d($e,null,Pe(l(u),(o,U)=>{var L;return i(),d("tr",{key:U,onClick:lt=>c.value=U,class:Ae(l(c)==U?"active":"")},[e("td",null,[e("div",et,[o.val?(i(),C(B,{key:1})):(i(),C(H,{key:0}))])]),e("td",null,[e("div",tt,[o.val1?(i(),C(B,{key:1})):(i(),C(H,{key:0}))])]),e("td",ot,_(o.id),1),e("td",null,_((L=o.employee)==null?void 0:L.name),1),e("td",null,_(o.no_pol),1),e("td",null,_(o.kejadian),1),e("td",null,_(l($)(o.nominal)),1),e("td",null,_(l($)(o.nominal_cut)),1),e("td",null,_(l($)(o.remaining_cut)),1),e("td",null,_(o.status),1),e("td",null,_(o.created_at?l(M)(o.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,_(o.updated_at?l(M)(o.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,Xe)}),128))])])],544))])]),p(re,{show:l(h),fnClose:()=>{h.value=!1},id:l(x),p_data:l(u),is_copy:l(w)},null,8,["show","fnClose","id","p_data","is_copy"])])}}};export{$t as default};
