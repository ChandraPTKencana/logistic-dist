import{_ as le}from"./HeaderPopup.vue.92a07f81.js";import{_ as se}from"./WidthMiniPart.vue.a7c21609.js";import oe from"./AttachmentSingle.7d7c933f.js";import ie from"./Times.221fc2d9.js";import ne from"./Check.69ba9e8c.js";import re from"./CaretTop.f159748e.js";import _e from"./CaretDown.f99be54d.js";import{r as h,g as de,Q as ve,i as Q,f as ce,k as ue,K as pe,o as r,c as v,a as e,b as D,t as o,l as a,F as X,D as fe,E as Z,z as T,n as u,C as H,d as ee,G as me,x as S,y as O,p as we,e as xe}from"./entry.4ff6eaba.js";import{u as C}from"./useUtils.8344b409.js";import{u as R}from"./useMyFetch.d6de1011.js";import{_ as be}from"./_plugin-vue_export-helper.c27b6911.js";import"./PDFJsView.fb953c8a.js";const _=p=>(we("data-v-87ef3ee9"),p=p(),xe(),p),he={class:"box-fixed"},ye={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},ke={class:"w-full flex flex-col items-center grow overflow-auto"},ge={class:"w-full flex flex-row flex-wrap"},De={class:"w-full sm:w-9/12 flex px-2 py-3"},Se={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},Ye=_(()=>e("div",{class:"absolute bg-white -top-3"}," Standby ",-1)),Ce={class:"w-6/12 sm:w-2/12 flex flex-col flex-wrap p-1"},Ne=_(()=>e("label",{for:""},"ID",-1)),Ie={class:"card-border"},Pe={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},$e=_(()=>e("label",{for:""},"Name",-1)),Ae={class:"card-border"},Me={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Te=_(()=>e("label",{for:""},"Type",-1)),He={class:"card-border"},Ue={class:"w-6/12 sm:w-2/12 flex flex-col flex-wrap p-1"},Fe=_(()=>e("label",{for:""},"Amount",-1)),Le={class:"card-border"},Be={class:"w-full sm:w-3/12 flex px-2 py-3"},Ve={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative items-end"},je=_(()=>e("div",{class:"absolute bg-white -top-3"}," Peralihan ",-1)),Ee={class:"w-6/12 flex flex-col flex-wrap p-1"},Oe={class:"card-border"},Re={class:"w-6/12 flex flex-col flex-wrap p-1"},ze={class:"card-border"},qe={class:"w-full flex flex-wrap"},Ge={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Je=_(()=>e("label",{for:""},"Supir",-1)),Ke={class:"card-border"},We={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Qe=_(()=>e("label",{for:""},"Kernet",-1)),Xe={class:"card-border"},Ze={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},et=_(()=>e("label",{for:""},"No Pol",-1)),tt={class:"card-border"},at={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},lt=_(()=>e("label",{for:""},"Tujuan",-1)),st={class:"card-border"},ot={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},it=_(()=>e("label",{for:""},"Note For Remarks",-1)),nt={class:"card-border"},rt={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},_t=_(()=>e("label",{for:""},"Trx Trp ID#",-1)),dt={class:"card-border"},vt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},ct={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},ut=_(()=>e("div",{class:"absolute bg-white -top-3"}," Cost Center ",-1)),pt={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},ft=_(()=>e("label",{for:""}," Code",-1)),mt={class:"card-border"},wt={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},xt=_(()=>e("label",{for:""},"Desc",-1)),bt={class:"card-border disabled"},ht={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},yt={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},kt=_(()=>e("div",{class:"absolute bg-white -top-3"}," PVR ",-1)),gt={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},Dt=_(()=>e("label",{for:""},"No",-1)),St={class:"card-border disabled"},Yt={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Ct=_(()=>e("label",{for:""},"Total",-1)),Nt={class:"card-border disabled"},It={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},Pt={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},$t=_(()=>e("div",{class:"absolute bg-white -top-3"}," PV ",-1)),At={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},Mt=_(()=>e("label",{for:""},"No",-1)),Tt={class:"card-border disabled"},Ht={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Ut=_(()=>e("label",{for:""},"Total",-1)),Ft={class:"card-border disabled"},Lt={class:"w-full flex grow p-1 overflow-auto 2xl:overflow-hidden justify-between flex-wrap"},Bt={class:"w-full",role:"sticky"},Vt={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},jt={class:"sticky -top-1 !z-[2]"},Et=["colspan"],Ot=_(()=>e("tr",{class:"sticky top-7 !z-[2]"},[e("th",{class:"!min-w-[50px] !w-[50px] !max-w-[50px]"},"No"),e("th",{class:"!min-w-[90px] !w-[90px] !max-w-[90px]"},"Tanggal"),e("th",{class:"!min-w-[55px] !w-[55px] !max-w-[55px]"},"Waktu"),e("th",{class:"!min-w-[200px] !w-[200px] !max-w-[200px]"},"Foto"),e("th",{class:"!min-w-[200px] !w-[200px] !max-w-[200px]"},"Note"),e("th",{class:"!min-w-[70px] !w-[70px] !max-w-[70px]"},"Dibayar")],-1)),Rt={ref:"to_move"},zt=["data-index"],qt={class:"cell"},Gt={class:"w-full h-auto flex items-center justify-center relative"},Jt={class:"cell"},Kt={class:"w-full h-auto flex items-center justify-center relative"},Wt={class:"cell"},Qt={style:{width:"60vw"},class:"h-auto flex items-center justify-center"},Xt={class:"cell"},Zt={class:"h-auto flex items-center justify-center"},ea={class:"w-full h-auto flex items-center justify-center"},ta={key:0,class:"text-3xl"},aa=["onClick"],la={class:"w-full flex items-center justify-end"},sa={class:"w-full flex flex-wrap p-3 items-center"},oa=_(()=>e("div",null," Di Validasi oleh : ",-1)),ia={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},na={key:0},ra={key:1},_a={key:2},da={key:3},va={key:4},ca={key:5},ua={key:0,class:"text-xs font-bold"},pa={key:0,class:"text-xs font-bold"},fa={__name:"standby_trx_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},it_state:{type:Number,required:!1,default:-1}},emits:["setID","setIndex"],setup(p,{emit:N}){const c=p,{$moment:y}=me(),{pointFormat:U}=C(),z={id:-1,transition_target:"",transition_type:"",standby_mst_id:"",standby_mst_:{name:"",tipe:"",amount:0},supir:"",kernet:"",no_pol:"",xto:"",note_for_remarks:"",trx_trp_id:"",cost_center_code:"",cost_center_desc:"",pvr_id:"",pvr_no:"",pvr_total:0,pvr_had_detail:0,pv_id:"",pv_no:"",pv_total:0,pv_datetime:"",rv_id:"",rv_no:"",rv_total:0,rv_had_detail:"",details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:"",val3:0,val3_by:{username:""},val3_at:"",val4:0,val4_by:{username:""},val4_at:"",val5:0,val5_by:{username:""},val5_at:""},t=h({...z}),F=de("token"),I=h({}),q=h(null),te=h(null),P=h([]),G={_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:-1,name:"",title:""};let L=s=>{s.key=="ArrowUp"&&K(),s.key=="ArrowDown"&&J()};ve(()=>{document.removeEventListener("keydown",L)});const x=h(JSON.parse(JSON.stringify(G))),b=h(JSON.parse(JSON.stringify(G))),m=h(""),B=async s=>{m.value="PROSES...",S().loading_full=!0,I.value={};const i=new FormData;let f=[...P.value];s=="paid"?f=f.map((w,A)=>(w.be_paid=1,w)):s=="nopaid"&&(f=f.map((w,A)=>(w.be_paid=0,w))),i.append("details",JSON.stringify(f));let l="post",g=c.id;g==0||(i.append("id",g),i.append("_method","PUT"));const{data:n,error:k,status:Y}=await R("/standby_trx_validasi",{method:l,headers:{Authorization:`Bearer ${F.value}`,Accept:"application/json"},body:i,retry:0});if(S().loading_full=!1,Y.value==="error"){m.value="GAGAL",O().trigger(k,I);return}t.value.val=n.value.val,t.value.val_user=n.value.val_user,t.value.val_by=n.value.val_by,t.value.val_at=n.value.val_at,t.value.val1=n.value.val1,t.value.val1_user=n.value.val1_user,t.value.val1_by=n.value.val1_by,t.value.val1_at=n.value.val1_at,t.value.val2=n.value.val2,t.value.val2_user=n.value.val2_user,t.value.val2_by=n.value.val2_by,t.value.val2_at=n.value.val2_at,t.value.val3=n.value.val3,t.value.val3_user=n.value.val3_user,t.value.val3_by=n.value.val3_by,t.value.val3_at=n.value.val3_at,t.value.val4=n.value.val4,t.value.val4_user=n.value.val4_user,t.value.val4_by=n.value.val4_by,t.value.val4_at=n.value.val4_at,t.value.val5=n.value.val5,t.value.val5_user=n.value.val5_user,t.value.val5_by=n.value.val5_by,t.value.val5_at=n.value.val5_at;let $=c.p_data.map(w=>w.id).indexOf(c.id);$>=-1&&c.p_data.splice($,1,{...t.value}),m.value="BERHASIL"},ae=async()=>{m.value="PROSES...",S().loading_full=!0,I.value={};const s=new FormData;let i="post",f=c.id;f==0||(s.append("id",f),s.append("_method","PUT"));const{data:l,error:g,status:n}=await R("/standby_trx_unvalidasi",{method:i,headers:{Authorization:`Bearer ${F.value}`,Accept:"application/json"},body:s,retry:0});if(S().loading_full=!1,n.value==="error"){m.value="GAGAL",O().trigger(g,I);return}t.value.val=l.value.val,t.value.val_user=l.value.val_user,t.value.val_by=l.value.val_by,t.value.val_at=l.value.val_at,t.value.val1=l.value.val1,t.value.val1_user=l.value.val1_user,t.value.val1_by=l.value.val1_by,t.value.val1_at=l.value.val1_at,t.value.val2=l.value.val2,t.value.val2_user=l.value.val2_user,t.value.val2_by=l.value.val2_by,t.value.val2_at=l.value.val2_at,t.value.val3=l.value.val3,t.value.val3_user=l.value.val3_user,t.value.val3_by=l.value.val3_by,t.value.val3_at=l.value.val3_at,t.value.val4=l.value.val4,t.value.val4_user=l.value.val4_user,t.value.val4_by=l.value.val4_by,t.value.val4_at=l.value.val4_at,t.value.val5=l.value.val5,t.value.val5_user=l.value.val5_user,t.value.val5_by=l.value.val5_by,t.value.val5_at=l.value.val5_at;let k=c.p_data.map(Y=>Y.id).indexOf(c.id);k>=-1&&c.p_data.splice(k,1,{...t.value}),m.value="BERHASIL"},V=async()=>{m.value="",S().loading_full=!0;const{data:s,error:i,status:f}=await R("/standby_trx",{method:"get",headers:{Authorization:`Bearer ${F.value}`,Accept:"application/json"},params:{id:c.id},retry:0});if(S().loading_full=!1,f.value==="error"){O().trigger(i);return}let l=s.value.data;t.value=l,x.value._.id.val=l.supir_id,x.value._.name.val=l.supir,x.value._.rek_no.val=l.supir_rek_no,x.value._.rek_name.val=l.supir_rek_name,x.value.id=l.supir_id,x.value.name=l.supir,x.value.rek_no=(l.supir_rek_no||"")+" "+(l.supir_rek_name||""),b.value._.id.val=l.kernet_id,b.value._.name.val=l.kernet,b.value._.rek_no.val=l.kernet_rek_no,b.value._.rek_name.val=l.kernet_rek_name,b.value.id=l.kernet_id,b.value.name=l.kernet,b.value.rek_no=(l.kernet_rek_no||"")+" "+(l.kernet_rek_name||""),P.value=s.value.data.details};Q(()=>{let s=0;return P.value.forEach(i=>{i.p_status!="Remove"&&(s+=i.amount)}),s});const j=Q(()=>t.value.val5==1);ce(()=>c.show,(s,i)=>{s==!0?(document.addEventListener("keydown",L),t.value={...z},c.is_view==!1&&setTimeout(()=>{q.value.focus()},1),V()):document.removeEventListener("keydown",L)},{immediate:!0});const J=()=>{let s=c.p_data.map(i=>i.id).indexOf(c.id);s!=c.p_data.length-1&&(s++,N("setID",c.p_data[s].id),N("setIndex",s),setTimeout(()=>{V()},100))},K=()=>{let s=c.p_data.map(i=>i.id).indexOf(c.id);s!=0&&(s--,N("setID",c.p_data[s].id),N("setIndex",s),setTimeout(()=>{V()},100))};return(s,i)=>{var w,A,W;const f=le,l=se,g=oe,n=ie,k=ne,Y=re,$=_e;return ue((r(),v("section",he,[e("div",null,[D(f,{title:"Form Transaction Standby Validation",fn:p.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",ye,[e("div",ke,[e("div",ge,[e("div",De,[e("div",Se,[Ye,e("div",Ce,[Ne,e("div",Ie,o(a(t).standby_mst_id),1)]),e("div",Pe,[$e,e("div",Ae,o((w=a(t).standby_mst_)==null?void 0:w.name),1)]),e("div",Me,[Te,e("div",He,o((A=a(t).standby_mst_)==null?void 0:A.tipe),1)]),e("div",Ue,[Fe,e("div",Le,o(a(U)((W=a(t).standby_mst_)==null?void 0:W.amount)),1)])])]),e("div",Be,[e("div",Ve,[je,e("div",Ee,[e("div",Oe,o(a(t).transition_type),1)]),e("div",Re,[e("div",ze,o(a(t).transition_target),1)])])]),e("div",qe,[e("div",Ge,[Je,e("div",Ke,[D(l,{selected:a(x)},null,8,["selected"])])]),e("div",We,[Qe,e("div",Xe,[D(l,{selected:a(b)},null,8,["selected"])])]),e("div",Ze,[et,e("div",tt,o(a(t).no_pol),1)]),e("div",at,[lt,e("div",st,o(a(t).xto),1)]),e("div",ot,[it,e("div",nt,o(a(t).note_for_remarks),1)]),e("div",rt,[_t,e("div",dt,o(a(t).trx_trp_id),1)])]),e("div",vt,[e("div",ct,[ut,e("div",pt,[ft,e("div",mt,o(a(t).cost_center_code),1)]),e("div",wt,[xt,e("div",bt,o(a(t).cost_center_desc),1)])])]),e("div",ht,[e("div",yt,[kt,e("div",gt,[Dt,e("div",St,o(a(t).pvr_no),1)]),e("div",Yt,[Ct,e("div",Nt,o(a(U)(a(t).pvr_total||0)),1)])])]),e("div",It,[e("div",Pt,[$t,e("div",At,[Mt,e("div",Tt,o(a(t).pv_no),1)]),e("div",Ht,[Ut,e("div",Ft,o(a(U)(a(t).pv_total)),1)])])]),e("div",Lt,[e("div",Bt,[e("table",Vt,[e("thead",null,[e("tr",jt,[e("td",{colspan:a(j)?6:7,class:"!bg-slate-800 text-white font-bold"}," Detail Transaction ",8,Et)]),Ot]),e("tbody",Rt,[(r(!0),v(X,null,fe(a(P),(d,E)=>(r(),v(X,{key:E},[d.p_status!="Remove"?(r(),v("tr",{key:0,"data-index":E},[e("td",null,o(E+1)+".",1),e("td",qt,[e("div",Gt,o(a(y)(d.tanggal).format("DD-MM-YYYY")),1)]),e("td",Jt,[e("div",Kt,o(d.waktu.substring(0,5)),1)]),e("td",Wt,[e("div",Qt,[D(g,{value:d.attachment_1_preview,onSetFile:M=>d.attachment_1=M,onSetPreview:M=>d.attachment_1_preview=M},null,8,["value","onSetFile","onSetPreview"])])]),e("td",Xt,[e("div",Zt,o(d.note),1)]),e("td",{class:Z(["cell",!("useUtils"in s?s.useUtils:a(C))().checkPermissions(["standby_trx.detail.decide_paid"])||a(j)||s.is_view?"unselectable":""])},[e("div",ea,[!("useUtils"in s?s.useUtils:a(C))().checkPermissions(["standby_trx.detail.decide_paid"])||a(j)||s.is_view?(r(),v("div",ta,[d.be_paid==0?(r(),T(n,{key:0,class:"text-red-800"})):(r(),T(k,{key:1,class:"text-green-800"}))])):(r(),v("button",{key:1,type:"button",onClick:M=>d.be_paid=d.be_paid?0:1,class:Z(["text-white w-auto rounded text-xl",d.be_paid?"bg-green-600":"bg-red-600"])},[d.be_paid==0?(r(),T(n,{key:0})):(r(),T(k,{key:1}))],10,aa))])],2)],8,zt)):u("",!0)],64))),128))],512)])])])])]),e("div",la,[e("div",sa,[oa,a(t).val||a(t).val1||a(t).val2||a(t).val3||a(t).val4||a(t).val5?(r(),v("div",ia,[a(t).val?(r(),v("div",na," Kasir : "+o(a(t).val_by.username)+" ( "+o(a(t).val_at?a(y)(a(t).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):u("",!0),a(t).val1?(r(),v("div",ra," Mandor : "+o(a(t).val1_by.username)+" ( "+o(a(t).val1_at?a(y)(a(t).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):u("",!0),a(t).val2?(r(),v("div",_a," Staff Logistik : "+o(a(t).val2_by.username)+" ( "+o(a(t).val2_at?a(y)(a(t).val2_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):u("",!0),a(t).val3?(r(),v("div",da," Staff Logistik : "+o(a(t).val3_by.username)+" ( "+o(a(t).val3_at?a(y)(a(t).val3_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):u("",!0),a(t).val4?(r(),v("div",va," Staff Logistik : "+o(a(t).val4_by.username)+" ( "+o(a(t).val4_at?a(y)(a(t).val4_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):u("",!0),a(t).val5?(r(),v("div",ca," Staff Logistik : "+o(a(t).val5_by.username)+" ( "+o(a(t).val5_at?a(y)(a(t).val5_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):u("",!0)])):u("",!0)]),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:i[0]||(i[0]=d=>K())},[D(Y,{class:"black"})]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:i[1]||(i[1]=d=>p.fnClose())}," Cancel "),p.it_state==1&&("useUtils"in s?s.useUtils:a(C))().checkPermissions(["standby_trx.detail.decide_paid"])&&a(t).val5=="0"?(r(),v("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-green-600 text-white text-xs rounded-sm",onClick:i[2]||(i[2]=H(d=>B("paid"),["prevent"]))}," Paid ")):u("",!0),p.it_state==1&&("useUtils"in s?s.useUtils:a(C))().checkPermissions(["standby_trx.detail.decide_paid"])&&a(t).val5=="0"?(r(),v("button",{key:1,type:"submit",name:"button",class:"w-36 m-1 bg-red-600 text-white text-xs rounded-sm",onClick:i[3]||(i[3]=H(d=>B("nopaid"),["prevent"]))}," NoPaid ")):u("",!0),p.it_state==1?(r(),v("button",{key:2,ref_key:"it_val",ref:q,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:i[4]||(i[4]=H(d=>B(),["prevent"]))},[ee(" Validasi "),a(m)!=""?(r(),v("div",ua,o(a(m)),1)):u("",!0)],512)):u("",!0),p.it_state==0?(r(),v("button",{key:3,ref_key:"it_unval",ref:te,type:"submit",name:"button",class:"w-36 m-1 bg-yellow-600 text-white rounded-sm",onClick:i[5]||(i[5]=H(d=>ae(),["prevent"]))},[ee(" Unvalidasi "),a(m)!=""?(r(),v("div",pa,o(a(m)),1)):u("",!0)],512)):u("",!0),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:i[6]||(i[6]=d=>J())},[D($,{class:"black"})])])])])],512)),[[pe,p.show]])}}},Na=be(fa,[["__scopeId","data-v-87ef3ee9"]]);export{Na as default};
