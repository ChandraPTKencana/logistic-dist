import{_ as Re}from"./Header.597ac695.js";import{_ as Fe,a as Ve}from"./ac_accs.805518dd.js";import{_ as Te}from"./Plus.6537f849.js";import{_ as Ne}from"./Edit.a998dc07.js";import{_ as Be}from"./Delete.f3319735.js";import{_ as He}from"./Signature.23fab659.js";import{_ as ze}from"./Search.9a45b5b4.js";import{_ as Me}from"./Line.dbf5347b.js";import{_ as ge}from"./Check.47672de9.js";import{_ as Ee}from"./PopupMini.vue.645d8b30.js";import{_ as Ae}from"./HeaderPopup.vue.fee2a3e5.js";import{_ as Le,a as Oe}from"./ToolsPopup.4490b092.js";import{_ as Ye}from"./InputPointFormat.vue.3cc029b2.js";import{_ as De}from"./Times.b88215cf.js";import{r as p,f as me,H as ke,J as de,g as $e,o as a,c as r,h as z,v as Pe,a as e,b as $,k as t,j as te,t as n,l as he,G as g,d as K,F as J,n as _e,q as S,K as N,m as je,x as B,y as se,p as Se,e as Ie,s as qe,D as Je,B as Ke,I as Qe,i as Ce,w as Ge,E as Xe,M as Ze}from"./entry.8100bad0.js";import{u as ue}from"./useUtils.e262fca6.js";import{u as le}from"./useMyFetch.5df1780f.js";import{_ as Ue}from"./_plugin-vue_export-helper.c27b6911.js";const h=b=>(Se("data-v-2a0cd422"),b=b(),Ie(),b),We={class:"box-fixed"},et={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},tt={class:"w-full flex flex-col items-center grow overflow-auto"},st={class:"w-full flex flex-row flex-wrap"},lt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},at=h(()=>e("label",{for:""},"To",-1)),ot=["disabled"],nt={class:"text-red-500"},ct={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},it=h(()=>e("label",{for:""},"Tipe",-1)),ut=["disabled"],rt={class:"text-red-500"},dt={class:"w-full sm:w-4/12 md:w-2/12 lg:w-1/12 flex flex-col flex-wrap p-1"},_t=h(()=>e("label",{for:""},"Jenis",-1)),pt=["disabled"],ft=h(()=>e("option",{value:"PK"},"PK",-1)),vt=h(()=>e("option",{value:"CPO"},"CPO",-1)),mt=h(()=>e("option",{value:"TBS"},"TBS",-1)),ht=[ft,vt,mt],xt={class:"text-red-500"},wt={class:"w-full sm:w-4/12 md:w-2/12 lg:w-1/12 flex flex-col flex-wrap p-1"},yt=h(()=>e("label",{for:""},"Harga",-1)),bt={class:"card-border disabled"},kt={class:"text-red-500"},gt={class:"w-full sm:w-4/12 md:w-2/12 lg:w-4/12 flex flex-col flex-wrap p-1"},$t=h(()=>e("label",{for:""},"Ket. Untuk Remarks",-1)),jt=["disabled"],Ct={class:"text-red-500"},Tt={class:"w-full flex flex-col sm:flex-row grow p-1 justify-between flex-wrap 2xl:overflow-hidden"},At={class:"w-full max-w-full p-0 2xl:pr-1 2xl:w-1/2 2xl:max-h-full 2xl:overflow-auto"},Dt={class:"w-full",role:"sticky"},Pt={class:"tacky w-full",style:{"white-space":"normal"}},St={class:"sticky -top-1 !z-[2]"},It=["colspan"],qt={class:"sticky top-7 !z-[2]"},Ut={key:0,class:"min-w-[50px] !w-[50px] max-w-[50px]"},Rt=h(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),Ft=h(()=>e("th",null,"Desc",-1)),Vt=h(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Harga @",-1)),Nt=h(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"Qty",-1)),Bt={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Ht=h(()=>e("br",null,null,-1)),zt={class:"text-sm"},Mt=h(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"For Remarks",-1)),Et={ref:"to_move"},Lt=["data-index"],Ot={key:0,class:"tools cell"},Yt={class:"w-full h-full flex items-center justify-center"},Jt=["onClick"],Kt={class:"cell"},Qt={class:"w-full h-full flex items-center justify-center"},Gt=["disabled","onUpdate:modelValue"],Xt={class:"w-full h-full flex items-center justify-center"},Zt={class:"w-full h-full flex items-center justify-center"},Wt={class:"cell"},es={class:"w-full h-full flex items-center justify-center unselectable"},ts={class:"w-full h-full flex items-center justify-center"},ss={key:0,class:"text-3xl"},ls=["onClick"],as={key:0},os={class:"tools cell"},ns={class:"w-full max-w-full max-h-full px-0 py-2 2xl:pl-1 2xl:py-0 2xl:w-1/2 2xl:overflow-auto"},cs={class:"w-full",role:"sticky"},is={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},us={class:"sticky -top-1 !z-[2]"},rs=["colspan"],ds={class:"sticky top-7 !z-[2]"},_s={key:0,class:"min-w-[30px] !w-[30px] max-w-[30px]"},ps=h(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),fs={key:1,class:"min-w-[30px] !w-[30px] max-w-[30px]"},vs=h(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),ms=h(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),hs=h(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),xs=h(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),ws=h(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Amount",-1)),ys=h(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Qty",-1)),bs=h(()=>e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"For",-1)),ks={class:"min-w-[100px] !w-[100px] max-w-[100px]"},gs=h(()=>e("br",null,null,-1)),$s={class:"text-sm"},js={ref:"to_move"},Cs=["data-index"],Ts={key:0,class:"tools cell"},As={class:"w-full h-full flex items-center justify-center"},Ds=["onClick"],Ps={key:1,class:"cell"},Ss={class:"w-full h-full flex items-center justify-center"},Is=["onClick"],qs=["onClick","disabled"],Us={class:"w-full h-full flex items-center justify-center"},Rs={class:"w-full h-full flex items-center justify-center"},Fs={class:"w-full h-full flex items-center justify-center"},Vs={class:"cell"},Ns={class:"w-full h-full flex items-center justify-center"},Bs=["disabled","onUpdate:modelValue"],Hs={class:"w-full h-full flex items-center justify-center"},zs={class:"w-full h-full flex items-center justify-center"},Ms={class:"w-full h-full flex items-center justify-center"},Es=["onUpdate:modelValue","disabled"],Ls=h(()=>e("option",{value:"Supir"},"Supir",-1)),Os=h(()=>e("option",{value:"Kernet"},"Kernet",-1)),Ys=[Ls,Os],Js={class:"cell"},Ks={class:"w-full h-full flex items-center justify-center unselectable"},Qs={key:0},Gs={class:"tools cell"},Xs={class:"w-full flex items-center justify-end"},Zs={__name:"ujalan",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(b){const x=b,{pointFormat:E}=ue(),U={id:-1,xto:"",tipe:"",jenis:"",harga:0,note_for_remarks:"",details:[],details2:[]},f=p({...U}),c=me("token"),R=p({}),ae=p([{xdesc:"Timbangan",qty:1,harga:55e3},{xdesc:"Retribusi TPR",qty:1,harga:23e3},{xdesc:"Parkir & Nginap",qty:1,harga:1e4},{xdesc:"Penitipan Alat (Dongkrak)",qty:1,harga:5e3},{xdesc:"Ikas Danau",qty:1,harga:1e4},{xdesc:"U.Bongkar + Ambil surat",qty:1,harga:35e3},{xdesc:"Perbaikan Jalan Pujut",qty:1,harga:1e4},{xdesc:"Gaji Supir",qty:1,harga:0},{xdesc:"Gaji Kernet",qty:1,harga:0},{xdesc:"U.Extrafooding",qty:1,harga:2e4}]);p([]);const d=p([]),_=p([]),M=p({ordinal:0,id:-1,xdesc:"",qty:1,harga:0,for_remarks:0,p_status:""}),T=p({ordinal:0,id:-1,ac_account_id:"",ac_account_name:"",ac_account_code:"",description:"",qty:1,amount:0,xfor:"",p_status:""}),I=()=>{ae.value.forEach(o=>{d.value.filter(l=>l.xdesc==o.xdesc).length==0&&d.value.push({...o,ordinal:0,id:-1,p_status:"Add"})})},F=p(!1),k=()=>{F.value=!1},A=o=>{_.value[D.value].ac_account_id=o.ac_account_id,_.value[D.value].ac_account_code=o.ac_account_code,_.value[D.value].ac_account_name=o.ac_account_name,F.value=!1},O=(o,l)=>{D.value=l,F.value=!0},V=(o,l)=>{_.value[l].ac_account_id="",_.value[l].ac_account_code="",_.value[l].ac_account_name=""},{display:L}=ke(),v=async()=>{if(_.value.length>0&&j.value!=oe.value){L({show:!0,status:"Failed",message:"Total tidak cocok"});return}B().loading_full=!0,R.value={};const o=new FormData;o.append("xto",f.value.xto),o.append("tipe",f.value.tipe),o.append("jenis",f.value.jenis),o.append("harga",f.value.harga),o.append("note_for_remarks",f.value.note_for_remarks),o.append("details",JSON.stringify(d.value)),o.append("details2",JSON.stringify(_.value));let l="post",Y=x.is_copy?0:x.id;Y==0||(o.append("id",Y),o.append("_method","PUT"));const{data:H,error:P,status:G}=await le("/ujalan",{method:l,headers:{Authorization:`Bearer ${c.value}`,Accept:"application/json"},body:o,retry:0});if(B().loading_full=!1,G.value==="error"){se().trigger(P,R);return}if(Y<=0)f.value.id=H.value.id,f.value.created_at=H.value.created_at,f.value.updated_at=H.value.updated_at,x.p_data.unshift(f.value);else{f.value.updated_at=H.value.updated_at;let X=x.p_data.map(ie=>ie.id).indexOf(Y);X>=-1&&x.p_data.splice(X,1,{...f.value})}x.fnClose()},j=de(()=>{let o=0;return d.value.forEach(l=>{l.p_status!="Remove"&&(o+=l.qty*l.harga)}),f.value.harga=o,o}),oe=de(()=>{let o=0;return _.value.forEach(l=>{l.p_status!="Remove"&&(o+=l.qty*l.amount)}),o}),q=p(-1),D=p(-1),ne=p(!1),ce=p({left:0,top:0}),Z=p(!1),pe=p({left:0,top:0}),re=(o,l)=>{q.value=l,ne.value=!0,ce.value={left:o.clientX,top:o.clientY}},fe=(o,l)=>{D.value=l,Z.value=!0,pe.value={left:o.clientX,top:o.clientY}},W=()=>{d.value.push({...M.value,p_status:"Add"})},Q=()=>{_.value.push({...T.value,p_status:"Add"})},xe=()=>{ne.value=!1},we=()=>{Z.value=!1},ye=(o="")=>{if(o=="insert")d.value.splice(q.value,0,{...M.value,p_status:"Add"});else if(o=="delete")d.value[q.value].p_status=="Edit"?d.value[q.value].p_status="Remove":d.value.splice(q.value,1);else if(o=="move_top"){let l=d.value[q.value];d.value.splice(q.value,1),d.value.splice(q.value-1,0,{...l})}else if(o=="move_bottom"){let l=d.value[q.value];d.value.splice(q.value,1),d.value.splice(q.value+1,0,{...l})}ne.value=!1},m=(o="")=>{if(o=="insert")_.value.splice(D.value,0,{...T.value,p_status:"Add"});else if(o=="delete")_.value[D.value].p_status=="Edit"?_.value[D.value].p_status="Remove":_.value.splice(D.value,1);else if(o=="move_top"){let l=_.value[D.value];_.value.splice(D.value,1),_.value.splice(D.value-1,0,{...l})}else if(o=="move_bottom"){let l=_.value[D.value];_.value.splice(D.value,1),_.value.splice(D.value+1,0,{...l})}Z.value=!1},i=me("role"),u=de(()=>f.value.val&&f.value.val1||i.value=="Logistic"&&f.value.val||i.value=="PabrikTransport"&&f.value.val1),ee=async()=>{B().loading_full=!0;const{data:o,error:l,status:Y}=await le("/ujalan_",{method:"get",headers:{Authorization:`Bearer ${c.value}`,Accept:"application/json"},params:{id:x.id},retry:0});if(B().loading_full=!1,Y.value==="error"){se().trigger(l);return}f.value=o.value.data;let H="Edit";x.is_copy&&(H="Add",f.value.val=0,f.value.val1=0),d.value=o.value.data.details.map(P=>(P.p_status=H,P.key=P.ordinal,P)),_.value=o.value.data.details2.map(P=>(P.p_status=H,P.key=P.ordinal,P))};return $e(()=>x.show,(o,l)=>{o==!0&&(f.value={...U},d.value=[],_.value=[],x.id!=0&&ee())},{immediate:!0}),(o,l)=>{const Y=Ae,H=Le,P=Ye,G=De,X=ge,ie=Te,ve=Oe,be=Fe;return a(),r(J,null,[z(e("section",We,[e("div",null,[$(Y,{title:"Form Ujalan",fn:b.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",et,[e("div",tt,[e("div",st,[e("div",lt,[at,z(e("input",{"onUpdate:modelValue":l[0]||(l[0]=s=>t(f).xto=s),disabled:t(i)=="PabrikTransport"||t(u)},null,8,ot),[[te,t(f).xto]]),e("p",nt,n(t(R).xto),1)]),e("div",ct,[it,z(e("textarea",{"onUpdate:modelValue":l[1]||(l[1]=s=>t(f).tipe=s),disabled:t(i)=="PabrikTransport"||t(u)},null,8,ut),[[te,t(f).tipe]]),e("p",rt,n(t(R).tipe),1)]),e("div",dt,[_t,z(e("select",{"onUpdate:modelValue":l[2]||(l[2]=s=>t(f).jenis=s),disabled:t(i)=="PabrikTransport"||t(u)},ht,8,pt),[[he,t(f).jenis]]),e("p",xt,n(t(R).jenis),1)]),e("div",wt,[yt,e("div",bt,n(t(E)(t(j))),1),e("p",kt,n(t(R).harga),1)]),e("div",gt,[$t,z(e("textarea",{"onUpdate:modelValue":l[3]||(l[3]=s=>t(f).note_for_remarks=s),disabled:t(i)=="PabrikTransport"||t(u)},null,8,jt),[[te,t(f).note_for_remarks]]),e("p",Ct,n(t(R).note_for_remarks),1)])]),e("div",Tt,[e("div",At,[e("div",Dt,[e("table",Pt,[e("thead",null,[e("tr",St,[e("td",{colspan:t(i)!="PabrikTransport"&&!t(u)?7:6,class:"!bg-slate-800 text-white font-bold"}," Detail Uang Jalan ",8,It)]),e("tr",qt,[t(i)!="PabrikTransport"&&!t(u)?(a(),r("th",Ut,[e("button",{type:"button",name:"button",class:"bg-yellow-600",onClick:l[4]||(l[4]=s=>I())}," Default In ")])):g("",!0),Rt,Ft,Vt,Nt,e("th",Bt,[K("Total "),Ht,K(),e("span",zt,"("+n(t(E)(t(j)))+")",1)]),Mt])]),e("tbody",Et,[(a(!0),r(J,null,_e(t(d),(s,C)=>(a(),r(J,{key:C},[s.p_status!="Remove"?(a(),r("tr",{key:0,"data-index":C},[t(i)!="PabrikTransport"&&!t(u)?(a(),r("td",Ot,[e("div",Yt,[e("button",{type:"button",name:"button",onClick:w=>re(w,C)},[$(H)],8,Jt)])])):g("",!0),e("td",null,n(C+1)+".",1),e("td",Kt,[e("div",Qt,[z(e("textarea",{disabled:t(i)=="PabrikTransport"||t(u),class:"p-1 w-full","onUpdate:modelValue":w=>s.xdesc=w,cols:"7",rows:"2"},null,8,Gt),[[te,s.xdesc]])])]),e("td",{class:S(["cell bold",t(i)=="PabrikTransport"||t(u)?"unselectable":""])},[e("div",Xt,[(a(),N(P,{key:C,class:"w-full h-full p-1",type:"text",value:s.harga||0,onInput:w=>s.harga=w,show:b.show,disabled:t(i)=="PabrikTransport"||t(u)},null,8,["value","onInput","show","disabled"]))])],2),e("td",{class:S(["cell",t(i)=="PabrikTransport"||t(u)?"unselectable":""])},[e("div",Zt,[(a(),N(P,{key:C,class:"w-full h-full p-1",type:"text",value:s.qty||0,onInput:w=>s.qty=w,show:b.show,disabled:t(i)=="PabrikTransport"||t(u)},null,8,["value","onInput","show","disabled"]))])],2),e("td",Wt,[e("div",es,n(t(E)(s.qty*s.harga||0)),1)]),e("td",{class:S(["cell",t(i)=="PabrikTransport"||t(u)?"unselectable":""])},[e("div",ts,[t(i)=="PabrikTransport"||t(u)?(a(),r("div",ss,[s.for_remarks==0?(a(),N(G,{key:0,class:"text-red-800"})):(a(),N(X,{key:1,class:"text-green-800"}))])):(a(),r("button",{key:1,type:"button",onClick:w=>s.for_remarks=s.for_remarks?0:1,class:S(["text-white w-auto rounded text-xl",s.for_remarks?"bg-green-600":"bg-red-600"])},[s.for_remarks==0?(a(),N(G,{key:0})):(a(),N(X,{key:1}))],10,ls))])],2)],8,Lt)):g("",!0)],64))),128)),t(i)!="PabrikTransport"&&!t(u)?(a(),r("tr",as,[e("td",os,[e("button",{type:"button",name:"button",onClick:l[5]||(l[5]=s=>W())},[$(ie)])])])):g("",!0)],512)])])]),e("div",ns,[e("div",cs,[e("table",is,[e("thead",null,[e("tr",us,[e("td",{colspan:t(u)?9:11,class:"!bg-slate-800 text-white font-bold"}," Detail PVR ",8,rs)]),e("tr",ds,[t(u)?g("",!0):(a(),r("th",_s)),ps,t(u)?g("",!0):(a(),r("th",fs)),vs,ms,hs,xs,ws,ys,bs,e("th",ks,[K("Total "),gs,K(),e("span",$s,"("+n(t(E)(t(oe)))+")",1)])])]),e("tbody",js,[(a(!0),r(J,null,_e(t(_),(s,C)=>(a(),r(J,{key:C},[s.p_status!="Remove"?(a(),r("tr",{key:0,"data-index":C},[t(u)?g("",!0):(a(),r("td",Ts,[e("div",As,[e("button",{type:"button",name:"button",onClick:w=>fe(w,C)},[$(H)],8,Ds)])])),e("td",null,n(C+1)+".",1),t(u)?g("",!0):(a(),r("td",Ps,[e("div",Ss,[s.ac_account_id?(a(),r("button",{key:1,type:"button",onClick:w=>V(w,C),disabled:s.confirm_by},[$(G,{class:"font-bold text-2xl"})],8,qs)):(a(),r("button",{key:0,type:"button",name:"button",onClick:w=>O(w,C)}," ... ",8,Is))])])),e("td",{class:S(["cell bold",t(u)?"unselectable":""])},[e("div",Us,n(s.ac_account_id),1)],2),e("td",{class:S(["cell bold",t(u)?"unselectable":""])},[e("div",Rs,n(s.ac_account_code),1)],2),e("td",{class:S(["cell bold",t(u)?"unselectable":""])},[e("div",Fs,n(s.ac_account_name),1)],2),e("td",Vs,[e("div",Ns,[z(e("textarea",{disabled:t(u),class:"p-1 w-full","onUpdate:modelValue":w=>s.description=w,cols:"7",rows:"2"},null,8,Bs),[[te,s.description]])])]),e("td",{class:S(["cell bold",t(u)?"unselectable":""])},[e("div",Hs,[(a(),N(P,{key:C,class:"w-full h-full p-1",type:"text",value:s.amount||0,onInput:w=>s.amount=w,show:b.show,disabled:t(u)},null,8,["value","onInput","show","disabled"]))])],2),e("td",{class:S(["cell",t(u)?"unselectable":""])},[e("div",zs,[(a(),N(P,{key:C,class:"w-full h-full p-1",type:"text",value:s.qty||0,onInput:w=>s.qty=w,show:b.show,disabled:t(u)},null,8,["value","onInput","show","disabled"]))])],2),e("td",{class:S(["cell",t(u)?"unselectable":""])},[e("div",Ms,[z(e("select",{class:"h-full","onUpdate:modelValue":w=>s.xfor=w,disabled:t(u)},Ys,8,Es),[[he,s.xfor]])])],2),e("td",Js,[e("div",Ks,n(t(E)(s.qty*s.amount||0)),1)])],8,Cs)):g("",!0)],64))),128)),t(u)?g("",!0):(a(),r("tr",Qs,[e("td",Gs,[e("button",{type:"button",name:"button",onClick:l[6]||(l[6]=s=>Q())},[$(ie)])])]))],512)])])])])]),e("div",Xs,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:l[7]||(l[7]=s=>b.fnClose())}," Cancel "),t(u)?g("",!0):(a(),r("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:l[8]||(l[8]=je(s=>v(),["prevent"]))}," Save "))])])])],512),[[Pe,b.show]]),$(ve,{show:t(ne),coor:t(ce),fn:xe,data:t(d),data_index:t(q),onReplyAct:l[9]||(l[9]=s=>ye(s))},null,8,["show","coor","data","data_index"]),$(ve,{show:t(Z),coor:t(pe),fn:we,data:t(_),data_index:t(D),onReplyAct:l[10]||(l[10]=s=>m(s))},null,8,["show","coor","data","data_index"]),$(be,{show:t(F),fnClose:k,fnSelect:A},null,8,["show"])],64)}}},Ws=Ue(Zs,[["__scopeId","data-v-2a0cd422"]]);const y=b=>(Se("data-v-e7e002f1"),b=b(),Ie(),b),el={class:"box-fixed"},tl={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},sl={class:"w-full flex flex-col items-center grow overflow-auto"},ll={class:"w-full flex flex-row flex-wrap"},al={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ol=y(()=>e("label",{for:""},"To",-1)),nl={class:"card-border"},cl={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},il=y(()=>e("label",{for:""},"Tipe",-1)),ul={class:"card-border"},rl={class:"w-full sm:w-4/12 md:w-2/12 lg:w-1/12 flex flex-col flex-wrap p-1"},dl=y(()=>e("label",{for:""},"Jenis",-1)),_l={class:"card-border"},pl={class:"w-full sm:w-4/12 md:w-2/12 lg:w-1/12 flex flex-col flex-wrap p-1"},fl=y(()=>e("label",{for:""},"Harga",-1)),vl={class:"card-border"},ml={class:"w-full sm:w-4/12 md:w-2/12 lg:w-4/12 flex flex-col flex-wrap p-1"},hl=y(()=>e("label",{for:""},"Ket. Untuk Remarks",-1)),xl={class:"card-border"},wl={class:"w-full flex flex-col sm:flex-row grow p-1 justify-between flex-wrap 2xl:overflow-hidden"},yl={class:"w-full p-0 2xl:pr-1 2xl:w-1/2 2xl:h-full 2xl:overflow-auto"},bl={class:"w-full",role:"sticky"},kl={class:"tacky w-full",style:{"white-space":"normal"}},gl=y(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"6",class:"!bg-slate-800 text-white font-bold"}," Detail Uang Jalan ")],-1)),$l={class:"sticky top-8 !z-[2]"},jl=y(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),Cl=y(()=>e("th",null,"Desc",-1)),Tl=y(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Harga @",-1)),Al=y(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"Qty",-1)),Dl={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Pl=y(()=>e("br",null,null,-1)),Sl={class:"text-sm"},Il=y(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"For Remarks",-1)),ql={ref:"to_move"},Ul=["data-index"],Rl={class:"cell"},Fl={class:"w-full h-full flex items-center justify-center"},Vl={class:"cell bold"},Nl={class:"w-full h-full flex items-center justify-center"},Bl={class:"cell"},Hl={class:"w-full h-full flex items-center justify-center"},zl={class:"cell"},Ml={class:"w-full h-full flex items-center justify-center"},El={class:"cell"},Ll={class:"w-full h-full flex items-center justify-center"},Ol={class:"w-full px-0 py-2 2xl:pl-1 2xl:py-0 2xl:w-1/2 2xl:h-full 2xl:overflow-auto"},Yl={class:"w-full",role:"sticky"},Jl={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},Kl=y(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"9",class:"!bg-slate-800 text-white font-bold"}," Detail PVR ")],-1)),Ql={class:"sticky top-8 !z-[2]"},Gl=y(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),Xl=y(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),Zl=y(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),Wl=y(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),ea=y(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),ta=y(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Amount",-1)),sa=y(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Qty",-1)),la=y(()=>e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"For",-1)),aa={class:"min-w-[100px] !w-[100px] max-w-[100px]"},oa=y(()=>e("br",null,null,-1)),na={class:"text-sm"},ca={ref:"to_move"},ia=["data-index"],ua={class:"w-full h-full flex items-center justify-center"},ra={class:"w-full h-full flex items-center justify-center"},da={class:"w-full h-full flex items-center justify-center"},_a={key:0,class:"cell"},pa={class:"w-full h-full flex items-center justify-center"},fa={class:"w-full h-full flex items-center justify-center"},va={class:"cell"},ma={class:"w-full h-full flex items-center justify-center"},ha={class:"w-full flex items-center justify-end"},xa={class:"w-full flex flex-wrap p-3 items-center"},wa=y(()=>e("div",null," Di Validasi oleh : ",-1)),ya={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},ba={key:0},ka={key:1},ga={__name:"ujalan_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},setup(b){const x=b,{$moment:E}=qe(),{pointFormat:U}=ue(),c=p({...{id:-1,xto:"",tipe:"",jenis:"",harga:0,note_for_remarks:0,details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:""}}),R=me("token"),ae=p({}),d=p([]),_=p([]),M=async()=>{B().loading_full=!0,ae.value={};const k=new FormData;let A="post",O=x.id;O==0||(k.append("id",O),k.append("_method","PUT"));const{data:V,error:L,status:v}=await le("/ujalan_validasi",{method:A,headers:{Authorization:`Bearer ${R.value}`,Accept:"application/json"},body:k,retry:0});if(B().loading_full=!1,v.value==="error"){se().trigger(L,ae);return}c.value.val=V.value.val,c.value.val_user=V.value.val_user,c.value.val_by=V.value.val_by,c.value.val_at=V.value.val_at,c.value.val1=V.value.val1,c.value.val1_user=V.value.val1_user,c.value.val1_by=V.value.val1_by,c.value.val1_at=V.value.val1_at;let j=x.p_data.map(oe=>oe.id).indexOf(x.id);j>=-1&&x.p_data.splice(j,1,{...c.value}),x.fnClose()},T=async()=>{B().loading_full=!0;const{data:k,error:A,status:O}=await le("/ujalan_",{method:"get",headers:{Authorization:`Bearer ${R.value}`,Accept:"application/json"},params:{id:x.id},retry:0});if(B().loading_full=!1,O.value==="error"){se().trigger(A);return}c.value=k.value.data,d.value=k.value.data.details,_.value=k.value.data.details2},I=de(()=>{let k=0;return _.value.forEach(A=>{A.p_status!="Remove"&&(k+=A.qty*A.amount)}),k}),F=de(()=>!1);return $e(()=>x.show,(k,A)=>{k==!0&&T()},{immediate:!0}),(k,A)=>{const O=Ae,V=De,L=ge;return z((a(),r("section",el,[e("div",null,[$(O,{title:"Form Ujalan Validation",fn:b.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",tl,[e("div",sl,[e("div",ll,[e("div",al,[ol,e("div",nl,n(t(c).xto),1)]),e("div",cl,[il,e("div",ul,n(t(c).tipe),1)]),e("div",rl,[dl,e("div",_l,n(t(c).jenis),1)]),e("div",pl,[fl,e("div",vl,n(t(U)(t(c).harga||0)),1)]),e("div",ml,[hl,e("div",xl,n(t(c).note_for_remarks),1)])]),e("div",wl,[e("div",yl,[e("div",bl,[e("table",kl,[e("thead",null,[gl,e("tr",$l,[jl,Cl,Tl,Al,e("th",Dl,[K("Total "),Pl,K(),e("span",Sl,"("+n(t(U)(t(c).harga||0))+")",1)]),Il])]),e("tbody",ql,[(a(!0),r(J,null,_e(t(d),(v,j)=>(a(),r(J,{key:j},[v.p_status!="Remove"?(a(),r("tr",{key:0,"data-index":j},[e("td",null,n(j+1)+".",1),e("td",Rl,[e("div",Fl,n(v.xdesc),1)]),e("td",Vl,[e("div",Nl,n(t(U)(v.harga||0)),1)]),e("td",Bl,[e("div",Hl,n(t(U)(v.qty||0)),1)]),e("td",zl,[e("div",Ml,n(t(U)(v.qty*v.harga||0)),1)]),e("td",El,[e("div",Ll,[e("div",{class:S(["text-white rounded text-xl w-5 h-5",v.for_remarks?"bg-green-600":"bg-red-600"])},[v.for_remarks==0?(a(),N(V,{key:0})):(a(),N(L,{key:1}))],2)])])],8,Ul)):g("",!0)],64))),128))],512)])])]),e("div",Ol,[e("div",Yl,[e("table",Jl,[e("thead",null,[Kl,e("tr",Ql,[Gl,Xl,Zl,Wl,ea,ta,sa,la,e("th",aa,[K("Total "),oa,K(),e("span",na,"("+n(t(U)(t(I)))+")",1)])])]),e("tbody",ca,[(a(!0),r(J,null,_e(t(_),(v,j)=>(a(),r(J,{key:j},[v.p_status!="Remove"?(a(),r("tr",{key:0,"data-index":j},[e("td",null,n(j+1)+".",1),e("td",{class:S(["cell bold",t(F)?"unselectable":""])},[e("div",ua,n(v.ac_account_id),1)],2),e("td",{class:S(["cell bold",t(F)?"unselectable":""])},[e("div",ra,n(v.ac_account_code),1)],2),e("td",{class:S(["cell bold",t(F)?"unselectable":""])},[e("div",da,n(v.ac_account_name),1)],2),t(F)?g("",!0):(a(),r("td",_a,[e("div",pa,n(v.description),1)])),e("td",{class:S(["cell bold",t(F)?"unselectable":""])},[e("div",fa,n(t(U)(v.amount||0)),1)],2),e("td",{class:S(["cell",t(F)?"unselectable":""])},n(t(U)(v.qty||0)),3),e("td",{class:S(["cell",t(F)?"unselectable":""])},n(v.xfor),3),e("td",va,[e("div",ma,n(t(U)(v.qty*v.amount||0)),1)])],8,ia)):g("",!0)],64))),128))],512)])])])])]),e("div",ha,[e("div",xa,[wa,t(c).val||t(c).val1?(a(),r("div",ya,[t(c).val?(a(),r("div",ba," App 1 : "+n(t(c).val_by.username)+" ( "+n(t(c).val_at?t(E)(t(c).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):g("",!0),t(c).val1?(a(),r("div",ka," App 2 : "+n(t(c).val1_by.username)+" ( "+n(t(c).val1_at?t(E)(t(c).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):g("",!0)])):g("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:A[0]||(A[0]=v=>b.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:A[1]||(A[1]=je(v=>M(),["prevent"]))}," Validasi ")])])])],512)),[[Pe,b.show]])}}},$a=Ue(ga,[["__scopeId","data-v-e7e002f1"]]),ja={class:"w-full h-full flex flex-col"},Ca={class:"w-full flex grow flex-col overflow-auto h-0"},Ta={class:"w-full flex"},Aa={action:"#",class:"w-full flex p-1"},Da={class:"grow"},Pa=e("div",{class:"font-bold"}," Keyword ",-1),Sa={class:"pl-1"},Ia=e("div",{class:"font-bold"}," Sort By ",-1),qa=Ze('<option value=""></option><option value="id">ID</option><option value="xto">To</option><option value="jenis">Jenis</option><option value="tipe">Tipe</option>',5),Ua=[qa],Ra={class:"pl-1"},Fa=e("div",{class:"font-bold"}," Sort Order ",-1),Va=e("option",{value:"asc"},"Asc",-1),Na=e("option",{value:"desc"},"Desc",-1),Ba=[Va,Na],Ha={class:"flex items-end pl-1"},za={class:"w-full flex justify-center items-center grow h-0 p-1"},Ma={key:0,class:""},Ea={class:"tacky"},La=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"App 2"),e("th",null,"ID"),e("th",null,"To"),e("th",null,"Tipe"),e("th",null,"Jenis"),e("th",null,"Harga"),e("th",null,"Ket.U.Remarks"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),Oa=["onClick"],Ya={class:"flex items-center justify-center"},Ja={class:"flex items-center justify-center"},Ka={class:"bold"},Qa={class:"grow mb-5"},vo={__name:"index",async setup(b){let x,E;const{$moment:U}=qe(),{pointFormat:f}=ue(),c={};c._TimeZoneOffset=new Date().getTimezoneOffset(),c.sort="created_at:desc";const R=me("token"),{data:ae}=([x,E]=Je(async()=>Xe(async()=>{let m=[];B().loading_full=!0;const{data:i,error:u,status:ee}=await le("/ujalan",{method:"get",headers:{Authorization:`Bearer ${R.value}`,Accept:"application/json"},params:c,retry:0});return B().loading_full=!1,ee.value==="error"?(se().trigger(u),{ujalans:m}):(m=i.value.data,{ujalans:m})},"$SN3C927rLk")),x=await x,E(),x),d=p(ae.value.ujalans),_=p(""),M=p({field:"created_at",by:"desc"}),T=p(-1),I=p({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),F=()=>{c.like="",_.value!=""&&(c.like=`id:%${_.value}%,xto:%${_.value}%,tipe:%${_.value}%,jenis:%${_.value}%,harga:%${_.value}%`),c.sort="",M.value.field&&(c.sort=M.value.field+":"+M.value.by)},k=p(null),A=async()=>{B().loading_full=!0,I.value.may_get_data=!1,c.page=I.value.page,c.page==1&&(d.value=[]),c.first_row&&delete c.first_row,c.page>1&&(c.first_row=JSON.stringify(d.value[0]));const{data:m,error:i,status:u}=await le("/ujalan",{method:"get",headers:{Authorization:`Bearer ${R.value}`,Accept:"application/json"},params:c,retry:0});if(B().loading_full=!1,I.value.may_get_data=!0,u.value==="error"){se().trigger(i);return}I.value.page==1?(d.value=m.value.data,k.value&&(k.value.scrollTop=0)):I.value.page>1&&(d.value=[...d.value,...m.value.data]),m.value.data.length==0&&(I.value.is_last_record=!0)},O=async()=>{if(!I.value.may_get_data)return;let m=k.value;if(m.scrollLeft!=I.value.scrollLeft){I.value.scrollLeft=m.scrollLeft;return}I.value.is_last_record||!(Math.round(m.scrollTop)+m.clientHeight>=m.scrollHeight-1)||(I.value.page++,await A())},V=()=>{I.value.page=1,I.value.is_last_record=!1,F(),A()};Ke();const L=p(!1),v=p(0),j=p(0),oe=()=>{v.value=0,L.value=!0,j.value=!1},{display:q}=ke();Qe(ke());const D=()=>{T.value==-1?q({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(v.value=d.value[T.value].id,L.value=!0,j.value=!1)},ne=()=>{T.value==-1?q({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(v.value=d.value[T.value].id,L.value=!0,j.value=!0)},ce=p(!1),Z=p(0),pe=()=>{T.value==-1?q({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(Z.value=d.value[T.value].id,ce.value=!0)},re=p(!1),fe=p({}),W=p(!1),Q=p(""),xe=async()=>{W.value&&(W.value=!1)},we=()=>{T.value==-1?q({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(Q.value="",fe.value={id:d.value[T.value].id},W.value=!0)};$e(()=>Q.value,m=>{m.trim().length>0?re.value=!0:re.value=!1},{immediate:!1});const ye=async()=>{B().loading_full=!0;const m=new FormData;m.append("id",d.value[T.value].id),m.append("deleted_reason",Q.value),m.append("_method","DELETE");const{data:i,error:u,status:ee}=await le("/ujalan",{method:"post",headers:{Authorization:`Bearer ${R.value}`,Accept:"application/json"},body:m,retry:0});if(B().loading_full=!1,ee.value==="error"){se().trigger(u);return}d.value.splice(T.value,1),T.value=-1,W.value=!1};return(m,i)=>{const u=Re,ee=Ve,o=Te,l=Ne,Y=Be,H=He,P=ze,G=Me,X=ge,ie=Ee,ve=Ws,be=$a;return a(),r("div",ja,[$(u,{title:"List Ujalan"}),e("div",Ca,[e("div",Ta,[("useUtils"in m?m.useUtils:t(ue))().checkRole(["PabrikTransport"])?g("",!0):(a(),r("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:i[0]||(i[0]=s=>ne())},[$(ee)])),("useUtils"in m?m.useUtils:t(ue))().checkRole(["PabrikTransport"])?g("",!0):(a(),r("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:i[1]||(i[1]=s=>oe())},[$(o)])),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:i[2]||(i[2]=s=>D())},[$(l)]),("useUtils"in m?m.useUtils:t(ue))().checkRole(["PabrikTransport"])?g("",!0):(a(),r("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:i[3]||(i[3]=s=>we())},[$(Y)])),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:i[4]||(i[4]=s=>pe())},[$(H)])]),e("form",Aa,[e("div",Da,[Pa,z(e("input",{class:"",type:"text","onUpdate:modelValue":i[5]||(i[5]=s=>Ce(_)?_.value=s:null),name:"search",placeholder:"Keyword"},null,512),[[te,t(_)]])]),e("div",Sa,[Ia,z(e("select",{class:"","onUpdate:modelValue":i[6]||(i[6]=s=>t(M).field=s)},Ua,512),[[he,t(M).field]])]),e("div",Ra,[Fa,z(e("select",{class:"","onUpdate:modelValue":i[7]||(i[7]=s=>t(M).by=s)},Ba,512),[[he,t(M).by]])]),e("div",Ha,[e("button",{class:"",type:"submit",name:"button",onClick:i[8]||(i[8]=je(s=>V(),["prevent"]))},[$(P,{class:"text-2xl"})])])]),e("div",za,[t(d).length==0?(a(),r("div",Ma," Maaf Tidak Ada Record ")):(a(),r("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:k,onScroll:O},[e("table",Ea,[La,e("tbody",null,[(a(!0),r(J,null,_e(t(d),(s,C)=>(a(),r("tr",{key:C,onClick:w=>T.value=C,class:S(t(T)==C?"active":"")},[e("td",null,[e("div",Ya,[s.val?(a(),N(X,{key:1})):(a(),N(G,{key:0}))])]),e("td",null,[e("div",Ja,[s.val1?(a(),N(X,{key:1})):(a(),N(G,{key:0}))])]),e("td",Ka,n(s.id),1),e("td",null,n(s.xto),1),e("td",null,n(s.tipe),1),e("td",null,n(s.jenis),1),e("td",null,n(t(f)(s.harga)),1),e("td",null,n(s.note_for_remarks),1),e("td",null,n(s.created_at?t(U)(s.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,n(s.updated_at?t(U)(s.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,Oa))),128))])])],544))])]),$(ie,{type:"delete",show:t(W),data:t(fe),fnClose:xe,fnConfirm:ye,enabledOk:t(re)},{footer:Ge(()=>[K(" Masukkan Alasan Penghapusan: "),e("div",Qa,[z(e("textarea",{"onUpdate:modelValue":i[9]||(i[9]=s=>Ce(Q)?Q.value=s:null)},null,512),[[te,t(Q)]])])]),_:1},8,["show","data","enabledOk"]),$(ve,{show:t(L),fnClose:()=>{L.value=!1},id:t(v),p_data:t(d),is_copy:t(j)},null,8,["show","fnClose","id","p_data","is_copy"]),$(be,{show:t(ce),fnClose:()=>{ce.value=!1},id:t(Z),p_data:t(d)},null,8,["show","fnClose","id","p_data"])])}}};export{vo as default};
