import _t from"./Header.9ac1ff43.js";import ct from"./PrinterEye.8bd061f5.js";import ut from"./Table2Column.49c42e87.js";import pt from"./Line.54c86bb2.js";import dt from"./Check.a81cdf3d.js";import ft from"./TableView.4c23bf32.js";import{_ as bt}from"./PopupMini.vue.91564f59.js";import mt from"./Times.30378410.js";import{_ as yt}from"./HeaderPopup.vue.1c6bff80.js";import{r as _,f as kt,g as ht,h as vt,i as V,s as gt,A as u,G as xt,c as h,b as k,a as s,d as p,w as c,k as a,l as wt,m as Dt,J as $t,t as l,F as q,y as L,z as St,B as D,o as d,C as Tt,D as v,E as At}from"./entry.d8b45e34.js";import{u as Z}from"./useUtils.8ca2e142.js";import{u as $}from"./useMyFetch.0f4f6d96.js";import{u as Ct}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.956b2fed.js";import"./Adjust.921df012.js";import"./TableHeaderEye.5986baee.js";import"./ClearAll.08e2c44c.js";import"./client-only.71815d14.js";import"./ClearEach.500f8992.js";import"./CaretLeftDoubleBold.535179d4.js";import"./CaretLeftBold.09242f1b.js";import"./CaretRightBold.e0243905.js";import"./CaretRightDoubleBold.23889bb4.js";import"./Exclamation.201354fe.js";const Mt={class:"w-full h-full flex flex-col"},Bt={class:"w-full flex grow flex-col overflow-auto h-0"},Nt={class:"w-full flex"},Pt={class:"flex flex-wrap p-1"},Ft=s("span",{class:"text-xs ml-1"}," PDF ",-1),Yt=s("span",{class:"text-xs ml-1"}," Excel ",-1),Ht={key:0,class:"w-full h-full flex items-center justify-center fixed top-0 left-0 z-20 p-3",style:{"background-color":"rgba(255,255,255,0.9)"}},Ot={class:"relative",style:{width:"95%",height:"90%"}},Rt={class:"absolute -top-7 right-0 bg-white",style:{position:"absolute",padding:"5px 10px",border:"solid 1px #ccc","border-bottom":"none","border-top-right-radius":"5px","border-top-left-radius":"5px"}},Et=["src"],zt={class:"w-full h-full fixed top-0 left-0 bg-gray-100 bg-opacity-80 flex items-center justify-center z-10"},jt={class:"w-full sm:w-10/12 md:w-8/12 lg:w-6/12 bg-white flex flex-col border-solid border-gray-200 max-w-full max-h-full",style:{"border-width":"1px"}},Ut={class:"p-1 flex flex-wrap overflow-auto items-start"},It={class:"w-full sm:w-1/2 flex flex-wrap"},Jt={class:"flex flex-col m-2"},Kt=s("span",{class:"text-xs"}," To ",-1),Vt={class:""},qt={class:"flex flex-col m-2"},Lt=s("span",{class:"text-xs"}," Tipe ",-1),Zt={class:""},Gt={class:"flex flex-col m-2"},Qt=s("span",{class:"text-xs"}," Jenis ",-1),Wt={class:""},Xt={class:"flex flex-col m-2"},te=s("span",{class:"text-xs"}," Ket. Untuk Remarks ",-1),ee={class:""},se={class:"w-full sm:w-1/2 text-sm flex justify-center"},oe={class:"border border-collapse border-black"},ae=s("tr",null,[s("th",{colspan:"4",class:"bg-blue-400"}," List Uang Jalan ")],-1),le={class:"p-1"},re={class:"p-1"},ne=s("td",{class:"p-1"},"= Rp.",-1),ie={class:"text-right p-1"},_e={class:"border-t-black border-dashed",style:{"border-top-width":"1px"}},ce=s("th",{colspan:"2",class:"text-right"},"Total",-1),ue=s("th",{class:"p-1 text-right"},"Rp.",-1),pe={class:"p-1 text-right"},de={class:"w-full mt-2 text-sm flex justify-center"},fe={class:"border border-collapse border-black"},be=s("tr",null,[s("th",{colspan:"5",class:"bg-blue-400"}," List PVR ")],-1),me={class:"p-1"},ye={class:"p-1"},ke={class:"p-1"},he=s("td",{class:"p-1"},"= Rp.",-1),ve={class:"text-right p-1"},ge={class:"border-t-black border-dashed",style:{"border-top-width":"1px"}},xe=s("th",{colspan:"2",class:"text-right"},"Total",-1),we=s("th",{class:"p-1 text-right"},"Rp.",-1),De={class:"p-1 text-right"},$e={class:"flex p-1 justify-end flex-wrap"},ts={__name:"index copy",async setup(Se){let S,R;const{$moment:E}=At(),{pointFormat:i}=Z(),r={};r._TimeZoneOffset=new Date().getTimezoneOffset(),r.sort="tanggal:desc";const z=_({}),g=kt("token"),T=_({from:"",to:""}),{data:G}=([S,R]=ht(async()=>St(async()=>{u().loading_full=!0;let e=[];const[o,n]=await Promise.all([$("/trx_trps",{method:"get",headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},retry:0})]);return o.status.value!=="error"&&(e=o.data.value.data),o.status.value==="error"?(D().trigger(o.error),{trx_trps:e}):(u().loading_full=!1,{trx_trps:e})},"$FEMAmUEOgN")),S=await S,R(),S),m=_(G.value.trx_trps||[]),M=_({field:"tanggal",by:"desc"}),x=_(-1),f=_({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),B=()=>{r.like="";let e=JSON.parse(JSON.stringify(u()._tv.global_keyword));e!=""&&(r.like=`id:%${e}%,xto:%${e}%,jenis:%${e}%,pv_no:%${e}%,ticket_a_no:%${e}%,ticket_b_no:%${e}%,no_pol:%${e}%,supir:%${e}%,kernet:%${e}%,cost_center_code:%${e}%,cost_center_desc:%${e}%,pvr_no:%${e}%,tanggal:%${e}%,transition_target:%${e}%`),r.sort="",M.value.field&&(r.sort=M.value.field+":"+M.value.by),r._TimeZoneOffset=new Date().getTimezoneOffset(),r.date_from=T.value.from?E(T.value.from).format("YYYY-MM-DD"):"",r.date_to=T.value.to?E(T.value.to).format("YYYY-MM-DD"):"",r.filter_model=JSON.stringify(u()._tv.filter_model)},j=_(null),U=async()=>{u().loading_full=!0,z.value={},f.value.may_get_data=!1,r.page=f.value.page,r.page==1&&(m.value=[]),r.first_row&&delete r.first_row,r.page>1&&(r.first_row=JSON.stringify(m.value[0]));const{data:e,error:o,status:n}=await $("/trx_trps",{method:"get",headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},params:r,retry:0});if(u().loading_full=!1,f.value.may_get_data=!0,n.value==="error"){D().trigger(o,z);return}f.value.page==1?(m.value=e.value.data,j.value&&(j.value.scrollTop=0)):f.value.page>1&&(m.value=[...m.value,...e.value.data]),e.value.data.length==0&&(f.value.is_last_record=!0),u()._tv.filter_box=!1},Q=()=>{f.value.page=1,f.value.is_last_record=!1,B(),U()};vt(),_(!1),_(0),V(),gt(V());const W=_({}),A=_(!1),X=async()=>{A.value&&(A.value=!1)},tt=async()=>{u().loading_full=!0;const e=new FormData;e.append("id",m.value[x.value].id),e.append("_method","DELETE");const{data:o,error:n,status:b}=await $("/trx_trp",{method:"post",headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},body:e,retry:0});if(u().loading_full=!1,b.value==="error"){D().trigger(n);return}m.value.splice(x.value,1),x.value=-1,A.value=!1},{downloadFile:I,viewFile:Te}=Ct(),C=_(!1),N=_(""),J=async(e="")=>{if(C.value==!0){C.value=!1;return}B(),u().loading_full=!0;const{data:o,error:n,status:b}=await $("/trx_trps/"+e,{method:"get",headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},params:r,retry:0});if(u().loading_full=!1,b.value==="error"){D().trigger(n);return}N.value=o.value,C.value=!0},et=async(e="")=>{B(),u().loading_full=!0;const{data:o,error:n,status:b}=await $("/trx_trps/"+e,{method:"get",headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},params:r,retry:0});if(u().loading_full=!1,b.value==="error"){D().trigger(n);return}I(o.value)},st=()=>{I(N.value)},K=e=>e.pv_id<=0||["CPO","PK"].indexOf(e.jenis)>-1&&(e.ticket_a_id<=0||e.ticket_b_bruto<=0||e.ticket_b_tara<=0||e.ticket_b_netto<=0||e.ticket_b_in_at==""||e.ticket_b_out_at=="")||e.jenis=="TBS"&&(e.ticket_a_id<=0||e.ticket_b_id<=0)||e.jenis=="TBSK"&&e.ticket_b_id<=0?0:1,ot=_([{key:"status",label:"Status",filter_on:1,sort_off:1,type:"select",select_item:["Undone","Done"]},{key:"val",label:"App 1",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val1",label:"App 2",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"tanggal",label:"U.Jalan Per",type:"date",dateformat:"DD-MM-Y",filter_on:1,sort:{priority:1,type:"desc"}},{key:"no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"xto",label:"Tujuan",filter_on:1,type:"string"},{key:"tipe",label:"Tipe",filter_on:1,type:"string"},{key:"jenis",label:"Jenis",filter_on:1,type:"select",select_item:["TBS","TBSK","CPO","PK"]},{key:"amount",label:"Amount",class:" justify-end",filter_on:1,type:"number"},{key:"cost_center",label:"Cost Center",childs:[{key:"cost_center_code",label:"Code",class:" justify-start",filter_on:1,type:"string"},{key:"cost_center_desc",label:"Desc",filter_on:1,type:"string"}]},{key:"pvr",label:"PVR",childs:[{key:"pvr_no",label:"No",filter_on:1,type:"string"},{key:"pvr_total",label:"Total",filter_on:1,type:"number"},{key:"pvr_had_detail",label:"Completed",filter_on:1,type:"select",select_item:[{k:"1",v:"Completed"},{k:"0",v:"Uncompleted"}]}]},{key:"pv",label:"PV",childs:[{key:"pv_datetime",label:"Date",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"pv_no",label:"No",filter_on:1,type:"string"},{key:"pv_total",label:"Total",filter_on:1,type:"number"}]},{key:"transition_target",label:"Peralihan",filter_on:1,type:"select",select_item:u().list_pabrik},{key:"ticket_a",label:"Ticket A",childs:[{key:"ticket_a_no",label:"No",filter_on:1,type:"string"},{key:"ticket_a_bruto",label:"Bruto",filter_on:1,type:"number"},{key:"ticket_a_tara",label:"Tara",filter_on:1,type:"number"},{key:"ticket_a_netto",label:"Netto",filter_on:1,type:"number"},{key:"ticket_a_supir",label:"Supir",filter_on:1,type:"string"},{key:"ticket_a_no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"ticket_a_in_at",label:"In At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"ticket_a_out_at",label:"Out At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1}]},{key:"ticket_b",label:"Ticket B",childs:[{key:"ticket_b_no",label:"No",filter_on:1,type:"string"},{key:"ticket_b_bruto",label:"Bruto",filter_on:1,type:"number"},{key:"ticket_b_tara",label:"Tara",filter_on:1,type:"number"},{key:"ticket_b_netto",label:"Netto",filter_on:1,type:"number"},{key:"ticket_b_supir",label:"Supir",filter_on:1,type:"string"},{key:"ticket_b_no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"ticket_b_in_at",label:"In At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"ticket_b_out_at",label:"Out At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1}]},{key:"susut",label:"Susut",childs:[{key:"susut_bruto",label:"Bruto",childs:[{key:"susut_bruto_a",label:"Berangkat"},{key:"susut_bruto_b",label:"Kembali"},{key:"susut_bruto_b_a",label:"Selisih"},{key:"susut_bruto_b_a_persen",label:"%"}]},{key:"susut_tara",label:"Tara",childs:[{key:"susut_tara_a",label:"Berangkat"},{key:"susut_tara_b",label:"Kembali"},{key:"susut_tara_b_a",label:"Selisih"},{key:"susut_tara_b_a_persen",label:"%"}]},{key:"susut_netto",label:"Netto",childs:[{key:"susut_netto_a",label:"Berangkat"},{key:"susut_netto_b",label:"Kembali"},{key:"susut_netto_b_a",label:"Selisih"},{key:"susut_netto_b_a_persen",label:"%"}]}]},{key:"supir",label:"Supir",filter_on:1,type:"string"},{key:"kernet",label:"Kernet",filter_on:1,type:"string"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1}]),P=(e,o)=>{e=parseFloat(e)||0,o=parseFloat(o)||0;let n=parseFloat(o-e),b=n>0?o:e;if(b==0)return 0;let w=Z().round(n/b*100,2);return w<0?"("+Math.abs(w*100)/100+")":w},F=(e,o)=>{e=parseFloat(e)||0,o=parseFloat(o)||0;let n=parseFloat(o-e);return n<0?"("+i(Math.abs(n))+")":i(n)},Y=_(!1),y=_({...{id:-1,xto:"",tipe:"",jenis:"",harga:0,note_for_remarks:"",details:[],details2:[]}}),at=xt(()=>{let e=0;return y.value.details2.forEach(o=>{o.p_status!="Remove"&&(e+=o.qty*o.amount)}),e});return(e,o)=>{const n=_t,b=ct,w=ut,H=pt,O=dt,lt=ft,rt=bt,nt=mt,it=yt;return d(),h("div",Mt,[k(n,{title:"Report Transaction"}),s("div",Bt,[s("div",Nt,[s("div",Pt,[s("button",{type:"button",name:"button",class:"m-1 text-2xl flex items-center",onClick:o[0]||(o[0]=t=>J("reportSusutPDF"))},[k(b),p(),Ft]),s("button",{type:"button",name:"button",class:"m-1 text-2xl flex items-center",onClick:o[1]||(o[1]=t=>et("reportSusutExcel"))},[k(w),p(),Yt])])]),k(lt,{thead:a(ot),selected:a(x),onSetSelected:o[2]||(o[2]=t=>x.value=t),tbody:a(m),fnCallData:U,scrolling:a(f),onSetScrollingPage:o[3]||(o[3]=t=>a(f).page=t),onDoFilter:o[4]||(o[4]=t=>Q())},{status:c(({item:t})=>[s("div",{class:Tt(["text-white text-xs px-2 py-1 rounded-lg",K(t)?"bg-green-600":"bg-red-600"])},l(K(t)?"Done":"Not Done"),3)]),val:c(({item:t})=>[t.val?(d(),v(O,{key:1})):(d(),v(H,{key:0}))]),val1:c(({item:t})=>[t.val1?(d(),v(O,{key:1})):(d(),v(H,{key:0}))]),pvr_had_detail:c(({item:t})=>[t.pvr_had_detail?(d(),v(O,{key:1})):(d(),v(H,{key:0}))]),susut_bruto_a:c(({item:t})=>[p(l(a(i)(t.ticket_a_bruto)),1)]),susut_tara_a:c(({item:t})=>[p(l(a(i)(t.ticket_a_tara)),1)]),susut_netto_a:c(({item:t})=>[p(l(a(i)(t.ticket_a_netto)),1)]),susut_bruto_b:c(({item:t})=>[p(l(a(i)(t.ticket_b_bruto)),1)]),susut_tara_b:c(({item:t})=>[p(l(a(i)(t.ticket_b_tara)),1)]),susut_netto_b:c(({item:t})=>[p(l(a(i)(t.ticket_b_netto)),1)]),susut_bruto_b_a:c(({item:t})=>[p(l(F(t.ticket_a_bruto,t.ticket_b_bruto)),1)]),susut_tara_b_a:c(({item:t})=>[p(l(F(t.ticket_a_tara,t.ticket_b_tara)),1)]),susut_netto_b_a:c(({item:t})=>[p(l(F(t.ticket_a_netto,t.ticket_b_netto)),1)]),susut_bruto_b_a_persen:c(({item:t})=>[p(l(P(t.ticket_a_bruto,t.ticket_b_bruto)),1)]),susut_tara_b_a_persen:c(({item:t})=>[p(l(P(t.ticket_a_tara,t.ticket_b_tara)),1)]),susut_netto_b_a_persen:c(({item:t})=>[p(l(P(t.ticket_a_netto,t.ticket_b_netto)),1)]),_:2},1032,["thead","selected","tbody","scrolling"])]),k(rt,{type:"delete",show:a(A),data:a(W),fnClose:X,fnConfirm:tt},null,8,["show","data"]),a(C)?(d(),h("div",Ht,[s("div",Ot,[s("div",Rt,[k(nt,{style:{color:"black",cursor:"pointer"},onClick:o[5]||(o[5]=t=>J())})]),s("iframe",{ref:"iframe",width:"100%",height:"100%",src:a(N).dataBase64},null,8,Et),s("div",{style:{position:"absolute",top:"12px",right:"88px","background-color":"rgba(255,255,255,0)",width:"37px",height:"36px","z-index":"1",cursor:"pointer"},onClick:o[6]||(o[6]=t=>st())})])])):wt("",!0),Dt(s("div",zt,[s("div",jt,[k(it,{title:"Detail Information",fn:()=>{Y.value=!1,e.show_confirm=!1},class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),s("div",Ut,[s("div",It,[s("div",Jt,[Kt,s("div",Vt,l(a(y).xto)+" ",1)]),s("div",qt,[Lt,s("div",Zt,l(a(y).tipe),1)]),s("div",Gt,[Qt,s("div",Wt,l(a(y).jenis),1)]),s("div",Xt,[te,s("div",ee,l(a(y).note_for_remarks),1)])]),s("div",se,[s("table",oe,[ae,(d(!0),h(q,null,L(a(y).details,t=>(d(),h("tr",null,[s("td",le,l(t.ordinal)+". ",1),s("td",re,l(t.xdesc)+" "+l(t.qty<=1?"":a(i)(t.qty||0)+" x Rp."+a(i)(t.harga||0)),1),ne,s("td",ie,l(a(i)(t.qty*t.harga)),1)]))),256)),s("tr",_e,[ce,ue,s("th",pe,l(a(i)(a(y).harga)),1)])])]),s("div",de,[s("table",fe,[be,(d(!0),h(q,null,L(a(y).details2,t=>(d(),h("tr",null,[s("td",me,l(t.ordinal)+". ",1),s("td",ye,l(t.ac_account_code),1),s("td",ke,l(t.description)+" "+l(t.qty<=1?"":a(i)(t.qty||0)+" x Rp."+a(i)(t.amount||0)),1),he,s("td",ve,l(a(i)(t.qty*t.amount)),1)]))),256)),s("tr",ge,[xe,we,s("th",De,l(a(i)(a(at))),1)])])])]),s("div",$e,[s("button",{class:"rounded m-1",onClick:o[7]||(o[7]=t=>Y.value=!1)}," Cancel ")])])],512),[[$t,a(Y)]])])}}};export{ts as default};
