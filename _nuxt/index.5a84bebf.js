import we from"./Header.c4932c18.js";import De from"./Plus.971916d7.js";import Se from"./Edit.baa4e7d8.js";import Ce from"./Eyes.5ff5156e.js";import $e from"./Delete.1f004db0.js";import Ae from"./Signature.45992cf6.js";import Pe from"./Line.1a7e0522.js";import Te from"./Check.84c53518.js";import Me from"./TypeIcon.d5cea0d7.js";import Oe from"./TableView.991bae3a.js";import{_ as Be}from"./PopupMini.vue.1533b4b6.js";import Ne from"./employee.9e2f8f70.js";import Ie from"./employee_validasi.1155175e.js";import{r as n,f as G,g as je,h as Fe,i as k,B as Ee,j as Q,s as ze,c as g,a as r,b as i,k as W,v as Ve,l as o,m as X,n as S,w as h,F as He,q as Je,x as m,y as V,o as _,z as O,d as H,t as ee,A as Re,p as Le,e as Ue}from"./entry.48b3d933.js";import{u as J}from"./useMyFetch.2a06d70a.js";import{u as v}from"./useUtils.14d22b9a.js";import{_ as Ye}from"./_plugin-vue_export-helper.c27b6911.js";import"./DocJPEG.31534644.js";import"./DocJPG.94012a8b.js";import"./DocPNG.cbe4de98.js";import"./DocPDF.d086df65.js";import"./Search.dc32962b.js";import"./Adjust.0c8903f0.js";import"./TableHeaderEye.b919d1a0.js";import"./Times.834f5337.js";import"./ClearAll.db5b4118.js";import"./client-only.212d9ba9.js";import"./ClearEach.326ff963.js";import"./CaretLeftDoubleBold.7427471d.js";import"./CaretLeftBold.1604d4b7.js";import"./CaretRightBold.20598fbb.js";import"./CaretRightDoubleBold.f098b916.js";import"./Exclamation.1b7ff15d.js";import"./HeaderPopup.vue.b7f02079.js";import"./InputPointFormat.vue.69dac75f.js";import"./AttachmentSingle.30344261.js";import"./PDFJsView.9db13dfd.js";const B=C=>(Le("data-v-9ced5aa2"),C=C(),Ue(),C),Ke={class:"w-full h-full flex flex-col"},qe={class:"w-full flex grow flex-col overflow-auto h-0"},Ze={class:"w-full flex justify-between flex-wrap"},Ge={class:"grow flex"},Qe={class:"m-1"},We=B(()=>r("option",{value:"available"},"Available",-1)),Xe=B(()=>r("option",{value:"unapprove"},"Unapprove",-1)),et=B(()=>r("option",{value:"deleted"},"Trash",-1)),tt=B(()=>r("option",{value:"all"},"All",-1)),at=[We,Xe,et,tt],lt={class:"grow mb-5"},ot={__name:"index",async setup(C){let $,R;const te=e=>e.deleted==1?"!bg-red-400":e.val==0||e.val1==0?"!bg-gray-300":"",p=n("available");G(()=>p.value,e=>{Y()},{immediate:!1});const u={};u._TimeZoneOffset=new Date().getTimezoneOffset();const N=je("token"),{data:s}=([$,R]=Fe(async()=>Je(async()=>{m().loading_full=!0;const{data:e,error:t,status:y}=await J("/employees",{method:"get",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},params:{filter_status:p},retry:0});return m().loading_full=!1,y.value==="error"?(V().trigger(t),[]):e.value.data},"$p5jj5crAgd")),$=await $,R(),$),I=n({field:"",by:"desc"}),l=n(-1),d=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),c=k(()=>s.value[l.value]),ae=()=>{u.like="";let e=JSON.parse(JSON.stringify(m()._tv.global_keyword));e!=""&&(u.like=`id:%${e}%,name:%${e}%,ktp_no:%${e}%,sim_no:%${e}%,phone_number:%${e}%,rek_no:%${e}%`),u.sort="",I.value.field&&(u.sort=I.value.field+":"+I.value.by),u.filter_model=JSON.stringify(m()._tv.filter_model)},L=n(null),U=async()=>{m().loading_full=!0,d.value.may_get_data=!1,u.page=d.value.page,u.page==1&&(s.value=[]),u.filter_status=p.value;const{data:e,error:t,status:y}=await J("/employees",{method:"get",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},params:u,retry:0});if(m().loading_full=!1,d.value.may_get_data=!0,y.value==="error"){V().trigger(t);return}d.value.page==1?(s.value=e.value.data,L.value&&(L.value.scrollTop=0)):d.value.page>1&&(s.value=[...s.value,...e.value.data]),e.value.data.length==0&&(d.value.is_last_record=!0),m()._tv.filter_box=!1},Y=()=>{l.value=-1,d.value.page=1,d.value.is_last_record=!1,ae(),U()};Ee();const A=n(!1),j=n(0),x=n(0),P=n(!1),le=()=>{j.value=0,P.value=!1,x.value=!1,A.value=!0},{display:T}=Q();ze(Q());const oe=()=>{l.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(j.value=s.value[l.value].id,P.value=!1,x.value=!1,A.value=!0)},M=n(!1),F=n(0),se=()=>{l.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=s.value[l.value].id,P.value=!1,x.value=!1,M.value=!0)},ne=()=>{l.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=s.value[l.value].id,P.value=!0,x.value=!1,M.value=!0)},E=n(!1),K=n({}),w=n(!1),b=n(""),re=async()=>{w.value&&(w.value=!1)},ie=()=>{l.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(b.value="",K.value={id:s.value[l.value].id},w.value=!0)};G(()=>b.value,e=>{e.trim().length>0?E.value=!0:E.value=!1},{immediate:!1});const ue=async()=>{m().loading_full=!0;const e=new FormData;e.append("id",s.value[l.value].id),e.append("deleted_reason",b.value),e.append("_method","DELETE");const{data:t,error:y,status:z}=await J("/employee",{method:"post",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},body:e,retry:0});if(m().loading_full=!1,z.value==="error"){V().trigger(y);return}let f={...s.value[l.value]};f.deleted=t.value.deleted,f.deleted_user=t.value.deleted_user,f.deleted_at=t.value.deleted_at,f.deleted_by=t.value.deleted_by,f.deleted_reason=t.value.deleted_reason,p.value!="all"?s.value.splice(l.value,1):s.value.splice(l.value,1,{...f}),l.value=-1,w.value=!1},de=n([{key:"no",label:"No",isai:!0},{key:"val",label:"App 1",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"id",label:"ID",freeze:1,filter_on:1,type:"number"},{key:"name",label:"Nama",freeze:1,freeze_left:"44px",filter_on:1,type:"string",sort:{priority:1,type:"asc"}},{key:"role",label:"Jabatan",filter_on:1,type:"string"},{key:"ktp_no",label:"No KTP",filter_on:1,type:"string"},{key:"sim_no",label:"No SIM",filter_on:1,type:"string"},{key:"bank_code",label:"Nama Bank",filter_on:1,type:"string"},{key:"rek_no",label:"No Rek",filter_on:1,type:"string"},{key:"rek_name",label:"Nama Rek",filter_on:1,type:"string"},{key:"phone_number",label:"No Tlp",filter_on:1,type:"string"},{key:"birth_place",label:"Tempat Lahir",filter_on:1,type:"string"},{key:"birth_date",label:"Tanggal Lahir",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"tmk",label:"TMK",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"address",label:"Alamat",filter_on:1,type:"string"},{key:"status",label:"Status",filter_on:1,type:"string"},{key:"attachment_1_type",label:"File",type:"string"},{key:"bpjs_kesehatan",label:"BPJS Kesehatan",class:" justify-end",type:"number",filter_on:1},{key:"bpjs_jamsos",label:"BPJS Jamsos",class:" justify-end",type:"number",filter_on:1},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]);k(()=>l.value>-1&&[void 0,0].indexOf(c.value.deleted)>-1&&v().checkPermission("employee.create"));const _e=k(()=>["available","all","unapprove"].indexOf(p.value)>-1&&v().checkPermission("employee.create")),me=k(()=>l.value>-1&&[void 0,0].indexOf(c.value.deleted)>-1&&(v().checkPermission("employee.val")&&[void 0,0].indexOf(c.value.val)>-1||v().checkPermission("employee.val1")&&[void 0,0].indexOf(c.value.val1)>-1)&&v().checkPermissions(["employee.modify","employee.detail.modify","employee.detail2.modify"])),pe=k(()=>l.value>-1&&[void 0,0].indexOf(c.value.deleted)>-1&&(v().checkPermission("employee.val")&&[void 0,0].indexOf(c.value.val)>-1||v().checkPermission("employee.val1")&&[void 0,0].indexOf(c.value.val1)>-1)),ce=k(()=>l.value>-1&&v().checkPermission("employee.remove")&&[void 0,0].indexOf(c.value.deleted)>-1);return(e,t)=>{const y=we,z=De,f=Se,fe=Ce,ve=$e,ye=Ae,q=Pe,Z=Te,be=Me,ke=Oe,ge=Be,he=Ne,xe=Ie;return _(),g(He,null,[r("div",Ke,[i(y,{title:"List Employee"}),r("div",qe,[r("div",Ze,[r("div",Ge,[r("div",Qe,[W(r("select",{class:"","onUpdate:modelValue":t[0]||(t[0]=a=>X(p)?p.value=a:null)},at,512),[[Ve,o(p)]])]),o(_e)?(_(),g("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=a=>le())},[i(z)])):S("",!0),o(me)?(_(),g("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=a=>oe())},[i(f)])):S("",!0),o(l)>-1?(_(),g("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[3]||(t[3]=a=>ne())},[i(fe)])):S("",!0),o(ce)?(_(),g("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[4]||(t[4]=a=>ie())},[i(ve)])):S("",!0),o(pe)?(_(),g("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[5]||(t[5]=a=>se())},[i(ye)])):S("",!0)])]),i(ke,{thead:o(de),selected:o(l),onSetSelected:t[6]||(t[6]=a=>l.value=a),tbody:o(s),fnCallData:U,scrolling:o(d),onSetScrollingPage:t[7]||(t[7]=a=>o(d).page=a),onDoFilter:t[8]||(t[8]=a=>Y()),rowBgColor:te},{val:h(({item:a})=>[a.val?(_(),O(Z,{key:1})):(_(),O(q,{key:0}))]),val1:h(({item:a})=>[a.val1?(_(),O(Z,{key:1})):(_(),O(q,{key:0}))]),bank_code:h(({item:a})=>{var D;return[H(ee((D=a.bank)==null?void 0:D.code),1)]}),attachment_1_type:h(({item:a})=>[i(be,{value:a.attachment_1_type},null,8,["value"])]),deleted_by_username:h(({item:a})=>{var D;return[H(ee((D=a.deleted_by)==null?void 0:D.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])])]),i(ge,{type:"delete",show:o(w),data:o(K),fnClose:re,fnConfirm:ue,enabledOk:o(E)},{footer:h(()=>[H(" Masukkan Alasan Penghapusan: "),r("div",lt,[W(r("textarea",{"onUpdate:modelValue":t[9]||(t[9]=a=>X(b)?b.value=a:null)},null,512),[[Re,o(b)]])])]),_:1},8,["show","data","enabledOk"]),i(he,{show:o(A),fnClose:()=>{A.value=!1},id:o(j),p_data:o(s),is_copy:o(x)},null,8,["show","fnClose","id","p_data","is_copy"]),i(xe,{show:o(M),fnClose:()=>{M.value=!1},id:o(F),p_data:o(s)},null,8,["show","fnClose","id","p_data"])],64)}}},Jt=Ye(ot,[["__scopeId","data-v-9ced5aa2"]]);export{Jt as default};
