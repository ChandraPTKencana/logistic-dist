import{_ as ae}from"./HeaderPopup.vue.d81cefce.js";import{_ as le}from"./WidthMiniPart.vue.0492ef97.js";import oe from"./AttachmentSingle.2a543a7c.js";import ie from"./Times.b3e1f779.js";import ne from"./Check.d6182f2c.js";import de from"./CaretTop.780c092a.js";import re from"./CaretDown.4411aeb3.js";import{r as b,g as _e,Q as ce,i as Q,f as ve,k as ue,K as pe,o as d,c as v,a as e,b as g,t as i,l as s,F as X,D as fe,E as Z,z as U,n as m,C as F,d as ee,G as me,x as D,y as H,p as we,e as xe}from"./entry.ae10661a.js";import{u as C}from"./useUtils.4772637c.js";import{u as L}from"./useMyFetch.fb53d751.js";import{_ as he}from"./_plugin-vue_export-helper.c27b6911.js";import"./PDFJsView.4f91ca97.js";const n=u=>(we("data-v-a655de4c"),u=u(),xe(),u),be={class:"box-fixed"},ye={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},ke={class:"w-full flex flex-col items-center grow overflow-auto"},ge={class:"w-full flex flex-row flex-wrap"},De={class:"w-full sm:w-9/12 flex px-2 py-3"},Se={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},Ce=n(()=>e("div",{class:"absolute bg-white -top-3"}," Standby ",-1)),Ne={class:"w-6/12 sm:w-2/12 flex flex-col flex-wrap p-1"},Ie=n(()=>e("label",{for:""},"ID",-1)),Ae={class:"card-border"},Pe={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},$e=n(()=>e("label",{for:""},"Name",-1)),Te={class:"card-border"},Ye={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Ue=n(()=>e("label",{for:""},"Type",-1)),Fe={class:"card-border"},Be={class:"w-6/12 sm:w-2/12 flex flex-col flex-wrap p-1"},Ve=n(()=>e("label",{for:""},"Amount",-1)),je={class:"card-border"},Ee={class:"w-full sm:w-3/12 flex px-2 py-3"},Me={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative items-end"},Oe=n(()=>e("div",{class:"absolute bg-white -top-3"}," Peralihan ",-1)),Re={class:"w-6/12 flex flex-col flex-wrap p-1"},He={class:"card-border"},Le={class:"w-6/12 flex flex-col flex-wrap p-1"},ze={class:"card-border"},qe={class:"w-full flex flex-wrap"},Ge={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Je=n(()=>e("label",{for:""},"Supir",-1)),Ke={class:"card-border"},We={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Qe=n(()=>e("label",{for:""},"Kernet",-1)),Xe={class:"card-border"},Ze={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},et=n(()=>e("label",{for:""},"No Pol",-1)),tt={class:"card-border"},st={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},at=n(()=>e("label",{for:""},"Tujuan",-1)),lt={class:"card-border"},ot={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},it=n(()=>e("label",{for:""},"Note For Remarks",-1)),nt={class:"card-border"},dt={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},rt=n(()=>e("label",{for:""},"Trx Trp ID#",-1)),_t={class:"card-border"},ct={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},vt={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},ut=n(()=>e("div",{class:"absolute bg-white -top-3"}," Cost Center ",-1)),pt={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},ft=n(()=>e("label",{for:""}," Code",-1)),mt={class:"card-border"},wt={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},xt=n(()=>e("label",{for:""},"Desc",-1)),ht={class:"card-border disabled"},bt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},yt={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},kt=n(()=>e("div",{class:"absolute bg-white -top-3"}," PVR ",-1)),gt={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},Dt=n(()=>e("label",{for:""},"No",-1)),St={class:"card-border disabled"},Ct={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Nt=n(()=>e("label",{for:""},"Total",-1)),It={class:"card-border disabled"},At={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},Pt={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},$t=n(()=>e("div",{class:"absolute bg-white -top-3"}," PV ",-1)),Tt={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},Yt=n(()=>e("label",{for:""},"No",-1)),Ut={class:"card-border disabled"},Ft={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Bt=n(()=>e("label",{for:""},"Total",-1)),Vt={class:"card-border disabled"},jt={class:"w-full flex grow p-1 overflow-auto 2xl:overflow-hidden justify-between flex-wrap"},Et={class:"w-full",role:"sticky"},Mt={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},Ot={class:"sticky -top-1 !z-[2]"},Rt=["colspan"],Ht=n(()=>e("tr",{class:"sticky top-7 !z-[2]"},[e("th",{class:"!min-w-[50px] !w-[50px] !max-w-[50px]"},"No"),e("th",{class:"!min-w-[90px] !w-[90px] !max-w-[90px]"},"Tanggal"),e("th",{class:"!min-w-[55px] !w-[55px] !max-w-[55px]"},"Waktu"),e("th",{class:"!min-w-[200px] !w-[200px] !max-w-[200px]"},"Foto"),e("th",{class:"!min-w-[200px] !w-[200px] !max-w-[200px]"},"Note"),e("th",{class:"!min-w-[70px] !w-[70px] !max-w-[70px]"},"Dibayar")],-1)),Lt={ref:"to_move"},zt=["data-index"],qt={class:"cell"},Gt={class:"w-full h-auto flex items-center justify-center relative"},Jt={class:"cell"},Kt={class:"w-full h-auto flex items-center justify-center relative"},Wt={class:"cell"},Qt={style:{width:"60vw"},class:"h-auto flex items-center justify-center"},Xt={class:"cell"},Zt={class:"h-auto flex items-center justify-center"},es={class:"w-full h-auto flex items-center justify-center"},ts={key:0,class:"text-3xl"},ss=["onClick"],as={class:"w-full flex items-center justify-end"},ls={class:"w-full flex flex-wrap p-3 items-center"},os=n(()=>e("div",null," Di Validasi oleh : ",-1)),is={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},ns={key:0},ds={key:1},rs={key:2},_s={key:0,class:"text-xs font-bold"},cs={key:0,class:"text-xs font-bold"},vs={__name:"standby_trx_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},it_state:{type:Number,required:!1,default:-1}},emits:["setID","setIndex"],setup(u,{emit:N}){const _=u,{$moment:I}=me(),{pointFormat:B}=C(),z={id:-1,transition_target:"",transition_type:"",standby_mst_id:"",standby_mst_:{name:"",tipe:"",amount:0},supir:"",kernet:"",no_pol:"",xto:"",note_for_remarks:"",trx_trp_id:"",cost_center_code:"",cost_center_desc:"",pvr_id:"",pvr_no:"",pvr_total:0,pvr_had_detail:0,pv_id:"",pv_no:"",pv_total:0,pv_datetime:"",rv_id:"",rv_no:"",rv_total:0,rv_had_detail:"",details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:""},t=b({...z}),V=_e("token"),A=b({}),q=b(null),te=b(null),P=b([]),G={_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:-1,name:"",title:""};let j=a=>{a.key=="ArrowUp"&&K(),a.key=="ArrowDown"&&J()};ce(()=>{document.removeEventListener("keydown",j)});const x=b(JSON.parse(JSON.stringify(G))),h=b(JSON.parse(JSON.stringify(G))),f=b(""),E=async a=>{f.value="PROSES...",D().loading_full=!0,A.value={};const o=new FormData;let p=[...P.value];a=="paid"?p=p.map((w,T)=>(w.be_paid=1,w)):a=="nopaid"&&(p=p.map((w,T)=>(w.be_paid=0,w))),o.append("details",JSON.stringify(p));let l="post",k=_.id;k==0||(o.append("id",k),o.append("_method","PUT"));const{data:c,error:y,status:S}=await L("/standby_trx_validasi",{method:l,headers:{Authorization:`Bearer ${V.value}`,Accept:"application/json"},body:o,retry:0});if(D().loading_full=!1,S.value==="error"){f.value="GAGAL",H().trigger(y,A);return}t.value.val=c.value.val,t.value.val_user=c.value.val_user,t.value.val_by=c.value.val_by,t.value.val_at=c.value.val_at,t.value.val1=c.value.val1,t.value.val1_user=c.value.val1_user,t.value.val1_by=c.value.val1_by,t.value.val1_at=c.value.val1_at,t.value.val2=c.value.val2,t.value.val2_user=c.value.val2_user,t.value.val2_by=c.value.val2_by,t.value.val2_at=c.value.val2_at;let $=_.p_data.map(w=>w.id).indexOf(_.id);$>=-1&&_.p_data.splice($,1,{...t.value}),f.value="BERHASIL"},se=async()=>{f.value="PROSES...",D().loading_full=!0,A.value={};const a=new FormData;let o="post",p=_.id;p==0||(a.append("id",p),a.append("_method","PUT"));const{data:l,error:k,status:c}=await L("/standby_trx_unvalidasi",{method:o,headers:{Authorization:`Bearer ${V.value}`,Accept:"application/json"},body:a,retry:0});if(D().loading_full=!1,c.value==="error"){f.value="GAGAL",H().trigger(k,A);return}t.value.val=l.value.val,t.value.val_user=l.value.val_user,t.value.val_by=l.value.val_by,t.value.val_at=l.value.val_at,t.value.val1=l.value.val1,t.value.val1_user=l.value.val1_user,t.value.val1_by=l.value.val1_by,t.value.val1_at=l.value.val1_at,t.value.val2=l.value.val2,t.value.val2_user=l.value.val2_user,t.value.val2_by=l.value.val2_by,t.value.val2_at=l.value.val2_at;let y=_.p_data.map(S=>S.id).indexOf(_.id);y>=-1&&_.p_data.splice(y,1,{...t.value}),f.value="BERHASIL"},M=async()=>{f.value="",D().loading_full=!0;const{data:a,error:o,status:p}=await L("/standby_trx",{method:"get",headers:{Authorization:`Bearer ${V.value}`,Accept:"application/json"},params:{id:_.id},retry:0});if(D().loading_full=!1,p.value==="error"){H().trigger(o);return}let l=a.value.data;t.value=l,x.value._.id.val=l.supir_id,x.value._.name.val=l.supir,x.value._.rek_no.val=l.supir_rek_no,x.value._.rek_name.val=l.supir_rek_name,x.value.id=l.supir_id,x.value.name=l.supir,x.value.rek_no=(l.supir_rek_no||"")+" "+(l.supir_rek_name||""),h.value._.id.val=l.kernet_id,h.value._.name.val=l.kernet,h.value._.rek_no.val=l.kernet_rek_no,h.value._.rek_name.val=l.kernet_rek_name,h.value.id=l.kernet_id,h.value.name=l.kernet,h.value.rek_no=(l.kernet_rek_no||"")+" "+(l.kernet_rek_name||""),P.value=a.value.data.details};Q(()=>{let a=0;return P.value.forEach(o=>{o.p_status!="Remove"&&(a+=o.amount)}),a});const O=Q(()=>t.value.val2==1);ve(()=>_.show,(a,o)=>{a==!0?(document.addEventListener("keydown",j),t.value={...z},_.is_view==!1&&setTimeout(()=>{q.value.focus()},1),M()):document.removeEventListener("keydown",j)},{immediate:!0});const J=()=>{let a=_.p_data.map(o=>o.id).indexOf(_.id);a!=_.p_data.length-1&&(a++,N("setID",_.p_data[a].id),N("setIndex",a),setTimeout(()=>{M()},100))},K=()=>{let a=_.p_data.map(o=>o.id).indexOf(_.id);a!=0&&(a--,N("setID",_.p_data[a].id),N("setIndex",a),setTimeout(()=>{M()},100))};return(a,o)=>{var w,T,W;const p=ae,l=le,k=oe,c=ie,y=ne,S=de,$=re;return ue((d(),v("section",be,[e("div",null,[g(p,{title:"Form Transaction Standby Validation",fn:u.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",ye,[e("div",ke,[e("div",ge,[e("div",De,[e("div",Se,[Ce,e("div",Ne,[Ie,e("div",Ae,i(s(t).standby_mst_id),1)]),e("div",Pe,[$e,e("div",Te,i((w=s(t).standby_mst_)==null?void 0:w.name),1)]),e("div",Ye,[Ue,e("div",Fe,i((T=s(t).standby_mst_)==null?void 0:T.tipe),1)]),e("div",Be,[Ve,e("div",je,i(s(B)((W=s(t).standby_mst_)==null?void 0:W.amount)),1)])])]),e("div",Ee,[e("div",Me,[Oe,e("div",Re,[e("div",He,i(s(t).transition_type),1)]),e("div",Le,[e("div",ze,i(s(t).transition_target),1)])])]),e("div",qe,[e("div",Ge,[Je,e("div",Ke,[g(l,{selected:s(x)},null,8,["selected"])])]),e("div",We,[Qe,e("div",Xe,[g(l,{selected:s(h)},null,8,["selected"])])]),e("div",Ze,[et,e("div",tt,i(s(t).no_pol),1)]),e("div",st,[at,e("div",lt,i(s(t).xto),1)]),e("div",ot,[it,e("div",nt,i(s(t).note_for_remarks),1)]),e("div",dt,[rt,e("div",_t,i(s(t).trx_trp_id),1)])]),e("div",ct,[e("div",vt,[ut,e("div",pt,[ft,e("div",mt,i(s(t).cost_center_code),1)]),e("div",wt,[xt,e("div",ht,i(s(t).cost_center_desc),1)])])]),e("div",bt,[e("div",yt,[kt,e("div",gt,[Dt,e("div",St,i(s(t).pvr_no),1)]),e("div",Ct,[Nt,e("div",It,i(s(B)(s(t).pvr_total||0)),1)])])]),e("div",At,[e("div",Pt,[$t,e("div",Tt,[Yt,e("div",Ut,i(s(t).pv_no),1)]),e("div",Ft,[Bt,e("div",Vt,i(s(B)(s(t).pv_total)),1)])])]),e("div",jt,[e("div",Et,[e("table",Mt,[e("thead",null,[e("tr",Ot,[e("td",{colspan:s(O)?6:7,class:"!bg-slate-800 text-white font-bold"}," Detail Transaction ",8,Rt)]),Ht]),e("tbody",Lt,[(d(!0),v(X,null,fe(s(P),(r,R)=>(d(),v(X,{key:R},[r.p_status!="Remove"?(d(),v("tr",{key:0,"data-index":R},[e("td",null,i(R+1)+".",1),e("td",qt,[e("div",Gt,i(s(I)(r.tanggal).format("DD-MM-YYYY")),1)]),e("td",Jt,[e("div",Kt,i(r.waktu.substring(0,5)),1)]),e("td",Wt,[e("div",Qt,[g(k,{value:r.attachment_1_preview,onSetFile:Y=>r.attachment_1=Y,onSetPreview:Y=>r.attachment_1_preview=Y},null,8,["value","onSetFile","onSetPreview"])])]),e("td",Xt,[e("div",Zt,i(r.note),1)]),e("td",{class:Z(["cell",!("useUtils"in a?a.useUtils:s(C))().checkPermissions(["standby_trx.detail.decide_paid"])||s(O)||a.is_view?"unselectable":""])},[e("div",es,[!("useUtils"in a?a.useUtils:s(C))().checkPermissions(["standby_trx.detail.decide_paid"])||s(O)||a.is_view?(d(),v("div",ts,[r.be_paid==0?(d(),U(c,{key:0,class:"text-red-800"})):(d(),U(y,{key:1,class:"text-green-800"}))])):(d(),v("button",{key:1,type:"button",onClick:Y=>r.be_paid=r.be_paid?0:1,class:Z(["text-white w-auto rounded text-xl",r.be_paid?"bg-green-600":"bg-red-600"])},[r.be_paid==0?(d(),U(c,{key:0})):(d(),U(y,{key:1}))],10,ss))])],2)],8,zt)):m("",!0)],64))),128))],512)])])])])]),e("div",as,[e("div",ls,[os,s(t).val||s(t).val1||s(t).val2?(d(),v("div",is,[s(t).val?(d(),v("div",ns," App 1 : "+i(s(t).val_by.username)+" ( "+i(s(t).val_at?s(I)(s(t).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0),s(t).val1?(d(),v("div",ds," App 2 : "+i(s(t).val1_by.username)+" ( "+i(s(t).val1_at?s(I)(s(t).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0),s(t).val2?(d(),v("div",rs," App 3 : "+i(s(t).val2_by.username)+" ( "+i(s(t).val2_at?s(I)(s(t).val2_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0)])):m("",!0)]),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:o[0]||(o[0]=r=>K())},[g(S,{class:"black"})]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:o[1]||(o[1]=r=>u.fnClose())}," Cancel "),u.it_state==1&&("useUtils"in a?a.useUtils:s(C))().checkPermissions(["standby_trx.detail.decide_paid"])&&s(t).val2=="0"?(d(),v("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-green-600 text-white text-xs rounded-sm",onClick:o[2]||(o[2]=F(r=>E("paid"),["prevent"]))}," Paid ")):m("",!0),u.it_state==1&&("useUtils"in a?a.useUtils:s(C))().checkPermissions(["standby_trx.detail.decide_paid"])&&s(t).val2=="0"?(d(),v("button",{key:1,type:"submit",name:"button",class:"w-36 m-1 bg-red-600 text-white text-xs rounded-sm",onClick:o[3]||(o[3]=F(r=>E("nopaid"),["prevent"]))}," NoPaid ")):m("",!0),u.it_state==1?(d(),v("button",{key:2,ref_key:"it_val",ref:q,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:o[4]||(o[4]=F(r=>E(),["prevent"]))},[ee(" Validasi "),s(f)!=""?(d(),v("div",_s,i(s(f)),1)):m("",!0)],512)):m("",!0),u.it_state==0?(d(),v("button",{key:3,ref_key:"it_unval",ref:te,type:"submit",name:"button",class:"w-36 m-1 bg-yellow-600 text-white rounded-sm",onClick:o[5]||(o[5]=F(r=>se(),["prevent"]))},[ee(" Unvalidasi "),s(f)!=""?(d(),v("div",cs,i(s(f)),1)):m("",!0)],512)):m("",!0),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:o[6]||(o[6]=r=>J())},[g($,{class:"black"})])])])])],512)),[[pe,u.show]])}}},Ss=he(vs,[["__scopeId","data-v-a655de4c"]]);export{Ss as default};
