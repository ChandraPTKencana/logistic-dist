import{_ as G}from"./Header.03011c32.js";import{_ as K}from"./client-only.d796d887.js";import{_ as Q}from"./Check.e1435bcb.js";import{_ as W}from"./Times.f09ef1bc.js";import{z as X,r,J as ee,o as x,c as h,h as w,j as te,k as n,a as e,i as N,v as j,F as O,n as F,b as i,t as b,G as U,f as oe,D as se,M as le,l as z,w as J,m as P,E as ne,x as k,y as B,s as ae}from"./entry.1e961bb7.js";import{_ as ie}from"./PrinterEye.7b64ae88.js";import{_ as re}from"./Table2Column.26918171.js";import{_ as ce}from"./PDFView.vue.e00c1f05.js";import{u as E}from"./useMyFetch.a26a0131.js";import{u as de}from"./useDownload.737fa5e3.js";import"./_plugin-vue_export-helper.c27b6911.js";const ue={class:"bg-white w-full flex flex-row flex-wrap mt-1"},_e={class:"p-1 flex"},fe={class:"flex items-center"},me=["onClick"],pe={class:"pl-1 flex flex-wrap items-center"},ve={class:"w-full"},xe={class:"font-bold"},he={key:0,class:"w-full"},we={class:"z-[2] w-full flex flex-col mt-1 relative"},ye={class:"w-full flex justify-end h-4"},ge={class:"bg-white w-full flex flex-col ring-1 ring-gray-600 max-h-40 overflow-auto"},$e={class:"p-1 flex"},ke={class:"flex items-center"},be=["onClick"],Ce=["onClick"],De={class:"pl-1 flex flex-wrap items-center"},Me={class:"w-full"},je={class:"font-bold"},Ve={key:0,class:"w-full"},Se=X({__name:"SelectMulti",props:{arr:{type:Array,required:!0,default:[]},list:{type:Array,required:!1,default:[]}},emits:["input","nextBlur"],setup(S,{emit:C}){const _=S,V=r(null);r([]);const l=r(!1),f=r(""),D=ee(()=>f.value!=""?_.arr.filter(m=>m.name.toLowerCase().includes(f.value.toLowerCase())):_.arr),c=m=>{let a=_.arr.map(p=>p.id).indexOf(m.id);a!=-1&&(_.arr[a].checked=!_.arr[a].checked)};return(m,a)=>{const p=Q,y=W;return x(),h("div",{ref_key:"slt_mul",ref:V,class:"relative",onBlur:a[3]||(a[3]=o=>l.value=!1)},[w(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=o=>N(f)?f.value=o:null),onFocus:a[1]||(a[1]=o=>l.value=!0)},null,544),[[te,n(f)]]),w(e("div",ue,[(x(!0),h(O,null,F(S.arr.filter(o=>o.checked),(o,g)=>(x(),h("div",_e,[e("div",fe,[w(e("button",{type:"button",class:"text-white bg-green-500 text-sm",onClick:M=>c(o)},[i(p)],8,me),[[j,o.checked]])]),e("div",pe,[e("div",ve,[e("span",xe," #"+b(o.name),1)]),o.title?(x(),h("div",he,b(o.title||""),1)):U("",!0)])]))),256))],512),[[j,!n(l)]]),w(e("div",we,[e("div",ye,[e("div",{class:"w-8 bg-gray-600 text-white rounded-t flex items-center justify-center font-bold text-sm cursor-pointer",onClick:a[2]||(a[2]=o=>l.value=!1)},[i(y)])]),e("div",ge,[(x(!0),h(O,null,F(n(D),(o,g)=>(x(),h("div",$e,[e("div",ke,[w(e("button",{type:"button",class:"text-white bg-green-500 text-sm",onClick:M=>c(o)},[i(p)],8,be),[[j,o.checked]]),w(e("button",{type:"button",class:"text-white bg-red-500 text-sm",onClick:M=>c(o)},[i(y)],8,Ce),[[j,!o.checked]])]),e("div",De,[e("div",Me,[e("span",je," #"+b(o.name),1)]),o.title?(x(),h("div",Ve,b(o.title||""),1)):U("",!0)])]))),256))])],512),[[j,n(l)]])],544)}}});const Ae={class:"w-full h-full flex flex-col"},Te={class:"w-full flex grow flex-col overflow-auto h-0 bg-gray-200 justify-center items-center p-2"},Be={class:"bg-white p-2 max-w-[350px] max-h-full overflow-auto"},Ee={action:"#",class:"w-full flex flex-col sm:flex-row flex-wrap text-xs"},Ne={class:"w-full p-1 flex flex-col"},Oe=e("div",{class:"font-bold"}," Tipe ",-1),Ye=e("option",{value:"header"},"Header",-1),Fe=e("option",{value:"detail"},"Detail",-1),Ue=[Ye,Fe],ze={class:"w-full p-1 flex flex-col"},Je=e("div",{class:"font-bold"}," Jenis ",-1),Pe=e("option",{value:""},null,-1),Ie=e("option",{value:"UJ"},"Uang Jalan",-1),Le=e("option",{value:"SB"},"Uang Standby",-1),Ze=[Pe,Ie,Le],qe={class:"w-full sm:w-1/2 p-1 flex flex-col"},He=e("div",{class:"font-bold"}," Tgl Dari ",-1),Re={class:"text-red-500"},Ge={class:"w-full sm:w-1/2 p-1 flex flex-col"},Ke=e("div",{class:"font-bold"}," Tgl Sampai ",-1),Qe={class:"text-red-500"},We={class:"w-full p-1 flex flex-col"},Xe=e("div",{class:"font-bold"}," Lokasi ",-1),et={class:"w-full p-1 flex flex-col"},tt=e("div",{class:"font-bold"}," Nama ",-1),ot={class:"w-full p-1 flex flex-col"},st=e("div",{class:"font-bold"}," No Pol ",-1),lt={class:"w-full p-1 flex items-end justify-end"},nt=e("div",{class:"text-left m-1"},"Download PDF",-1),at=e("div",{class:"text-left m-1"},"Download Excel",-1),wt={__name:"ast_n_driver",async setup(S){let C,_;const{$moment:V}=ae(),l={};l._TimeZoneOffset=new Date().getTimezoneOffset(),l.sort="tanggal:desc";const f=r({}),D=oe("token"),c=r({from:"",to:""}),{data:m}=([C,_]=se(async()=>ne(async()=>{k().loading_full=!0;let t=[],s=[],v=[];const[u,A]=await Promise.all([E("/report/ast_n_driver/load_data",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},retry:0})]);return u.status.value!=="error"&&(t=u.data.value.list_xto,v=u.data.value.list_employee,s=u.data.value.list_vehicle),u.status.value==="error"&&B().trigger(u.error),k().loading_full=!1,{list_xto:t,list_employee:v,list_vehicle:s}},"$Aw9scsfjYZ")),C=await C,_(),C),a=r([]),p=r([]),y=r([]);m.value.list_xto.forEach(t=>{a.value.push({id:t,name:t,title:"",checked:!1})}),m.value.list_employee.forEach(t=>{p.value.push({id:t.id,name:t.name,title:t.role,checked:!1})}),m.value.list_vehicle.forEach(t=>{y.value.push({id:t.id,name:t.no_pol,title:"",checked:!1})});const o=r("header"),g=r(""),M=()=>{l._TimeZoneOffset=new Date().getTimezoneOffset(),l.date_from=c.value.from?V(c.value.from).format("YYYY-MM-DD"):"",l.date_to=c.value.to?V(c.value.to).format("YYYY-MM-DD"):"",l.list_xto=JSON.stringify(a.value.filter(t=>t.checked).map(t=>t.id)),l.list_employee=JSON.stringify(p.value.filter(t=>t.checked).map(t=>t.id)),l.list_vehicle=JSON.stringify(y.value.filter(t=>t.checked).map(t=>t.id)),l.type=o.value,l.jenis=g.value},{downloadFile:I,viewFile:it}=de(),$=r(!1),Y=r({}),L=async()=>{if($.value==!0){$.value=!1;return}M(),k().loading_full=!0;const{data:t,error:s,status:v}=await E("/report/ast_n_driver/pdf_preview",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},params:l,retry:0});if(k().loading_full=!1,v.value==="error"){B().trigger(s);return}Y.value=t.value,$.value=!0},Z=async()=>{M(),k().loading_full=!0;const{data:t,error:s,status:v}=await E("/report/ast_n_driver/excel_download",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},params:l,retry:0});if(k().loading_full=!1,v.value==="error"){B().trigger(s);return}I(t.value)};return(t,s)=>{const v=G,u=le("vue-date-picker"),A=K,T=Se,q=ie,H=re,R=ce;return x(),h(O,null,[e("div",Ae,[i(v,{title:"Report Transaction"}),e("div",Te,[e("div",Be,[e("form",Ee,[e("div",Ne,[Oe,w(e("select",{"onUpdate:modelValue":s[0]||(s[0]=d=>N(o)?o.value=d:null)},Ue,512),[[z,n(o)]])]),e("div",ze,[Je,w(e("select",{"onUpdate:modelValue":s[1]||(s[1]=d=>N(g)?g.value=d:null)},Ze,512),[[z,n(g)]])]),e("div",qe,[He,i(A,null,{default:J(()=>[i(u,{modelValue:n(c).from,"onUpdate:modelValue":s[2]||(s[2]=d=>n(c).from=d),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1}),e("p",Re,b(n(f).date_from),1)]),e("div",Ge,[Ke,i(A,null,{default:J(()=>[i(u,{modelValue:n(c).to,"onUpdate:modelValue":s[3]||(s[3]=d=>n(c).to=d),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1}),e("p",Qe,b(n(f).date_to),1)]),e("div",We,[Xe,i(T,{arr:n(a)},null,8,["arr"])]),e("div",et,[tt,i(T,{arr:n(p)},null,8,["arr"])]),e("div",ot,[st,i(T,{arr:n(y)},null,8,["arr"])]),e("div",lt,[e("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:s[4]||(s[4]=P(d=>L(),["prevent"]))},[e("div",null,[i(q,{class:"text-2xl"})]),nt]),e("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:s[5]||(s[5]=P(d=>Z(),["prevent"]))},[e("div",null,[i(H,{class:"text-2xl"})]),at])])])])])]),i(R,{show:n($),pdfContent:n(Y),onClose:s[6]||(s[6]=d=>$.value=!n($))},null,8,["show","pdfContent"])],64)}}};export{wt as default};
