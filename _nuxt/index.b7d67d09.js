import{_ as Me}from"./Header.71ed6a7a.js";import{_ as Ve,a as Pe}from"./ac_accs.2cc0bb74.js";import{_ as xe}from"./Plus.20e40809.js";import{_ as Be}from"./Edit.468b824a.js";import{_ as qe}from"./Eyes.a945b41c.js";import{_ as Re}from"./Delete.33334e8b.js";import{_ as ze}from"./Signature.51267873.js";import{_ as He}from"./Search.547d4f6a.js";import{_ as Le,a as Ee}from"./Check.35d029cf.js";import{_ as Ye}from"./PopupMini.vue.47efb420.js";import{_ as ye}from"./HeaderPopup.vue.185b5495.js";import{_ as Oe,a as Ke}from"./ToolsPopup.e88d6eb5.js";import{_ as Je}from"./Times.74e0f3d2.js";import{_ as Ge}from"./InputPointFormat.vue.fff0433c.js";import{r as _,f as ne,J as ce,g as _e,o as c,c as u,h as z,v as be,a as e,b as g,k as t,j as le,t as i,G as k,d as ae,F as ee,n as pe,q as V,K as se,l as re,m as fe,x as S,y as X,p as $e,e as ge,s as ke,D as Xe,B as Ze,H as he,I as Qe,i as we,w as We,E as et}from"./entry.d239d820.js";import{u as G}from"./useUtils.807de404.js";import{u as Z}from"./useMyFetch.75d43dc0.js";import{_ as Ae}from"./_plugin-vue_export-helper.c27b6911.js";const F=x=>($e("data-v-539b56dc"),x=x(),ge(),x),tt={class:"box-fixed"},st={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},lt={class:"w-full flex flex-col items-center justify-center grow overflow-auto"},at={class:"w-full flex flex-row flex-wrap"},ot={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},nt=F(()=>e("label",{for:""},"Name",-1)),ct=["disabled"],it={class:"text-red-500"},ut={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},dt=F(()=>e("label",{for:""},"Tipe",-1)),rt=["disabled"],_t={class:"text-red-500"},pt={class:"w-full sm:w-4/12 md:w-2/12 lg:w-1/12 flex flex-col flex-wrap p-1"},ft=F(()=>e("label",{for:""},"Amount",-1)),mt={class:"card-border disabled"},vt={class:"text-red-500"},ht={class:"w-full flex grow p-1 overflow-auto 2xl:overflow-hidden justify-between flex-wrap"},wt={class:"w-full",role:"sticky"},xt={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},yt={class:"sticky -top-1 !z-[2]"},bt=["colspan"],$t={class:"sticky top-7 !z-[2]"},gt={key:0,class:"min-w-[30px] !w-[30px] max-w-[30px]"},kt=F(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),At={key:1,class:"min-w-[30px] !w-[30px] max-w-[30px]"},Ct=F(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),St=F(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),Dt=F(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),jt=F(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),It={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Tt=F(()=>e("br",null,null,-1)),Ft={class:"text-sm"},Ut=F(()=>e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"For",-1)),Nt={ref:"to_move"},Mt=["data-index"],Vt={key:0,class:"tools cell"},Pt={class:"w-full h-full flex items-center justify-center"},Bt=["onClick"],qt={key:1,class:"cell"},Rt={class:"w-full h-full flex items-center justify-center"},zt=["onClick"],Ht=["onClick","disabled"],Lt={class:"w-full h-full flex items-center justify-center"},Et={class:"w-full h-full flex items-center justify-center"},Yt={class:"w-full h-full flex items-center justify-center"},Ot={class:"cell"},Kt={class:"w-full h-full flex items-center justify-center"},Jt=["disabled","onUpdate:modelValue"],Gt={class:"w-full h-full flex items-center justify-center"},Xt={class:"w-full h-full flex items-center justify-center"},Zt=["onUpdate:modelValue","disabled"],Qt=F(()=>e("option",{value:"Supir"},"Supir",-1)),Wt=F(()=>e("option",{value:"Kernet"},"Kernet",-1)),es=[Qt,Wt],ts={key:0},ss={class:"tools cell"},ls={class:"w-full flex items-center justify-end"},as={__name:"standby_mst",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(x){const m=x,{pointFormat:Y}=G(),H={id:-1,name:"",tipe:"",amount:0,details:[]},p=_({...H}),s=ne("token"),D=_({});_([{xdesc:"Gaji Kernet",qty:1,harga:0},{xdesc:"U.Extrafooding",qty:1,harga:2e4}]);const d=_([]),v=_({ordinal:0,id:-1,ac_account_id:"",ac_account_name:"",ac_account_code:"",description:"",amount:0,xfor:"",p_status:""}),C=_(!1),N=()=>{C.value=!1},y=n=>{d.value[a.value].ac_account_id=n.ac_account_id,d.value[a.value].ac_account_code=n.ac_account_code,d.value[a.value].ac_account_name=n.ac_account_name,C.value=!1},w=(n,o)=>{a.value=o,C.value=!0},A=(n,o)=>{d.value[o].ac_account_id="",d.value[o].ac_account_code="",d.value[o].ac_account_name=""},b=async()=>{S().loading_full=!0,D.value={};const n=new FormData;n.append("name",p.value.name),n.append("tipe",p.value.tipe),n.append("amount",p.value.amount),n.append("details",JSON.stringify(d.value));let o="post",B=m.is_copy?0:m.id;B==0||(n.append("id",B),n.append("_method","PUT"));const{data:M,error:T,status:W}=await Z("/standby_mst",{method:o,headers:{Authorization:`Bearer ${s.value}`,Accept:"application/json"},body:n,retry:0});if(S().loading_full=!1,W.value==="error"){X().trigger(T,D);return}if(B<=0)p.value.id=M.value.id,p.value.created_at=M.value.created_at,p.value.updated_at=M.value.updated_at,m.p_data.unshift(p.value);else{p.value.updated_at=M.value.updated_at;let q=m.p_data.map(R=>R.id).indexOf(B);q>=-1&&m.p_data.splice(q,1,{...p.value})}m.fnClose()},j=ce(()=>{let n=0;return d.value.forEach(o=>{o.p_status!="Remove"&&(n+=1*o.amount)}),p.value.amount=n,n}),a=_(-1),I=_(!1),P=_({left:0,top:0}),L=(n,o)=>{a.value=o,I.value=!0,P.value={left:n.clientX,top:n.clientY}},O=()=>{d.value.push({...v.value,p_status:"Add"})},ie=()=>{I.value=!1},K=(n="")=>{if(n=="insert")d.value.splice(a.value,0,{...v.value,p_status:"Add"});else if(n=="delete")d.value[a.value].p_status=="Edit"?d.value[a.value].p_status="Remove":d.value.splice(a.value,1);else if(n=="move_top"){let o=d.value[a.value];d.value.splice(a.value,1),d.value.splice(a.value-1,0,{...o})}else if(n=="move_bottom"){let o=d.value[a.value];d.value.splice(a.value,1),d.value.splice(a.value+1,0,{...o})}I.value=!1},oe=ne("role"),$=ce(()=>p.value.val&&p.value.val1||oe.value=="Logistic"&&p.value.val||oe.value=="PabrikTransport"&&p.value.val1),Q=async()=>{S().loading_full=!0;const{data:n,error:o,status:B}=await Z("/standby_mst",{method:"get",headers:{Authorization:`Bearer ${s.value}`,Accept:"application/json"},params:{id:m.id},retry:0});if(S().loading_full=!1,B.value==="error"){X().trigger(o);return}p.value=n.value.data;let M="Edit";m.is_copy&&(M="Add",p.value.val=0,p.value.val1=0),d.value=n.value.data.details.map(T=>(T.p_status=M,T.key=T.ordinal,T))};return _e(()=>m.show,(n,o)=>{n==!0&&(p.value={...H},d.value=[],m.id!=0&&Q())},{immediate:!0}),(n,o)=>{const B=ye,M=Oe,T=Je,W=Ge,q=xe,R=Ke,ue=Ve;return c(),u(ee,null,[z(e("section",tt,[e("div",null,[g(B,{title:"Form StandBy Mst",fn:x.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",st,[e("div",lt,[e("div",at,[e("div",ot,[nt,z(e("input",{"onUpdate:modelValue":o[0]||(o[0]=h=>t(p).name=h),disabled:t($)},null,8,ct),[[le,t(p).name]]),e("p",it,i(t(D).name),1)]),e("div",ut,[dt,z(e("input",{"onUpdate:modelValue":o[1]||(o[1]=h=>t(p).tipe=h),disabled:t($)},null,8,rt),[[le,t(p).tipe]]),e("p",_t,i(t(D).tipe),1)]),e("div",pt,[ft,e("div",mt,i(t(Y)(t(j))),1),e("p",vt,i(t(D).amount),1)])]),e("div",ht,[e("div",wt,[e("table",xt,[e("thead",null,[e("tr",yt,[e("td",{colspan:t($)?7:9,class:"!bg-slate-800 text-white font-bold"}," Detail ",8,bt)]),e("tr",$t,[t($)?k("",!0):(c(),u("th",gt)),kt,t($)?k("",!0):(c(),u("th",At)),Ct,St,Dt,jt,e("th",It,[ae("Amount "),Tt,ae(),e("span",Ft,"("+i(t(Y)(t(j)))+")",1)]),Ut])]),e("tbody",Nt,[(c(!0),u(ee,null,pe(t(d),(h,E)=>(c(),u(ee,{key:E},[h.p_status!="Remove"?(c(),u("tr",{key:0,"data-index":E},[t($)?k("",!0):(c(),u("td",Vt,[e("div",Pt,[e("button",{type:"button",name:"button",onClick:l=>L(l,E)},[g(M)],8,Bt)])])),e("td",null,i(E+1)+".",1),t($)?k("",!0):(c(),u("td",qt,[e("div",Rt,[h.ac_account_id?(c(),u("button",{key:1,type:"button",onClick:l=>A(l,E),disabled:h.confirm_by},[g(T,{class:"font-bold text-2xl"})],8,Ht)):(c(),u("button",{key:0,type:"button",name:"button",onClick:l=>w(l,E)}," ... ",8,zt))])])),e("td",{class:V(["cell bold",t($)?"unselectable":""])},[e("div",Lt,i(h.ac_account_id),1)],2),e("td",{class:V(["cell bold",t($)?"unselectable":""])},[e("div",Et,i(h.ac_account_code),1)],2),e("td",{class:V(["cell bold",t($)?"unselectable":""])},[e("div",Yt,i(h.ac_account_name),1)],2),e("td",Ot,[e("div",Kt,[z(e("textarea",{disabled:t($),class:"p-1 w-full","onUpdate:modelValue":l=>h.description=l,cols:"7",rows:"2"},null,8,Jt),[[le,h.description]])])]),e("td",{class:V(["cell bold",t($)?"unselectable":""])},[e("div",Gt,[(c(),se(W,{key:E,class:"w-full h-full p-1",type:"text",value:h.amount||0,onInput:l=>h.amount=l,show:x.show,disabled:t($)},null,8,["value","onInput","show","disabled"]))])],2),e("td",{class:V(["cell",t($)?"unselectable":""])},[e("div",Xt,[z(e("select",{"onUpdate:modelValue":l=>h.xfor=l,disabled:t($)},es,8,Zt),[[re,h.xfor]])])],2)],8,Mt)):k("",!0)],64))),128)),t($)?k("",!0):(c(),u("tr",ts,[e("td",ss,[e("button",{type:"button",name:"button",onClick:o[2]||(o[2]=h=>O())},[g(q)])])]))],512)])])])]),e("div",ls,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:o[3]||(o[3]=h=>x.fnClose())}," Cancel "),t($)?k("",!0):(c(),u("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:o[4]||(o[4]=fe(h=>b(),["prevent"]))}," Save "))])])])],512),[[be,x.show]]),g(R,{show:t(I),coor:t(P),fn:ie,data:t(d),data_index:t(a),onReplyAct:o[5]||(o[5]=h=>K(h))},null,8,["show","coor","data","data_index"]),g(ue,{show:t(C),fnClose:N,fnSelect:y},null,8,["show"])],64)}}},os=Ae(as,[["__scopeId","data-v-539b56dc"]]);const U=x=>($e("data-v-aaf71e65"),x=x(),ge(),x),ns={class:"box-fixed"},cs={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},is={class:"w-full flex flex-col items-center grow overflow-auto"},us={class:"w-full flex flex-row flex-wrap"},ds={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},rs=U(()=>e("label",{for:""},"Name",-1)),_s={class:"card-border"},ps={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},fs=U(()=>e("label",{for:""},"Tipe",-1)),ms={class:"card-border"},vs={class:"w-full sm:w-4/12 md:w-2/12 lg:w-1/12 flex flex-col flex-wrap p-1"},hs=U(()=>e("label",{for:""},"Amount",-1)),ws={class:"card-border"},xs={class:"w-full flex grow p-1 overflow-auto 2xl:overflow-hidden justify-between flex-wrap"},ys={class:"w-full",role:"sticky"},bs={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},$s=U(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"7",class:"!bg-slate-800 text-white font-bold"}," Detail PVR ")],-1)),gs={class:"sticky top-8 !z-[2]"},ks=U(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),As=U(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),Cs=U(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),Ss=U(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),Ds=U(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),js={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Is=U(()=>e("br",null,null,-1)),Ts={class:"text-sm"},Fs=U(()=>e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"For",-1)),Us={ref:"to_move"},Ns=["data-index"],Ms={class:"w-full h-full flex items-center justify-center"},Vs={class:"w-full h-full flex items-center justify-center"},Ps={class:"w-full h-full flex items-center justify-center"},Bs={key:0,class:"cell"},qs={class:"w-full h-full flex items-center justify-center"},Rs={class:"w-full h-full flex items-center justify-center"},zs={class:"w-full flex items-center justify-end"},Hs={class:"w-full flex flex-wrap p-3 items-center"},Ls=U(()=>e("div",null," Di Validasi oleh : ",-1)),Es={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},Ys={key:0},Os={key:1},Ks={__name:"standby_mst_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(x){const m=x,{$moment:Y}=ke(),{pointFormat:H}=G(),s=_({...{id:-1,name:"",tipe:"",amount:0,details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:""}}),D=ne("token"),d=_({}),v=_([]),C=async()=>{S().loading_full=!0,d.value={};const A=new FormData;let b="post",j=m.id;j==0||(A.append("id",j),A.append("_method","PUT"));const{data:a,error:I,status:P}=await Z("/standby_mst_validasi",{method:b,headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},body:A,retry:0});if(S().loading_full=!1,P.value==="error"){X().trigger(I,d);return}s.value.val=a.value.val,s.value.val_user=a.value.val_user,s.value.val_by=a.value.val_by,s.value.val_at=a.value.val_at,s.value.val1=a.value.val1,s.value.val1_user=a.value.val1_user,s.value.val1_by=a.value.val1_by,s.value.val1_at=a.value.val1_at;let L=m.p_data.map(O=>O.id).indexOf(m.id);L>=-1&&m.p_data.splice(L,1,{...s.value}),m.fnClose()},N=async()=>{S().loading_full=!0;const{data:A,error:b,status:j}=await Z("/standby_mst",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},params:{id:m.id},retry:0});if(S().loading_full=!1,j.value==="error"){X().trigger(b);return}s.value=A.value.data,v.value=A.value.data.details},y=ce(()=>{let A=0;return v.value.forEach(b=>{b.p_status!="Remove"&&(A+=parseInt(b.amount))}),A}),w=ce(()=>!1);return _e(()=>m.show,(A,b)=>{A==!0&&N()},{immediate:!0}),(A,b)=>{const j=ye;return z((c(),u("section",ns,[e("div",null,[g(j,{title:"Form Master Standby Validation",fn:x.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",cs,[e("div",is,[e("div",us,[e("div",ds,[rs,e("div",_s,i(t(s).name),1)]),e("div",ps,[fs,e("div",ms,i(t(s).tipe),1)]),e("div",vs,[hs,e("div",ws,i(t(H)(t(s).amount||0)),1)])]),e("div",xs,[e("div",ys,[e("table",bs,[e("thead",null,[$s,e("tr",gs,[ks,As,Cs,Ss,Ds,e("th",js,[ae("Amount "),Is,ae(),e("span",Ts,"("+i(t(H)(t(y)))+")",1)]),Fs])]),e("tbody",Us,[(c(!0),u(ee,null,pe(t(v),(a,I)=>(c(),u(ee,{key:I},[a.p_status!="Remove"?(c(),u("tr",{key:0,"data-index":I},[e("td",null,i(I+1)+".",1),e("td",{class:V(["cell bold",t(w)?"unselectable":""])},[e("div",Ms,i(a.ac_account_id),1)],2),e("td",{class:V(["cell bold",t(w)?"unselectable":""])},[e("div",Vs,i(a.ac_account_code),1)],2),e("td",{class:V(["cell bold",t(w)?"unselectable":""])},[e("div",Ps,i(a.ac_account_name),1)],2),t(w)?k("",!0):(c(),u("td",Bs,[e("div",qs,i(a.description),1)])),e("td",{class:V(["cell bold",t(w)?"unselectable":""])},[e("div",Rs,i(t(H)(a.amount||0)),1)],2),e("td",{class:V(["cell",t(w)?"unselectable":""])},i(a.xfor),3)],8,Ns)):k("",!0)],64))),128))],512)])])])]),e("div",zs,[e("div",Hs,[Ls,t(s).val||t(s).val1?(c(),u("div",Es,[t(s).val?(c(),u("div",Ys," App 1 : "+i(t(s).val_by.username)+" ( "+i(t(s).val_at?t(Y)(t(s).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):k("",!0),t(s).val1?(c(),u("div",Os," App 2 : "+i(t(s).val1_by.username)+" ( "+i(t(s).val1_at?t(Y)(t(s).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):k("",!0)])):k("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:b[0]||(b[0]=a=>x.fnClose())}," Cancel "),x.is_view==0?(c(),u("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:b[1]||(b[1]=fe(a=>C(),["prevent"]))}," Validasi ")):k("",!0)])])])],512)),[[be,x.show]])}}},Js=Ae(Ks,[["__scopeId","data-v-aaf71e65"]]),Gs={class:"w-full h-full flex flex-col"},Xs={class:"w-full flex grow flex-col overflow-auto h-0"},Zs={class:"w-full flex"},Qs={action:"#",class:"w-full flex p-1"},Ws={class:"grow"},el=e("div",{class:"font-bold"}," Keyword ",-1),tl={class:"pl-1"},sl=e("div",{class:"font-bold"}," Sort By ",-1),ll=e("option",{value:""},null,-1),al=e("option",{value:"id"},"ID",-1),ol=e("option",{value:"name"},"Name",-1),nl=e("option",{value:"tipe"},"Tipe",-1),cl=[ll,al,ol,nl],il={class:"pl-1"},ul=e("div",{class:"font-bold"}," Sort Order ",-1),dl=e("option",{value:"asc"},"Asc",-1),rl=e("option",{value:"desc"},"Desc",-1),_l=[dl,rl],pl={class:"flex items-end pl-1"},fl={class:"w-full flex justify-center items-center grow h-0 p-1"},ml={key:0,class:""},vl={class:"tacky"},hl=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"App 2"),e("th",null,"ID"),e("th",null,"Name"),e("th",null,"Tipe"),e("th",null,"Amount"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),wl=["onClick"],xl={class:"flex items-center justify-center"},yl={class:"flex items-center justify-center"},bl={class:"bold"},$l={class:"grow mb-5"},Hl={__name:"index",async setup(x){let m,Y;const{$moment:H}=ke(),{pointFormat:p}=G(),s={};s._TimeZoneOffset=new Date().getTimezoneOffset(),s.sort="created_at:desc";const D=ne("token"),{data:d}=([m,Y]=Xe(async()=>et(async()=>{let l=[];S().loading_full=!0;const{data:r,error:J,status:te}=await Z("/standby_msts",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},params:s,retry:0});return S().loading_full=!1,te.value==="error"?(X().trigger(J),{standby_msts:l}):(l=r.value.data,{standby_msts:l})},"$rczbThuP8g")),m=await m,Y(),m),v=_(d.value.standby_msts),C=_(""),N=_({field:"created_at",by:"desc"}),y=_(-1),w=_({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),A=()=>{s.like="",C.value!=""&&(s.like=`id:%${C.value}%,name:%${C.value}%,amount:%${C.value}%`),s.sort="",N.value.field&&(s.sort=N.value.field+":"+N.value.by)},b=_(null),j=async()=>{S().loading_full=!0,w.value.may_get_data=!1,s.page=w.value.page,s.page==1&&(v.value=[]),s.first_row&&delete s.first_row,s.page>1&&(s.first_row=JSON.stringify(v.value[0]));const{data:l,error:r,status:J}=await Z("/standby_msts",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},params:s,retry:0});if(S().loading_full=!1,w.value.may_get_data=!0,J.value==="error"){X().trigger(r);return}w.value.page==1?(v.value=l.value.data,b.value&&(b.value.scrollTop=0)):w.value.page>1&&(v.value=[...v.value,...l.value.data]),l.value.data.length==0&&(w.value.is_last_record=!0)},a=async()=>{if(!w.value.may_get_data)return;let l=b.value;if(l.scrollLeft!=w.value.scrollLeft){w.value.scrollLeft=l.scrollLeft;return}w.value.is_last_record||!(Math.round(l.scrollTop)+l.clientHeight>=l.scrollHeight-1)||(w.value.page++,await j())},I=()=>{w.value.page=1,w.value.is_last_record=!1,A(),j()};Ze();const P=_(!1),L=_(0),O=_(0),ie=()=>{L.value=0,P.value=!0,O.value=!1},{display:K}=he();Qe(he());const oe=()=>{y.value==-1?K({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(L.value=v.value[y.value].id,P.value=!0,O.value=!1)},$=()=>{y.value==-1?K({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(L.value=v.value[y.value].id,P.value=!0,O.value=!0)},Q=_(!1),n=_(0),o=_(!1),B=()=>{y.value==-1?K({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(n.value=v.value[y.value].id,Q.value=!0,o.value=!1)},M=()=>{y.value==-1?K({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(n.value=v.value[y.value].id,Q.value=!0,o.value=!0)},T=_(!1),W=_({}),q=_(!1),R=_(""),ue=async()=>{q.value&&(q.value=!1)},h=()=>{y.value==-1?K({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(R.value="",W.value={id:v.value[y.value].id},q.value=!0)};_e(()=>R.value,l=>{l.trim().length>0?T.value=!0:T.value=!1},{immediate:!1});const E=async()=>{S().loading_full=!0;const l=new FormData;l.append("id",v.value[y.value].id),l.append("deleted_reason",R.value),l.append("_method","DELETE");const{data:r,error:J,status:te}=await Z("/standby_mst",{method:"post",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},body:l,retry:0});if(S().loading_full=!1,te.value==="error"){X().trigger(J);return}v.value.splice(y.value,1),y.value=-1,q.value=!1};return(l,r)=>{const J=Me,te=Pe,Ce=xe,Se=Be,De=qe,je=Re,Ie=ze,Te=He,me=Le,ve=Ee,Fe=Ye,Ue=os,Ne=Js;return c(),u("div",Gs,[g(J,{title:"List Standby"}),e("div",Xs,[e("div",Zs,[("useUtils"in l?l.useUtils:t(G))().checkRole(["Logistic"])?k("",!0):(c(),u("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:r[0]||(r[0]=f=>$())},[g(te)])),("useUtils"in l?l.useUtils:t(G))().checkRole(["Logistic"])?k("",!0):(c(),u("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:r[1]||(r[1]=f=>ie())},[g(Ce)])),("useUtils"in l?l.useUtils:t(G))().checkRole(["Logistic"])?k("",!0):(c(),u("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:r[2]||(r[2]=f=>oe())},[g(Se)])),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:r[3]||(r[3]=f=>M())},[g(De)]),("useUtils"in l?l.useUtils:t(G))().checkRole(["PabrikTransport"])?k("",!0):(c(),u("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:r[4]||(r[4]=f=>h())},[g(je)])),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:r[5]||(r[5]=f=>B())},[g(Ie)])]),e("form",Qs,[e("div",Ws,[el,z(e("input",{class:"",type:"text","onUpdate:modelValue":r[6]||(r[6]=f=>we(C)?C.value=f:null),name:"search",placeholder:"Keyword"},null,512),[[le,t(C)]])]),e("div",tl,[sl,z(e("select",{class:"","onUpdate:modelValue":r[7]||(r[7]=f=>t(N).field=f)},cl,512),[[re,t(N).field]])]),e("div",il,[ul,z(e("select",{class:"","onUpdate:modelValue":r[8]||(r[8]=f=>t(N).by=f)},_l,512),[[re,t(N).by]])]),e("div",pl,[e("button",{class:"",type:"submit",name:"button",onClick:r[9]||(r[9]=fe(f=>I(),["prevent"]))},[g(Te,{class:"text-2xl"})])])]),e("div",fl,[t(v).length==0?(c(),u("div",ml," Maaf Tidak Ada Record ")):(c(),u("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:a},[e("table",vl,[hl,e("tbody",null,[(c(!0),u(ee,null,pe(t(v),(f,de)=>(c(),u("tr",{key:de,onClick:gl=>y.value=de,class:V(t(y)==de?"active":"")},[e("td",null,[e("div",xl,[f.val?(c(),se(ve,{key:1})):(c(),se(me,{key:0}))])]),e("td",null,[e("div",yl,[f.val1?(c(),se(ve,{key:1})):(c(),se(me,{key:0}))])]),e("td",bl,i(f.id),1),e("td",null,i(f.name),1),e("td",null,i(f.tipe),1),e("td",null,i(t(p)(f.amount)),1),e("td",null,i(f.created_at?t(H)(f.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,i(f.updated_at?t(H)(f.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,wl))),128))])])],544))])]),g(Fe,{type:"delete",show:t(q),data:t(W),fnClose:ue,fnConfirm:E,enabledOk:t(T)},{footer:We(()=>[ae(" Masukkan Alasan Penghapusan: "),e("div",$l,[z(e("textarea",{"onUpdate:modelValue":r[10]||(r[10]=f=>we(R)?R.value=f:null)},null,512),[[le,t(R)]])])]),_:1},8,["show","data","enabledOk"]),g(Ue,{show:t(P),fnClose:()=>{P.value=!1},id:t(L),p_data:t(v),is_copy:t(O)},null,8,["show","fnClose","id","p_data","is_copy"]),g(Ne,{show:t(Q),fnClose:()=>{Q.value=!1},id:t(n),p_data:t(v),is_view:t(o)},null,8,["show","fnClose","id","p_data","is_view"])])}}};export{Hl as default};
