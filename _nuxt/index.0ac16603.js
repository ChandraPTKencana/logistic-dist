import ce from"./Header.5020b0cd.js";import me from"./Copy.230f5e44.js";import pe from"./Plus.0c9dd364.js";import fe from"./Edit.df76135b.js";import ve from"./Delete.4a228bd6.js";import ge from"./TableView.e4e13dc3.js";import{_ as ye}from"./PopupMini.vue.973cd684.js";import he from"./user.7e83055f.js";import{_ as be}from"./GAQR.vue.aac1a6a3.js";import{r,f as ke,g as xe,h as we,i as g,j as z,s as De,c as y,a as _,b as c,k as Ce,v as Se,l,m as Ae,n as C,w as H,F as $e,q as Te,x as u,y as S,o as h,d as V,t as J,p as Fe,e as Pe}from"./entry.379a219d.js";import{u as A}from"./useMyFetch.55d023bc.js";import{u as $}from"./useUtils.eceb15d4.js";import{_ as Be}from"./_plugin-vue_export-helper.c27b6911.js";import"./Search.0223cefe.js";import"./Adjust.657141b7.js";import"./TableHeaderEye.5d90e4b0.js";import"./Times.5b5e07d6.js";import"./ClearAll.336687a5.js";import"./client-only.2ddfa6d7.js";import"./ClearEach.32cad27c.js";import"./CaretLeftDoubleBold.3d1b6553.js";import"./CaretLeftBold.5ec3b419.js";import"./CaretRightBold.8c717807.js";import"./CaretRightDoubleBold.6d791ab8.js";import"./Exclamation.86a1538a.js";import"./HeaderPopup.vue.76d2fee8.js";const O=b=>(Fe("data-v-c4e60a73"),b=b(),Pe(),b),Ie={class:"w-full h-full flex flex-col"},Ne={class:"w-full flex grow flex-col overflow-auto h-0"},Oe={class:"w-full flex justify-between flex-wrap"},Ue={class:"grow flex"},je={class:"m-1"},Ee=O(()=>_("option",{value:"active"},"Active",-1)),Me=O(()=>_("option",{value:"nonactive"},"Nonactive",-1)),qe=O(()=>_("option",{value:"all"},"All",-1)),ze=[Ee,Me,qe],He={__name:"index",async setup(b){let k,U;const L=t=>t.is_active==0?"!bg-red-400":"",m=r("active");ke(()=>m.value,t=>{E()},{immediate:!1});const n={};n._TimeZoneOffset=new Date().getTimezoneOffset();const x=xe("token"),{data:o}=([k,U]=we(async()=>Te(async()=>{u().loading_full=!0;const{data:t,error:e,status:i}=await A("/users",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:{filter_status:m},retry:0});return u().loading_full=!1,i.value==="error"?(S().trigger(e),[]):t.value.data},"$4SJ9UL5Y8i")),k=await k,U(),k);r("");const T=r({field:"",by:"desc"}),a=r(-1),d=r({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),F=g(()=>o.value[a.value]),R=()=>{n.like="";let t=JSON.parse(JSON.stringify(u()._tv.global_keyword));t!=""&&(n.like=`id:%${t}%,username:%${t}%`),n.sort="",T.value.field&&(n.sort=T.value.field+":"+T.value.by),n.filter_model=JSON.stringify(u()._tv.filter_model)},Y=t=>{let e=[];return t.permission_group_users&&t.permission_group_users.length>0&&t.permission_group_users.forEach(i=>{e.push(i.permission_group.name)}),e.join(",")};r(null);const j=async()=>{u().loading_full=!0,d.value.may_get_data=!1,n.page=d.value.page,n.page==1&&(o.value=[]),n.filter_status=m.value;const{data:t,error:e,status:i}=await A("/users",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:n,retry:0});if(u().loading_full=!1,d.value.may_get_data=!0,i.value==="error"){S().trigger(e);return}d.value.page==1?o.value=t.value.data:d.value.page>1&&(o.value=[...o.value,...t.value.data]),t.value.data.length==0&&(d.value.is_last_record=!0),u()._tv.filter_box=!1},E=()=>{a.value=-1,d.value.page=1,d.value.is_last_record=!1,R(),j()},f=r(!1),w=r(0),P=r(0),B=r(!1),G=()=>{w.value=0,B.value=!1,P.value=!1,f.value=!0},{display:D}=z();De(z());const Q=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(w.value=o.value[a.value].id,B.value=!1,P.value=!1,f.value=!0)},Z=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(w.value=o.value[a.value].id,B.value=!1,P.value=!0,f.value=!0)},M=r({}),v=r(!1),K=async()=>{v.value&&(v.value=!1)},W=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(M.value={id:o.value[a.value].id},v.value=!0)},X=async()=>{u().loading_full=!0;const t=new FormData;t.append("id",o.value[a.value].id),t.append("_method","DELETE");const{data:e,error:i,status:N}=await A("/user",{method:"post",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},body:t,retry:0});if(u().loading_full=!1,N.value==="error"){S().trigger(i);return}let p={...o.value[a.value]};p.deleted=e.value.deleted,p.deleted_user=e.value.deleted_user,p.deleted_at=e.value.deleted_at,p.deleted_by=e.value.deleted_by,p.deleted_reason=e.value.deleted_reason,m.value!="all"?o.value.splice(a.value,1):o.value.splice(a.value,1,{...p}),a.value=-1,v.value=!1},q=r(""),I=r(!1),ee=async()=>{if(a.value==-1){D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"});return}n.id=o.value[a.value].id,u().loading_full=!0;const{data:t,error:e,status:i}=await A("/ga_qr",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:n,retry:0});if(u().loading_full=!1,i.value==="error"){S().trigger(e);return}q.value=t.value,I.value=!0},te=r([{key:"no",label:"No",isai:!0},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"username",label:"Username",freeze:1,filter_on:1,type:"string",sort:{priority:1,type:"asc"}},{key:"hak_akses",label:"Hak Akses",filter_on:1,type:"string"},{key:"group",label:"Group",filter_on:1,type:"string"},{key:"is_active",label:"Status",filter_on:1,type:"select",select_item:[{k:"1",v:"Ya"},{k:"0",v:"Tidak"}]},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1}]),ae=g(()=>a.value>-1&&[void 0,0].indexOf(F.value.deleted)>-1&&$().checkPermission("user.create")),le=g(()=>["active","nonactive","all"].indexOf(m.value)>-1&&$().checkPermission("user.create")),oe=g(()=>a.value>-1&&[void 0,0].indexOf(F.value.deleted)>-1&&$().checkPermissions(["user.modify"])),se=g(()=>a.value>-1&&$().checkPermission("user.remove")&&[void 0,0].indexOf(F.value.deleted)>-1);return(t,e)=>{const i=ce,N=me,p=pe,re=fe,ne=ve,ie=ge,ue=ye,de=he,_e=be;return h(),y($e,null,[_("div",Ie,[c(i,{title:"List User"}),_("div",Ne,[_("div",Oe,[_("div",Ue,[_("div",je,[Ce(_("select",{class:"","onUpdate:modelValue":e[0]||(e[0]=s=>Ae(m)?m.value=s:null)},ze,512),[[Se,l(m)]])]),l(ae)?(h(),y("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[1]||(e[1]=s=>Z())},[c(N)])):C("",!0),l(le)?(h(),y("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[2]||(e[2]=s=>G())},[c(p)])):C("",!0),l(oe)?(h(),y("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[3]||(e[3]=s=>Q())},[c(re)])):C("",!0),l(se)?(h(),y("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[4]||(e[4]=s=>W())},[c(ne)])):C("",!0),_("button",{type:"button",name:"button",class:"m-1 text-xs",onClick:e[5]||(e[5]=s=>ee())}," SET 2FA ")])]),c(ie,{thead:l(te),selected:l(a),onSetSelected:e[6]||(e[6]=s=>a.value=s),tbody:l(o),fnCallData:j,scrolling:l(d),onSetScrollingPage:e[7]||(e[7]=s=>l(d).page=s),onDoFilter:e[8]||(e[8]=s=>E()),rowBgColor:L},{group:H(({item:s})=>[V(J(Y(s)),1)]),is_active:H(({item:s})=>[V(J(s.is_active?"Aktif":"Tidak Aktif"),1)]),_:2},1032,["thead","selected","tbody","scrolling"])])]),c(ue,{type:"delete",show:l(v),data:l(M),fnClose:K,fnConfirm:X},null,8,["show","data"]),c(de,{show:l(f),fnClose:()=>{f.value=!1},id:l(w),p_data:l(o)},null,8,["show","fnClose","id","p_data"]),c(_e,{show:l(I),fnClose:()=>{I.value=!1},qrCodeUrl:l(q)},null,8,["show","fnClose","qrCodeUrl"])],64)}}},ft=Be(He,[["__scopeId","data-v-c4e60a73"]]);export{ft as default};
