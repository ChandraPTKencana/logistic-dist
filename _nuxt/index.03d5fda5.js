import{_ as oe}from"./Header.5ff8f1db.js";import{_ as le}from"./Plus.f2a88043.js";import{_ as ne}from"./Edit.e1a9cda6.js";import{_ as ie}from"./Delete.9b72cf22.js";import{_ as re}from"./Search.7e31076b.js";import{_ as ue}from"./PopupMini.vue.d8440859.js";import{_ as de}from"./HeaderPopup.vue.eda7ca4c.js";import{r as v,u as q,g as ce,n as y,v as _e,o as $,c as S,a as e,b as x,x as a,s as z,t as m,y as L,z as fe,D as h,E as U,p as O,e as K,U as pe,K as ve,I as me,N as E,O as he,q as we,F as R,A as ge,L as xe,B as ye,C as ke,V as be}from"./entry.817b73b0.js";import{u as B}from"./useMyFetch.c734ddd3.js";import{_ as Y}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.c1b0f44c.js";const A=c=>(O("data-v-ac9f4acf"),c=c(),K(),c),$e={class:"box-fixed"},Se={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},Ae={class:"w-full flex flex-col items-center grow overflow-auto"},De={class:"w-full flex flex-row flex-wrap"},Ce={class:"w-full flex flex-col flex-wrap p-1"},Ue=A(()=>e("label",{for:""},"Username",-1)),Te={class:"text-red-500"},Ie={class:"w-full flex flex-col flex-wrap p-1"},Me=A(()=>e("label",{for:""},"Password",-1)),Fe={class:"text-red-500"},Le={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Be=A(()=>e("label",{for:""},"Hak Akses",-1)),Ve=pe('<option value="PabrikTransport" data-v-ac9f4acf>Pabrik Transport</option><option value="Logistic" data-v-ac9f4acf>Logisitic</option><option value="Finance" data-v-ac9f4acf>Finance</option><option value="MIS" data-v-ac9f4acf>MIS</option><option value="SuperAdmin" data-v-ac9f4acf>SuperAdmin</option>',5),He=[Ve],Pe={class:"text-red-500"},ze={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ne=A(()=>e("label",{for:""},"Status",-1)),je=A(()=>e("option",{value:"1"},"Aktif",-1)),Ee=A(()=>e("option",{value:"0"},"Nonaktif",-1)),Re=[je,Ee],qe={class:"text-red-500"},Oe={class:"w-full flex items-center justify-end"},Ke={__name:"user",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},setup(c){const u=c,D={id:-1,username:"",password:"",hak_akses:"PabrikTransport",is_active:1},s=v({...D}),f=q("token"),p=v({}),_=async()=>{h().loading_full=!0,p.value={};const o=new FormData;o.append("username",s.value.username),s.value.password&&o.append("password",s.value.password),o.append("hak_akses",s.value.hak_akses),o.append("is_active",s.value.is_active);let t="post",l=u.id;l==0||(o.append("id",l),o.append("_method","PUT"));const{data:i,error:b,status:T}=await B("/user",{method:t,headers:{Authorization:`Bearer ${f.value}`,Accept:"application/json"},body:o,retry:0});if(h().loading_full=!1,T.value==="error"){U().trigger(b,p);return}if(u.id<=0)s.value.id=i.value.id,s.value.created_at=i.value.created_at,s.value.updated_at=i.value.updated_at,u.p_data.unshift(s.value);else{s.value.updated_at=i.value.updated_at;let I=u.p_data.map(V=>V.id).indexOf(u.id);I>=-1&&u.p_data.splice(I,1,{...s.value})}u.fnClose()},g=async()=>{h().loading_full=!0;const{data:o,error:t,status:l}=await B("/user",{method:"get",headers:{Authorization:`Bearer ${f.value}`,Accept:"application/json"},params:{id:u.id},retry:0});if(h().loading_full=!1,l.value==="error"){U().trigger(t);return}s.value=o.value.data};return ce(()=>u.show,(o,t)=>{o==!0&&(s.value={...D},p.value={},u.id!=0&&g())},{immediate:!0}),(o,t)=>{const l=de;return y(($(),S("section",$e,[e("div",null,[x(l,{title:"Form User",fn:c.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",Se,[e("div",Ae,[e("div",De,[e("div",Ce,[Ue,y(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=i=>a(s).username=i)},null,512),[[z,a(s).username]]),e("p",Te,m(a(p).username),1)]),e("div",Ie,[Me,y(e("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=i=>a(s).password=i)},null,512),[[z,a(s).password]]),e("p",Fe,m(a(p).password),1)]),e("div",Le,[Be,y(e("select",{"onUpdate:modelValue":t[2]||(t[2]=i=>a(s).hak_akses=i)},He,512),[[L,a(s).hak_akses]]),e("p",Pe,m(a(p).hak_akses),1)]),e("div",ze,[Ne,y(e("select",{"onUpdate:modelValue":t[3]||(t[3]=i=>a(s).is_active=i)},Re,512),[[L,a(s).is_active]]),e("p",qe,m(a(p).is_active),1)])])]),e("div",Oe,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:t[4]||(t[4]=i=>c.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:t[5]||(t[5]=fe(i=>_(),["prevent"]))}," Save ")])])])],512)),[[_e,c.show]])}}},Ye=Y(Ke,[["__scopeId","data-v-ac9f4acf"]]);const w=c=>(O("data-v-37a4ae3a"),c=c(),K(),c),Ze={class:"w-full h-full flex flex-col"},Je={class:"w-full flex grow flex-col overflow-auto h-0"},Qe={class:"w-full flex"},Ge={class:"w-full flex p-1"},We={class:"grow"},Xe=w(()=>e("div",{class:"font-bold"}," Keyword ",-1)),et={class:"pl-1"},tt=w(()=>e("div",{class:"font-bold"}," Sort By ",-1)),at=w(()=>e("option",{value:""},null,-1)),st=w(()=>e("option",{value:"username"},"Username",-1)),ot=w(()=>e("option",{value:"hak_akses"},"Hak Akses",-1)),lt=w(()=>e("option",{value:"is_active"},"Status",-1)),nt=[at,st,ot,lt],it={class:"pl-1"},rt=w(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),ut=w(()=>e("option",{value:"asc"},"Asc",-1)),dt=w(()=>e("option",{value:"desc"},"Desc",-1)),ct=[ut,dt],_t={class:"flex items-end pl-1"},ft={class:"w-full flex justify-center items-center grow h-0 p-1"},pt={key:0,class:""},vt={class:"tacky"},mt=w(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"Username"),e("th",null,"Hak Akses"),e("th",null,"Status"),e("th",null,"Tanggal Dibuat"),e("th",null,"Tanggal Diubah")])],-1)),ht=["onClick"],wt={class:"bold"},gt={__name:"index",async setup(c){let u,D;const{$moment:s}=ke(),f={};f._TimeZoneOffset=new Date().getTimezoneOffset();const p=q("token"),{data:_}=([u,D]=ve(async()=>xe(async()=>{h().loading_full=!0;const{data:r,error:n,status:k}=await B("/users",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:f,retry:0});return h().loading_full=!1,k.value==="error"?(U().trigger(n),[]):r.value.data},"$4SJ9UL5Y8i")),u=await u,D(),u),g=v(""),o=v({field:"",by:"desc"}),t=v(-1),l=v({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),i=()=>{f.like="",g.value!=""&&(f.like=`id:%${g.value}%,username:%${g.value}%`),f.sort="",o.value.field&&(f.sort=o.value.field+":"+o.value.by)},b=v(null),T=async()=>{h().loading_full=!0,l.value.may_get_data=!1,f.page=l.value.page,f.page==1&&(_.value=[]);const{data:r,error:n,status:k}=await be("/users",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:f,retry:0},"$LZQttUfkIg");if(h().loading_full=!1,l.value.may_get_data=!0,k.value==="error"){U().trigger(n);return}l.value.page==1?(_.value=r.value.data,b.value&&(b.value.scrollTop=0)):l.value.page>1&&(_.value=[..._.value,...r.value.data]),r.value.data.length==0&&(l.value.is_last_record=!0)},I=async()=>{if(!l.value.may_get_data)return;let r=b.value;if(r.scrollLeft!=l.value.scrollLeft){l.value.scrollLeft=r.scrollLeft;return}l.value.is_last_record||!(Math.round(r.scrollTop)+r.clientHeight>=r.scrollHeight-1)||(l.value.page++,await T())},V=()=>{l.value.page=1,l.value.is_last_record=!1,i(),T()};me();const M=v(!1),H=v(0),Z=()=>{H.value=0,M.value=!0},{display:N}=E();he(E());const J=()=>{t.value==-1?N({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(H.value=_.value[t.value].id,M.value=!0)},j=v({}),C=v(!1),Q=async()=>{C.value&&(C.value=!1)},G=()=>{t.value==-1?N({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(j.value={id:_.value[t.value].id},C.value=!0)},W=async()=>{h().loading_full=!0;const r=new FormData;r.append("id",_.value[t.value].id),r.append("_method","DELETE");const{data:n,error:k,status:P}=await B("/user",{method:"post",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},body:r,retry:0});if(h().loading_full=!1,P.value==="error"){U().trigger(k);return}_.value.splice(t.value,1),t.value=-1,C.value=!1};return(r,n)=>{const k=oe,P=le,X=ne,ee=ie,te=re,ae=ue,se=Ye;return $(),S(R,null,[e("div",Ze,[x(k,{title:"List User"}),e("div",Je,[e("div",Qe,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:n[0]||(n[0]=d=>Z())},[x(P)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:n[1]||(n[1]=d=>J())},[x(X)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:n[2]||(n[2]=d=>G())},[x(ee)])]),e("div",Ge,[e("div",We,[Xe,y(e("input",{class:"",type:"text","onUpdate:modelValue":n[3]||(n[3]=d=>we(g)?g.value=d:null),name:"search",placeholder:"Keyword"},null,512),[[z,a(g)]])]),e("div",et,[tt,y(e("select",{class:"","onUpdate:modelValue":n[4]||(n[4]=d=>a(o).field=d)},nt,512),[[L,a(o).field]])]),e("div",it,[rt,y(e("select",{class:"","onUpdate:modelValue":n[5]||(n[5]=d=>a(o).by=d)},ct,512),[[L,a(o).by]])]),e("div",_t,[e("button",{class:"",type:"button",name:"button",onClick:n[6]||(n[6]=d=>V())},[x(te,{class:"text-2xl"})])])]),e("div",ft,[a(_).length==0?($(),S("div",pt," Maaf Tidak Ada Record ")):($(),S("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:I},[e("table",vt,[mt,e("tbody",null,[($(!0),S(R,null,ge(a(_),(d,F)=>($(),S("tr",{key:F,onClick:xt=>t.value=F,class:ye(a(t)==F?"active":"")},[e("td",null,m(F+1)+".",1),e("td",wt,m(d.username),1),e("td",null,m(d.hak_akses),1),e("td",null,m(d.is_active?"Aktif":"Nonaktif"),1),e("td",null,m(a(s)(d.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,m(a(s)(d.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,ht))),128))])])],544))])])]),x(ae,{type:"delete",show:a(C),data:a(j),fnClose:Q,fnConfirm:W},null,8,["show","data"]),x(se,{show:a(M),fnClose:()=>{M.value=!1},id:a(H),p_data:a(_)},null,8,["show","fnClose","id","p_data"])],64)}}},Mt=Y(gt,[["__scopeId","data-v-37a4ae3a"]]);export{Mt as default};
