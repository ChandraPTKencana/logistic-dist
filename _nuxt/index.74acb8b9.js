import{_ as ie}from"./Header.5dfdd404.js";import{_ as ue}from"./Plus.c37e71b9.js";import{_ as de}from"./Edit.a6f6ff95.js";import{_ as ce}from"./Delete.9289958d.js";import{_ as _e}from"./useUtils.5b5c81d3.js";import{_ as fe}from"./PopupMini.vue.66887c13.js";import{_ as pe}from"./HeaderPopup.vue.8b7b8cc9.js";import{r as _,f as J,g as Y,h as x,v as me,o as D,c as C,a as e,b as g,k as a,j as L,t as b,l as O,m as ve,x as m,y as T,p as Z,e as G,D as he,B as ye,H as R,I as ge,i as q,F as K,n as we,w as be,E as xe,q as ke,d as $e,s as De}from"./entry.3662c5b4.js";import{u as M}from"./useMyFetch.25b712a1.js";import{_ as Q}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.ae2e5856.js";const F=d=>(Z("data-v-2b5c7f91"),d=d(),G(),d),Ce={class:"box-fixed"},Se={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},Ae={class:"w-full flex flex-col items-center grow overflow-auto"},Te={class:"w-full flex flex-row flex-wrap"},Me={class:"w-full flex flex-col flex-wrap p-1"},Be=F(()=>e("label",{for:""},"Nama",-1)),je={class:"text-red-500"},Ie={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ee=F(()=>e("label",{for:""},"Jabatan",-1)),Fe=F(()=>e("option",{value:"Supir"},"Supir",-1)),Ve=F(()=>e("option",{value:"Kernet"},"Kernet",-1)),He=[Fe,Ve],Ne={class:"text-red-500"},ze={class:"w-full flex items-center justify-end"},Le={__name:"employee",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},setup(d){const u=d,S={id:-1,name:"",role:"Supir"},r=_({...S}),f=J("token"),v=_({}),c=async()=>{m().loading_full=!0,v.value={};const n=new FormData;n.append("name",r.value.name),n.append("role",r.value.role);let t="post",l=u.id;l==0||(n.append("id",l),n.append("_method","PUT"));const{data:p,error:k,status:B}=await M("/employee",{method:t,headers:{Authorization:`Bearer ${f.value}`,Accept:"application/json"},body:n,retry:0});if(m().loading_full=!1,B.value==="error"){T().trigger(k,v);return}if(r.value.updated_at=p.value.updated_at,u.id<=0)r.value.id=p.value.id,r.value.created_at=p.value.created_at,u.p_data.unshift(r.value);else{let j=u.p_data.map(V=>V.id).indexOf(u.id);j>=-1&&u.p_data.splice(j,1,{...r.value})}u.fnClose()},y=async()=>{m().loading_full=!0;const{data:n,error:t,status:l}=await M("/employee",{method:"get",headers:{Authorization:`Bearer ${f.value}`,Accept:"application/json"},params:{id:u.id},retry:0});if(m().loading_full=!1,l.value==="error"){T().trigger(t);return}r.value=n.value.data};return Y(()=>u.show,(n,t)=>{n==!0&&(r.value={...S},v.value={},u.id!=0&&y())},{immediate:!0}),(n,t)=>{const l=pe;return x((D(),C("section",Ce,[e("div",null,[g(l,{title:"Form Employee",fn:d.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",Se,[e("div",Ae,[e("div",Te,[e("div",Me,[Be,x(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=p=>a(r).name=p)},null,512),[[L,a(r).name]]),e("p",je,b(a(v).name),1)]),e("div",Ie,[Ee,x(e("select",{"onUpdate:modelValue":t[1]||(t[1]=p=>a(r).role=p)},He,512),[[O,a(r).role]]),e("p",Ne,b(a(v).role),1)])])]),e("div",ze,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:t[2]||(t[2]=p=>d.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:t[3]||(t[3]=ve(p=>c(),["prevent"]))}," Save ")])])])],512)),[[me,d.show]])}}},Oe=Q(Le,[["__scopeId","data-v-2b5c7f91"]]);const h=d=>(Z("data-v-7b1bb1fe"),d=d(),G(),d),Pe={class:"w-full h-full flex flex-col"},Ue={class:"w-full flex grow flex-col overflow-auto h-0"},Re={class:"w-full flex"},qe={class:"w-full flex p-1"},Ke={class:"grow"},Je=h(()=>e("div",{class:"font-bold"}," Keyword ",-1)),Ye={class:"pl-1"},Ze=h(()=>e("div",{class:"font-bold"}," Sort By ",-1)),Ge=h(()=>e("option",{value:""},null,-1)),Qe=h(()=>e("option",{value:"name"},"Nama",-1)),We=h(()=>e("option",{value:"role"},"Jabatan",-1)),Xe=[Ge,Qe,We],et={class:"pl-1"},tt=h(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),at=h(()=>e("option",{value:"asc"},"Asc",-1)),ot=h(()=>e("option",{value:"desc"},"Desc",-1)),lt=[at,ot],st={class:"flex items-end pl-1"},nt={class:"w-full flex justify-center items-center grow h-0 p-1"},rt={key:0,class:""},it={class:"tacky"},ut=h(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"Nama"),e("th",null,"Jabatan"),e("th",null,"Tanggal Dibuat"),e("th",null,"Tanggal Diubah")])],-1)),dt=["onClick"],ct={class:"bold"},_t={class:"grow mb-5"},ft={__name:"index",async setup(d){let u,S;const{$moment:r}=De(),f={};f._TimeZoneOffset=new Date().getTimezoneOffset();const v=J("token"),{data:c}=([u,S]=he(async()=>xe(async()=>{m().loading_full=!0;const{data:s,error:o,status:w}=await M("/employees",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:f,retry:0});return m().loading_full=!1,w.value==="error"?(T().trigger(o),[]):s.value.data},"$p5jj5crAgd")),u=await u,S(),u),y=_(""),n=_({field:"",by:"desc"}),t=_(-1),l=_({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),p=()=>{f.like="",y.value!=""&&(f.like=`id:%${y.value}%,no_pol:%${y.value}%`),f.sort="",n.value.field&&(f.sort=n.value.field+":"+n.value.by)},k=_(null),B=async()=>{m().loading_full=!0,l.value.may_get_data=!1,f.page=l.value.page,f.page==1&&(c.value=[]);const{data:s,error:o,status:w}=await M("/employees",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:f,retry:0});if(m().loading_full=!1,l.value.may_get_data=!0,w.value==="error"){T().trigger(o);return}l.value.page==1?(c.value=s.value.data,k.value&&(k.value.scrollTop=0)):l.value.page>1&&(c.value=[...c.value,...s.value.data]),s.value.data.length==0&&(l.value.is_last_record=!0)},j=async()=>{if(!l.value.may_get_data)return;let s=k.value;if(s.scrollLeft!=l.value.scrollLeft){l.value.scrollLeft=s.scrollLeft;return}l.value.is_last_record||!(Math.round(s.scrollTop)+s.clientHeight>=s.scrollHeight-1)||(l.value.page++,await B())},V=()=>{l.value.page=1,l.value.is_last_record=!1,p(),B()};ye();const I=_(!1),H=_(0),W=()=>{H.value=0,I.value=!0},{display:P}=R();ge(R());const X=()=>{t.value==-1?P({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(H.value=c.value[t.value].id,I.value=!0)},N=_(!1),U=_({}),A=_(!1),$=_(""),ee=async()=>{A.value&&(A.value=!1)},te=()=>{t.value==-1?P({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):($.value="",U.value={id:c.value[t.value].id},A.value=!0)};Y(()=>$.value,s=>{s.trim().length>0?N.value=!0:N.value=!1},{immediate:!1});const ae=async()=>{m().loading_full=!0;const s=new FormData;s.append("id",c.value[t.value].id),s.append("deleted_reason",$.value),s.append("_method","DELETE");const{data:o,error:w,status:z}=await M("/employee",{method:"post",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},body:s,retry:0});if(m().loading_full=!1,z.value==="error"){T().trigger(w);return}c.value.splice(t.value,1),t.value=-1,A.value=!1};return(s,o)=>{const w=ie,z=ue,oe=de,le=ce,se=_e,ne=fe,re=Oe;return D(),C(K,null,[e("div",Pe,[g(w,{title:"List Employee"}),e("div",Ue,[e("div",Re,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:o[0]||(o[0]=i=>W())},[g(z)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:o[1]||(o[1]=i=>X())},[g(oe)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:o[2]||(o[2]=i=>te())},[g(le)])]),e("div",qe,[e("div",Ke,[Je,x(e("input",{class:"",type:"text","onUpdate:modelValue":o[3]||(o[3]=i=>q(y)?y.value=i:null),name:"search",placeholder:"Keyword"},null,512),[[L,a(y)]])]),e("div",Ye,[Ze,x(e("select",{class:"","onUpdate:modelValue":o[4]||(o[4]=i=>a(n).field=i)},Xe,512),[[O,a(n).field]])]),e("div",et,[tt,x(e("select",{class:"","onUpdate:modelValue":o[5]||(o[5]=i=>a(n).by=i)},lt,512),[[O,a(n).by]])]),e("div",st,[e("button",{class:"",type:"button",name:"button",onClick:o[6]||(o[6]=i=>V())},[g(se,{class:"text-2xl"})])])]),e("div",nt,[a(c).length==0?(D(),C("div",rt," Maaf Tidak Ada Record ")):(D(),C("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:k,onScroll:j},[e("table",it,[ut,e("tbody",null,[(D(!0),C(K,null,we(a(c),(i,E)=>(D(),C("tr",{key:E,onClick:pt=>t.value=E,class:ke(a(t)==E?"active":"")},[e("td",null,b(E+1)+".",1),e("td",ct,b(i.name),1),e("td",null,b(i.role),1),e("td",null,b(a(r)(i.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,b(a(r)(i.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,dt))),128))])])],544))])])]),g(ne,{type:"delete",show:a(A),data:a(U),fnClose:ee,fnConfirm:ae,enabledOk:a(N)},{footer:be(()=>[$e(" Masukkan Alasan Penghapusan: "),e("div",_t,[x(e("textarea",{"onUpdate:modelValue":o[7]||(o[7]=i=>q($)?$.value=i:null)},null,512),[[L,a($)]])])]),_:1},8,["show","data","enabledOk"]),g(re,{show:a(I),fnClose:()=>{I.value=!1},id:a(H),p_data:a(c)},null,8,["show","fnClose","id","p_data"])],64)}}},Ct=Q(ft,[["__scopeId","data-v-7b1bb1fe"]]);export{Ct as default};
