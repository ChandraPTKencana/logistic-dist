import{_ as M}from"./_plugin-vue_export-helper.c27b6911.js";import{o as f,c as p,a as e,f as F,r as _,g as j,h as y,v as K,b as D,i as R,j as O,k as u,l as I,m as U,F as H,n as E,q as J,t as g,p as P,e as Z,x as q,y as G}from"./entry.088021ef.js";import{_ as Q}from"./HeaderPopup.vue.910fdc26.js";import{_ as W}from"./Search.89db18e8.js";import{u as X}from"./useUtils.b741a801.js";import{u as Y}from"./useMyFetch.38ca3367.js";const ee={name:"MaterialSymbolsContentCopy"},te={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},oe=e("path",{fill:"currentColor",d:"M9 18q-.825 0-1.412-.587T7 16V4q0-.825.588-1.412T9 2h9q.825 0 1.413.588T20 4v12q0 .825-.587 1.413T18 18zm-4 4q-.825 0-1.412-.587T3 20V6h2v14h11v2z"},null,-1),se=[oe];function ae(r,v,b,C,c,i){return f(),p("svg",te,se)}const ze=M(ee,[["render",ae]]);const n=r=>(P("data-v-6c303ced"),r=r(),Z(),r),le={class:"box-fixed"},ce={action:"#",class:"w-full flex p-1"},ne={class:"grow"},re=n(()=>e("div",{class:"font-bold"}," Keyword ",-1)),ie={class:"pl-1"},ue=n(()=>e("div",{class:"font-bold"}," Sort By ",-1)),de=n(()=>e("option",{value:"AccountID"},"ID",-1)),_e=n(()=>e("option",{value:"AccountCode"},"Code",-1)),fe=n(()=>e("option",{value:"AccountName"},"Nama",-1)),pe=[de,_e,fe],ve={class:"pl-1"},me=n(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),he=n(()=>e("option",{value:"asc"},"Asc",-1)),we=n(()=>e("option",{value:"desc"},"Desc",-1)),ye=[he,we],ge={class:"flex items-end pl-1"},ke={class:"w-full flex justify-center items-center grow h-0 p-1"},xe={key:0,class:""},Se={class:"tacky w-full"},be=n(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No."),e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"ID"),e("th",null,"Code"),e("th",null,"Name")])],-1)),Ce=["onClick"],$e={class:"bold"},Te={class:"whitespace-normal break-words"},Ae={class:"flex",style:{"justify-content":"end",padding:"5px"}},De={__name:"ac_accs",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1}},setup(r){const v=r,{countClickListFn:b}=X(),C=F("token"),c=_([]),i=_(""),d=_({field:"AccountID",by:"desc"}),m=_(-1),s=_({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),a={};a._TimeZoneOffset=new Date().getTimezoneOffset();const L=()=>{a.like="",i.value!=""&&(a.like=`AccountID:%${i.value}%,AccountCode:%${i.value}%,AccountName:%${i.value}%`),a.sort="",d.value.field&&(a.sort=d.value.field+":"+d.value.by)},h=_(null),$=async()=>{q().loading_full=!0,s.value.may_get_data=!1,a.page=s.value.page,a.page==1&&(c.value=[]),a.first_row&&delete a.first_row,a.page>1&&(a.first_row=JSON.stringify(c.value[0]));const{data:t,error:o,status:S}=await Y("/ac_accounts",{method:"get",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},params:a,retry:0});if(q().loading_full=!1,s.value.may_get_data=!0,S.value==="error"){G().trigger(o);return}s.value.page==1?(c.value=t.value.data,h.value&&(h.value.scrollTop=0)):s.value.page>1&&(c.value=[...c.value,...t.value.data]),t.value.data.length==0&&(s.value.is_last_record=!0)},N=async()=>{if(!s.value.may_get_data)return;let t=h.value;if(t.scrollLeft!=s.value.scrollLeft){s.value.scrollLeft=t.scrollLeft;return}s.value.is_last_record||!(Math.round(t.scrollTop)+t.clientHeight>=t.scrollHeight-1)||(s.value.page++,await $())},k=()=>{s.value.page=1,s.value.is_last_record=!1,L(),$()},T=()=>{m.value>-1?v.fnSelect(c.value[m.value]):v.fnSelect({ac_account_id:"",ac_account_code:"",ac_account_name:""})},V=t=>{b(t,()=>{m.value=t},T)},A=_(null);let x=null;const B=t=>{x&&clearTimeout(x),x=setTimeout(()=>{k()},500)};return j(()=>v.show,(t,o)=>{t==!0&&(k(),setTimeout(()=>{A.value.focus()},100))},{immediate:!0}),(t,o)=>{const S=Q,z=W;return y((f(),p("section",le,[e("div",null,[D(S,{title:"Search And Select Ac Account",fn:r.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",ce,[e("div",ne,[re,y(e("input",{ref_key:"ref_keyword",ref:A,class:"",type:"text","onUpdate:modelValue":o[0]||(o[0]=l=>R(i)?i.value=l:null),name:"search",placeholder:"Keyword",onKeyup:o[1]||(o[1]=l=>B())},null,544),[[O,u(i)]])]),e("div",ie,[ue,y(e("select",{class:"","onUpdate:modelValue":o[2]||(o[2]=l=>u(d).field=l)},pe,512),[[I,u(d).field]])]),e("div",ve,[me,y(e("select",{class:"","onUpdate:modelValue":o[3]||(o[3]=l=>u(d).by=l)},ye,512),[[I,u(d).by]])]),e("div",ge,[e("button",{class:"",type:"submit",name:"button",onClick:o[4]||(o[4]=U(l=>k(),["prevent"]))},[D(z,{class:"text-2xl"})])])]),e("div",ke,[u(c).length==0?(f(),p("div",xe," Maaf Tidak Ada Record ")):(f(),p("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:h,onScroll:N},[e("table",Se,[be,e("tbody",null,[(f(!0),p(H,null,E(u(c),(l,w)=>(f(),p("tr",{key:w,onClick:Ie=>V(w),class:J(u(m)==w?"active":"")},[e("td",null,g(w+1)+".",1),e("td",$e,g(l.ac_account_id),1),e("td",null,g(l.ac_account_code),1),e("td",Te,g(l.ac_account_name),1)],10,Ce))),128))])])],544))]),e("div",Ae,[e("button",{onClick:o[5]||(o[5]=l=>T()),class:"w-36 m-1 bg-blue-600 text-white rounded-sm"}," Select ")])])],512)),[[K,r.show]])}}},Fe=M(De,[["__scopeId","data-v-6c303ced"]]);export{Fe as _,ze as a};
