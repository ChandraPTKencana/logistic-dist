import he from"./Header.f4bd81f9.js";import we from"./Plus.96388b84.js";import xe from"./Edit.7a14f9d1.js";import De from"./Eyes.f371e3b3.js";import Se from"./Delete.d729cd52.js";import Ae from"./Signature.c82d7fc7.js";import Ce from"./Line.48f5c11a.js";import Pe from"./Check.718be30a.js";import Oe from"./TypeIcon.e4d73cd5.js";import $e from"./TableView.690542a7.js";import{_ as Te}from"./PopupMini.vue.1f68efd6.js";import Me from"./salary_bonus.2c13f659.js";import Ne from"./salary_bonus_validasi.a0259e88.js";import{r as n,f as G,g as Be,h as Fe,i as P,j as K,s as Ie,c as h,b as d,a as _,k as Z,v as Ve,l,m as Q,n as O,w as m,q as Ue,x as c,y as z,o as u,z as w,d as x,t as D,A as je}from"./entry.5eaee47b.js";import{u as k}from"./useUtils.478d066b.js";import{u as J}from"./useMyFetch.c1c4d34c.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./DocJPEG.c1ae13fe.js";import"./DocJPG.084863b1.js";import"./DocPNG.f24dd070.js";import"./DocPDF.a0a80fd7.js";import"./Search.839158cd.js";import"./Adjust.5ed7e4c7.js";import"./TableHeaderEye.8967b51d.js";import"./Times.83c50a35.js";import"./ClearAll.045a875a.js";import"./client-only.4c910340.js";import"./ClearEach.f5c9b33c.js";import"./CaretLeftDoubleBold.2178a14d.js";import"./CaretLeftBold.3edb8e7b.js";import"./CaretRightBold.e80618c4.js";import"./CaretRightDoubleBold.74f94a25.js";import"./Exclamation.ae96152b.js";import"./HeaderPopup.vue.4d128728.js";import"./WidthMiniList.vue.d5600cde.js";import"./WidthMiniPart.vue.ef7918cb.js";import"./InputPointFormat.vue.7469d383.js";import"./AttachmentSingle.ac5477cb.js";import"./PDFJsView.173dfc94.js";const Ee={class:"w-full h-full flex flex-col"},He={class:"w-full flex grow flex-col overflow-auto h-0"},ze={class:"w-full flex justify-between flex-wrap"},Je={class:"grow flex"},Le={class:"m-1"},Re=_("option",{value:"undone"},"Undone",-1),Ye=_("option",{value:"done"},"Done",-1),qe=_("option",{value:"deleted"},"Trash",-1),Ge=_("option",{value:"all"},"All",-1),Ke=[Re,Ye,qe,Ge],Ze={style:{"min-width":"350px","text-wrap":"wrap"}},Qe={class:"grow mb-5"},Ut={__name:"index",async setup(We){let $,L;const W=t=>t.deleted==1?"!bg-red-400":t.val1>0&&t.val2>0&&t.val3>0&&t.salary_paid_id>0?"!bg-blue-300":"",v=n("undone");G(()=>v.value,t=>{Y()},{immediate:!1});const r={};r._TimeZoneOffset=new Date().getTimezoneOffset(),r.sort="created_at:desc";const B=Be("token"),{data:X}=([$,L]=Fe(async()=>Ue(async()=>{let t=[];c().loading_full=!0;const{data:a,error:b,status:C}=await J("/salary_bonuses",{method:"get",headers:{Authorization:`Bearer ${B.value}`,Accept:"application/json"},params:{filter_status:v},retry:0});return c().loading_full=!1,C.value==="error"?(z().trigger(b),{salary_bonuses:t}):(t=a.value.data,{salary_bonuses:t})},"$tya7A7egnO")),$=await $,L(),$),s=n(X.value.salary_bonuses);n("");const F=n({field:"created_at",by:"desc"}),o=n(-1),y=P(()=>s.value[o.value]),p=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),ee=()=>{r.like="";let t=JSON.parse(JSON.stringify(c()._tv.global_keyword));t!=""&&(r.like=`id:%${t}%,employee_name:%${t}%`),r.sort="",F.value.field&&(r.sort=F.value.field+":"+F.value.by),r.filter_model=JSON.stringify(c()._tv.filter_model)},R=async()=>{c().loading_full=!0,p.value.may_get_data=!1,r.page=p.value.page,r.page==1&&(s.value=[]),r.first_row&&delete r.first_row,r.page>1&&(r.first_row=JSON.stringify(s.value[0])),r.filter_status=v.value;const{data:t,error:a,status:b}=await J("/salary_bonuses",{method:"get",headers:{Authorization:`Bearer ${B.value}`,Accept:"application/json"},params:r,retry:0});if(c().loading_full=!1,p.value.may_get_data=!0,b.value==="error"){z().trigger(a);return}p.value.page==1?s.value=t.value.data:p.value.page>1&&(s.value=[...s.value,...t.value.data]),t.value.data.length==0&&(p.value.is_last_record=!0),c()._tv.filter_box=!1},Y=()=>{o.value=-1,o.value=-1,p.value.page=1,p.value.is_last_record=!1,ee(),R()},T=n(!1),I=n(0),V=n(0),S=n(!1),te=()=>{I.value=0,S.value=!1,V.value=!1,T.value=!0},{display:M}=K();Ie(K());const ae=()=>{o.value==-1?M({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(I.value=s.value[o.value].id,S.value=!1,V.value=!1,T.value=!0)},N=n(!1),U=n(0),le=()=>{o.value==-1?M({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(U.value=s.value[o.value].id,S.value=!1,N.value=!0)},oe=()=>{o.value==-1?M({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(U.value=s.value[o.value].id,S.value=!0,N.value=!0)},j=n(!1),q=n({}),A=n(!1),g=n(""),se=async()=>{A.value&&(A.value=!1)},ne=()=>{o.value==-1?M({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(g.value="",q.value={id:s.value[o.value].id},A.value=!0)};G(()=>g.value,t=>{t.trim().length>0?j.value=!0:j.value=!1},{immediate:!1});const re=async()=>{c().loading_full=!0;const t=new FormData;t.append("id",s.value[o.value].id),t.append("deleted_reason",g.value),t.append("_method","DELETE");const{data:a,error:b,status:C}=await J("/salary_bonus",{method:"post",headers:{Authorization:`Bearer ${B.value}`,Accept:"application/json"},body:t,retry:0});if(c().loading_full=!1,C.value==="error"){z().trigger(b);return}let f={...s.value[o.value]};f.deleted=a.value.deleted,f.deleted_user=a.value.deleted_user,f.deleted_at=a.value.deleted_at,f.deleted_by=a.value.deleted_by,f.deleted_reason=a.value.deleted_reason,v.value!="all"?s.value.splice(o.value,1):s.value.splice(o.value,1,{...f}),o.value=-1,A.value=!1},ie=n([{key:"no",label:"No",isai:!0},{key:"val",label:"APP",childs:[{key:"val1",label:"Staff",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val2",label:"SPV",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val3",label:"MGR",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]}]},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"tanggal",label:"Tanggal",type:"date",dateformat:"DD-MM-Y",filter_on:1,sort:{priority:1,type:"desc"}},{key:"type",label:"Tipe",filter_on:1,type:"string"},{key:"employee_name",label:"Nama",freeze:1,filter_on:1,type:"string"},{key:"employee_ktp_no",label:"No KTP",filter_on:1,type:"string"},{key:"employee_sim_no",label:"No SIM",filter_on:1,type:"string"},{key:"nominal",label:"Nominal",class:" justify-end",type:"number"},{key:"note",label:"Note",filter_on:1,type:"string"},{key:"attachment_1_type",label:"File",filter_on:1,type:"string"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]),ue=P(()=>["undone","all"].indexOf(v.value)>-1&&k().checkPermission("salary_bonus.create")),_e=P(()=>o.value>-1&&[void 0,0].indexOf(y.value.deleted)>-1&&(k().checkPermission("salary_bonus.val")&&[void 0,0].indexOf(y.value.val)>-1||k().checkPermission("salary_bonus.val1")&&[void 0,0].indexOf(y.value.val1)>-1)&&k().checkPermissions(["salary_bonus.modify"])),de=P(()=>o.value>-1&&[void 0,0].indexOf(y.value.deleted)>-1&&(k().checkPermission("salary_bonus.val")&&[void 0,0].indexOf(y.value.val)>-1||k().checkPermission("salary_bonus.val1")&&[void 0,0].indexOf(y.value.val1)>-1)),me=P(()=>o.value>-1&&k().checkPermission("salary_bonus.remove")&&[void 0,0].indexOf(y.value.deleted)>-1);return(t,a)=>{const b=he,C=we,f=xe,pe=De,ce=Se,ve=Ae,E=Ce,H=Pe,fe=Oe,ye=$e,be=Te,ke=Me,ge=Ne;return u(),h("div",Ee,[d(b,{title:"List Salary Additional"}),_("div",He,[_("div",ze,[_("div",Je,[_("div",Le,[Z(_("select",{class:"","onUpdate:modelValue":a[0]||(a[0]=e=>Q(v)?v.value=e:null)},Ke,512),[[Ve,l(v)]])]),l(ue)?(u(),h("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[1]||(a[1]=e=>te())},[d(C)])):O("",!0),l(_e)?(u(),h("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[2]||(a[2]=e=>ae())},[d(f)])):O("",!0),l(o)>-1?(u(),h("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[3]||(a[3]=e=>oe())},[d(pe)])):O("",!0),l(me)?(u(),h("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[4]||(a[4]=e=>ne())},[d(ce)])):O("",!0),l(de)?(u(),h("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[5]||(a[5]=e=>le())},[d(ve)])):O("",!0)])]),d(ye,{thead:l(ie),selected:l(o),onSetSelected:a[6]||(a[6]=e=>o.value=e),tbody:l(s),fnCallData:R,scrolling:l(p),onSetScrollingPage:a[7]||(a[7]=e=>l(p).page=e),onDoFilter:a[8]||(a[8]=e=>Y()),rowBgColor:W},{val1:m(({item:e})=>[e.val1?(u(),w(H,{key:1})):(u(),w(E,{key:0}))]),val2:m(({item:e})=>[e.val2?(u(),w(H,{key:1})):(u(),w(E,{key:0}))]),val3:m(({item:e})=>[e.val3?(u(),w(H,{key:1})):(u(),w(E,{key:0}))]),employee_name:m(({item:e})=>{var i;return[x(D((i=e.employee)==null?void 0:i.name),1)]}),employee_ktp_no:m(({item:e})=>{var i;return[x(D((i=e.employee)==null?void 0:i.ktp_no),1)]}),employee_sim_no:m(({item:e})=>{var i;return[x(D((i=e.employee)==null?void 0:i.sim_no),1)]}),note:m(({item:e})=>[_("div",Ze,D(e.note),1)]),attachment_1_type:m(({item:e})=>[d(fe,{value:e.attachment_1_type},null,8,["value"])]),deleted_by_username:m(({item:e})=>{var i;return[x(D((i=e.deleted_by)==null?void 0:i.username),1)]}),req_deleted_by_username:m(({item:e})=>{var i;return[x(D((i=e.req_deleted_by)==null?void 0:i.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])]),d(be,{type:"delete",show:l(A),data:l(q),fnClose:se,fnConfirm:re,enabledOk:l(j)},{footer:m(()=>[x(" Masukkan Alasan Penghapusan: "),_("div",Qe,[Z(_("textarea",{"onUpdate:modelValue":a[9]||(a[9]=e=>Q(g)?g.value=e:null)},null,512),[[je,l(g)]])])]),_:1},8,["show","data","enabledOk"]),d(ke,{show:l(T),fnClose:()=>{T.value=!1},id:l(I),p_data:l(s),is_copy:l(V)},null,8,["show","fnClose","id","p_data","is_copy"]),d(ge,{show:l(N),fnClose:()=>{N.value=!1},id:l(U),p_data:l(s),is_view:l(S)},null,8,["show","fnClose","id","p_data","is_view"])])}}};export{Ut as default};
