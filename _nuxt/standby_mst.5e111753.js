import{_ as oe}from"./HeaderPopup.vue.f517fb30.js";import le from"./Tools.85e790f0.js";import ae from"./Times.c23c0c4b.js";import{_ as ne}from"./InputPointFormat.vue.bb08af52.js";import ce from"./Plus.a223a5ab.js";import ie from"./ToolsPopup.48cbe2a6.js";import de from"./ac_accs.ec212c28.js";import{r as h,f as z,G as R,j as ue,o as d,c as _,m as g,J as _e,a as e,b as S,k as t,v as B,t as p,Y as re,l as y,d as K,F,y as pe,C,D as me,q as fe,x as ve,A as N,B as Y,p as he,e as we}from"./entry.d666f234.js";import{u as U}from"./useUtils.05bab760.js";import{u as G}from"./useMyFetch.587fa9a2.js";import{_ as xe}from"./_plugin-vue_export-helper.c27b6911.js";import"./Search.d358c638.js";const u=f=>(he("data-v-de31d79b"),f=f(),we(),f),be={class:"box-fixed"},ye={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},ke={class:"w-full flex flex-col items-center grow overflow-auto"},ge={class:"w-full flex flex-row flex-wrap"},Se={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ce=u(()=>e("label",{for:""},"Name",-1)),Ae=["disabled"],Ie={class:"text-red-500"},je={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ne=u(()=>e("label",{for:""},"Tipe",-1)),Ve=["disabled"],qe={class:"text-red-500"},Be={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Fe=u(()=>e("label",{for:""},"Amount",-1)),Ue={class:"card-border disabled"},Pe={class:"text-red-500"},Te={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},$e=u(()=>e("label",{for:""},"Peralihan?",-1)),De={class:"card-border !flex flex-row items-center"},Ee=["checked"],Me={for:"checkbox",class:"w-full ml-1"},ze={class:"text-red-500"},Re={class:"w-full flex p-1 2xl:overflow-hidden justify-between flex-wrap"},Ke={class:"w-full",role:"sticky"},Ye={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},Ge={class:"sticky -top-1 !z-[2]"},Je=["colspan"],Le={class:"sticky top-7 !z-[2]"},Oe={key:0,class:"min-w-[30px] !w-[30px] max-w-[30px]"},He=u(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),Xe={key:1,class:"min-w-[30px] !w-[30px] max-w-[30px]"},Qe=u(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),We=u(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),Ze=u(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),et=u(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),tt={class:"min-w-[100px] !w-[100px] max-w-[100px]"},st=u(()=>e("br",null,null,-1)),ot={class:"text-sm"},lt=u(()=>e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"For",-1)),at={ref:"to_move"},nt=["data-index"],ct={key:0,class:"tools cell"},it={class:"w-full h-full flex items-center justify-center"},dt=["onClick"],ut={key:1,class:"cell"},_t={class:"w-full h-full flex items-center justify-center"},rt=["onClick"],pt=["onClick","disabled"],mt={class:"w-full h-full flex items-center justify-center"},ft={class:"w-full h-full flex items-center justify-center"},vt={class:"w-full h-full flex items-center justify-center"},ht={class:"cell"},wt={class:"w-full h-full flex items-center justify-center"},xt=["disabled","onUpdate:modelValue"],bt={class:"w-full h-full flex items-center justify-center"},yt={class:"w-full h-full flex items-center justify-center"},kt=["onUpdate:modelValue","disabled"],gt=u(()=>e("option",{value:"Supir"},"Supir",-1)),St=u(()=>e("option",{value:"Kernet"},"Kernet",-1)),Ct=[gt,St],At={key:0},It={class:"tools cell"},jt={class:"w-full flex items-center justify-end"},Nt={__name:"standby_mst",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(f){const m=f,{pointFormat:P}=U(),T={id:-1,name:"",tipe:"",amount:0,is_transition:0,details:[]},l=h({...T}),$=z("token"),k=h({});h([{xdesc:"Gaji Kernet",qty:1,harga:0},{xdesc:"U.Extrafooding",qty:1,harga:2e4}]);const a=h([]),D=h({ordinal:0,id:-1,ac_account_id:"",ac_account_name:"",ac_account_code:"",description:"",amount:0,xfor:"",p_status:""}),A=h(!1),J=()=>{A.value=!1},L=o=>{a.value[i.value].ac_account_id=o.ac_account_id,a.value[i.value].ac_account_code=o.ac_account_code,a.value[i.value].ac_account_name=o.ac_account_name,A.value=!1},O=(o,s)=>{i.value=s,A.value=!0},H=(o,s)=>{a.value[s].ac_account_id="",a.value[s].ac_account_code="",a.value[s].ac_account_name=""},X=async()=>{N().loading_full=!0,k.value={};const o=new FormData;o.append("name",l.value.name),o.append("tipe",l.value.tipe),o.append("is_transition",l.value.is_transition),o.append("amount",l.value.amount),o.append("details",JSON.stringify(a.value));let s="post",w=m.is_copy?0:m.id;w==0||(o.append("id",w),o.append("_method","PUT"));const{data:v,error:x,status:V}=await G("/standby_mst",{method:s,headers:{Authorization:`Bearer ${$.value}`,Accept:"application/json"},body:o,retry:0});if(N().loading_full=!1,V.value==="error"){Y().trigger(x,k);return}if(w<=0)l.value.id=v.value.id,l.value.created_at=v.value.created_at,l.value.updated_at=v.value.updated_at,m.p_data.unshift(l.value);else{l.value.updated_at=v.value.updated_at;let j=m.p_data.map(q=>q.id).indexOf(w);j>=-1&&m.p_data.splice(j,1,{...l.value})}m.fnClose()},E=R(()=>{let o=0;return a.value.forEach(s=>{s.p_status!="Remove"&&(o+=1*s.amount)}),l.value.amount=o,o}),i=h(-1),I=h(!1),M=h({left:0,top:0}),Q=(o,s)=>{i.value=s,I.value=!0,M.value={left:o.clientX,top:o.clientY}},W=()=>{a.value.push({...D.value,p_status:"Add"})},Z=()=>{I.value=!1},ee=(o="")=>{if(o=="insert")a.value.splice(i.value,0,{...D.value,p_status:"Add"});else if(o=="delete")a.value[i.value].p_status=="Edit"?a.value[i.value].p_status="Remove":a.value.splice(i.value,1);else if(o=="move_top"){let s=a.value[i.value];a.value.splice(i.value,1),a.value.splice(i.value-1,0,{...s})}else if(o=="move_bottom"){let s=a.value[i.value];a.value.splice(i.value,1),a.value.splice(i.value+1,0,{...s})}I.value=!1};z("role");const c=R(()=>l.value.val&&l.value.val1||U().checkPermission("standby_mst.val")&&l.value.val||U().checkPermission("standby_mst.val1")&&l.value.val1),te=async()=>{N().loading_full=!0;const{data:o,error:s,status:w}=await G("/standby_mst",{method:"get",headers:{Authorization:`Bearer ${$.value}`,Accept:"application/json"},params:{id:m.id},retry:0});if(N().loading_full=!1,w.value==="error"){Y().trigger(s);return}l.value=o.value.data;let v="Edit";m.is_copy&&(v="Add",l.value.val=0,l.value.val1=0),a.value=o.value.data.details.map(x=>(x.p_status=v,x.key=x.ordinal,x))};return ue(()=>m.show,(o,s)=>{o==!0&&(l.value={...T},a.value=[],m.id!=0&&te())},{immediate:!0}),(o,s)=>{const w=oe,v=le,x=ae,V=ne,j=ce,q=ie,se=de;return d(),_(F,null,[g(e("section",be,[e("div",null,[S(w,{title:"Form StandBy Mst",fn:f.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",ye,[e("div",ke,[e("div",ge,[e("div",Se,[Ce,g(e("input",{"onUpdate:modelValue":s[0]||(s[0]=n=>t(l).name=n),disabled:t(c)},null,8,Ae),[[B,t(l).name]]),e("p",Ie,p(t(k).name),1)]),e("div",je,[Ne,g(e("input",{"onUpdate:modelValue":s[1]||(s[1]=n=>t(l).tipe=n),disabled:t(c)},null,8,Ve),[[B,t(l).tipe]]),e("p",qe,p(t(k).tipe),1)]),e("div",Be,[Fe,e("div",Ue,p(t(P)(t(E))),1),e("p",Pe,p(t(k).amount),1)]),e("div",Te,[$e,e("div",De,[g(e("input",{id:"checkbox",checked:t(l).is_transition,"onUpdate:modelValue":s[2]||(s[2]=n=>t(l).is_transition=n),type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded"},null,8,Ee),[[re,t(l).is_transition]]),e("label",Me,p(t(l).is_transition?"Ya":"Tidak"),1)]),e("p",ze,p(t(k).is_transition),1)])]),e("div",Re,[e("div",Ke,[e("table",Ye,[e("thead",null,[e("tr",Ge,[e("td",{colspan:t(c)?7:9,class:"!bg-slate-800 text-white font-bold"}," Detail ",8,Je)]),e("tr",Le,[t(c)?y("",!0):(d(),_("th",Oe)),He,t(c)?y("",!0):(d(),_("th",Xe)),Qe,We,Ze,et,e("th",tt,[K("Amount "),st,K(),e("span",ot,"("+p(t(P)(t(E)))+")",1)]),lt])]),e("tbody",at,[(d(!0),_(F,null,pe(t(a),(n,b)=>(d(),_(F,{key:b},[n.p_status!="Remove"?(d(),_("tr",{key:0,"data-index":b},[t(c)?y("",!0):(d(),_("td",ct,[e("div",it,[e("button",{type:"button",name:"button",onClick:r=>Q(r,b)},[S(v)],8,dt)])])),e("td",null,p(b+1)+".",1),t(c)?y("",!0):(d(),_("td",ut,[e("div",_t,[n.ac_account_id?(d(),_("button",{key:1,type:"button",onClick:r=>H(r,b),disabled:n.confirm_by},[S(x,{class:"font-bold text-2xl"})],8,pt)):(d(),_("button",{key:0,type:"button",name:"button",onClick:r=>O(r,b)}," ... ",8,rt))])])),e("td",{class:C(["cell bold",t(c)?"unselectable":""])},[e("div",mt,p(n.ac_account_id),1)],2),e("td",{class:C(["cell bold",t(c)?"unselectable":""])},[e("div",ft,p(n.ac_account_code),1)],2),e("td",{class:C(["cell bold",t(c)?"unselectable":""])},[e("div",vt,p(n.ac_account_name),1)],2),e("td",ht,[e("div",wt,[g(e("textarea",{disabled:t(c),class:"p-1 w-full","onUpdate:modelValue":r=>n.description=r,cols:"7",rows:"2"},null,8,xt),[[B,n.description]])])]),e("td",{class:C(["cell bold",t(c)?"unselectable":""])},[e("div",bt,[(d(),me(V,{key:b,class:"w-full h-full p-1",type:"text",value:n.amount||0,onInput:r=>n.amount=r,show:f.show,disabled:t(c)},null,8,["value","onInput","show","disabled"]))])],2),e("td",{class:C(["cell",t(c)?"unselectable":""])},[e("div",yt,[g(e("select",{"onUpdate:modelValue":r=>n.xfor=r,disabled:t(c)},Ct,8,kt),[[fe,n.xfor]])])],2)],8,nt)):y("",!0)],64))),128)),t(c)?y("",!0):(d(),_("tr",At,[e("td",It,[e("button",{type:"button",name:"button",onClick:s[3]||(s[3]=n=>W())},[S(j)])])]))],512)])])])]),e("div",jt,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:s[4]||(s[4]=n=>f.fnClose())}," Cancel "),t(c)?y("",!0):(d(),_("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:s[5]||(s[5]=ve(n=>X(),["prevent"]))}," Save "))])])])],512),[[_e,f.show]]),S(q,{show:t(I),coor:t(M),fn:Z,data:t(a),data_index:t(i),onReplyAct:s[6]||(s[6]=n=>ee(n))},null,8,["show","coor","data","data_index"]),S(se,{show:t(A),fnClose:J,fnSelect:L},null,8,["show"])],64)}}},Rt=xe(Nt,[["__scopeId","data-v-de31d79b"]]);export{Rt as default};
