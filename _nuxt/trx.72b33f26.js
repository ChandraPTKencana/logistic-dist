import{_ as $}from"./HeaderPopup.vue.1e12c737.js";import{_ as A}from"./InputPointFormat.vue.54c794b4.js";import{r as _,f as S,j as q,m as v,J as F,o as N,c as P,a as e,b as w,k as r,t as x,v as j,x as D,A as c,B as h}from"./entry.89e85ed5.js";import{u as g}from"./useMyFetch.626d98fa.js";import"./Times.6908c55f.js";import"./_plugin-vue_export-helper.c27b6911.js";const V={class:"box-fixed"},M={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},T={class:"w-full flex flex-col items-center grow overflow-auto"},z={class:"w-full flex flex-row flex-wrap"},E={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},I=e("label",{for:""},"Nominal Potong",-1),R={class:"w-full"},U={class:"text-red-500"},H={class:"w-full flex flex-col flex-wrap p-1"},J=e("label",{for:""},"Keterangan",-1),K={class:"text-red-500"},O={class:"w-full flex items-center justify-end"},Z={__name:"trx",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},potongan_mst_id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},emits:["updateRemainingCut"],setup(u,{emit:y}){const a=u,f={id:-1,note:"",nominal_cut:""},t=_({...f}),p=S("token"),d=_({}),b=async()=>{c().loading_full=!0,d.value={};const n=new FormData;n.append("potongan_mst_id",a.potongan_mst_id),n.append("note",t.value.note),n.append("nominal_cut",t.value.nominal_cut);let o="post",s=a.id;s==0||(n.append("id",s),n.append("_method","PUT"));const{data:i,error:l,status:k}=await g("/potongan_trx",{method:o,headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},body:n,retry:0});if(c().loading_full=!1,k.value==="error"){h().trigger(l,d);return}if(t.value.updated_at=i.value.updated_at,a.id<=0)t.value.id=i.value.id,t.value.created_at=i.value.created_at,a.p_data.unshift(t.value);else{let m=a.p_data.map(B=>B.id).indexOf(a.id);m>=-1&&a.p_data.splice(m,1,{...t.value})}y("updateRemainingCut",i.value.remaining_cut),a.fnClose()},C=async()=>{c().loading_full=!0;const{data:n,error:o,status:s}=await g("/potongan_trx",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:{id:a.id},retry:0});if(c().loading_full=!1,s.value==="error"){h().trigger(o);return}t.value=n.value.data};return q(()=>a.show,(n,o)=>{n==!0&&(t.value={...f},d.value={},a.id!=0&&C())},{immediate:!0}),(n,o)=>{const s=$,i=A;return v((N(),P("section",V,[e("div",null,[w(s,{title:"Form Potongan Trx",fn:u.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",M,[e("div",T,[e("div",z,[e("div",E,[I,e("div",R,[w(i,{class:"w-full h-full",type:"text",value:r(t).nominal_cut||0,onInput:o[0]||(o[0]=l=>r(t).nominal_cut=l),show:u.show},null,8,["value","show"])]),e("p",U,x(r(d).ref),1)]),e("div",H,[J,v(e("textarea",{"onUpdate:modelValue":o[1]||(o[1]=l=>r(t).note=l),rows:"10"}," ",512),[[j,r(t).note]]),e("p",K,x(r(d).note),1)])])]),e("div",O,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:o[2]||(o[2]=l=>u.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:o[3]||(o[3]=D(l=>b(),["prevent"]))}," Save ")])])])],512)),[[F,u.show]])}}};export{Z as default};
