import{_ as L}from"./HeaderPopup.vue.def29a01.js";import{r as w,g as U,i as p,f as G,k as T,L as J,o as _,c,a as e,b as K,t as n,l as a,m as O,A as Q,n as f,d as x,F as I,E as W,D as X,H as Z,x as F,y as R,p as ee,e as ae}from"./entry.80f9400f.js";import{u as te}from"./useUtils.4905e334.js";import{u as Y}from"./useMyFetch.a3705501.js";import{_ as le}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.533e4a65.js";const r=d=>(ee("data-v-c0d56cdf"),d=d(),ae(),d),se={class:"box-fixed"},oe={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},ne={class:"w-full flex flex-col items-center grow overflow-auto"},re={class:"w-full flex flex-row flex-wrap"},ie={class:"w-1/2 sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ue=r(()=>e("label",{for:""},"Period End",-1)),de={class:"card-border"},_e={class:"w-1/2 sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ce=r(()=>e("label",{for:""},"Period Part",-1)),ve={class:"card-border"},pe={key:0,class:"w-full p-1"},me=r(()=>e("div",{class:"font-bold"}," Filter Nama ",-1)),fe={key:1,class:"w-full flex p-1 justify-between flex-wrap"},he={class:"w-full",role:"sticky"},ye={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},be=r(()=>e("tr",{class:"sticky -top-1 !z-[2]"},[e("td",{colspan:"12",class:"!bg-slate-800 text-white font-bold"}," Detail ")],-1)),we={class:"sticky top-7 !z-[2]"},xe=r(()=>e("th",null,"No",-1)),ke=r(()=>e("th",null,"Jabatan",-1)),ge=r(()=>e("th",null,"Nama Pekerja",-1)),Fe=r(()=>e("th",null,"No KTP",-1)),Ne=r(()=>e("th",null,"Rek No",-1)),Se=r(()=>e("th",null,"Rek Nama",-1)),Be=r(()=>e("th",null,"Bank Name",-1)),Ce={class:"text-sm"},De={class:"text-sm"},je={class:"text-sm"},Ee={class:"text-sm"},Me={class:"text-sm"},Ve={ref:"to_move"},Ae=["data-index"],Pe={class:"w-full flex items-center justify-end"},$e={class:"w-full flex flex-wrap p-3 items-center"},qe=r(()=>e("div",null," Di Validasi oleh : ",-1)),Te={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},Ie={key:0},Re={__name:"salary_paid_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(d){const v=d,{$moment:N}=Z(),{pointFormat:i}=te(),o=w({...{id:-1,name:"",tipe:"",is_transition:!1,amount:0,details:[],val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:"",val3:0,val3_by:{username:""},val3_at:""}}),S=U("token"),B=w({}),C=w(null),u=w([]),z=async()=>{F().loading_full=!0,B.value={};const l=new FormData;let s="post",m=v.id;m==0||(l.append("id",m),l.append("_method","PUT"));const{data:t,error:y,status:k}=await Y("/salary_paid_validasi",{method:s,headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},body:l,retry:0});if(F().loading_full=!1,k.value==="error"){R().trigger(y,B);return}o.value.val1=t.value.val1,o.value.val1_user=t.value.val1_user,o.value.val1_by=t.value.val1_by,o.value.val1_at=t.value.val1_at,o.value.val2=t.value.val2,o.value.val2_user=t.value.val2_user,o.value.val2_by=t.value.val2_by,o.value.val2_at=t.value.val2_at,o.value.val3=t.value.val3,o.value.val3_user=t.value.val3_user,o.value.val3_by=t.value.val3_by,o.value.val3_at=t.value.val3_at;let b=v.p_data.map(g=>g.id).indexOf(v.id);b>-1&&v.p_data.splice(b,1,{...o.value}),v.fnClose()};p(()=>{let l=0;return u.value.forEach(s=>{l+=parseFloat(s.standby_nominal)}),l});const D=p(()=>{let l=0;return u.value.forEach(s=>{l+=parseFloat(s.sb_gaji)}),l}),j=p(()=>{let l=0;return u.value.forEach(s=>{l+=parseFloat(s.sb_makan)}),l}),E=p(()=>{let l=0;return u.value.forEach(s=>{l+=parseFloat(s.sb_dinas)}),l}),M=p(()=>{let l=0;return u.value.forEach(s=>{l+=parseFloat(s.salary_bonus_nominal)}),l}),H=async()=>{F().loading_full=!0;const{data:l,error:s,status:m}=await Y("/salary_paid",{method:"get",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},params:{id:v.id},retry:0});if(F().loading_full=!1,m.value==="error"){R().trigger(s);return}o.value=l.value.data,u.value=l.value.data.details};p(()=>{let l=0;return u.value.forEach(s=>{s.p_status!="Remove"&&(l+=parseInt(s.amount))}),l}),p(()=>!1);const h=w(""),V=p(()=>h.value!=""?u.value.filter(l=>l.employee.name.toLowerCase().includes(h.value.toLowerCase())):u.value);return G(()=>v.show,(l,s)=>{l==!0&&(v.is_view==!1&&setTimeout(()=>{C.value.focus()},1),H())},{immediate:!0}),(l,s)=>{const m=L;return T((_(),c("section",se,[e("div",null,[K(m,{title:"Form Master Standby Validation",fn:d.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",oe,[e("div",ne,[e("div",re,[e("div",ie,[ue,e("div",de,n(a(N)(a(o).period_end).format("MM-Y")),1)]),e("div",_e,[ce,e("div",ve,n(a(o).period_part),1)])]),a(u).length?(_(),c("div",pe,[me,T(e("input",{class:"",type:"text","onUpdate:modelValue":s[0]||(s[0]=t=>O(h)?h.value=t:null),name:"search",placeholder:"Nama"},null,512),[[Q,a(h)]])])):f("",!0),a(V).length?(_(),c("div",fe,[e("div",he,[e("table",ye,[e("thead",null,[be,e("tr",we,[xe,ke,ge,Fe,Ne,Se,Be,e("th",null,[x("SB.Gaji "),e("span",Ce,"("+n(a(i)(a(D)||0))+")",1)]),e("th",null,[x("SB.Makan "),e("span",De,"("+n(a(i)(a(j)||0))+")",1)]),e("th",null,[x("SB.Dinas "),e("span",je,"("+n(a(i)(a(E)||0))+")",1)]),e("th",null,[x("Nominal Bonus "),e("span",Ee,"("+n(a(i)(a(M)||0))+")",1)]),e("th",null,[x("Total "),e("span",Me,"("+n(a(i)(a(D)+a(j)+a(E)+a(M)||0))+")",1)])])]),e("tbody",Ve,[(_(!0),c(I,null,W(a(V),(t,y)=>{var k,b,g,A,P,$,q;return _(),c(I,{key:y},[t.p_status!="Remove"?(_(),c("tr",{key:0,"data-index":y},[e("td",null,n(y+1)+".",1),e("td",null,n((k=t.employee)==null?void 0:k.role),1),e("td",null,n((b=t.employee)==null?void 0:b.name),1),e("td",null,n((g=t.employee)==null?void 0:g.ktp_no),1),e("td",null,n((A=t.employee)==null?void 0:A.rek_no),1),e("td",null,n((P=t.employee)==null?void 0:P.rek_name),1),e("td",null,n((q=($=t.employee)==null?void 0:$.bank)==null?void 0:q.code),1),e("td",null,n(a(i)(t.sb_gaji)),1),e("td",null,n(a(i)(t.sb_makan)),1),e("td",null,n(a(i)(t.sb_dinas)),1),e("td",null,n(a(i)(t.salary_bonus_nominal)),1),e("td",null,n(a(i)(parseFloat(t.sb_gaji)+parseFloat(t.sb_makan)+parseFloat(t.sb_dinas)+parseFloat(t.salary_bonus_nominal))),1)],8,Ae)):f("",!0)],64)}),128))],512)])])])):f("",!0)]),e("div",Pe,[e("div",$e,[qe,a(o).val1||a(o).val2||a(o).val3?(_(),c("div",Te,[a(o).val1?(_(),c("div",Ie," App 1 : "+n(a(o).val1_by.username)+" ( "+n(a(o).val1_at?a(N)(a(o).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):f("",!0)])):f("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:s[1]||(s[1]=t=>d.fnClose())}," Cancel "),d.is_view==0?(_(),c("button",{key:0,ref_key:"it_val",ref:C,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:s[2]||(s[2]=X(t=>z(),["prevent"]))}," Validasi ",512)):f("",!0)])])])],512)),[[J,d.show]])}}},Ke=le(Re,[["__scopeId","data-v-c0d56cdf"]]);export{Ke as default};
