import Z from"./Header.a734ad2b.js";import tt from"./Calendar.b472c241.js";import et from"./CarTag.f18225d8.js";import st from"./TruckDriver.4e1abc86.js";import ot from"./TruckDriverOutline.32eb4544.js";import nt from"./LocationOn.300dc622.js";import{_ as lt}from"./HeaderPopup.vue.7dab8cd1.js";import at from"./Image.c5661b69.js";import rt from"./GAPIN.6bb16678.js";import{f as it,g as ct,r as p,i as dt,G as _t,j as ut,c as i,b as f,a as t,m as k,v as pt,k as e,n as ft,F as P,y as K,J as j,t as n,l as u,d as A,z as xt,A as b,B as C,o as c,E as ht}from"./entry.2c49a8ae.js";import{u as mt}from"./useUtils.5604218d.js";import{u as H}from"./useMyFetch.a36dd4ca.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.7633c7c0.js";const gt={class:"w-full h-full flex flex-col relative"},vt={class:"grow flex flex-col"},bt={class:"w-full flex items-center p-1"},yt={class:"grow"},wt={class:"grow overflow-auto h-0"},kt={class:"p-1 grow"},Yt={class:"bg-white flex py-2 justify-between"},Tt={class:"flex flex-wrap"},Dt={class:"flex items-center justify-center m-2 text-xs"},Mt={class:"bg-blue-400 p-2 font-bold text-white"},jt={class:"flex flex-col m-2"},At=t("span",{class:"text-xs"}," Tgl Terima U.Jalan ",-1),Ct={class:"flex items-center justify-center"},Ht={class:"flex flex-col m-2"},Lt=t("span",{class:"text-xs"}," Nomor Kendaraan ",-1),It={class:"flex items-center justify-center"},Nt=["data-real"],$t={class:"flex flex-col m-2"},St=t("span",{class:"text-xs"}," Nama Supir ",-1),Bt={class:"flex items-center justify-center"},Pt=["data-real"],Kt={key:0,class:"flex flex-col m-2"},Rt=t("span",{class:"text-xs"}," Nama Kernet ",-1),Vt={class:"flex items-center justify-center"},Ft=["data-real"],Ut={class:"flex flex-col m-2"},zt=t("span",{class:"text-xs"}," Tujuan ",-1),Jt={class:"flex items-center justify-center"},qt=["onClick"],Et={class:"w-full h-full fixed top-0 left-0 bg-gray-100 bg-opacity-80 flex items-center justify-center z-10"},Ot={class:"w-full sm:w-10/12 md:w-10/12 lg:w-8/12 bg-white flex flex-col border-solid border-gray-200 max-w-full max-h-full overflow-auto",style:{"border-width":"1px"}},Gt={class:"p-1 flex flex-wrap overflow-auto items-start"},Wt={class:"w-full flex flex-wrap"},Qt={class:"w-full flex flex-wrap"},Xt={class:"flex flex-col m-2 border-solid border-l-4 border-blue-400 px-2 bg-gray-200"},Zt=t("span",{class:"text-xs font-bold"}," ID ",-1),te={class:""},ee={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},se=t("span",{class:"text-xs font-bold"}," Tgl Terima U.Jalan ",-1),oe={class:""},ne={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},le=t("span",{class:"text-xs font-bold"}," Nomor Kendaraan ",-1),ae={class:""},re={class:"flex flex-row flex-wrap m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},ie={class:"flex flex-col"},ce=t("span",{class:"text-xs font-bold"}," Nama Supir ",-1),de={class:""},_e={class:"flex flex-col pl-2"},ue=t("span",{class:"text-xs font-bold"}," No rek ",-1),pe={class:""},fe={key:0,class:"flex flex-row flex-wrap m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},xe={class:"flex flex-col"},he=t("span",{class:"text-xs font-bold"}," Nama Kernet ",-1),me={class:""},ge={class:"flex flex-col pl-2"},ve=t("span",{class:"text-xs font-bold"}," No rek ",-1),be={class:""},ye={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},we=t("span",{class:"text-xs font-bold"}," Tujuan ",-1),ke={class:""},Ye={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},Te=t("span",{class:"text-xs font-bold"}," Tipe ",-1),De={class:""},Me={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},je=t("span",{class:"text-xs font-bold"}," Jenis ",-1),Ae={class:""},Ce={key:1,class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},He=t("span",{class:"text-xs font-bold"}," Pengalihan ",-1),Le={class:""},Ie={class:"w-full flex flex-wrap justify-center"},Ne={key:0,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},$e=t("span",{class:"text-xs font-bold"}," App Kasir ",-1),Se={class:"text-xs"},Be={key:1,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},Pe=t("span",{class:"text-xs font-bold"}," App Mandor ",-1),Ke={class:"text-xs"},Re={key:2,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},Ve=t("span",{class:"text-xs font-bold"}," App KTU/W ",-1),Fe={class:"text-xs"},Ue={key:3,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},ze=t("span",{class:"text-xs font-bold"}," App Marketing ",-1),Je={class:"text-xs"},qe={key:4,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},Ee=t("span",{class:"text-xs font-bold"}," App Logistik ",-1),Oe={class:"text-xs"},Ge={key:5,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},We=t("span",{class:"text-xs font-bold"}," App SPV Logistik ",-1),Qe={class:"text-xs"},Xe={class:"w-full sm:w-1/2 text-sm flex justify-center"},Ze={class:"border border-collapse border-black"},ts=t("tr",null,[t("th",{colspan:"4",class:"bg-blue-400"}," List Uang Jalan ")],-1),es={class:"p-1"},ss={class:"p-1"},os=t("td",{class:"p-1"},"= Rp.",-1),ns={class:"text-right p-1"},ls={class:"border-t-black border-dashed",style:{"border-top-width":"1px"}},as=t("th",{colspan:"2",class:"text-right"},"Total",-1),rs=t("th",{class:"p-1 text-right"},"Rp.",-1),is={class:"p-1 text-right"},cs={key:0,class:"text-red-500 font-bold"},ds=t("td",{colspan:"2",class:"text-right"},"Potongan Supir",-1),_s=t("td",{class:"p-1 text-right"},"Rp.",-1),us={class:"p-1 text-right"},ps={key:1,class:"text-red-500 font-bold"},fs=t("td",{colspan:"2",class:"text-right"},"Potongan Kernet",-1),xs=t("td",{class:"p-1 text-right"},"Rp.",-1),hs={class:"p-1 text-right"},ms={key:2,class:"text-red-500 font-bold"},gs=t("td",{colspan:"2",class:"text-right"},"Total Potongan",-1),vs=t("td",{class:"p-1 text-right"},"Rp.",-1),bs={class:"p-1 text-right"},ys={key:3,class:"font-bold"},ws=t("td",{colspan:"2",class:"text-right"},"Total Diterima",-1),ks=t("td",{class:"p-1 text-right"},"Rp.",-1),Ys={class:"p-1 text-right"},Ts={class:"w-full sm:w-1/2 h-full"},Ds=["src"],Ms={key:1,class:"flex flex-col justify-center items-center px-2 py-8 border border-gray-700 bg-gray-300"},js={class:"flex p-1 justify-end flex-wrap"},As={class:"flex p-1 justify-center flex-wrap bg-yellow-100"},Cs=t("div",{class:"w-full text-center"}," Akan dilakukan Transfer dengan data diatas. Apakah Informasi Diatas Sudah Benar Dan Tepat? ",-1),Es={__name:"transfer",async setup(Hs){let y,L;const{$moment:x}=ht(),{pointFormat:h}=mt(),Y=it("token");new Date().getTimezoneOffset();const{data:R}=([y,L]=ct(async()=>xt(async()=>{b().loading_full=!0;let l=[];const[o,d]=await Promise.all([H("/trx_trp/transfers",{method:"get",headers:{Authorization:`Bearer ${Y.value}`,Accept:"application/json"},retry:0})]);return o.status.value==="error"?(C().trigger(o.error),{trx_trps:l}):(b().loading_full=!1,l=o.data.value.data,{trx_trps:l})},"$pIgiM26TjW")),y=await y,L(),y),T=p(R.value.trx_trps||[]),D=p({}),s=p({id:-1,tanggal:new Date,xto:"",tipe:"",jenis:"",amount:0,supir:"",kernet:"",no_pol:"",details_uj:[]}),M=p(-1),m=p(""),V=async l=>{b().loading_full=!0;const{data:o,error:d,status:r}=await H("/trx_trp/transfer/detail",{method:"get",headers:{Authorization:`Bearer ${Y.value}`,Accept:"application/json"},params:{id:l.id},retry:0});if(b().loading_full=!1,r.value==="error"){C().trigger(d,D);return}s.value=o.value.data},F=async()=>{b().loading_full=!0,D.value={};const l=new FormData;l.append("id",s.value.id),l.append("_method","PUT");let o="post";const{data:d,error:r,status:_}=await H("/trx_trp/transfer",{method:o,headers:{Authorization:`Bearer ${Y.value}`,Accept:"application/json"},body:l,retry:0});if(b().loading_full=!1,_.value==="error"){C().trigger(r,D);return}T.value.splice(M.value,1),M.value=-1,v.value=!1,g.value=!1},g=p(!1),U=p(0),v=p(!1);dt();const z=(l,o)=>{M.value=l,U.value=o,g.value=!0,V(o)},I=_t(()=>m.value!=""?T.value.filter(l=>l.no_pol.toLowerCase().includes(m.value.toLowerCase())||l.supir.toLowerCase().includes(m.value.toLowerCase())||l.kernet.toLowerCase().includes(m.value.toLowerCase())):T.value),w=l=>l.potongan&&l.potongan.length>0?l.potongan.map(o=>parseInt(o.nominal_cut)).reduce((o,d)=>(o+=d,o)):0,N=l=>{if(l.potongan&&l.potongan.length>0){let o=l.potongan.filter(r=>r.potongan_mst.employee_id==l.supir_id);if(o.length==0)return 0;let d=o.map(r=>parseInt(r.nominal_cut));return d.length==0?0:d.reduce((r,_)=>(r+=_,r))}return 0},$=l=>{if(l.potongan&&l.potongan.length>0){let o=l.potongan.filter(r=>r.potongan_mst.employee_id==l.kernet_id);if(o.length==0)return 0;let d=o.map(r=>parseInt(r.nominal_cut));return d.length==0?0:d.reduce((r,_)=>(r+=_,r))}return 0},J=()=>{let l=m.value;document.querySelectorAll(".to_hl").forEach(o=>{let d=o.dataset.real;var r=o.innerHTML,_=d.toLowerCase().indexOf(l.toLowerCase());_>-1&&l!=""?(r=d.substring(0,_)+"<span class='highlight'>"+d.substring(_,_+l.length)+"</span>"+d.substring(_+l.length),o.innerHTML=r):o.innerHTML=r=d})};ut(()=>I,(l,o)=>{setTimeout(()=>{J()},0)},{deep:!0,immediate:!0});const S=p(0);return(l,o)=>{var B;const d=Z,r=tt,_=et,q=st,E=ot,O=nt,G=lt,W=at,Q=rt;return c(),i("div",gt,[f(d,{title:"List Transaction"}),t("section",vt,[t("div",bt,[t("div",yt,[k(t("input",{class:"flex-grow",type:"text","onUpdate:modelValue":o[0]||(o[0]=a=>ft(m)?m.value=a:null),name:"search",placeholder:"Keyword"},null,512),[[pt,e(m)]])])]),t("div",wt,[(c(!0),i(P,null,K(e(I),(a,X)=>(c(),i("div",kt,[t("div",Yt,[t("div",Tt,[t("div",Dt,[t("div",Mt,n(a.id),1)]),t("div",jt,[At,t("div",Ct,[f(r,{class:"mr-1"}),A(" "+n(e(x)(a.tanggal).format("DD-MM-YYYY")),1)])]),t("div",Ht,[Lt,t("div",It,[f(_,{class:"mr-1"}),t("span",{class:"to_hl","data-real":a.no_pol},n(a.no_pol),9,Nt)])]),t("div",$t,[St,t("div",Bt,[f(q,{class:"mr-1"}),t("span",{class:"to_hl","data-real":a.supir},n(a.supir),9,Pt)])]),a.kernet?(c(),i("div",Kt,[Rt,t("div",Vt,[f(E,{class:"mr-1"}),t("span",{class:"to_hl","data-real":a.kernet},n(a.kernet),9,Ft)])])):u("",!0),t("div",Ut,[zt,t("div",Jt,[f(O,{class:"mr-1"}),A(" "+n(a.xto),1)])])]),t("button",{class:"bg-blue-500 text-white rounded",onClick:Ls=>z(X,a)}," Detail ",8,qt)])]))),256))])]),k(t("div",Et,[t("div",Ot,[f(G,{title:"Detail Information",fn:()=>{g.value=!1,v.value=!1},class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("div",Gt,[t("div",Wt,[t("div",Qt,[t("div",Xt,[Zt,t("div",te,n(e(s).id),1)]),t("div",ee,[se,t("div",oe,n(e(x)(e(s).tanggal).format("DD-MM-YYYY")),1)]),t("div",ne,[le,t("div",ae,n(e(s).no_pol),1)]),t("div",re,[t("div",ie,[ce,t("div",de,n(e(s).supir),1)]),t("div",_e,[ue,t("div",pe,n(e(s).supir_rek_no),1)])]),e(s).kernet?(c(),i("div",fe,[t("div",xe,[he,t("div",me,n(e(s).kernet),1)]),t("div",ge,[ve,t("div",be,n(e(s).kernet_rek_no),1)])])):u("",!0),t("div",ye,[we,t("div",ke,n(e(s).xto),1)]),t("div",Ye,[Te,t("div",De,n(e(s).tipe),1)]),t("div",Me,[je,t("div",Ae,n(e(s).jenis),1)]),e(s).transition_type=="From"?(c(),i("div",Ce,[He,t("div",Le,n(e(s).transition_target),1)])):u("",!0)]),t("div",Ie,[e(s).val?(c(),i("div",Ne,[$e,t("div",null," ( "+n(e(s).val_by.username)+" ) ",1),t("div",Se,n(e(x)(e(s).val_at).format("DD-MM-YYYY HH:mm:ss")),1)])):u("",!0),e(s).val1?(c(),i("div",Be,[Pe,t("div",null," ( "+n(e(s).val1_by.username)+" ) ",1),t("div",Ke,n(e(x)(e(s).val1_at).format("DD-MM-YYYY HH:mm:ss")),1)])):u("",!0),e(s).val2?(c(),i("div",Re,[Ve,t("div",null," ( "+n(e(s).val2_by.username)+" ) ",1),t("div",Fe,n(e(x)(e(s).val2_at).format("DD-MM-YYYY HH:mm:ss")),1)])):u("",!0),e(s).val3?(c(),i("div",Ue,[ze,t("div",null," ( "+n(e(s).val3_by.username)+" ) ",1),t("div",Je,n(e(x)(e(s).val3_at).format("DD-MM-YYYY HH:mm:ss")),1)])):u("",!0),e(s).val4?(c(),i("div",qe,[Ee,t("div",null," ( "+n(e(s).val4_by.username)+" ) ",1),t("div",Oe,n(e(x)(e(s).val4_at).format("DD-MM-YYYY HH:mm:ss")),1)])):u("",!0),e(s).val5?(c(),i("div",Ge,[We,t("div",null," ( "+n(e(s).val5_by.username)+" ) ",1),t("div",Qe,n(e(x)(e(s).val5_at).format("DD-MM-YYYY HH:mm:ss")),1)])):u("",!0)])]),t("div",Xe,[t("table",Ze,[ts,(c(!0),i(P,null,K(e(s).details_uj,a=>(c(),i("tr",null,[t("td",es,n(a.ordinal)+". ",1),t("td",ss,n(a.xdesc)+" "+n(a.qty<=1?"":e(h)(a.qty||0)+" x Rp."+e(h)(a.harga||0)),1),os,t("td",ns,n(e(h)(a.qty*a.harga)),1)]))),256)),t("tr",ls,[as,rs,t("th",is,n(e(h)(e(s).amount)),1)]),N(e(s))>0?(c(),i("tr",cs,[ds,_s,t("td",us,n(e(h)(N(e(s)))),1)])):u("",!0),$(e(s))>0?(c(),i("tr",ps,[fs,xs,t("td",hs,n(e(h)($(e(s)))),1)])):u("",!0),w(e(s))>0?(c(),i("tr",ms,[gs,vs,t("td",bs,n(e(h)(w(e(s)))),1)])):u("",!0),w(e(s))>0?(c(),i("tr",ys,[ws,ks,t("td",Ys,n(e(h)(e(s).amount-w(e(s)))),1)])):u("",!0)])]),t("div",Ts,[((B=e(s).trx_absens)==null?void 0:B.length)>0?(c(),i("img",{key:0,class:"w-full",src:e(s).trx_absens[0].gambar},null,8,Ds)):(c(),i("div",Ms,[f(W),A(" Tidak Ada Foto Berangkat ")]))])]),k(t("div",js,[t("button",{class:"rounded m-1",onClick:o[1]||(o[1]=a=>g.value=!1)}," Cancel "),t("button",{class:"rounded m-1 text-white bg-blue-500",onClick:o[2]||(o[2]=a=>v.value=!0)}," Transfer ")],512),[[j,!e(v)]]),k(t("div",As,[Cs,t("button",{class:"rounded m-1 bg-white",onClick:o[3]||(o[3]=a=>(v.value=!1,g.value=!1))}," Tidak "),t("button",{class:"rounded m-1 text-white bg-blue-500",onClick:o[4]||(o[4]=a=>F())}," Ya ")],512),[[j,e(v)]])])],512),[[j,e(g)]]),f(Q,{show:e(S),onSetTimeout:o[5]||(o[5]=a=>S.value=a)},null,8,["show"])])}}};export{Es as default};
