import Z from"./Header.9ac1304c.js";import{_ as H}from"./client-only.85ccf7d4.js";import{_ as R}from"./SelectMulti.vue.cf6534b8.js";import q from"./PrinterEye.ebbeec98.js";import G from"./Table2Column.ce59180d.js";import{_ as L}from"./PDFView.vue.066de42d.js";import{r as d,g as K,h as Q,I as W,c as X,a as e,b as n,k as T,v as Y,l,m as E,w as N,t as O,C as B,F as ee,q as te,o as oe,p as le,e as se,x as f,y as C,G as ae}from"./entry.e181b2a0.js";import{u as S}from"./useMyFetch.dcf65f79.js";import{u as ne}from"./useDownload.174f4da2.js";import{_ as ie}from"./_plugin-vue_export-helper.c27b6911.js";import"./Check.d7776801.js";import"./Times.3821d6e4.js";const s=p=>(le("data-v-d2078fe2"),p=p(),se(),p),re={class:"w-full h-full flex flex-col"},de={class:"w-full flex grow flex-col overflow-auto h-0 bg-gray-200 justify-center items-center p-2"},ce={class:"bg-white p-2 max-w-[350px] max-h-full overflow-auto"},_e={action:"#",class:"w-full flex flex-col sm:flex-row flex-wrap text-xs"},ue={class:"w-full p-1 flex flex-col"},fe=s(()=>e("div",{class:"font-bold"}," Tipe ",-1)),pe=s(()=>e("option",{value:"header"},"Header",-1)),me=s(()=>e("option",{value:"detail"},"Detail",-1)),ve=[pe,me],he={class:"w-full p-1 flex flex-col"},xe=s(()=>e("div",{class:"font-bold"}," Jenis ",-1)),ye=s(()=>e("option",{value:""},null,-1)),we=s(()=>e("option",{value:"UJ"},"Uang Jalan",-1)),ge=s(()=>e("option",{value:"SB"},"Uang Standby",-1)),be=[ye,we,ge],ke={class:"w-full sm:w-1/2 p-1 flex flex-col"},De=s(()=>e("div",{class:"font-bold"}," Tgl Dari ",-1)),Ce={class:"text-red-500"},Se={class:"w-full sm:w-1/2 p-1 flex flex-col"},Me=s(()=>e("div",{class:"font-bold"}," Tgl Sampai ",-1)),Ve={class:"text-red-500"},je={class:"w-full p-1 flex flex-col"},Ae=s(()=>e("div",{class:"font-bold"}," Lokasi ",-1)),$e={class:"w-full p-1 flex flex-col"},Te=s(()=>e("div",{class:"font-bold"}," Nama ",-1)),Ye={class:"w-full p-1 flex flex-col"},Ee=s(()=>e("div",{class:"font-bold"}," No Pol ",-1)),Ne={class:"w-full p-1 flex items-end justify-end"},Oe=s(()=>e("div",{class:"text-left m-1"},"Download PDF",-1)),Be=s(()=>e("div",{class:"text-left m-1"},"Download Excel",-1)),Fe={__name:"ast_n_driver",async setup(p){let m,M;const{$moment:V}=ae(),a={};a._TimeZoneOffset=new Date().getTimezoneOffset(),a.sort="tanggal:desc";const j=d({}),x=K("token"),c=d({from:"",to:""}),{data:y}=([m,M]=Q(async()=>te(async()=>{f().loading_full=!0;let t=[],o=[],_=[];const[r,k]=await Promise.all([S("/report/ast_n_driver/load_data",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},retry:0})]);return r.status.value!=="error"&&(t=r.data.value.list_xto,_=r.data.value.list_employee,o=r.data.value.list_vehicle),r.status.value==="error"&&C().trigger(r.error),f().loading_full=!1,{list_xto:t,list_employee:_,list_vehicle:o}},"$Aw9scsfjYZ")),m=await m,M(),m),w=d([]),g=d([]),b=d([]);y.value.list_xto.forEach(t=>{w.value.push({id:t,name:t,title:"",checked:!1})}),y.value.list_employee.forEach(t=>{g.value.push({id:t.id,name:t.name,title:t.role,checked:!1})}),y.value.list_vehicle.forEach(t=>{b.value.push({id:t.id,name:t.no_pol,title:"",checked:!1})});const v=d("header"),h=d(""),A=()=>{a._TimeZoneOffset=new Date().getTimezoneOffset(),a.date_from=c.value.from?V(c.value.from).format("YYYY-MM-DD"):"",a.date_to=c.value.to?V(c.value.to).format("YYYY-MM-DD"):"",a.list_xto=JSON.stringify(w.value.filter(t=>t.checked).map(t=>t.id)),a.list_employee=JSON.stringify(g.value.filter(t=>t.checked).map(t=>t.id)),a.list_vehicle=JSON.stringify(b.value.filter(t=>t.checked).map(t=>t.id)),a.type=v.value,a.jenis=h.value},{downloadFile:F,viewFile:Ie}=ne(),u=d(!1),$=d({}),I=async()=>{if(u.value==!0){u.value=!1;return}A(),f().loading_full=!0;const{data:t,error:o,status:_}=await S("/report/ast_n_driver/pdf_preview",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:a,retry:0});if(f().loading_full=!1,_.value==="error"){C().trigger(o);return}$.value=t.value,u.value=!0},P=async()=>{A(),f().loading_full=!0;const{data:t,error:o,status:_}=await S("/report/ast_n_driver/excel_download",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:a,retry:0});if(f().loading_full=!1,_.value==="error"){C().trigger(o);return}F(t.value)};return(t,o)=>{const _=Z,r=W("vue-date-picker"),k=H,D=R,U=q,J=G,z=L;return oe(),X(ee,null,[e("div",re,[n(_,{title:"Report Transaction"}),e("div",de,[e("div",ce,[e("form",_e,[e("div",ue,[fe,T(e("select",{"onUpdate:modelValue":o[0]||(o[0]=i=>E(v)?v.value=i:null)},ve,512),[[Y,l(v)]])]),e("div",he,[xe,T(e("select",{"onUpdate:modelValue":o[1]||(o[1]=i=>E(h)?h.value=i:null)},be,512),[[Y,l(h)]])]),e("div",ke,[De,n(k,null,{default:N(()=>[n(r,{modelValue:l(c).from,"onUpdate:modelValue":o[2]||(o[2]=i=>l(c).from=i),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1}),e("p",Ce,O(l(j).date_from),1)]),e("div",Se,[Me,n(k,null,{default:N(()=>[n(r,{modelValue:l(c).to,"onUpdate:modelValue":o[3]||(o[3]=i=>l(c).to=i),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1}),e("p",Ve,O(l(j).date_to),1)]),e("div",je,[Ae,n(D,{arr:l(w)},null,8,["arr"])]),e("div",$e,[Te,n(D,{arr:l(g)},null,8,["arr"])]),e("div",Ye,[Ee,n(D,{arr:l(b)},null,8,["arr"])]),e("div",Ne,[e("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:o[4]||(o[4]=B(i=>I(),["prevent"]))},[e("div",null,[n(U,{class:"text-2xl"})]),Oe]),e("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:o[5]||(o[5]=B(i=>P(),["prevent"]))},[e("div",null,[n(J,{class:"text-2xl"})]),Be])])])])])]),n(z,{show:l(u),pdfContent:l($),onClose:o[6]||(o[6]=i=>u.value=!l(u))},null,8,["show","pdfContent"])],64)}}},We=ie(Fe,[["__scopeId","data-v-d2078fe2"]]);export{We as default};
