import{r as i,f as ae,g as Ue,h as ze,i as T,j as le,s as Le,x as m,c as h,b as u,a as _,k as ne,v as Ve,l,m as oe,n as j,d as g,w as f,q as Me,y as z,o as d,z as L,t as P,A as Ne,B as M,_ as N}from"./entry.2c798c4f.js";import He from"./Header.0187adba.js";import Re from"./Copy.fffc3bbd.js";import Ke from"./Plus.c2822e5c.js";import Je from"./Edit.76169185.js";import Ye from"./Eyes.7efe1cae.js";import Ge from"./Delete.eb66884c.js";import qe from"./Signature.da7d7916.js";import Xe from"./SignatureOff.ff748fd0.js";import Ze from"./Table2Column.763b5873.js";import Qe from"./Line.0d639d98.js";import We from"./Check.e6bf60f5.js";import et from"./TableView.2b97c741.js";import{u as p}from"./useUtils.437b3e73.js";import{u as V}from"./useMyFetch.79160f08.js";import{u as tt}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.3043f934.js";import"./Adjust.128330ca.js";import"./TableHeaderEye.5e114b42.js";import"./Times.a570b43c.js";import"./ClearAll.82a76196.js";import"./client-only.c834acb6.js";import"./ClearEach.611de72c.js";import"./CaretLeftDoubleBold.718f916e.js";import"./CaretLeftBold.c9427645.js";import"./CaretRightBold.04d147af.js";import"./CaretRightDoubleBold.4149bc18.js";const at=M(()=>N(()=>import("./PopupMini.46e51de8.js"),["./PopupMini.46e51de8.js","./PopupMini.vue.ccc5215b.js","./Times.a570b43c.js","./_plugin-vue_export-helper.c27b6911.js","./entry.2c798c4f.js","./entry.493f9183.css","./Exclamation.c2186a38.js"],import.meta.url).then(c=>c.default||c)),lt=M(()=>N(()=>import("./ujalan.9fc3ee01.js"),["./ujalan.9fc3ee01.js","./HeaderPopup.vue.65f721df.js","./Times.a570b43c.js","./_plugin-vue_export-helper.c27b6911.js","./entry.2c798c4f.js","./entry.493f9183.css","./InputPointFormat.vue.afbdaa92.js","./Tools.e5f1e629.js","./Check.e6bf60f5.js","./Plus.c2822e5c.js","./ToolsPopup.3ab2086d.js","./ToolsPopup.13c08491.css","./ac_accs.a6ce7d5d.js","./Search.3043f934.js","./useUtils.437b3e73.js","./useMyFetch.79160f08.js","./ac_accs.2900e1e1.css"],import.meta.url).then(c=>c.default||c)),nt=M(()=>N(()=>import("./ujalan_batas_persen_susut.4c184417.js"),["./ujalan_batas_persen_susut.4c184417.js","./HeaderPopup.vue.65f721df.js","./Times.a570b43c.js","./_plugin-vue_export-helper.c27b6911.js","./entry.2c798c4f.js","./entry.493f9183.css","./InputPointFormat.vue.afbdaa92.js","./WidthMiniList.vue.a4f06b2c.js","./WidthMiniPart.vue.ad962092.js","./useUtils.437b3e73.js","./useMyFetch.79160f08.js"],import.meta.url).then(c=>c.default||c)),ot=M(()=>N(()=>import("./ujalan_validasi.726d4c8b.js"),["./ujalan_validasi.726d4c8b.js","./HeaderPopup.vue.65f721df.js","./Times.a570b43c.js","./_plugin-vue_export-helper.c27b6911.js","./entry.2c798c4f.js","./entry.493f9183.css","./Check.e6bf60f5.js","./useUtils.437b3e73.js","./useMyFetch.79160f08.js"],import.meta.url).then(c=>c.default||c)),st={class:"w-full h-full flex flex-col"},it={class:"w-full flex grow flex-col overflow-auto h-0"},rt={class:"w-full flex justify-between flex-wrap"},ut={class:"grow flex"},_t={class:"m-1"},dt=_("option",{value:"available"},"Available",-1),pt=_("option",{value:"unapprove"},"Unapprove",-1),ct=_("option",{value:"deleted"},"Trash",-1),mt=_("option",{value:"all"},"All",-1),vt=[dt,pt,ct,mt],ft=_("span",{class:"text-xs ml-1"}," Download ",-1),yt={class:"whitespace-pre-wrap"},bt={class:"grow mb-5"},Gt={__name:"index",async setup(c){let E,Y;const{pointFormat:O}=p(),se=t=>t.deleted==1?"!bg-red-400":t.val==0||t.val1==0?"!bg-gray-300":"",b=i("available");ae(()=>b.value,t=>{Z()},{immediate:!1});const r={};r._TimeZoneOffset=new Date().getTimezoneOffset(),r.sort="tanggal:desc";const G=i({}),I=Ue("token"),{data:ie}=([E,Y]=ze(async()=>Me(async()=>{m().loading_full=!0;let t=[];const[e,w]=await Promise.all([V("/ujalan",{method:"get",headers:{Authorization:`Bearer ${I.value}`,Accept:"application/json"},params:{filter_status:b},retry:0})]);return e.status.value!=="error"&&(t=e.data.value.data),e.status.value==="error"?(z().trigger(e.error),{ujalans:t}):(m().loading_full=!1,{ujalans:t})},"$SN3C927rLk")),E=await E,Y(),E),o=i(ie.value.ujalans||[]),H=i({field:"tanggal",by:"desc"}),n=i(-1),v=T(()=>o.value[n.value]),y=i({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),q=()=>{r.like="";let t=JSON.parse(JSON.stringify(m()._tv.global_keyword));t!=""&&(r.like=`id:%${t}%,xto:%${t}%,tipe:%${t}%,jenis:%${t}%,harga:%${t}%`),r.sort="",H.value.field&&(r.sort=H.value.field+":"+H.value.by),r.filter_model=JSON.stringify(m()._tv.filter_model)},X=async()=>{m().loading_full=!0,G.value={},y.value.may_get_data=!1,r.page=y.value.page,r.page==1&&(o.value=[]),r.first_row&&delete r.first_row,r.page>1&&(r.first_row=JSON.stringify(o.value[0])),r.filter_status=b.value;const{data:t,error:e,status:w}=await V("/ujalan",{method:"get",headers:{Authorization:`Bearer ${I.value}`,Accept:"application/json"},params:r,retry:0});if(m().loading_full=!1,y.value.may_get_data=!0,w.value==="error"){z().trigger(e,G);return}y.value.page==1?o.value=t.value.data:y.value.page>1&&(o.value=[...o.value,...t.value.data]),t.value.data.length==0&&(y.value.is_last_record=!0),m()._tv.filter_box=!1},Z=()=>{n.value=-1,y.value.page=1,y.value.is_last_record=!1,q(),X()},$=i(!1),R=i(!1),S=i(0),k=i(0),x=i(-1),re=()=>{S.value=0,x.value=-1,k.value=!1,$.value=!0},{display:C}=le();Le(le());const ue=()=>{n.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(S.value=o.value[n.value].id,x.value=-1,k.value=!1,$.value=!0)},_e=()=>{n.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(S.value=o.value[n.value].id,x.value=-1,k.value=!1,R.value=!0)},de=()=>{n.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(S.value=o.value[n.value].id,x.value=-1,k.value=!0,$.value=!0)},B=i(!1),U=i(0),pe=()=>{n.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(U.value=o.value[n.value].id,x.value=1,k.value=!1,B.value=!0)},ce=()=>{n.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(U.value=o.value[n.value].id,x.value=0,k.value=!1,B.value=!0)},me=()=>{n.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(U.value=o.value[n.value].id,k.value=!1,x.value=-1,B.value=!0)},K=i(!1),Q=i({}),F=i(!1),A=i(""),ve=async()=>{F.value&&(F.value=!1)},fe=()=>{n.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(A.value="",Q.value={id:o.value[n.value].id,tujuan:o.value[n.value].xto},F.value=!0)};ae(()=>A.value,t=>{t.trim().length>0?K.value=!0:K.value=!1},{immediate:!1});const ye=async()=>{m().loading_full=!0;const t=new FormData;t.append("id",o.value[n.value].id),t.append("deleted_reason",A.value),t.append("_method","DELETE");const{data:e,error:w,status:J}=await V("/ujalan",{method:"post",headers:{Authorization:`Bearer ${I.value}`,Accept:"application/json"},body:t,retry:0});if(m().loading_full=!1,J.value==="error"){z().trigger(w);return}let D={...o.value[n.value]};D.deleted=e.value.deleted,D.deleted_user=e.value.deleted_user,D.deleted_at=e.value.deleted_at,D.deleted_by=e.value.deleted_by,D.deleted_reason=e.value.deleted_reason,b.value!="all"?o.value.splice(n.value,1):o.value.splice(n.value,1,{...D}),n.value=-1,F.value=!1},be=i([{key:"no",label:"No",isai:!0},{key:"val",label:"App 1",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val1",label:"App 2",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"xto",label:"Tujuan",freeze:1,filter_on:1,type:"string"},{key:"asst_opt",label:"Info",filter_on:1,type:"string"},{key:"tipe",label:"Tipe",filter_on:1,type:"string"},{key:"destination_location",label:"Dest. Location",childs:[{key:"destination_location_xto",label:"Xto",type:"string",filter_on:1},{key:"destination_location_minimal_trip",label:"Min Trip",filter_on:1,type:"string"},{key:"destination_location_bonus_trip_supir",label:"Bonus Trip Supir",filter_on:1,type:"number"},{key:"destination_location_bonus_next_trip_supir",label:"Bonus Trip Supir",filter_on:1,type:"number"},{key:"destination_location_bonus_trip_kernet",label:"Bonus Trip Kernet",filter_on:1,type:"number"},{key:"destination_location_bonus_next_trip_kernet",label:"Bonus Trip Kernet",filter_on:1,type:"number"}]},{key:"km_range",label:"Jarak KM",filter_on:1,type:"number"},{key:"jenis",label:"Jenis",filter_on:1,type:"select",select_item:["TBS","TBSK","CPO","PK","LAIN","TUNGGU"]},{key:"harga",label:"Harga",class:" justify-end",type:"number"},{key:"batas_persen_susut",label:"Batas Persen Susut",class:" justify-end",type:"number",tbl_show:p().checkPermission("ujalan.batas_persen_susut.full_act")},{key:"bonus_trip_supir",label:"Bonus Trip Supir",class:" justify-end",type:"number"},{key:"bonus_trip_kernet",label:"Bonus Trip Kernet",class:" justify-end",type:"number"},{key:"note_for_remarks",label:"Ket.U.Remarks",filter_on:1,type:"string"},{key:"transition_from",label:"Pengalihan",filter_on:1,type:"select",select_item:m().list_pabrik},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]),ke=T(()=>n.value>-1&&[void 0,0].indexOf(v.value.deleted)>-1&&p().checkPermission("ujalan.create")),he=T(()=>["available","all","unapprove"].indexOf(b.value)>-1&&p().checkPermission("ujalan.create")),ge=T(()=>n.value>-1&&[void 0,0].indexOf(v.value.deleted)>-1&&(p().checkPermission("ujalan.val")&&[void 0,0].indexOf(v.value.val)>-1||p().checkPermission("ujalan.val1")&&[void 0,0].indexOf(v.value.val1)>-1)&&p().checkPermissions(["ujalan.modify","ujalan.detail.modify","ujalan.detail2.modify"])),xe=T(()=>n.value>-1&&[void 0,0].indexOf(v.value.deleted)>-1&&(p().checkPermission("ujalan.val")&&[void 0,0].indexOf(v.value.val)>-1||p().checkPermission("ujalan.val1")&&[void 0,0].indexOf(v.value.val1)>-1)),we=T(()=>n.value>-1&&[void 0,0].indexOf(v.value.deleted)>-1&&(p().checkPermission("ujalan.unval")&&[1].indexOf(v.value.val)>-1||p().checkPermission("ujalan.unval1")&&[1].indexOf(v.value.val1)>-1)),De=T(()=>n.value>-1&&p().checkPermission("ujalan.remove")&&[void 0,0].indexOf(v.value.deleted)>-1),{downloadFile:je,viewFile:kt}=tt(),Pe=async()=>{q(),m().loading_full=!0,r.filter_status=b.value;const{data:t,error:e,status:w}=await V("/ujalan/download_excel",{method:"get",headers:{Authorization:`Bearer ${I.value}`,Accept:"application/json"},params:r,retry:0});if(m().loading_full=!1,w.value==="error"){z().trigger(e);return}je(t.value)};return(t,e)=>{const w=He,J=Re,D=Ke,W=Je,Ce=Ye,Te=Ge,Se=qe,Ae=Xe,Oe=Ze,ee=Qe,te=We,$e=et,Be=at,Fe=lt,Ee=nt,Ie=ot;return d(),h("div",st,[u(w,{title:"List Ujalan"}),_("div",it,[_("div",rt,[_("div",ut,[_("div",_t,[ne(_("select",{"aria-label":"Filter Status","onUpdate:modelValue":e[0]||(e[0]=a=>oe(b)?b.value=a:null)},vt,512),[[Ve,l(b)]])]),l(ke)?(d(),h("button",{key:0,type:"button",name:"button","aria-label":"Copy Data",class:"m-1 text-2xl",onClick:e[1]||(e[1]=a=>de())},[u(J)])):j("",!0),l(he)?(d(),h("button",{key:1,type:"button",name:"button","aria-label":"New Form",class:"m-1 text-2xl",onClick:e[2]||(e[2]=a=>re())},[u(D)])):j("",!0),l(ge)?(d(),h("button",{key:2,type:"button",name:"button","aria-label":"Edit Form",class:"m-1 text-2xl",onClick:e[3]||(e[3]=a=>ue())},[u(W)])):j("",!0),l(n)>-1?(d(),h("button",{key:3,type:"button",name:"button","aria-label":"View Form",class:"m-1 text-2xl",onClick:e[4]||(e[4]=a=>me())},[u(Ce)])):j("",!0),l(De)?(d(),h("button",{key:4,type:"button",name:"button","aria-label":"Delete Data",class:"m-1 text-2xl",onClick:e[5]||(e[5]=a=>fe())},[u(Te)])):j("",!0),l(xe)?(d(),h("button",{key:5,type:"button",name:"button","aria-label":"Validate Data",class:"m-1 text-2xl",onClick:e[6]||(e[6]=a=>pe())},[u(Se)])):j("",!0),l(we)?(d(),h("button",{key:6,type:"button",name:"button","aria-label":"Unvalidate Data",class:"m-1 text-2xl",onClick:e[7]||(e[7]=a=>ce())},[u(Ae)])):j("",!0),_("button",{type:"button",name:"button",class:"m-1 text-2xl flex items-center",onClick:e[8]||(e[8]=a=>Pe())},[u(Oe),g(),ft]),l(n)>-1&&("useUtils"in t?t.useUtils:l(p))().checkPermission("ujalan.batas_persen_susut.full_act")?(d(),h("button",{key:7,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[9]||(e[9]=a=>_e())},[u(W)])):j("",!0)])]),u($e,{thead:l(be),selected:l(n),onSetSelected:e[10]||(e[10]=a=>n.value=a),tbody:l(o),fnCallData:X,scrolling:l(y),onSetScrollingPage:e[11]||(e[11]=a=>l(y).page=a),onDoFilter:e[12]||(e[12]=a=>Z()),rowBgColor:se},{val:f(({item:a})=>[a.val?(d(),L(te,{key:1})):(d(),L(ee,{key:0}))]),val1:f(({item:a})=>[a.val1?(d(),L(te,{key:1})):(d(),L(ee,{key:0}))]),xto:f(({item:a})=>[_("div",yt,P(a.xto),1)]),destination_location_xto:f(({item:a})=>{var s;return[g(P((s=a.destination_location)==null?void 0:s.xto),1)]}),destination_location_minimal_trip:f(({item:a})=>{var s;return[g(P(l(O)((s=a.destination_location)==null?void 0:s.minimal_trip)),1)]}),destination_location_bonus_trip_supir:f(({item:a})=>{var s;return[g(P(l(O)((s=a.destination_location)==null?void 0:s.bonus_trip_supir)),1)]}),destination_location_bonus_next_trip_supir:f(({item:a})=>{var s;return[g(P(l(O)((s=a.destination_location)==null?void 0:s.bonus_next_trip_supir)),1)]}),destination_location_bonus_trip_kernet:f(({item:a})=>{var s;return[g(P(l(O)((s=a.destination_location)==null?void 0:s.bonus_trip_kernet)),1)]}),destination_location_bonus_next_trip_kernet:f(({item:a})=>{var s;return[g(P(l(O)((s=a.destination_location)==null?void 0:s.bonus_next_trip_kernet)),1)]}),deleted_by_username:f(({item:a})=>{var s;return[g(P((s=a.deleted_by)==null?void 0:s.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])]),u(Be,{type:"delete",show:l(F),data:l(Q),fnClose:ve,fnConfirm:ye,enabledOk:l(K)},{footer:f(()=>[g(" Masukkan Alasan Penghapusan: "),_("div",bt,[ne(_("textarea",{"onUpdate:modelValue":e[13]||(e[13]=a=>oe(A)?A.value=a:null)},null,512),[[Ne,l(A)]])])]),_:1},8,["show","data","enabledOk"]),u(Fe,{show:l($),fnClose:()=>{$.value=!1},id:l(S),p_data:l(o),is_copy:l(k)},null,8,["show","fnClose","id","p_data","is_copy"]),u(Ee,{show:l(R),fnClose:()=>{R.value=!1},id:l(S),p_data:l(o),is_copy:l(k)},null,8,["show","fnClose","id","p_data","is_copy"]),u(Ie,{show:l(B),fnClose:()=>{B.value=!1},id:l(U),p_data:l(o),it_state:l(x)},null,8,["show","fnClose","id","p_data","it_state"])])}}};export{Gt as default};
