import{g as _e,h as ce,r as n,C as fe,j as U,s as pe,f as me,c as f,b as p,a as o,l as t,n as g,F as ve,E as ye,w as he,q as ge,x as m,y as w,o as u,G as we,z as j,t as k,d as ke,k as xe,A as be,m as Ce,B as z,H as De,_ as E}from"./entry.80f9400f.js";import Ae from"./Header.d832b074.js";import Pe from"./Plus.ff7cfb63.js";import ze from"./Edit.8ba83185.js";import Ee from"./Signature.b3ac5cb1.js";import Le from"./Table2Column.1f2f6325.js";import Te from"./TableUp.db8bc3f8.js";import $e from"./Line.0d89352b.js";import Me from"./Check.2d47ab0b.js";import{u as V}from"./useUtils.4905e334.js";import{u as x}from"./useMyFetch.a3705501.js";import{u as Ie}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";const Se=z(()=>E(()=>import("./PopupMini.8abf2423.js"),["./PopupMini.8abf2423.js","./PopupMini.vue.9a484447.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./Exclamation.44603bae.js"],import.meta.url).then(i=>i.default||i)),Ve=z(()=>E(()=>import("./salary_paid.45cc3eed.js"),["./salary_paid.45cc3eed.js","./HeaderPopup.vue.def29a01.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./client-only.b5fd6b3a.js","./useUtils.4905e334.js","./useMyFetch.a3705501.js"],import.meta.url).then(i=>i.default||i)),Be=z(()=>E(()=>import("./salary_paid_validasi.feb6dfb9.js"),["./salary_paid_validasi.feb6dfb9.js","./HeaderPopup.vue.def29a01.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./useUtils.4905e334.js","./useMyFetch.a3705501.js"],import.meta.url).then(i=>i.default||i)),Fe=z(()=>E(()=>import("./PDFView.095cf9d0.js"),["./PDFView.095cf9d0.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./useDownload.174f4da2.js"],import.meta.url).then(i=>i.default||i)),Oe={class:"w-full h-full flex flex-col"},Re={class:"w-full flex grow flex-col overflow-auto h-0"},Ue={class:"w-full flex"},je={class:"w-full flex justify-center items-center grow h-0 p-1"},He={key:0,class:""},Ne={class:"tacky"},Ye=o("thead",null,[o("tr",{class:"sticky top-0 !z-[2]"},[o("th",null,"Logistik"),o("th",null,"ID"),o("th",null,"Period End"),o("th",null,"Period Part"),o("th",null,"Created At"),o("th",null,"Updated At")])],-1),qe=["onClick"],Ge={class:"flex items-center justify-center"},Je={class:"bold"},Ze={class:"grow mb-5"},_t={__name:"index",async setup(i){let b,B;const{$moment:L}=De(),c={};c._TimeZoneOffset=new Date().getTimezoneOffset(),c.sort="created_at:desc";const v=_e("token"),{data:H}=([b,B]=ce(async()=>ge(async()=>{let e=[];m().loading_full=!0;const{data:a,error:_,status:h}=await x("/salary_paids",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:c,retry:0});return m().loading_full=!1,h.value==="error"?(w().trigger(_),{salary_paids:e}):(e=a.value.data,{salary_paids:e})},"$5DNPjgzs1s")),b=await b,B(),b),l=n(H.value.salary_paids);n(""),n({field:"created_at",by:"desc"});const r=n(-1),d=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),C=n(null),N=async()=>{m().loading_full=!0,d.value.may_get_data=!1,c.page=d.value.page,c.page==1&&(l.value=[]),c.first_row&&delete c.first_row,c.page>1&&(c.first_row=JSON.stringify(l.value[0]));const{data:e,error:a,status:_}=await x("/salary_paids",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:c,retry:0});if(m().loading_full=!1,d.value.may_get_data=!0,_.value==="error"){w().trigger(a);return}d.value.page==1?(l.value=e.value.data,C.value&&(C.value.scrollTop=0)):d.value.page>1&&(l.value=[...l.value,...e.value.data]),e.value.data.length==0&&(d.value.is_last_record=!0)},Y=async()=>{if(!d.value.may_get_data)return;let e=C.value;if(e.scrollLeft!=d.value.scrollLeft){d.value.scrollLeft=e.scrollLeft;return}d.value.is_last_record||!(Math.round(e.scrollTop)+e.clientHeight>=e.scrollHeight-1)||(d.value.page++,await N())};fe();const D=n(!1),T=n(0),A=n(0),q=()=>{T.value=0,D.value=!0,A.value=!1},{display:F}=U();pe(U());const G=()=>{r.value==-1?F({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(T.value=l.value[r.value].id,D.value=!0,A.value=!1)},$=n(!1),O=n(0),J=()=>{r.value==-1?F({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(O.value=l.value[r.value].id,A.value=!1,$.value=!0)},M=n(!1),Z=n({}),P=n(!1),y=n(""),K=async()=>{P.value&&(P.value=!1)};me(()=>y.value,e=>{e.trim().length>0?M.value=!0:M.value=!1},{immediate:!1});const Q=async()=>{m().loading_full=!0;const e=new FormData;e.append("id",l.value[r.value].id),e.append("deleted_reason",y.value),e.append("_method","DELETE");const{data:a,error:_,status:h}=await x("/salary_paid",{method:"post",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},body:e,retry:0});if(m().loading_full=!1,h.value==="error"){w().trigger(_);return}l.value.splice(r.value,1),r.value=-1,P.value=!1},{downloadFile:R,viewFile:Ke}=Ie(),I=n(!1),W=n({}),X=async()=>{m().loading_full=!0;const{data:e,error:a,status:_}=await x("/salary_paid/excel_download",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:{id:l.value[r.value].id},retry:0});if(m().loading_full=!1,_.value==="error"){w().trigger(a);return}R(e.value)},ee=async()=>{m().loading_full=!0;const{data:e,error:a,status:_}=await x("/salary_paid/excel_download2",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:{id:l.value[r.value].id},retry:0});if(m().loading_full=!1,_.value==="error"){w().trigger(a);return}R(e.value)};return(e,a)=>{const _=Ae,h=Pe,te=ze,ae=Ee,oe=Le,le=Te,se=$e,ne=Me,re=Se,ie=Ve,ue=Be,de=Fe;return u(),f("div",Oe,[p(_,{title:"List Salary Paid"}),o("div",Re,[o("div",Ue,[("useUtils"in e?e.useUtils:t(V))().checkPermission("salary_paid.create")?(u(),f("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[0]||(a[0]=s=>q())},[p(h)])):g("",!0),("useUtils"in e?e.useUtils:t(V))().checkPermissions(["salary_paid.modify"])?(u(),f("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[1]||(a[1]=s=>G())},[p(te)])):g("",!0),("useUtils"in e?e.useUtils:t(V))().checkPermissions(["salary_paid.val1","salary_paid.val2","salary_paid.val3"])?(u(),f("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[2]||(a[2]=s=>J())},[p(ae)])):g("",!0),t(r)>-1&&t(l)[t(r)].val1==1?(u(),f("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[3]||(a[3]=s=>X())},[p(oe)])):g("",!0),t(r)>-1&&t(l)[t(r)].val1==1?(u(),f("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[4]||(a[4]=s=>ee())},[p(le)])):g("",!0)]),o("div",je,[t(l).length==0?(u(),f("div",He," Maaf Tidak Ada Record ")):(u(),f("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:C,onScroll:Y},[o("table",Ne,[Ye,o("tbody",null,[(u(!0),f(ve,null,ye(t(l),(s,S)=>(u(),f("tr",{key:S,onClick:Qe=>r.value=S,class:we(t(r)==S?"active":"")},[o("td",null,[o("div",Ge,[s.val1?(u(),j(ne,{key:1})):(u(),j(se,{key:0}))])]),o("td",Je,k(s.id),1),o("td",null,k(s.period_end?t(L)(s.period_end).format("MM-Y"):""),1),o("td",null,k(s.period_part),1),o("td",null,k(s.created_at?t(L)(s.created_at).format("DD-MM-Y HH:mm:ss"):""),1),o("td",null,k(s.updated_at?t(L)(s.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,qe))),128))])])],544))])]),p(re,{type:"delete",show:t(P),data:t(Z),fnClose:K,fnConfirm:Q,enabledOk:t(M)},{footer:he(()=>[ke(" Masukkan Alasan Penghapusan: "),o("div",Ze,[xe(o("textarea",{"onUpdate:modelValue":a[5]||(a[5]=s=>Ce(y)?y.value=s:null)},null,512),[[be,t(y)]])])]),_:1},8,["show","data","enabledOk"]),p(ie,{show:t(D),fnClose:()=>{D.value=!1},id:t(T),p_data:t(l),is_copy:t(A)},null,8,["show","fnClose","id","p_data","is_copy"]),p(ue,{show:t($),fnClose:()=>{$.value=!1},id:t(O),p_data:t(l)},null,8,["show","fnClose","id","p_data"]),p(de,{show:t(I),pdfContent:t(W),onClose:a[6]||(a[6]=s=>I.value=!t(I))},null,8,["show","pdfContent"])])}}};export{_t as default};
