import{_ as H}from"./Header.4c4e13a0.js";import{_ as R}from"./client-only.e61f926f.js";import{_ as G}from"./Check.e0722d10.js";import{_ as K}from"./Times.fc483249.js";import{z as Q,r as c,J as W,o as x,c as h,h as w,j as X,k as n,a as e,i as L,v as D,F as O,n as B,b as i,t as k,G as F,f as ee,D as te,L as oe,w as z,l as se,m as P,E as le,x as $,y as E,s as ne}from"./entry.acc468b4.js";import{_ as ae}from"./PrinterEye.6d66a83c.js";import{_ as ie}from"./Table2Column.5340b4b8.js";import{_ as re}from"./PDFView.vue.306a6ce0.js";import{u as N}from"./useMyFetch.c756e4b3.js";import{u as ce}from"./useDownload.737fa5e3.js";import"./_plugin-vue_export-helper.c27b6911.js";const de={class:"bg-white w-full flex flex-row flex-wrap mt-1"},ue={class:"p-1 flex"},_e={class:"flex items-center"},fe=["onClick"],me={class:"pl-1 flex flex-wrap items-center"},pe={class:"w-full"},ve={class:"font-bold"},xe={key:0,class:"w-full"},he={class:"z-[2] w-full flex flex-col mt-1 relative"},we={class:"w-full flex justify-end h-4"},ye={class:"bg-white w-full flex flex-col ring-1 ring-gray-600 max-h-40 overflow-auto"},ge={class:"p-1 flex"},$e={class:"flex items-center"},ke=["onClick"],be=["onClick"],Ce={class:"pl-1 flex flex-wrap items-center"},De={class:"w-full"},Me={class:"font-bold"},Ve={key:0,class:"w-full"},je=Q({__name:"SelectMulti",props:{arr:{type:Array,required:!0,default:[]},list:{type:Array,required:!1,default:[]}},emits:["input","nextBlur"],setup(A,{emit:b}){const u=A,M=c(null);c([]);const l=c(!1),_=c(""),C=W(()=>_.value!=""?u.arr.filter(f=>f.name.toLowerCase().includes(_.value.toLowerCase())):u.arr),r=f=>{let a=u.arr.map(m=>m.id).indexOf(f.id);a!=-1&&(u.arr[a].checked=!u.arr[a].checked)};return(f,a)=>{const m=G,y=K;return x(),h("div",{ref_key:"slt_mul",ref:M,class:"relative",onBlur:a[3]||(a[3]=o=>l.value=!1)},[w(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=o=>L(_)?_.value=o:null),onFocus:a[1]||(a[1]=o=>l.value=!0)},null,544),[[X,n(_)]]),w(e("div",de,[(x(!0),h(O,null,B(A.arr.filter(o=>o.checked),(o,V)=>(x(),h("div",ue,[e("div",_e,[w(e("button",{type:"button",class:"text-white bg-green-500 text-sm",onClick:j=>r(o)},[i(m)],8,fe),[[D,o.checked]])]),e("div",me,[e("div",pe,[e("span",ve," #"+k(o.name),1)]),o.title?(x(),h("div",xe,k(o.title||""),1)):F("",!0)])]))),256))],512),[[D,!n(l)]]),w(e("div",he,[e("div",we,[e("div",{class:"w-8 bg-gray-600 text-white rounded-t flex items-center justify-center font-bold text-sm cursor-pointer",onClick:a[2]||(a[2]=o=>l.value=!1)},[i(y)])]),e("div",ye,[(x(!0),h(O,null,B(n(C),(o,V)=>(x(),h("div",ge,[e("div",$e,[w(e("button",{type:"button",class:"text-white bg-green-500 text-sm",onClick:j=>r(o)},[i(m)],8,ke),[[D,o.checked]]),w(e("button",{type:"button",class:"text-white bg-red-500 text-sm",onClick:j=>r(o)},[i(y)],8,be),[[D,!o.checked]])]),e("div",Ce,[e("div",De,[e("span",Me," #"+k(o.name),1)]),o.title?(x(),h("div",Ve,k(o.title||""),1)):F("",!0)])]))),256))])],512),[[D,n(l)]])],544)}}});const Ae={class:"w-full h-full flex flex-col"},Se={class:"w-full flex grow flex-col overflow-auto h-0 bg-gray-200 justify-center items-center p-2"},Te={class:"bg-white p-2 max-w-[350px] max-h-full overflow-auto"},Ee={action:"#",class:"w-full flex flex-col sm:flex-row flex-wrap text-xs"},Ne={class:"w-full sm:w-1/2 p-1 flex flex-col"},Oe=e("div",{class:"font-bold"}," Tgl Dari ",-1),Ye={class:"text-red-500"},Be={class:"w-full sm:w-1/2 p-1 flex flex-col"},Fe=e("div",{class:"font-bold"}," Tgl Sampai ",-1),ze={class:"text-red-500"},Pe={class:"w-full p-1 flex flex-col"},Le=e("div",{class:"font-bold"}," Lokasi ",-1),Ie={class:"w-full p-1 flex flex-col"},Je=e("div",{class:"font-bold"}," Nama ",-1),Ue={class:"w-full p-1 flex flex-col"},Ze=e("div",{class:"font-bold"}," No Pol ",-1),qe={class:"w-full p-1 flex flex-col"},He=e("div",{class:"font-bold"}," Tipe ",-1),Re=e("option",{value:"header"},"Header",-1),Ge=e("option",{value:"detail"},"Detail",-1),Ke=[Re,Ge],Qe={class:"w-full p-1 flex items-end justify-end"},We=e("div",{class:"text-left m-1"},"Download PDF",-1),Xe=e("div",{class:"text-left m-1"},"Download Excel",-1),_t={__name:"ast_n_driver",async setup(A){let b,u;const{$moment:M}=ne(),l={};l._TimeZoneOffset=new Date().getTimezoneOffset(),l.sort="tanggal:desc";const _=c({}),C=ee("token"),r=c({from:"",to:""}),{data:f}=([b,u]=te(async()=>le(async()=>{$().loading_full=!0;let t=[],s=[],p=[];const[d,S]=await Promise.all([N("/report/ast_n_driver/load_data",{method:"get",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},retry:0})]);return d.status.value!=="error"&&(t=d.data.value.list_xto,p=d.data.value.list_employee,s=d.data.value.list_vehicle),d.status.value==="error"&&E().trigger(d.error),$().loading_full=!1,{list_xto:t,list_employee:p,list_vehicle:s}},"$Aw9scsfjYZ")),b=await b,u(),b),a=c([]),m=c([]),y=c([]);f.value.list_xto.forEach(t=>{a.value.push({id:t,name:t,title:"",checked:!1})}),f.value.list_employee.forEach(t=>{m.value.push({id:t.id,name:t.name,title:t.role,checked:!1})}),f.value.list_vehicle.forEach(t=>{y.value.push({id:t.id,name:t.no_pol,title:"",checked:!1})});const o=c("header"),V=()=>{l._TimeZoneOffset=new Date().getTimezoneOffset(),l.date_from=r.value.from?M(r.value.from).format("YYYY-MM-DD"):"",l.date_to=r.value.to?M(r.value.to).format("YYYY-MM-DD"):"",l.list_xto=JSON.stringify(a.value.filter(t=>t.checked).map(t=>t.id)),l.list_employee=JSON.stringify(m.value.filter(t=>t.checked).map(t=>t.id)),l.list_vehicle=JSON.stringify(y.value.filter(t=>t.checked).map(t=>t.id)),l.type=o.value},{downloadFile:j,viewFile:et}=ce(),g=c(!1),Y=c({}),I=async()=>{if(g.value==!0){g.value=!1;return}V(),$().loading_full=!0;const{data:t,error:s,status:p}=await N("/report/ast_n_driver/pdf_preview",{method:"get",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},params:l,retry:0});if($().loading_full=!1,p.value==="error"){E().trigger(s);return}Y.value=t.value,g.value=!0},J=async()=>{V(),$().loading_full=!0;const{data:t,error:s,status:p}=await N("/report/ast_n_driver/excel_download",{method:"get",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},params:l,retry:0});if($().loading_full=!1,p.value==="error"){E().trigger(s);return}j(t.value)};return(t,s)=>{const p=H,d=oe("vue-date-picker"),S=R,T=je,U=ae,Z=ie,q=re;return x(),h(O,null,[e("div",Ae,[i(p,{title:"Report Transaction"}),e("div",Se,[e("div",Te,[e("form",Ee,[e("div",Ne,[Oe,i(S,null,{default:z(()=>[i(d,{modelValue:n(r).from,"onUpdate:modelValue":s[0]||(s[0]=v=>n(r).from=v),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1}),e("p",Ye,k(n(_).date_from),1)]),e("div",Be,[Fe,i(S,null,{default:z(()=>[i(d,{modelValue:n(r).to,"onUpdate:modelValue":s[1]||(s[1]=v=>n(r).to=v),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1}),e("p",ze,k(n(_).date_to),1)]),e("div",Pe,[Le,i(T,{arr:n(a)},null,8,["arr"])]),e("div",Ie,[Je,i(T,{arr:n(m)},null,8,["arr"])]),e("div",Ue,[Ze,i(T,{arr:n(y)},null,8,["arr"])]),e("div",qe,[He,w(e("select",{"onUpdate:modelValue":s[2]||(s[2]=v=>L(o)?o.value=v:null)},Ke,512),[[se,n(o)]])]),e("div",Qe,[e("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:s[3]||(s[3]=P(v=>I(),["prevent"]))},[e("div",null,[i(U,{class:"text-2xl"})]),We]),e("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:s[4]||(s[4]=P(v=>J(),["prevent"]))},[e("div",null,[i(Z,{class:"text-2xl"})]),Xe])])])])])]),i(q,{show:n(g),pdfContent:n(Y),onClose:s[5]||(s[5]=v=>g.value=!n(g))},null,8,["show","pdfContent"])],64)}}};export{_t as default};
