import lt from"./Header.e8fbd9bd.js";import at from"./Plus.1eea054a.js";import nt from"./Edit.59d28f16.js";import it from"./Signature.c90a1ef5.js";import rt from"./Search.81b0610a.js";import ut from"./Line.e332566a.js";import ct from"./Check.3fd5e058.js";import dt from"./mst.7056f5e6.js";import _t from"./validasi.7c11efbe.js";import{f as mt,g as pt,r as a,h as ft,i as z,s as vt,j as ht,c as _,b as p,a as t,k as o,l as P,m as M,v as yt,n as gt,q as R,x as kt,F as wt,y as xt,z as bt,o as r,C as Ct,D as k,t as c,H as Dt,E as St,A as w,B as O}from"./entry.e36785a7.js";import{u as x}from"./useUtils.e0162c97.js";import{u as E}from"./useMyFetch.23ee3399.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./HeaderPopup.vue.65289720.js";import"./Times.f23511d3.js";import"./WidthMiniList.vue.0b6bd973.js";import"./WidthMiniPart.vue.c01dc684.js";import"./InputPointFormat.vue.38912cbe.js";import"./AttachmentSingle.fd59760b.js";import"./PDFJsView.234e4eee.js";import"./part.80893e58.js";import"./Calculator.17605636.js";import"./trx.a7ff5b9e.js";import"./trx_validasi.b4b58a5e.js";const At={class:"w-full h-full flex flex-col"},$t={class:"w-full flex grow flex-col overflow-auto h-0"},Pt={class:"w-full flex"},Mt={action:"#",class:"w-full flex p-1"},Ut={class:"grow"},jt=t("div",{class:"font-bold"}," Keyword ",-1),Tt={class:"pl-1"},Nt=t("div",{class:"font-bold"}," Sort By ",-1),Ht=Dt('<option value=""></option><option value="id">ID</option><option value="xto">To</option><option value="jenis">Jenis</option><option value="tipe">Tipe</option>',5),Bt=[Ht],Ft={class:"pl-1"},It=t("div",{class:"font-bold"}," Sort Order ",-1),Lt=t("option",{value:"asc"},"Asc",-1),Vt=t("option",{value:"desc"},"Desc",-1),zt=[Lt,Vt],Rt={class:"flex items-end pl-1"},Ot={class:"w-full flex justify-center items-center grow h-0 p-1"},Et={key:0,class:""},Jt={class:"tacky"},Kt=t("thead",null,[t("tr",{class:"sticky top-0 !z-[2]"},[t("th",null,"App 1"),t("th",null,"App 2"),t("th",null,"ID"),t("th",null,"Nama Pekerja"),t("th",null,"No Pol"),t("th",null,"Kejadian"),t("th",null,"Nominal"),t("th",null,"Nominal Potongan"),t("th",null,"Sisa Potongan"),t("th",null,"Status"),t("th",null,"Created At"),t("th",null,"Updated At")])],-1),Yt=["onClick"],qt={class:"flex items-center justify-center"},Zt={class:"flex items-center justify-center"},Gt={class:"bold"},be={__name:"index",async setup(Qt){let h,U;const{$moment:j}=St(),{pointFormat:b}=x(),n={};n._TimeZoneOffset=new Date().getTimezoneOffset(),n.sort="created_at:desc";const T=mt("token"),{data:J}=([h,U]=pt(async()=>bt(async()=>{let s=[];w().loading_full=!0;const{data:l,error:v,status:A}=await E("/potongan_msts",{method:"get",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},params:n,retry:0});return w().loading_full=!1,A.value==="error"?(O().trigger(v),{potongan_msts:s}):(s=l.value.data,{potongan_msts:s})},"$4H5grU4zhJ")),h=await h,U(),h),u=a(J.value.potongan_msts),d=a(""),m=a({field:"created_at",by:"desc"}),f=a(-1),i=a({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),K=()=>{n.like="",d.value!=""&&(n.like=`id:%${d.value}%,employee_name:%${d.value}%,no_pol:%${d.value}%,info:%${d.value}%,status:%${d.value}%`),n.sort="",m.value.field&&(n.sort=m.value.field+":"+m.value.by)},y=a(null),N=async()=>{w().loading_full=!0,i.value.may_get_data=!1,n.page=i.value.page,n.page==1&&(u.value=[]),n.first_row&&delete n.first_row,n.page>1&&(n.first_row=JSON.stringify(u.value[0]));const{data:s,error:l,status:v}=await E("/potongan_msts",{method:"get",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},params:n,retry:0});if(w().loading_full=!1,i.value.may_get_data=!0,v.value==="error"){O().trigger(l);return}i.value.page==1?(u.value=s.value.data,y.value&&(y.value.scrollTop=0)):i.value.page>1&&(u.value=[...u.value,...s.value.data]),s.value.data.length==0&&(i.value.is_last_record=!0)},Y=async()=>{if(!i.value.may_get_data)return;let s=y.value;if(s.scrollLeft!=i.value.scrollLeft){i.value.scrollLeft=s.scrollLeft;return}i.value.is_last_record||!(Math.round(s.scrollTop)+s.clientHeight>=s.scrollHeight-1)||(i.value.page++,await N())},q=()=>{i.value.page=1,i.value.is_last_record=!1,K(),N()};ft();const g=a(!1),C=a(0),D=a(0),Z=()=>{C.value=0,g.value=!0,D.value=!1},{display:H}=z();vt(z());const G=()=>{f.value==-1?H({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(C.value=u.value[f.value].id,g.value=!0,D.value=!1)},S=a(!1),B=a(0),Q=()=>{f.value==-1?H({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(B.value=u.value[f.value].id,S.value=!0)},F=a(!1);a({}),a(!1);const W=a("");return ht(()=>W.value,s=>{s.trim().length>0?F.value=!0:F.value=!1},{immediate:!1}),(s,l)=>{const v=lt,A=at,X=nt,tt=it,et=rt,I=ut,L=ct,ot=dt,st=_t;return r(),_("div",At,[p(v,{title:"List Potongan"}),t("div",$t,[t("div",Pt,[("useUtils"in s?s.useUtils:o(x))().checkPermission("potongan_mst.create")?(r(),_("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:l[0]||(l[0]=e=>Z())},[p(A)])):P("",!0),("useUtils"in s?s.useUtils:o(x))().checkPermissions(["potongan_mst.modify","potongan_trx.create","potongan_trx.modify","potongan_trx.remove"])?(r(),_("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:l[1]||(l[1]=e=>G())},[p(X)])):P("",!0),("useUtils"in s?s.useUtils:o(x))().checkPermissions(["potongan_mst.val","potongan_mst.val1","potongan_trx.val","potongan_trx.val1"])?(r(),_("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:l[2]||(l[2]=e=>Q())},[p(tt)])):P("",!0)]),t("form",Mt,[t("div",Ut,[jt,M(t("input",{class:"",type:"text","onUpdate:modelValue":l[3]||(l[3]=e=>gt(d)?d.value=e:null),name:"search",placeholder:"Keyword"},null,512),[[yt,o(d)]])]),t("div",Tt,[Nt,M(t("select",{class:"","onUpdate:modelValue":l[4]||(l[4]=e=>o(m).field=e)},Bt,512),[[R,o(m).field]])]),t("div",Ft,[It,M(t("select",{class:"","onUpdate:modelValue":l[5]||(l[5]=e=>o(m).by=e)},zt,512),[[R,o(m).by]])]),t("div",Rt,[t("button",{class:"",type:"submit",name:"button",onClick:l[6]||(l[6]=kt(e=>q(),["prevent"]))},[p(et,{class:"text-2xl"})])])]),t("div",Ot,[o(u).length==0?(r(),_("div",Et," Maaf Tidak Ada Record ")):(r(),_("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:y,onScroll:Y},[t("table",Jt,[Kt,t("tbody",null,[(r(!0),_(wt,null,xt(o(u),(e,$)=>{var V;return r(),_("tr",{key:$,onClick:Wt=>f.value=$,class:Ct(o(f)==$?"active":"")},[t("td",null,[t("div",qt,[e.val?(r(),k(L,{key:1})):(r(),k(I,{key:0}))])]),t("td",null,[t("div",Zt,[e.val1?(r(),k(L,{key:1})):(r(),k(I,{key:0}))])]),t("td",Gt,c(e.id),1),t("td",null,c((V=e.employee)==null?void 0:V.name),1),t("td",null,c(e.no_pol),1),t("td",null,c(e.kejadian),1),t("td",null,c(o(b)(e.nominal)),1),t("td",null,c(o(b)(e.nominal_cut)),1),t("td",null,c(o(b)(e.remaining_cut)),1),t("td",null,c(e.status),1),t("td",null,c(e.created_at?o(j)(e.created_at).format("DD-MM-Y HH:mm:ss"):""),1),t("td",null,c(e.updated_at?o(j)(e.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,Yt)}),128))])])],544))])]),p(ot,{show:o(g),fnClose:()=>{g.value=!1},id:o(C),p_data:o(u),is_copy:o(D)},null,8,["show","fnClose","id","p_data","is_copy"]),p(st,{show:o(S),fnClose:()=>{S.value=!1},id:o(B),p_data:o(u)},null,8,["show","fnClose","id","p_data"])])}}};export{be as default};
