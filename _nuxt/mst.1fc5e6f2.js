import{_ as R}from"./HeaderPopup.vue.2b313006.js";import{_ as G}from"./WidthMiniList.vue.0dd6a9cb.js";import{_ as H}from"./InputPointFormat.vue.dade0de4.js";import K from"./part.ec5d10ec.js";import{r as m,f as W,G as F,j as Q,m as b,M as X,o as h,c as g,a as e,b as x,k as a,v as A,t as c,F as Y,y as Z,d as ee,q as te,x as oe,l as V,A as w,B as O,p as le,e as ae}from"./entry.90f7e7d0.js";import{u as j}from"./useMyFetch.ffe077f5.js";import{u as se}from"./useUtils.607571cd.js";import{_ as ne}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.e420182d.js";import"./WidthMiniPart.vue.f91cecf8.js";import"./Plus.0e8db38d.js";import"./Edit.a3f584b7.js";import"./Signature.c40dfa32.js";import"./Calculator.ec79ed3f.js";import"./Search.0fbb0fe2.js";import"./Line.2062a520.js";import"./Check.97a7a142.js";import"./trx.34746a1c.js";const u=r=>(le("data-v-f969d476"),r=r(),ae(),r),ie={class:"box-fixed"},re={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-slate-200"},de={class:"w-full flex flex-col items-center grow overflow-auto"},ue={class:"w-full p-1"},_e={class:"w-full flex flex-row flex-wrap bg-white"},pe={class:"w-full flex flex-col flex-wrap p-1"},me=u(()=>e("label",{for:""},"Kejadian",-1)),ce={class:"text-red-500"},fe={class:"w-full sm:w-9/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},ve=u(()=>e("label",{for:""},"Pekerja",-1)),we={class:"text-red-500"},he={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ge=u(()=>e("label",{for:""},"No Pol",-1)),xe={id:"vehicle"},ye=["value"],ke={class:"text-red-500"},be={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Se=u(()=>e("label",{for:""},"Nominal",-1)),Ne={class:"w-full"},Ce={class:"text-red-500"},Oe={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},je=u(()=>e("label",{for:""},"Nominal Potong",-1)),Je={class:"w-full"},Ie={class:"text-red-500"},Pe={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ue=u(()=>e("label",{for:""},"Sisa Potongan",-1)),$e={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Be=u(()=>e("label",{for:""},"Status",-1)),Fe=u(()=>e("option",{value:"Open"},"Open",-1)),Ae=u(()=>e("option",{value:"Close Clear"},"Close Clear",-1)),Ve=u(()=>e("option",{value:"Close UnClear"},"Close UnClear",-1)),De=[Fe,Ae,Ve],Me={class:"text-red-500"},qe={class:"w-full flex flex-row flex-wrap p-1 justify-end"},Te={key:0,class:"w-full h-full p-1"},ze={class:"w-full flex items-center justify-end bg-white"},Ee={__name:"mst",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},setup(r){const d=r,S={id:-1,kejadian:"",employee:{id:-1,name:""},no_pol:"",nominal:0,nominal_cut:0,remaining_cut:0,status:"Open"},D=m([]);m({ordinal:0,id:"",tanggal:new Date,note:"",p_status:""}),JSON.parse(JSON.stringify(S));const o=m(JSON.parse(JSON.stringify(S))),N=W("token"),_=m({}),M=async()=>{w().loading_full=!0,_.value={};const s=new FormData;s.append("kejadian",o.value.kejadian),s.append("nominal",o.value.nominal),s.append("nominal_cut",o.value.nominal_cut),s.append("status",o.value.status),s.append("employee_id",i.value.id),s.append("no_pol",o.value.no_pol);let t="post",p=d.id;p==0||(s.append("id",p),s.append("_method","PUT"));const{data:l,error:f,status:v}=await j("/potongan_mst",{method:t,headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},body:s,retry:0});if(w().loading_full=!1,v.value==="error"){O().trigger(f,_);return}if(o.value.employee.id=i.value.id,o.value.employee.name=i.value.name,o.value.remaining_cut=l.value.remaining_cut,o.value.updated_at=l.value.updated_at,d.id<=0)o.value.id=l.value.id,o.value.created_at=l.value.created_at,d.p_data.unshift(o.value);else{let n=d.p_data.map(k=>k.id).indexOf(d.id);n>=-1&&d.p_data.splice(n,1,{...o.value})}d.fnClose()},y={_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:"",name:"",title:""},i=m(JSON.parse(JSON.stringify(y))),q=F(()=>{let s=[];return I.value.forEach((t,p)=>{let l=JSON.parse(JSON.stringify(y));l._.id.val=t.id,l._.name.val=t.name,l._.rek_no.val=t.rek_no,l._.rek_name.val=t.rek_name,l.id=t.id,l.name=t.name,l.title=(t.rek_no||"")+" "+(t.rek_name||""),s.push(JSON.parse(JSON.stringify(l)))}),s}),C=F(()=>!1),T=async()=>{var f,v,n,k,P,U,$,B;w().loading_full=!0;const{data:s,error:t,status:p}=await j("/potongan_mst",{method:"get",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},params:{id:d.id},retry:0});if(w().loading_full=!1,p.value==="error"){O().trigger(t);return}let l=s.value.data;o.value=l,{...l},i.value._.id.val=(f=l.employee)==null?void 0:f.id,i.value._.name.val=(v=l.employee)==null?void 0:v.name,i.value._.rek_no.val=(n=l.employee)==null?void 0:n.rek_no,i.value._.rek_name.val=(k=l.employee)==null?void 0:k.rek_name,i.value.id=(P=l.employee)==null?void 0:P.id,i.value.name=(U=l.employee)==null?void 0:U.name,i.value.rek_no=((($=l.employee)==null?void 0:$.rek_no)||"")+" "+(((B=l.employee)==null?void 0:B.rek_name)||"")},z=m([]),E=m([]),J=m([]),I=m([]),L=async()=>{w().loading_full=!0;const{data:s,error:t,status:p}=await j("/potongan_mst_load_local",{method:"get",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},retry:0});if(w().loading_full=!1,p.value==="error"){O().trigger(t);return}z.value=s.value.list_potongan_mst,E.value=s.value.list_xto,J.value=s.value.list_vehicle,I.value=s.value.list_employee};return Q(()=>d.show,async(s,t)=>{s==!0&&(await L(),o.value=JSON.parse(JSON.stringify(S)),i.value=JSON.parse(JSON.stringify(y)),D.value=[],_.value={},d.id!=0&&T())},{immediate:!0}),(s,t)=>{const p=R,l=G,f=H,v=K;return b((h(),g("section",ie,[e("div",null,[x(p,{title:"Form Potongan",fn:r.fnClose,class:"w-full flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",re,[e("div",de,[e("div",ue,[e("div",_e,[e("div",pe,[me,b(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=n=>a(o).kejadian=n),rows:"10"}," ",512),[[A,a(o).kejadian]]),e("p",ce,c(a(_).kejadian),1)]),e("div",fe,[ve,x(l,{arr:a(q),selected:a(i),pure:y,onSetSelected:t[1]||(t[1]=n=>i.value=n)},null,8,["arr","selected"]),e("p",we,c(a(_).employee_id),1)]),e("div",he,[ge,b(e("input",{type:"text",list:"vehicle","onUpdate:modelValue":t[2]||(t[2]=n=>a(o).no_pol=n)},null,512),[[A,a(o).no_pol]]),e("datalist",xe,[(h(!0),g(Y,null,Z(a(J),n=>(h(),g("option",{value:n.no_pol},c(n.no_pol),9,ye))),256))]),e("p",ke,c(a(_).no_pol),1)]),e("div",be,[Se,e("div",Ne,[x(f,{class:"w-full h-full",type:"text",value:a(o).nominal||0,onInput:t[3]||(t[3]=n=>a(o).nominal=n),show:r.show,disabled:a(C)},null,8,["value","show","disabled"])]),e("p",Ce,c(a(_).ref),1)]),e("div",Oe,[je,e("div",Je,[x(f,{class:"w-full h-full",type:"text",value:a(o).nominal_cut||0,onInput:t[4]||(t[4]=n=>a(o).nominal_cut=n),show:r.show,disabled:a(C)},null,8,["value","show","disabled"])]),e("p",Ie,c(a(_).ref),1)]),e("div",Pe,[Ue,ee(" "+c(("useUtils"in s?s.useUtils:a(se))().pointFormat(a(o).remaining_cut)),1)]),e("div",$e,[Be,b(e("select",{"onUpdate:modelValue":t[5]||(t[5]=n=>a(o).status=n)},De,512),[[te,a(o).status]]),e("p",Me,c(a(_).ref),1)]),e("div",qe,[a(C)?V("",!0):(h(),g("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:t[6]||(t[6]=oe(n=>M(),["prevent"]))}," Save "))])])]),a(o).id>0?(h(),g("div",Te,[x(v,{id:r.id,show:r.show,onUpdateRemainingCut:t[7]||(t[7]=n=>a(o).remaining_cut=n)},null,8,["id","show"])])):V("",!0)]),e("div",ze,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:t[8]||(t[8]=n=>r.fnClose())}," Close ")])])])],512)),[[X,r.show]])}}},rt=ne(Ee,[["__scopeId","data-v-f969d476"]]);export{rt as default};
