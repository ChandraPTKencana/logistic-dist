import{r as s,f as Y,g as Ie,h as ze,i as h,j as le,s as Fe,x as u,c as b,b as d,a as c,k as oe,v as Ne,l,m as ne,n as k,w as T,q as Be,y as j,o as _,z as I,d as H,t as se,A as Le,B as U,_ as R,H as Ve}from"./entry.aab07f9f.js";import Ye from"./Header.ca2f02f7.js";import He from"./Copy.24cfa0ac.js";import Ue from"./Plus.0489f412.js";import Re from"./Edit.b4d432af.js";import qe from"./Eyes.9f760706.js";import Je from"./Delete.5ce407c0.js";import Ke from"./Signature.f94486d8.js";import Ge from"./PrinterEye.de0d3f2b.js";import Qe from"./Line.a54bf290.js";import Ze from"./Check.acb99e89.js";import We from"./TableView.c3727f9e.js";import{u as x}from"./useUtils.9fa3f6cd.js";import{u as z}from"./useMyFetch.cb965b1e.js";import{u as Xe}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.79709d1f.js";import"./Adjust.69ff5410.js";import"./TableHeaderEye.530bc726.js";import"./Times.b9004b7b.js";import"./ClearAll.9b9ae5da.js";import"./client-only.a1dffc96.js";import"./ClearEach.8dca629a.js";import"./CaretLeftDoubleBold.772c8b01.js";import"./CaretLeftBold.d939b229.js";import"./CaretRightBold.9b39d0d1.js";import"./CaretRightDoubleBold.25a3f3a4.js";const et=U(()=>R(()=>import("./PopupMini.41da9559.js"),["./PopupMini.41da9559.js","./PopupMini.vue.064584de.js","./Times.b9004b7b.js","./_plugin-vue_export-helper.c27b6911.js","./entry.aab07f9f.js","./entry.c5f8f180.css","./Exclamation.cfb6ed30.js"],import.meta.url).then(p=>p.default||p)),tt=U(()=>R(()=>import("./extra_money.207483d7.js"),["./extra_money.207483d7.js","./HeaderPopup.vue.d7e465de.js","./Times.b9004b7b.js","./_plugin-vue_export-helper.c27b6911.js","./entry.aab07f9f.js","./entry.c5f8f180.css","./WidthMiniList.vue.16991579.js","./WidthMiniPart.vue.f3ab5403.js","./InputPointFormat.vue.2f0e98c5.js","./useUtils.9fa3f6cd.js","./useMyFetch.cb965b1e.js"],import.meta.url).then(p=>p.default||p)),at=U(()=>R(()=>import("./extra_money_validasi.00771569.js"),["./extra_money_validasi.00771569.js","./HeaderPopup.vue.d7e465de.js","./Times.b9004b7b.js","./_plugin-vue_export-helper.c27b6911.js","./entry.aab07f9f.js","./entry.c5f8f180.css","./WidthMiniPart.vue.f3ab5403.js","./useUtils.9fa3f6cd.js","./useMyFetch.cb965b1e.js"],import.meta.url).then(p=>p.default||p)),lt={class:"w-full h-full flex flex-col"},ot={class:"w-full flex grow flex-col overflow-auto h-0"},nt={class:"w-full flex justify-between flex-wrap"},st={class:"grow flex"},rt={class:"m-1"},it=c("option",{value:"available"},"Available",-1),ut=c("option",{value:"unapprove"},"Unapprove",-1),dt=c("option",{value:"deleted"},"Trash",-1),_t=c("option",{value:"all"},"All",-1),mt=[it,ut,dt,_t],ct={class:"grow mb-5"},Vt={__name:"index",async setup(p){let C,q;const{$moment:J}=Ve(),{pointFormat:re}=x(),K=t=>t.deleted==1?"!bg-red-400":t.pv_id>0?"!bg-blue-300":"",F=t=>(t.map(e=>{e.class_h=K(e)}),t),y=s("available");Y(()=>y.value,t=>{X.value.map(e=>{let m=["deleted_by_username","deleted_at","deleted_reason"].indexOf(e.key)>-1;return["all","deleted"].indexOf(t)>-1?m&&(e.tbl_show=1):m&&(e.tbl_show=0),e}),Z()},{immediate:!1});const r={};r._TimeZoneOffset=new Date().getTimezoneOffset(),r.sort="tanggal:desc";const G=s({}),$=s({from:"",to:""}),S=Ie("token"),{data:ie}=([C,q]=ze(async()=>Be(async()=>{u().loading_full=!0;let t=[];const[e,m]=await Promise.all([z("/extra_moneys",{method:"get",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},params:{filter_status:y},retry:0})]);return e.status.value!=="error"&&(t=F(e.data.value.data)),e.status.value==="error"?(j().trigger(e.error),{extra_moneys:t}):(u().loading_full=!1,{extra_moneys:t})},{lazy:!0,server:!1,default:()=>({ujalans:[]})},"$pjdlE6mDqg")),C=await C,q(),C),n=s([]);Y(()=>{var t;return(t=ie.value)==null?void 0:t.extra_moneys},t=>{t&&(n.value=[...t])},{immediate:!0});const N=s({field:"tanggal",by:"desc"}),a=s(-1),i=h(()=>n.value[a.value]),v=s({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),ue=()=>{r.like="";let t=JSON.parse(JSON.stringify(u()._tv.global_keyword));t!=""&&(r.like=`id:%${t}%,transition_target:%${t}%,transition_type:%${t}%,extra_money_name:%${t}%,extra_money_type:%${t}%,xto:%${t}%,transition_target:%${t}%`),r.sort="",N.value.field&&(r.sort=N.value.field+":"+N.value.by),r.date_from=$.value.from?J($.value.from).format("YYYY-MM-DD"):"",r.date_to=$.value.to?J($.value.to).format("YYYY-MM-DD"):"",r.filter_model=JSON.stringify(u()._tv.filter_model)},Q=async()=>{u().loading_full=!0,G.value={},v.value.may_get_data=!1,r.page=v.value.page,r.page==1&&(n.value=[]),r.first_row&&delete r.first_row,r.page>1&&(r.first_row=JSON.stringify(n.value[0])),r.filter_status=y.value;const{data:t,error:e,status:m}=await z("/extra_moneys",{method:"get",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},params:r,retry:0});if(u().loading_full=!1,v.value.may_get_data=!0,m.value==="error"){j().trigger(e,G);return}v.value.page==1?n.value=F(t.value.data):v.value.page>1&&(n.value=[...n.value,...F(t.value.data)]),t.value.data.length==0&&(v.value.is_last_record=!0),u()._tv.filter_box=!1},Z=()=>{a.value=-1,v.value.page=1,v.value.is_last_record=!1,ue(),Q()},P=s(!1),E=s(0),g=s(0),w=s(!1),de=()=>{E.value=0,w.value=!1,g.value=!1,P.value=!0},{display:D}=le();Fe(le());const _e=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(E.value=n.value[a.value].id,w.value=!1,g.value=!1,P.value=!0)},me=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(E.value=n.value[a.value].id,w.value=!1,g.value=!0,P.value=!0)},M=s(!1),B=s(0),ce=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(B.value=n.value[a.value].id,w.value=!1,g.value=!1,M.value=!0)},ve=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(B.value=n.value[a.value].id,w.value=!0,g.value=!1,M.value=!0)},L=s(!1),W=s({}),O=s(!1),A=s(""),fe=async()=>{O.value&&(O.value=!1)},pe=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(A.value="",W.value={id:n.value[a.value].id,tujuan:n.value[a.value].xto},O.value=!0)};Y(()=>A.value,t=>{t.trim().length>0?L.value=!0:L.value=!1},{immediate:!1});const ye=async()=>{u().loading_full=!0;const t=new FormData;t.append("id",n.value[a.value].id),t.append("deleted_reason",A.value),t.append("_method","DELETE");const{data:e,error:m,status:V}=await z("/extra_money",{method:"post",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},body:t,retry:0});if(u().loading_full=!1,V.value==="error"){j().trigger(m);return}let f={...n.value[a.value]};f.deleted=e.value.deleted,f.deleted_user=e.value.deleted_user,f.deleted_at=e.value.deleted_at,f.deleted_by=e.value.deleted_by,f.deleted_reason=e.value.deleted_reason,f.class_h=K(f),y.value!="all"?n.value.splice(a.value,1):n.value.splice(a.value,1,{...f}),a.value=-1,O.value=!1},{printHtml:be}=Xe(),xe=async()=>{if(a.value==-1){D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"});return}u().loading_full=!0;const{data:t,error:e,status:m}=await z("/extra_money_preview_file",{method:"get",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},params:{id:n.value[a.value].id},retry:0});if(u().loading_full=!1,m.value==="error"){j().trigger(e);return}be(t.value.html,318)},X=s([{key:"no",label:"No",isai:!0},{key:"val1",label:"App 1",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val2",label:"App 2",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"xto",label:"Tujuan",freeze:1,filter_on:1,type:"string"},{key:"jenis",label:"Jenis",filter_on:1,type:"select",select_item:["TBS","TBSK","CPO","PK","LAIN","TUNGGU"]},{key:"transition_target",label:"Pengalihan",filter_on:1,type:"select",select_item:u().list_pabrik},{key:"transition_type",label:"Tipe Pengalihan",type:"select",select_item:[{k:"From",v:"Dari"},{k:"To",v:"Ke"}]},{key:"ac_account",label:"Account",childs:[{key:"ac_account_id",label:"Account ID",filter_on:1,type:"string"},{key:"ac_account_code",label:"Account Code",filter_on:1,type:"string"},{key:"ac_account_name",label:"Account Name",filter_on:1,type:"string"}]},{key:"description",label:"Deskripsi",filter_on:1,type:"string"},{key:"qty",label:"Qty",class:" justify-end",type:"number"},{key:"nominal",label:"Nominal",class:" justify-end",type:"number"},{key:"qn_total",label:"Total",class:" justify-end",type:"number"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:0},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:0},{key:"deleted_reason",label:"Deleted Reason",tbl_show:0,type:"string",filter_on:1}]),he=h(()=>a.value>-1&&[void 0,0].indexOf(i.value.deleted)>-1&&x().checkPermission("extra_money.create")),ke=h(()=>["available","all"].indexOf(y.value)>-1&&x().checkPermission("extra_money.create")),ge=h(()=>a.value>-1&&[void 0,0].indexOf(i.value.deleted)>-1&&[void 0,0].indexOf(i.value.val1)>-1&&[void 0,""].indexOf(i.value.pvr_id)>-1&&x().checkPermission("extra_money.modify")),we=h(()=>a.value>-1&&[void 0,0].indexOf(i.value.deleted)>-1&&[void 0,""].indexOf(i.value.pvr_id)>-1&&(x().checkPermission("extra_money.val1")&&[void 0,0].indexOf(i.value.val1)>-1||x().checkPermission("extra_money.val2")&&[void 0,0].indexOf(i.value.val2)>-1)),De=h(()=>x().checkPermission("extra_money.remove")&&a.value>-1&&[void 0,0].indexOf(i.value.deleted)>-1&&[void 0,""].indexOf(i.value.pvr_id)>-1),Ae=h(()=>x().checkPermission("extra_money.preview_file")&&a.value>-1&&[void 0,0].indexOf(i.value.deleted)>-1&&i.value.val==1);return(t,e)=>{const m=Ye,V=He,f=Ue,Pe=Re,Oe=qe,Te=Je,Ce=Ke,$e=Ge,ee=Qe,te=Ze,Se=We,Ee=et,Me=tt,je=at;return _(),b("div",lt,[d(m,{title:"List Transaction"}),c("div",ot,[c("div",nt,[c("div",st,[c("div",rt,[oe(c("select",{class:"","onUpdate:modelValue":e[0]||(e[0]=o=>ne(y)?y.value=o:null)},mt,512),[[Ne,l(y)]])]),l(he)?(_(),b("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[1]||(e[1]=o=>me())},[d(V)])):k("",!0),l(ke)?(_(),b("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[2]||(e[2]=o=>de())},[d(f)])):k("",!0),l(ge)?(_(),b("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[3]||(e[3]=o=>_e())},[d(Pe)])):k("",!0),l(a)>-1?(_(),b("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[4]||(e[4]=o=>ve())},[d(Oe)])):k("",!0),l(De)?(_(),b("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[5]||(e[5]=o=>pe())},[d(Te)])):k("",!0),l(we)?(_(),b("button",{key:5,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[6]||(e[6]=o=>ce())},[d(Ce)])):k("",!0),l(Ae)?(_(),b("button",{key:6,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[7]||(e[7]=o=>xe())},[d($e)])):k("",!0)])]),d(Se,{thead:l(X),selected:l(a),onSetSelected:e[8]||(e[8]=o=>a.value=o),tbody:l(n),fnCallData:Q,scrolling:l(v),onSetScrollingPage:e[9]||(e[9]=o=>l(v).page=o),onDoFilter:e[10]||(e[10]=o=>Z())},{val1:T(({item:o})=>[o.val1?(_(),I(te,{key:1})):(_(),I(ee,{key:0}))]),val2:T(({item:o})=>[o.val2?(_(),I(te,{key:1})):(_(),I(ee,{key:0}))]),qn_total:T(({item:o})=>[H(" Rp. "+se(l(re)(parseFloat(o.total)||0)),1)]),deleted_by_username:T(({item:o})=>{var ae;return[H(se((ae=o.deleted_by)==null?void 0:ae.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])]),d(Ee,{type:"delete",show:l(O),data:l(W),fnClose:fe,fnConfirm:ye,enabledOk:l(L)},{footer:T(()=>[H(" Masukkan Alasan Penghapusan: "),c("div",ct,[oe(c("textarea",{"onUpdate:modelValue":e[11]||(e[11]=o=>ne(A)?A.value=o:null)},null,512),[[Le,l(A)]])])]),_:1},8,["show","data","enabledOk"]),d(Me,{show:l(P),fnClose:()=>{P.value=!1},id:l(E),p_data:l(n),is_copy:l(g)},null,8,["show","fnClose","id","p_data","is_copy"]),d(je,{show:l(M),fnClose:()=>{M.value=!1},id:l(B),p_data:l(n),is_view:l(w)},null,8,["show","fnClose","id","p_data","is_view"])])}}};export{Vt as default};
