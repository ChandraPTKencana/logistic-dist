import{_ as L}from"./HeaderPopup.vue.eec85662.js";import T from"./Refresh.07bcd260.js";import{r as n,g as D,f as B,k as F,K as I,o as c,c as i,a as e,b as k,l as h,F as N,D as j,E as z,t as f,x as m,y as M,p as R,e as $}from"./entry.01c2230e.js";import{u as A}from"./useMyFetch.f17f669a.js";import{_ as E}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.f39974ac.js";const H=s=>(R("data-v-424cb17b"),s=s(),$(),s),O={class:"box-fixed"},V={class:"w-full flex grow flex-col overflow-auto h-0"},q={class:"w-full flex justify-between flex-wrap"},J={class:"grow flex"},P={class:"w-full flex justify-center items-center grow h-0 p-1"},K={key:0,class:""},Z={class:"tacky"},G=H(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"Jenis Tiket"),e("th",null,"No Ticket"),e("th",null,"Lebih")])],-1)),Q=["onClick"],U={__name:"trx_trp_ticket_over",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1}},setup(s){const w=s,l={};l._TimeZoneOffset=new Date().getTimezoneOffset(),l.sort="tanggal:desc";const g=n({}),x=D("token"),o=n([]),d=n(-1),t=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),p=async()=>{m().loading_full=!0,g.value={},t.value.may_get_data=!1,l.page=t.value.page,l.page==1&&(o.value=[]),l.first_row&&delete l.first_row,l.page>1&&(l.first_row=JSON.stringify(o.value[0]));const{data:a,error:r,status:v}=await A("/trx_trps/ticket_over",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:l,retry:0});if(m().loading_full=!1,t.value.may_get_data=!0,v.value==="error"){M().trigger(r,g);return}t.value.page==1?o.value=a.value.data:t.value.page>1&&(o.value=[...o.value,...a.value.data]),a.value.data.length==0&&(t.value.is_last_record=!0),m()._tv.filter_box=!1},b=()=>{d.value=-1,t.value.page=1,t.value.is_last_record=!1,p()},y=n(null),C=async()=>{if(!t.value.may_get_data)return;let a=y.value;if(a.scrollLeft!=t.value.scrollLeft){t.value.scrollLeft=a.scrollLeft;return}t.value.is_last_record||!(Math.round(a.scrollTop)+a.clientHeight>=a.scrollHeight-1)||(t.value.page++,await p())};return B(()=>w.show,(a,r)=>{a==!0&&p()},{immediate:!0}),(a,r)=>{const v=L,S=T;return F((c(),i("section",O,[e("div",null,[k(v,{title:"Form Check Tickets",fn:s.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("div",V,[e("div",q,[e("div",J,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:r[0]||(r[0]=u=>b())},[k(S)])])]),e("div",P,[h(o).length==0?(c(),i("div",K," Maaf Tidak Ada Record ")):(c(),i("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:y,onScroll:C},[e("table",Z,[G,e("tbody",null,[(c(!0),i(N,null,j(h(o),(u,_)=>(c(),i("tr",{key:_,onClick:W=>d.value=_,class:z(h(d)==_?"active":"")},[e("td",null,f(_+1)+".",1),e("td",null,f(u.jenis),1),e("td",null,f(u.ticket_no),1),e("td",null,f(u.lebih),1)],10,Q))),128))])])],544))])])])],512)),[[I,s.show]])}}},se=E(U,[["__scopeId","data-v-424cb17b"]]);export{se as default};
