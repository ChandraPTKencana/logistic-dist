import Se from"./Header.f4f1ee70.js";import $e from"./Copy.4271ef9a.js";import Ae from"./Plus.9f5f997b.js";import Te from"./Edit.ee1f63a2.js";import Pe from"./Eyes.979cfbf0.js";import Me from"./Delete.3c4808f1.js";import Oe from"./Signature.331175d9.js";import Ie from"./Line.771f1e02.js";import Ne from"./Check.a15db1bc.js";import Be from"./TypeIcon.5d414138.js";import Fe from"./TableView.d746017b.js";import{_ as Ee}from"./PopupMini.vue.574bf002.js";import je from"./employee.b46e812f.js";import ze from"./employee_validasi.b6bf71d5.js";import{r as s,f as G,g as Ve,h as He,i as g,B as Re,j as Q,s as Le,c as b,a as i,b as r,k as W,v as Ue,l as o,m as X,n as h,w as x,F as Ye,q as Je,x as m,y as V,o as u,z as O,d as H,t as ee,A as Ke,p as qe,e as Ze}from"./entry.aa3fda92.js";import{u as R}from"./useMyFetch.9afcdb0b.js";import{u as v}from"./useUtils.647d3ea4.js";import{_ as Ge}from"./_plugin-vue_export-helper.c27b6911.js";import"./DocJPEG.f0157b19.js";import"./DocJPG.f835fc7c.js";import"./DocPNG.44d5fcfa.js";import"./DocPDF.b7a3eb1c.js";import"./Search.e22861f4.js";import"./Adjust.d551fe56.js";import"./TableHeaderEye.cd11de27.js";import"./Times.29115eb5.js";import"./ClearAll.ff3b99fc.js";import"./client-only.ce07a1c2.js";import"./ClearEach.d1843ccc.js";import"./CaretLeftDoubleBold.3ed99f36.js";import"./CaretLeftBold.889bf4b5.js";import"./CaretRightBold.f379a332.js";import"./CaretRightDoubleBold.a5ab5f46.js";import"./Exclamation.e8cb86dc.js";import"./HeaderPopup.vue.232e2279.js";import"./AttachmentSingle.867ef67e.js";import"./PDFJsView.278a9411.js";const I=A=>(qe("data-v-0d5f4c01"),A=A(),Ze(),A),Qe={class:"w-full h-full flex flex-col"},We={class:"w-full flex grow flex-col overflow-auto h-0"},Xe={class:"w-full flex justify-between flex-wrap"},et={class:"grow flex"},tt={class:"m-1"},lt=I(()=>i("option",{value:"available"},"Available",-1)),at=I(()=>i("option",{value:"unapprove"},"Unapprove",-1)),ot=I(()=>i("option",{value:"deleted"},"Trash",-1)),nt=I(()=>i("option",{value:"all"},"All",-1)),st=[lt,at,ot,nt],rt={class:"grow mb-5"},it={__name:"index",async setup(A){let T,L;const te=t=>t.deleted==1?"!bg-red-400":t.val==0||t.val1==0?"!bg-gray-300":"",p=s("available");G(()=>p.value,t=>{J()},{immediate:!1});const d={};d._TimeZoneOffset=new Date().getTimezoneOffset();const N=Ve("token"),{data:n}=([T,L]=He(async()=>Je(async()=>{m().loading_full=!0;const{data:t,error:e,status:y}=await R("/employees",{method:"get",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},params:{filter_status:p},retry:0});return m().loading_full=!1,y.value==="error"?(V().trigger(e),[]):t.value.data},"$p5jj5crAgd")),T=await T,L(),T),B=s({field:"",by:"desc"}),l=s(-1),_=s({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),c=g(()=>n.value[l.value]),le=()=>{d.like="";let t=JSON.parse(JSON.stringify(m()._tv.global_keyword));t!=""&&(d.like=`id:%${t}%,name:%${t}%,ktp_no:%${t}%,sim_no:%${t}%,phone_number:%${t}%,rek_no:%${t}%`),d.sort="",B.value.field&&(d.sort=B.value.field+":"+B.value.by),d.filter_model=JSON.stringify(m()._tv.filter_model)},U=s(null),Y=async()=>{m().loading_full=!0,_.value.may_get_data=!1,d.page=_.value.page,d.page==1&&(n.value=[]),d.filter_status=p.value;const{data:t,error:e,status:y}=await R("/employees",{method:"get",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},params:d,retry:0});if(m().loading_full=!1,_.value.may_get_data=!0,y.value==="error"){V().trigger(e);return}_.value.page==1?(n.value=t.value.data,U.value&&(U.value.scrollTop=0)):_.value.page>1&&(n.value=[...n.value,...t.value.data]),t.value.data.length==0&&(_.value.is_last_record=!0),m()._tv.filter_box=!1},J=()=>{l.value=-1,_.value.page=1,_.value.is_last_record=!1,le(),Y()};Re();const w=s(!1),P=s(0),F=s(0),D=s(!1),ae=()=>{P.value=0,D.value=!1,F.value=!1,w.value=!0},{display:C}=Q();Le(Q());const oe=()=>{l.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=n.value[l.value].id,D.value=!1,F.value=!1,w.value=!0)},ne=()=>{l.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=n.value[l.value].id,D.value=!1,F.value=!0,w.value=!0)},M=s(!1),E=s(0),se=()=>{l.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(E.value=n.value[l.value].id,D.value=!1,M.value=!0)},re=()=>{l.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(E.value=n.value[l.value].id,D.value=!0,M.value=!0)},j=s(!1),K=s({}),S=s(!1),k=s(""),ie=async()=>{S.value&&(S.value=!1)},ue=()=>{l.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(k.value="",K.value={id:n.value[l.value].id},S.value=!0)};G(()=>k.value,t=>{t.trim().length>0?j.value=!0:j.value=!1},{immediate:!1});const de=async()=>{m().loading_full=!0;const t=new FormData;t.append("id",n.value[l.value].id),t.append("deleted_reason",k.value),t.append("_method","DELETE");const{data:e,error:y,status:z}=await R("/employee",{method:"post",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},body:t,retry:0});if(m().loading_full=!1,z.value==="error"){V().trigger(y);return}let f={...n.value[l.value]};f.deleted=e.value.deleted,f.deleted_user=e.value.deleted_user,f.deleted_at=e.value.deleted_at,f.deleted_by=e.value.deleted_by,f.deleted_reason=e.value.deleted_reason,p.value!="all"?n.value.splice(l.value,1):n.value.splice(l.value,1,{...f}),l.value=-1,S.value=!1},_e=s([{key:"no",label:"No",isai:!0},{key:"val",label:"App 1",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"id",label:"ID",freeze:1,filter_on:1,type:"number"},{key:"name",label:"Nama",freeze:1,freeze_left:"44px",filter_on:1,type:"string",sort:{priority:1,type:"asc"}},{key:"role",label:"Jabatan",filter_on:1,type:"string"},{key:"ktp_no",label:"No KTP",filter_on:1,type:"string"},{key:"sim_no",label:"No SIM",filter_on:1,type:"string"},{key:"bank_code",label:"Nama Bank",filter_on:1,type:"string"},{key:"rek_no",label:"No Rek",filter_on:1,type:"string"},{key:"rek_name",label:"Nama Rek",filter_on:1,type:"string"},{key:"phone_number",label:"No Tlp",filter_on:1,type:"string"},{key:"birth_place",label:"Tempat Lahir",filter_on:1,type:"string"},{key:"birth_date",label:"Tanggal Lahir",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"tmk",label:"TMK",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"address",label:"Alamat",filter_on:1,type:"string"},{key:"status",label:"Status",filter_on:1,type:"string"},{key:"attachment_1_type",label:"File",type:"string"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]),me=g(()=>l.value>-1&&[void 0,0].indexOf(c.value.deleted)>-1&&v().checkPermission("employee.create")),pe=g(()=>["available","all","unapprove"].indexOf(p.value)>-1&&v().checkPermission("employee.create")),ce=g(()=>l.value>-1&&[void 0,0].indexOf(c.value.deleted)>-1&&(v().checkPermission("employee.val")&&[void 0,0].indexOf(c.value.val)>-1||v().checkPermission("employee.val1")&&[void 0,0].indexOf(c.value.val1)>-1)&&v().checkPermissions(["employee.modify","employee.detail.modify","employee.detail2.modify"])),fe=g(()=>l.value>-1&&[void 0,0].indexOf(c.value.deleted)>-1&&(v().checkPermission("employee.val")&&[void 0,0].indexOf(c.value.val)>-1||v().checkPermission("employee.val1")&&[void 0,0].indexOf(c.value.val1)>-1)),ve=g(()=>l.value>-1&&v().checkPermission("employee.remove")&&[void 0,0].indexOf(c.value.deleted)>-1);return(t,e)=>{const y=Se,z=$e,f=Ae,ye=Te,be=Pe,ke=Me,ge=Oe,q=Ie,Z=Ne,he=Be,xe=Fe,we=Ee,De=je,Ce=ze;return u(),b(Ye,null,[i("div",Qe,[r(y,{title:"List Employee"}),i("div",We,[i("div",Xe,[i("div",et,[i("div",tt,[W(i("select",{class:"","onUpdate:modelValue":e[0]||(e[0]=a=>X(p)?p.value=a:null)},st,512),[[Ue,o(p)]])]),o(me)?(u(),b("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[1]||(e[1]=a=>ne())},[r(z)])):h("",!0),o(pe)?(u(),b("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[2]||(e[2]=a=>ae())},[r(f)])):h("",!0),o(ce)?(u(),b("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[3]||(e[3]=a=>oe())},[r(ye)])):h("",!0),o(l)>-1?(u(),b("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[4]||(e[4]=a=>re())},[r(be)])):h("",!0),o(ve)?(u(),b("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[5]||(e[5]=a=>ue())},[r(ke)])):h("",!0),o(fe)?(u(),b("button",{key:5,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[6]||(e[6]=a=>se())},[r(ge)])):h("",!0)])]),r(xe,{thead:o(_e),selected:o(l),onSetSelected:e[7]||(e[7]=a=>l.value=a),tbody:o(n),fnCallData:Y,scrolling:o(_),onSetScrollingPage:e[8]||(e[8]=a=>o(_).page=a),onDoFilter:e[9]||(e[9]=a=>J()),rowBgColor:te},{val:x(({item:a})=>[a.val?(u(),O(Z,{key:1})):(u(),O(q,{key:0}))]),val1:x(({item:a})=>[a.val1?(u(),O(Z,{key:1})):(u(),O(q,{key:0}))]),bank_code:x(({item:a})=>{var $;return[H(ee(($=a.bank)==null?void 0:$.code),1)]}),attachment_1_type:x(({item:a})=>[r(he,{value:a.attachment_1_type},null,8,["value"])]),deleted_by_username:x(({item:a})=>{var $;return[H(ee(($=a.deleted_by)==null?void 0:$.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])])]),r(we,{type:"delete",show:o(S),data:o(K),fnClose:ie,fnConfirm:de,enabledOk:o(j)},{footer:x(()=>[H(" Masukkan Alasan Penghapusan: "),i("div",rt,[W(i("textarea",{"onUpdate:modelValue":e[10]||(e[10]=a=>X(k)?k.value=a:null)},null,512),[[Ke,o(k)]])])]),_:1},8,["show","data","enabledOk"]),r(De,{show:o(w),fnClose:()=>{w.value=!1},id:o(P),p_data:o(n)},null,8,["show","fnClose","id","p_data"]),r(Ce,{show:o(M),fnClose:()=>{M.value=!1},id:o(E),p_data:o(n)},null,8,["show","fnClose","id","p_data"])],64)}}},Jt=Ge(it,[["__scopeId","data-v-0d5f4c01"]]);export{Jt as default};
