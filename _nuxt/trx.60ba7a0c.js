import{_ as A}from"./HeaderPopup.vue.8f4eeb55.js";import{_ as B}from"./InputPointFormat.vue.ed1ac573.js";import{r as _,g as P,f as S,k as v,K as q,o as D,c as F,a as e,b as w,l as s,t as x,A as N,C as V,x as c,y as h}from"./entry.c21ffdc3.js";import{u as g}from"./useMyFetch.f843d345.js";import"./Times.022951bf.js";import"./_plugin-vue_export-helper.c27b6911.js";const j={class:"box-fixed"},M={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},T={class:"w-full flex flex-col items-center grow overflow-auto"},z={class:"w-full flex flex-row flex-wrap"},E={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},I=e("label",{for:""},"Nominal Potong",-1),K={class:"w-full"},R={class:"text-red-500"},U={class:"w-full flex flex-col flex-wrap p-1"},H=e("label",{for:""},"Keterangan",-1),O={class:"text-red-500"},G={class:"w-full flex items-center justify-end"},Z={__name:"trx",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},potongan_mst_id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},emits:["updateRemainingCut"],setup(d,{emit:y}){const o=d,f={id:-1,note:"",nominal_cut:""},t=_({...f}),p=P("token"),u=_({}),b=async()=>{c().loading_full=!0,u.value={};const l=new FormData;l.append("potongan_mst_id",o.potongan_mst_id),l.append("note",t.value.note),l.append("nominal_cut",t.value.nominal_cut);let a="post",i=o.id;i==0||(l.append("id",i),l.append("_method","PUT"));const{data:r,error:n,status:k}=await g("/potongan_trx",{method:a,headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},body:l,retry:0});if(c().loading_full=!1,k.value==="error"){h().trigger(n,u);return}if(t.value.updated_at=r.value.updated_at,o.id<=0)t.value.id=r.value.id,t.value.created_at=r.value.created_at,o.p_data.unshift(t.value);else{let m=o.p_data.map($=>$.id).indexOf(o.id);m>=-1&&o.p_data.splice(m,1,{...t.value})}y("updateRemainingCut",r.value.remaining_cut),o.fnClose()},C=async()=>{c().loading_full=!0;const{data:l,error:a,status:i}=await g("/potongan_trx",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:{id:o.id},retry:0});if(c().loading_full=!1,i.value==="error"){h().trigger(a);return}t.value=l.value.data};return S(()=>o.show,(l,a)=>{l==!0&&(t.value={...f},u.value={},o.id!=0&&C())},{immediate:!0}),(l,a)=>{const i=A,r=B;return v((D(),F("section",j,[e("div",null,[w(i,{title:"Form Potongan Trx",fn:d.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",M,[e("div",T,[e("div",z,[e("div",E,[I,e("div",K,[w(r,{class:"w-full h-full",type:"text",value:s(t).nominal_cut||0,onInput:a[0]||(a[0]=n=>s(t).nominal_cut=n),show:d.show,disabled:s(t).trx_trp_id},null,8,["value","show","disabled"])]),e("p",R,x(s(u).ref),1)]),e("div",U,[H,v(e("textarea",{"onUpdate:modelValue":a[1]||(a[1]=n=>s(t).note=n),rows:"10"}," ",512),[[N,s(t).note]]),e("p",O,x(s(u).note),1)])])]),e("div",G,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:a[2]||(a[2]=n=>d.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:a[3]||(a[3]=V(n=>b(),["prevent"]))}," Save ")])])])],512)),[[q,d.show]])}}};export{Z as default};
