import{_ as L}from"./HeaderPopup.vue.74859f5a.js";import T from"./Refresh.32228eb5.js";import{r as n,f as B,j,m as F,J as I,o as c,c as i,a as e,b as y,k as m,F as N,y as z,C as A,t as f,A as h,B as D,p as M,e as R}from"./entry.39fdf8d7.js";import{u as $}from"./useMyFetch.f7da0529.js";import{_ as H}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.6046cef3.js";const J=l=>(M("data-v-d4323c04"),l=l(),R(),l),O={class:"box-fixed"},V={class:"w-full flex grow flex-col overflow-auto h-0"},q={class:"w-full flex justify-between flex-wrap"},E={class:"grow flex"},P={class:"w-full flex justify-center items-center grow h-0 p-1"},Z={key:0,class:""},G={class:"tacky"},K=J(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"Jenis Tiket"),e("th",null,"No Ticket"),e("th",null,"Lebih")])],-1)),Q=["onClick"],U={__name:"trx_trp_ticket_over",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1}},setup(l){const w=l,s={};s._TimeZoneOffset=new Date().getTimezoneOffset(),s.sort="tanggal:desc";const g=n({}),x=B("token"),o=n([]),d=n(-1),t=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),p=async()=>{h().loading_full=!0,g.value={},t.value.may_get_data=!1,s.page=t.value.page,s.page==1&&(o.value=[]),s.first_row&&delete s.first_row,s.page>1&&(s.first_row=JSON.stringify(o.value[0]));const{data:a,error:r,status:v}=await $("/trx_trps/ticket_over",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:s,retry:0});if(h().loading_full=!1,t.value.may_get_data=!0,v.value==="error"){D().trigger(r,g);return}t.value.page==1?o.value=a.value.data:t.value.page>1&&(o.value=[...o.value,...a.value.data]),a.value.data.length==0&&(t.value.is_last_record=!0),h()._tv.filter_box=!1},b=()=>{d.value=-1,t.value.page=1,t.value.is_last_record=!1,p()},k=n(null),C=async()=>{if(!t.value.may_get_data)return;let a=k.value;if(a.scrollLeft!=t.value.scrollLeft){t.value.scrollLeft=a.scrollLeft;return}t.value.is_last_record||!(Math.round(a.scrollTop)+a.clientHeight>=a.scrollHeight-1)||(t.value.page++,await p())};return j(()=>w.show,(a,r)=>{a==!0&&p()},{immediate:!0}),(a,r)=>{const v=L,S=T;return F((c(),i("section",O,[e("div",null,[y(v,{title:"Form Check Tickets",fn:l.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("div",V,[e("div",q,[e("div",E,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:r[0]||(r[0]=u=>b())},[y(S)])])]),e("div",P,[m(o).length==0?(c(),i("div",Z," Maaf Tidak Ada Record ")):(c(),i("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:k,onScroll:C},[e("table",G,[K,e("tbody",null,[(c(!0),i(N,null,z(m(o),(u,_)=>(c(),i("tr",{key:_,onClick:W=>d.value=_,class:A(m(d)==_?"active":"")},[e("td",null,f(_+1)+".",1),e("td",null,f(u.jenis),1),e("td",null,f(u.ticket_no),1),e("td",null,f(u.lebih),1)],10,Q))),128))])])],544))])])])],512)),[[I,l.show]])}}},le=H(U,[["__scopeId","data-v-d4323c04"]]);export{le as default};
