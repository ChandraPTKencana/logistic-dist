import{r as s,f as R,g as ve,h as ye,i as h,j as q,s as ge,c as b,a as c,b as p,k as he,v as be,l,m as ke,n as S,w as H,F as xe,q as we,x as d,y as P,o as k,d as J,t as Y,B as O,_ as B,p as De,e as Ae}from"./entry.36c38a87.js";import Ce from"./Header.652a6bc3.js";import Se from"./Copy.33940a82.js";import Pe from"./Plus.62845205.js";import Te from"./Edit.22daa074.js";import Ee from"./Delete.1fcbd518.js";import $e from"./TableView.89032e76.js";import{u as T}from"./useMyFetch.933fc75d.js";import{u as E}from"./useUtils.a0510d7f.js";import{_ as ze}from"./_plugin-vue_export-helper.c27b6911.js";import"./Search.13f381d5.js";import"./Adjust.e9f62f5e.js";import"./TableHeaderEye.fbdb74ba.js";import"./Times.1c210fa8.js";import"./ClearAll.02e2a0d2.js";import"./client-only.68fc6f49.js";import"./ClearEach.3642c752.js";import"./CaretLeftDoubleBold.eaa05186.js";import"./CaretLeftBold.c18ec9ea.js";import"./CaretRightBold.e7374f7a.js";import"./CaretRightDoubleBold.dc954a45.js";const Fe=O(()=>B(()=>import("./PopupMini.94663181.js"),["./PopupMini.94663181.js","./PopupMini.vue.577db0ef.js","./Times.1c210fa8.js","./_plugin-vue_export-helper.c27b6911.js","./entry.36c38a87.js","./entry.d3e41f65.css","./Exclamation.fa871340.js"],import.meta.url).then(n=>n.default||n)),Ie=O(()=>B(()=>import("./user.3d3b3d06.js"),["./user.3d3b3d06.js","./HeaderPopup.vue.efc68b23.js","./Times.1c210fa8.js","./_plugin-vue_export-helper.c27b6911.js","./entry.36c38a87.js","./entry.d3e41f65.css","./useMyFetch.933fc75d.js"],import.meta.url).then(n=>n.default||n)),Oe=O(()=>B(()=>import("./GAQR.bb8e6663.js"),["./GAQR.bb8e6663.js","./Times.1c210fa8.js","./_plugin-vue_export-helper.c27b6911.js","./entry.36c38a87.js","./entry.d3e41f65.css"],import.meta.url).then(n=>n.default||n)),L=n=>(De("data-v-8d80772a"),n=n(),Ae(),n),Be={class:"w-full h-full flex flex-col"},Le={class:"w-full flex grow flex-col overflow-auto h-0"},Ne={class:"w-full flex justify-between flex-wrap"},Ue={class:"grow flex"},Ve={class:"m-1"},je=L(()=>c("option",{value:"active"},"Active",-1)),Me=L(()=>c("option",{value:"nonactive"},"Nonactive",-1)),Re=L(()=>c("option",{value:"all"},"All",-1)),qe=[je,Me,Re],He={__name:"index",async setup(n){let x,N;const G=e=>e.is_active==0?"!bg-red-400":"",m=s("active");R(()=>m.value,e=>{V()},{immediate:!1});const u={};u._TimeZoneOffset=new Date().getTimezoneOffset();const w=ve("token"),{data:Q}=([x,N]=ye(async()=>we(async()=>{d().loading_full=!0;let e=[];const{data:t,error:i,status:g}=await T("/users",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:{filter_status:m},retry:0});return d().loading_full=!1,g.value==="error"?(P().trigger(i),[]):(e=t.value.data,{users:e})},{lazy:!0,server:!1,default:()=>({users:[]})},"$4SJ9UL5Y8i")),x=await x,N(),x),o=s([]);R(()=>{var e;return(e=Q.value)==null?void 0:e.users},e=>{e&&(o.value=[...e])},{immediate:!0}),s("");const $=s({field:"",by:"desc"}),a=s(-1),_=s({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),z=h(()=>o.value[a.value]),Z=()=>{u.like="";let e=JSON.parse(JSON.stringify(d()._tv.global_keyword));e!=""&&(u.like=`id:%${e}%,username:%${e}%`),u.sort="",$.value.field&&(u.sort=$.value.field+":"+$.value.by),u.filter_model=JSON.stringify(d()._tv.filter_model)},K=e=>{let t=[];return e.permission_group_users&&e.permission_group_users.length>0&&e.permission_group_users.forEach(i=>{t.push(i.permission_group.name)}),t.join(",")};s(null);const U=async()=>{d().loading_full=!0,_.value.may_get_data=!1,u.page=_.value.page,u.page==1&&(o.value=[]),u.filter_status=m.value;const{data:e,error:t,status:i}=await T("/users",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:u,retry:0});if(d().loading_full=!1,_.value.may_get_data=!0,i.value==="error"){P().trigger(t);return}_.value.page==1?o.value=e.value.data:_.value.page>1&&(o.value=[...o.value,...e.value.data]),e.value.data.length==0&&(_.value.is_last_record=!0),d()._tv.filter_box=!1},V=()=>{a.value=-1,_.value.page=1,_.value.is_last_record=!1,Z(),U()},v=s(!1),D=s(0),A=s(0),F=s(!1),W=()=>{D.value=0,F.value=!1,A.value=!1,v.value=!0},{display:C}=q();ge(q());const X=()=>{a.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(D.value=o.value[a.value].id,F.value=!1,A.value=!1,v.value=!0)},ee=()=>{a.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(D.value=o.value[a.value].id,F.value=!1,A.value=!0,v.value=!0)},j=s({}),y=s(!1),te=async()=>{y.value&&(y.value=!1)},ae=()=>{a.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(j.value={id:o.value[a.value].id},y.value=!0)},le=async()=>{d().loading_full=!0;const e=new FormData;e.append("id",o.value[a.value].id),e.append("_method","DELETE");const{data:t,error:i,status:g}=await T("/user",{method:"post",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},body:e,retry:0});if(d().loading_full=!1,g.value==="error"){P().trigger(i);return}let f={...o.value[a.value]};f.deleted=t.value.deleted,f.deleted_user=t.value.deleted_user,f.deleted_at=t.value.deleted_at,f.deleted_by=t.value.deleted_by,f.deleted_reason=t.value.deleted_reason,m.value!="all"?o.value.splice(a.value,1):o.value.splice(a.value,1,{...f}),a.value=-1,y.value=!1},M=s(""),I=s(!1),oe=async()=>{if(a.value==-1){C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"});return}u.id=o.value[a.value].id,d().loading_full=!0;const{data:e,error:t,status:i}=await T("/ga_qr",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:u,retry:0});if(d().loading_full=!1,i.value==="error"){P().trigger(t);return}M.value=e.value,I.value=!0},se=s([{key:"no",label:"No",isai:!0},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"username",label:"Username",freeze:1,filter_on:1,type:"string",sort:{priority:1,type:"asc"}},{key:"hak_akses",label:"Hak Akses",filter_on:1,type:"string"},{key:"group",label:"Group",filter_on:1,type:"string"},{key:"is_active",label:"Status",filter_on:1,type:"select",select_item:[{k:"1",v:"Ya"},{k:"0",v:"Tidak"}]},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1}]),re=h(()=>a.value>-1&&[void 0,0].indexOf(z.value.deleted)>-1&&E().checkPermission("user.create")),ne=h(()=>["active","nonactive","all"].indexOf(m.value)>-1&&E().checkPermission("user.create")),ue=h(()=>a.value>-1&&[void 0,0].indexOf(z.value.deleted)>-1&&E().checkPermissions(["user.modify"])),ie=h(()=>a.value>-1&&E().checkPermission("user.remove")&&[void 0,0].indexOf(z.value.deleted)>-1);return(e,t)=>{const i=Ce,g=Se,f=Pe,de=Te,_e=Ee,ce=$e,pe=Fe,me=Ie,fe=Oe;return k(),b(xe,null,[c("div",Be,[p(i,{title:"List User"}),c("div",Le,[c("div",Ne,[c("div",Ue,[c("div",Ve,[he(c("select",{class:"","onUpdate:modelValue":t[0]||(t[0]=r=>ke(m)?m.value=r:null)},qe,512),[[be,l(m)]])]),l(re)?(k(),b("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=r=>ee())},[p(g)])):S("",!0),l(ne)?(k(),b("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=r=>W())},[p(f)])):S("",!0),l(ue)?(k(),b("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[3]||(t[3]=r=>X())},[p(de)])):S("",!0),l(ie)?(k(),b("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[4]||(t[4]=r=>ae())},[p(_e)])):S("",!0),c("button",{type:"button",name:"button",class:"m-1 text-xs",onClick:t[5]||(t[5]=r=>oe())}," SET 2FA ")])]),p(ce,{thead:l(se),selected:l(a),onSetSelected:t[6]||(t[6]=r=>a.value=r),tbody:l(o),fnCallData:U,scrolling:l(_),onSetScrollingPage:t[7]||(t[7]=r=>l(_).page=r),onDoFilter:t[8]||(t[8]=r=>V()),rowBgColor:G},{group:H(({item:r})=>[J(Y(K(r)),1)]),is_active:H(({item:r})=>[J(Y(r.is_active==1?"Aktif":"Tidak Aktif"),1)]),_:2},1032,["thead","selected","tbody","scrolling"])])]),p(pe,{type:"delete",show:l(y),data:l(j),fnClose:te,fnConfirm:le},null,8,["show","data"]),p(me,{show:l(v),fnClose:()=>{v.value=!1},id:l(D),p_data:l(o),is_copy:l(A)},null,8,["show","fnClose","id","p_data","is_copy"]),p(fe,{show:l(I),fnClose:()=>{I.value=!1},qrCodeUrl:l(M)},null,8,["show","fnClose","qrCodeUrl"])],64)}}},pt=ze(He,[["__scopeId","data-v-8d80772a"]]);export{pt as default};
