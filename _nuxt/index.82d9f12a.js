import ce from"./Header.dae1d99d.js";import de from"./Plus.cee3ddf4.js";import me from"./Edit.fcdbc249.js";import _e from"./Eyes.bdf7795b.js";import fe from"./Delete.f6abaa17.js";import pe from"./Signature.1f1ecefd.js";import ve from"./Line.6e3f8199.js";import he from"./Check.b0958afa.js";import ye from"./TypeIcon.8aef68fc.js";import{_ as ge}from"./PopupMini.vue.464c94de.js";import ke from"./salary_bonus.bd39dcbc.js";import we from"./salary_bonus_validasi.4d0ff51b.js";import{f as be,g as xe,r,h as De,i as V,s as Ce,j as Ae,c as d,b as m,a as e,k as a,l as k,F as Te,y as $e,w as Se,z as Me,A as v,B as N,o as u,C as Pe,D as A,t as _,d as Ue,m as Fe,v as Be,n as Ne,E as Ie}from"./entry.7018568f.js";import{u as h}from"./useUtils.06a8ae99.js";import{u as I}from"./useMyFetch.9ff61eb6.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./DocJPEG.cf41057c.js";import"./DocJPG.bdf28c2b.js";import"./DocPNG.587d6e6a.js";import"./DocPDF.97cfa506.js";import"./Times.9e709495.js";import"./Exclamation.d3f4a885.js";import"./HeaderPopup.vue.3da2b044.js";import"./client-only.1b736a95.js";import"./WidthMiniList.vue.34491956.js";import"./WidthMiniPart.vue.d14bb10f.js";import"./InputPointFormat.vue.7071867f.js";import"./AttachmentSingle.66fa2082.js";import"./PDFJsView.e551e183.js";const Le={class:"w-full h-full flex flex-col"},Ee={class:"w-full flex grow flex-col overflow-auto h-0"},Oe={class:"w-full flex"},je={class:"w-full flex justify-center items-center grow h-0 p-1"},ze={key:0,class:""},He={class:"tacky"},Re=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"App 2"),e("th",null,"ID"),e("th",null,"Tanggal"),e("th",null,"Tipe"),e("th",null,"Nama Karyawan"),e("th",null,"No KTP"),e("th",null,"No SIM"),e("th",null,"Nominal"),e("th",null,"Note"),e("th",null,"File"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),Ve=["onClick"],Ye={class:"flex items-center justify-center"},Ke={class:"flex items-center justify-center"},Je={class:"bold"},Ze={class:"grow mb-5"},At={__name:"index",async setup(qe){let w,L;const{$moment:T}=Ie(),{pointFormat:Y}=h(),c={};c._TimeZoneOffset=new Date().getTimezoneOffset(),c.sort="created_at:desc";const $=be("token"),{data:K}=([w,L]=xe(async()=>Me(async()=>{let t=[];v().loading_full=!0;const{data:o,error:f,status:g}=await I("/salary_bonuses",{method:"get",headers:{Authorization:`Bearer ${$.value}`,Accept:"application/json"},params:c,retry:0});return v().loading_full=!1,g.value==="error"?(N().trigger(f),{salary_bonuses:t}):(t=o.value.data,{salary_bonuses:t})},"$tya7A7egnO")),w=await w,L(),w),n=r(K.value.salary_bonuses);r(""),r({field:"created_at",by:"desc"});const s=r(-1),i=r({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),b=r(null),J=async()=>{v().loading_full=!0,i.value.may_get_data=!1,c.page=i.value.page,c.page==1&&(n.value=[]),c.first_row&&delete c.first_row,c.page>1&&(c.first_row=JSON.stringify(n.value[0]));const{data:t,error:o,status:f}=await I("/salary_bonuses",{method:"get",headers:{Authorization:`Bearer ${$.value}`,Accept:"application/json"},params:c,retry:0});if(v().loading_full=!1,i.value.may_get_data=!0,f.value==="error"){N().trigger(o);return}i.value.page==1?(n.value=t.value.data,b.value&&(b.value.scrollTop=0)):i.value.page>1&&(n.value=[...n.value,...t.value.data]),t.value.data.length==0&&(i.value.is_last_record=!0)},Z=async()=>{if(!i.value.may_get_data)return;let t=b.value;if(t.scrollLeft!=i.value.scrollLeft){i.value.scrollLeft=t.scrollLeft;return}i.value.is_last_record||!(Math.round(t.scrollTop)+t.clientHeight>=t.scrollHeight-1)||(i.value.page++,await J())};De();const x=r(!1),S=r(0),M=r(0),q=()=>{S.value=0,x.value=!0,M.value=!1},{display:D}=V();Ce(V());const G=()=>{s.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(S.value=n.value[s.value].id,x.value=!0,M.value=!1)},C=r(!1),P=r(0),U=r(!1),Q=()=>{s.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=n.value[s.value].id,C.value=!0,U.value=!1)},W=()=>{s.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=n.value[s.value].id,C.value=!0,U.value=!0)},F=r(!1),E=r({}),y=r(!1),p=r(""),X=async()=>{y.value&&(y.value=!1)},ee=()=>{s.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(p.value="",E.value={id:n.value[s.value].id},y.value=!0)};Ae(()=>p.value,t=>{t.trim().length>0?F.value=!0:F.value=!1},{immediate:!1});const te=async()=>{v().loading_full=!0;const t=new FormData;t.append("id",n.value[s.value].id),t.append("deleted_reason",p.value),t.append("_method","DELETE");const{data:o,error:f,status:g}=await I("/salary_bonus",{method:"post",headers:{Authorization:`Bearer ${$.value}`,Accept:"application/json"},body:t,retry:0});if(v().loading_full=!1,g.value==="error"){N().trigger(f);return}n.value.splice(s.value,1),s.value=-1,y.value=!1};return(t,o)=>{const f=ce,g=de,ae=me,le=_e,se=fe,oe=pe,O=ve,j=he,ne=ye,re=ge,ue=ke,ie=we;return u(),d("div",Le,[m(f,{title:"List Salary Additional"}),e("div",Ee,[e("div",Oe,[("useUtils"in t?t.useUtils:a(h))().checkPermission("salary_bonus.create")?(u(),d("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[0]||(o[0]=l=>q())},[m(g)])):k("",!0),("useUtils"in t?t.useUtils:a(h))().checkPermissions(["salary_bonus.modify"])&&a(s)>-1&&[void 0,0].indexOf(a(n)[a(s)].val3)>-1?(u(),d("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[1]||(o[1]=l=>G())},[m(ae)])):k("",!0),("useUtils"in t?t.useUtils:a(h))().checkPermissions(["salary_bonus.view"])&&a(s)>-1?(u(),d("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[2]||(o[2]=l=>W())},[m(le)])):k("",!0),("useUtils"in t?t.useUtils:a(h))().checkPermission("salary_bonus.remove")&&a(s)>-1?(u(),d("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[3]||(o[3]=l=>ee())},[m(se)])):k("",!0),("useUtils"in t?t.useUtils:a(h))().checkPermissions(["salary_bonus.val1","salary_bonus.val2","salary_bonus.val3"])&&a(s)>-1?(u(),d("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[4]||(o[4]=l=>Q())},[m(oe)])):k("",!0)]),e("div",je,[a(n).length==0?(u(),d("div",ze," Maaf Tidak Ada Record ")):(u(),d("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:Z},[e("table",He,[Re,e("tbody",null,[(u(!0),d(Te,null,$e(a(n),(l,B)=>{var z,H,R;return u(),d("tr",{key:B,onClick:Ge=>s.value=B,class:Pe(a(s)==B?"active":"")},[e("td",null,[e("div",Ye,[l.val1?(u(),A(j,{key:1})):(u(),A(O,{key:0}))])]),e("td",null,[e("div",Ke,[l.val2?(u(),A(j,{key:1})):(u(),A(O,{key:0}))])]),e("td",Je,_(l.id),1),e("td",null,_(l.tanggal?a(T)(l.tanggal).format("DD-MM-Y"):""),1),e("td",null,_(l.type),1),e("td",null,_((z=l.employee)==null?void 0:z.name),1),e("td",null,_((H=l.employee)==null?void 0:H.ktp_no),1),e("td",null,_((R=l.employee)==null?void 0:R.sim_no),1),e("td",null,_(a(Y)(l.nominal||0)),1),e("td",null,_(l.note),1),e("td",null,[m(ne,{value:l.attachment_1_type},null,8,["value"])]),e("td",null,_(l.created_at?a(T)(l.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,_(l.updated_at?a(T)(l.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,Ve)}),128))])])],544))])]),m(re,{type:"delete",show:a(y),data:a(E),fnClose:X,fnConfirm:te,enabledOk:a(F)},{footer:Se(()=>[Ue(" Masukkan Alasan Penghapusan: "),e("div",Ze,[Fe(e("textarea",{"onUpdate:modelValue":o[5]||(o[5]=l=>Ne(p)?p.value=l:null)},null,512),[[Be,a(p)]])])]),_:1},8,["show","data","enabledOk"]),m(ue,{show:a(x),fnClose:()=>{x.value=!1},id:a(S),p_data:a(n),is_copy:a(M)},null,8,["show","fnClose","id","p_data","is_copy"]),m(ie,{show:a(C),fnClose:()=>{C.value=!1},id:a(P),p_data:a(n),is_view:a(U)},null,8,["show","fnClose","id","p_data","is_view"])])}}};export{At as default};
