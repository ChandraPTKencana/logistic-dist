import{_ as oe}from"./Header.dafd11f0.js";import{_ as le}from"./Plus.bce0b7d8.js";import{_ as ne}from"./Edit.ea0ffa29.js";import{_ as ie}from"./Delete.34e5831f.js";import{_ as re}from"./Search.ea52ea4e.js";import{_ as ue}from"./PopupMini.vue.cda3d52a.js";import{_ as de}from"./HeaderPopup.vue.2bc6ec0c.js";import{r as v,f as q,g as ce,h as y,v as _e,o as $,c as S,a as e,b as x,k as a,j,t as m,l as B,m as fe,x as h,y as T,p as O,e as Y,O as pe,D as ve,B as me,H as E,I as he,i as we,F as R,n as ge,E as xe,q as ye,s as ke,P as be}from"./entry.25520946.js";import{u as H}from"./useMyFetch.0dc5fa7c.js";import{_ as K}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.70db6abe.js";const A=c=>(O("data-v-ac9f4acf"),c=c(),Y(),c),$e={class:"box-fixed"},Se={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},Ae={class:"w-full flex flex-col items-center grow overflow-auto"},De={class:"w-full flex flex-row flex-wrap"},Ce={class:"w-full flex flex-col flex-wrap p-1"},Te=A(()=>e("label",{for:""},"Username",-1)),Ue={class:"text-red-500"},Ie={class:"w-full flex flex-col flex-wrap p-1"},Me=A(()=>e("label",{for:""},"Password",-1)),Fe={class:"text-red-500"},Be={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},He=A(()=>e("label",{for:""},"Hak Akses",-1)),Le=pe('<option value="PabrikTransport" data-v-ac9f4acf>Pabrik Transport</option><option value="Logistic" data-v-ac9f4acf>Logisitic</option><option value="Finance" data-v-ac9f4acf>Finance</option><option value="MIS" data-v-ac9f4acf>MIS</option><option value="SuperAdmin" data-v-ac9f4acf>SuperAdmin</option>',5),Pe=[Le],Ve={class:"text-red-500"},je={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ze=A(()=>e("label",{for:""},"Status",-1)),Ne=A(()=>e("option",{value:"1"},"Aktif",-1)),Ee=A(()=>e("option",{value:"0"},"Nonaktif",-1)),Re=[Ne,Ee],qe={class:"text-red-500"},Oe={class:"w-full flex items-center justify-end"},Ye={__name:"user",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},setup(c){const u=c,D={id:-1,username:"",password:"",hak_akses:"PabrikTransport",is_active:1},s=v({...D}),f=q("token"),p=v({}),_=async()=>{h().loading_full=!0,p.value={};const o=new FormData;o.append("username",s.value.username),s.value.password&&o.append("password",s.value.password),o.append("hak_akses",s.value.hak_akses),o.append("is_active",s.value.is_active);let t="post",l=u.id;l==0||(o.append("id",l),o.append("_method","PUT"));const{data:i,error:b,status:U}=await H("/user",{method:t,headers:{Authorization:`Bearer ${f.value}`,Accept:"application/json"},body:o,retry:0});if(h().loading_full=!1,U.value==="error"){T().trigger(b,p);return}if(u.id<=0)s.value.id=i.value.id,s.value.created_at=i.value.created_at,s.value.updated_at=i.value.updated_at,u.p_data.unshift(s.value);else{s.value.updated_at=i.value.updated_at;let I=u.p_data.map(L=>L.id).indexOf(u.id);I>=-1&&u.p_data.splice(I,1,{...s.value})}u.fnClose()},g=async()=>{h().loading_full=!0;const{data:o,error:t,status:l}=await H("/user",{method:"get",headers:{Authorization:`Bearer ${f.value}`,Accept:"application/json"},params:{id:u.id},retry:0});if(h().loading_full=!1,l.value==="error"){T().trigger(t);return}s.value=o.value.data};return ce(()=>u.show,(o,t)=>{o==!0&&(s.value={...D},p.value={},u.id!=0&&g())},{immediate:!0}),(o,t)=>{const l=de;return y(($(),S("section",$e,[e("div",null,[x(l,{title:"Form User",fn:c.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",Se,[e("div",Ae,[e("div",De,[e("div",Ce,[Te,y(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=i=>a(s).username=i)},null,512),[[j,a(s).username]]),e("p",Ue,m(a(p).username),1)]),e("div",Ie,[Me,y(e("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=i=>a(s).password=i)},null,512),[[j,a(s).password]]),e("p",Fe,m(a(p).password),1)]),e("div",Be,[He,y(e("select",{"onUpdate:modelValue":t[2]||(t[2]=i=>a(s).hak_akses=i)},Pe,512),[[B,a(s).hak_akses]]),e("p",Ve,m(a(p).hak_akses),1)]),e("div",je,[ze,y(e("select",{"onUpdate:modelValue":t[3]||(t[3]=i=>a(s).is_active=i)},Re,512),[[B,a(s).is_active]]),e("p",qe,m(a(p).is_active),1)])])]),e("div",Oe,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:t[4]||(t[4]=i=>c.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:t[5]||(t[5]=fe(i=>_(),["prevent"]))}," Save ")])])])],512)),[[_e,c.show]])}}},Ke=K(Ye,[["__scopeId","data-v-ac9f4acf"]]);const w=c=>(O("data-v-37a4ae3a"),c=c(),Y(),c),Ze={class:"w-full h-full flex flex-col"},Je={class:"w-full flex grow flex-col overflow-auto h-0"},Qe={class:"w-full flex"},Ge={class:"w-full flex p-1"},We={class:"grow"},Xe=w(()=>e("div",{class:"font-bold"}," Keyword ",-1)),et={class:"pl-1"},tt=w(()=>e("div",{class:"font-bold"}," Sort By ",-1)),at=w(()=>e("option",{value:""},null,-1)),st=w(()=>e("option",{value:"username"},"Username",-1)),ot=w(()=>e("option",{value:"hak_akses"},"Hak Akses",-1)),lt=w(()=>e("option",{value:"is_active"},"Status",-1)),nt=[at,st,ot,lt],it={class:"pl-1"},rt=w(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),ut=w(()=>e("option",{value:"asc"},"Asc",-1)),dt=w(()=>e("option",{value:"desc"},"Desc",-1)),ct=[ut,dt],_t={class:"flex items-end pl-1"},ft={class:"w-full flex justify-center items-center grow h-0 p-1"},pt={key:0,class:""},vt={class:"tacky"},mt=w(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"Username"),e("th",null,"Hak Akses"),e("th",null,"Status"),e("th",null,"Tanggal Dibuat"),e("th",null,"Tanggal Diubah")])],-1)),ht=["onClick"],wt={class:"bold"},gt={__name:"index",async setup(c){let u,D;const{$moment:s}=ke(),f={};f._TimeZoneOffset=new Date().getTimezoneOffset();const p=q("token"),{data:_}=([u,D]=ve(async()=>xe(async()=>{h().loading_full=!0;const{data:r,error:n,status:k}=await H("/users",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:f,retry:0});return h().loading_full=!1,k.value==="error"?(T().trigger(n),[]):r.value.data},"$4SJ9UL5Y8i")),u=await u,D(),u),g=v(""),o=v({field:"",by:"desc"}),t=v(-1),l=v({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),i=()=>{f.like="",g.value!=""&&(f.like=`id:%${g.value}%,username:%${g.value}%`),f.sort="",o.value.field&&(f.sort=o.value.field+":"+o.value.by)},b=v(null),U=async()=>{h().loading_full=!0,l.value.may_get_data=!1,f.page=l.value.page,f.page==1&&(_.value=[]);const{data:r,error:n,status:k}=await be("/users",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:f,retry:0},"$LZQttUfkIg");if(h().loading_full=!1,l.value.may_get_data=!0,k.value==="error"){T().trigger(n);return}l.value.page==1?(_.value=r.value.data,b.value&&(b.value.scrollTop=0)):l.value.page>1&&(_.value=[..._.value,...r.value.data]),r.value.data.length==0&&(l.value.is_last_record=!0)},I=async()=>{if(!l.value.may_get_data)return;let r=b.value;if(r.scrollLeft!=l.value.scrollLeft){l.value.scrollLeft=r.scrollLeft;return}l.value.is_last_record||!(Math.round(r.scrollTop)+r.clientHeight>=r.scrollHeight-1)||(l.value.page++,await U())},L=()=>{l.value.page=1,l.value.is_last_record=!1,i(),U()};me();const M=v(!1),P=v(0),Z=()=>{P.value=0,M.value=!0},{display:z}=E();he(E());const J=()=>{t.value==-1?z({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=_.value[t.value].id,M.value=!0)},N=v({}),C=v(!1),Q=async()=>{C.value&&(C.value=!1)},G=()=>{t.value==-1?z({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(N.value={id:_.value[t.value].id},C.value=!0)},W=async()=>{h().loading_full=!0;const r=new FormData;r.append("id",_.value[t.value].id),r.append("_method","DELETE");const{data:n,error:k,status:V}=await H("/user",{method:"post",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},body:r,retry:0});if(h().loading_full=!1,V.value==="error"){T().trigger(k);return}_.value.splice(t.value,1),t.value=-1,C.value=!1};return(r,n)=>{const k=oe,V=le,X=ne,ee=ie,te=re,ae=ue,se=Ke;return $(),S(R,null,[e("div",Ze,[x(k,{title:"List User"}),e("div",Je,[e("div",Qe,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:n[0]||(n[0]=d=>Z())},[x(V)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:n[1]||(n[1]=d=>J())},[x(X)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:n[2]||(n[2]=d=>G())},[x(ee)])]),e("div",Ge,[e("div",We,[Xe,y(e("input",{class:"",type:"text","onUpdate:modelValue":n[3]||(n[3]=d=>we(g)?g.value=d:null),name:"search",placeholder:"Keyword"},null,512),[[j,a(g)]])]),e("div",et,[tt,y(e("select",{class:"","onUpdate:modelValue":n[4]||(n[4]=d=>a(o).field=d)},nt,512),[[B,a(o).field]])]),e("div",it,[rt,y(e("select",{class:"","onUpdate:modelValue":n[5]||(n[5]=d=>a(o).by=d)},ct,512),[[B,a(o).by]])]),e("div",_t,[e("button",{class:"",type:"button",name:"button",onClick:n[6]||(n[6]=d=>L())},[x(te,{class:"text-2xl"})])])]),e("div",ft,[a(_).length==0?($(),S("div",pt," Maaf Tidak Ada Record ")):($(),S("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:I},[e("table",vt,[mt,e("tbody",null,[($(!0),S(R,null,ge(a(_),(d,F)=>($(),S("tr",{key:F,onClick:xt=>t.value=F,class:ye(a(t)==F?"active":"")},[e("td",null,m(F+1)+".",1),e("td",wt,m(d.username),1),e("td",null,m(d.hak_akses),1),e("td",null,m(d.is_active?"Aktif":"Nonaktif"),1),e("td",null,m(a(s)(d.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,m(a(s)(d.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,ht))),128))])])],544))])])]),x(ae,{type:"delete",show:a(C),data:a(N),fnClose:Q,fnConfirm:W},null,8,["show","data"]),x(se,{show:a(M),fnClose:()=>{M.value=!1},id:a(P),p_data:a(_)},null,8,["show","fnClose","id","p_data"])],64)}}},Mt=K(gt,[["__scopeId","data-v-37a4ae3a"]]);export{Mt as default};
