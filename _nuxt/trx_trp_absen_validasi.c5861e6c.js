import{_ as S}from"./HeaderPopup.vue.5e43446c.js";import B from"./CaretTop.08316eba.js";import $ from"./CaretDown.592e64c0.js";import{P as T,r as H,f as E,j as N,m as V,J as L,o as c,c as u,a as e,b as y,t as i,k as s,l as v,x as P,E as q,A as h,B as A,p as F,e as O}from"./entry.44d5fc3d.js";import"./useUtils.f69303a2.js";import{u as j}from"./useMyFetch.7cc1a605.js";import{_ as U}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.5282973f.js";const _=n=>(F("data-v-7597789d"),n=n(),O(),n),z={class:"box-fixed"},G={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},J={class:"w-full flex flex-col items-center grow overflow-auto"},K={class:"w-full"},R={class:"w-full flex flex-wrap p-3 items-center text-xs"},Q=_(()=>e("label",{for:""},"ID",-1)),W={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},X=_(()=>e("label",{for:""},"U.jalan Per",-1)),Z={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},ee=_(()=>e("label",{for:""},"Jenis",-1)),te={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},se=_(()=>e("label",{for:""},"Supir",-1)),ae={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},ie={key:0},oe=_(()=>e("label",{for:""},"Kernet",-1)),le={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},re=_(()=>e("label",{for:""},"No Pol",-1)),_e={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},ne=_(()=>e("label",{for:""},"Tujuan",-1)),de={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},ce=_(()=>e("label",{for:""},"Tipe",-1)),ue={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},ve={class:"w-full flex flex-wrap items-center grow overflow-auto"},me={class:"w-full sm:w-1/2 text-center p-1"},fe={class:"border-[1px] p-1"},pe={class:"font-bold"},be={class:"w-full flex justify-center items-center"},he=["src"],we={class:"w-full sm:w-1/2 text-center p-1"},xe={class:"border-[1px] p-1"},ge={class:"border-[1px] p-1"},ye={class:"font-bold"},Ye={class:"w-full flex justify-center items-center"},De=["src"],ke={class:"w-full sm:w-1/2 text-center p-1"},Me={class:"border-[1px] p-1"},He={class:"border-[1px] p-1"},Ae={class:"font-bold"},je={class:"w-full flex justify-center items-center"},Ie=["src"],Ce={class:"w-full sm:w-1/2 text-center p-1"},Se={class:"border-[1px] p-1"},Be={class:"border-[1px] p-1"},$e={class:"font-bold"},Te={class:"w-full flex justify-center items-center"},Ee=["src"],Ne={class:"w-full p-1"},Ve=_(()=>e("label",{for:""}," Note ",-1)),Le={class:"card-border"},Pe={class:"w-full flex items-center justify-end"},qe={class:"w-full flex flex-wrap p-3 items-center"},Fe=_(()=>e("div",null," Di Validasi oleh : ",-1)),Oe={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},Ue={key:0},ze={key:1},Ge={key:2},Je=_(()=>e("div",null," Validasi ",-1)),Ke={key:0,class:"text-xs font-bold"},Re={__name:"trx_trp_absen_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},emits:["setID","setIndex"],setup(n,{emit:b}){const l=n,{$moment:d}=q();let w=a=>{a.key=="ArrowUp"&&k(),a.key=="ArrowDown"&&D()};T(()=>{document.removeEventListener("keydown",w)});const t=H({...{id:-1,tanggal:new Date,id_uj:-1,xto:"",tipe:"",jenis:"",amount:0,img_leaves:[],img_leave:"",img_arrive:"",img_return:"",img_till:"",img_leave_file:"",img_arrive_file:"",img_return_file:"",img_till_file:"",img_leave_ts:"",img_arrive_ts:"",img_return_ts:"",img_till_ts:"",ritase_note:"",ritase_val:0,ritase_val_by:{username:""},ritase_val_at:"",ritase_val1:0,ritase_val1_by:{username:""},ritase_val1_at:"",ritase_val2:0,ritase_val2_by:{username:""},ritase_val2_at:""}}),Y=E("token"),m=H(""),I=async()=>{m.value="PROSES...",h().loading_full=!0;const a=new FormData;let o="post",f=l.id;f==0||(a.append("id",f),a.append("_method","PUT"));const{data:r,error:g,status:p}=await j("/trx_trp/absen/validasi",{method:o,headers:{Authorization:`Bearer ${Y.value}`,Accept:"application/json"},body:a,retry:0});if(h().loading_full=!1,p.value==="error"){m.value="GAGAL",A().trigger(g);return}t.value.ritase_val=r.value.ritase_val,t.value.ritase_val_by=r.value.ritase_val_by,t.value.ritase_val_at=r.value.ritase_val_at,t.value.ritase_val1=r.value.ritase_val1,t.value.ritase_val1_by=r.value.ritase_val1_by,t.value.ritase_val1_at=r.value.ritase_val1_at,t.value.ritase_val2=r.value.ritase_val2,t.value.ritase_val2_by=r.value.ritase_val2_by,t.value.ritase_val2_at=r.value.ritase_val2_at;let M=l.p_data.map(C=>C.id).indexOf(l.id);M>=-1&&l.p_data.splice(M,1,{...t.value}),m.value="BERHASIL"},x=async()=>{m.value="",h().loading_full=!0;const{data:a,error:o,status:f}=await j("/trx_trp/absen",{method:"get",headers:{Authorization:`Bearer ${Y.value}`,Accept:"application/json"},params:{id:l.id},retry:0});if(h().loading_full=!1,f.value==="error"){A().trigger(o);return}t.value=a.value.data};N(()=>l.show,(a,o)=>{a==!0?(document.addEventListener("keydown",w),x()):document.removeEventListener("keydown",w)},{immediate:!0});const D=()=>{let a=l.p_data.map(o=>o.id).indexOf(l.id);a!=l.p_data.length-1&&(a++,b("setID",l.p_data[a].id),b("setIndex",a),setTimeout(()=>{x()},100))},k=()=>{let a=l.p_data.map(o=>o.id).indexOf(l.id);a!=0&&(a--,b("setID",l.p_data[a].id),b("setIndex",a),setTimeout(()=>{x()},100))};return(a,o)=>{const f=S,r=B,g=$;return V((c(),u("section",z,[e("div",null,[y(f,{title:"Form Transaction Validation",fn:n.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",G,[e("div",J,[e("div",K,[e("div",R,[e("div",null,[Q,e("div",W,i(s(t).id),1)]),e("div",null,[X,e("div",Z,i(s(t).tanggal?s(d)(s(t).tanggal).format("DD-MM-YYYY"):""),1)]),e("div",null,[ee,e("div",te,i(s(t).jenis),1)]),e("div",null,[se,e("div",ae,i(s(t).supir),1)]),s(t).kernet?(c(),u("div",ie,[oe,e("div",le,i(s(t).kernet),1)])):v("",!0),e("div",null,[re,e("div",_e,i(s(t).no_pol),1)]),e("div",null,[ne,e("div",de,i(s(t).xto),1)]),e("div",null,[ce,e("div",ue,i(s(t).tipe),1)])])]),e("div",ve,[e("div",me,[e("div",fe,[e("label",pe,"Berangkat : "+i(s(t).img_leave_ts?s(d)(s(t).img_leave_ts).format("DD-MM-YYYY HH:mm"):""),1),e("div",be,[e("img",{src:s(t).img_leave,alt:""},null,8,he)])])]),e("div",we,[e("div",xe,[e("div",ge,[e("label",ye,"Tiba : "+i(s(t).img_arrive_ts?s(d)(s(t).img_arrive_ts).format("DD-MM-YYYY HH:mm"):""),1),e("div",Ye,[e("img",{src:s(t).img_arrive,alt:""},null,8,De)])])])]),e("div",ke,[e("div",Me,[e("div",He,[e("label",Ae,"Kembali : "+i(s(t).img_return_ts?s(d)(s(t).img_return_ts).format("DD-MM-YYYY HH:mm"):""),1),e("div",je,[e("img",{src:s(t).img_return,alt:""},null,8,Ie)])])])]),e("div",Ce,[e("div",Se,[e("div",Be,[e("label",$e,"Sampai : "+i(s(t).img_till_ts?s(d)(s(t).img_till_ts).format("DD-MM-YYYY HH:mm"):""),1),e("div",Te,[e("img",{src:s(t).img_till,alt:""},null,8,Ee)])])])]),e("div",Ne,[Ve,e("div",Le,i(s(t).ritase_note),1)])])]),e("div",Pe,[e("div",qe,[Fe,s(t).ritase_val||s(t).ritase_val1||s(t).ritase_val2?(c(),u("div",Oe,[s(t).ritase_val?(c(),u("div",Ue," App 1 : "+i(s(t).ritase_val_by.username)+" ( "+i(s(t).ritase_val_at?s(d)(s(t).ritase_val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):v("",!0),s(t).ritase_val1?(c(),u("div",ze," App 2 : "+i(s(t).ritase_val1_by.username)+" ( "+i(s(t).ritase_val1_at?s(d)(s(t).ritase_val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):v("",!0),s(t).ritase_val2?(c(),u("div",Ge," App 3 : "+i(s(t).ritase_val2_by.username)+" ( "+i(s(t).ritase_val2_at?s(d)(s(t).ritase_val2_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):v("",!0)])):v("",!0)]),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:o[0]||(o[0]=p=>k())},[y(r,{class:"black"})]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:o[1]||(o[1]=p=>n.fnClose())}," Cancel "),n.is_view==0?(c(),u("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm flex flex-col items-center justify-center",onClick:o[2]||(o[2]=P(p=>I(),["prevent"]))},[Je,s(m)!=""?(c(),u("div",Ke,i(s(m)),1)):v("",!0)])):v("",!0),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:o[3]||(o[3]=p=>D())},[y(g,{class:"black"})])])])])],512)),[[L,n.show]])}}},ot=U(Re,[["__scopeId","data-v-7597789d"]]);export{ot as default};
