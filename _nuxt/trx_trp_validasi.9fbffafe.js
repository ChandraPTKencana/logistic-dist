import{_ as A}from"./HeaderPopup.vue.08dca28b.js";import{_ as P}from"./WidthMiniPart.vue.83951cfb.js";import{r as h,h as S,I as j,n as B,v as H,o as _,c as d,a as e,b,t as s,m as a,G as v,s as $,H as J,x as m,y as C}from"./entry.0dd19dc7.js";import{u as I}from"./useUtils.f0799763.js";import{u as D}from"./useMyFetch.1fc866cf.js";import"./Times.daf3647d.js";import"./_plugin-vue_export-helper.c27b6911.js";const T={class:"box-fixed"},q={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},F={class:"w-full flex flex-col items-center grow overflow-auto"},O={class:"w-full flex flex-row flex-wrap"},R={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},U=e("label",{for:""},"U.Jalan Per",-1),z={class:"card-border"},E={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},G=e("label",{for:""},"Jenis",-1),K={class:"card-border"},W={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},L=e("label",{for:""},"No Pol",-1),Q={class:"card-border"},X={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Z=e("label",{for:""},"Supir",-1),ee={class:"card-border !flex"},te={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},ae=e("label",{for:""},"Kernet",-1),le={class:"card-border !flex"},se={key:0,class:"w-full flex flex-wrap"},oe={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-4/12 flex flex-col flex-wrap p-1"},re=e("label",{for:""},"Tujuan",-1),ie={class:"card-border"},ne={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-4/12 flex flex-col flex-wrap p-1"},_e=e("label",{for:""},"Tipe",-1),de={class:"card-border"},ce={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-4/12 flex flex-col flex-wrap p-1"},ve=e("label",{for:""},"Total Dari U.Jalan",-1),ue={class:"card-border"},fe={key:1,class:"w-full flex flex-wrap"},pe={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},me=e("label",{for:""},"Cost Center Code",-1),we={class:"card-border"},xe={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},he=e("label",{for:""},"Cost Center Desc",-1),be={class:"card-border"},ke={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},ye=e("label",{for:""},"PVR No",-1),ge={class:"card-border"},Ce={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},De=e("label",{for:""},"PVR Total",-1),Ne={class:"card-border"},Ye={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},Me=e("label",{for:""},"PV",-1),Ve={class:"card-border"},Ae={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Pe=e("label",{for:""},"PV Amount",-1),Se={class:"card-border"},je={class:"w-full flex items-center justify-end"},Be={class:"w-full flex flex-wrap p-3 items-center"},He=e("div",null," Di Validasi oleh : ",-1),$e={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},Je={key:0},Ie={key:1},Te={key:2},Ke={__name:"trx_trp_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(f){const c=f,{$moment:p}=J(),{pointFormat:w}=I(),t=h({...{id:-1,tanggal:new Date,id_uj:-1,xto:"",tipe:"",jenis:"",amount:0,pv_id:-1,pv_no:"",pv_total:0,supir:"",kernet:"",no_pol:"",val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:"",cost_center_code:"",cost_center_desc:"",pvr_id:"",pvr_no:"",pvr_total:"",pvr_had_detail:""}}),k=S("token"),y={_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:-1,name:"",title:""},r=h(JSON.parse(JSON.stringify(y))),i=h(JSON.parse(JSON.stringify(y))),N=async()=>{m().loading_full=!0;const n=new FormData;let o="post",u=c.id;u==0||(n.append("id",u),n.append("_method","PUT"));const{data:l,error:x,status:M}=await D("/trx_trp_validasi",{method:o,headers:{Authorization:`Bearer ${k.value}`,Accept:"application/json"},body:n,retry:0});if(m().loading_full=!1,M.value==="error"){C().trigger(x);return}t.value.val=l.value.val,t.value.val_user=l.value.val_user,t.value.val_by=l.value.val_by,t.value.val_at=l.value.val_at,t.value.val1=l.value.val1,t.value.val1_user=l.value.val1_user,t.value.val1_by=l.value.val1_by,t.value.val1_at=l.value.val1_at,t.value.val2=l.value.val2,t.value.val2_user=l.value.val2_user,t.value.val2_by=l.value.val2_by,t.value.val2_at=l.value.val2_at;let g=c.p_data.map(V=>V.id).indexOf(c.id);g>=-1&&c.p_data.splice(g,1,{...t.value}),c.fnClose()},Y=async()=>{m().loading_full=!0;const{data:n,error:o,status:u}=await D("/trx_trp",{method:"get",headers:{Authorization:`Bearer ${k.value}`,Accept:"application/json"},params:{id:c.id},retry:0});if(m().loading_full=!1,u.value==="error"){C().trigger(o);return}let l=n.value.data;t.value=l,r.value._.id.val=l.supir_id,r.value._.name.val=l.supir,r.value._.rek_no.val=l.supir_rek_no,r.value._.rek_name.val=l.supir_rek_name,r.value.id=l.supir_id,r.value.name=l.supir,r.value.rek_no=(l.supir_rek_no||"")+" "+(l.supir_rek_name||""),i.value._.id.val=l.kernet_id,i.value._.name.val=l.kernet,i.value._.rek_no.val=l.kernet_rek_no,i.value._.rek_name.val=l.kernet_rek_name,i.value.id=l.kernet_id,i.value.name=l.kernet,i.value.rek_no=(l.kernet_rek_no||"")+" "+(l.kernet_rek_name||"")};return j(()=>c.show,(n,o)=>{n==!0&&Y()},{immediate:!0}),(n,o)=>{const u=A,l=P;return B((_(),d("section",T,[e("div",null,[b(u,{title:"Form Transaction Validation",fn:f.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",q,[e("div",F,[e("div",O,[e("div",R,[U,e("div",z,s(a(t).tanggal?a(p)(a(t).tanggal).format("DD-MM-YYYY"):""),1)]),e("div",E,[G,e("div",K,s(a(t).jenis),1)]),e("div",W,[L,e("div",Q,s(a(t).no_pol),1)]),e("div",X,[Z,e("div",ee,[b(l,{selected:a(r)},null,8,["selected"])])]),e("div",te,[ae,e("div",le,[b(l,{selected:a(i)},null,8,["selected"])])]),a(t).jenis!=""?(_(),d("div",se,[e("div",oe,[re,e("div",ie,s(a(t).xto),1)]),e("div",ne,[_e,e("div",de,s(a(t).tipe),1)]),e("div",ce,[ve,e("div",ue,s(a(w)(a(t).amount||0)),1)])])):v("",!0),a(t).jenis!=""?(_(),d("div",fe,[e("div",pe,[me,e("div",we,s(a(t).cost_center_code),1)]),e("div",xe,[he,e("div",be,s(a(t).cost_center_desc),1)]),e("div",ke,[ye,e("div",ge,s(a(t).pvr_no),1)]),e("div",Ce,[De,e("div",Ne,s(a(w)(a(t).pvr_total||0)),1)]),e("div",Ye,[Me,e("div",Ve,s(a(t).pv_no),1)]),e("div",Ae,[Pe,e("div",Se,s(a(w)(a(t).pv_total||0)),1)])])):v("",!0)])]),e("div",je,[e("div",Be,[He,a(t).val||a(t).val1||a(t).val2?(_(),d("div",$e,[a(t).val?(_(),d("div",Je," App 1 : "+s(a(t).val_by.username)+" ( "+s(a(t).val_at?a(p)(a(t).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):v("",!0),a(t).val1?(_(),d("div",Ie," App 2 : "+s(a(t).val1_by.username)+" ( "+s(a(t).val1_at?a(p)(a(t).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):v("",!0),a(t).val2?(_(),d("div",Te," App 3 : "+s(a(t).val2_by.username)+" ( "+s(a(t).val2_at?a(p)(a(t).val2_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):v("",!0)])):v("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:o[0]||(o[0]=x=>f.fnClose())}," Cancel "),f.is_view==0?(_(),d("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:o[1]||(o[1]=$(x=>N(),["prevent"]))}," Validasi ")):v("",!0)])])])],512)),[[H,f.show]])}}};export{Ke as default};
