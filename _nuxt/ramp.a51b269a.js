import O from"./Header.c79c26a8.js";import{_ as S}from"./client-only.478bb590.js";import I from"./PrinterEye.75b3f094.js";import N from"./Table2Column.42f259d3.js";import{_ as U}from"./PDFView.vue.02e4e77a.js";import{r as u,g as G,h as L,I as R,c as p,a as e,b as r,w as V,t as v,l as s,k as Z,A as q,m as H,F as A,D as Q,C as T,q as X,o as w,x as d,y as x,G as J}from"./entry.7dca494d.js";import{u as y}from"./useMyFetch.07e5797d.js";import{u as K}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.bb804a2f.js";const W={class:"w-full h-full flex flex-col"},tt={class:"w-full flex grow flex-col overflow-auto h-0 bg-gray-200 justify-center items-center p-2"},et={class:"bg-white p-2"},ot={action:"#",class:"w-full flex flex-col sm:flex-row flex-wrap text-xs"},st={class:"w-full p-1 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col"},lt=e("div",{class:"font-bold"}," Tgl Dari ",-1),at={class:"text-red-500"},nt={class:"w-full p-1 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col"},rt=e("div",{class:"font-bold"}," Tgl Sampai ",-1),it={class:"text-red-500"},ct={class:"w-full p-1 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col"},ut=e("div",{class:"font-bold"}," Lokasi ",-1),dt={id:"locations"},mt=["value"],ft={class:"w-full p-1 sm:w-12/12 md:w-12/12 lg:w-3/12 flex items-end justify-end"},_t=e("div",{class:"text-left m-1"},"Download PDF",-1),pt=e("div",{class:"text-left m-1"},"Download Excel",-1),At={__name:"ramp",async setup(vt){let m,g;const{$moment:h}=J(),l={};l._TimeZoneOffset=new Date().getTimezoneOffset(),l.sort="tanggal:desc";const D=u({}),_=G("token"),a=u({from:"",to:""}),{data:$}=([m,g]=L(async()=>X(async()=>{d().loading_full=!0;let n=[];const[t,c]=await Promise.all([y("/report/ramp/get_locations",{method:"get",headers:{Authorization:`Bearer ${_.value}`,Accept:"application/json"},retry:0})]);return t.status.value!=="error"&&(n=t.data.value.list_xto),t.status.value==="error"?(x().trigger(t.error),{locations:n}):(d().loading_full=!1,{locations:n})},"$SQhImG8ywX")),m=await m,g(),m),j=u($.value.locations||[]),f=u(""),b=()=>{l._TimeZoneOffset=new Date().getTimezoneOffset(),l.date_from=a.value.from?h(a.value.from).format("YYYY-MM-DD"):"",l.date_to=a.value.to?h(a.value.to).format("YYYY-MM-DD"):"",l.location=f.value},{downloadFile:Y,viewFile:wt}=K(),i=u(!1),C=u({}),F=async()=>{if(i.value==!0){i.value=!1;return}b(),d().loading_full=!0;const{data:n,error:t,status:c}=await y("/report/ramp/pdf_preview",{method:"get",headers:{Authorization:`Bearer ${_.value}`,Accept:"application/json"},params:l,retry:0});if(d().loading_full=!1,c.value==="error"){x().trigger(t);return}C.value=n.value,i.value=!0},B=async()=>{b(),d().loading_full=!0;const{data:n,error:t,status:c}=await y("/report/ramp/excel_download",{method:"get",headers:{Authorization:`Bearer ${_.value}`,Accept:"application/json"},params:l,retry:0});if(d().loading_full=!1,c.value==="error"){x().trigger(t);return}Y(n.value)};return(n,t)=>{const c=O,k=R("vue-date-picker"),M=S,P=I,z=N,E=U;return w(),p(A,null,[e("div",W,[r(c,{title:"Report Transaction"}),e("div",tt,[e("div",et,[e("form",ot,[e("div",st,[lt,r(M,null,{default:V(()=>[r(k,{modelValue:s(a).from,"onUpdate:modelValue":t[0]||(t[0]=o=>s(a).from=o),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"",class:"flex-grow"},null,8,["modelValue"])]),_:1}),e("p",at,v(s(D).date_from),1)]),e("div",nt,[rt,r(M,null,{default:V(()=>[r(k,{modelValue:s(a).to,"onUpdate:modelValue":t[1]||(t[1]=o=>s(a).to=o),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"",class:"flex-grow"},null,8,["modelValue"])]),_:1}),e("p",it,v(s(D).date_to),1)]),e("div",ct,[ut,Z(e("input",{type:"text",list:"locations","onUpdate:modelValue":t[2]||(t[2]=o=>H(f)?f.value=o:null)},null,512),[[q,s(f)]]),e("datalist",dt,[(w(!0),p(A,null,Q(s(j),o=>(w(),p("option",{value:o},v(o),9,mt))),256))])]),e("div",ft,[e("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:t[3]||(t[3]=T(o=>F(),["prevent"]))},[e("div",null,[r(P,{class:"text-2xl"})]),_t]),e("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:t[4]||(t[4]=T(o=>B(),["prevent"]))},[e("div",null,[r(z,{class:"text-2xl"})]),pt])])])])])]),r(E,{show:s(i),pdfContent:s(C),onClose:t[5]||(t[5]=o=>i.value=!s(i))},null,8,["show","pdfContent"])],64)}}};export{At as default};
