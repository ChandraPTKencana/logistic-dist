import{_ as z}from"./HeaderPopup.vue.d6400a7b.js";import{_ as E}from"./client-only.5e00cd21.js";import{r as y,g as R,i as S,f as U,J as K,k as B,L as Y,o as u,c as d,a as t,b as D,l as a,t as _,w as H,m as O,A as I,n as w,d as i,F as V,E as Q,D as W,H as X,x as v,y as A}from"./entry.d9b45284.js";import{u as M}from"./useUtils.ab60562a.js";import{u as q}from"./useMyFetch.405cdccc.js";import"./Times.6df50bd1.js";import"./_plugin-vue_export-helper.c27b6911.js";const Z={class:"box-fixed"},x={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},tt={class:"w-full flex flex-col items-center grow overflow-auto"},at={class:"w-full flex flex-row flex-wrap"},st={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},_t=t("label",{for:""},"Period End",-1),nt={key:0,class:"card-border"},et={key:1},ot={class:"text-red-500"},lt={key:0,class:"w-full sm:w-6/12 md:w-4/12 lg:w-4/12 p-1"},it=t("div",{class:"font-bold"}," Filter Nama ",-1),rt={key:0,class:"w-full flex p-1 justify-between flex-wrap"},pt={class:"w-full",role:"sticky"},ut={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},dt=t("tr",{class:"sticky -top-1 !z-[2]"},[t("td",{colspan:"46",class:"!bg-slate-800 text-white font-bold"}," Detail ")],-1),ct={class:"sticky top-7 !z-[2]"},mt=t("th",{rowspan:"2"},"No",-1),ht=t("th",{rowspan:"2"},"ID",-1),bt=t("th",{rowspan:"2"},"Nama Pekerja",-1),gt=t("th",{rowspan:"2"},"Jabatan",-1),yt=t("th",{rowspan:"2"},"Tmpt Lahir",-1),jt=t("th",{rowspan:"2"},"Tgl Lahir",-1),ft=t("th",{rowspan:"2"},"TMK",-1),kt=t("th",{rowspan:"2"},"No KTP",-1),wt=t("th",{rowspan:"2"},"Alamat",-1),vt=t("th",{rowspan:"2"},"Status",-1),Ft=t("th",{rowspan:"2"},"No Rek",-1),Dt=t("th",{rowspan:"2"},"Nama Rek",-1),Mt=t("th",{rowspan:"2"},"Nama Bank",-1),Pt={colspan:"3"},Nt={class:"text-sm"},Tt={rowspan:"2"},Ct={class:"text-sm"},St={rowspan:"2"},Bt={class:"text-sm"},Vt={colspan:"3"},At={class:"text-sm"},qt={rowspan:"2"},Gt={class:"text-sm"},Jt={rowspan:"2"},Lt={class:"text-sm"},$t={colspan:"3"},zt={class:"text-sm"},Et={rowspan:"2"},Rt={class:"text-sm"},Ut={rowspan:"2"},Kt={class:"text-sm"},Yt={rowspan:"2"},Ht={class:"text-sm"},Ot={rowspan:"2"},It={class:"text-sm"},Qt={colspan:"4"},Wt={class:"text-sm"},Xt={colspan:"4"},Zt={class:"text-sm"},xt={colspan:"3",class:"whitespace-nowrap"},ta={class:"text-sm"},aa={rowspan:"2"},sa={class:"text-sm"},_a={rowspan:"2"},na={class:"text-sm"},ea={rowspan:"2"},oa={class:"text-sm"},la={rowspan:"2"},ia={class:"text-sm"},ra={rowspan:"2"},pa={class:"text-sm"},ua={class:"sticky top-[60px] !z-[2]"},da={class:"text-sm"},ca={class:"text-sm"},ma={class:"text-sm"},ha={class:"text-sm"},ba={class:"text-sm"},ga={class:"text-sm"},ya={class:"text-sm"},ja={class:"text-sm"},fa={class:"text-sm"},ka={class:"text-sm"},wa={class:"text-sm"},va={class:"text-sm"},Fa={class:"text-sm"},Da={class:"text-sm"},Ma={class:"text-sm"},Pa={class:"text-sm"},Na={class:"text-sm"},Ta={class:"text-sm"},Ca={class:"text-sm"},Sa={class:"text-sm"},Ba={ref:"to_move"},Va=["data-index"],Aa={class:"w-full flex items-center justify-end"},Ra={__name:"rpt_salary",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(j){const c=j,{$moment:f}=X(),{pointFormat:e}=M(),P={id:"",period_end:new Date},r=y({...P}),N=R("token"),k=y({}),m=y([]),l=y([]),G=async()=>{v().loading_full=!0,k.value={};const p=new FormData;p.append("period_end",r.value.period_end?f(r.value.period_end).format("Y-MM"):"");let s="post",n=r.value.id;n==""||(p.append("id",n),p.append("_method","PUT"));const{data:h,error:F,status:o}=await q("/rpt_salary",{method:s,headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},body:p,retry:0});if(v().loading_full=!1,o.value==="error"){A().trigger(F,k);return}if(m.value=h.value.details,n<=0)r.value.id=h.value.id,r.value.created_at=h.value.created_at,r.value.updated_at=h.value.updated_at,c.p_data.unshift(r.value);else{r.value.updated_at=h.value.updated_at;let b=c.p_data.map($=>$.id).indexOf(n);b>-1&&c.p_data.splice(b,1,{...r.value})}T(m.value)},J=S(()=>r.value.val&&r.value.val1||M().checkPermission("rpt_salary.val")&&r.value.val||M().checkPermission("rpt_salary.val1")&&r.value.val1),L=async()=>{v().loading_full=!0;const{data:p,error:s,status:n}=await q("/rpt_salary",{method:"get",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},params:{id:c.id},retry:0});if(v().loading_full=!1,n.value==="error"){A().trigger(s);return}r.value=p.value.data,c.is_copy&&(r.value.val=0,r.value.val1=0),m.value=p.value.data.details,T(p.value.data.details)},T=p=>{let s={details:p,standby_1_ttl:0,standby_1_gaji:0,standby_1_makan:0,standby_1_dinas:0,perubahaan_lainnya_1_ttl:0,periode_1_ttl:0,standby_2_ttl:0,standby_2_gaji:0,standby_2_makan:0,standby_2_dinas:0,perubahaan_lainnya_2_ttl:0,perubahaan_kerajinan_ttl:0,periode_2_ttl:0,potongan_manual_ttl:0,periode_2_ttl_stlh_pot:0,periode_ttl:0,trip_umum_ttl:0,trip_umum_gaji:0,trip_umum_makan:0,trip_umum_dinas:0,trip_lain_ttl:0,trip_lain_jlh:0,trip_lain_gaji:0,trip_lain_makan:0,trip_lain_dinas:0,trip_tunggu_ttl:0,trip_tunggu_jlh:0,trip_tunggu_gaji:0,trip_tunggu_dinas:0,bonus_trip_ttl:0,trip_jumlah:0,bonus_trip_gaji:0,bonus_trip_dinas:0,bonus_trip_perubahaan:0,potongan_trip:0,total:0,bpjs_kesehatan_ttl:0,bpjs_jamsos_ttl:0,total_grand:0};s.details.forEach(n=>{n.periode_1_ttl=parseFloat(n.sb_gaji)+parseFloat(n.sb_makan)+parseFloat(n.sb_dinas)+parseFloat(n.salary_bonus_nominal),n.trip_jumlah=n.trip_cpo+n.trip_pk+n.trip_tbs+n.trip_tbsk,n.bonus_trip_gaji=parseFloat(n.trip_cpo_bonus_gaji)+parseFloat(n.trip_pk_bonus_gaji)+parseFloat(n.trip_tbs_bonus_gaji)+parseFloat(n.trip_tbsk_bonus_gaji),n.bonus_trip_dinas=parseFloat(n.trip_cpo_bonus_dinas)+parseFloat(n.trip_pk_bonus_dinas)+parseFloat(n.trip_tbs_bonus_dinas)+parseFloat(n.trip_tbsk_bonus_dinas),n.periode_2_ttl=parseFloat(n.sb_gaji_2)+parseFloat(n.sb_makan_2)+parseFloat(n.sb_dinas_2)+parseFloat(n.salary_bonus_nominal_2)+parseFloat(n.kerajinan)+parseFloat(n.bonus_trip_gaji)+parseFloat(n.bonus_trip_dinas)+parseFloat(n.salary_bonus_bonus_trip),n.periode_2_ttl_stlh_pot=n.periode_2_ttl-parseFloat(n.potongan_manual),n.periode_ttl=n.periode_1_ttl+n.periode_2_ttl_stlh_pot,n.total=parseFloat(n.uj_gaji)+parseFloat(n.uj_makan)+parseFloat(n.uj_dinas)+parseFloat(n.trip_lain_gaji)+parseFloat(n.trip_lain_makan)+parseFloat(n.trip_lain_dinas)+parseFloat(n.trip_tunggu_gaji)+parseFloat(n.trip_tunggu_dinas)-parseFloat(n.nominal_cut),n.total_grand=n.periode_ttl+n.total-parseFloat(n.employee_bpjs_kesehatan)-parseFloat(n.employee_bpjs_jamsos),s.standby_1_gaji+=parseFloat(n.sb_gaji),s.standby_1_makan+=parseFloat(n.sb_makan),s.standby_1_dinas+=parseFloat(n.sb_dinas),s.perubahaan_lainnya_1_ttl+=parseFloat(n.salary_bonus_nominal),s.standby_2_gaji+=parseFloat(n.sb_gaji_2),s.standby_2_makan+=parseFloat(n.sb_makan_2),s.standby_2_dinas+=parseFloat(n.sb_dinas_2),s.perubahaan_lainnya_2_ttl+=parseFloat(n.salary_bonus_nominal_2),s.perubahaan_kerajinan_ttl+=parseFloat(n.kerajinan),s.potongan_manual_ttl+=parseFloat(n.potongan_manual),s.trip_umum_gaji+=parseFloat(n.uj_gaji),s.trip_umum_makan+=parseFloat(n.uj_makan),s.trip_umum_dinas+=parseFloat(n.uj_dinas),s.trip_lain_jlh+=n.trip_lain,s.trip_lain_gaji+=parseFloat(n.trip_lain_gaji),s.trip_lain_makan+=parseFloat(n.trip_lain_makan),s.trip_lain_dinas+=parseFloat(n.trip_lain_dinas),s.trip_tunggu_jlh+=n.trip_tunggu,s.trip_tunggu_gaji+=parseFloat(n.trip_tunggu_gaji),s.trip_tunggu_dinas+=parseFloat(n.trip_tunggu_dinas),s.trip_jumlah+=n.trip_jumlah,s.bonus_trip_gaji+=n.bonus_trip_gaji,s.bonus_trip_dinas+=n.bonus_trip_dinas,s.bonus_trip_perubahaan+=parseFloat(n.salary_bonus_bonus_trip),s.potongan_trip+=parseFloat(n.nominal_cut),s.bpjs_kesehatan_ttl+=parseFloat(n.employee_bpjs_kesehatan),s.bpjs_jamsos_ttl+=parseFloat(n.employee_bpjs_jamsos)}),s.standby_1_ttl=s.standby_1_gaji+s.standby_1_makan+s.standby_1_dinas,s.periode_1_ttl=s.standby_1_ttl+s.perubahaan_lainnya_1_ttl,s.standby_2_ttl=s.standby_2_gaji+s.standby_2_makan+s.standby_2_dinas,s.bonus_trip_ttl=s.bonus_trip_gaji+s.bonus_trip_dinas+s.bonus_trip_perubahaan,s.periode_2_ttl=s.standby_2_ttl+s.perubahaan_lainnya_2_ttl+s.perubahaan_kerajinan_ttl+s.bonus_trip_ttl,s.periode_2_ttl_stlh_pot=s.periode_2_ttl+s.potongan_manual_ttl,s.periode_ttl=s.periode_1_ttl+s.periode_2_ttl_stlh_pot,s.trip_umum_ttl=s.trip_umum_gaji+s.trip_umum_makan+s.trip_umum_dinas,s.trip_lain_ttl=s.trip_lain_gaji+s.trip_lain_makan+s.trip_lain_dinas,s.trip_tunggu_ttl=s.trip_tunggu_gaji+s.trip_tunggu_dinas,s.total=s.trip_umum_ttl+s.trip_lain_ttl+s.trip_tunggu_ttl-s.potongan_trip,s.total_grand=s.periode_ttl+s.total-s.bpjs_kesehatan_ttl-s.bpjs_jamsos_ttl,l.value=s},g=y(""),C=S(()=>g.value!=""?m.value.filter(p=>p.employee.name.toLowerCase().includes(g.value.toLowerCase())):m.value);return U(()=>c.show,(p,s)=>{p==!0&&(r.value={...P},m.value=[],k.value={},c.id!=0&&L())},{immediate:!0}),(p,s)=>{const n=z,h=K("vue-date-picker"),F=E;return B((u(),d("section",Z,[t("div",null,[D(n,{title:"Form Salary Report",fn:j.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",x,[t("div",tt,[t("div",at,[t("div",st,[_t,a(r).id?(u(),d("div",nt,_(a(f)(a(r).period_end).format("MM-Y")),1)):(u(),d("div",et,[D(F,null,{default:H(()=>[D(h,{modelValue:a(r).period_end,"onUpdate:modelValue":s[0]||(s[0]=o=>a(r).period_end=o),format:"MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"","month-picker":""},null,8,["modelValue"])]),_:1})])),t("p",ot,_(a(k).period_end),1)]),a(m).length?(u(),d("div",lt,[it,B(t("input",{class:"",type:"text","onUpdate:modelValue":s[1]||(s[1]=o=>O(g)?g.value=o:null),name:"search",placeholder:"Nama"},null,512),[[I,a(g)]])])):w("",!0)]),a(C).length?(u(),d("div",rt,[t("div",pt,[t("table",ut,[t("thead",null,[dt,t("tr",ct,[mt,ht,bt,gt,yt,jt,ft,kt,wt,vt,Ft,Dt,Mt,t("th",Pt,[i("Standby 1 "),t("span",Nt,"("+_(a(e)(a(l).standby_1_ttl))+")",1)]),t("th",Tt,[i("Potongan 1 "),t("span",Ct,"("+_(a(e)(a(l).perubahaan_lainnya_1_ttl))+")",1)]),t("th",St,[i("Periode 1 "),t("span",Bt,"("+_(a(e)(a(l).periode_1_ttl))+")",1)]),t("th",Vt,[i("Standby 2 "),t("span",At,"("+_(a(e)(a(l).standby_2_ttl))+")",1)]),t("th",qt,[i("Potongan 2 "),t("span",Gt,"("+_(a(e)(a(l).perubahaan_lainnya_2_ttl))+")",1)]),t("th",Jt,[i("U.Kerajinan "),t("span",Lt,"("+_(a(e)(a(l).perubahaan_kerajinan_ttl))+")",1)]),t("th",$t,[i("Bonus Trip "),t("span",zt,"("+_(a(e)(a(l).bonus_trip_ttl))+")",1)]),t("th",Et,[i("Periode 2 "),t("span",Rt,"("+_(a(e)(a(l).periode_2_ttl))+")",1)]),t("th",Ut,[i("Potongan Manual "),t("span",Kt,"("+_(a(e)(a(l).potongan_manual_ttl))+")",1)]),t("th",Yt,[i("Periode 2 setelah potongan "),t("span",Ht,"("+_(a(e)(a(l).periode_2_ttl_stlh_pot))+")",1)]),t("th",Ot,[i("Periode 1+2 "),t("span",It,"("+_(a(e)(a(l).periode_ttl))+")",1)]),t("th",Qt,[i("Trip "),t("span",Wt,"("+_(a(e)(a(l).trip_umum_ttl))+")",1)]),t("th",Xt,[i("Trip Lain "),t("span",Zt,"("+_(a(e)(a(l).trip_lain_ttl))+")",1)]),t("th",xt,[i("Trip Tunggu "),t("span",ta,"("+_(a(e)(a(l).trip_tunggu_ttl))+")",1)]),t("th",aa,[i("Potongan Trip "),t("span",sa,"("+_(a(e)(a(l).potongan_trip))+")",1)]),t("th",_a,[i("Total "),t("span",na,"("+_(a(e)(a(l).total))+")",1)]),t("th",ea,[i("BPJS Kesehatan "),t("span",oa,"("+_(a(e)(a(l).bpjs_kesehatan_ttl))+")",1)]),t("th",la,[i("BPJS Jamsos "),t("span",ia,"("+_(a(e)(a(l).bpjs_jamsos_ttl))+")",1)]),t("th",ra,[i("Grand Total "),t("span",pa,"("+_(a(e)(a(l).total_grand))+")",1)])]),t("tr",ua,[t("th",null,[i("Gaji "),t("span",da,"("+_(a(e)(a(l).standby_1_gaji))+")",1)]),t("th",null,[i("Makan "),t("span",ca,"("+_(a(e)(a(l).standby_1_makan))+")",1)]),t("th",null,[i("Dinas "),t("span",ma,"("+_(a(e)(a(l).standby_1_dinas))+")",1)]),t("th",null,[i("Gaji "),t("span",ha,"("+_(a(e)(a(l).standby_2_gaji))+")",1)]),t("th",null,[i("Makan "),t("span",ba,"("+_(a(e)(a(l).standby_2_makan))+")",1)]),t("th",null,[i("Dinas "),t("span",ga,"("+_(a(e)(a(l).standby_2_dinas))+")",1)]),t("th",null,[i("Gaji "),t("span",ya,"("+_(a(e)(a(l).bonus_trip_gaji))+")",1)]),t("th",null,[i("Dinas "),t("span",ja,"("+_(a(e)(a(l).bonus_trip_dinas))+")",1)]),t("th",null,[i("Potongan "),t("span",fa,"("+_(a(e)(a(l).bonus_trip_perubahaan||0))+" )",1)]),t("th",null,[i("Jmlh "),t("span",ka,"("+_(a(e)(a(l).trip_jumlah))+")",1)]),t("th",null,[i("Gaji "),t("span",wa,"("+_(a(e)(a(l).trip_umum_gaji))+")",1)]),t("th",null,[i("Makan "),t("span",va,"("+_(a(e)(a(l).trip_umum_makan))+")",1)]),t("th",null,[i("Dinas "),t("span",Fa,"("+_(a(e)(a(l).trip_umum_dinas))+")",1)]),t("th",null,[i("Jmlh "),t("span",Da,"("+_(a(e)(a(l).trip_lain_jlh))+")",1)]),t("th",null,[i("Gaji "),t("span",Ma,"("+_(a(e)(a(l).trip_lain_gaji))+")",1)]),t("th",null,[i("Makan "),t("span",Pa,"("+_(a(e)(a(l).trip_lain_makan))+")",1)]),t("th",null,[i("Dinas "),t("span",Na,"("+_(a(e)(a(l).trip_lain_dinas))+")",1)]),t("th",null,[i("Jmlh "),t("span",Ta,"("+_(a(e)(a(l).trip_tunggu_jlh))+")",1)]),t("th",null,[i("Gaji "),t("span",Ca,"("+_(a(e)(a(l).trip_tunggu_gaji))+")",1)]),t("th",null,[i("Dinas "),t("span",Sa,"("+_(a(e)(a(l).trip_tunggu_dinas))+")",1)])])]),t("tbody",Ba,[(u(!0),d(V,null,Q(a(C),(o,b)=>(u(),d(V,{key:b},[o.p_status!="Remove"?(u(),d("tr",{key:0,"data-index":b},[t("td",null,_(b+1)+".",1),t("td",null,_(o.employee_id),1),t("td",null,_(o.employee_name),1),t("td",null,_(o.employee_role),1),t("td",null,_(o.employee_birth_place),1),t("td",null,_(o.employee_birth_date?a(f)(o.employee_birth_date).format("DD-MM-Y"):""),1),t("td",null,_(o.employee_tmk?a(f)(o.employee_tmk).format("DD-MM-Y"):""),1),t("td",null,_(o.employee_ktp_no),1),t("td",null,_(o.employee_address),1),t("td",null,_(o.employee_status),1),t("td",null,_(o.employee_rek_no),1),t("td",null,_(o.employee_rek_name),1),t("td",null,_(o.employee_bank_name),1),t("td",null,_(a(e)(o.sb_gaji)),1),t("td",null,_(a(e)(o.sb_makan)),1),t("td",null,_(a(e)(o.sb_dinas)),1),t("td",null,_(a(e)(o.salary_bonus_nominal)),1),t("td",null,_(a(e)(o.periode_1_ttl)),1),t("td",null,_(a(e)(o.sb_gaji_2)),1),t("td",null,_(a(e)(o.sb_makan_2)),1),t("td",null,_(a(e)(o.sb_dinas_2)),1),t("td",null,_(a(e)(o.salary_bonus_nominal_2)),1),t("td",null,_(a(e)(o.kerajinan)),1),t("td",null,_(a(e)(o.bonus_trip_gaji)),1),t("td",null,_(a(e)(o.bonus_trip_dinas)),1),t("td",null,_(a(e)(o.salary_bonus_bonus_trip)),1),t("td",null,_(a(e)(o.periode_2_ttl)),1),t("td",null,_(a(e)(o.potongan_manual)),1),t("td",null,_(a(e)(o.periode_2_ttl_stlh_pot)),1),t("td",null,_(a(e)(o.periode_ttl)),1),t("td",null,_(a(e)(o.trip_jumlah)),1),t("td",null,_(a(e)(o.uj_gaji)),1),t("td",null,_(a(e)(o.uj_makan)),1),t("td",null,_(a(e)(o.uj_dinas)),1),t("td",null,_(a(e)(o.trip_lain)),1),t("td",null,_(a(e)(o.trip_lain_gaji)),1),t("td",null,_(a(e)(o.trip_lain_makan)),1),t("td",null,_(a(e)(o.trip_lain_dinas)),1),t("td",null,_(a(e)(o.trip_tunggu)),1),t("td",null,_(a(e)(o.trip_tunggu_gaji)),1),t("td",null,_(a(e)(o.trip_tunggu_dinas)),1),t("td",null,_(a(e)(o.nominal_cut)),1),t("td",null,_(a(e)(o.total)),1),t("td",null,_(a(e)(o.employee_bpjs_kesehatan)),1),t("td",null,_(a(e)(o.employee_bpjs_jamsos)),1),t("td",null,_(a(e)(o.total_grand)),1)],8,Va)):w("",!0)],64))),128))],512)])])])):w("",!0)]),t("div",Aa,[t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:s[2]||(s[2]=o=>j.fnClose())}," Cancel "),a(J)?w("",!0):(u(),d("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:s[3]||(s[3]=W(o=>G(),["prevent"]))}," Generate "+_(a(r).id==""?"& Save":""),1))])])])],512)),[[Y,j.show]])}}};export{Ra as default};
