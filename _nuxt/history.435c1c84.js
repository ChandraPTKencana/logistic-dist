var K=(g,A,b)=>new Promise((m,D)=>{var M=r=>{try{y(b.next(r))}catch(h){D(h)}},_=r=>{try{y(b.throw(r))}catch(h){D(h)}},y=r=>r.done?m(r.value):Promise.resolve(r.value).then(M,_);y((b=b.apply(g,A)).next())});import{M as me,Q as ve,N as L,V as fe,W as ye,Z as be,$ as we,a0 as xe,a1 as he,a2 as ke,a3 as ge,a4 as De,a5 as Me,a6 as Se,a7 as $e,a8 as Ce}from"./pages.b486181e.js";import{_ as Te,e as Ve}from"./entry.9d4c4f80.js";import{r as n,c as qe,w as Ae,e as Ye,o as u,a as T,f as k,p as Ie,b as o,u as e,h as c,k as V,m as v,t as q,i as Z,v as Ne,l as j,D as Be,s as f,y as Q,F as Fe,J as He}from"./vue-vendor.ccf46959.js";import"./state-vendor.7641a25c.js";const Oe={class:"p-1 grow"},Ue={class:"bg-white h-full flex flex-col"},je={action:"#",class:"w-full flex flex-wrap text-xs"},Pe={class:"w-6/12 p-1 sm:w-4/12 md:w-4/12 lg:w-2/12 flex flex-col"},Re=o("div",{class:"font-bold"}," Tgl Dari ",-1),Je={class:"text-red-500"},Ee={class:"w-6/12 p-1 sm:w-4/12 md:w-4/12 lg:w-2/12 flex flex-col"},ze=o("div",{class:"font-bold"}," Tgl Sampai ",-1),Ke={class:"text-red-500"},Le={class:"w-6/12 p-1 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col"},Ze=o("div",{class:"font-bold"}," Keyword ",-1),Qe={class:"w-6/12 p-1 sm:w-4/12 md:w-4/12 lg:w-2/12 flex flex-col"},We=o("div",{class:"font-bold"}," Status ",-1),Ge=o("option",{value:"ritase_done"},"Done",-1),Xe=o("option",{value:"deleted"},"Trash",-1),et=o("option",{value:"all"},"All",-1),tt=o("option",{value:"req_deleted"},"Req Delete",-1),lt=[Ge,Xe,et,tt],ot={class:"w-6/12 p-1 sm:w-4/12 md:w-4/12 lg:w-1/12 flex flex-col"},st=o("div",{class:"font-bold"}," Sort By ",-1),at=He('<option value=""></option><option value="id">ID</option><option value="xto">To</option><option value="jenis">Jenis</option><option value="tipe">Tipe</option>',5),nt=[at],_t={class:"w-4/12 p-1 sm:w-3/12 md:w-3/12 lg:w-1/12 flex flex-col"},rt=o("div",{class:"font-bold"}," Sort Order ",-1),dt=o("option",{value:"asc"},"Asc",-1),it=o("option",{value:"desc"},"Desc",-1),ut=[dt,it],ct={class:"w-2/12 sm:w-1/12 md:w-1/12 lg:w-1/12 p-1 flex items-end"},wt={__name:"history",props:{show:{type:Boolean,required:!0}},setup(g){const A=g,{$moment:b}=Ve(),m=n("ritase_done"),D=s=>s.deleted==1?"!bg-red-400":s.req_deleted==1?"!bg-yellow-300":s.ritase_val==1?"!bg-blue-300":"",M=s=>(s.map(l=>{l.class_h=D(l)}),s),_={};_._TimeZoneOffset=new Date().getTimezoneOffset(),_.sort="tanggal:desc";const y=n({}),r=n({from:"",to:""}),h=me("token"),d=n([]),W=n([]),G=n([]),X=n(!1),a=n(""),w=n({field:"tanggal",by:"desc"}),i=n(-1),Y=qe(()=>d.value[i.value]),p=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),ee=()=>{_.like="",a.value!=""&&(_.like=`id:%${a.value}%,xto:%${a.value}%,jenis:%${a.value}%,pv_no:%${a.value}%,ticket_a_no:%${a.value}%,ticket_b_no:%${a.value}%,no_pol:%${a.value}%,supir:%${a.value}%,kernet:%${a.value}%,cost_center_code:%${a.value}%,cost_center_desc:%${a.value}%,pvr_id:%${a.value}%,pvr_no:%${a.value}%,tanggal:%${a.value}%,transition_target:%${a.value}%`),_.sort="",w.value.field&&(_.sort=w.value.field+":"+w.value.by),_.date_from=r.value.from?b(r.value.from).format("YYYY-MM-DD"):"",_.date_to=r.value.to?b(r.value.to).format("YYYY-MM-DD"):""},I=()=>K(this,null,function*(){L().loading_full=!0,y.value={},p.value.may_get_data=!1,_.page=p.value.page,_.page==1&&(d.value=[]),_.first_row&&delete _.first_row,_.page>1&&(_.first_row=JSON.stringify(d.value[0])),_.filter_status=m.value;const{data:s,error:l,status:U}=yield fe("/trx_trps",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},params:_,retry:0});if(L().loading_full=!1,p.value.may_get_data=!0,U.value==="error"){ye().trigger(l,y);return}p.value.page==1?d.value=M(s.value.data):p.value.page>1&&(d.value=[...d.value,...M(s.value.data)]),s.value.data.length==0&&(p.value.is_last_record=!0)}),te=()=>{J.value.map(s=>{let l=["deleted_by_username","deleted_at","deleted_reason","req_deleted_by_username","req_deleted_at","req_deleted_reason"].indexOf(s.key)>-1;return["all","deleted","req_deleted"].indexOf(m.value)>-1?l&&(s.tbl_show=1):l&&(s.tbl_show=0),s}),i.value=-1,p.value.page=1,p.value.is_last_record=!1,ee(),I()},N=n(!1),P=n(0),{display:B}=ve(),le=()=>{i.value==-1?B({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=d.value[i.value].id,N.value=!0)},S=n(!1),F=n(0),H=n(!1),oe=()=>{i.value==-1?B({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=d.value[i.value].id,S.value=!0,H.value=!1)},se=()=>{i.value==-1?B({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=d.value[i.value].id,S.value=!0,H.value=!0)},O=n(!1),R=n(0),ae=s=>{R.value=s,O.value=!0},J=n([{key:"no",label:"No",isai:!0},{key:"app1",label:"A1"},{key:"app2",label:"A2"},{key:"app3",label:"A3"},{key:"id",label:"ID"},{key:"absen",label:"Absen"},{key:"tanggal",label:"U.Jalan Per",dateformat:"DD-MM-Y"},{key:"no_pol",label:"No Pol",freeze:1},{key:"xto",label:"Tujuan"},{key:"tipe",label:"Tipe"},{key:"jenis",label:"Jenis"},{key:"amount",label:"Amount",class:" justify-end"},{key:"supir",label:"Supir"},{key:"kernet",label:"Kernet"},{key:"created_at",label:"Created At",dateformat:"DD-MM-Y HH:mm:ss"},{key:"updated_at",label:"Updated At",dateformat:"DD-MM-Y HH:mm:ss"},{key:"deleted_by_username",label:"Deleted By",tbl_show:0},{key:"deleted_at",label:"Deleted At",dateformat:"DD-MM-Y HH:mm:ss",tbl_show:0},{key:"deleted_reason",label:"Deleted Reason",tbl_show:0},{key:"req_deleted_by_username",label:"Req Deleted By",tbl_show:0},{key:"req_deleted_at",label:"Req Delete At",dateformat:"DD-MM-Y HH:mm:ss",tbl_show:0},{key:"req_deleted_reason",label:"Req Delete Reason",tbl_show:0}]);return Ae(()=>A.show,(s,l)=>{s==!0&&I()},{immediate:!0}),(s,l)=>{const U=be,ne=we,_e=xe,E=Ye("vue-date-picker"),z=Te,re=he,de=ke,$=ge,C=De,ie=Me,ue=Se,ce=$e,pe=Ce;return u(),T(Fe,null,[k(o("section",Oe,[o("div",Ue,[o("div",null,[["pv_not_done","all"].indexOf(e(m))>-1&&e(i)>-1&&e(Y).deleted==0&&e(Y).pvr_id==""?(u(),T("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:l[0]||(l[0]=t=>le())},[c(U)])):V("",!0),e(i)>-1?(u(),T("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:l[1]||(l[1]=t=>se())},[c(ne)])):V("",!0),e(m)=="pv_not_done"&&e(i)>-1&&e(Y).val==0?(u(),T("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:l[2]||(l[2]=t=>oe())},[c(_e)])):V("",!0)]),o("form",je,[o("div",Pe,[Re,c(z,null,{default:v(()=>[c(E,{modelValue:e(r).from,"onUpdate:modelValue":l[3]||(l[3]=t=>e(r).from=t),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"",class:"flex-grow"},null,8,["modelValue"])]),_:1}),o("p",Je,q(e(y).date_from),1)]),o("div",Ee,[ze,c(z,null,{default:v(()=>[c(E,{modelValue:e(r).to,"onUpdate:modelValue":l[4]||(l[4]=t=>e(r).to=t),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"",class:"flex-grow"},null,8,["modelValue"])]),_:1}),o("p",Ke,q(e(y).date_to),1)]),o("div",Le,[Ze,k(o("input",{class:"flex-grow",type:"text","onUpdate:modelValue":l[5]||(l[5]=t=>Z(a)?a.value=t:null),name:"search",placeholder:"Keyword"},null,512),[[Ne,e(a)]])]),o("div",Qe,[We,k(o("select",{class:"","onUpdate:modelValue":l[6]||(l[6]=t=>Z(m)?m.value=t:null)},lt,512),[[j,e(m)]])]),o("div",ot,[st,k(o("select",{class:"flex-grow","onUpdate:modelValue":l[7]||(l[7]=t=>e(w).field=t)},nt,512),[[j,e(w).field]])]),o("div",_t,[rt,k(o("select",{class:"flex-grow","onUpdate:modelValue":l[8]||(l[8]=t=>e(w).by=t)},ut,512),[[j,e(w).by]])]),o("div",ct,[o("button",{class:"",type:"submit",name:"button",onClick:l[9]||(l[9]=Be(t=>te(),["prevent"]))},[c(re,{class:"text-xl"})])])]),c(ie,{thead:e(J),selected:e(i),onSetSelected:l[10]||(l[10]=t=>i.value=t),tbody:e(d),fnCallData:I,scrolling:e(p),onSetScrollingPage:l[11]||(l[11]=t=>e(p).page=t)},{absen:v(({item:t,index:x})=>[t.trx_absens&&t.trx_absens.length>0?(u(),f(de,{key:0,class:"cursor-pointer",onClick:pt=>ae(x)},null,8,["onClick"])):V("",!0)]),app1:v(({item:t})=>[t.val?(u(),f(C,{key:1})):(u(),f($,{key:0}))]),app2:v(({item:t})=>[t.val1?(u(),f(C,{key:1})):(u(),f($,{key:0}))]),app3:v(({item:t})=>[t.val2?(u(),f(C,{key:1})):(u(),f($,{key:0}))]),pvr_completed:v(({item:t})=>[t.pvr_had_detail?(u(),f(C,{key:1})):(u(),f($,{key:0}))]),deleted_by_username:v(({item:t})=>{var x;return[Q(q((x=t.deleted_by)==null?void 0:x.username),1)]}),req_deleted_by_username:v(({item:t})=>{var x;return[Q(q((x=t.req_deleted_by)==null?void 0:x.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])])],512),[[Ie,g.show]]),c(ue,{show:e(N),fnClose:()=>{N.value=!1},id:e(P),p_data:e(d),list_pv:e(G),list_cost_center:e(W),online_status:e(X)},null,8,["show","fnClose","id","p_data","list_pv","list_cost_center","online_status"]),c(ce,{show:e(S),fnClose:()=>{S.value=!1},id:e(F),p_data:e(d),is_view:e(H)},null,8,["show","fnClose","id","p_data","is_view"]),c(pe,{show:e(O),fnClose:()=>{O.value=!1},index:e(R),p_data:e(d)},null,8,["show","fnClose","index","p_data"])],64)}}};export{wt as default};
