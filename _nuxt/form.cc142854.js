import{_ as Be}from"./HeaderCustom.vue.e72fcbc5.js";import{_ as ve}from"./Search.a474148e.js";import{_ as He}from"./Delete.99f66b2d.js";import{_ as Ue,a as ze}from"./ToolsPopup.54e7b9d5.js";import{_ as ge}from"./Times.8ccff7b9.js";import{_ as Ee}from"./InputPointFormat.vue.9aaca78a.js";import{_ as Ke}from"./Plus.8d735e0a.js";import{_ as ke}from"./HeaderPopup.vue.6c128d49.js";import{G as $e,r as _,g as re,Q as Pe,o as a,c as r,a as e,b as M,F as Q,A as le,z as oe,t as f,x as t,B as W,M as j,u as pe,n as V,v as Se,q as Ce,s as ue,y as ae,d as Je,C as Ie,p as De,e as Me,D as Y,E as ce,H as We,I as Ye,J as Qe,K as Ge,L as Xe,R as xe,S as Ze,T as be}from"./entry.e646a3f0.js";import{u as Ae}from"./useUtils.100f5b4a.js";import{u as de}from"./useMyFetch.03505594.js";import{_ as Te}from"./_plugin-vue_export-helper.c27b6911.js";const Ne=function(c,u){c.value.addEventListener("touchstart",h,{passive:!0}),c.value.addEventListener("touchend",g,{passive:!0});let b=-1,T=null,A=0;function h(d){b=v(d.target),T=setInterval(()=>{A+=100},100)}function g(d){clearInterval(T);let s=d.changedTouches[0],o=-1;if(A>400){let n=document.elementFromPoint(s.clientX,s.clientY);o=v(n);let k=u.value[b];u.value.splice(b,1),u.value.splice(o,0,{...k})}A=0,b=-1}function v(d){return d?d.hasAttribute("data-index")?d.dataset.index:d.parentElement?v(d.parentElement):-1:-1}},et={key:0,class:"flex items-center justify-center fixed top-0 left-0 z-10 p-3 w-full h-full bg-black bg-opacity-80"},tt={class:"flex items-center max-w-xs w-full h-5/6 relative bg-white border-solid border-gray-600 border-2 p-3 flex-col"},st={class:"absolute -top-7 right-0 py-1 px-2 bg-white border-solid border-2 border-gray-600 border-b-0 rounded-tl-md"},lt={class:"w-full grow text-left mt-3 flex flex-col overflow-hidden"},ot=e("b",{class:"text-gray-600"},"Selected List:",-1),at=["data-index","onDragstart","onDrop"],nt={class:"flex flex-row flex-wrap items-center"},it={class:"p-1"},rt={class:"flex w-full justify-between mt-3"},ut=["disabled"],ct=$e({__name:"PopupMiniMulti",props:{show:{type:Boolean,required:!0},data:{type:Object,required:!1,default:""},fnClose:{type:Function,required:!0},fnConfirm:{type:Function,required:!0},fnRemoveFromList:{type:Function,required:!0},enabledOk:{type:Boolean,required:!1,default:!0},multi_key:{type:Array,required:!0}},setup(c){const u=c;let b=null;const T=_(0),A=()=>{b==null&&(T.value=1,b=setInterval(()=>{T.value--,T.value<=0&&(clearInterval(b),b=null)},1e3))},h=_(null);re(()=>u.show,(d,s)=>{d?(A(),setTimeout(()=>{Ne(h,{value:u.data})},0)):(clearInterval(b),b=null)},{immediate:!0,deep:!0}),re(()=>u.enabledOk,(d,s)=>{d&&u.show&&A()},{immediate:!0,deep:!0}),Pe(()=>{clearInterval(b),b=null});const g=(d,s)=>{d.dataTransfer.setData("application/json",JSON.stringify(s))},v=(d,s)=>{let o=JSON.parse(d.dataTransfer.getData("application/json")),n=u.data[o];u.data.splice(o,1),u.data.splice(s,0,{...n})};return(d,s)=>{const o=ge;return c.show?(a(),r("div",et,[e("div",tt,[e("div",st,[M(o,{class:"text-2xl text-black cursor-pointer",onClick:s[0]||(s[0]=n=>c.fnClose())})]),e("div",lt,[ot,e("div",{class:"w-full grow overflow-auto p-2",ref_key:"to_move",ref:h},[(a(!0),r(Q,null,le(c.data,(n,k)=>(a(),r("div",{"data-index":k,class:"w-full flex flex-row flex-wrap items-center bg-blue-500 my-1 text-white rounded justify-between",draggable:"true",onDragstart:S=>g(S,k),onDragover:s[1]||(s[1]=oe(()=>{},["prevent"])),onDrop:S=>v(S,k)},[e("div",nt,[(a(!0),r(Q,null,le(c.multi_key,S=>(a(),r("div",it,f(n[S]),1))),256))]),M(o,{class:"text-2xl cursor-pointer",onClick:S=>c.fnRemoveFromList(k)},null,8,["onClick"])],40,at))),256))],512)]),e("div",rt,[e("button",{onClick:s[2]||(s[2]=n=>c.fnClose()),class:"w-full bg-blue-500 border-blue-500 border-solid border-2 p-1 text-white mr-2"}," Tutup "),e("button",{onClick:s[3]||(s[3]=n=>c.fnConfirm()),disabled:!u.enabledOk||t(T)>0,class:W(["w-full border-solid border-2 p-1 text-white",u.enabledOk&&t(T)<=0?"bg-red-600 border-red-600":"bg-slate-600 border-slate-600"])}," Lanjutkan "+f(t(T)>0?t(T):""),11,ut)])])])):j("",!0)}}});const O=c=>(De("data-v-72cf138d"),c=c(),Me(),c),dt={class:"box-fixed"},_t={action:"#",class:"w-full flex p-1"},ft={class:"grow"},vt=O(()=>e("div",{class:"font-bold"}," Keyword ",-1)),pt={class:"pl-1"},mt=O(()=>e("div",{class:"font-bold"}," Sort By ",-1)),ht=O(()=>e("option",{value:"created_at"},"Created At",-1)),wt=O(()=>e("option",{value:"id"},"ID",-1)),yt=O(()=>e("option",{value:"name"},"Nama",-1)),xt=[ht,wt,yt],bt={class:"pl-1"},gt=O(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),kt=O(()=>e("option",{value:"asc"},"Asc",-1)),$t=O(()=>e("option",{value:"desc"},"Desc",-1)),St=[kt,$t],Ct={class:"flex items-end pl-1"},It={class:"w-full flex justify-center items-center grow h-0 p-1"},Dt={key:0,class:""},Mt={class:"tacky w-full"},At={class:"sticky top-0 !z-[2]"},Tt={key:0,class:"min-w-[28px] !w-[28px] max-w-[28px]"},Nt=O(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No.",-1)),jt=O(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"ID",-1)),qt=O(()=>e("th",null,"Name",-1)),Lt=O(()=>e("th",null,"Unit",-1)),Ot=O(()=>e("th",{class:"min-w-[170px] !w-[170px] max-w-[170px]"},"Created At",-1)),Rt=O(()=>e("th",{class:"min-w-[170px] !w-[170px] max-w-[170px]"},"Updated At",-1)),Ft=["onClick"],Vt={key:0},Bt=["checked","onClick"],Ht={class:"bold"},Ut={class:"whitespace-normal break-words"},zt={class:"flex",style:{"justify-content":"end",padding:"5px"}},Et={key:0,class:"grow flex items-center"},Kt={__name:"items",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},fnSelectMulti:{type:Function,required:!1},enableMultiSelect:{type:Boolean,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},multi_key:{type:Array,required:!1}},setup(c){const u=c,{$moment:b}=Ie(),{countClickListFn:T}=Ae(),A=pe("token"),h=_([]),g=_(""),v=_({field:"created_at",by:"desc"}),d=_(-1),s=_({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),o={};o._TimeZoneOffset=new Date().getTimezoneOffset();const n=()=>{o.like="",g.value!=""&&(o.like=`id:%${g.value}%,name:%${g.value}%`),o.sort="",v.value.field&&(o.sort=v.value.field+":"+v.value.by)},k=_(null),S=async()=>{Y().loading_full=!0,s.value.may_get_data=!1,o.page=s.value.page,o.page==1&&(h.value=[]),u.exclude_lists&&(o.exclude_lists=JSON.stringify(u.exclude_lists)),o.first_row&&delete o.first_row,o.page>1&&(o.first_row=JSON.stringify(h.value[0]));const{data:m,error:w,status:y}=await de("/items",{method:"get",headers:{Authorization:`Bearer ${A.value}`,Accept:"application/json"},params:o,retry:0});if(Y().loading_full=!1,s.value.may_get_data=!0,y.value==="error"){ce().trigger(w);return}s.value.page==1?(h.value=m.value.data,k.value&&(k.value.scrollTop=0)):s.value.page>1&&(h.value=[...h.value,...m.value.data]),m.value.data.length==0&&(s.value.is_last_record=!0)},ee=async()=>{if(!s.value.may_get_data)return;let m=k.value;if(m.scrollLeft!=s.value.scrollLeft){s.value.scrollLeft=m.scrollLeft;return}s.value.is_last_record||!(Math.round(m.scrollTop)+m.clientHeight>=m.scrollHeight-1)||(s.value.page++,await S())},z=()=>{s.value.page=1,s.value.is_last_record=!1,n(),S()},B=_(!1),q=_([]),E=()=>{u.enableMultiSelect?(u.fnSelectMulti(q.value),B.value=!1):d.value>-1?u.fnSelect(h.value[d.value]):u.fnSelect({id:"",name:""})},te=m=>{u.enableMultiSelect||T(m,()=>{d.value=m},E)},N=m=>{q.value.splice(m,1)},x=async()=>{B.value&&(B.value=!1)},H=m=>{const w=q.value.map(y=>y.id).indexOf(m.id);w===-1?q.value.push(m):q.value.splice(w,1)},G=m=>q.value.map(y=>y.id).indexOf(m.id)!==-1,C=_(null);let R=null;const ne=m=>{R&&clearTimeout(R),R=setTimeout(()=>{z()},500)};return re(()=>u.show,(m,w)=>{m==!0&&(q.value=[],z(),setTimeout(()=>{C.value.focus()},100))},{immediate:!0}),(m,w)=>{const y=ke,X=ve,ie=ct;return a(),r(Q,null,[V(e("section",dt,[e("div",null,[M(y,{title:"Search And Select Item",fn:c.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",_t,[e("div",ft,[vt,V(e("input",{ref_key:"ref_keyword",ref:C,class:"",type:"text","onUpdate:modelValue":w[0]||(w[0]=I=>Ce(g)?g.value=I:null),name:"search",placeholder:"Keyword",onKeyup:w[1]||(w[1]=I=>ne())},null,544),[[ue,t(g)]])]),e("div",pt,[mt,V(e("select",{class:"","onUpdate:modelValue":w[2]||(w[2]=I=>t(v).field=I)},xt,512),[[ae,t(v).field]])]),e("div",bt,[gt,V(e("select",{class:"","onUpdate:modelValue":w[3]||(w[3]=I=>t(v).by=I)},St,512),[[ae,t(v).by]])]),e("div",Ct,[e("button",{class:"",type:"submit",name:"button",onClick:w[4]||(w[4]=oe(I=>z(),["prevent"]))},[M(X,{class:"text-2xl"})])])]),e("div",It,[t(h).length==0?(a(),r("div",Dt," Maaf Tidak Ada Record ")):(a(),r("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:k,onScroll:ee},[e("table",Mt,[e("thead",null,[e("tr",At,[c.enableMultiSelect?(a(),r("th",Tt)):j("",!0),Nt,jt,qt,Lt,Ot,Rt])]),e("tbody",null,[(a(!0),r(Q,null,le(t(h),(I,Z)=>(a(),r("tr",{key:Z,onClick:_e=>te(Z),class:W(t(d)==Z?"active":"")},[c.enableMultiSelect?(a(),r("td",Vt,[e("input",{type:"checkbox",checked:G(I),class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600",onClick:_e=>H(I)},null,8,Bt)])):j("",!0),e("td",null,f(Z+1)+".",1),e("td",Ht,f(I.id),1),e("td",Ut,f(I.name),1),e("td",null,f(I.unit.name),1),e("td",null,f(t(b)(I.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,f(t(b)(I.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,Ft))),128))])])],544))]),e("div",zt,[c.enableMultiSelect?(a(),r("div",Et,[Je(" Selected Items: "+f(t(q).length)+" ",1),e("button",{type:"button",class:"ml-3",onClick:w[5]||(w[5]=I=>B.value=!0)}," View all Items ")])):j("",!0),e("button",{onClick:w[6]||(w[6]=I=>E()),class:"w-36 m-1 bg-blue-600 text-white rounded-sm"}," Select ")])])],512),[[Se,c.show]]),M(ie,{show:t(B),data:t(q),fnClose:x,fnConfirm:E,multi_key:c.multi_key,fnRemoveFromList:N},null,8,["show","data","multi_key"])],64)}}},Pt=Te(Kt,[["__scopeId","data-v-72cf138d"]]);const J=c=>(De("data-v-0dfd718e"),c=c(),Me(),c),Jt={class:"box-fixed"},Wt={action:"#",class:"w-full flex p-1"},Yt={class:"grow"},Qt=J(()=>e("div",{class:"font-bold"}," Keyword ",-1)),Gt={class:"pl-1"},Xt=J(()=>e("div",{class:"font-bold"}," Sort By ",-1)),Zt=J(()=>e("option",{value:"created_at"},"Created At",-1)),es=J(()=>e("option",{value:"id"},"ID",-1)),ts=J(()=>e("option",{value:"name"},"Nama",-1)),ss=[Zt,es,ts],ls={class:"pl-1"},os=J(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),as=J(()=>e("option",{value:"asc"},"Asc",-1)),ns=J(()=>e("option",{value:"desc"},"Desc",-1)),is=[as,ns],rs={class:"flex items-end pl-1"},us={class:"w-full flex justify-center items-center grow h-0 p-1"},cs={key:0,class:""},ds={class:"tacky"},_s=J(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"ID"),e("th",null,"Name"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1)),fs=["onClick"],vs={class:"bold"},ps={class:"flex",style:{"justify-content":"end",padding:"5px"}},ms={__name:"hrm_revisi_lokasis",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},opt:{type:String,required:!1},exclude:{type:Number,required:!1},exclude_lists:{type:Array,required:!1}},setup(c){const u=c,{$moment:b}=Ie(),{countClickListFn:T}=Ae(),A=pe("token"),h=_([]),g=_(""),v=_({field:"created_at",by:"desc"}),d=_(-1),s=_({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),o={};o._TimeZoneOffset=new Date().getTimezoneOffset();const n=()=>{o.like="",g.value!=""&&(o.like=`id:%${g.value}%,name:%${g.value}%`),o.sort="",v.value.field&&(o.sort=v.value.field+":"+v.value.by)},k=_(null),S=async()=>{Y().loading_full=!0,s.value.may_get_data=!1,o.opt=u.opt,o.exclude=u.exclude,o.page=s.value.page,o.page==1&&(h.value=[]),o.first_row&&delete o.first_row,o.page>1&&(o.first_row=JSON.stringify(h.value[0]));const{data:N,error:x,status:H}=await de("/hrm_revisi_lokasis",{method:"get",headers:{Authorization:`Bearer ${A.value}`,Accept:"application/json"},params:o,retry:0});if(Y().loading_full=!1,s.value.may_get_data=!0,H.value==="error"){ce().trigger(x);return}s.value.page==1?(h.value=N.value.data,k.value&&(k.value.scrollTop=0)):s.value.page>1&&(h.value=[...h.value,...N.value.data]),N.value.data.length==0&&(s.value.is_last_record=!0)},ee=async()=>{if(!s.value.may_get_data)return;let N=k.value;if(N.scrollLeft!=s.value.scrollLeft){s.value.scrollLeft=N.scrollLeft;return}s.value.is_last_record||!(Math.round(N.scrollTop)+N.clientHeight>=N.scrollHeight-1)||(s.value.page++,await S())},z=()=>{s.value.page=1,s.value.is_last_record=!1,n(),S()},B=()=>{d.value>-1?u.fnSelect(h.value[d.value]):u.fnSelect({id:"",name:""})},q=_(null);let E=null;const te=N=>{E&&clearTimeout(E),E=setTimeout(()=>{z()},500)};return re(()=>u.show,(N,x)=>{N==!0&&z(),setTimeout(()=>{q.value.focus()},100)},{immediate:!0}),(N,x)=>{const H=ke,G=ve;return V((a(),r("section",Jt,[e("div",null,[M(H,{title:"Search And Select Warehouse",fn:c.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",Wt,[e("div",Yt,[Qt,V(e("input",{ref_key:"ref_keyword",ref:q,class:"",type:"text","onUpdate:modelValue":x[0]||(x[0]=C=>Ce(g)?g.value=C:null),name:"search",placeholder:"Keyword",onKeyup:x[1]||(x[1]=C=>te())},null,544),[[ue,t(g)]])]),e("div",Gt,[Xt,V(e("select",{class:"","onUpdate:modelValue":x[2]||(x[2]=C=>t(v).field=C)},ss,512),[[ae,t(v).field]])]),e("div",ls,[os,V(e("select",{class:"","onUpdate:modelValue":x[3]||(x[3]=C=>t(v).by=C)},is,512),[[ae,t(v).by]])]),e("div",rs,[e("button",{class:"",type:"submit",name:"button",onClick:x[4]||(x[4]=oe(C=>z(),["prevent"]))},[M(G,{class:"text-2xl"})])])]),e("div",us,[t(h).length==0?(a(),r("div",cs," Maaf Tidak Ada Record ")):(a(),r("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:k,onScroll:ee},[e("table",ds,[_s,e("tbody",null,[(a(!0),r(Q,null,le(t(h),(C,R)=>(a(),r("tr",{key:R,onClick:ne=>t(T)(R,()=>{d.value=R},B),class:W(t(d)==R?"active":"")},[e("td",null,f(R+1)+".",1),e("td",vs,f(C.id),1),e("td",null,f(C.name),1),e("td",null,f(t(b)(C.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,f(t(b)(C.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,fs))),128))])])],544))]),e("div",ps,[e("button",{onClick:x[5]||(x[5]=C=>B()),class:"w-36 m-1 bg-blue-600 text-white rounded-sm"}," Select ")])])],512)),[[Se,c.show]])}}},hs=Te(ms,[["__scopeId","data-v-0dfd718e"]]),ws={class:"w-full h-full flex flex-col"},ys={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},xs={class:"w-full flex flex-col items-center justify-center grow overflow-auto"},bs={class:"w-full flex flex-row flex-wrap"},gs={key:0,class:"w-full sm:w-4/12 md:w-3/12 lg:w-2/12 flex flex-col flex-wrap p-1"},ks=e("label",{for:""},"Input At",-1),$s={class:"card-border"},Ss={class:"w-full flex flex-col flex-wrap p-1 sm:w-4/12 md:w-3/12 lg:w-2/12"},Cs=e("label",{for:""},"Type",-1),Is=["disabled"],Ds=e("option",{value:"used"},"Used",-1),Ms=e("option",{value:"in"},"In",-1),As=e("option",{value:"transfer"},"Transfer",-1),Ts=[Ds,Ms,As],Ns={class:"text-red-500"},js={class:"w-full sm:w-4/12 md:w-3/12 lg:w-2/12 flex flex-col flex-wrap p-1"},qs=e("label",{for:""},"From Warehouse",-1),Ls={key:0,class:"w-full flex"},Os=e("div",{class:"flex items-center grow p-1"}," Pilih Warehouse yang dikelola ",-1),Rs={key:1,class:"w-full flex",style:{}},Fs={class:"flex flex-row flex-wrap grow"},Vs={class:"p-1"},Bs=e("div",{class:"text-sm text-gray-600"},"ID",-1),Hs={class:"bold"},Us={class:"p-1"},zs=e("div",{class:"text-sm text-gray-600"},"Name",-1),Es={class:"bold"},Ks={class:"flex flex-row flex-wrap grow"},Ps={class:"p-1"},Js=e("div",{class:"text-sm text-gray-600"},"ID",-1),Ws={class:"bold"},Ys={class:"p-1"},Qs=e("div",{class:"text-sm text-gray-600"},"Name",-1),Gs={class:"bold"},Xs={class:"text-red-500"},Zs={key:1,class:"w-full sm:w-4/12 md:w-3/12 lg:w-2/12 flex flex-col flex-wrap p-1"},el=e("label",{for:""},"To Warehouse",-1),tl={key:0,class:"w-full flex"},sl=e("div",{class:"flex items-center grow p-1"}," Pilih Warehouse Target ",-1),ll={key:1,class:"w-full flex",style:{}},ol={class:"flex flex-row flex-wrap grow"},al={class:"p-1"},nl=e("div",{class:"text-sm text-gray-600"},"ID",-1),il={class:"bold"},rl={class:"p-1"},ul=e("div",{class:"text-sm text-gray-600"},"Name",-1),cl={class:"bold"},dl={class:"text-red-500"},_l={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},fl=e("label",{for:""},"Note",-1),vl=["disabled"],pl={class:"text-red-500"},ml={class:"w-full flex grow p-1 overflow-auto"},hl={role:"sticky",ref:"loadRef"},wl={class:"tacky w-full",style:{"white-space":"normal"}},yl={class:"sticky top-0 !z-[2]"},xl={key:0,class:"min-w-[50px] !w-[50px] max-w-[50px]"},bl=e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1),gl={key:1,class:"min-w-[50px] !w-[50px] max-w-[50px]"},kl=e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"ID Item",-1),$l=e("th",null,"Nama Item",-1),Sl=e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"Qty In",-1),Cl=e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"Qty Out",-1),Il=e("th",null,"Keterangan",-1),Dl=["data-index","onDragstart","onDrop"],Ml={key:0,class:"tools cell"},Al={class:"w-full h-full flex items-center justify-center"},Tl=["onClick"],Nl={key:1,class:"cell"},jl={class:"w-full h-full flex items-center justify-center"},ql=["onClick"],Ll=["onClick","disabled"],Ol={class:"w-full h-full flex items-center justify-center"},Rl={class:"w-full h-full flex items-center justify-center"},Fl={class:"cell"},Vl={class:"w-full h-full flex items-center justify-center"},Bl={class:"cell"},Hl={class:"w-full h-full flex items-center justify-center"},Ul={class:"cell"},zl={class:"w-full h-full flex items-center justify-center"},El=["disabled","onUpdate:modelValue","tabindex"],Kl={key:0},Pl={class:"tools cell"},Jl={class:"w-full flex items-center justify-end"},no=$e({__name:"form",async setup(c){var he,we,ye;let u,b;We();const T=pe("token"),A=_({}),h=Ye(),g=Qe();let v={id:"",name:""};const{data:d}=([u,b]=Ge(async()=>Xe(async()=>{const i=g.query.id;let l=null,D=null,F=null;if(i!==void 0&&i!==""){Y().loading_full=!0;const{data:K,error:se,status:fe}=await de("/transaction",{method:"get",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},params:{id:i},retry:0});Y().loading_full=!1,fe.value==="error"?ce().trigger(se,A):(l=K.value.data,F=K.value.data.details.map(P=>(P.status="Edit",P.key=P.ordinal,P)),D=K.value.data.details.map(P=>P.item.id))}return{transaction:l,exclude_lists:D,details:F}},"$RAej7t9zIe")),u=await u,b(),u),s=_(((he=d.value)==null?void 0:he.transaction)||{id:-1,type:"used",note:"",warehouse:{...v},warehouse_target:{...v},details:[]}),o=_(((we=d.value)==null?void 0:we.exclude_lists)||[]),n=_(((ye=d.value)==null?void 0:ye.details)||[]),k=_({ordinal:0,item:{id:"",name:"",unit:{id:"",name:""}},item_id:"",qty_in:0,qty_out:0,note:"",status:""}),S=_(!1),ee=()=>{S.value=!1},z=i=>{n.value[y.value].item=i,n.value[y.value].item_id=i.id,o.value.push(i.id),S.value=!1},B=i=>{i.forEach(l=>{let D={...k.value,status:"Add"};D.item=l,D.item_id=l.id,o.value.push(l.id),n.value.push(D)}),S.value=!1},q=_(!1),E=(i,l)=>{y.value=l,q.value=!1,S.value=!0},te=(i,l)=>{q.value=!0,S.value=!0},N=(i,l)=>{let D=n.value[l].item.id,F=o.value.indexOf(D);F>-1&&o.value.splice(F,1),n.value[l].item_id="",n.value[l].item={id:"",name:"",unit:{id:"",name:""}}};let x=_(!1),H="";const G=i=>{i=="from"?s.value.warehouse={...v}:i=="to"&&(s.value.warehouse_target={...v})},C=i=>{H=i,x.value=!0},R=()=>{x.value=!1},ne=i=>{H=="from"?s.value.warehouse={...i}:H=="to"&&(s.value.warehouse_target={...i}),x.value=!1},m=async()=>{Y().loading_full=!0,A.value={};let i={type:s.value.type,note:s.value.note,warehouse_id:s.value.warehouse.id,warehouse_target_id:s.value.warehouse_target.id,details:JSON.stringify(n.value)},l="post",D=g.query.id;D===""||(l="put",i.id=D);const{data:F,error:K,status:se}=await de("/transaction",{method:l,headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},body:i,retry:0});if(Y().loading_full=!1,se.value==="error"){ce().trigger(K,A);return}h.go(-1)},w=xe(()=>{var i,l;return((i=s.value.warehouse)==null?void 0:i.id)||((l=s.value.warehouse_target)==null?void 0:l.id)||0}),y=_(-1),X=_(!1),ie=_({left:0,top:0}),I=(i,l)=>{y.value=l,X.value=!0,ie.value={left:i.clientX,top:i.clientY}},Z=()=>{n.value.push({...k.value,status:"Add"})},_e=()=>{X.value=!1},je=(i="")=>{if(i=="insert")n.value.splice(y.value,0,{...k.value,status:"Add"});else if(i=="delete"){let l=n.value[y.value].item.id,D=o.value.indexOf(l);D>-1&&o.value.splice(D,1),n.value[y.value].status=="Edit"?n.value[y.value].status="Remove":n.value.splice(y.value,1)}else if(i=="move_top"){let l=n.value[y.value];n.value.splice(y.value,1),n.value.splice(y.value-1,0,{...l})}else if(i=="move_bottom"){let l=n.value[y.value];n.value.splice(y.value,1),n.value.splice(y.value+1,0,{...l})}X.value=!1},$=xe(()=>s.value.confirmed_by||s.value.ref_id!=null),qe=(i,l)=>{i.dataTransfer.setData("application/json",JSON.stringify(l))},Le=(i,l)=>{let D=JSON.parse(i.dataTransfer.getData("application/json")),F=n.value[D];n.value.splice(D,1),n.value.splice(l,0,{...F})},me=_(null);return Ze(()=>{$.value||Ne(me,n)}),(i,l)=>{const D=Be,F=ve,K=He,se=Ue,fe=ge,P=Ee,Oe=Ke,Re=Pt,Fe=hs,Ve=ze;return a(),r(Q,null,[e("div",ws,[M(D,{title:"Form Transaksi",back:!0}),e("form",ys,[e("div",xs,[e("div",bs,[t(s).confirmed_by?(a(),r("div",gs,[ks,e("div",$s,f(i.$moment(t(s).input_at).format("DD-MM-Y")),1)])):j("",!0),e("div",Ss,[Cs,V(e("select",{disabled:t($),class:"","onUpdate:modelValue":l[0]||(l[0]=p=>t(s).type=p)},Ts,8,Is),[[ae,t(s).type]]),e("p",Ns,f(t(A).type),1)]),e("div",js,[qs,e("div",{class:W(["w-full flex flex-row flex-wrap",t($)?"unselectable":""])},[!t(s).warehouse||!t(s).warehouse.id?(a(),r("div",Ls,[e("button",{type:"button",onClick:l[1]||(l[1]=p=>C("from")),class:"flex items-center grow"},[M(F,{class:"text-2xl text-black"}),Os])])):t(s).ref_id==null?(a(),r("div",Rs,[e("div",Fs,[e("div",Vs,[Bs,e("div",Hs,f(t(s).warehouse.id),1)]),e("div",Us,[zs,e("div",Es,f(t(s).warehouse.name),1)])]),t($)?j("",!0):(a(),r("button",{key:0,type:"button",class:"w-10 bg-red-600 flex items-center justify-center",onClick:l[2]||(l[2]=p=>G("from"))},[M(K,{class:"text-2xl text-white"})]))])):t(s).ref_id!=null?(a(),r("div",{key:2,class:W(["w-full flex",t($)?"unselectable":""]),style:{}},[e("div",Ks,[e("div",Ps,[Js,e("div",Ws,f(t(s).warehouse_source.id),1)]),e("div",Ys,[Qs,e("div",Gs,f(t(s).warehouse_source.name),1)])]),t($)?j("",!0):(a(),r("button",{key:0,type:"button",class:"w-10 bg-red-600 flex items-center justify-center",onClick:l[3]||(l[3]=p=>G("from"))},[M(K,{class:"text-2xl text-white"})]))],2)):j("",!0)],2),e("p",Xs,f(t(A).warehouse_id),1)]),t(s).type=="transfer"?(a(),r("div",Zs,[el,e("div",{class:W(["w-full flex flex-row flex-wrap",t($)?"unselectable":""])},[!t(s).warehouse_target||!t(s).warehouse_target.id?(a(),r("div",tl,[e("button",{type:"button",onClick:l[4]||(l[4]=p=>C("to")),class:"flex items-center grow"},[M(F,{class:"text-2xl text-black"}),sl])])):(a(),r("div",ll,[e("div",ol,[e("div",al,[nl,e("div",il,f(t(s).warehouse_target.id),1)]),e("div",rl,[ul,e("div",cl,f(t(s).warehouse_target.name),1)])]),t($)?j("",!0):(a(),r("button",{key:0,type:"button",class:"w-10 bg-red-600 flex items-center justify-center",onClick:l[5]||(l[5]=p=>G("to"))},[M(K,{class:"text-2xl text-white"})]))]))],2),e("p",dl,f(t(A).warehouse_target_id),1)])):j("",!0),e("div",_l,[fl,V(e("textarea",{disabled:t($),class:"","onUpdate:modelValue":l[6]||(l[6]=p=>t(s).note=p)},null,8,vl),[[ue,t(s).note]]),e("p",pl,f(t(A).note),1)])]),e("div",ml,[e("div",hl,[e("table",wl,[e("thead",null,[e("tr",yl,[t($)?j("",!0):(a(),r("th",xl,[e("button",{type:"button",name:"button",class:"bg-yellow-600",onClick:l[7]||(l[7]=p=>te())}," Bulk Add ")])),bl,t($)?j("",!0):(a(),r("th",gl)),kl,$l,Sl,Cl,Il])]),e("tbody",{ref_key:"to_move",ref:me},[(a(!0),r(Q,null,le(t(n),(p,U)=>(a(),r(Q,{key:U},[p.status!="Remove"?(a(),r("tr",{key:0,"data-index":U,draggable:"true",onDragstart:L=>qe(L,U),onDragover:l[8]||(l[8]=oe(()=>{},["prevent"])),onDrop:L=>Le(L,U)},[t($)?j("",!0):(a(),r("td",Ml,[e("div",Al,[e("button",{type:"button",name:"button",onClick:L=>I(L,U)},[M(se)],8,Tl)])])),e("td",null,f(U+1)+".",1),t($)?j("",!0):(a(),r("td",Nl,[e("div",jl,[p.item_id?(a(),r("button",{key:1,type:"button",onClick:L=>N(L,U),disabled:p.confirm_by},[M(fe,{class:"font-bold text-2xl"})],8,Ll)):(a(),r("button",{key:0,type:"button",name:"button",onClick:L=>E(L,U)}," ... ",8,ql))])])),e("td",{class:W(["cell bold",t($)?"unselectable":""])},[e("div",Ol,f(p.item.id),1)],2),e("td",{class:W(["cell",t($)?"unselectable":""])},[e("div",Rl,f(p.item.name),1)],2),e("td",Fl,[e("div",Vl,[(a(),be(P,{disabled:t($)||t(s).type=="used"||t(s).type=="transfer",key:U,class:"w-full h-full p-1",type:"text",value:p.qty_in||0,onInput:L=>p.qty_in=L,tabindex:t(n).length*0+1},null,8,["disabled","value","onInput","tabindex"]))])]),e("td",Bl,[e("div",Hl,[(a(),be(P,{disabled:t($)||t(s).type=="in",key:U,class:"w-full h-full p-1",type:"text",value:p.qty_out||0,onInput:L=>p.qty_out=L,tabindex:t(n).length*1+1},null,8,["disabled","value","onInput","tabindex"]))])]),e("td",Ul,[e("div",zl,[V(e("textarea",{disabled:t($),class:"p-1 w-full","onUpdate:modelValue":L=>p.note=L,cols:"7",rows:"2",tabindex:t(n).length*2+1},null,8,El),[[ue,p.note]])])])],40,Dl)):j("",!0)],64))),128)),t($)?j("",!0):(a(),r("tr",Kl,[e("td",Pl,[e("button",{type:"button",name:"button",onClick:l[9]||(l[9]=p=>Z())},[M(Oe)])])]))],512)])],512)])]),e("div",Jl,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:l[10]||(l[10]=p=>i.$router.go(-1))}," Cancel "),t($)?j("",!0):(a(),r("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:l[11]||(l[11]=oe(p=>m(),["prevent"]))}," Save "))])])]),M(Re,{show:t(S),fnClose:ee,fnSelect:z,fnSelectMulti:B,exclude_lists:t(o),enableMultiSelect:t(q),multi_key:["id","name"]},null,8,["show","exclude_lists","enableMultiSelect"]),M(Fe,{show:t(x),fnClose:R,fnSelect:ne,opt:t(H),exclude:t(w)},null,8,["show","opt","exclude"]),M(Ve,{show:t(X),coor:t(ie),fn:_e,data:t(n),data_index:t(y),onReplyAct:l[12]||(l[12]=p=>je(p))},null,8,["show","coor","data","data_index"])],64)}}});export{no as default};
