import se from"./Header.f4bd81f9.js";import oe from"./Plus.96388b84.js";import le from"./Edit.7a14f9d1.js";import re from"./Signature.c82d7fc7.js";import ne from"./Table2Column.33a7291c.js";import ie from"./Line.48f5c11a.js";import ue from"./Check.718be30a.js";import{_ as ce}from"./PopupMini.vue.1f68efd6.js";import de from"./rpt_salary.6a54a2db.js";import _e from"./rpt_salary_validasi.25b19f5a.js";import{g as fe,h as me,r as o,B as pe,j as U,s as ve,f as ye,c as _,b as f,a,l as t,n as x,F as he,D as ge,w as ke,q as we,x as m,y as b,o as u,E as xe,z,t as C,d as be,k as Ce,A as De,m as Ae,G as $e}from"./entry.5eaee47b.js";import{u as B}from"./useUtils.478d066b.js";import{u as D}from"./useMyFetch.c1c4d34c.js";import{u as Me}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.83c50a35.js";import"./Exclamation.ae96152b.js";import"./HeaderPopup.vue.4d128728.js";import"./client-only.4c910340.js";const Se={class:"w-full h-full flex flex-col"},Te={class:"w-full flex grow flex-col overflow-auto h-0"},Pe={class:"w-full flex"},Be={class:"w-full flex justify-center items-center grow h-0 p-1"},Fe={key:0,class:""},Le={class:"tacky"},Ee=a("thead",null,[a("tr",{class:"sticky top-0 !z-[2]"},[a("th",null,"Logistik"),a("th",null,"ID"),a("th",null,"Period End"),a("th",null,"Created At"),a("th",null,"Updated At")])],-1),Ue=["onClick"],ze={class:"flex items-center justify-center"},Ie={class:"bold"},Re={class:"grow mb-5"},it={__name:"rpt",async setup(je){let y,F;const{$moment:A}=$e(),c={};c._TimeZoneOffset=new Date().getTimezoneOffset(),c.sort="created_at:desc";const h=fe("token"),{data:I}=([y,F]=me(async()=>we(async()=>{let e=[];m().loading_full=!0;const{data:s,error:d,status:v}=await D("/rpt_salarys",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},params:c,retry:0});return m().loading_full=!1,v.value==="error"?(b().trigger(d),{rpt_salarys:e}):(e=s.value.data,{rpt_salarys:e})},"$fWJlXxIgiP")),y=await y,F(),y),l=o(I.value.rpt_salarys);o(""),o({field:"created_at",by:"desc"});const n=o(-1),i=o({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),g=o(null),R=async()=>{m().loading_full=!0,i.value.may_get_data=!1,c.page=i.value.page,c.page==1&&(l.value=[]),c.first_row&&delete c.first_row,c.page>1&&(c.first_row=JSON.stringify(l.value[0]));const{data:e,error:s,status:d}=await D("/rpt_salarys",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},params:c,retry:0});if(m().loading_full=!1,i.value.may_get_data=!0,d.value==="error"){b().trigger(s);return}i.value.page==1?(l.value=e.value.data,g.value&&(g.value.scrollTop=0)):i.value.page>1&&(l.value=[...l.value,...e.value.data]),e.value.data.length==0&&(i.value.is_last_record=!0)},j=async()=>{if(!i.value.may_get_data)return;let e=g.value;if(e.scrollLeft!=i.value.scrollLeft){i.value.scrollLeft=e.scrollLeft;return}i.value.is_last_record||!(Math.round(e.scrollTop)+e.clientHeight>=e.scrollHeight-1)||(i.value.page++,await R())};pe();const k=o(!1),$=o(0),M=o(0),H=()=>{$.value=0,k.value=!0,M.value=!1},{display:L}=U();ve(U());const N=()=>{n.value==-1?L({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):($.value=l.value[n.value].id,k.value=!0,M.value=!1)},S=o(!1),E=o(0),O=()=>{n.value==-1?L({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(E.value=l.value[n.value].id,S.value=!0)},T=o(!1),V=o({}),w=o(!1),p=o(""),Y=async()=>{w.value&&(w.value=!1)};ye(()=>p.value,e=>{e.trim().length>0?T.value=!0:T.value=!1},{immediate:!1});const J=async()=>{m().loading_full=!0;const e=new FormData;e.append("id",l.value[n.value].id),e.append("deleted_reason",p.value),e.append("_method","DELETE");const{data:s,error:d,status:v}=await D("/rpt_salary",{method:"post",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},body:e,retry:0});if(m().loading_full=!1,v.value==="error"){b().trigger(d);return}l.value.splice(n.value,1),n.value=-1,w.value=!1},{downloadFile:q,viewFile:He}=Me();o(!1),o({});const G=async()=>{m().loading_full=!0;const{data:e,error:s,status:d}=await D("/rpt_salary/excel_download",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},params:{id:l.value[n.value].id},retry:0});if(m().loading_full=!1,d.value==="error"){b().trigger(s);return}q(e.value)};return(e,s)=>{const d=se,v=oe,W=le,X=re,Z=ne,K=ie,Q=ue,ee=ce,te=de,ae=_e;return u(),_("div",Se,[f(d,{title:"List Salary Paid"}),a("div",Te,[a("div",Pe,[("useUtils"in e?e.useUtils:t(B))().checkPermission("rpt_salary.create")?(u(),_("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[0]||(s[0]=r=>H())},[f(v)])):x("",!0),("useUtils"in e?e.useUtils:t(B))().checkPermissions(["rpt_salary.modify"])?(u(),_("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[1]||(s[1]=r=>N())},[f(W)])):x("",!0),("useUtils"in e?e.useUtils:t(B))().checkPermissions(["rpt_salary.val1","rpt_salary.val2","rpt_salary.val3"])?(u(),_("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[2]||(s[2]=r=>O())},[f(X)])):x("",!0),t(n)>-1&&t(l)[t(n)].val1==1?(u(),_("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[3]||(s[3]=r=>G())},[f(Z)])):x("",!0)]),a("div",Be,[t(l).length==0?(u(),_("div",Fe," Maaf Tidak Ada Record ")):(u(),_("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:g,onScroll:j},[a("table",Le,[Ee,a("tbody",null,[(u(!0),_(he,null,ge(t(l),(r,P)=>(u(),_("tr",{key:P,onClick:Ne=>n.value=P,class:xe(t(n)==P?"active":"")},[a("td",null,[a("div",ze,[r.val1?(u(),z(Q,{key:1})):(u(),z(K,{key:0}))])]),a("td",Ie,C(r.id),1),a("td",null,C(r.period_end?t(A)(r.period_end).format("MM-Y"):""),1),a("td",null,C(r.created_at?t(A)(r.created_at).format("DD-MM-Y HH:mm:ss"):""),1),a("td",null,C(r.updated_at?t(A)(r.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,Ue))),128))])])],544))])]),f(ee,{type:"delete",show:t(w),data:t(V),fnClose:Y,fnConfirm:J,enabledOk:t(T)},{footer:ke(()=>[be(" Masukkan Alasan Penghapusan: "),a("div",Re,[Ce(a("textarea",{"onUpdate:modelValue":s[4]||(s[4]=r=>Ae(p)?p.value=r:null)},null,512),[[De,t(p)]])])]),_:1},8,["show","data","enabledOk"]),f(te,{show:t(k),fnClose:()=>{k.value=!1},id:t($),p_data:t(l),is_copy:t(M)},null,8,["show","fnClose","id","p_data","is_copy"]),f(ae,{show:t(S),fnClose:()=>{S.value=!1},id:t(E),p_data:t(l)},null,8,["show","fnClose","id","p_data"])])}}};export{it as default};
