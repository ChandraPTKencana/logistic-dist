import lt from"./Header.f4bd81f9.js";import nt from"./Calendar.91614731.js";import at from"./CarTag.23ad0d80.js";import rt from"./TruckDriver.6861764b.js";import it from"./TruckDriverOutline.cc86c88e.js";import ct from"./LocationOn.eb1d1a64.js";import{_ as dt}from"./HeaderPopup.vue.4d128728.js";import _t from"./Image.eabc797c.js";import xt from"./GAPIN.0c86c436.js";import{g as ft,h as ut,r as u,j as pt,i as ht,f as mt,c as i,b as p,a as t,k as T,A as gt,l as s,m as vt,F as C,D as H,J as L,t as o,n as x,d as I,q as bt,x as b,y as N,o as c,G as yt}from"./entry.5eaee47b.js";import{u as wt}from"./useUtils.478d066b.js";import{u as $}from"./useMyFetch.c1c4d34c.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.83c50a35.js";const kt={class:"w-full h-full flex flex-col relative"},Tt={class:"grow flex flex-col"},Dt={class:"w-full flex items-center p-1"},Yt={class:"grow"},Mt={class:"grow overflow-auto h-0"},jt={class:"p-1 grow"},At={class:"bg-white flex py-2 justify-between"},Ct={class:"flex flex-wrap"},Ht={class:"flex items-center justify-center m-2 text-xs"},Lt={class:"bg-blue-400 p-2 font-bold text-white"},It={class:"flex flex-col m-2"},Nt=t("span",{class:"text-xs"}," Tgl Terima U.Jalan ",-1),$t={class:"flex items-center justify-center"},St={class:"flex flex-col m-2"},Pt=t("span",{class:"text-xs"}," Nomor Kendaraan ",-1),Bt={class:"flex items-center justify-center"},Kt=["data-real"],Rt={class:"flex flex-col m-2"},Vt=t("span",{class:"text-xs"}," Nama Supir ",-1),Ft={class:"flex items-center justify-center"},Ut=["data-real"],qt={key:0,class:"flex flex-col m-2"},zt=t("span",{class:"text-xs"}," Nama Kernet ",-1),Jt={class:"flex items-center justify-center"},Et=["data-real"],Ot={class:"flex flex-col m-2"},Gt=t("span",{class:"text-xs"}," Tujuan ",-1),Wt={class:"flex items-center justify-center"},Qt=["onClick"],Xt={class:"w-full h-full fixed top-0 left-0 bg-gray-100 bg-opacity-80 flex items-center justify-center z-10"},Zt={class:"w-full sm:w-10/12 md:w-10/12 lg:w-8/12 bg-white flex flex-col border-solid border-gray-200 max-w-full max-h-full overflow-auto",style:{"border-width":"1px"}},ts={class:"p-1 flex flex-wrap overflow-auto items-start"},ss={class:"w-full flex flex-wrap"},es={class:"w-full flex flex-wrap"},os={class:"flex flex-col m-2 border-solid border-l-4 border-blue-400 px-2 bg-gray-200"},ls=t("span",{class:"text-xs font-bold"}," ID ",-1),ns={class:""},as={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},rs=t("span",{class:"text-xs font-bold"}," Tgl Terima U.Jalan ",-1),is={class:""},cs={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},ds=t("span",{class:"text-xs font-bold"}," Nomor Kendaraan ",-1),_s={class:""},xs={class:"flex flex-row flex-wrap m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},fs={class:"flex flex-col"},us=t("span",{class:"text-xs font-bold"}," Nama Supir ",-1),ps={class:""},hs={class:"flex flex-col pl-2"},ms=t("span",{class:"text-xs font-bold"}," No rek ",-1),gs={class:""},vs={key:0,class:"flex flex-row flex-wrap m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},bs={class:"flex flex-col"},ys=t("span",{class:"text-xs font-bold"}," Nama Kernet ",-1),ws={class:""},ks={class:"flex flex-col pl-2"},Ts=t("span",{class:"text-xs font-bold"}," No rek ",-1),Ds={class:""},Ys={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},Ms=t("span",{class:"text-xs font-bold"}," Tujuan ",-1),js={class:""},As={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},Cs=t("span",{class:"text-xs font-bold"}," Tipe ",-1),Hs={class:""},Ls={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},Is=t("span",{class:"text-xs font-bold"}," Jenis ",-1),Ns={class:""},$s={key:1,class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},Ss=t("span",{class:"text-xs font-bold"}," Pengalihan ",-1),Ps={class:""},Bs={class:"w-full flex flex-wrap justify-center"},Ks={key:0,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},Rs=t("span",{class:"text-xs font-bold"}," App Kasir ",-1),Vs={class:"text-xs"},Fs={key:1,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},Us=t("span",{class:"text-xs font-bold"}," App Mandor ",-1),qs={class:"text-xs"},zs={key:2,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},Js=t("span",{class:"text-xs font-bold"}," App KTU/W ",-1),Es={class:"text-xs"},Os={key:3,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},Gs=t("span",{class:"text-xs font-bold"}," App Marketing ",-1),Ws={class:"text-xs"},Qs={key:4,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},Xs=t("span",{class:"text-xs font-bold"}," App Logistik ",-1),Zs={class:"text-xs"},te={key:5,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},se=t("span",{class:"text-xs font-bold"}," App SPV Logistik ",-1),ee={class:"text-xs"},oe={class:"w-full sm:w-1/2 text-sm flex justify-center"},le={class:"border border-collapse border-black"},ne=t("tr",null,[t("th",{colspan:"4",class:"bg-blue-400"}," List Uang Jalan ")],-1),ae={class:"p-1"},re={class:"p-1"},ie=t("td",{class:"p-1"},"= Rp.",-1),ce={class:"text-right p-1"},de={class:"border-t-black border-dashed",style:{"border-top-width":"1px"}},_e=t("th",{colspan:"2",class:"text-right"},"Total",-1),xe=t("th",{class:"p-1 text-right"},"Rp.",-1),fe={class:"p-1 text-right"},ue={key:0,class:"text-red-500 font-bold"},pe=t("td",{colspan:"2",class:"text-right"},"Potongan Supir",-1),he=t("td",{class:"p-1 text-right"},"Rp.",-1),me={class:"p-1 text-right"},ge={key:1,class:"text-red-500 font-bold"},ve=t("td",{colspan:"2",class:"text-right"},"Potongan Kernet",-1),be=t("td",{class:"p-1 text-right"},"Rp.",-1),ye={class:"p-1 text-right"},we={key:2,class:"text-red-500 font-bold"},ke=t("td",{colspan:"2",class:"text-right"},"Total Potongan",-1),Te=t("td",{class:"p-1 text-right"},"Rp.",-1),De={class:"p-1 text-right"},Ye={key:3,class:"font-bold"},Me=t("td",{colspan:"2",class:"text-right"},"Total Diterima",-1),je=t("td",{class:"p-1 text-right"},"Rp.",-1),Ae={class:"p-1 text-right"},Ce={class:"w-full sm:w-1/2 h-full"},He=["src"],Le={key:1,class:"flex flex-col justify-center items-center px-2 py-8 border border-gray-700 bg-gray-300"},Ie={class:"w-full border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200 mt-2 flex flex-row flex-wrap"},Ne={class:"flex flex-col mr-5"},$e=t("span",{class:"text-xs font-bold"}," EM#ID ",-1),Se={class:""},Pe={class:"flex flex-col mr-5"},Be=t("span",{class:"text-xs font-bold"}," Nama Penerima ",-1),Ke={class:""},Re={class:"flex flex-col mr-5"},Ve=t("span",{class:"text-xs font-bold"}," No rek ",-1),Fe={class:""},Ue={class:"flex flex-col mr-5"},qe=t("span",{class:"text-xs font-bold"}," Tanggal ",-1),ze={class:""},Je={class:"flex flex-col mr-5"},Ee=t("span",{class:"text-xs font-bold"}," Tujuan ",-1),Oe={class:""},Ge={class:"flex flex-col mr-5"},We=t("span",{class:"text-xs font-bold"}," Desc ",-1),Qe={class:""},Xe={class:"flex flex-col mr-5"},Ze=t("span",{class:"text-xs font-bold"}," Total ",-1),to={class:""},so={class:"flex p-1 justify-end flex-wrap"},eo={class:"flex p-1 justify-center flex-wrap bg-yellow-100"},oo=t("div",{class:"w-full text-center"}," Akan dilakukan Transfer dengan data diatas. Apakah Informasi Diatas Sudah Benar Dan Tepat? ",-1),bo={__name:"transfer",async setup(lo){let y,S;const{$moment:h}=yt(),{pointFormat:f}=wt(),D=ft("token");new Date().getTimezoneOffset();const{data:J}=([y,S]=ut(async()=>bt(async()=>{b().loading_full=!0;let n=[];const[l,d]=await Promise.all([$("/trx_trp/transfers",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},retry:0})]);return l.status.value==="error"?(N().trigger(l.error),{trx_trps:n}):(b().loading_full=!1,n=l.data.value.data,{trx_trps:n})},"$pIgiM26TjW")),y=await y,S(),y),Y=u(J.value.trx_trps||[]),M=u({}),e=u({id:-1,tanggal:new Date,xto:"",tipe:"",jenis:"",amount:0,supir:"",kernet:"",no_pol:"",details_uj:[]}),j=u(-1),m=u(""),E=async n=>{b().loading_full=!0;const{data:l,error:d,status:r}=await $("/trx_trp/transfer/detail",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},params:{id:n.id},retry:0});if(b().loading_full=!1,r.value==="error"){N().trigger(d,M);return}e.value=l.value.data},O=async()=>{b().loading_full=!0,M.value={};const n=new FormData;n.append("id",e.value.id),n.append("_method","PUT");let l="post";const{data:d,error:r,status:_}=await $("/trx_trp/transfer",{method:l,headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},body:n,retry:0});if(b().loading_full=!1,_.value==="error"){N().trigger(r,M);return}Y.value.splice(j.value,1),j.value=-1,v.value=!1,g.value=!1},g=u(!1),G=u(0),v=u(!1);pt();const W=(n,l)=>{j.value=n,G.value=l,g.value=!0,E(l)},P=ht(()=>m.value!=""?Y.value.filter(n=>n.no_pol.toLowerCase().includes(m.value.toLowerCase())||n.supir.toLowerCase().includes(m.value.toLowerCase())||n.kernet.toLowerCase().includes(m.value.toLowerCase())):Y.value),w=n=>n.potongan&&n.potongan.length>0?n.potongan.map(l=>parseInt(l.nominal_cut)).reduce((l,d)=>(l+=d,l)):0,B=n=>{if(n.potongan&&n.potongan.length>0){let l=n.potongan.filter(r=>r.potongan_mst.employee_id==n.supir_id);if(l.length==0)return 0;let d=l.map(r=>parseInt(r.nominal_cut));return d.length==0?0:d.reduce((r,_)=>(r+=_,r))}return 0},K=n=>{if(n.potongan&&n.potongan.length>0){let l=n.potongan.filter(r=>r.potongan_mst.employee_id==n.kernet_id);if(l.length==0)return 0;let d=l.map(r=>parseInt(r.nominal_cut));return d.length==0?0:d.reduce((r,_)=>(r+=_,r))}return 0},Q=()=>{let n=m.value;document.querySelectorAll(".to_hl").forEach(l=>{let d=l.dataset.real;var r=l.innerHTML,_=d.toLowerCase().indexOf(n.toLowerCase());_>-1&&n!=""?(r=d.substring(0,_)+"<span class='highlight'>"+d.substring(_,_+n.length)+"</span>"+d.substring(_+n.length),l.innerHTML=r):l.innerHTML=r=d})};mt(()=>P,(n,l)=>{setTimeout(()=>{Q()},0)},{deep:!0,immediate:!0});const R=u(0);return(n,l)=>{var V;const d=lt,r=nt,_=at,X=rt,Z=it,tt=ct,st=dt,et=_t,ot=xt;return c(),i("div",kt,[p(d,{title:"List Transaction"}),t("section",Tt,[t("div",Dt,[t("div",Yt,[T(t("input",{class:"flex-grow",type:"text","onUpdate:modelValue":l[0]||(l[0]=a=>vt(m)?m.value=a:null),name:"search",placeholder:"Keyword"},null,512),[[gt,s(m)]])])]),t("div",Mt,[(c(!0),i(C,null,H(s(P),(a,k)=>(c(),i("div",jt,[t("div",At,[t("div",Ct,[t("div",Ht,[t("div",Lt,o(a.id),1)]),t("div",It,[Nt,t("div",$t,[p(r,{class:"mr-1"}),I(" "+o(s(h)(a.tanggal).format("DD-MM-YYYY")),1)])]),t("div",St,[Pt,t("div",Bt,[p(_,{class:"mr-1"}),t("span",{class:"to_hl","data-real":a.no_pol},o(a.no_pol),9,Kt)])]),t("div",Rt,[Vt,t("div",Ft,[p(X,{class:"mr-1"}),t("span",{class:"to_hl","data-real":a.supir},o(a.supir),9,Ut)])]),a.kernet?(c(),i("div",qt,[zt,t("div",Jt,[p(Z,{class:"mr-1"}),t("span",{class:"to_hl","data-real":a.kernet},o(a.kernet),9,Et)])])):x("",!0),t("div",Ot,[Gt,t("div",Wt,[p(tt,{class:"mr-1"}),I(" "+o(a.xto),1)])])]),t("button",{class:"bg-blue-500 text-white rounded",onClick:A=>W(k,a)}," Detail ",8,Qt)])]))),256))])]),T(t("div",Xt,[t("div",Zt,[p(st,{title:"Detail Information",fn:()=>{g.value=!1,v.value=!1},class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("div",ts,[t("div",ss,[t("div",es,[t("div",os,[ls,t("div",ns,o(s(e).id),1)]),t("div",as,[rs,t("div",is,o(s(h)(s(e).tanggal).format("DD-MM-YYYY")),1)]),t("div",cs,[ds,t("div",_s,o(s(e).no_pol),1)]),t("div",xs,[t("div",fs,[us,t("div",ps,o(s(e).supir),1)]),t("div",hs,[ms,t("div",gs,o(s(e).supir_rek_no),1)])]),s(e).kernet?(c(),i("div",vs,[t("div",bs,[ys,t("div",ws,o(s(e).kernet),1)]),t("div",ks,[Ts,t("div",Ds,o(s(e).kernet_rek_no),1)])])):x("",!0),t("div",Ys,[Ms,t("div",js,o(s(e).xto),1)]),t("div",As,[Cs,t("div",Hs,o(s(e).tipe),1)]),t("div",Ls,[Is,t("div",Ns,o(s(e).jenis),1)]),s(e).transition_type=="From"?(c(),i("div",$s,[Ss,t("div",Ps,o(s(e).transition_target),1)])):x("",!0)]),t("div",Bs,[s(e).val?(c(),i("div",Ks,[Rs,t("div",null," ( "+o(s(e).val_by.username)+" ) ",1),t("div",Vs,o(s(h)(s(e).val_at).format("DD-MM-YYYY HH:mm:ss")),1)])):x("",!0),s(e).val1?(c(),i("div",Fs,[Us,t("div",null," ( "+o(s(e).val1_by.username)+" ) ",1),t("div",qs,o(s(h)(s(e).val1_at).format("DD-MM-YYYY HH:mm:ss")),1)])):x("",!0),s(e).val2?(c(),i("div",zs,[Js,t("div",null," ( "+o(s(e).val2_by.username)+" ) ",1),t("div",Es,o(s(h)(s(e).val2_at).format("DD-MM-YYYY HH:mm:ss")),1)])):x("",!0),s(e).val3?(c(),i("div",Os,[Gs,t("div",null," ( "+o(s(e).val3_by.username)+" ) ",1),t("div",Ws,o(s(h)(s(e).val3_at).format("DD-MM-YYYY HH:mm:ss")),1)])):x("",!0),s(e).val4?(c(),i("div",Qs,[Xs,t("div",null," ( "+o(s(e).val4_by.username)+" ) ",1),t("div",Zs,o(s(h)(s(e).val4_at).format("DD-MM-YYYY HH:mm:ss")),1)])):x("",!0),s(e).val5?(c(),i("div",te,[se,t("div",null," ( "+o(s(e).val5_by.username)+" ) ",1),t("div",ee,o(s(h)(s(e).val5_at).format("DD-MM-YYYY HH:mm:ss")),1)])):x("",!0)])]),t("div",oe,[t("table",le,[ne,(c(!0),i(C,null,H(s(e).details_uj,a=>(c(),i("tr",null,[t("td",ae,o(a.ordinal)+". ",1),t("td",re,o(a.xdesc)+" "+o(a.qty<=1?"":s(f)(a.qty||0)+" x Rp."+s(f)(a.harga||0)),1),ie,t("td",ce,o(s(f)(a.qty*a.harga)),1)]))),256)),t("tr",de,[_e,xe,t("th",fe,o(s(f)(s(e).amount)),1)]),B(s(e))>0?(c(),i("tr",ue,[pe,he,t("td",me,o(s(f)(B(s(e)))),1)])):x("",!0),K(s(e))>0?(c(),i("tr",ge,[ve,be,t("td",ye,o(s(f)(K(s(e)))),1)])):x("",!0),w(s(e))>0?(c(),i("tr",we,[ke,Te,t("td",De,o(s(f)(w(s(e)))),1)])):x("",!0),w(s(e))>0?(c(),i("tr",Ye,[Me,je,t("td",Ae,o(s(f)(s(e).amount-w(s(e)))),1)])):x("",!0)])]),t("div",Ce,[((V=s(e).trx_absens)==null?void 0:V.length)>0?(c(),i("img",{key:0,class:"w-full",src:s(e).trx_absens[0].gambar},null,8,He)):(c(),i("div",Le,[p(et),I(" Tidak Ada Foto Berangkat ")]))]),(c(!0),i(C,null,H(s(e).extra_money_trxs,a=>{var k,A,F,U,q,z;return c(),i("div",Ie,[t("div",Ne,[$e,t("div",Se,o(a.id),1)]),t("div",Pe,[Be,t("div",Ke,o((k=a.employee)==null?void 0:k.name),1)]),t("div",Re,[Ve,t("div",Fe,o((A=a.employee)==null?void 0:A.rek_no),1)]),t("div",Ue,[qe,t("div",ze,o(a.tanggal),1)]),t("div",Je,[Ee,t("div",Oe,o((F=a.extra_money)==null?void 0:F.xto),1)]),t("div",Ge,[We,t("div",Qe,o((U=a.extra_money)==null?void 0:U.description),1)]),t("div",Xe,[Ze,t("div",to,o(s(f)(((q=a.extra_money)==null?void 0:q.nominal)*((z=a.extra_money)==null?void 0:z.qty))),1)])])}),256))]),T(t("div",so,[t("button",{class:"rounded m-1",onClick:l[1]||(l[1]=a=>g.value=!1)}," Cancel "),t("button",{class:"rounded m-1 text-white bg-blue-500",onClick:l[2]||(l[2]=a=>v.value=!0)}," Transfer ")],512),[[L,!s(v)]]),T(t("div",eo,[oo,t("button",{class:"rounded m-1 bg-white",onClick:l[3]||(l[3]=a=>(v.value=!1,g.value=!1))}," Tidak "),t("button",{class:"rounded m-1 text-white bg-blue-500",onClick:l[4]||(l[4]=a=>O())}," Ya ")],512),[[L,s(v)]])])],512),[[L,s(g)]]),p(ot,{show:s(R),onSetTimeout:l[5]||(l[5]=a=>R.value=a)},null,8,["show"])])}}};export{bo as default};
