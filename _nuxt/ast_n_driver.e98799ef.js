import{_ as H}from"./Header.408610e1.js";import{_ as R}from"./client-only.560f86f6.js";import{_ as G}from"./Check.ef457354.js";import{_ as K}from"./Times.7cbddc6d.js";import{z as Q,r as c,J as W,o as x,c as h,h as w,j as X,k as a,a as e,i as L,v as D,F as O,n as Y,b as i,t as g,G as B,f as ee,D as te,L as oe,w as F,l as se,m as z,E as le,x as y,y as j,s as ne}from"./entry.088021ef.js";import{_ as ae,u as ie}from"./useDownload.0df59fda.js";import{_ as re}from"./Table2Column.316a5eab.js";import{_ as ce}from"./PDFView.vue.7dbdb23f.js";import{u as N}from"./useMyFetch.38ca3367.js";import"./_plugin-vue_export-helper.c27b6911.js";const de={class:"bg-white w-full flex flex-row flex-wrap mt-1"},_e={class:"p-1 flex"},ue={class:"flex items-center"},fe=["onClick"],me={class:"pl-1 flex flex-wrap items-center"},pe={class:"w-full"},ve={class:"font-bold"},xe={key:0,class:"w-full"},he={class:"z-[2] bg-white w-full flex flex-col mt-1 ring-1 ring-gray-600 relative max-h-40 overflow-auto"},we={class:"p-1 flex"},ye={class:"flex items-center"},ge=["onClick"],ke=["onClick"],$e={class:"pl-1 flex flex-wrap items-center"},be={class:"w-full"},Ce={class:"font-bold"},De={key:0,class:"w-full"},Me=Q({__name:"SelectMulti",props:{arr:{type:Array,required:!0,default:[]},list:{type:Array,required:!1,default:[]}},emits:["input","nextBlur"],setup(A,{emit:k}){const f=A,$=c(null);window.addEventListener("click",_=>{var d;const n=_.target;n instanceof Element&&((d=$.value)!=null&&d.contains(n)||(l.value=!1))}),c([]);const l=c(!1),m=c(""),b=W(()=>m.value!=""?f.arr.filter(_=>_.name.toLowerCase().includes(m.value.toLowerCase())):f.arr),r=_=>{let n=f.arr.map(d=>d.id).indexOf(_.id);n!=-1&&(f.arr[n].checked=!f.arr[n].checked)};return(_,n)=>{const d=G,C=K;return x(),h("div",{ref_key:"slt_mul",ref:$,class:"relative",onBlur:n[2]||(n[2]=o=>l.value=!1)},[w(e("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=o=>L(m)?m.value=o:null),onFocus:n[1]||(n[1]=o=>l.value=!0)},null,544),[[X,a(m)]]),w(e("div",de,[(x(!0),h(O,null,Y(A.arr.filter(o=>o.checked),(o,M)=>(x(),h("div",_e,[e("div",ue,[w(e("button",{type:"button",class:"text-white bg-green-500 text-sm",onClick:V=>r(o)},[i(d)],8,fe),[[D,o.checked]])]),e("div",me,[e("div",pe,[e("span",ve," #"+g(o.name),1)]),o.title?(x(),h("div",xe,g(o.title||""),1)):B("",!0)])]))),256))],512),[[D,!a(l)]]),w(e("div",he,[(x(!0),h(O,null,Y(a(b),(o,M)=>(x(),h("div",we,[e("div",ye,[w(e("button",{type:"button",class:"text-white bg-green-500 text-sm",onClick:V=>r(o)},[i(d)],8,ge),[[D,o.checked]]),w(e("button",{type:"button",class:"text-white bg-red-500 text-sm",onClick:V=>r(o)},[i(C)],8,ke),[[D,!o.checked]])]),e("div",$e,[e("div",be,[e("span",Ce," #"+g(o.name),1)]),o.title?(x(),h("div",De,g(o.title||""),1)):B("",!0)])]))),256))],512),[[D,a(l)]])],544)}}});const Ve={class:"w-full h-full flex flex-col"},Ae={class:"w-full flex grow flex-col overflow-auto h-0 bg-gray-200 justify-center items-center p-2"},Ee={class:"bg-white p-2 max-w-[350px] max-h-full overflow-auto"},Se={action:"#",class:"w-full flex flex-col sm:flex-row flex-wrap text-xs"},Te={class:"w-full sm:w-1/2 p-1 flex flex-col"},je=e("div",{class:"font-bold"}," Tgl Dari ",-1),Ne={class:"text-red-500"},Oe={class:"w-full sm:w-1/2 p-1 flex flex-col"},Ye=e("div",{class:"font-bold"}," Tgl Sampai ",-1),Be={class:"text-red-500"},Fe={class:"w-full p-1 flex flex-col"},ze=e("div",{class:"font-bold"}," Lokasi ",-1),Le={class:"w-full p-1 flex flex-col"},Pe=e("div",{class:"font-bold"}," Nama ",-1),Ie={class:"w-full p-1 flex flex-col"},Je=e("div",{class:"font-bold"}," No Pol ",-1),Ue={class:"w-full p-1 flex flex-col"},Ze=e("div",{class:"font-bold"}," Tipe ",-1),qe=e("option",{value:"header"},"Header",-1),He=e("option",{value:"detail"},"Detail",-1),Re=[qe,He],Ge={class:"w-full p-1 flex items-end justify-end"},Ke=e("div",{class:"text-left m-1"},"Download PDF",-1),Qe=e("div",{class:"text-left m-1"},"Download Excel",-1),ct={__name:"ast_n_driver",async setup(A){let k,f;const{$moment:$}=ne(),l={};l._TimeZoneOffset=new Date().getTimezoneOffset(),l.sort="tanggal:desc";const m=c({}),b=ee("token"),r=c({from:"",to:""}),{data:_}=([k,f]=te(async()=>le(async()=>{y().loading_full=!0;let t=[],s=[],p=[];const[u,S]=await Promise.all([N("/report/ast_n_driver/load_data",{method:"get",headers:{Authorization:`Bearer ${b.value}`,Accept:"application/json"},retry:0})]);return u.status.value!=="error"&&(t=u.data.value.list_xto,p=u.data.value.list_employee,s=u.data.value.list_vehicle),u.status.value==="error"&&j().trigger(u.error),y().loading_full=!1,{list_xto:t,list_employee:p,list_vehicle:s}},"$Aw9scsfjYZ")),k=await k,f(),k),n=c([]),d=c([]),C=c([]);_.value.list_xto.forEach(t=>{n.value.push({id:t,name:t,title:"",checked:!1})}),_.value.list_employee.forEach(t=>{d.value.push({id:t.id,name:t.name,title:t.role,checked:!1})}),_.value.list_vehicle.forEach(t=>{C.value.push({id:t.id,name:t.no_pol,title:"",checked:!1})});const o=c("header"),M=()=>{l._TimeZoneOffset=new Date().getTimezoneOffset(),l.date_from=r.value.from?$(r.value.from).format("YYYY-MM-DD"):"",l.date_to=r.value.to?$(r.value.to).format("YYYY-MM-DD"):"",l.list_xto=JSON.stringify(n.value.filter(t=>t.checked).map(t=>t.id)),l.list_employee=JSON.stringify(d.value.filter(t=>t.checked).map(t=>t.id)),l.list_vehicle=JSON.stringify(C.value.filter(t=>t.checked).map(t=>t.id)),l.type=o.value},{downloadFile:V,viewFile:We}=ie(),E=c(!1),P=c({}),I=async()=>{M(),y().loading_full=!0;const{data:t,error:s,status:p}=await N("/report/ast_n_driver/index",{method:"get",headers:{Authorization:`Bearer ${b.value}`,Accept:"application/json"},params:l,retry:0});if(y().loading_full=!1,p.value==="error"){j().trigger(s);return}},J=async()=>{M(),y().loading_full=!0;const{data:t,error:s,status:p}=await N("/report/ast_n_driver/excel_download",{method:"get",headers:{Authorization:`Bearer ${b.value}`,Accept:"application/json"},params:l,retry:0});if(y().loading_full=!1,p.value==="error"){j().trigger(s);return}V(t.value)};return(t,s)=>{const p=H,u=oe("vue-date-picker"),S=R,T=Me,U=ae,Z=re,q=ce;return x(),h(O,null,[e("div",Ve,[i(p,{title:"Report Transaction"}),e("div",Ae,[e("div",Ee,[e("form",Se,[e("div",Te,[je,i(S,null,{default:F(()=>[i(u,{modelValue:a(r).from,"onUpdate:modelValue":s[0]||(s[0]=v=>a(r).from=v),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1}),e("p",Ne,g(a(m).date_from),1)]),e("div",Oe,[Ye,i(S,null,{default:F(()=>[i(u,{modelValue:a(r).to,"onUpdate:modelValue":s[1]||(s[1]=v=>a(r).to=v),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1}),e("p",Be,g(a(m).date_to),1)]),e("div",Fe,[ze,i(T,{arr:a(n)},null,8,["arr"])]),e("div",Le,[Pe,i(T,{arr:a(d)},null,8,["arr"])]),e("div",Ie,[Je,i(T,{arr:a(C)},null,8,["arr"])]),e("div",Ue,[Ze,w(e("select",{"onUpdate:modelValue":s[2]||(s[2]=v=>L(o)?o.value=v:null)},Re,512),[[se,a(o)]])]),e("div",Ge,[e("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:s[3]||(s[3]=z(v=>I(),["prevent"]))},[e("div",null,[i(U,{class:"text-2xl"})]),Ke]),e("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:s[4]||(s[4]=z(v=>J(),["prevent"]))},[e("div",null,[i(Z,{class:"text-2xl"})]),Qe])])])])])]),i(q,{show:a(E),pdfContent:a(P),onClose:s[5]||(s[5]=v=>E.value=!a(E))},null,8,["show","pdfContent"])],64)}}};export{ct as default};
