import G from"./Eyes.572d9306.js";import W from"./Image.d79fe2d9.js";import Z from"./Times.7f222972.js";import Q from"./Line.fae3fafc.js";import X from"./Check.e9c0eafb.js";import ee from"./TableView.244b73e9.js";import te from"./trx_trp_nolog.adbc0a1e.js";import{r as p,j as le,g as ae,G as q,i as oe,A as v,c as y,a as n,m as se,q as re,k as o,n as ne,b as S,l as P,w as c,z as _e,B as R,o as i,D as m,d as s,t as r,H as ie,E as de}from"./entry.a1e5190e.js";import{u as U}from"./useMyFetch.7a853bd2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.2179d70e.js";import"./Adjust.c478eb92.js";import"./TableHeaderEye.d84ed875.js";import"./ClearAll.efa32306.js";import"./client-only.471853de.js";import"./ClearEach.cea56e7c.js";import"./CaretLeftDoubleBold.e1a2dd37.js";import"./CaretLeftBold.b9c20085.js";import"./CaretRightBold.3ec4bab7.js";import"./CaretRightDoubleBold.3e432139.js";import"./useUtils.f2a2cb47.js";import"./HeaderPopup.vue.3ec630e5.js";import"./WidthMiniPart.vue.2e1497af.js";const pe={class:"w-full h-full flex flex-col"},ce={class:"w-full flex grow flex-col overflow-auto h-0"},ue={class:"w-full flex justify-between flex-wrap"},me={class:"grow flex"},fe={class:"m-1"},ve=ie('<option value="pv_not_done">Undone</option><option value="pv_done">Done</option><option value="deleted">Trash</option><option value="all">All</option><option value="req_deleted">Req Delete</option>',5),ye=[ve],be={class:"text-xs w-full text-center"},ke=n("br",null,null,-1),ge={key:1,class:"text-xs"},he=n("br",null,null,-1),De=n("br",null,null,-1),xe={key:1,class:"text-xs"},we=n("br",null,null,-1),Me=n("br",null,null,-1),He={key:1,class:"text-xs"},Se=n("br",null,null,-1),Te=n("br",null,null,-1),Ne={key:1,class:"text-xs"},$e=n("br",null,null,-1),Ce=n("br",null,null,-1),Ae={key:1,class:"text-xs"},Ye=n("br",null,null,-1),qe=n("br",null,null,-1),Pe={key:1,class:"text-xs"},Re=n("br",null,null,-1),Ue=n("br",null,null,-1),it={__name:"index",async setup(Ve){let D,T;const{$moment:d}=de(),V=t=>t.deleted==1?"!bg-red-400":t.pvr_id>0&&t.req_deleted==1?"!bg-yellow-300":t.pv_id>0?"!bg-blue-300":"",w=t=>(t.map(a=>{a.class_h=V(a)}),t),g=p("pv_not_done");le(()=>g.value,t=>{Y.value.map(a=>{let k=["deleted_by_username","deleted_at","deleted_reason","req_deleted_by_username","req_deleted_at","req_deleted_reason"].indexOf(a.key)>-1;return["all","deleted","req_deleted"].indexOf(t)>-1?k&&(a.tbl_show=1):k&&(a.tbl_show=0),a}),C()},{immediate:!1});const _={};_._TimeZoneOffset=new Date().getTimezoneOffset(),_.sort="tanggal:desc";const N=p({}),x=p({from:"",to:""}),{data:B}=([D,T]=ae(async()=>_e(async()=>{v().loading_full=!0;let t=[];const[a,k]=await Promise.all([U("/trx_trp_nologs",{method:"get",params:{filter_status:g},retry:0})]);return a.status.value!=="error"&&(t=w(a.data.value.data)),a.status.value==="error"?(R().trigger(a.error),{trx_trps:t}):(v().loading_full=!1,{trx_trps:t})},"$MmURKklrhv")),D=await D,T(),D),f=p(B.value.trx_trps||[]);p([]),p(!1);const M=p({field:"tanggal",by:"desc"}),b=p(-1);q(()=>f.value[b.value]);const u=p({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),O=()=>{_.like="";let t=JSON.parse(JSON.stringify(v()._tv.global_keyword));t!=""&&(_.like=`id:%${t}%,xto:%${t}%,jenis:%${t}%,pv_no:%${t}%,ticket_a_no:%${t}%,ticket_b_no:%${t}%,no_pol:%${t}%,supir:%${t}%,kernet:%${t}%,cost_center_code:%${t}%,cost_center_desc:%${t}%,pvr_no:%${t}%,tanggal:%${t}%,transition_target:%${t}%`),_.sort="",M.value.field&&(_.sort=M.value.field+":"+M.value.by),_.date_from=x.value.from?d(x.value.from).format("YYYY-MM-DD"):"",_.date_to=x.value.to?d(x.value.to).format("YYYY-MM-DD"):"",_.filter_model=JSON.stringify(v()._tv.filter_model)},$=async()=>{v().loading_full=!0,N.value={},u.value.may_get_data=!1,_.page=u.value.page,_.page==1&&(f.value=[]),_.first_row&&delete _.first_row,_.page>1&&(_.first_row=JSON.stringify(f.value[0])),_.filter_status=g.value;const{data:t,error:a,status:k}=await U("/trx_trp_nologs",{method:"get",params:_,retry:0});if(v().loading_full=!1,u.value.may_get_data=!0,k.value==="error"){R().trigger(a,N);return}u.value.page==1?f.value=w(t.value.data):u.value.page>1&&(f.value=[...f.value,...w(t.value.data)]),t.value.data.length==0&&(u.value.is_last_record=!0),v()._tv.filter_box=!1},C=()=>{b.value=-1,u.value.page=1,u.value.is_last_record=!1,O(),$()},{display:j}=oe(),H=p(!1),A=p(0),K=()=>{b.value==-1?j({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(A.value=f.value[b.value].id,H.value=!0)},Y=p([{key:"no",label:"No",isai:!0},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm",filter_on:1,class:"text-xs"},{key:"val",label:"APP",childs:[{key:"val",label:"Kasir",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val1",label:"Mandor",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val2",label:"KTU/W",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val3",label:"Marketing",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val4",label:"Logistik",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val5",label:"SPV Logistik",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]}]},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"tanggal",label:"U.Jalan Per",type:"date",dateformat:"DD-MM-Y",filter_on:1,sort:{priority:1,type:"desc"}},{key:"no_pol",label:"No Pol",freeze:1,filter_on:1,type:"string"},{key:"xto",label:"Tujuan",filter_on:1,type:"string"},{key:"tipe",label:"Tipe",filter_on:1,type:"string"},{key:"jenis",label:"Jenis",filter_on:1,type:"select",select_item:["TBS","TBSK","CPO","PK"]},{key:"amount",label:"Amount",class:" justify-end",filter_on:1,type:"number"},{key:"transition",label:"Peralihan",childs:[{key:"transition_type",label:"Type",type:"select",filter_on:1,select_item:["To","From"]},{key:"transition_target",label:"Target",type:"select",filter_on:1,select_item:v().list_pabrik}]},{key:"cost_center",label:"Cost Center",childs:[{key:"cost_center_code",label:"Code",type:"string",class:" justify-start",filter_on:1},{key:"cost_center_desc",label:"Desc",filter_on:1,type:"string"}]},{key:"pvr",label:"PVR",childs:[{key:"pvr_no",label:"No",filter_on:1,type:"string"},{key:"pvr_total",label:"Total",filter_on:1,type:"number"},{key:"pvr_had_detail",label:"Completed",filter_on:1,type:"select",select_item:[{k:"1",v:"Completed"},{k:"0",v:"Uncompleted"}]}]},{key:"pv",label:"PV",childs:[{key:"pv_datetime",label:"Date",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"pv_no",label:"No",filter_on:1,type:"string"},{key:"pv_total",label:"Total",filter_on:1,type:"number"}]},{key:"supir",label:"Supir",filter_on:1,type:"string"},{key:"supir_rek_no",label:"No Rek Supir",filter_on:1,type:"string"},{key:"supir_rek_name",label:"Nama Rek Supir",filter_on:1,type:"string"},{key:"kernet",label:"Kernet",filter_on:1,type:"string"},{key:"kernet_rek_no",label:"No Rek Kernet",filter_on:1,type:"string"},{key:"kernet_rek_name",label:"Nama Rek Kernet",filter_on:1,type:"string"},{key:"payment_method_name",label:"Payment Method Name",type:"string"},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:0},{key:"deleted_at",label:"Deleted At",dateformat:"DD-MM-Y HH:mm:ss",tbl_show:0,type:"datetime",filter_on:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:0,type:"string",filter_on:1},{key:"req_deleted_by_username",label:"Req Deleted By",tbl_show:0},{key:"req_deleted_at",label:"Req Delete At",dateformat:"DD-MM-Y HH:mm:ss",tbl_show:0,type:"datetime",filter_on:1},{key:"req_deleted_reason",label:"Req Delete Reason",tbl_show:0,type:"string",filter_on:1}]),I=q(()=>b.value>-1);return(t,a)=>{const k=G,J=W,h=Z,F=Q,E=X,L=ee,z=te;return i(),y("div",pe,[n("div",ce,[n("div",ue,[n("div",me,[n("div",fe,[se(n("select",{class:"","onUpdate:modelValue":a[0]||(a[0]=e=>ne(g)?g.value=e:null)},ye,512),[[re,o(g)]])]),o(I)?(i(),y("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[1]||(a[1]=e=>K())},[S(k)])):P("",!0)])]),S(L,{thead:o(Y),selected:o(b),onSetSelected:a[2]||(a[2]=e=>b.value=e),tbody:o(f),fnCallData:$,scrolling:o(u),onSetScrollingPage:a[3]||(a[3]=e=>o(u).page=e),onDoFilter:a[4]||(a[4]=e=>C())},{absen:c(({item:e,index:l})=>[e.trx_absens&&e.trx_absens.length>0?(i(),m(J,{key:0,class:"cursor-pointer",onClick:Be=>t.form_absen(l)},null,8,["onClick"])):P("",!0)]),created_at:c(({item:e})=>[n("div",be,[s(r(o(d)(e.created_at).format("DD-MM-YYYY"))+" ",1),ke,s(" "+r(o(d)(e.created_at).format("HH:mm")),1)])]),val:c(({item:e})=>{var l;return[e.val?(i(),y("div",ge,[s(r((l=e.val_by)==null?void 0:l.username)+" ",1),he,s(" "+r(o(d)(e.val_at).format("DD/MM"))+" ",1),De,s(" "+r(o(d)(e.val_at).format("HH:mm")),1)])):(i(),m(h,{key:0}))]}),val1:c(({item:e})=>{var l;return[e.val1?(i(),y("div",xe,[s(r((l=e.val1_by)==null?void 0:l.username)+" ",1),we,s(" "+r(o(d)(e.val1_at).format("DD/MM"))+" ",1),Me,s(" "+r(o(d)(e.val1_at).format("HH:mm")),1)])):(i(),m(h,{key:0}))]}),val2:c(({item:e})=>{var l;return[e.val2?(i(),y("div",He,[s(r((l=e.val2_by)==null?void 0:l.username)+" ",1),Se,s(" "+r(o(d)(e.val2_at).format("DD/MM"))+" ",1),Te,s(" "+r(o(d)(e.val2_at).format("HH:mm")),1)])):(i(),m(h,{key:0}))]}),val3:c(({item:e})=>{var l;return[e.val3?(i(),y("div",Ne,[s(r((l=e.val3_by)==null?void 0:l.username)+" ",1),$e,s(" "+r(o(d)(e.val3_at).format("DD/MM"))+" ",1),Ce,s(" "+r(o(d)(e.val3_at).format("HH:mm")),1)])):(i(),m(h,{key:0}))]}),val4:c(({item:e})=>{var l;return[e.val4?(i(),y("div",Ae,[s(r((l=e.val4_by)==null?void 0:l.username)+" ",1),Ye,s(" "+r(o(d)(e.val4_at).format("DD/MM"))+" ",1),qe,s(" "+r(o(d)(e.val4_at).format("HH:mm")),1)])):(i(),m(h,{key:0}))]}),val5:c(({item:e})=>{var l;return[e.val5?(i(),y("div",Pe,[s(r((l=e.val5_by)==null?void 0:l.username)+" ",1),Re,s(" "+r(o(d)(e.val5_at).format("DD/MM"))+" ",1),Ue,s(" "+r(o(d)(e.val5_at).format("HH:mm")),1)])):(i(),m(h,{key:0}))]}),payment_method_name:c(({item:e})=>{var l;return[s(r((l=e.payment_method)==null?void 0:l.name),1)]}),pvr_had_detail:c(({item:e})=>[e.pvr_had_detail?(i(),m(E,{key:1})):(i(),m(F,{key:0}))]),deleted_by_username:c(({item:e})=>{var l;return[s(r((l=e.deleted_by)==null?void 0:l.username),1)]}),req_deleted_by_username:c(({item:e})=>{var l;return[s(r((l=e.req_deleted_by)==null?void 0:l.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])]),S(z,{show:o(H),fnClose:()=>{H.value=!1},id:o(A)},null,8,["show","fnClose","id"])])}}};export{it as default};
