import{g as de,h as pe,r as l,C as fe,j,s as me,f as ve,c as p,b as f,a as o,l as t,n as g,F as ye,E as he,w as ge,q as ke,x as m,y as k,o as i,G as we,z as H,t as E,d as xe,k as be,A as Ce,m as De,B as L,H as Ae,_ as T}from"./entry.80f9400f.js";import Ee from"./Header.d832b074.js";import Le from"./Plus.ff7cfb63.js";import Te from"./Edit.8ba83185.js";import ze from"./Signature.b3ac5cb1.js";import Pe from"./Table2Column.1f2f6325.js";import $e from"./TableUp.db8bc3f8.js";import Re from"./Line.0d89352b.js";import Se from"./Check.2d47ab0b.js";import{u as F}from"./useUtils.4905e334.js";import{u as w}from"./useMyFetch.a3705501.js";import{u as Ie}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";const Me=L(()=>T(()=>import("./PopupMini.8abf2423.js"),["./PopupMini.8abf2423.js","./PopupMini.vue.9a484447.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./Exclamation.44603bae.js"],import.meta.url).then(u=>u.default||u)),Fe=L(()=>T(()=>import("./rpt_salary.144e0844.js"),["./rpt_salary.144e0844.js","./HeaderPopup.vue.def29a01.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./client-only.b5fd6b3a.js","./useUtils.4905e334.js","./useMyFetch.a3705501.js"],import.meta.url).then(u=>u.default||u)),Be=L(()=>T(()=>import("./rpt_salary_validasi.70da5853.js"),["./rpt_salary_validasi.70da5853.js","./HeaderPopup.vue.def29a01.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./useUtils.4905e334.js","./useMyFetch.a3705501.js"],import.meta.url).then(u=>u.default||u)),Oe=L(()=>T(()=>import("./rpt_salary_check.507825e2.js"),["./rpt_salary_check.507825e2.js","./HeaderPopup.vue.def29a01.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./Refresh.e9321577.js","./useUtils.4905e334.js","./useMyFetch.a3705501.js"],import.meta.url).then(u=>u.default||u)),Ue={class:"w-full h-full flex flex-col"},Ve={class:"w-full flex grow flex-col overflow-auto h-0"},je={class:"w-full flex"},He={class:"w-full flex justify-center items-center grow h-0 p-1"},Ne={key:0,class:""},Ye={class:"tacky"},Je=o("thead",null,[o("tr",{class:"sticky top-0 !z-[2]"},[o("th",null,"Logistik"),o("th",null,"ID"),o("th",null,"Period End"),o("th",null,"Created At"),o("th",null,"Updated At")])],-1),qe=["onClick"],Ge={class:"flex items-center justify-center"},We={class:"bold"},Xe={class:"grow mb-5"},dt={__name:"rpt",async setup(u){let x,B;const{$moment:z}=Ae(),d={};d._TimeZoneOffset=new Date().getTimezoneOffset(),d.sort="created_at:desc";const v=de("token"),{data:N}=([x,B]=pe(async()=>ke(async()=>{let e=[];m().loading_full=!0;const{data:a,error:c,status:h}=await w("/rpt_salarys",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:d,retry:0});return m().loading_full=!1,h.value==="error"?(k().trigger(c),{rpt_salarys:e}):(e=a.value.data,{rpt_salarys:e})},"$fWJlXxIgiP")),x=await x,B(),x),s=l(N.value.rpt_salarys);l(""),l({field:"created_at",by:"desc"});const n=l(-1),_=l({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),b=l(null),Y=async()=>{m().loading_full=!0,_.value.may_get_data=!1,d.page=_.value.page,d.page==1&&(s.value=[]),d.first_row&&delete d.first_row,d.page>1&&(d.first_row=JSON.stringify(s.value[0]));const{data:e,error:a,status:c}=await w("/rpt_salarys",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:d,retry:0});if(m().loading_full=!1,_.value.may_get_data=!0,c.value==="error"){k().trigger(a);return}_.value.page==1?(s.value=e.value.data,b.value&&(b.value.scrollTop=0)):_.value.page>1&&(s.value=[...s.value,...e.value.data]),e.value.data.length==0&&(_.value.is_last_record=!0)},J=async()=>{if(!_.value.may_get_data)return;let e=b.value;if(e.scrollLeft!=_.value.scrollLeft){_.value.scrollLeft=e.scrollLeft;return}_.value.is_last_record||!(Math.round(e.scrollTop)+e.clientHeight>=e.scrollHeight-1)||(_.value.page++,await Y())};fe();const C=l(!1),P=l(0),D=l(0),q=()=>{P.value=0,C.value=!0,D.value=!1},{display:$}=j();me(j());const G=()=>{n.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=s.value[n.value].id,C.value=!0,D.value=!1)},R=l(!1),O=l(0),W=()=>{n.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(O.value=s.value[n.value].id,D.value=!0,R.value=!0)},S=l(!1),X=l({}),A=l(!1),y=l(""),Z=async()=>{A.value&&(A.value=!1)};ve(()=>y.value,e=>{e.trim().length>0?S.value=!0:S.value=!1},{immediate:!1});const K=async()=>{m().loading_full=!0;const e=new FormData;e.append("id",s.value[n.value].id),e.append("deleted_reason",y.value),e.append("_method","DELETE");const{data:a,error:c,status:h}=await w("/rpt_salary",{method:"post",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},body:e,retry:0});if(m().loading_full=!1,h.value==="error"){k().trigger(c);return}s.value.splice(n.value,1),n.value=-1,A.value=!1},{downloadFile:U,viewFile:Ze}=Ie();l(!1),l({});const Q=async()=>{m().loading_full=!0;const{data:e,error:a,status:c}=await w("/rpt_salary/excel_download",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:{id:s.value[n.value].id},retry:0});if(m().loading_full=!1,c.value==="error"){k().trigger(a);return}U(e.value)},ee=async()=>{m().loading_full=!0;const{data:e,error:a,status:c}=await w("/rpt_salary/excel_download2",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:{id:s.value[n.value].id},retry:0});if(m().loading_full=!1,c.value==="error"){k().trigger(a);return}U(e.value)},V=l(0),I=l(!1),te=()=>{n.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(V.value=s.value[n.value].id,I.value=!0)};return(e,a)=>{const c=Ee,h=Le,ae=Te,oe=ze,le=Pe,se=$e,ne=Re,re=Se,ue=Me,ie=Fe,_e=Be,ce=Oe;return i(),p("div",Ue,[f(c,{title:"List Salary Report"}),o("div",Ve,[o("div",je,[("useUtils"in e?e.useUtils:t(F))().checkPermission("rpt_salary.create")?(i(),p("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[0]||(a[0]=r=>q())},[f(h)])):g("",!0),("useUtils"in e?e.useUtils:t(F))().checkPermissions(["rpt_salary.modify"])?(i(),p("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[1]||(a[1]=r=>G())},[f(ae)])):g("",!0),("useUtils"in e?e.useUtils:t(F))().checkPermissions(["rpt_salary.val1","rpt_salary.val2","rpt_salary.val3"])?(i(),p("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[2]||(a[2]=r=>W())},[f(oe)])):g("",!0),t(n)>-1?(i(),p("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[3]||(a[3]=r=>Q())},[f(le)])):g("",!0),o("button",{type:"button",name:"button",class:"m-1 text-xs whitespace-nowrap",onClick:a[4]||(a[4]=r=>te())}," Check Nilai "),t(n)>-1&&t(s)[t(n)].val1==1?(i(),p("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[5]||(a[5]=r=>ee())},[f(se)])):g("",!0)]),o("div",He,[t(s).length==0?(i(),p("div",Ne," Maaf Tidak Ada Record ")):(i(),p("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:J},[o("table",Ye,[Je,o("tbody",null,[(i(!0),p(ye,null,he(t(s),(r,M)=>(i(),p("tr",{key:M,onClick:Ke=>n.value=M,class:we(t(n)==M?"active":"")},[o("td",null,[o("div",Ge,[r.val1?(i(),H(re,{key:1})):(i(),H(ne,{key:0}))])]),o("td",We,E(r.id),1),o("td",null,E(r.period_end?t(z)(r.period_end).format("MM-Y"):""),1),o("td",null,E(r.created_at?t(z)(r.created_at).format("DD-MM-Y HH:mm:ss"):""),1),o("td",null,E(r.updated_at?t(z)(r.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,qe))),128))])])],544))])]),f(ue,{type:"delete",show:t(A),data:t(X),fnClose:Z,fnConfirm:K,enabledOk:t(S)},{footer:ge(()=>[xe(" Masukkan Alasan Penghapusan: "),o("div",Xe,[be(o("textarea",{"onUpdate:modelValue":a[6]||(a[6]=r=>De(y)?y.value=r:null)},null,512),[[Ce,t(y)]])])]),_:1},8,["show","data","enabledOk"]),f(ie,{show:t(C),fnClose:()=>{C.value=!1},id:t(P),p_data:t(s),is_copy:t(D)},null,8,["show","fnClose","id","p_data","is_copy"]),f(_e,{show:t(R),fnClose:()=>{R.value=!1},id:t(O),p_data:t(s)},null,8,["show","fnClose","id","p_data"]),f(ce,{show:t(I),fnClose:()=>{I.value=!1},id:t(V)},null,8,["show","fnClose","id"])])}}};export{dt as default};
