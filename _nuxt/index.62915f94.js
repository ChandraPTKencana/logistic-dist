import{_ as oe}from"./Header.71ed6a7a.js";import{_ as se}from"./Plus.20e40809.js";import{_ as ne}from"./Edit.468b824a.js";import{_ as re}from"./Delete.33334e8b.js";import{_ as ie}from"./Search.547d4f6a.js";import{_ as ue}from"./PopupMini.vue.47efb420.js";import{_ as de}from"./HeaderPopup.vue.185b5495.js";import{r as c,f as K,g as J,h as b,v as ce,o as D,c as C,a as e,b as g,k as a,j as z,t as x,l as L,m as _e,x as p,y as T,D as fe,B as pe,H as U,I as me,i as R,F as q,n as ve,w as he,E as ye,q as ge,d as we,p as xe,e as be,s as ke}from"./entry.d239d820.js";import{u as M}from"./useMyFetch.75d43dc0.js";import{_ as $e}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.74e0f3d2.js";const De={class:"box-fixed"},Ce={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},Se={class:"w-full flex flex-col items-center grow overflow-auto"},Ae={class:"w-full flex flex-row flex-wrap"},Te={class:"w-full flex flex-col flex-wrap p-1"},Me=e("label",{for:""},"Nama",-1),Be={class:"text-red-500"},je={class:"w-full flex flex-col flex-wrap p-1"},Ee=e("label",{for:""},"Jabatan",-1),Fe=e("option",{value:"Supir"},"Supir",-1),Ve=e("option",{value:"Kernet"},"Kernet",-1),He=[Fe,Ve],Ie={class:"text-red-500"},Ne={class:"w-full flex items-center justify-end"},ze={__name:"employee",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},setup(m){const u=m,S={id:-1,name:"",role:"Supir"},r=c({...S}),_=K("token"),v=c({}),d=async()=>{p().loading_full=!0,v.value={};const n=new FormData;n.append("name",r.value.name),n.append("role",r.value.role);let t="post",o=u.id;o==0||(n.append("id",o),n.append("_method","PUT"));const{data:f,error:k,status:B}=await M("/employee",{method:t,headers:{Authorization:`Bearer ${_.value}`,Accept:"application/json"},body:n,retry:0});if(p().loading_full=!1,B.value==="error"){T().trigger(k,v);return}if(r.value.updated_at=f.value.updated_at,u.id<=0)r.value.id=f.value.id,r.value.created_at=f.value.created_at,u.p_data.unshift(r.value);else{let j=u.p_data.map(V=>V.id).indexOf(u.id);j>=-1&&u.p_data.splice(j,1,{...r.value})}u.fnClose()},y=async()=>{p().loading_full=!0;const{data:n,error:t,status:o}=await M("/employee",{method:"get",headers:{Authorization:`Bearer ${_.value}`,Accept:"application/json"},params:{id:u.id},retry:0});if(p().loading_full=!1,o.value==="error"){T().trigger(t);return}r.value=n.value.data};return J(()=>u.show,(n,t)=>{n==!0&&(r.value={...S},v.value={},u.id!=0&&y())},{immediate:!0}),(n,t)=>{const o=de;return b((D(),C("section",De,[e("div",null,[g(o,{title:"Form Employee",fn:m.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",Ce,[e("div",Se,[e("div",Ae,[e("div",Te,[Me,b(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=f=>a(r).name=f)},null,512),[[z,a(r).name]]),e("p",Be,x(a(v).name),1)]),e("div",je,[Ee,b(e("select",{"onUpdate:modelValue":t[1]||(t[1]=f=>a(r).role=f)},He,512),[[L,a(r).role]]),e("p",Ie,x(a(v).role),1)])])]),e("div",Ne,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:t[2]||(t[2]=f=>m.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:t[3]||(t[3]=_e(f=>d(),["prevent"]))}," Save ")])])])],512)),[[ce,m.show]])}}};const h=m=>(xe("data-v-4e427f4c"),m=m(),be(),m),Le={class:"w-full h-full flex flex-col"},Oe={class:"w-full flex grow flex-col overflow-auto h-0"},Pe={class:"w-full flex"},Ue={class:"w-full flex p-1"},Re={class:"grow"},qe=h(()=>e("div",{class:"font-bold"}," Keyword ",-1)),Ke={class:"pl-1"},Je=h(()=>e("div",{class:"font-bold"}," Sort By ",-1)),Ye=h(()=>e("option",{value:""},null,-1)),Ze=h(()=>e("option",{value:"name"},"Nama",-1)),Ge=h(()=>e("option",{value:"role"},"Jabatan",-1)),Qe=[Ye,Ze,Ge],We={class:"pl-1"},Xe=h(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),et=h(()=>e("option",{value:"asc"},"Asc",-1)),tt=h(()=>e("option",{value:"desc"},"Desc",-1)),at=[et,tt],lt={class:"flex items-end pl-1"},ot={class:"w-full flex justify-center items-center grow h-0 p-1"},st={key:0,class:""},nt={class:"tacky"},rt=h(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"Nama"),e("th",null,"Jabatan"),e("th",null,"Tanggal Dibuat"),e("th",null,"Tanggal Diubah")])],-1)),it=["onClick"],ut={class:"bold"},dt={class:"grow mb-5"},ct={__name:"index",async setup(m){let u,S;const{$moment:r}=ke(),_={};_._TimeZoneOffset=new Date().getTimezoneOffset();const v=K("token"),{data:d}=([u,S]=fe(async()=>ye(async()=>{p().loading_full=!0;const{data:s,error:l,status:w}=await M("/employees",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:_,retry:0});return p().loading_full=!1,w.value==="error"?(T().trigger(l),[]):s.value.data},"$p5jj5crAgd")),u=await u,S(),u),y=c(""),n=c({field:"",by:"desc"}),t=c(-1),o=c({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),f=()=>{_.like="",y.value!=""&&(_.like=`id:%${y.value}%,name:%${y.value}%`),_.sort="",n.value.field&&(_.sort=n.value.field+":"+n.value.by)},k=c(null),B=async()=>{p().loading_full=!0,o.value.may_get_data=!1,_.page=o.value.page,_.page==1&&(d.value=[]);const{data:s,error:l,status:w}=await M("/employees",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:_,retry:0});if(p().loading_full=!1,o.value.may_get_data=!0,w.value==="error"){T().trigger(l);return}o.value.page==1?(d.value=s.value.data,k.value&&(k.value.scrollTop=0)):o.value.page>1&&(d.value=[...d.value,...s.value.data]),s.value.data.length==0&&(o.value.is_last_record=!0)},j=async()=>{if(!o.value.may_get_data)return;let s=k.value;if(s.scrollLeft!=o.value.scrollLeft){o.value.scrollLeft=s.scrollLeft;return}o.value.is_last_record||!(Math.round(s.scrollTop)+s.clientHeight>=s.scrollHeight-1)||(o.value.page++,await B())},V=()=>{o.value.page=1,o.value.is_last_record=!1,f(),B()};pe();const E=c(!1),H=c(0),Y=()=>{H.value=0,E.value=!0},{display:O}=U();me(U());const Z=()=>{t.value==-1?O({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(H.value=d.value[t.value].id,E.value=!0)},I=c(!1),P=c({}),A=c(!1),$=c(""),G=async()=>{A.value&&(A.value=!1)},Q=()=>{t.value==-1?O({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):($.value="",P.value={id:d.value[t.value].id},A.value=!0)};J(()=>$.value,s=>{s.trim().length>0?I.value=!0:I.value=!1},{immediate:!1});const W=async()=>{p().loading_full=!0;const s=new FormData;s.append("id",d.value[t.value].id),s.append("deleted_reason",$.value),s.append("_method","DELETE");const{data:l,error:w,status:N}=await M("/employee",{method:"post",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},body:s,retry:0});if(p().loading_full=!1,N.value==="error"){T().trigger(w);return}d.value.splice(t.value,1),t.value=-1,A.value=!1};return(s,l)=>{const w=oe,N=se,X=ne,ee=re,te=ie,ae=ue,le=ze;return D(),C(q,null,[e("div",Le,[g(w,{title:"List Employee"}),e("div",Oe,[e("div",Pe,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:l[0]||(l[0]=i=>Y())},[g(N)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:l[1]||(l[1]=i=>Z())},[g(X)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:l[2]||(l[2]=i=>Q())},[g(ee)])]),e("div",Ue,[e("div",Re,[qe,b(e("input",{class:"",type:"text","onUpdate:modelValue":l[3]||(l[3]=i=>R(y)?y.value=i:null),name:"search",placeholder:"Keyword"},null,512),[[z,a(y)]])]),e("div",Ke,[Je,b(e("select",{class:"","onUpdate:modelValue":l[4]||(l[4]=i=>a(n).field=i)},Qe,512),[[L,a(n).field]])]),e("div",We,[Xe,b(e("select",{class:"","onUpdate:modelValue":l[5]||(l[5]=i=>a(n).by=i)},at,512),[[L,a(n).by]])]),e("div",lt,[e("button",{class:"",type:"button",name:"button",onClick:l[6]||(l[6]=i=>V())},[g(te,{class:"text-2xl"})])])]),e("div",ot,[a(d).length==0?(D(),C("div",st," Maaf Tidak Ada Record ")):(D(),C("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:k,onScroll:j},[e("table",nt,[rt,e("tbody",null,[(D(!0),C(q,null,ve(a(d),(i,F)=>(D(),C("tr",{key:F,onClick:_t=>t.value=F,class:ge(a(t)==F?"active":"")},[e("td",null,x(F+1)+".",1),e("td",ut,x(i.name),1),e("td",null,x(i.role),1),e("td",null,x(a(r)(i.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,x(a(r)(i.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,it))),128))])])],544))])])]),g(ae,{type:"delete",show:a(A),data:a(P),fnClose:G,fnConfirm:W,enabledOk:a(I)},{footer:he(()=>[we(" Masukkan Alasan Penghapusan: "),e("div",dt,[b(e("textarea",{"onUpdate:modelValue":l[7]||(l[7]=i=>R($)?$.value=i:null)},null,512),[[z,a($)]])])]),_:1},8,["show","data","enabledOk"]),g(le,{show:a(E),fnClose:()=>{E.value=!1},id:a(H),p_data:a(d)},null,8,["show","fnClose","id","p_data"])],64)}}},$t=$e(ct,[["__scopeId","data-v-4e427f4c"]]);export{$t as default};
