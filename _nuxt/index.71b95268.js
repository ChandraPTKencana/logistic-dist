import ce from"./Header.e4b9e841.js";import de from"./Plus.605756a1.js";import me from"./Edit.52ec6a01.js";import _e from"./Eyes.9129b112.js";import fe from"./Delete.c0bbfe5c.js";import pe from"./Signature.3f685be6.js";import ve from"./Line.6b19c045.js";import he from"./Check.4f1fa85c.js";import ye from"./TypeIcon.ac754b3c.js";import{_ as ge}from"./PopupMini.vue.8a499cf3.js";import ke from"./salary_bonus.899b9e48.js";import we from"./salary_bonus_validasi.270c74a5.js";import{f as be,g as xe,r,h as De,i as V,s as Ce,j as Ae,c as d,b as m,a as e,k as t,l as k,F as Te,y as $e,w as Se,z as Me,A as v,B as N,o as u,C as Pe,D as A,t as _,d as Ue,m as Fe,v as Be,n as Ne,E as Ie}from"./entry.b0ebf8be.js";import{u as h}from"./useUtils.34b00da9.js";import{u as I}from"./useMyFetch.87f76a8b.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./DocJPEG.9334805b.js";import"./DocJPG.12ed4aa1.js";import"./DocPNG.60f06337.js";import"./DocPDF.16b8593f.js";import"./Times.e768340b.js";import"./Exclamation.d8ce6e32.js";import"./HeaderPopup.vue.4f40aaad.js";import"./client-only.97580058.js";import"./WidthMiniList.vue.47e14819.js";import"./WidthMiniPart.vue.a8e44d9b.js";import"./InputPointFormat.vue.e64938d7.js";import"./AttachmentSingle.2a449a9e.js";import"./PDFJsView.8811f203.js";const Le={class:"w-full h-full flex flex-col"},Oe={class:"w-full flex grow flex-col overflow-auto h-0"},Ee={class:"w-full flex"},je={class:"w-full flex justify-center items-center grow h-0 p-1"},ze={key:0,class:""},He={class:"tacky"},Re=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"App 2"),e("th",null,"ID"),e("th",null,"Tanggal"),e("th",null,"Tipe"),e("th",null,"Nama Karyawan"),e("th",null,"No KTP"),e("th",null,"No SIM"),e("th",null,"Nominal"),e("th",null,"Note"),e("th",null,"File"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),Ve=["onClick"],Ye={class:"flex items-center justify-center"},Ke={class:"flex items-center justify-center"},Je={class:"bold"},Ze={class:"grow mb-5"},At={__name:"index",async setup(qe){let w,L;const{$moment:T}=Ie(),{pointFormat:Y}=h(),c={};c._TimeZoneOffset=new Date().getTimezoneOffset(),c.sort="created_at:desc";const $=be("token"),{data:K}=([w,L]=xe(async()=>Me(async()=>{let a=[];v().loading_full=!0;const{data:o,error:f,status:g}=await I("/salary_bonuses",{method:"get",headers:{Authorization:`Bearer ${$.value}`,Accept:"application/json"},params:c,retry:0});return v().loading_full=!1,g.value==="error"?(N().trigger(f),{salary_bonuses:a}):(a=o.value.data,{salary_bonuses:a})},"$tya7A7egnO")),w=await w,L(),w),n=r(K.value.salary_bonuses);r(""),r({field:"created_at",by:"desc"});const s=r(-1),i=r({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),b=r(null),J=async()=>{v().loading_full=!0,i.value.may_get_data=!1,c.page=i.value.page,c.page==1&&(n.value=[]),c.first_row&&delete c.first_row,c.page>1&&(c.first_row=JSON.stringify(n.value[0]));const{data:a,error:o,status:f}=await I("/salary_bonuses",{method:"get",headers:{Authorization:`Bearer ${$.value}`,Accept:"application/json"},params:c,retry:0});if(v().loading_full=!1,i.value.may_get_data=!0,f.value==="error"){N().trigger(o);return}i.value.page==1?(n.value=a.value.data,b.value&&(b.value.scrollTop=0)):i.value.page>1&&(n.value=[...n.value,...a.value.data]),a.value.data.length==0&&(i.value.is_last_record=!0)},Z=async()=>{if(!i.value.may_get_data)return;let a=b.value;if(a.scrollLeft!=i.value.scrollLeft){i.value.scrollLeft=a.scrollLeft;return}i.value.is_last_record||!(Math.round(a.scrollTop)+a.clientHeight>=a.scrollHeight-1)||(i.value.page++,await J())};De();const x=r(!1),S=r(0),M=r(0),q=()=>{S.value=0,x.value=!0,M.value=!1},{display:D}=V();Ce(V());const G=()=>{s.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(S.value=n.value[s.value].id,x.value=!0,M.value=!1)},C=r(!1),P=r(0),U=r(!1),Q=()=>{s.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=n.value[s.value].id,C.value=!0,U.value=!1)},W=()=>{s.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=n.value[s.value].id,C.value=!0,U.value=!0)},F=r(!1),O=r({}),y=r(!1),p=r(""),X=async()=>{y.value&&(y.value=!1)},ee=()=>{s.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(p.value="",O.value={id:n.value[s.value].id},y.value=!0)};Ae(()=>p.value,a=>{a.trim().length>0?F.value=!0:F.value=!1},{immediate:!1});const te=async()=>{v().loading_full=!0;const a=new FormData;a.append("id",n.value[s.value].id),a.append("deleted_reason",p.value),a.append("_method","DELETE");const{data:o,error:f,status:g}=await I("/salary_bonus",{method:"post",headers:{Authorization:`Bearer ${$.value}`,Accept:"application/json"},body:a,retry:0});if(v().loading_full=!1,g.value==="error"){N().trigger(f);return}n.value.splice(s.value,1),s.value=-1,y.value=!1};return(a,o)=>{const f=ce,g=de,ae=me,le=_e,se=fe,oe=pe,E=ve,j=he,ne=ye,re=ge,ue=ke,ie=we;return u(),d("div",Le,[m(f,{title:"List Salary Additional"}),e("div",Oe,[e("div",Ee,[("useUtils"in a?a.useUtils:t(h))().checkPermission("salary_bonus.create")?(u(),d("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[0]||(o[0]=l=>q())},[m(g)])):k("",!0),("useUtils"in a?a.useUtils:t(h))().checkPermissions(["salary_bonus.modify"])&&t(s)>-1&&[void 0,0].indexOf(t(n)[t(s)].val1)>-1?(u(),d("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[1]||(o[1]=l=>G())},[m(ae)])):k("",!0),("useUtils"in a?a.useUtils:t(h))().checkPermissions(["salary_bonus.view"])&&t(s)>-1&&[void 0,0].indexOf(t(n)[t(s)].val1)>-1?(u(),d("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[2]||(o[2]=l=>W())},[m(le)])):k("",!0),("useUtils"in a?a.useUtils:t(h))().checkPermission("salary_bonus.remove")&&t(s)>-1?(u(),d("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[3]||(o[3]=l=>ee())},[m(se)])):k("",!0),("useUtils"in a?a.useUtils:t(h))().checkPermissions(["salary_bonus.val1","salary_bonus.val2","salary_bonus.val3"])&&t(s)>-1?(u(),d("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[4]||(o[4]=l=>Q())},[m(oe)])):k("",!0)]),e("div",je,[t(n).length==0?(u(),d("div",ze," Maaf Tidak Ada Record ")):(u(),d("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:Z},[e("table",He,[Re,e("tbody",null,[(u(!0),d(Te,null,$e(t(n),(l,B)=>{var z,H,R;return u(),d("tr",{key:B,onClick:Ge=>s.value=B,class:Pe(t(s)==B?"active":"")},[e("td",null,[e("div",Ye,[l.val1?(u(),A(j,{key:1})):(u(),A(E,{key:0}))])]),e("td",null,[e("div",Ke,[l.val2?(u(),A(j,{key:1})):(u(),A(E,{key:0}))])]),e("td",Je,_(l.id),1),e("td",null,_(l.tanggal?t(T)(l.tanggal).format("DD-MM-Y"):""),1),e("td",null,_(l.type),1),e("td",null,_((z=l.employee)==null?void 0:z.name),1),e("td",null,_((H=l.employee)==null?void 0:H.ktp_no),1),e("td",null,_((R=l.employee)==null?void 0:R.sim_no),1),e("td",null,_(t(Y)(l.nominal||0)),1),e("td",null,_(l.note),1),e("td",null,[m(ne,{value:l.attachment_1_type},null,8,["value"])]),e("td",null,_(l.created_at?t(T)(l.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,_(l.updated_at?t(T)(l.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,Ve)}),128))])])],544))])]),m(re,{type:"delete",show:t(y),data:t(O),fnClose:X,fnConfirm:te,enabledOk:t(F)},{footer:Se(()=>[Ue(" Masukkan Alasan Penghapusan: "),e("div",Ze,[Fe(e("textarea",{"onUpdate:modelValue":o[5]||(o[5]=l=>Ne(p)?p.value=l:null)},null,512),[[Be,t(p)]])])]),_:1},8,["show","data","enabledOk"]),m(ue,{show:t(x),fnClose:()=>{x.value=!1},id:t(S),p_data:t(n),is_copy:t(M)},null,8,["show","fnClose","id","p_data","is_copy"]),m(ie,{show:t(C),fnClose:()=>{C.value=!1},id:t(P),p_data:t(n),is_view:t(U)},null,8,["show","fnClose","id","p_data","is_view"])])}}};export{At as default};
