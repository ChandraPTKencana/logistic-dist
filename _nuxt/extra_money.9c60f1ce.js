import{_ as K}from"./HeaderPopup.vue.0c89d567.js";import{_ as L}from"./WidthMiniList.vue.16022c28.js";import{_ as M}from"./InputPointFormat.vue.66f4dea8.js";import{r as v,g as z,i as G,f as E,k as m,K as H,o as w,c as x,a as t,b,l as o,A as I,F as T,D as j,t as _,v as A,x as p,C as Q,y as S,p as W,e as R,H as X}from"./entry.fb632158.js";import{u as Y}from"./useUtils.8f10d844.js";import{u as N}from"./useMyFetch.14298027.js";import{_ as Z}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.2162c804.js";import"./WidthMiniPart.vue.60db8824.js";const r=f=>(W("data-v-4b4f708b"),f=f(),R(),f),tt={class:"box-fixed"},et={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},at={class:"w-full flex flex-col items-center grow overflow-auto"},ot={class:"w-full flex flex-row flex-wrap"},lt={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},st=r(()=>t("label",{for:""},"Tujuan",-1)),nt={id:"xto"},it={class:"text-red-500"},rt={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ct=r(()=>t("label",{for:""},"Jenis",-1)),dt=X('<option value="PK" data-v-4b4f708b>PK</option><option value="CPO" data-v-4b4f708b>CPO</option><option value="TBS" data-v-4b4f708b>TBS</option><option value="TBSK" data-v-4b4f708b>TBSK</option><option value="LAIN" data-v-4b4f708b>LAIN</option><option value="TUNGGU" data-v-4b4f708b>TUNGGU</option>',6),ut=[dt],_t={class:"text-red-500"},pt={class:"w-full sm:w-3/12 flex px-2 py-3"},ft={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative items-end"},vt=r(()=>t("div",{class:"absolute bg-white -top-3"}," Peralihan ",-1)),mt={class:"w-6/12 flex flex-col flex-wrap p-1"},wt=r(()=>t("option",{value:""},null,-1)),xt=r(()=>t("option",{value:"From"},"Dari",-1)),ht=r(()=>t("option",{value:"To"},"Ke",-1)),yt=[wt,xt,ht],gt={class:"text-red-500"},bt={class:"w-6/12 flex flex-col flex-wrap p-1"},St=r(()=>t("option",{value:""},null,-1)),Nt=["value"],At={class:"text-red-500"},Ct={class:"w-full sm:w-12/12 flex px-2 py-3"},qt={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative items-start"},Bt=r(()=>t("div",{class:"absolute bg-white -top-3"}," Account ",-1)),Dt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},It=r(()=>t("label",{for:""},"Info",-1)),Tt={class:"text-red-500"},jt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Ot=r(()=>t("label",{for:""},"Deskripsi",-1)),Ut={class:"text-red-500"},kt={class:"w-full sm:w-4/12 md:w-4/12 lg:w-4/12 flex flex-col flex-wrap p-1"},$t=r(()=>t("label",{for:""},"Nominal",-1)),Ft={class:"w-full"},Jt={class:"text-red-500"},Pt={class:"w-full sm:w-4/12 md:w-4/12 lg:w-4/12 flex flex-col flex-wrap p-1"},Vt=r(()=>t("label",{for:""},"Qty",-1)),Kt={class:"w-full"},Lt={class:"text-red-500"},Mt={class:"w-full sm:w-4/12 md:w-4/12 lg:w-4/12 flex flex-col flex-wrap p-1"},zt=r(()=>t("label",{for:""},"Total",-1)),Gt={class:"w-full card-border"},Et={class:"w-full flex items-center justify-end"},Ht={__name:"extra_money",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(f){const d=f,{pointFormat:O}=Y(),C={id:-1,xto:"",jenis:"",transition_target:"",transition_type:"",ac_account_id:"",ac_account_code:"",ac_account_name:"",description:"",nominal:0,qty:1},U=v([]);v({ordinal:0,id:"",tanggal:new Date,note:"",p_status:""});const a=v({...C}),h=z("token"),u=v({}),k=async()=>{p().loading_full=!0,u.value={};const s=new FormData;s.append("xto",a.value.xto),s.append("jenis",a.value.jenis),s.append("transition_target",a.value.transition_target),s.append("transition_type",a.value.transition_type),s.append("ac_account_id",i.value.id),s.append("description",a.value.description),s.append("nominal",a.value.nominal),s.append("qty",a.value.qty);let e="post",c=d.is_copy?0:d.id;c==0||(s.append("id",c),s.append("_method","PUT"));const{data:n,error:g,status:l}=await N("/extra_money",{method:e,headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},body:s,retry:0});if(p().loading_full=!1,l.value==="error"){S().trigger(g,u);return}if(a.value.ac_account_id=i.value._.id.val,a.value.ac_account_name=i.value._.name.val,a.value.ac_account_code=i.value._.code.val,a.value.updated_at=n.value.updated_at,c<=0)a.value.id=n.value.id,a.value.created_at=n.value.created_at,d.p_data.unshift(a.value);else{let D=d.p_data.map(V=>V.id).indexOf(d.id);D>=-1&&d.p_data.splice(D,1,{...a.value})}d.fnClose()},y={_:{id:{tcon:"",text:"ID",val:""},code:{tcon:"",text:"Code",val:""},name:{tcon:"",text:"Name",val:""}},id:"",name:"",title:""},i=v(JSON.parse(JSON.stringify(y))),$=G(()=>{let s=[];return B.value.forEach((e,c)=>{let n=JSON.parse(JSON.stringify(y));n._.id.val=e.AccountID,n._.name.val=e.AccountName,n._.code.val=e.AccountCode,n.id=e.AccountID,n.name=e.AccountCode,n.title=e.AccountName,s.push(JSON.parse(JSON.stringify(n)))}),s}),F=async()=>{p().loading_full=!0;const{data:s,error:e,status:c}=await N("/extra_money",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},params:{id:d.id},retry:0});if(p().loading_full=!1,c.value==="error"){S().trigger(e);return}d.is_copy&&(a.value.val=0,a.value.val1=0);let n=s.value.data;a.value=n,{...n},i.value._.id.val=n.ac_account_id,i.value._.name.val=n.ac_account_name,i.value._.code.val=n.ac_account_code,i.value.id=n.ac_account_id,i.value.name=n.ac_account_code,i.value.title=n.ac_account_name},q=v([]),B=v([]),J=async()=>{p().loading_full=!0;const{data:s,error:e,status:c}=await N("/extra_money_load_local",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},retry:0});if(p().loading_full=!1,c.value==="error"){S().trigger(e);return}q.value=s.value.list_xto},P=async()=>{p().loading_full=!0;const{data:s,error:e,status:c}=await N("/extra_money_load_sqlsrv",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},retry:0});if(p().loading_full=!1,c.value==="error"){S().trigger(e);return}B.value=s.value.list_accs};return E(()=>d.show,async(s,e)=>{s==!0&&(await J(),await P(),a.value={...C},i.value=JSON.parse(JSON.stringify(y)),U.value=[],u.value={},d.id!=0&&F())},{immediate:!0}),(s,e)=>{const c=K,n=L,g=M;return m((w(),x("section",tt,[t("div",null,[b(c,{title:"Form Transaction",fn:f.fnClose,class:"w-full flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",et,[t("div",at,[t("div",ot,[t("div",lt,[st,m(t("input",{type:"text",list:"xto","onUpdate:modelValue":e[0]||(e[0]=l=>o(a).xto=l)},null,512),[[I,o(a).xto]]),t("datalist",nt,[(w(!0),x(T,null,j(o(q),l=>(w(),x("option",null,_(l),1))),256))]),t("p",it,_(o(u).xto),1)]),t("div",rt,[ct,m(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>o(a).jenis=l)},ut,512),[[A,o(a).jenis]]),t("p",_t,_(o(u).jenis),1)]),t("div",pt,[t("div",ft,[vt,t("div",mt,[m(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>o(a).transition_type=l)},yt,512),[[A,o(a).transition_type]]),t("p",gt,_(o(u).transition_type),1)]),t("div",bt,[m(t("select",{"onUpdate:modelValue":e[3]||(e[3]=l=>o(a).transition_target=l)},[St,(w(!0),x(T,null,j(o(p)().list_pabrik,l=>(w(),x("option",{value:l},_(l),9,Nt))),256))],512),[[A,o(a).transition_target]]),t("p",At,_(o(u).transition_target),1)])])]),t("div",Ct,[t("div",qt,[Bt,t("div",Dt,[It,b(n,{arr:o($),selected:o(i),pure:y,onSetSelected:e[4]||(e[4]=l=>i.value=l)},null,8,["arr","selected"]),t("p",Tt,_(o(u).ac_account_id),1)]),t("div",jt,[Ot,m(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=l=>o(a).description=l)},null,512),[[I,o(a).description]]),t("p",Ut,_(o(u).description),1)]),t("div",kt,[$t,t("div",Ft,[b(g,{class:"w-full h-full p-1",type:"text",value:o(a).nominal||0,onInput:e[6]||(e[6]=l=>o(a).nominal=l)},null,8,["value"])]),t("p",Jt,_(o(u).nominal),1)]),t("div",Pt,[Vt,t("div",Kt,[b(g,{class:"w-full h-full p-1",type:"text",value:o(a).qty||0,onInput:e[7]||(e[7]=l=>o(a).qty=l)},null,8,["value"])]),t("p",Lt,_(o(u).qty),1)]),t("div",Mt,[zt,t("div",Gt,_(o(O)(o(a).nominal*o(a).qty)),1)])])])])]),t("div",Et,[t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:e[8]||(e[8]=l=>f.fnClose())}," Cancel "),t("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:e[9]||(e[9]=Q(l=>k(),["prevent"]))}," Save ")])])])],512)),[[H,f.show]])}}},oe=Z(Ht,[["__scopeId","data-v-4b4f708b"]]);export{oe as default};
