import de from"./Header.54c82aef.js";import me from"./Plus.dd09454a.js";import pe from"./Edit.3cef9f4d.js";import ce from"./Eyes.c256e6d9.js";import fe from"./Signature.49e32bdc.js";import ve from"./Line.c116fade.js";import ye from"./Check.f6dc2b89.js";import ge from"./TableView.e109d8df.js";import be from"./mst.881738d1.js";import ke from"./validasi.c407254a.js";import{r as a,f as V,g as he,h as xe,i as f,B as we,j as z,s as De,c as x,b as p,a as d,k as Pe,v as Se,l,m as Ce,n as P,w as S,q as Ae,x as v,y as J,o as u,z as C,d as E,t as R}from"./entry.b6e16180.js";import{u as _}from"./useUtils.ec700263.js";import{u as L}from"./useMyFetch.ce7be1f1.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.801da737.js";import"./Adjust.13c58660.js";import"./TableHeaderEye.7c47d910.js";import"./Times.1d45301c.js";import"./ClearAll.955d6de1.js";import"./client-only.e2fc9316.js";import"./ClearEach.4ad50093.js";import"./CaretLeftDoubleBold.4ca4eab2.js";import"./CaretLeftBold.778ea19d.js";import"./CaretRightBold.533cb4ca.js";import"./CaretRightDoubleBold.45de0dc4.js";import"./HeaderPopup.vue.794dd8e3.js";import"./WidthMiniList.vue.e0a77642.js";import"./WidthMiniPart.vue.eb2826e1.js";import"./InputPointFormat.vue.2cc7585b.js";import"./AttachmentSingle.b4c2510b.js";import"./PDFJsView.99362033.js";import"./part.3d452012.js";import"./Calculator.82412ac1.js";import"./trx.1e685b3d.js";import"./trx_validasi.c7ae9599.js";const Oe={class:"w-full h-full flex flex-col"},$e={class:"w-full flex grow flex-col overflow-auto h-0"},je={class:"w-full flex justify-between flex-wrap"},Ne={class:"grow flex"},Be={class:"m-1"},Me=d("option",{value:"undone"},"Undone",-1),Te=d("option",{value:"done"},"Done",-1),He=d("option",{value:"deleted"},"Trash",-1),Fe=d("option",{value:"all"},"All",-1),Ie=[Me,Te,He,Fe],ht={__name:"index",async setup(Ue){let w,N;const Y=e=>e.deleted==1?"!bg-red-400":e.val>0&&e.val1>0&&e.remaining_cut==0?"!bg-blue-300":"",c=a("undone");V(()=>c.value,e=>{T()},{immediate:!1});const n={};n._TimeZoneOffset=new Date().getTimezoneOffset(),n.sort="created_at:desc";const B=he("token"),{data:q}=([w,N]=xe(async()=>Ae(async()=>{let e=[];v().loading_full=!0;const{data:t,error:k,status:j}=await L("/potongan_msts",{method:"get",headers:{Authorization:`Bearer ${B.value}`,Accept:"application/json"},params:{filter_status:c},retry:0});return v().loading_full=!1,j.value==="error"?(J().trigger(k),{potongan_msts:e}):(e=t.value.data,{potongan_msts:e})},"$4H5grU4zhJ")),w=await w,N(),w),r=a(q.value.potongan_msts);a("");const A=a({field:"created_at",by:"desc"}),s=a(-1),i=a({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),m=f(()=>r.value[s.value]),K=()=>{n.like="";let e=JSON.parse(JSON.stringify(v()._tv.global_keyword));e!=""&&(n.like=`id:%${e}%,employee_name:%${e}%,no_pol:%${e}%,kejadian:%${e}%,status:%${e}%`),n.sort="",A.value.field&&(n.sort=A.value.field+":"+A.value.by),n.filter_model=JSON.stringify(v()._tv.filter_model)};a(null);const M=async()=>{v().loading_full=!0,i.value.may_get_data=!1,n.page=i.value.page,n.page==1&&(r.value=[]),n.first_row&&delete n.first_row,n.page>1&&(n.first_row=JSON.stringify(r.value[0])),n.filter_status=c.value;const{data:e,error:t,status:k}=await L("/potongan_msts",{method:"get",headers:{Authorization:`Bearer ${B.value}`,Accept:"application/json"},params:n,retry:0});if(v().loading_full=!1,i.value.may_get_data=!0,k.value==="error"){J().trigger(t);return}i.value.page==1?r.value=e.value.data:i.value.page>1&&(r.value=[...r.value,...e.value.data]),e.value.data.length==0&&(i.value.is_last_record=!0),v()._tv.filter_box=!1},T=()=>{s.value=-1,i.value.page=1,i.value.is_last_record=!1,K(),M()};we();const y=a(!1),D=a(0),g=a(0),b=a(!1),Z=()=>{D.value=0,b.value=!1,g.value=!1,y.value=!0},{display:O}=z();De(z());const G=()=>{s.value==-1?O({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(D.value=r.value[s.value].id,b.value=!1,g.value=!1,y.value=!0)},$=a(!1),H=a(0),Q=()=>{s.value==-1?O({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(H.value=r.value[s.value].id,b.value=!0,g.value=!1,$.value=!0)},W=()=>{s.value==-1?O({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(D.value=r.value[s.value].id,b.value=!0,g.value=!1,y.value=!0)},F=a(!1);a({}),a(!1);const X=a("");V(()=>X.value,e=>{e.trim().length>0?F.value=!0:F.value=!1},{immediate:!1});const ee=a([{key:"no",label:"No",isai:!0},{key:"valx",label:"APP",childs:[{key:"val",label:"App 1",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val1",label:"App 2",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]}]},{key:"id",label:"ID",filter_on:1,type:"number",sort:{priority:1,type:"desc"}},{key:"employee_name",label:"Nama Pekerja",freeze:1,filter_on:1,type:"string"},{key:"no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"kejadian",label:"Kejadian",filter_on:1,type:"string"},{key:"nominal",label:"Nominal",class:" justify-end",type:"number"},{key:"nominal_cut",label:"Nominal Potongan",class:" justify-end",type:"number"},{key:"remaining_cut",label:"Sisa Potongan",class:" justify-end",type:"number"},{key:"status",label:"Status",class:" justify-end",type:"number"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]);f(()=>s.value>-1&&[void 0,0].indexOf(m.value.deleted)>-1&&_().checkPermission("potongan_mst.create"));const te=f(()=>["undone","done","deleted","all"].indexOf(c.value)>-1&&_().checkPermission("potongan_mst.create")),oe=f(()=>s.value>-1&&_().checkPermission("potongan_mst.view")),ae=f(()=>s.value>-1&&[void 0,0].indexOf(m.value.deleted)>-1&&(_().checkPermission("potongan_mst.val")&&[void 0,0].indexOf(m.value.val)>-1||_().checkPermission("potongan_mst.val1")&&[void 0,0].indexOf(m.value.val1)>-1)&&_().checkPermissions(["potongan_mst.modify","potongan_trx.create","potongan_trx.modify","potongan_trx.remove"])),le=f(()=>s.value>-1&&[void 0,0].indexOf(m.value.deleted)>-1&&(_().checkPermission("potongan_mst.val")&&[void 0,0].indexOf(m.value.val)>-1||_().checkPermission("potongan_mst.val1")&&[void 0,0].indexOf(m.value.val1)>-1));return f(()=>s.value>-1&&_().checkPermission("potongan_mst.remove")&&[void 0,0].indexOf(m.value.deleted)>-1),(e,t)=>{const k=de,j=me,ne=pe,se=ce,re=fe,I=ve,U=ye,ie=ge,ue=be,_e=ke;return u(),x("div",Oe,[p(k,{title:"List Potongan"}),d("div",$e,[d("div",je,[d("div",Ne,[d("div",Be,[Pe(d("select",{class:"","onUpdate:modelValue":t[0]||(t[0]=o=>Ce(c)?c.value=o:null)},Ie,512),[[Se,l(c)]])]),l(te)?(u(),x("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=o=>Z())},[p(j)])):P("",!0),l(ae)?(u(),x("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=o=>G())},[p(ne)])):P("",!0),l(oe)?(u(),x("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[3]||(t[3]=o=>W())},[p(se)])):P("",!0),l(le)?(u(),x("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[4]||(t[4]=o=>Q())},[p(re)])):P("",!0)])]),p(ie,{thead:l(ee),selected:l(s),onSetSelected:t[5]||(t[5]=o=>s.value=o),tbody:l(r),fnCallData:M,scrolling:l(i),onSetScrollingPage:t[6]||(t[6]=o=>l(i).page=o),onDoFilter:t[7]||(t[7]=o=>T()),rowBgColor:Y},{val:S(({item:o})=>[o.val?(u(),C(U,{key:1})):(u(),C(I,{key:0}))]),val1:S(({item:o})=>[o.val1?(u(),C(U,{key:1})):(u(),C(I,{key:0}))]),employee_name:S(({item:o})=>{var h;return[E(R((h=o.employee)==null?void 0:h.name),1)]}),deleted_by_username:S(({item:o})=>{var h;return[E(R((h=o.deleted_by)==null?void 0:h.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])]),p(ue,{show:l(y),fnClose:()=>{y.value=!1},id:l(D),p_data:l(r),is_copy:l(g),is_view:l(b)},null,8,["show","fnClose","id","p_data","is_copy","is_view"]),p(_e,{show:l($),fnClose:()=>{$.value=!1},id:l(H),p_data:l(r)},null,8,["show","fnClose","id","p_data"])])}}};export{ht as default};
