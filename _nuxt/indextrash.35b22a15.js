import he from"./Header.abb9a0dd.js";import ye from"./Copy.0f3d0c61.js";import ke from"./Plus.d9933a2b.js";import be from"./Edit.6684a181.js";import ge from"./Eyes.ea52574c.js";import we from"./Delete.e8452bb4.js";import xe from"./Signature.3714b415.js";import De from"./Search.19acb84d.js";import Ce from"./Line.2cb92914.js";import $e from"./Check.f17b370a.js";import{_ as Ae}from"./PopupMini.vue.6251da8a.js";import Se from"./standby_mst.a3e9e2d2.js";import Ue from"./standby_mst_validasi.23d8e197.js";import{g as Te,h as Pe,r as n,B as Me,j as Y,s as Fe,f as Ie,c as d,b as _,a as e,l as s,n as k,k as T,A as K,m as q,v as G,C as je,F as Be,D as Le,w as Ve,q as Ee,x as b,y as L,o as u,E as Ne,z as P,t as v,d as Oe,G as ze}from"./entry.d3b1eb86.js";import{u as h}from"./useUtils.20b3b5b9.js";import{u as V}from"./useMyFetch.e123b428.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.55bb2602.js";import"./Exclamation.a9d61ca5.js";import"./HeaderPopup.vue.d65961ae.js";import"./Tools.59996675.js";import"./InputPointFormat.vue.166650e2.js";import"./ToolsPopup.f69b7393.js";import"./ac_accs.0fc288a1.js";const He={class:"w-full h-full flex flex-col"},Re={class:"w-full flex grow flex-col overflow-auto h-0"},Ye={class:"w-full flex"},Ke={action:"#",class:"w-full flex p-1"},qe={class:"grow"},Ge=e("div",{class:"font-bold"}," Keyword ",-1),Je={class:"pl-1"},Ze=e("div",{class:"font-bold"}," Sort By ",-1),Qe=e("option",{value:""},null,-1),We=e("option",{value:"id"},"ID",-1),Xe=e("option",{value:"name"},"Name",-1),et=e("option",{value:"tipe"},"Tipe",-1),tt=[Qe,We,Xe,et],st={class:"pl-1"},at=e("div",{class:"font-bold"}," Sort Order ",-1),ot=e("option",{value:"asc"},"Asc",-1),lt=e("option",{value:"desc"},"Desc",-1),nt=[ot,lt],it={class:"flex items-end pl-1"},ut={class:"w-full flex justify-center items-center grow h-0 p-1"},rt={key:0,class:""},ct={class:"tacky"},dt=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"App 2"),e("th",null,"ID"),e("th",null,"Name"),e("th",null,"Tipe"),e("th",null,"Amount"),e("th",null,"Peralihan"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),_t=["onClick"],mt={class:"flex items-center justify-center"},ft={class:"flex items-center justify-center"},pt={class:"bold"},vt={class:"grow mb-5"},Ht={__name:"indextrash",async setup(ht){let C,E;const{$moment:N}=ze(),{pointFormat:J}=h(),r={};r._TimeZoneOffset=new Date().getTimezoneOffset(),r.sort="created_at:desc";const M=Te("token"),{data:Z}=([C,E]=Pe(async()=>Ee(async()=>{let t=[];b().loading_full=!0;const{data:a,error:p,status:D}=await V("/standby_msts",{method:"get",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},params:r,retry:0});return b().loading_full=!1,D.value==="error"?(L().trigger(p),{standby_msts:t}):(t=a.value.data,{standby_msts:t})},"$lwjC6yOixj")),C=await C,E(),C),l=n(Z.value.standby_msts),m=n(""),f=n({field:"created_at",by:"desc"}),i=n(-1),c=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),Q=()=>{r.like="",m.value!=""&&(r.like=`id:%${m.value}%,name:%${m.value}%,amount:%${m.value}%`),r.sort="",f.value.field&&(r.sort=f.value.field+":"+f.value.by)},$=n(null),O=async()=>{b().loading_full=!0,c.value.may_get_data=!1,r.page=c.value.page,r.page==1&&(l.value=[]),r.first_row&&delete r.first_row,r.page>1&&(r.first_row=JSON.stringify(l.value[0]));const{data:t,error:a,status:p}=await V("/standby_msts",{method:"get",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},params:r,retry:0});if(b().loading_full=!1,c.value.may_get_data=!0,p.value==="error"){L().trigger(a);return}c.value.page==1?(l.value=t.value.data,$.value&&($.value.scrollTop=0)):c.value.page>1&&(l.value=[...l.value,...t.value.data]),t.value.data.length==0&&(c.value.is_last_record=!0)},W=async()=>{if(!c.value.may_get_data)return;let t=$.value;if(t.scrollLeft!=c.value.scrollLeft){c.value.scrollLeft=t.scrollLeft;return}c.value.is_last_record||!(Math.round(t.scrollTop)+t.clientHeight>=t.scrollHeight-1)||(c.value.page++,await O())},X=()=>{c.value.page=1,c.value.is_last_record=!1,Q(),O()};Me();const g=n(!1),A=n(0),S=n(0),ee=()=>{A.value=0,g.value=!0,S.value=!1},{display:w}=Y();Fe(Y());const te=()=>{i.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(A.value=l.value[i.value].id,g.value=!0,S.value=!1)},se=()=>{i.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(A.value=l.value[i.value].id,g.value=!0,S.value=!0)},U=n(!1),F=n(0),I=n(!1),ae=()=>{i.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=l.value[i.value].id,U.value=!0,I.value=!1)},oe=()=>{i.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=l.value[i.value].id,U.value=!0,I.value=!0)},j=n(!1),z=n({}),x=n(!1),y=n(""),le=async()=>{x.value&&(x.value=!1)},ne=()=>{i.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(y.value="",z.value={id:l.value[i.value].id},x.value=!0)};Ie(()=>y.value,t=>{t.trim().length>0?j.value=!0:j.value=!1},{immediate:!1});const ie=async()=>{b().loading_full=!0;const t=new FormData;t.append("id",l.value[i.value].id),t.append("deleted_reason",y.value),t.append("_method","DELETE");const{data:a,error:p,status:D}=await V("/standby_mst",{method:"post",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},body:t,retry:0});if(b().loading_full=!1,D.value==="error"){L().trigger(p);return}l.value.splice(i.value,1),i.value=-1,x.value=!1};return(t,a)=>{const p=he,D=ye,ue=ke,re=be,ce=ge,de=we,_e=xe,me=De,H=Ce,R=$e,fe=Ae,pe=Se,ve=Ue;return u(),d("div",He,[_(p,{title:"List Standby"}),e("div",Re,[e("div",Ye,[("useUtils"in t?t.useUtils:s(h))().checkPermission("standby_mst.create")?(u(),d("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[0]||(a[0]=o=>se())},[_(D)])):k("",!0),("useUtils"in t?t.useUtils:s(h))().checkPermission("standby_mst.create")?(u(),d("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[1]||(a[1]=o=>ee())},[_(ue)])):k("",!0),("useUtils"in t?t.useUtils:s(h))().checkPermission("standby_mst.modify")?(u(),d("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[2]||(a[2]=o=>te())},[_(re)])):k("",!0),("useUtils"in t?t.useUtils:s(h))().checkPermission("standby_mst.view")?(u(),d("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[3]||(a[3]=o=>oe())},[_(ce)])):k("",!0),("useUtils"in t?t.useUtils:s(h))().checkPermission("standby_mst.remove")?(u(),d("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[4]||(a[4]=o=>ne())},[_(de)])):k("",!0),("useUtils"in t?t.useUtils:s(h))().checkPermissions(["standby_mst.val","standby_mst.val1"])?(u(),d("button",{key:5,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[5]||(a[5]=o=>ae())},[_(_e)])):k("",!0)]),e("form",Ke,[e("div",qe,[Ge,T(e("input",{class:"",type:"text","onUpdate:modelValue":a[6]||(a[6]=o=>q(m)?m.value=o:null),name:"search",placeholder:"Keyword"},null,512),[[K,s(m)]])]),e("div",Je,[Ze,T(e("select",{class:"","onUpdate:modelValue":a[7]||(a[7]=o=>s(f).field=o)},tt,512),[[G,s(f).field]])]),e("div",st,[at,T(e("select",{class:"","onUpdate:modelValue":a[8]||(a[8]=o=>s(f).by=o)},nt,512),[[G,s(f).by]])]),e("div",it,[e("button",{class:"",type:"submit",name:"button",onClick:a[9]||(a[9]=je(o=>X(),["prevent"]))},[_(me,{class:"text-2xl"})])])]),e("div",ut,[s(l).length==0?(u(),d("div",rt," Maaf Tidak Ada Record ")):(u(),d("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:$,onScroll:W},[e("table",ct,[dt,e("tbody",null,[(u(!0),d(Be,null,Le(s(l),(o,B)=>(u(),d("tr",{key:B,onClick:yt=>i.value=B,class:Ne(s(i)==B?"active":"")},[e("td",null,[e("div",mt,[o.val?(u(),P(R,{key:1})):(u(),P(H,{key:0}))])]),e("td",null,[e("div",ft,[o.val1?(u(),P(R,{key:1})):(u(),P(H,{key:0}))])]),e("td",pt,v(o.id),1),e("td",null,v(o.name),1),e("td",null,v(o.tipe),1),e("td",null,v(s(J)(o.amount)),1),e("td",null,v(o.is_transition?"Ya":"Tidak"),1),e("td",null,v(o.created_at?s(N)(o.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,v(o.updated_at?s(N)(o.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,_t))),128))])])],544))])]),_(fe,{type:"delete",show:s(x),data:s(z),fnClose:le,fnConfirm:ie,enabledOk:s(j)},{footer:Ve(()=>[Oe(" Masukkan Alasan Penghapusan: "),e("div",vt,[T(e("textarea",{"onUpdate:modelValue":a[10]||(a[10]=o=>q(y)?y.value=o:null)},null,512),[[K,s(y)]])])]),_:1},8,["show","data","enabledOk"]),_(pe,{show:s(g),fnClose:()=>{g.value=!1},id:s(A),p_data:s(l),is_copy:s(S)},null,8,["show","fnClose","id","p_data","is_copy"]),_(ve,{show:s(U),fnClose:()=>{U.value=!1},id:s(F),p_data:s(l),is_view:s(I)},null,8,["show","fnClose","id","p_data","is_view"])])}}};export{Ht as default};
