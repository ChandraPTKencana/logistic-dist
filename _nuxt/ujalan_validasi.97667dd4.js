import{_ as R}from"./HeaderPopup.vue.b004c5e6.js";import P from"./Times.3fee37ef.js";import E from"./Check.1aa47b5a.js";import{r as w,g as K,i as z,f as J,k as O,K as Q,o as r,c as u,a as e,b as G,t as a,l as t,d as k,F as j,D as B,E as x,z as S,n as p,C as U,G as L,x as y,y as q,p as W,e as X}from"./entry.c550775e.js";import{u as Z}from"./useUtils.5bfaf943.js";import{u as F}from"./useMyFetch.105aa333.js";import{_ as ee}from"./_plugin-vue_export-helper.c27b6911.js";const o=f=>(W("data-v-89836ea0"),f=f(),X(),f),te={class:"box-fixed"},se={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},ae={class:"w-full flex flex-col items-center grow overflow-auto"},le={class:"w-full flex flex-row flex-wrap"},oe={class:"w-full sm:w-8/12 md:w-5/12 lg:w-5/12 flex flex-col flex-wrap p-1"},ce=o(()=>e("label",{for:""},"To",-1)),ne={class:"card-border"},ie={class:"w-1/2 sm:w-2/12 md:w-1/12 lg:w-1/12 flex flex-col flex-wrap p-1"},re=o(()=>e("label",{for:""},"Jenis",-1)),de={class:"card-border"},_e={class:"w-1/2 sm:w-2/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},ue=o(()=>e("label",{for:""},"KM Range",-1)),fe={class:"card-border"},ve={class:"w-1/2 sm:w-2/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},me=o(()=>e("label",{for:""},"Harga",-1)),pe={class:"card-border"},he={class:"w-1/2 sm:w-3/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},xe=o(()=>e("label",{for:""},"Asal Peralihan",-1)),we={class:"card-border"},ye={class:"w-full sm:w-7/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},be=o(()=>e("label",{for:""},"Tipe",-1)),ge={class:"card-border"},ke={class:"w-full sm:w-full md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},je=o(()=>e("label",{for:""},"Ket. Untuk Remarks",-1)),Ce={class:"card-border"},De={class:"w-full flex flex-col sm:flex-row grow p-1 justify-between flex-wrap 2xl:overflow-hidden"},Ae={class:"w-full max-w-full 2xl:w-1/2 2xl:overflow-auto 2xl:pr-1 2xl:max-h-full"},qe={class:"w-full",role:"sticky"},Fe={class:"tacky w-full !table-auto whitespace-normal"},Ve=o(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"6",class:"!bg-slate-800 text-white font-bold"}," Detail Uang Jalan ")],-1)),Ne={class:"sticky top-8 !z-[2]"},Te=o(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),$e=o(()=>e("th",{class:"min-w-[150px] !w-[150px] max-w-[150px]"},"Desc",-1)),ze=o(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Harga @",-1)),Be=o(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"Qty",-1)),Se={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Ue=o(()=>e("br",null,null,-1)),Ye={class:"text-sm"},He=o(()=>e("th",{class:"min-w-[70px] !w-[70px] max-w-[70px] whitespace-break-spaces"},"For Remarks",-1)),Ie={ref:"to_move"},Me=["data-index"],Re={class:"cell"},Pe={class:"w-full h-auto flex items-center justify-center"},Ee={class:"cell bold"},Ke={class:"w-full h-auto flex items-center justify-center"},Je={class:"cell"},Oe={class:"w-full h-auto flex items-center justify-center"},Qe={class:"cell"},Ge={class:"w-full h-auto flex items-center justify-center"},Le={class:"cell"},We={class:"w-full h-auto flex items-center justify-center"},Xe={class:"w-full max-w-full 2xl:w-1/2 2xl:overflow-auto 2xl:pl-1 2xl:max-h-full pt-1 2xl:pt-0"},Ze={class:"w-full",role:"sticky"},et={class:"tacky w-full !table-auto whitespace-normal"},tt=o(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"9",class:"!bg-slate-800 text-white font-bold"}," Detail PVR ")],-1)),st={class:"sticky top-8 !z-[2]"},at=o(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),lt=o(()=>e("th",{class:"min-w-[60px] !w-[60px] max-w-[60px]"},"Acc ID",-1)),ot=o(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),ct=o(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),nt=o(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),it=o(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Amount",-1)),rt=o(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Qty",-1)),dt=o(()=>e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"For",-1)),_t={class:"min-w-[100px] !w-[100px] max-w-[100px]"},ut=o(()=>e("br",null,null,-1)),ft={class:"text-sm"},vt={ref:"to_move"},mt=["data-index"],pt={class:"w-full h-auto flex items-center justify-center"},ht={class:"w-full h-auto flex items-center justify-center"},xt={class:"w-full h-auto flex items-center justify-center"},wt={key:0,class:"cell"},yt={class:"w-full h-auto flex items-center justify-center"},bt={class:"w-full h-auto flex items-center justify-center"},gt={class:"cell"},kt={class:"w-full h-auto flex items-center justify-center"},jt={class:"w-full flex items-center justify-end"},Ct={class:"w-full flex flex-wrap p-3 items-center"},Dt=o(()=>e("div",null," Di Validasi oleh : ",-1)),At={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},qt={key:0},Ft={key:1},Vt={__name:"ujalan_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},it_state:{type:Number,required:!1,default:-1}},setup(f){const d=f,{$moment:V}=L(),{pointFormat:v}=Z(),s=w({...{id:-1,xto:"",km_range:0,tipe:"",jenis:"",harga:0,note_for_remarks:0,details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:""}}),C=K("token"),g=w({}),N=w(null),T=w(null),$=w([]),D=w([]),Y=async()=>{y().loading_full=!0,g.value={};const n=new FormData;let i="post",m=d.id;m==0||(n.append("id",m),n.append("_method","PUT"));const{data:c,error:b,status:l}=await F("/ujalan_validasi",{method:i,headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},body:n,retry:0});if(y().loading_full=!1,l.value==="error"){q().trigger(b,g);return}s.value.val=c.value.val,s.value.val_user=c.value.val_user,s.value.val_by=c.value.val_by,s.value.val_at=c.value.val_at,s.value.val1=c.value.val1,s.value.val1_user=c.value.val1_user,s.value.val1_by=c.value.val1_by,s.value.val1_at=c.value.val1_at;let _=d.p_data.map(A=>A.id).indexOf(d.id);_>=-1&&d.p_data.splice(_,1,{...s.value}),d.fnClose()},H=async()=>{y().loading_full=!0,g.value={};const n=new FormData;let i="post",m=d.id;m==0||(n.append("id",m),n.append("_method","PUT"));const{data:c,error:b,status:l}=await F("/ujalan_unvalidasi",{method:i,headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},body:n,retry:0});if(y().loading_full=!1,l.value==="error"){q().trigger(b,g);return}s.value.val=c.value.val,s.value.val_user=c.value.val_user,s.value.val_by=c.value.val_by,s.value.val_at=c.value.val_at,s.value.val1=c.value.val1,s.value.val1_user=c.value.val1_user,s.value.val1_by=c.value.val1_by,s.value.val1_at=c.value.val1_at;let _=d.p_data.map(A=>A.id).indexOf(d.id);_>=-1&&d.p_data.splice(_,1,{...s.value}),d.fnClose()},I=async()=>{y().loading_full=!0;const{data:n,error:i,status:m}=await F("/ujalan_",{method:"get",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},params:{id:d.id},retry:0});if(y().loading_full=!1,m.value==="error"){q().trigger(i);return}s.value=n.value.data,$.value=n.value.data.details,D.value=n.value.data.details2},M=z(()=>{let n=0;return D.value.forEach(i=>{i.p_status!="Remove"&&(n+=i.qty*i.amount)}),n}),h=z(()=>!1);return J(()=>d.show,(n,i)=>{n==!0&&(d.it_state==1&&setTimeout(()=>{N.value.focus()},1),d.it_state==0&&setTimeout(()=>{T.value.focus()},1),I())},{immediate:!0}),(n,i)=>{const m=R,c=P,b=E;return O((r(),u("section",te,[e("div",null,[G(m,{title:"Form Ujalan Validation",fn:f.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",se,[e("div",ae,[e("div",le,[e("div",oe,[ce,e("div",ne,a(t(s).xto),1)]),e("div",ie,[re,e("div",de,a(t(s).jenis),1)]),e("div",_e,[ue,e("div",fe,a(t(s).km_range),1)]),e("div",ve,[me,e("div",pe,a(t(v)(t(s).harga||0)),1)]),e("div",he,[xe,e("div",we,a(t(s).transition_from),1)]),e("div",ye,[be,e("div",ge,a(t(s).tipe),1)]),e("div",ke,[je,e("div",Ce,a(t(s).note_for_remarks),1)])]),e("div",De,[e("div",Ae,[e("div",qe,[e("table",Fe,[e("thead",null,[Ve,e("tr",Ne,[Te,$e,ze,Be,e("th",Se,[k("Total "),Ue,k(),e("span",Ye,"("+a(t(v)(t(s).harga||0))+")",1)]),He])]),e("tbody",Ie,[(r(!0),u(j,null,B(t($),(l,_)=>(r(),u(j,{key:_},[l.p_status!="Remove"?(r(),u("tr",{key:0,"data-index":_},[e("td",null,a(_+1)+".",1),e("td",Re,[e("div",Pe,a(l.xdesc),1)]),e("td",Ee,[e("div",Ke,a(t(v)(l.harga||0)),1)]),e("td",Je,[e("div",Oe,a(t(v)(l.qty||0)),1)]),e("td",Qe,[e("div",Ge,a(t(v)(l.qty*l.harga||0)),1)]),e("td",Le,[e("div",We,[e("div",{class:x(["text-white rounded text-xl w-5 h-5",l.for_remarks?"bg-green-600":"bg-red-600"])},[l.for_remarks==0?(r(),S(c,{key:0})):(r(),S(b,{key:1}))],2)])])],8,Me)):p("",!0)],64))),128))],512)])])]),e("div",Xe,[e("div",Ze,[e("table",et,[e("thead",null,[tt,e("tr",st,[at,lt,ot,ct,nt,it,rt,dt,e("th",_t,[k("Total "),ut,k(),e("span",ft,"("+a(t(v)(t(M)))+")",1)])])]),e("tbody",vt,[(r(!0),u(j,null,B(t(D),(l,_)=>(r(),u(j,{key:_},[l.p_status!="Remove"?(r(),u("tr",{key:0,"data-index":_},[e("td",null,a(_+1)+".",1),e("td",{class:x(["cell bold",t(h)?"unselectable":""])},[e("div",pt,a(l.ac_account_id),1)],2),e("td",{class:x(["cell bold",t(h)?"unselectable":""])},[e("div",ht,a(l.ac_account_code),1)],2),e("td",{class:x(["cell bold",t(h)?"unselectable":""])},[e("div",xt,a(l.ac_account_name),1)],2),t(h)?p("",!0):(r(),u("td",wt,[e("div",yt,a(l.description),1)])),e("td",{class:x(["cell bold",t(h)?"unselectable":""])},[e("div",bt,a(t(v)(l.amount||0)),1)],2),e("td",{class:x(["cell",t(h)?"unselectable":""])},a(t(v)(l.qty||0)),3),e("td",{class:x(["cell",t(h)?"unselectable":""])},a(l.xfor),3),e("td",gt,[e("div",kt,a(t(v)(l.qty*l.amount||0)),1)])],8,mt)):p("",!0)],64))),128))],512)])])])])]),e("div",jt,[e("div",Ct,[Dt,t(s).val||t(s).val1?(r(),u("div",At,[t(s).val?(r(),u("div",qt," App 1 : "+a(t(s).val_by.username)+" ( "+a(t(s).val_at?t(V)(t(s).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):p("",!0),t(s).val1?(r(),u("div",Ft," App 2 : "+a(t(s).val1_by.username)+" ( "+a(t(s).val1_at?t(V)(t(s).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):p("",!0)])):p("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:i[0]||(i[0]=l=>f.fnClose())}," Cancel "),f.it_state==1?(r(),u("button",{key:0,ref_key:"it_val",ref:N,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:i[1]||(i[1]=U(l=>Y(),["prevent"]))}," Validasi ",512)):p("",!0),f.it_state==0?(r(),u("button",{key:1,ref_key:"it_unval",ref:T,type:"submit",name:"button",class:"w-36 m-1 bg-yellow-600 text-white rounded-sm",onClick:i[2]||(i[2]=U(l=>H(),["prevent"]))}," Unvalidasi ",512)):p("",!0)])])])],512)),[[Q,f.show]])}}},Ht=ee(Vt,[["__scopeId","data-v-89836ea0"]]);export{Ht as default};
