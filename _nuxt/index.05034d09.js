import{g as re,h as ie,r as l,f as B,C as ue,j as F,s as _e,J as ce,c as h,b as u,a as e,w as I,t as c,l as s,k as de,A as fe,m as me,D as pe,F as ve,E as he,q as ye,o as d,G as ge,z as q,B as O,H as we,x as k,y as E,_ as j}from"./entry.450f3054.js";import xe from"./Header.3dc61caf.js";import ke from"./Plus.aceb4550.js";import be from"./Edit.ddf9bcb4.js";import De from"./Signature.54a7be06.js";import{_ as Ce}from"./client-only.9cf9a7f5.js";import Me from"./Search.9e5665ed.js";import Ae from"./Line.1b5b48df.js";import Le from"./Check.135d567f.js";import{u as H}from"./useMyFetch.e6f412ed.js";import"./_plugin-vue_export-helper.c27b6911.js";const Te=O(()=>j(()=>import("./fin_payment_req_validasi.b00e8b04.js"),["./fin_payment_req_validasi.b00e8b04.js","./HeaderPopup.vue.a23d4aa3.js","./Times.db8d9a46.js","./_plugin-vue_export-helper.c27b6911.js","./entry.450f3054.js","./entry.c5f8f180.css","./useUtils.f22d17c7.js","./useMyFetch.e6f412ed.js"],import.meta.url).then(f=>f.default||f)),ze=O(()=>j(()=>import("./fin_payment_req.c23052e2.js"),["./fin_payment_req.c23052e2.js","./entry.450f3054.js","./entry.c5f8f180.css","./HeaderPopup.vue.a23d4aa3.js","./Times.db8d9a46.js","./_plugin-vue_export-helper.c27b6911.js","./Plus.aceb4550.js","./Send.2f52be9f.js","./CloudDownload.793f098d.js","./useUtils.f22d17c7.js","./useMyFetch.e6f412ed.js"],import.meta.url).then(f=>f.default||f)),Re={class:"w-full h-full flex flex-col"},Se={class:"w-full flex grow flex-col overflow-auto h-0"},Ve={class:"w-full flex"},$e={action:"#",class:"w-full flex"},Pe={class:"w-full p-1 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col"},Ye=e("div",{class:"font-bold"}," Tgl Dari ",-1),Be={class:"text-red-500"},Fe={class:"w-full p-1 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col"},Ie=e("div",{class:"font-bold"}," Tgl Sampai ",-1),qe={class:"text-red-500"},Ee={class:"grow p-1"},He=e("div",{class:"font-bold"}," Keyword ",-1),Oe={class:"flex items-end p-1"},je={class:"w-full flex justify-center items-center grow h-0 p-1"},Ne={key:0,class:""},Ue={class:"tacky"},Je=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App"),e("th",null,"ID"),e("th",null,"Status"),e("th",null,"Batch no"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),Ke=["onClick"],Ge={class:"flex items-center justify-center"},Ze={class:"bold"},Qe={class:"bold"},We={class:"bold"},ct={__name:"index",async setup(f){let y,L;const{$moment:g}=we(),n={};n._TimeZoneOffset=new Date().getTimezoneOffset(),n.sort="created_at:desc";const T=re("token"),{data:N}=([y,L]=ie(async()=>ye(async()=>{let t=[];k().loading_full=!0;const{data:a,error:v,status:M}=await H("/fin_payment_reqs",{method:"get",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},params:n,retry:0});return k().loading_full=!1,M.value==="error"?(E().trigger(v),{fin_payment_reqs:t}):(t=a.value.data,{fin_payment_reqs:t})},{lazy:!0,server:!1,default:()=>({fin_payment_reqs:[]})},"$u2BOcRLizp")),y=await y,L(),y),i=l([]);B(()=>{var t;return(t=N.value)==null?void 0:t.fin_payment_reqs},t=>{t&&(i.value=[...t])},{immediate:!0});const m=l(""),b=l({field:"created_at",by:"desc"}),p=l(-1),r=l({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),z=l({}),_=l({from:"",to:""}),U=()=>{n.like="",m.value!=""&&(n.like=`id:%${m.value}%,status:%${m.value}%`),n.sort="",b.value.field&&(n.sort=b.value.field+":"+b.value.by),n.date_from=_.value.from?g(_.value.from).format("YYYY-MM-DD"):"",n.date_to=_.value.to?g(_.value.to).format("YYYY-MM-DD"):""},w=l(null),R=async()=>{k().loading_full=!0,r.value.may_get_data=!1,n.page=r.value.page,n.page==1&&(i.value=[]),n.first_row&&delete n.first_row,n.page>1&&(n.first_row=JSON.stringify(i.value[0]));const{data:t,error:a,status:v}=await H("/fin_payment_reqs",{method:"get",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},params:n,retry:0});if(k().loading_full=!1,r.value.may_get_data=!0,v.value==="error"){E().trigger(a);return}r.value.page==1?(i.value=t.value.data,w.value&&(w.value.scrollTop=0)):r.value.page>1&&(i.value=[...i.value,...t.value.data]),t.value.data.length==0&&(r.value.is_last_record=!0)},J=async()=>{if(!r.value.may_get_data)return;let t=w.value;if(t.scrollLeft!=r.value.scrollLeft){r.value.scrollLeft=t.scrollLeft;return}r.value.is_last_record||!(Math.round(t.scrollTop)+t.clientHeight>=t.scrollHeight-1)||(r.value.page++,await R())},K=()=>{r.value.page=1,r.value.is_last_record=!1,U(),R()};ue();const x=l(!1),D=l(0),G=l(0),Z=()=>{D.value=0,x.value=!0,G.value=!1},{display:S}=F();_e(F());const Q=()=>{p.value==-1?S({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(D.value=i.value[p.value].id,x.value=!0)},C=l(!1),V=l(0),W=()=>{p.value==-1?S({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(V.value=i.value[p.value].id,C.value=!0)},$=l(!1);l({}),l(!1);const X=l("");return B(()=>X.value,t=>{t.trim().length>0?$.value=!0:$.value=!1},{immediate:!1}),(t,a)=>{const v=xe,M=ke,ee=be,te=De,P=ce("vue-date-picker"),Y=Ce,ae=Me,oe=Ae,se=Le,le=Te,ne=ze;return d(),h("div",Re,[u(v,{title:"List Payment Req"}),e("div",Se,[e("div",Ve,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:a[0]||(a[0]=o=>Z())},[u(M)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:a[1]||(a[1]=o=>Q())},[u(ee)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:a[2]||(a[2]=o=>W())},[u(te)])]),e("form",$e,[e("div",Pe,[Ye,u(Y,null,{default:I(()=>[u(P,{modelValue:s(_).from,"onUpdate:modelValue":a[3]||(a[3]=o=>s(_).from=o),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"",class:"flex-grow"},null,8,["modelValue"])]),_:1}),e("p",Be,c(s(z).date_from),1)]),e("div",Fe,[Ie,u(Y,null,{default:I(()=>[u(P,{modelValue:s(_).to,"onUpdate:modelValue":a[4]||(a[4]=o=>s(_).to=o),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"",class:"flex-grow"},null,8,["modelValue"])]),_:1}),e("p",qe,c(s(z).date_to),1)]),e("div",Ee,[He,de(e("input",{class:"",type:"text","onUpdate:modelValue":a[5]||(a[5]=o=>me(m)?m.value=o:null),name:"search",placeholder:"Keyword"},null,512),[[fe,s(m)]])]),e("div",Oe,[e("button",{class:"",type:"submit",name:"button",onClick:a[6]||(a[6]=pe(o=>K(),["prevent"]))},[u(ae,{class:"text-2xl"})])])]),e("div",je,[s(i).length==0?(d(),h("div",Ne," Maaf Tidak Ada Record ")):(d(),h("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:w,onScroll:J},[e("table",Ue,[Je,e("tbody",null,[(d(!0),h(ve,null,he(s(i),(o,A)=>(d(),h("tr",{key:A,onClick:Xe=>p.value=A,class:ge(s(p)==A?"active":"")},[e("td",null,[e("div",Ge,[o.val?(d(),q(se,{key:1})):(d(),q(oe,{key:0}))])]),e("td",Ze,c(o.id),1),e("td",Qe,c(o.status),1),e("td",We,c(o.batch_no),1),e("td",null,c(o.created_at?s(g)(o.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,c(o.updated_at?s(g)(o.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,Ke))),128))])])],544))])]),u(le,{show:s(C),fnClose:()=>{C.value=!1},id:s(V),p_data:s(i)},null,8,["show","fnClose","id","p_data"]),u(ne,{show:s(x),fnClose:()=>{x.value=!1},id:s(D),p_data:s(i)},null,8,["show","fnClose","id","p_data"])])}}};export{ct as default};
