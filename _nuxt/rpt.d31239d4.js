import ue from"./Header.594d027b.js";import ce from"./Plus.832cb343.js";import de from"./Edit.e71afca3.js";import _e from"./Signature.ff0936ed.js";import fe from"./Table2Column.668ff8ed.js";import me from"./TableUp.b82be287.js";import pe from"./Line.f78d58e1.js";import ve from"./Check.64c6b8d9.js";import{_ as he}from"./PopupMini.vue.f2b8b594.js";import ye from"./rpt_salary.7842ec95.js";import ge from"./rpt_salary_validasi.8ecc0c02.js";import ke from"./rpt_salary_check.41c4ff7f.js";import{g as we,h as xe,r as l,B as be,j as R,s as Ce,f as De,c as _,b as f,a as o,l as t,n as y,F as Ae,D as $e,w as Se,q as Te,x as m,y as g,o as i,E as Me,z as j,t as A,d as Fe,k as Pe,A as Be,m as Ee,G as Le}from"./entry.78fbd343.js";import{u as E}from"./useUtils.18429599.js";import{u as k}from"./useMyFetch.16701d1d.js";import{u as Ue}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.145a34cc.js";import"./Exclamation.db620b02.js";import"./HeaderPopup.vue.80939380.js";import"./client-only.78ecc580.js";import"./Refresh.62aa464f.js";const ze={class:"w-full h-full flex flex-col"},Ie={class:"w-full flex grow flex-col overflow-auto h-0"},Re={class:"w-full flex"},je={class:"w-full flex justify-center items-center grow h-0 p-1"},Ne={key:0,class:""},He={class:"tacky"},Oe=o("thead",null,[o("tr",{class:"sticky top-0 !z-[2]"},[o("th",null,"Logistik"),o("th",null,"ID"),o("th",null,"Period End"),o("th",null,"Created At"),o("th",null,"Updated At")])],-1),Ve=["onClick"],Ye={class:"flex items-center justify-center"},Je={class:"bold"},qe={class:"grow mb-5"},gt={__name:"rpt",async setup(Ge){let w,L;const{$moment:$}=Le(),d={};d._TimeZoneOffset=new Date().getTimezoneOffset(),d.sort="created_at:desc";const p=we("token"),{data:N}=([w,L]=xe(async()=>Te(async()=>{let e=[];m().loading_full=!0;const{data:a,error:c,status:h}=await k("/rpt_salarys",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:d,retry:0});return m().loading_full=!1,h.value==="error"?(g().trigger(c),{rpt_salarys:e}):(e=a.value.data,{rpt_salarys:e})},"$fWJlXxIgiP")),w=await w,L(),w),s=l(N.value.rpt_salarys);l(""),l({field:"created_at",by:"desc"});const n=l(-1),u=l({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),x=l(null),H=async()=>{m().loading_full=!0,u.value.may_get_data=!1,d.page=u.value.page,d.page==1&&(s.value=[]),d.first_row&&delete d.first_row,d.page>1&&(d.first_row=JSON.stringify(s.value[0]));const{data:e,error:a,status:c}=await k("/rpt_salarys",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:d,retry:0});if(m().loading_full=!1,u.value.may_get_data=!0,c.value==="error"){g().trigger(a);return}u.value.page==1?(s.value=e.value.data,x.value&&(x.value.scrollTop=0)):u.value.page>1&&(s.value=[...s.value,...e.value.data]),e.value.data.length==0&&(u.value.is_last_record=!0)},O=async()=>{if(!u.value.may_get_data)return;let e=x.value;if(e.scrollLeft!=u.value.scrollLeft){u.value.scrollLeft=e.scrollLeft;return}u.value.is_last_record||!(Math.round(e.scrollTop)+e.clientHeight>=e.scrollHeight-1)||(u.value.page++,await H())};be();const b=l(!1),S=l(0),C=l(0),V=()=>{S.value=0,b.value=!0,C.value=!1},{display:T}=R();Ce(R());const Y=()=>{n.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(S.value=s.value[n.value].id,b.value=!0,C.value=!1)},M=l(!1),U=l(0),J=()=>{n.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(U.value=s.value[n.value].id,C.value=!0,M.value=!0)},F=l(!1),q=l({}),D=l(!1),v=l(""),G=async()=>{D.value&&(D.value=!1)};De(()=>v.value,e=>{e.trim().length>0?F.value=!0:F.value=!1},{immediate:!1});const W=async()=>{m().loading_full=!0;const e=new FormData;e.append("id",s.value[n.value].id),e.append("deleted_reason",v.value),e.append("_method","DELETE");const{data:a,error:c,status:h}=await k("/rpt_salary",{method:"post",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},body:e,retry:0});if(m().loading_full=!1,h.value==="error"){g().trigger(c);return}s.value.splice(n.value,1),n.value=-1,D.value=!1},{downloadFile:z,viewFile:We}=Ue();l(!1),l({});const X=async()=>{m().loading_full=!0;const{data:e,error:a,status:c}=await k("/rpt_salary/excel_download",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:{id:s.value[n.value].id},retry:0});if(m().loading_full=!1,c.value==="error"){g().trigger(a);return}z(e.value)},Z=async()=>{m().loading_full=!0;const{data:e,error:a,status:c}=await k("/rpt_salary/excel_download2",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:{id:s.value[n.value].id},retry:0});if(m().loading_full=!1,c.value==="error"){g().trigger(a);return}z(e.value)},I=l(0),P=l(!1),K=()=>{n.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(I.value=s.value[n.value].id,P.value=!0)};return(e,a)=>{const c=ue,h=ce,Q=de,ee=_e,te=fe,ae=me,oe=pe,le=ve,se=he,ne=ye,re=ge,ie=ke;return i(),_("div",ze,[f(c,{title:"List Salary Paid"}),o("div",Ie,[o("div",Re,[("useUtils"in e?e.useUtils:t(E))().checkPermission("rpt_salary.create")?(i(),_("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[0]||(a[0]=r=>V())},[f(h)])):y("",!0),("useUtils"in e?e.useUtils:t(E))().checkPermissions(["rpt_salary.modify"])?(i(),_("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[1]||(a[1]=r=>Y())},[f(Q)])):y("",!0),("useUtils"in e?e.useUtils:t(E))().checkPermissions(["rpt_salary.val1","rpt_salary.val2","rpt_salary.val3"])?(i(),_("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[2]||(a[2]=r=>J())},[f(ee)])):y("",!0),t(n)>-1&&t(s)[t(n)].val1==1?(i(),_("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[3]||(a[3]=r=>X())},[f(te)])):y("",!0),t(n)>-1&&t(s)[t(n)].val1==1?(i(),_("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[4]||(a[4]=r=>Z())},[f(ae)])):y("",!0),o("button",{type:"button",name:"button",class:"m-1 text-xs whitespace-nowrap",onClick:a[5]||(a[5]=r=>K())}," Check Nilai ")]),o("div",je,[t(s).length==0?(i(),_("div",Ne," Maaf Tidak Ada Record ")):(i(),_("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:x,onScroll:O},[o("table",He,[Oe,o("tbody",null,[(i(!0),_(Ae,null,$e(t(s),(r,B)=>(i(),_("tr",{key:B,onClick:Xe=>n.value=B,class:Me(t(n)==B?"active":"")},[o("td",null,[o("div",Ye,[r.val1?(i(),j(le,{key:1})):(i(),j(oe,{key:0}))])]),o("td",Je,A(r.id),1),o("td",null,A(r.period_end?t($)(r.period_end).format("MM-Y"):""),1),o("td",null,A(r.created_at?t($)(r.created_at).format("DD-MM-Y HH:mm:ss"):""),1),o("td",null,A(r.updated_at?t($)(r.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,Ve))),128))])])],544))])]),f(se,{type:"delete",show:t(D),data:t(q),fnClose:G,fnConfirm:W,enabledOk:t(F)},{footer:Se(()=>[Fe(" Masukkan Alasan Penghapusan: "),o("div",qe,[Pe(o("textarea",{"onUpdate:modelValue":a[6]||(a[6]=r=>Ee(v)?v.value=r:null)},null,512),[[Be,t(v)]])])]),_:1},8,["show","data","enabledOk"]),f(ne,{show:t(b),fnClose:()=>{b.value=!1},id:t(S),p_data:t(s),is_copy:t(C)},null,8,["show","fnClose","id","p_data","is_copy"]),f(re,{show:t(M),fnClose:()=>{M.value=!1},id:t(U),p_data:t(s)},null,8,["show","fnClose","id","p_data"]),f(ie,{show:t(P),fnClose:()=>{P.value=!1},id:t(I)},null,8,["show","fnClose","id"])])}}};export{gt as default};
