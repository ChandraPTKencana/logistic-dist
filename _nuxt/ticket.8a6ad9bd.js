import{g as je,r as _,f as pe,h as ct,i as F,C as pt,j as Pe,s as ft,x as c,J as vt,c as x,b as i,a as s,k as fe,v as mt,l as n,m as ve,n as T,d as v,w as f,F as kt,E as bt,q as yt,y as S,o as m,z as B,t as D,G as ht,A as gt,K as xt,B as U,I as wt,H as Dt,_ as Y}from"./entry.f7e5e777.js";import Ct from"./Header.56d047f0.js";import Tt from"./Edit.49c4f705.js";import $t from"./Eyes.94aa27bc.js";import At from"./Void.b5ce2c45.js";import St from"./Signature.298edfd3.js";import Mt from"./SignatureOff.f894d47d.js";import jt from"./Table2Column.06f8495d.js";import Pt from"./Cog.a045546b.js";import Bt from"./Image.a3e22915.js";import zt from"./Line.8a8bbcd9.js";import Ft from"./Check.19ae7820.js";import Nt from"./TableView.e8d796ff.js";import Et from"./Times.8ca04ec0.js";import{_ as Ot}from"./client-only.9f1c7306.js";import{_ as Vt}from"./SelectMulti.vue.7da34db9.js";import{u as j}from"./useUtils.5b6922fd.js";import{u as $}from"./useMyFetch.4b536cbd.js";import{u as qt}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.8bc0c4e5.js";import"./Adjust.1b6e3e1e.js";import"./TableHeaderEye.4f0d2ab4.js";import"./ClearAll.b91160a0.js";import"./ClearEach.cdce4923.js";import"./CaretLeftDoubleBold.ab0f65f2.js";import"./CaretLeftBold.05e3e4fc.js";import"./CaretRightBold.c44aab47.js";import"./CaretRightDoubleBold.4e5f2593.js";const It=U(()=>Y(()=>import("./PopupMini.0a0cbd7a.js"),["./PopupMini.0a0cbd7a.js","./PopupMini.vue.363d6d9f.js","./Times.8ca04ec0.js","./_plugin-vue_export-helper.c27b6911.js","./entry.f7e5e777.js","./entry.c5f8f180.css","./Exclamation.3decaf82.js"],import.meta.url).then(g=>g.default||g)),Ut=U(()=>Y(()=>import("./trx_trp_ticket.b8e0dd3a.js"),["./trx_trp_ticket.b8e0dd3a.js","./HeaderPopup.vue.bb2a590e.js","./Times.8ca04ec0.js","./_plugin-vue_export-helper.c27b6911.js","./entry.f7e5e777.js","./entry.c5f8f180.css","./client-only.9f1c7306.js","./InputPointFormat.vue.fab798fb.js","./useUtils.5b6922fd.js","./useMyFetch.4b536cbd.js"],import.meta.url).then(g=>g.default||g)),Yt=U(()=>Y(()=>import("./trx_trp_ticket_validasi.3575af74.js"),["./trx_trp_ticket_validasi.3575af74.js","./HeaderPopup.vue.bb2a590e.js","./Times.8ca04ec0.js","./_plugin-vue_export-helper.c27b6911.js","./entry.f7e5e777.js","./entry.c5f8f180.css","./useUtils.5b6922fd.js","./useMyFetch.4b536cbd.js"],import.meta.url).then(g=>g.default||g)),Lt=U(()=>Y(()=>import("./trx_absen.b4e556f8.js"),["./trx_absen.b4e556f8.js","./HeaderPopup.vue.bb2a590e.js","./Times.8ca04ec0.js","./_plugin-vue_export-helper.c27b6911.js","./entry.f7e5e777.js","./entry.c5f8f180.css","./Check.19ae7820.js","./PopupMini.vue.363d6d9f.js","./Exclamation.3decaf82.js","./useUtils.5b6922fd.js","./useMyFetch.4b536cbd.js"],import.meta.url).then(g=>g.default||g)),Ht=U(()=>Y(()=>import("./trx_trp_ticket_over.2851afce.js"),["./trx_trp_ticket_over.2851afce.js","./HeaderPopup.vue.bb2a590e.js","./Times.8ca04ec0.js","./_plugin-vue_export-helper.c27b6911.js","./entry.f7e5e777.js","./entry.c5f8f180.css","./Refresh.d1ae585c.js","./useMyFetch.4b536cbd.js"],import.meta.url).then(g=>g.default||g)),Rt={class:"w-full h-full flex flex-col"},Jt={class:"w-full flex grow flex-col overflow-auto h-0"},Kt={class:"w-full flex justify-between flex-wrap"},Gt={class:"grow flex"},Xt={class:"m-1"},Zt=wt('<option value="ticket_not_done">Undone</option><option value="ticket_done">Done</option><option value="deleted">Trash</option><option value="all">All</option><option value="req_deleted">Req Delete</option>',5),Qt=[Zt],Wt=s("span",{class:"text-xs ml-1"}," Download ",-1),ea={class:"flex"},ta={class:"relative z-[1]"},aa=s("b",null,"tidak dapat dibatalkan lagi",-1),la={class:"grow mb-5"},oa=s("b",{class:"text-red-500"},"dibersihkan",-1),sa=s("b",{class:"text-red-500"},"divalidasi",-1),na=s("b",{class:"text-red-500"},"di unvalidasi",-1),ra={key:0,class:"w-full h-full flex items-center justify-center fixed top-0 left-0 z-20 p-3",style:{"background-color":"rgba(255,255,255,0.9)"}},ia={class:"relative",style:{width:"95%",height:"90%"}},_a={class:"absolute -top-7 right-0 bg-white",style:{position:"absolute",padding:"5px 10px",border:"solid 1px #ccc","border-bottom":"none","border-top-right-radius":"5px","border-top-left-radius":"5px"}},ua={class:"w-full h-full flex flex-col items-center justify-content-center bg-white"},da={class:"w-full p-1"},ca={class:"w-full p-1 bg-gray-200"},pa=s("div",{class:"w-full text-blue-600 font-bold"}," Set Date For Load Data ",-1),fa={class:"w-full grid grid-cols-2 grid-rows-1 gap-1"},va={class:"flex flex-col flex-wrap p-1"},ma=s("label",{for:""},"From",-1),ka={class:"grow"},ba={class:"flex flex-col flex-wrap p-1"},ya=s("label",{for:""},"To",-1),ha={class:"grow"},ga={key:1,class:"w-full h-full flex items-center justify-center fixed top-0 left-0 z-10 p-3",style:{"background-color":"rgba(255,255,255,0.9)"}},xa={class:"relative",style:{border:"solid 1px #ccc"}},wa={class:"absolute -top-7 right-0 bg-white",style:{position:"absolute",padding:"5px 10px",border:"solid 1px #ccc","border-bottom":"none","border-top-right-radius":"5px","border-top-left-radius":"5px"}},Da={class:"w-full h-full flex flex-col items-center justify-content-center bg-white"},Ca={class:"w-full p-1"},Ta={class:"w-full p-1"},$a=s("div",{class:"w-full text-gray-600 font-bold text-center"}," Set Mobil Yang Tidak Di Izinkan Untuk Di Update Tiketnya ",-1),Aa={class:"w-full flex my-2"},Sa=s("div",{class:"text-gray-600"}," Data Luar: ",-1),Ma={class:"flex mx-2"},ja={class:"flex cursor-pointer"},Pa=["value"],Ba={class:"w-full"},za={class:"w-full grid grid-cols-2 gap-1 p-1 mt-5"},dl={__name:"ticket",async setup(g){let L,me;const{$moment:N}=Dt(),{pointFormat:ke}=j(),be=e=>e.deleted==1?"!bg-red-400":e.req_deleted==1?"!bg-yellow-300":e.val_ticket==1?"!bg-blue-300":"",te=e=>(e.map(t=>{t.class_h=be(t)}),e),Be=je("company_code"),H=_([]);let R=_({clearCheckBox:!1});const M=_("ticket_not_done");pe(()=>M.value,e=>{we()},{immediate:!1});const k={};k._TimeZoneOffset=new Date().getTimezoneOffset(),k.sort="tanggal:desc";const ye=_({}),J=_({from:"",to:""}),C=je("token"),{data:ae}=([L,me]=ct(async()=>yt(async()=>{c().loading_full=!0;let e=[],t=[],d=[];const[b,l,p]=await Promise.all([$("/trx_trp_tickets",{method:"get",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},params:{filter_status:M},retry:0}),$("/vehicles_available",{method:"get",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},retry:0}),$("/temp_data/vehiclesAllowedUpdateTicket",{method:"get",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},retry:0})]);return b.status.value!=="error"&&(e=te(b.data.value.data)),b.status.value==="error"?(S().trigger(b.error),{trx_trps:e}):(l.status.value!=="error"&&(t=l.data.value.data),p.status.value!=="error"&&(d=p.data.value.data),c().loading_full=!1,{trx_trps:e,list_vehicle:t,vehicles_allowed:d})},{lazy:!0,server:!1,default:()=>({trx_trps:[],list_vehicle:[],vehicles_allowed:[]})},"$X4xCu6yBOs")),L=await L,me(),L),r=_([]);pe(()=>{var e;return(e=ae.value)==null?void 0:e.trx_trps},e=>{e&&(r.value=[...e])},{immediate:!0});const le=_([]);pe(()=>{var e;return(e=ae.value)==null?void 0:e.list_vehicle},e=>{e&&e.forEach(t=>{le.value.push({id:t.id,name:t.no_pol,title:"",checked:ae.value.vehicles_allowed.indexOf(t.id)>-1})})},{immediate:!0});const he=_([]),ze=async(e,t="")=>{c().loading_full=!0;let d=h.value.from?N(h.value.from).format("Y-MM-DD"):"",b=h.value.to?N(h.value.to).format("Y-MM-DD"):"";const{data:l,error:p,status:o}=await $("/trx_load_for_trp",{method:"get",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},params:{jenis:e,from:d,to:b,transition_target:t},retry:0});if(c().loading_full=!1,o.value==="error"){S().trigger(p);return}he.value=l.value.list_ticket},oe=_({field:"tanggal",by:"desc"}),u=_(-1),w=F(()=>r.value[u.value]),A=_({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),ge=()=>{k.like="";let e=JSON.parse(JSON.stringify(c()._tv.global_keyword));e!=""&&(k.like=`id:%${e}%,xto:%${e}%,jenis:%${e}%,pv_no:%${e}%,ticket_a_no:%${e}%,ticket_b_no:%${e}%,no_pol:%${e}%,supir:%${e}%,kernet:%${e}%,cost_center_code:%${e}%,cost_center_desc:%${e}%,pvr_no:%${e}%,tanggal:%${e}%,transition_target:%${e}%,uj_asst_opt:%${e}%`),k.sort="",oe.value.field&&(k.sort=oe.value.field+":"+oe.value.by),k.date_from=J.value.from?N(J.value.from).format("YYYY-MM-DD"):"",k.date_to=J.value.to?N(J.value.to).format("YYYY-MM-DD"):"",k.filter_model=JSON.stringify(c()._tv.filter_model)},xe=async()=>{c().loading_full=!0,ye.value={},A.value.may_get_data=!1,k.page=A.value.page,k.page==1&&(r.value=[]),k.first_row&&delete k.first_row,k.page>1&&(k.first_row=JSON.stringify(r.value[0])),k.filter_status=M.value;const{data:e,error:t,status:d}=await $("/trx_trp_tickets",{method:"get",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},params:k,retry:0});if(c().loading_full=!1,A.value.may_get_data=!0,d.value==="error"){S().trigger(t,ye);return}A.value.page==1?r.value=te(e.value.data):A.value.page>1&&(r.value=[...r.value,...te(e.value.data)]),e.value.data.length==0&&(A.value.is_last_record=!0),c()._tv.filter_box=!1},we=()=>{u.value=-1,A.value.page=1,A.value.is_last_record=!1,ge(),xe()};pt();const se=_(!1),De=_(0),{display:z}=Pe();ft(Pe());const E=_(1),Fe=()=>{u.value==-1?z({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(De.value=r.value[u.value].id,E.value=-1,se.value=!0)},O=_(!1),K=_(0),Ne=()=>{u.value==-1?z({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(K.value=r.value[u.value].id,E.value=1,O.value=!0)},Ee=()=>{u.value==-1?z({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(K.value=r.value[u.value].id,E.value=0,O.value=!0)},Oe=()=>{u.value==-1?z({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(K.value=r.value[u.value].id,E.value=-1,O.value=!0)},ne=_(!1),Ce=_(0),Ve=e=>{Ce.value=e,ne.value=!0},Te=_({}),V=_(!1),qe=_(""),Ie=async()=>{V.value&&(V.value=!1)},G=_(!1),X=_(!1),Z=_(!1),q=_(""),Ue=()=>{var e;u.value==-1?z({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(qe.value="",q.value="",Te.value={id:r.value[u.value].id,"no pol":r.value[u.value].no_pol,tujuan:r.value[u.value].xto,permintaan:(e=r.value[u.value].req_deleted_by)==null?void 0:e.username,alasan:r.value[u.value].req_deleted_reason},V.value=!0)},Ye=async()=>{c().loading_full=!0;const e=new FormData;e.append("id",r.value[u.value].id),e.append("_method","DELETE"),e.append("reason_adder",q.value);const{data:t,error:d,status:b}=await $("/trx_trp_approve_req_delete",{method:"post",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},body:e,retry:0});if(c().loading_full=!1,b.value==="error"){S().trigger(d);return}let l={...r.value[u.value]};l.deleted=t.value.deleted,l.deleted_user=t.value.deleted_user,l.deleted_at=t.value.deleted_at,l.deleted_by=t.value.deleted_by,l.deleted_reason=t.value.deleted_reason,l.class_h=be(l),M.value!="all"?r.value.splice(u.value,1):r.value.splice(u.value,1,{...l}),u.value=-1,V.value=!1},Le=async()=>{c().loading_full=!0;const e=new FormData;e.append("ids",JSON.stringify(P.value)),e.append("_method","PUT");const{data:t,error:d,status:b}=await $("/trx_trp_val_tickets",{method:"post",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},body:e,retry:0});if(c().loading_full=!1,b.value==="error"){S().trigger(d);return}X.value=!1,t.value.val_lists.forEach(l=>{let p=r.value.map(o=>o.id).indexOf(l.id);if(p>-1){let o=r.value[p];o.val_ticket=l.val_ticket,o.val_ticket_by=l.val_ticket_by,o.val_ticket_at=l.val_ticket_at,o.updated_at=l.updated_at,r.value.splice(p,1,{...o})}}),R.value.clearCheckBox=!0},He=async()=>{c().loading_full=!0;const e=new FormData;e.append("ids",JSON.stringify(P.value)),e.append("_method","PUT");const{data:t,error:d,status:b}=await $("/trx_trp_unval_tickets",{method:"post",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},body:e,retry:0});if(c().loading_full=!1,b.value==="error"){S().trigger(d);return}Z.value=!1,t.value.val_lists.forEach(l=>{let p=r.value.map(o=>o.id).indexOf(l.id);if(p>-1){let o=r.value[p];o.val_ticket=l.val_ticket,o.val_ticket_by=l.val_ticket_by,o.val_ticket_at=l.val_ticket_at,o.updated_at=l.updated_at,r.value.splice(p,1,{...o})}}),R.value.clearCheckBox=!0},Re=async()=>{c().loading_full=!0;const e=new FormData;e.append("ids",JSON.stringify(P.value)),e.append("_method","PUT");const{data:t,error:d,status:b}=await $("/trx_trp_clear_tickets",{method:"post",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},body:e,retry:0});if(c().loading_full=!1,b.value==="error"){S().trigger(d);return}G.value=!1,t.value.clear_lists.forEach(l=>{let p=r.value.map(o=>o.id).indexOf(l.id);if(p>-1){let o=r.value[p];o.ticket_a_id=l.ticket_a_id,o.ticket_a_no=l.ticket_a_no,o.ticket_b_id=l.ticket_b_id,o.ticket_b_no=l.ticket_b_no,o.updated_at=l.updated_at,r.value.splice(p,1,{...o})}}),R.value.clearCheckBox=!0},re=_(!1),Je=e=>{re.value=!0},Q=_(!1),h=_({from:new Date().setDate(new Date().getDate()-3),to:new Date}),$e=e=>{e=="from"?h.value.from-h.value.to>0&&(h.value.from=h.value.to):h.value.to-h.value.from<0&&(h.value.to=h.value.from)},Ke=async()=>{c().loading_full=!0;const e=new FormData;e.append("vehicles",JSON.stringify(le.value.filter(l=>l.checked).map(l=>l.id))),e.append("pabriks",JSON.stringify(H.value));const{data:t,error:d,status:b}=await $("/trx_trp_do_update_ticket",{method:"post",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},body:e,retry:0});if(c().loading_full=!1,b.value==="error"){S().trigger(d);return}t.value.data.forEach(l=>{let p=r.value.map(o=>o.id).indexOf(l.id);if(p!==-1){let o=r.value[p];o.ticket_a_id=l.ticket_a_id,o.ticket_a_no=l.ticket_a_no,o.ticket_a_bruto=l.ticket_a_bruto,o.ticket_a_tara=l.ticket_a_tara,o.ticket_a_netto=l.ticket_a_netto,o.ticket_a_supir=l.ticket_a_supir,o.ticket_a_no_pol=l.ticket_a_no_pol,o.ticket_a_in_at=l.ticket_a_in_at,o.ticket_a_out_at=l.ticket_a_out_at,o.ticket_b_id=l.ticket_b_id,o.ticket_b_no=l.ticket_b_no,o.ticket_b_bruto=l.ticket_b_bruto,o.ticket_b_tara=l.ticket_b_tara,o.ticket_b_netto=l.ticket_b_netto,o.ticket_b_supir=l.ticket_b_supir,o.ticket_b_no_pol=l.ticket_b_no_pol,o.ticket_b_in_at=l.ticket_b_in_at,o.ticket_b_out_at=l.ticket_b_out_at,o.updated_at=l.updated_at,r.value.splice(p,1,{...o})}}),z({show:!0,status:"Success",message:"Update PV Done"})},P=_([]),Ge=_([{key:"cb",label:"",checkbox:"id"},{key:"no",label:"No",isai:!0},{key:"val_ticket",label:"Logistik",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"id",label:"ID",filter_on:1,type:"number",sort:{priority:1,type:"desc"}},{key:"status_batas_susut",label:"Batas Susut",type:"string"},{key:"tanggal",label:"U.Jalan Per",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"no_pol",label:"No Pol",freeze:1,filter_on:1,type:"string"},{key:"xto",label:"Tujuan",filter_on:1,type:"string"},{key:"uj_asst_opt",label:"Info",filter_on:1,type:"select",select_item:["DENGAN KERNET","TANPA KERNET"]},{key:"tipe",label:"Tipe",filter_on:1,type:"string"},{key:"jenis",label:"Jenis",filter_on:1,type:"string"},{key:"amount",label:"Amount",class:" justify-end",filter_on:1,type:"number"},{key:"transition",label:"Peralihan",childs:[{key:"transition_type",label:"Type",type:"select",filter_on:1,select_item:["To","From"]},{key:"transition_target",label:"Target",type:"select",filter_on:1,select_item:c().list_pabrik}]},{key:"ticket_a",label:"Ticket A",childs:[{key:"ticket_a_no",label:"No",filter_on:1,type:"string"},{key:"ticket_a_bruto",label:"Bruto",filter_on:1,type:"number"},{key:"ticket_a_tara",label:"Tara",filter_on:1,type:"number"},{key:"ticket_a_netto",label:"Netto",filter_on:1,type:"number"},{key:"ticket_a_supir",label:"Supir",filter_on:1,type:"string"},{key:"ticket_a_no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"ticket_a_in_at",label:"In At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"ticket_a_out_at",label:"Out At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1}]},{key:"ticket_b",label:"Ticket B",childs:[{key:"ticket_b_no",label:"No",filter_on:1,type:"string"},{key:"ticket_b_bruto",label:"Bruto",filter_on:1,type:"number"},{key:"ticket_b_tara",label:"Tara",filter_on:1,type:"number"},{key:"ticket_b_netto",label:"Netto",filter_on:1,type:"number"},{key:"ticket_b_supir",label:"Supir",filter_on:1,type:"string"},{key:"ticket_b_no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"ticket_b_in_at",label:"In At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"ticket_b_out_at",label:"Out At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1}]},{key:"susut",label:"Susut",childs:[{key:"susut_bruto",label:"Bruto",childs:[{key:"susut_bruto_b_a",label:"Selisih"},{key:"susut_bruto_b_a_persen",label:"%"}]},{key:"susut_tara",label:"Tara",childs:[{key:"susut_tara_b_a",label:"Selisih"},{key:"susut_tara_b_a_persen",label:"%"}]},{key:"susut_netto",label:"Netto",childs:[{key:"susut_netto_b_a",label:"Selisih"},{key:"susut_netto_b_a_persen",label:"%"}]}]},{key:"salary_paid",label:"Salary Paid",type:"string"},{key:"supir",label:"Supir",filter_on:1,type:"string"},{key:"kernet",label:"Kernet",filter_on:1,type:"string"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"pv_no",label:"PV No",type:"string"},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",dateformat:"DD-MM-Y HH:mm:ss",tbl_show:1,type:"datetime",filter_on:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1},{key:"req_deleted_by_username",label:"Req Deleted By",tbl_show:1},{key:"req_deleted_at",label:"Req Delete At",dateformat:"DD-MM-Y HH:mm:ss",tbl_show:1,type:"datetime",filter_on:1},{key:"req_deleted_reason",label:"Req Delete Reason",tbl_show:1,type:"string",filter_on:1}]),Xe=F(()=>u.value>-1&&j().checkPermission("trp_trx.ticket.view")),Ze=F(()=>u.value>-1&&w.value.deleted==0&&w.value.req_deleted==0&&w.value.val_ticket==0&&j().checkPermission("trp_trx.ticket.modify")),Qe=F(()=>u.value>-1&&w.value.deleted==0&&w.value.req_deleted==0&&w.value.val_ticket==0&&j().checkPermission("trp_trx.ticket.val_ticket")),We=F(()=>u.value>-1&&w.value.deleted==0&&w.value.req_deleted==0&&w.value.val_ticket==1&&j().checkPermission("trp_trx.ticket.unval_ticket")),et=F(()=>u.value>-1&&w.value.deleted==0&&w.value.req_deleted==1&&w.value.val_ticket==0&&j().checkPermission("trp_trx.approve_request_remove")),W=_(!1),ie=(e,t)=>{e=parseFloat(e)||0,t=parseFloat(t)||0;let d=parseFloat(t-e);if((d>0?t:e)==0)return 0;let l=j().round(d/e*100,2);return l<0?"("+Math.abs(l*100)/100+")":l},_e=(e,t)=>{e=parseFloat(e)||0,t=parseFloat(t)||0;let d=parseFloat(t-e);return d<0?"("+ke(Math.abs(d))+")":ke(d)},{downloadFile:tt,viewFile:Fa}=qt(),at=async()=>{ge(),c().loading_full=!0,k.filter_status=M.value;const{data:e,error:t,status:d}=await $("/trx_trp_tickets/download_excel",{method:"get",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},params:k,retry:0});if(c().loading_full=!1,d.value==="error"){S().trigger(t);return}tt(e.value)};return(e,t)=>{const d=Ct,b=Tt,l=$t,p=At,o=St,I=Mt,lt=jt,ot=Pt,st=Bt,ue=zt,de=Ft,nt=Nt,ee=It,rt=Ut,it=Yt,_t=Lt,ut=Ht,Ae=Et,Se=vt("vue-date-picker"),Me=Ot,dt=Vt;return m(),x("div",Rt,[i(d,{title:"List Transaction"}),s("div",Jt,[s("div",Kt,[s("div",Gt,[s("div",Xt,[fe(s("select",{class:"","onUpdate:modelValue":t[0]||(t[0]=a=>ve(M)?M.value=a:null)},Qt,512),[[mt,n(M)]])]),n(Ze)?(m(),x("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=a=>Fe())},[i(b)])):T("",!0),n(Xe)?(m(),x("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=a=>Oe())},[i(l)])):T("",!0),n(et)?(m(),x("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[3]||(t[3]=a=>Ue())},[i(p)])):T("",!0),n(Qe)?(m(),x("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[4]||(t[4]=a=>Ne())},[i(o)])):T("",!0),n(We)?(m(),x("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[5]||(t[5]=a=>Ee())},[i(I)])):T("",!0),s("button",{type:"button",name:"button",class:"m-1 text-2xl flex items-center",onClick:t[6]||(t[6]=a=>at())},[i(lt),v(),Wt])]),s("div",ea,[n(P).length>0&&("useUtils"in e?e.useUtils:n(j))().checkPermission("trp_trx.ticket.unval_ticket")?(m(),x("button",{key:0,type:"button",name:"button",class:"m-1 text-xs whitespace-nowrap grid grid-cols-2",onClick:t[7]||(t[7]=a=>Z.value=!0)},[i(I),i(I),i(I),i(I)])):T("",!0),n(P).length>0?(m(),x("button",{key:1,type:"button",name:"button",class:"m-1 text-xs whitespace-nowrap",onClick:t[8]||(t[8]=a=>G.value=!0)}," Multi Clear Ticket ")):T("",!0),n(P).length>0?(m(),x("button",{key:2,type:"button",name:"button",class:"m-1 text-xs whitespace-nowrap grid grid-cols-2",onClick:t[9]||(t[9]=a=>X.value=!0)},[i(o),i(o),i(o),i(o)])):T("",!0),s("button",{type:"button",name:"button",class:"m-1 text-xs whitespace-nowrap",onClick:t[10]||(t[10]=a=>Je())}," Check Tickets "),s("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[11]||(t[11]=a=>Q.value=!0)},[i(ot)]),s("button",{type:"button",name:"button",class:"m-1 text-xs whitespace-nowrap",onClick:t[12]||(t[12]=a=>W.value=!0)}," Update Ticket ")])]),i(nt,{thead:n(Ge),selected:n(u),onSetSelected:t[13]||(t[13]=a=>u.value=a),tbody:n(r),fnCallData:xe,scrolling:n(A),onSetScrollingPage:t[14]||(t[14]=a=>n(A).page=a),onDoFilter:t[15]||(t[15]=a=>we()),onSetCheckbox:t[16]||(t[16]=a=>P.value=a),deep_state:n(R)},{absen:f(({item:a,index:y})=>[a.trx_absens&&a.trx_absens.length>0?(m(),B(st,{key:0,class:"cursor-pointer",onClick:ce=>Ve(y)},null,8,["onClick"])):T("",!0)]),val:f(({item:a})=>[a.val?(m(),B(de,{key:1})):(m(),B(ue,{key:0}))]),val1:f(({item:a})=>[a.val1?(m(),B(de,{key:1})):(m(),B(ue,{key:0}))]),val_ticket:f(({item:a})=>[a.val_ticket?(m(),B(de,{key:1})):(m(),B(ue,{key:0}))]),uj_asst_opt:f(({item:a})=>{var y;return[v(D((y=a.uj)==null?void 0:y.asst_opt),1)]}),salary_paid:f(({item:a})=>{var y,ce;return[v(D(a.salary_paid?n(N)((y=a.salary_paid)==null?void 0:y.period_end).format("MM-Y")+"["+((ce=a.salary_paid)==null?void 0:ce.period_part)+"]":""),1)]}),susut_bruto_b_a:f(({item:a})=>[v(D(_e(a.ticket_a_bruto,a.ticket_b_bruto)),1)]),susut_tara_b_a:f(({item:a})=>[v(D(_e(a.ticket_a_tara,a.ticket_b_tara)),1)]),susut_netto_b_a:f(({item:a})=>[v(D(_e(a.ticket_a_netto,a.ticket_b_netto)),1)]),susut_bruto_b_a_persen:f(({item:a})=>[v(D(ie(a.ticket_a_bruto,a.ticket_b_bruto)),1)]),susut_tara_b_a_persen:f(({item:a})=>[v(D(ie(a.ticket_a_tara,a.ticket_b_tara)),1)]),susut_netto_b_a_persen:f(({item:a})=>[v(D(ie(a.ticket_a_netto,a.ticket_b_netto)),1)]),status_batas_susut:f(({item:a})=>{var y;return[s("div",{class:ht(["btn p-1 rounded-sm text-white text-xs mr-1 relative",[a.uj&&a.uj.status_batas_susut=="Terisi"?"bg-green-600":"bg-red-500"]])},[s("div",ta,D((y=a.uj)==null?void 0:y.status_batas_susut),1)],2)]}),deleted_by_username:f(({item:a})=>{var y;return[v(D((y=a.deleted_by)==null?void 0:y.username),1)]}),req_deleted_by_username:f(({item:a})=>{var y;return[v(D((y=a.req_deleted_by)==null?void 0:y.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling","deep_state"])]),i(ee,{type:"custome",show:n(V),data:n(Te),fnClose:Ie,fnConfirm:Ye},{words:f(()=>[v(" Data akan diproses dan "),aa,v(", apakah Anda menyetujui permintaan penghapusan data berikut? ")]),footer:f(()=>[v(" Alasan Tambahan: "),s("div",la,[fe(s("textarea",{"onUpdate:modelValue":t[17]||(t[17]=a=>ve(q)?q.value=a:null)},null,512),[[gt,n(q)]])])]),_:1},8,["show","data"]),i(ee,{type:"custome",show:n(G),fnClose:()=>G.value=!1,fnConfirm:Re},{words:f(()=>[v(" Ticket akan "),oa,v(" sesuai dengan data-data yang telah di pilih, yakin untuk melanjutkan ? ")]),_:1},8,["show","fnClose"]),i(ee,{type:"custome",show:n(X),fnClose:()=>X.value=!1,fnConfirm:Le},{words:f(()=>[v(" Ticket akan "),sa,v(" sesuai dengan data-data yang telah di pilih, yakin untuk melanjutkan ? ")]),_:1},8,["show","fnClose"]),i(ee,{type:"custome",show:n(Z),fnClose:()=>Z.value=!1,fnConfirm:He},{words:f(()=>[v(" Ticket akan "),na,v(" sesuai dengan data-data yang telah di pilih, yakin untuk melanjutkan ? ")]),_:1},8,["show","fnClose"]),i(rt,{show:n(se),fnClose:()=>{se.value=!1},fnLoadDBData:ze,id:n(De),p_data:n(r),list_ticket:n(he)},null,8,["show","fnClose","id","p_data","list_ticket"]),i(it,{show:n(O),fnClose:()=>{O.value=!1},id:n(K),p_data:n(r),it_state:n(E)},null,8,["show","fnClose","id","p_data","it_state"]),i(_t,{show:n(ne),fnClose:()=>{ne.value=!1},index:n(Ce),p_data:n(r)},null,8,["show","fnClose","index","p_data"]),i(ut,{show:n(re),fnClose:()=>{re.value=!1}},null,8,["show","fnClose"]),n(Q)?(m(),x("div",ra,[s("div",ia,[s("div",_a,[i(Ae,{style:{color:"black",cursor:"pointer"},onClick:t[18]||(t[18]=a=>Q.value=!1)})]),s("div",ua,[s("div",da,[s("div",ca,[pa,s("div",fa,[s("div",va,[ma,s("div",ka,[i(Me,null,{default:f(()=>[i(Se,{modelValue:n(h).from,"onUpdate:modelValue":t[19]||(t[19]=a=>n(h).from=a),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,clearable:!1,"text-input":"","teleport-center":"",onClosed:t[20]||(t[20]=a=>$e("from"))},null,8,["modelValue"])]),_:1})])]),s("div",ba,[ya,s("div",ha,[i(Me,null,{default:f(()=>[i(Se,{modelValue:n(h).to,"onUpdate:modelValue":t[21]||(t[21]=a=>n(h).to=a),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,clearable:!1,"text-input":"","teleport-center":"",onClosed:t[22]||(t[22]=a=>$e("to"))},null,8,["modelValue"])]),_:1})])])])])])]),s("div",{style:{position:"absolute",top:"12px",right:"98px","background-color":"rgba(255,255,255,0)",width:"37px",height:"36px","z-index":"1",cursor:"pointer"},onClick:t[23]||(t[23]=a=>Q.value=!1)})])])):T("",!0),n(W)?(m(),x("div",ga,[s("div",xa,[s("div",wa,[i(Ae,{style:{color:"black",cursor:"pointer"},onClick:t[24]||(t[24]=a=>W.value=!1)})]),s("div",Da,[s("div",Ca,[s("div",Ta,[$a,s("div",Aa,[Sa,(m(!0),x(kt,null,bt(n(c)().list_pabrik.filter(a=>a!=n(Be)),a=>(m(),x("div",Ma,[s("label",ja,[fe(s("input",{type:"checkbox",value:a,"onUpdate:modelValue":t[25]||(t[25]=y=>ve(H)?H.value=y:null),class:"mr-1"},null,8,Pa),[[xt,n(H)]]),v(" "+D(a),1)])]))),256))]),s("div",Ba,[i(dt,{arr:n(le)},null,8,["arr"]),s("div",za,[s("button",{type:"button",name:"button",class:"bg-blue-500 text-white",onClick:t[26]||(t[26]=a=>Ke())}," Set & Update "),s("button",{type:"button",name:"button",class:"bg-white",onClick:t[27]||(t[27]=a=>W.value=!1)}," Close ")])])])])])])])):T("",!0)])}}};export{dl as default};
