import{_ as U}from"./HeaderPopup.vue.6db44442.js";import{r as w,f as H,G as c,j as O,m as q,J as Q,o as d,c as m,a as t,b as W,t as l,k as s,n as X,v as Z,l as f,d as r,F as I,y as tt,x as st,E as at,A as F,B as z,p as et,e as lt}from"./entry.ee87ecfe.js";import{u as ot}from"./useUtils.52d38825.js";import{u as G}from"./useMyFetch.6728ea6f.js";import{_ as nt}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.3112f93f.js";const i=p=>(et("data-v-4e277087"),p=p(),lt(),p),_t={class:"box-fixed"},rt={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},ut={class:"w-full flex flex-col items-center grow overflow-auto"},it={class:"w-full flex flex-row flex-wrap"},ct={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},pt=i(()=>t("label",{for:""},"Period End",-1)),dt={class:"card-border"},mt={key:0,class:"w-full p-1"},ht=i(()=>t("div",{class:"font-bold"}," Filter Nama ",-1)),vt={key:1,class:"w-full flex p-1 justify-between flex-wrap"},ft={class:"w-full",role:"sticky"},bt={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},yt=i(()=>t("tr",{class:"sticky -top-1 !z-[2]"},[t("td",{colspan:"27",class:"!bg-slate-800 text-white font-bold"}," Detail ")],-1)),wt={class:"sticky top-7 !z-[2]"},xt=i(()=>t("th",{rowspan:"2"},"No",-1)),kt=i(()=>t("th",{rowspan:"2"},"ID",-1)),jt=i(()=>t("th",{rowspan:"2"},"Nama Pekerja",-1)),gt=i(()=>t("th",{rowspan:"2"},"Jabatan",-1)),Ft=i(()=>t("th",{rowspan:"2"},"Tmpt Lahir",-1)),Et=i(()=>t("th",{rowspan:"2"},"Tgl Lahir",-1)),Dt=i(()=>t("th",{rowspan:"2"},"TMK",-1)),Mt=i(()=>t("th",{rowspan:"2"},"No KTP",-1)),St=i(()=>t("th",{rowspan:"2"},"Alamat",-1)),Nt=i(()=>t("th",{rowspan:"2"},"Status",-1)),Ct=i(()=>t("th",{rowspan:"2"},"No Rek",-1)),Bt=i(()=>t("th",{rowspan:"2"},"Nama Bank",-1)),Tt={colspan:"3"},At={class:"text-sm"},Pt={colspan:"3"},Vt={class:"text-sm"},Yt={colspan:"3"},$t={class:"text-sm"},qt={rowspan:"2"},It={class:"text-sm"},zt={rowspan:"2"},Gt={class:"text-sm"},Jt={rowspan:"2"},Lt={class:"text-sm"},Kt={rowspan:"2"},Rt={class:"text-sm"},Ut={rowspan:"2"},Ht={class:"text-sm"},Ot={rowspan:"2"},Qt={class:"text-sm"},Wt={class:"sticky top-[60px] !z-[2]"},Xt={class:"text-sm"},Zt={class:"text-sm"},ts={class:"text-sm"},ss={class:"text-sm"},as={class:"text-sm"},es={class:"text-sm"},ls={class:"text-sm"},os={class:"text-sm"},ns={class:"text-sm"},_s={ref:"to_move"},rs=["data-index"],us={class:"w-full flex items-center justify-end"},is={class:"w-full flex flex-wrap p-3 items-center"},cs=i(()=>t("div",null," Di Validasi oleh : ",-1)),ps={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},ds={key:0},ms={__name:"rpt_salary_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(p){const h=p,{$moment:x}=at(),{pointFormat:n}=ot(),_=w({...{id:-1,name:"",tipe:"",is_transition:!1,amount:0,details:[],val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:"",val3:0,val3_by:{username:""},val3_at:""}}),T=H("token"),A=w({}),P=w(null),u=w([]),J=async()=>{F().loading_full=!0,A.value={};const e=new FormData;let o="post",v=h.id;v==0||(e.append("id",v),e.append("_method","PUT"));const{data:a,error:y,status:K}=await G("/rpt_salary_validasi",{method:o,headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},body:e,retry:0});if(F().loading_full=!1,K.value==="error"){z().trigger(y,A);return}_.value.val1=a.value.val1,_.value.val1_user=a.value.val1_user,_.value.val1_by=a.value.val1_by,_.value.val1_at=a.value.val1_at,_.value.val2=a.value.val2,_.value.val2_user=a.value.val2_user,_.value.val2_by=a.value.val2_by,_.value.val2_at=a.value.val2_at,_.value.val3=a.value.val3,_.value.val3_user=a.value.val3_user,_.value.val3_by=a.value.val3_by,_.value.val3_at=a.value.val3_at;let $=h.p_data.map(R=>R.id).indexOf(h.id);$>=-1&&h.p_data.splice($,1,{..._.value}),h.fnClose()};c(()=>{let e=0;return u.value.forEach(o=>{e+=parseFloat(o.standby_nominal)}),e});const E=c(()=>{let e=0;return u.value.forEach(o=>{e+=parseFloat(o.sb_gaji)}),e}),D=c(()=>{let e=0;return u.value.forEach(o=>{e+=parseFloat(o.sb_makan)}),e}),M=c(()=>{let e=0;return u.value.forEach(o=>{e+=parseFloat(o.sb_dinas)}),e}),k=c(()=>{let e=0;return u.value.forEach(o=>{e+=parseFloat(o.sb_gaji_2)}),e}),j=c(()=>{let e=0;return u.value.forEach(o=>{e+=parseFloat(o.sb_makan_2)}),e}),g=c(()=>{let e=0;return u.value.forEach(o=>{e+=parseFloat(o.sb_dinas_2)}),e}),S=c(()=>{let e=0;return u.value.forEach(o=>{e+=parseFloat(o.uj_gaji)}),e}),N=c(()=>{let e=0;return u.value.forEach(o=>{e+=parseFloat(o.uj_makan)}),e}),C=c(()=>{let e=0;return u.value.forEach(o=>{e+=parseFloat(o.uj_dinas)}),e}),V=c(()=>{let e=0;return u.value.forEach(o=>{e+=parseFloat(o.nominal_cut)}),e}),B=c(()=>{let e=0;return u.value.forEach(o=>{e+=parseFloat(o.salary_bonus_nominal)}),e}),L=async()=>{F().loading_full=!0;const{data:e,error:o,status:v}=await G("/rpt_salary",{method:"get",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},params:{id:h.id},retry:0});if(F().loading_full=!1,v.value==="error"){z().trigger(o);return}_.value=e.value.data,u.value=e.value.data.details};c(()=>{let e=0;return u.value.forEach(o=>{o.p_status!="Remove"&&(e+=parseInt(o.amount))}),e}),c(()=>!1);const b=w(""),Y=c(()=>b.value!=""?u.value.filter(e=>e.employee.name.toLowerCase().includes(b.value.toLowerCase())):u.value);return O(()=>h.show,(e,o)=>{e==!0&&(h.is_view==!1&&setTimeout(()=>{P.value.focus()},1),L())},{immediate:!0}),(e,o)=>{const v=U;return q((d(),m("section",_t,[t("div",null,[W(v,{title:"Form Master Standby Validation",fn:p.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",rt,[t("div",ut,[t("div",it,[t("div",ct,[pt,t("div",dt,l(s(x)(s(_).period_end).format("MM-Y")),1)])]),s(u).length?(d(),m("div",mt,[ht,q(t("input",{class:"",type:"text","onUpdate:modelValue":o[0]||(o[0]=a=>X(b)?b.value=a:null),name:"search",placeholder:"Nama"},null,512),[[Z,s(b)]])])):f("",!0),s(Y).length?(d(),m("div",vt,[t("div",ft,[t("table",bt,[t("thead",null,[yt,t("tr",wt,[xt,kt,jt,gt,Ft,Et,Dt,Mt,St,Nt,Ct,Bt,t("th",Tt,[r("Standby 1 "),t("span",At,"("+l(s(n)(s(E)+s(D)+s(M)||0))+")",1)]),t("th",Pt,[r("Standby 2 "),t("span",Vt,"("+l(s(n)(s(k)+s(j)+s(g)||0))+")",1)]),t("th",Yt,[r("Trip "),t("span",$t,"("+l(s(n)(s(S)+s(N)+s(C)||0))+")",1)]),t("th",qt,[r("Potongan "),t("span",It,"("+l(s(n)(s(V)||0))+")",1)]),t("th",zt,[r("U.Kerajinan "),t("span",Gt,"("+l(s(n)(s(B)||0))+")",1)]),t("th",Jt,[r("BPJS Kesehatan "),t("span",Lt,"("+l(s(n)(e.ttl_bpjs_kesehatan||0))+")",1)]),t("th",Kt,[r("BPJS Jamsos "),t("span",Rt,"("+l(s(n)(e.ttl_bpjs_jamsos||0))+")",1)]),t("th",Ut,[r("Grand Total "),t("span",Ht,"("+l(s(n)(s(E)+s(D)+s(M)+s(k)+s(j)+s(g)+s(S)+s(N)+s(C)-s(V)+s(B)||0))+")",1)]),t("th",Ot,[r("Total Periode 2 "),t("span",Qt,"("+l(s(n)(s(k)+s(j)+s(g)+s(B)||0))+")",1)])]),t("tr",Wt,[t("th",null,[r("Gaji "),t("span",Xt,"("+l(s(n)(s(E)||0))+")",1)]),t("th",null,[r("Makan "),t("span",Zt,"("+l(s(n)(s(D)||0))+")",1)]),t("th",null,[r("Dinas "),t("span",ts,"("+l(s(n)(s(M)||0))+")",1)]),t("th",null,[r("Gaji "),t("span",ss,"("+l(s(n)(s(k)||0))+")",1)]),t("th",null,[r("Makan "),t("span",as,"("+l(s(n)(s(j)||0))+")",1)]),t("th",null,[r("Dinas "),t("span",es,"("+l(s(n)(s(g)||0))+")",1)]),t("th",null,[r("Gaji "),t("span",ls,"("+l(s(n)(s(S)||0))+")",1)]),t("th",null,[r("Makan "),t("span",os,"("+l(s(n)(s(N)||0))+")",1)]),t("th",null,[r("Dinas "),t("span",ns,"("+l(s(n)(s(C)||0))+")",1)])])]),t("tbody",_s,[(d(!0),m(I,null,tt(s(Y),(a,y)=>(d(),m(I,{key:y},[a.p_status!="Remove"?(d(),m("tr",{key:0,"data-index":y},[t("td",null,l(y+1)+".",1),t("td",null,l(a.employee_id),1),t("td",null,l(a.employee_name),1),t("td",null,l(a.employee_role),1),t("td",null,l(a.employee_birth_place),1),t("td",null,l(a.employee_birth_date?s(x)(a.employee_birth_date).format("DD-MM-Y"):""),1),t("td",null,l(a.employee_tmk?s(x)(a.employee_tmk).format("DD-MM-Y"):""),1),t("td",null,l(a.employee_ktp_no),1),t("td",null,l(a.employee_address),1),t("td",null,l(a.employee_status),1),t("td",null,l(a.employee_rek_no),1),t("td",null,l(a.employee_bank_name),1),t("td",null,l(s(n)(a.sb_gaji)),1),t("td",null,l(s(n)(a.sb_makan)),1),t("td",null,l(s(n)(a.sb_dinas)),1),t("td",null,l(s(n)(a.sb_gaji_2)),1),t("td",null,l(s(n)(a.sb_makan_2)),1),t("td",null,l(s(n)(a.sb_dinas_2)),1),t("td",null,l(s(n)(a.uj_gaji)),1),t("td",null,l(s(n)(a.uj_makan)),1),t("td",null,l(s(n)(a.uj_dinas)),1),t("td",null,l(s(n)(a.nominal_cut)),1),t("td",null,l(s(n)(a.employee_bpjs_kesehatan)),1),t("td",null,l(s(n)(a.employee_bpjs_jamsos)),1),t("td",null,l(s(n)(a.salary_bonus_nominal)),1),t("td",null,l(s(n)(parseFloat(a.sb_gaji)+parseFloat(a.sb_makan)+parseFloat(a.sb_dinas)+parseFloat(a.sb_gaji_2)+parseFloat(a.sb_makan_2)+parseFloat(a.sb_dinas_2)+parseFloat(a.uj_gaji)+parseFloat(a.uj_makan)+parseFloat(a.uj_dinas)-parseFloat(a.nominal_cut)+parseFloat(a.salary_bonus_nominal))),1),t("td",null,l(s(n)(parseFloat(a.sb_gaji_2)+parseFloat(a.sb_makan_2)+parseFloat(a.sb_dinas_2)+parseFloat(a.salary_bonus_nominal))),1)],8,rs)):f("",!0)],64))),128))],512)])])])):f("",!0)]),t("div",us,[t("div",is,[cs,s(_).val1||s(_).val2||s(_).val3?(d(),m("div",ps,[s(_).val1?(d(),m("div",ds," App 1 : "+l(s(_).val1_by.username)+" ( "+l(s(_).val1_at?s(x)(s(_).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):f("",!0)])):f("",!0)]),t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:o[1]||(o[1]=a=>p.fnClose())}," Cancel "),p.is_view==0?(d(),m("button",{key:0,ref_key:"it_val",ref:P,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:o[2]||(o[2]=st(a=>J(),["prevent"]))}," Validasi ",512)):f("",!0)])])])],512)),[[Q,p.show]])}}},ks=nt(ms,[["__scopeId","data-v-4e277087"]]);export{ks as default};
