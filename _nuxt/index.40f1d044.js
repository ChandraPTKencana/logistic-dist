import{r,f as ae,g as Ee,h as Ie,i as S,j as le,s as ze,x as f,c as h,b as v,a as c,k as ne,v as Ve,l,m as oe,n as D,d as x,w as p,q as Me,y as M,o as d,z as P,t as C,A as Ne,B as R,_ as H}from"./entry.80f9400f.js";import Re from"./Header.d832b074.js";import He from"./Copy.f6cc2e3d.js";import Ke from"./Plus.ff7cfb63.js";import Je from"./Edit.8ba83185.js";import Ge from"./Eyes.35a34929.js";import Ye from"./Delete.fbe43ce9.js";import qe from"./Signature.b3ac5cb1.js";import Xe from"./SignatureOff.b6c9f856.js";import Ze from"./Table2Column.1f2f6325.js";import Qe from"./Line.0d89352b.js";import We from"./Check.2d47ab0b.js";import et from"./TableView.85942596.js";import{u as i}from"./useUtils.4905e334.js";import{u as N}from"./useMyFetch.a3705501.js";import{u as tt}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.e94f12c9.js";import"./Adjust.bbeeda20.js";import"./TableHeaderEye.75695600.js";import"./Times.533e4a65.js";import"./ClearAll.84555876.js";import"./client-only.b5fd6b3a.js";import"./ClearEach.3dd0da5e.js";import"./CaretLeftDoubleBold.8dc8d473.js";import"./CaretLeftBold.1ba5db7b.js";import"./CaretRightBold.b313526e.js";import"./CaretRightDoubleBold.22e21eb5.js";const at=R(()=>H(()=>import("./PopupMini.8abf2423.js"),["./PopupMini.8abf2423.js","./PopupMini.vue.9a484447.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./Exclamation.44603bae.js"],import.meta.url).then(m=>m.default||m)),lt=R(()=>H(()=>import("./ujalan.fa70fb6d.js"),["./ujalan.fa70fb6d.js","./HeaderPopup.vue.def29a01.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./InputPointFormat.vue.53b3b8a4.js","./Tools.a45eab5c.js","./Check.2d47ab0b.js","./Plus.ff7cfb63.js","./ToolsPopup.9498720b.js","./ToolsPopup.13c08491.css","./ac_accs.06fd70ab.js","./Search.e94f12c9.js","./useUtils.4905e334.js","./useMyFetch.a3705501.js","./ac_accs.2900e1e1.css"],import.meta.url).then(m=>m.default||m)),nt=R(()=>H(()=>import("./ujalan_batas_persen_susut.3f8f5137.js"),["./ujalan_batas_persen_susut.3f8f5137.js","./HeaderPopup.vue.def29a01.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./InputPointFormat.vue.53b3b8a4.js","./WidthMiniList.vue.0c640245.js","./WidthMiniPart.vue.1a42f0c4.js","./useUtils.4905e334.js","./useMyFetch.a3705501.js"],import.meta.url).then(m=>m.default||m)),ot=R(()=>H(()=>import("./ujalan_validasi.eb923c7a.js"),["./ujalan_validasi.eb923c7a.js","./HeaderPopup.vue.def29a01.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./Check.2d47ab0b.js","./useUtils.4905e334.js","./useMyFetch.a3705501.js"],import.meta.url).then(m=>m.default||m)),st={class:"w-full h-full flex flex-col"},it={class:"w-full flex grow flex-col overflow-auto h-0"},rt={class:"w-full flex justify-between flex-wrap"},ut={class:"grow flex"},_t={class:"m-1"},dt=c("option",{value:"available"},"Available",-1),vt=c("option",{value:"unapprove"},"Unapprove",-1),ct=c("option",{value:"deleted"},"Trash",-1),pt=c("option",{value:"all"},"All",-1),mt=[dt,vt,ct,pt],ft=c("span",{class:"text-xs ml-1"}," Download ",-1),yt={class:"whitespace-pre-wrap"},bt={class:"grow mb-5"},Yt={__name:"index",async setup(m){let L,q;const{pointFormat:$}=i(),se=a=>a.deleted==1?"!bg-red-400":a.val==0||a.val1==0||a.val2==0||a.val3==0?"!bg-gray-300":"",b=r("available");ae(()=>b.value,a=>{W()},{immediate:!1});const u={};u._TimeZoneOffset=new Date().getTimezoneOffset(),u.sort="tanggal:desc";const X=r({}),E=Ee("token"),{data:ie}=([L,q]=Ie(async()=>Me(async()=>{f().loading_full=!0;let a=[];const[e,w]=await Promise.all([N("/ujalan",{method:"get",headers:{Authorization:`Bearer ${E.value}`,Accept:"application/json"},params:{filter_status:b},retry:0})]);return e.status.value!=="error"&&(a=e.data.value.data),e.status.value==="error"?(M().trigger(e.error),{ujalans:a}):(f().loading_full=!1,{ujalans:a})},"$SN3C927rLk")),L=await L,q(),L),o=r(ie.value.ujalans||[]),K=r({field:"tanggal",by:"desc"}),n=r(-1),_=S(()=>o.value[n.value]),y=r({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),Z=()=>{u.like="";let a=JSON.parse(JSON.stringify(f()._tv.global_keyword));a!=""&&(u.like=`id:%${a}%,xto:%${a}%,tipe:%${a}%,jenis:%${a}%,harga:%${a}%`),u.sort="",K.value.field&&(u.sort=K.value.field+":"+K.value.by),u.filter_model=JSON.stringify(f()._tv.filter_model)},Q=async()=>{f().loading_full=!0,X.value={},y.value.may_get_data=!1,u.page=y.value.page,u.page==1&&(o.value=[]),u.first_row&&delete u.first_row,u.page>1&&(u.first_row=JSON.stringify(o.value[0])),u.filter_status=b.value;const{data:a,error:e,status:w}=await N("/ujalan",{method:"get",headers:{Authorization:`Bearer ${E.value}`,Accept:"application/json"},params:u,retry:0});if(f().loading_full=!1,y.value.may_get_data=!0,w.value==="error"){M().trigger(e,X);return}y.value.page==1?o.value=a.value.data:y.value.page>1&&(o.value=[...o.value,...a.value.data]),a.value.data.length==0&&(y.value.is_last_record=!0),f()._tv.filter_box=!1},W=()=>{n.value=-1,y.value.page=1,y.value.is_last_record=!1,Z(),Q()},B=r(!1),J=r(!1),T=r(0),k=r(0),g=r(-1),re=()=>{T.value=0,g.value=-1,k.value=!1,B.value=!0},{display:O}=le();ze(le());const ue=()=>{n.value==-1?O({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(T.value=o.value[n.value].id,g.value=-1,k.value=!1,B.value=!0)},_e=()=>{n.value==-1?O({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(T.value=o.value[n.value].id,g.value=-1,k.value=!1,J.value=!0)},de=()=>{n.value==-1?O({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(T.value=o.value[n.value].id,g.value=-1,k.value=!0,B.value=!0)},F=r(!1),I=r(0),ve=()=>{n.value==-1?O({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(I.value=o.value[n.value].id,g.value=1,k.value=!1,F.value=!0)},ce=()=>{n.value==-1?O({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(I.value=o.value[n.value].id,g.value=0,k.value=!1,F.value=!0)},pe=()=>{n.value==-1?O({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(I.value=o.value[n.value].id,k.value=!1,g.value=-1,F.value=!0)},G=r(!1),ee=r({}),U=r(!1),A=r(""),me=async()=>{U.value&&(U.value=!1)},fe=()=>{n.value==-1?O({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(A.value="",ee.value={id:o.value[n.value].id,tujuan:o.value[n.value].xto},U.value=!0)};ae(()=>A.value,a=>{a.trim().length>0?G.value=!0:G.value=!1},{immediate:!1});const ye=async()=>{f().loading_full=!0;const a=new FormData;a.append("id",o.value[n.value].id),a.append("deleted_reason",A.value),a.append("_method","DELETE");const{data:e,error:w,status:Y}=await N("/ujalan",{method:"post",headers:{Authorization:`Bearer ${E.value}`,Accept:"application/json"},body:a,retry:0});if(f().loading_full=!1,Y.value==="error"){M().trigger(w);return}let j={...o.value[n.value]};j.deleted=e.value.deleted,j.deleted_user=e.value.deleted_user,j.deleted_at=e.value.deleted_at,j.deleted_by=e.value.deleted_by,j.deleted_reason=e.value.deleted_reason,b.value!="all"?o.value.splice(n.value,1):o.value.splice(n.value,1,{...j}),n.value=-1,U.value=!1},be=r([{key:"no",label:"No",isai:!0},{key:"val",label:"Staff Logistik",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val1",label:"Kasir",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val2",label:"SPV Logistik",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val3",label:"MGR Logistik",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"xto",label:"Tujuan",freeze:1,filter_on:1,type:"string"},{key:"asst_opt",label:"Info",filter_on:1,type:"string"},{key:"tipe",label:"Tipe",filter_on:1,type:"string"},{key:"destination_location",label:"Dest. Location",childs:[{key:"destination_location_xto",label:"Xto",type:"string",filter_on:1},{key:"destination_location_minimal_trip",label:"Min Trip",filter_on:1,type:"string"},{key:"destination_location_bonus_trip_supir",label:"Bonus Trip Supir",filter_on:1,type:"number"},{key:"destination_location_bonus_next_trip_supir",label:"Bonus Trip Supir",filter_on:1,type:"number"},{key:"destination_location_bonus_trip_kernet",label:"Bonus Trip Kernet",filter_on:1,type:"number"},{key:"destination_location_bonus_next_trip_kernet",label:"Bonus Trip Kernet",filter_on:1,type:"number"}]},{key:"km_range",label:"Jarak KM",filter_on:1,type:"number"},{key:"jenis",label:"Jenis",filter_on:1,type:"select",select_item:["TBS","TBSK","CPO","PK","LAIN","TUNGGU"]},{key:"harga",label:"Harga",class:" justify-end",type:"number"},{key:"batas_persen_susut",label:"Batas Persen Susut",class:" justify-end",type:"number",tbl_show:i().checkPermission("ujalan.batas_persen_susut.full_act")},{key:"bonus_trip_supir",label:"Bonus Trip Supir",class:" justify-end",type:"number"},{key:"bonus_trip_kernet",label:"Bonus Trip Kernet",class:" justify-end",type:"number"},{key:"note_for_remarks",label:"Ket.U.Remarks",filter_on:1,type:"string"},{key:"transition_from",label:"Pengalihan",filter_on:1,type:"select",select_item:f().list_pabrik},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]),ke=S(()=>n.value>-1&&[void 0,0].indexOf(_.value.deleted)>-1&&i().checkPermission("ujalan.create")),he=S(()=>["available","all","unapprove"].indexOf(b.value)>-1&&i().checkPermission("ujalan.create")),xe=S(()=>n.value>-1&&[void 0,0].indexOf(_.value.deleted)>-1&&(i().checkPermission("ujalan.val")&&[void 0,0].indexOf(_.value.val)>-1||i().checkPermission("ujalan.val1")&&[void 0,0].indexOf(_.value.val1)>-1||i().checkPermission("ujalan.val2")&&[void 0,0].indexOf(_.value.val2)>-1||i().checkPermission("ujalan.val3")&&[void 0,0].indexOf(_.value.val3)>-1)&&i().checkPermissions(["ujalan.modify","ujalan.detail.modify","ujalan.detail2.modify"])),ge=S(()=>n.value>-1&&[void 0,0].indexOf(_.value.deleted)>-1&&(i().checkPermission("ujalan.val")&&[void 0,0].indexOf(_.value.val)>-1||i().checkPermission("ujalan.val1")&&[void 0,0].indexOf(_.value.val1)>-1||i().checkPermission("ujalan.val2")&&[void 0,0].indexOf(_.value.val2)>-1||i().checkPermission("ujalan.val3")&&[void 0,0].indexOf(_.value.val3)>-1)),we=S(()=>n.value>-1&&[void 0,0].indexOf(_.value.deleted)>-1&&(i().checkPermission("ujalan.unval")&&[1].indexOf(_.value.val)>-1||i().checkPermission("ujalan.unval1")&&[1].indexOf(_.value.val1)>-1||i().checkPermission("ujalan.unval2")&&[1].indexOf(_.value.val2)>-1||i().checkPermission("ujalan.unval3")&&[1].indexOf(_.value.val3)>-1)),je=S(()=>n.value>-1&&i().checkPermission("ujalan.remove")&&[void 0,0].indexOf(_.value.deleted)>-1),{downloadFile:De,viewFile:kt}=tt(),Pe=async()=>{Z(),f().loading_full=!0,u.filter_status=b.value;const{data:a,error:e,status:w}=await N("/ujalan/download_excel",{method:"get",headers:{Authorization:`Bearer ${E.value}`,Accept:"application/json"},params:u,retry:0});if(f().loading_full=!1,w.value==="error"){M().trigger(e);return}De(a.value)};return(a,e)=>{const w=Re,Y=He,j=Ke,te=Je,Ce=Ge,Oe=Ye,Se=qe,Te=Xe,Ae=Ze,z=Qe,V=We,$e=et,Be=at,Fe=lt,Ue=nt,Le=ot;return d(),h("div",st,[v(w,{title:"List Ujalan"}),c("div",it,[c("div",rt,[c("div",ut,[c("div",_t,[ne(c("select",{"aria-label":"Filter Status","onUpdate:modelValue":e[0]||(e[0]=t=>oe(b)?b.value=t:null)},mt,512),[[Ve,l(b)]])]),l(ke)?(d(),h("button",{key:0,type:"button",name:"button","aria-label":"Copy Data",class:"m-1 text-2xl",onClick:e[1]||(e[1]=t=>de())},[v(Y)])):D("",!0),l(he)?(d(),h("button",{key:1,type:"button",name:"button","aria-label":"New Form",class:"m-1 text-2xl",onClick:e[2]||(e[2]=t=>re())},[v(j)])):D("",!0),l(xe)?(d(),h("button",{key:2,type:"button",name:"button","aria-label":"Edit Form",class:"m-1 text-2xl",onClick:e[3]||(e[3]=t=>ue())},[v(te)])):D("",!0),l(n)>-1?(d(),h("button",{key:3,type:"button",name:"button","aria-label":"View Form",class:"m-1 text-2xl",onClick:e[4]||(e[4]=t=>pe())},[v(Ce)])):D("",!0),l(je)?(d(),h("button",{key:4,type:"button",name:"button","aria-label":"Delete Data",class:"m-1 text-2xl",onClick:e[5]||(e[5]=t=>fe())},[v(Oe)])):D("",!0),l(ge)?(d(),h("button",{key:5,type:"button",name:"button","aria-label":"Validate Data",class:"m-1 text-2xl",onClick:e[6]||(e[6]=t=>ve())},[v(Se)])):D("",!0),l(we)?(d(),h("button",{key:6,type:"button",name:"button","aria-label":"Unvalidate Data",class:"m-1 text-2xl",onClick:e[7]||(e[7]=t=>ce())},[v(Te)])):D("",!0),c("button",{type:"button",name:"button",class:"m-1 text-2xl flex items-center",onClick:e[8]||(e[8]=t=>Pe())},[v(Ae),x(),ft]),l(n)>-1&&("useUtils"in a?a.useUtils:l(i))().checkPermission("ujalan.batas_persen_susut.full_act")?(d(),h("button",{key:7,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[9]||(e[9]=t=>_e())},[v(te)])):D("",!0)])]),v($e,{thead:l(be),selected:l(n),onSetSelected:e[10]||(e[10]=t=>n.value=t),tbody:l(o),fnCallData:Q,scrolling:l(y),onSetScrollingPage:e[11]||(e[11]=t=>l(y).page=t),onDoFilter:e[12]||(e[12]=t=>W()),rowBgColor:se},{val:p(({item:t})=>[t.val?(d(),P(V,{key:1})):(d(),P(z,{key:0}))]),val1:p(({item:t})=>[t.val1?(d(),P(V,{key:1})):(d(),P(z,{key:0}))]),val2:p(({item:t})=>[t.val2?(d(),P(V,{key:1})):(d(),P(z,{key:0}))]),val3:p(({item:t})=>[t.val3?(d(),P(V,{key:1})):(d(),P(z,{key:0}))]),xto:p(({item:t})=>[c("div",yt,C(t.xto),1)]),destination_location_xto:p(({item:t})=>{var s;return[x(C((s=t.destination_location)==null?void 0:s.xto),1)]}),destination_location_minimal_trip:p(({item:t})=>{var s;return[x(C(l($)((s=t.destination_location)==null?void 0:s.minimal_trip)),1)]}),destination_location_bonus_trip_supir:p(({item:t})=>{var s;return[x(C(l($)((s=t.destination_location)==null?void 0:s.bonus_trip_supir)),1)]}),destination_location_bonus_next_trip_supir:p(({item:t})=>{var s;return[x(C(l($)((s=t.destination_location)==null?void 0:s.bonus_next_trip_supir)),1)]}),destination_location_bonus_trip_kernet:p(({item:t})=>{var s;return[x(C(l($)((s=t.destination_location)==null?void 0:s.bonus_trip_kernet)),1)]}),destination_location_bonus_next_trip_kernet:p(({item:t})=>{var s;return[x(C(l($)((s=t.destination_location)==null?void 0:s.bonus_next_trip_kernet)),1)]}),deleted_by_username:p(({item:t})=>{var s;return[x(C((s=t.deleted_by)==null?void 0:s.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])]),v(Be,{type:"delete",show:l(U),data:l(ee),fnClose:me,fnConfirm:ye,enabledOk:l(G)},{footer:p(()=>[x(" Masukkan Alasan Penghapusan: "),c("div",bt,[ne(c("textarea",{"onUpdate:modelValue":e[13]||(e[13]=t=>oe(A)?A.value=t:null)},null,512),[[Ne,l(A)]])])]),_:1},8,["show","data","enabledOk"]),v(Fe,{show:l(B),fnClose:()=>{B.value=!1},id:l(T),p_data:l(o),is_copy:l(k)},null,8,["show","fnClose","id","p_data","is_copy"]),v(Ue,{show:l(J),fnClose:()=>{J.value=!1},id:l(T),p_data:l(o),is_copy:l(k)},null,8,["show","fnClose","id","p_data","is_copy"]),v(Le,{show:l(F),fnClose:()=>{F.value=!1},id:l(I),p_data:l(o),it_state:l(g)},null,8,["show","fnClose","id","p_data","it_state"])])}}};export{Yt as default};
