import{r,f as J,g as Ce,h as Se,i as T,j as X,s as Oe,c as w,b as _,a as u,k as ee,v as Te,l,m as te,n as $,d as h,w as m,q as $e,x as c,y as N,o as d,z as D,t as A,A as Be,B as Y,_ as q}from"./entry.6bb5a617.js";import Me from"./Header.b5243f3e.js";import ze from"./Plus.3fe977c9.js";import Ee from"./Edit.512c20a3.js";import Ie from"./Eyes.cd8577ae.js";import Ne from"./Delete.86627645.js";import Fe from"./Signature.412f52c0.js";import Ve from"./Table2Column.1ba7e0a3.js";import Le from"./Line.51e21d0f.js";import je from"./Check.2caf03fc.js";import Ue from"./TypeIcon.81a1508f.js";import He from"./TableView.3ee9daf4.js";import{u as k}from"./useUtils.9a9f1e8e.js";import{u as F}from"./useMyFetch.5acab9e9.js";import{u as Re}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./DocJPEG.26fe7ea6.js";import"./DocJPG.3e806f23.js";import"./DocPNG.d66d48eb.js";import"./DocPDF.f67d5d2a.js";import"./Search.67a5428c.js";import"./Adjust.9189acf7.js";import"./TableHeaderEye.e9086890.js";import"./Times.888657e4.js";import"./ClearAll.e656002b.js";import"./client-only.cc6b344e.js";import"./ClearEach.76ebad6e.js";import"./CaretLeftDoubleBold.0f3d8274.js";import"./CaretLeftBold.a876b67b.js";import"./CaretRightBold.4e7bfd51.js";import"./CaretRightDoubleBold.af3f45fc.js";const Je=Y(()=>q(()=>import("./PopupMini.fe3c8904.js"),["./PopupMini.fe3c8904.js","./PopupMini.vue.1adaf94e.js","./Times.888657e4.js","./_plugin-vue_export-helper.c27b6911.js","./entry.6bb5a617.js","./entry.493f9183.css","./Exclamation.daa7f244.js"],import.meta.url).then(v=>v.default||v)),Ye=Y(()=>q(()=>import("./salary_bonus.6865be51.js"),["./salary_bonus.6865be51.js","./HeaderPopup.vue.553fe2a0.js","./Times.888657e4.js","./_plugin-vue_export-helper.c27b6911.js","./entry.6bb5a617.js","./entry.493f9183.css","./client-only.cc6b344e.js","./WidthMiniList.vue.dc226eda.js","./WidthMiniPart.vue.f6c1fc23.js","./InputPointFormat.vue.7835142f.js","./AttachmentSingle.85e1dde9.js","./PDFJsView.768c6b9c.js","./PDFJsView.4e9fad9f.css","./useMyFetch.5acab9e9.js"],import.meta.url).then(v=>v.default||v)),qe=Y(()=>q(()=>import("./salary_bonus_validasi.5ac277a4.js"),["./salary_bonus_validasi.5ac277a4.js","./HeaderPopup.vue.553fe2a0.js","./Times.888657e4.js","./_plugin-vue_export-helper.c27b6911.js","./entry.6bb5a617.js","./entry.493f9183.css","./WidthMiniPart.vue.f6c1fc23.js","./AttachmentSingle.85e1dde9.js","./PDFJsView.768c6b9c.js","./PDFJsView.4e9fad9f.css","./useUtils.9a9f1e8e.js","./useMyFetch.5acab9e9.js"],import.meta.url).then(v=>v.default||v)),Ge={class:"w-full h-full flex flex-col"},Ke={class:"w-full flex grow flex-col overflow-auto h-0"},Ze={class:"w-full flex justify-between flex-wrap"},Qe={class:"grow flex"},We={class:"m-1"},Xe=u("option",{value:"undone"},"Undone",-1),et=u("option",{value:"done"},"Done",-1),tt=u("option",{value:"deleted"},"Trash",-1),at=u("option",{value:"all"},"All",-1),lt=[Xe,et,tt,at],ot=u("span",{class:"text-xs ml-1"}," Download ",-1),st={style:{"min-width":"350px","text-wrap":"wrap"}},nt={class:"grow mb-5"},Vt={__name:"index",async setup(v){let B,G;const ae=e=>e.deleted==1?"!bg-red-400":e.val1>0&&e.val2>0&&e.val3>0&&e.salary_paid_id>0?"!bg-blue-300":"",f=r("undone");J(()=>f.value,e=>{Q()},{immediate:!1});const n={};n._TimeZoneOffset=new Date().getTimezoneOffset(),n.sort="created_at:desc";const M=Ce("token"),{data:le}=([B,G]=Se(async()=>$e(async()=>{let e=[];c().loading_full=!0;const{data:t,error:y,status:O}=await F("/salary_bonuses",{method:"get",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},params:{filter_status:f},retry:0});return c().loading_full=!1,O.value==="error"?(N().trigger(y),{salary_bonuses:e}):(e=t.value.data,{salary_bonuses:e})},{lazy:!0,server:!1,default:()=>({salary_bonuses:[]})},"$tya7A7egnO")),B=await B,G(),B),s=r([]);J(()=>{var e;return(e=le.value)==null?void 0:e.salary_bonuses},e=>{e&&(s.value=[...e])},{immediate:!0}),r("");const V=r({field:"created_at",by:"desc"}),o=r(-1),b=T(()=>s.value[o.value]),p=r({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),K=()=>{n.like="";let e=JSON.parse(JSON.stringify(c()._tv.global_keyword));e!=""&&(n.like=`id:%${e}%,employee_name:%${e}%`),n.sort="",V.value.field&&(n.sort=V.value.field+":"+V.value.by),n.filter_model=JSON.stringify(c()._tv.filter_model)},Z=async()=>{c().loading_full=!0,p.value.may_get_data=!1,n.page=p.value.page,n.page==1&&(s.value=[]),n.first_row&&delete n.first_row,n.page>1&&(n.first_row=JSON.stringify(s.value[0])),n.filter_status=f.value;const{data:e,error:t,status:y}=await F("/salary_bonuses",{method:"get",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},params:n,retry:0});if(c().loading_full=!1,p.value.may_get_data=!0,y.value==="error"){N().trigger(t);return}p.value.page==1?s.value=e.value.data:p.value.page>1&&(s.value=[...s.value,...e.value.data]),e.value.data.length==0&&(p.value.is_last_record=!0),c()._tv.filter_box=!1},Q=()=>{o.value=-1,o.value=-1,p.value.page=1,p.value.is_last_record=!1,K(),Z()},z=r(!1),L=r(0),P=r(0),C=r(!1),oe=()=>{L.value=0,C.value=!1,P.value=!1,z.value=!0},{display:E}=X();Oe(X());const se=()=>{o.value==-1?E({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(L.value=s.value[o.value].id,C.value=!1,P.value=!1,z.value=!0)},I=r(!1),j=r(0),ne=()=>{o.value==-1?E({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(j.value=s.value[o.value].id,C.value=!1,P.value=!1,I.value=!0)},re=()=>{o.value==-1?E({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(j.value=s.value[o.value].id,C.value=!0,P.value=!1,I.value=!0)},U=r(!1),W=r({}),S=r(!1),x=r(""),ie=async()=>{S.value&&(S.value=!1)},ue=()=>{o.value==-1?E({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(x.value="",W.value={id:s.value[o.value].id},S.value=!0)};J(()=>x.value,e=>{e.trim().length>0?U.value=!0:U.value=!1},{immediate:!1});const _e=async()=>{c().loading_full=!0;const e=new FormData;e.append("id",s.value[o.value].id),e.append("deleted_reason",x.value),e.append("_method","DELETE");const{data:t,error:y,status:O}=await F("/salary_bonus",{method:"post",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},body:e,retry:0});if(c().loading_full=!1,O.value==="error"){N().trigger(y);return}let g={...s.value[o.value]};g.deleted=t.value.deleted,g.deleted_user=t.value.deleted_user,g.deleted_at=t.value.deleted_at,g.deleted_by=t.value.deleted_by,g.deleted_reason=t.value.deleted_reason,f.value!="all"?s.value.splice(o.value,1):s.value.splice(o.value,1,{...g}),o.value=-1,S.value=!1},de=r([{key:"no",label:"No",isai:!0},{key:"val",label:"APP",childs:[{key:"val1",label:"Staff",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val2",label:"SPV",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val3",label:"MGR",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]}]},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"tanggal",label:"Tanggal",type:"date",dateformat:"DD-MM-Y",filter_on:1,sort:{priority:1,type:"desc"}},{key:"type",label:"Tipe",filter_on:1,type:"string"},{key:"employee_name",label:"Nama",freeze:1,filter_on:1,type:"string"},{key:"employee_ktp_no",label:"No KTP",filter_on:1,type:"string"},{key:"employee_sim_no",label:"No SIM",filter_on:1,type:"string"},{key:"nominal",label:"Nominal",class:" justify-end",type:"number"},{key:"note",label:"Note",filter_on:1,type:"string"},{key:"attachment_1_type",label:"File",filter_on:1,type:"string"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]),me=T(()=>["undone","all"].indexOf(f.value)>-1&&k().checkPermission("salary_bonus.create")),ce=T(()=>o.value>-1&&[void 0,0].indexOf(b.value.deleted)>-1&&(k().checkPermission("salary_bonus.val1")&&[void 0,0,1].indexOf(b.value.val1)>-1||k().checkPermission("salary_bonus.val2")&&[void 0,0].indexOf(b.value.val2)>-1)&&k().checkPermissions(["salary_bonus.modify"])),pe=T(()=>o.value>-1&&[void 0,0].indexOf(b.value.deleted)>-1&&(k().checkPermission("salary_bonus.val1")&&[void 0,0].indexOf(b.value.val1)>-1||k().checkPermission("salary_bonus.val2")&&[void 0,0].indexOf(b.value.val2)>-1||k().checkPermission("salary_bonus.val3")&&[void 0,0].indexOf(b.value.val3)>-1)),ve=T(()=>o.value>-1&&k().checkPermission("salary_bonus.remove")&&[void 0,0].indexOf(b.value.deleted)>-1),{downloadFile:fe,viewFile:rt}=Re(),ye=async()=>{K(),c().loading_full=!0,n.filter_status=f.value;const{data:e,error:t,status:y}=await F("/salary_bonus/download_excel",{method:"get",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},params:n,retry:0});if(c().loading_full=!1,y.value==="error"){N().trigger(t);return}fe(e.value)};return(e,t)=>{const y=Me,O=ze,g=Ee,be=Ie,ge=Ne,ke=Fe,he=Ve,H=Le,R=je,xe=Ue,we=He,De=Je,Ae=Ye,Pe=qe;return d(),w("div",Ge,[_(y,{title:"List Salary Additional"}),u("div",Ke,[u("div",Ze,[u("div",Qe,[u("div",We,[ee(u("select",{class:"","onUpdate:modelValue":t[0]||(t[0]=a=>te(f)?f.value=a:null)},lt,512),[[Te,l(f)]])]),l(me)?(d(),w("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=a=>oe())},[_(O)])):$("",!0),l(ce)?(d(),w("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=a=>se())},[_(g)])):$("",!0),l(o)>-1?(d(),w("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[3]||(t[3]=a=>re())},[_(be)])):$("",!0),l(ve)?(d(),w("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[4]||(t[4]=a=>ue())},[_(ge)])):$("",!0),l(pe)?(d(),w("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[5]||(t[5]=a=>ne())},[_(ke)])):$("",!0),u("button",{type:"button",name:"button",class:"m-1 text-2xl flex items-center",onClick:t[6]||(t[6]=a=>ye())},[_(he),h(),ot])])]),_(we,{thead:l(de),selected:l(o),onSetSelected:t[7]||(t[7]=a=>o.value=a),tbody:l(s),fnCallData:Z,scrolling:l(p),onSetScrollingPage:t[8]||(t[8]=a=>l(p).page=a),onDoFilter:t[9]||(t[9]=a=>Q()),rowBgColor:ae},{val1:m(({item:a})=>[a.val1?(d(),D(R,{key:1})):(d(),D(H,{key:0}))]),val2:m(({item:a})=>[a.val2?(d(),D(R,{key:1})):(d(),D(H,{key:0}))]),val3:m(({item:a})=>[a.val3?(d(),D(R,{key:1})):(d(),D(H,{key:0}))]),employee_name:m(({item:a})=>{var i;return[h(A((i=a.employee)==null?void 0:i.name),1)]}),employee_ktp_no:m(({item:a})=>{var i;return[h(A((i=a.employee)==null?void 0:i.ktp_no),1)]}),employee_sim_no:m(({item:a})=>{var i;return[h(A((i=a.employee)==null?void 0:i.sim_no),1)]}),note:m(({item:a})=>[u("div",st,A(a.note),1)]),attachment_1_type:m(({item:a})=>[_(xe,{value:a.attachment_1_type},null,8,["value"])]),deleted_by_username:m(({item:a})=>{var i;return[h(A((i=a.deleted_by)==null?void 0:i.username),1)]}),req_deleted_by_username:m(({item:a})=>{var i;return[h(A((i=a.req_deleted_by)==null?void 0:i.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])]),_(De,{type:"delete",show:l(S),data:l(W),fnClose:ie,fnConfirm:_e,enabledOk:l(U)},{footer:m(()=>[h(" Masukkan Alasan Penghapusan: "),u("div",nt,[ee(u("textarea",{"onUpdate:modelValue":t[10]||(t[10]=a=>te(x)?x.value=a:null)},null,512),[[Be,l(x)]])])]),_:1},8,["show","data","enabledOk"]),_(Ae,{show:l(z),fnClose:()=>{z.value=!1},id:l(L),p_data:l(s),is_copy:l(P)},null,8,["show","fnClose","id","p_data","is_copy"]),_(Pe,{show:l(I),fnClose:()=>{I.value=!1},id:l(j),p_data:l(s),is_view:l(C)},null,8,["show","fnClose","id","p_data","is_view"])])}}};export{Vt as default};
