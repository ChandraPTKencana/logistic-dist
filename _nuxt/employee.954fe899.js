import{_ as F}from"./HeaderPopup.vue.d8d71852.js";import P from"./AttachmentSingle.aba4566f.js";import{r as x,f as j,j as q,m as i,J as M,o as h,c as b,a as e,b as S,k as l,v as p,t as d,q as V,F as D,y as z,x as E,A as _,B as k}from"./entry.35634b8f.js";import{u as y}from"./useMyFetch.6cd47c90.js";import"./Times.91251ff3.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./PDFJsView.b255ee2f.js";const K={class:"box-fixed"},T={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},J={class:"w-full flex flex-wrap flex-row grow overflow-auto items-start"},O={class:"w-full sm:w-full md:w-1/3 flex flex-row flex-wrap"},R={class:"w-1/2 sm:w-1/2 md:w-full flex flex-col flex-wrap p-1"},H=e("label",{for:""},"Nama",-1),I={class:"text-red-500"},L={class:"w-1/2 sm:w-1/2 md:w-full flex flex-col flex-wrap p-1"},G=e("label",{for:""},"Jabatan",-1),Q=e("option",{value:"Supir"},"Supir",-1),W=e("option",{value:"Kernet"},"Kernet",-1),X=[Q,W],Y={class:"text-red-500"},Z={class:"w-1/2 sm:w-1/2 md:w-full flex flex-col flex-wrap p-1"},ee=e("label",{for:""},"No KTP",-1),te={class:"text-red-500"},oe={class:"w-1/2 sm:w-1/2 md:w-full flex flex-col flex-wrap p-1"},le=e("label",{for:""},"No SIM",-1),ae={class:"text-red-500"},ne={class:"w-1/2 sm:w-1/2 md:w-full flex flex-col flex-wrap p-1"},se=e("label",{for:""},"Pilih Bank",-1),re=e("option",{value:""},null,-1),ie=["value"],de={class:"text-red-500"},ue={class:"w-1/2 sm:w-1/2 md:w-full flex flex-col flex-wrap p-1"},pe=e("label",{for:""},"No Rek",-1),_e={class:"text-red-500"},me={class:"w-1/2 sm:w-1/2 md:w-full flex flex-col flex-wrap p-1"},fe=e("label",{for:""},"Nama Rek",-1),ce={class:"text-red-500"},ve={class:"w-1/2 sm:w-1/2 md:w-full flex flex-col flex-wrap p-1"},we=e("label",{for:""},"Phone Number",-1),xe={class:"text-red-500"},he={class:"p-1 w-full sm:w-full md:w-2/3 md:overflow-auto max-h-full"},be={class:"w-full flex items-center justify-end"},Ce={__name:"employee",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},setup(f){const s=f,g={id:-1,name:"",role:"Supir",ktp_no:"",sim_no:"",bank_id:1,rek_no:"",rek_name:"",phone_number:"",attachment_1:"",attachment_1_preview:""},t=x({...g}),w=j("token"),r=x({}),A=async()=>{_().loading_full=!0,r.value={};const n=new FormData;n.append("name",t.value.name),n.append("role",t.value.role),n.append("ktp_no",t.value.ktp_no),n.append("sim_no",t.value.sim_no),n.append("bank_id",t.value.bank_id),n.append("rek_no",t.value.rek_no),n.append("rek_name",t.value.rek_name),n.append("phone_number",t.value.phone_number),n.append("attachment_1",t.value.attachment_1),n.append("attachment_1_preview",t.value.attachment_1_preview);let o="post",u=s.id;u==0||(n.append("id",u),n.append("_method","PUT"));const{data:m,error:a,status:N}=await y("/employee",{method:o,headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},body:n,retry:0});if(_().loading_full=!1,N.value==="error"){k().trigger(a,r);return}let U=c.value.map(v=>v.id).indexOf(t.value.bank_id);if(t.value.bank={...c.value[U]},t.value.updated_at=m.value.updated_at,s.id<=0)t.value.id=m.value.id,t.value.created_at=m.value.created_at,s.p_data.unshift(t.value);else{let v=s.p_data.map($=>$.id).indexOf(s.id);v>=-1&&s.p_data.splice(v,1,{...t.value})}s.fnClose()},B=async()=>{_().loading_full=!0;const{data:n,error:o,status:u}=await y("/employee",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:{id:s.id},retry:0});if(_().loading_full=!1,u.value==="error"){k().trigger(o);return}t.value=n.value.data},c=x([]),C=async()=>{_().loading_full=!0;const{data:n,error:o,status:u}=await y("/banks",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:{id:s.id},retry:0});if(_().loading_full=!1,u.value==="error"){k().trigger(o);return}c.value=n.value.data};return q(()=>s.show,async(n,o)=>{n==!0&&(t.value={...g},r.value={},await C(),s.id!=0&&await B())},{immediate:!0}),(n,o)=>{const u=F,m=P;return i((h(),b("section",K,[e("div",null,[S(u,{title:"Form Employee",fn:f.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",T,[e("div",J,[e("div",O,[e("div",R,[H,i(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=a=>l(t).name=a)},null,512),[[p,l(t).name]]),e("p",I,d(l(r).name),1)]),e("div",L,[G,i(e("select",{"onUpdate:modelValue":o[1]||(o[1]=a=>l(t).role=a)},X,512),[[V,l(t).role]]),e("p",Y,d(l(r).role),1)]),e("div",Z,[ee,i(e("input",{type:"text","onUpdate:modelValue":o[2]||(o[2]=a=>l(t).ktp_no=a)},null,512),[[p,l(t).ktp_no]]),e("p",te,d(l(r).ktp_no),1)]),e("div",oe,[le,i(e("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=a=>l(t).sim_no=a)},null,512),[[p,l(t).sim_no]]),e("p",ae,d(l(r).sim_no),1)]),e("div",ne,[se,i(e("select",{"onUpdate:modelValue":o[4]||(o[4]=a=>l(t).bank_id=a)},[re,(h(!0),b(D,null,z(l(c),a=>(h(),b("option",{value:a.id},d(a.code),9,ie))),256))],512),[[V,l(t).bank_id]]),e("p",de,d(l(r).bank_id),1)]),e("div",ue,[pe,i(e("input",{type:"text","onUpdate:modelValue":o[5]||(o[5]=a=>l(t).rek_no=a)},null,512),[[p,l(t).rek_no]]),e("p",_e,d(l(r).rek_no),1)]),e("div",me,[fe,i(e("input",{type:"text","onUpdate:modelValue":o[6]||(o[6]=a=>l(t).rek_name=a)},null,512),[[p,l(t).rek_name]]),e("p",ce,d(l(r).rek_name),1)]),e("div",ve,[we,i(e("input",{type:"text","onUpdate:modelValue":o[7]||(o[7]=a=>l(t).phone_number=a)},null,512),[[p,l(t).phone_number]]),e("p",xe,d(l(r).phone_number),1)])]),e("div",he,[S(m,{label:"Attachment",value:l(t).attachment_1_preview,onSetFile:o[8]||(o[8]=a=>l(t).attachment_1=a),onSetPreview:o[9]||(o[9]=a=>l(t).attachment_1_preview=a),can_remove:!0},null,8,["value"])])]),e("div",be,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:o[10]||(o[10]=a=>f.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:o[11]||(o[11]=E(a=>A(),["prevent"]))}," Save ")])])])],512)),[[M,f.show]])}}};export{Ce as default};
