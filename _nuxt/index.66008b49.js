import ie from"./Header.1e8af04b.js";import re from"./Plus.fc20c6d2.js";import ue from"./Edit.38352e21.js";import ce from"./Eyes.f96431fe.js";import _e from"./Signature.3fcded29.js";import de from"./Search.cd68ed20.js";import me from"./Line.d52a95df.js";import pe from"./Check.5886cf77.js";import fe from"./mst.8648063a.js";import ve from"./validasi.6e444912.js";import{f as he,g as ye,r as a,h as ge,i as R,s as ke,j as we,c as m,b as p,a as e,k as t,l as x,m as M,v as xe,n as be,q as E,x as Ce,F as De,y as Se,z as $e,o as r,C as Ae,D as b,t as c,H as Pe,E as Ue,A as C,B as O}from"./entry.d8926042.js";import{u as y}from"./useUtils.45af66c8.js";import{u as J}from"./useMyFetch.ef190efc.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./HeaderPopup.vue.68fc8f64.js";import"./Times.2507741c.js";import"./WidthMiniList.vue.dd9b1a58.js";import"./WidthMiniPart.vue.689d0bbc.js";import"./InputPointFormat.vue.51a0aad3.js";import"./AttachmentSingle.ce264b54.js";import"./PDFJsView.5be0233c.js";import"./part.3a1048e2.js";import"./Calculator.b38f6aa5.js";import"./trx.24f75387.js";import"./trx_validasi.8a805856.js";const Me={class:"w-full h-full flex flex-col"},Te={class:"w-full flex grow flex-col overflow-auto h-0"},je={class:"w-full flex"},Ne={action:"#",class:"w-full flex p-1"},Fe={class:"grow"},He=e("div",{class:"font-bold"}," Keyword ",-1),Ie={class:"pl-1"},Be=e("div",{class:"font-bold"}," Sort By ",-1),Le=Pe('<option value=""></option><option value="id">ID</option><option value="xto">To</option><option value="jenis">Jenis</option><option value="tipe">Tipe</option>',5),Ve=[Le],ze={class:"pl-1"},Re=e("div",{class:"font-bold"}," Sort Order ",-1),Ee=e("option",{value:"asc"},"Asc",-1),Oe=e("option",{value:"desc"},"Desc",-1),Je=[Ee,Oe],Ke={class:"flex items-end pl-1"},Ye={class:"w-full flex justify-center items-center grow h-0 p-1"},qe={key:0,class:""},Ze={class:"tacky"},Ge=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"App 2"),e("th",null,"ID"),e("th",null,"Nama Pekerja"),e("th",null,"No Pol"),e("th",null,"Kejadian"),e("th",null,"Nominal"),e("th",null,"Nominal Potongan"),e("th",null,"Sisa Potongan"),e("th",null,"Status"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),Qe=["onClick"],We={class:"flex items-center justify-center"},Xe={class:"flex items-center justify-center"},et={class:"bold"},At={__name:"index",async setup(tt){let g,T;const{$moment:j}=Ue(),{pointFormat:D}=y(),n={};n._TimeZoneOffset=new Date().getTimezoneOffset(),n.sort="created_at:desc";const N=he("token"),{data:K}=([g,T]=ye(async()=>$e(async()=>{let s=[];C().loading_full=!0;const{data:l,error:h,status:P}=await J("/potongan_msts",{method:"get",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},params:n,retry:0});return C().loading_full=!1,P.value==="error"?(O().trigger(h),{potongan_msts:s}):(s=l.value.data,{potongan_msts:s})},"$4H5grU4zhJ")),g=await g,T(),g),u=a(K.value.potongan_msts),_=a(""),f=a({field:"created_at",by:"desc"}),d=a(-1),i=a({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),Y=()=>{n.like="",_.value!=""&&(n.like=`id:%${_.value}%,employee_name:%${_.value}%,no_pol:%${_.value}%,info:%${_.value}%,status:%${_.value}%`),n.sort="",f.value.field&&(n.sort=f.value.field+":"+f.value.by)},k=a(null),F=async()=>{C().loading_full=!0,i.value.may_get_data=!1,n.page=i.value.page,n.page==1&&(u.value=[]),n.first_row&&delete n.first_row,n.page>1&&(n.first_row=JSON.stringify(u.value[0]));const{data:s,error:l,status:h}=await J("/potongan_msts",{method:"get",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},params:n,retry:0});if(C().loading_full=!1,i.value.may_get_data=!0,h.value==="error"){O().trigger(l);return}i.value.page==1?(u.value=s.value.data,k.value&&(k.value.scrollTop=0)):i.value.page>1&&(u.value=[...u.value,...s.value.data]),s.value.data.length==0&&(i.value.is_last_record=!0)},q=async()=>{if(!i.value.may_get_data)return;let s=k.value;if(s.scrollLeft!=i.value.scrollLeft){i.value.scrollLeft=s.scrollLeft;return}i.value.is_last_record||!(Math.round(s.scrollTop)+s.clientHeight>=s.scrollHeight-1)||(i.value.page++,await F())},Z=()=>{i.value.page=1,i.value.is_last_record=!1,Y(),F()};ge();const v=a(!1),w=a(0),S=a(0),G=()=>{w.value=0,v.value=!0,S.value=!1},{display:$}=R();ke(R());const Q=()=>{d.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(w.value=u.value[d.value].id,v.value=!0,S.value=!1)},A=a(!1),H=a(0),I=a(!1),W=()=>{d.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(H.value=u.value[d.value].id,A.value=!0)},X=()=>{d.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(w.value=u.value[d.value].id,v.value=!0,I.value=!0)},B=a(!1);a({}),a(!1);const ee=a("");return we(()=>ee.value,s=>{s.trim().length>0?B.value=!0:B.value=!1},{immediate:!1}),(s,l)=>{const h=ie,P=re,te=ue,oe=ce,se=_e,le=de,L=me,V=pe,ae=fe,ne=ve;return r(),m("div",Me,[p(h,{title:"List Potongan"}),e("div",Te,[e("div",je,[("useUtils"in s?s.useUtils:t(y))().checkPermission("potongan_mst.create")?(r(),m("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:l[0]||(l[0]=o=>G())},[p(P)])):x("",!0),("useUtils"in s?s.useUtils:t(y))().checkPermissions(["potongan_mst.modify","potongan_trx.create","potongan_trx.modify","potongan_trx.remove"])?(r(),m("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:l[1]||(l[1]=o=>Q())},[p(te)])):x("",!0),t(d)>-1&&("useUtils"in s?s.useUtils:t(y))().checkPermission("potongan_mst.view")?(r(),m("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:l[2]||(l[2]=o=>X())},[p(oe)])):x("",!0),("useUtils"in s?s.useUtils:t(y))().checkPermissions(["potongan_mst.val","potongan_mst.val1","potongan_trx.val","potongan_trx.val1"])?(r(),m("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:l[3]||(l[3]=o=>W())},[p(se)])):x("",!0)]),e("form",Ne,[e("div",Fe,[He,M(e("input",{class:"",type:"text","onUpdate:modelValue":l[4]||(l[4]=o=>be(_)?_.value=o:null),name:"search",placeholder:"Keyword"},null,512),[[xe,t(_)]])]),e("div",Ie,[Be,M(e("select",{class:"","onUpdate:modelValue":l[5]||(l[5]=o=>t(f).field=o)},Ve,512),[[E,t(f).field]])]),e("div",ze,[Re,M(e("select",{class:"","onUpdate:modelValue":l[6]||(l[6]=o=>t(f).by=o)},Je,512),[[E,t(f).by]])]),e("div",Ke,[e("button",{class:"",type:"submit",name:"button",onClick:l[7]||(l[7]=Ce(o=>Z(),["prevent"]))},[p(le,{class:"text-2xl"})])])]),e("div",Ye,[t(u).length==0?(r(),m("div",qe," Maaf Tidak Ada Record ")):(r(),m("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:k,onScroll:q},[e("table",Ze,[Ge,e("tbody",null,[(r(!0),m(De,null,Se(t(u),(o,U)=>{var z;return r(),m("tr",{key:U,onClick:ot=>d.value=U,class:Ae(t(d)==U?"active":"")},[e("td",null,[e("div",We,[o.val?(r(),b(V,{key:1})):(r(),b(L,{key:0}))])]),e("td",null,[e("div",Xe,[o.val1?(r(),b(V,{key:1})):(r(),b(L,{key:0}))])]),e("td",et,c(o.id),1),e("td",null,c((z=o.employee)==null?void 0:z.name),1),e("td",null,c(o.no_pol),1),e("td",null,c(o.kejadian),1),e("td",null,c(t(D)(o.nominal)),1),e("td",null,c(t(D)(o.nominal_cut)),1),e("td",null,c(t(D)(o.remaining_cut)),1),e("td",null,c(o.status),1),e("td",null,c(o.created_at?t(j)(o.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,c(o.updated_at?t(j)(o.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,Qe)}),128))])])],544))])]),p(ae,{show:t(v),fnClose:()=>{v.value=!1},id:t(w),p_data:t(u),is_copy:t(S),is_view:t(I)},null,8,["show","fnClose","id","p_data","is_copy","is_view"]),p(ne,{show:t(A),fnClose:()=>{A.value=!1},id:t(H),p_data:t(u)},null,8,["show","fnClose","id","p_data"])])}}};export{At as default};
