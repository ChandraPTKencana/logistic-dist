import W from"./Header.2db4b3ee.js";import X from"./Plus.e9db1a54.js";import ee from"./Edit.4c477d8d.js";import te from"./Delete.eb1bce1a.js";import se from"./Search.014ca2ec.js";import{_ as ae}from"./PopupMini.vue.98509531.js";import oe from"./user.37ee8394.js";import{h as le,k as ne,r as c,i as re,z,A as ue,c as g,a as e,b as f,n as $,q as ie,m as o,B as ce,C as E,F,D as de,l as _e,x as m,y as T,o as y,E as fe,t as v,p as pe,e as me,H as ve}from"./entry.026e5532.js";import{u as M}from"./useMyFetch.f0db4149.js";import{_ as he}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.75e4d24e.js";import"./Exclamation.22cd90f8.js";import"./HeaderPopup.vue.ff9da216.js";import"./useUtils.7a44f3e9.js";const r=k=>(pe("data-v-a6cba22e"),k=k(),me(),k),ge={class:"w-full h-full flex flex-col"},ye={class:"w-full flex grow flex-col overflow-auto h-0"},ke={class:"w-full flex"},xe={class:"w-full flex p-1"},be={class:"grow"},we=r(()=>e("div",{class:"font-bold"}," Keyword ",-1)),De={class:"pl-1"},Se=r(()=>e("div",{class:"font-bold"}," Sort By ",-1)),Ae=r(()=>e("option",{value:""},null,-1)),Ce=r(()=>e("option",{value:"username"},"Username",-1)),$e=r(()=>e("option",{value:"hak_akses"},"Hak Akses",-1)),Te=r(()=>e("option",{value:"is_active"},"Status",-1)),Me=[Ae,Ce,$e,Te],He={class:"pl-1"},Be=r(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),Le=r(()=>e("option",{value:"asc"},"Asc",-1)),Ie=r(()=>e("option",{value:"desc"},"Desc",-1)),Ue=[Le,Ie],ze={class:"flex items-end pl-1"},Ee={class:"w-full flex justify-center items-center grow h-0 p-1"},Fe={key:0,class:""},Re={class:"tacky"},je=r(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"Username"),e("th",null,"Hak Akses"),e("th",null,"Status"),e("th",null,"Tanggal Dibuat"),e("th",null,"Tanggal Diubah")])],-1)),Ne=["onClick"],Ve={class:"bold"},Pe={__name:"index",async setup(k){let x,H;const{$moment:B}=ve(),u={};u._TimeZoneOffset=new Date().getTimezoneOffset();const S=le("token"),{data:n}=([x,H]=ne(async()=>_e(async()=>{m().loading_full=!0;const{data:s,error:t,status:_}=await M("/users",{method:"get",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},params:u,retry:0});return m().loading_full=!1,_.value==="error"?(T().trigger(t),[]):s.value.data},"$4SJ9UL5Y8i")),x=await x,H(),x),p=c(""),d=c({field:"",by:"desc"}),i=c(-1),l=c({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),R=()=>{u.like="",p.value!=""&&(u.like=`id:%${p.value}%,username:%${p.value}%`),u.sort="",d.value.field&&(u.sort=d.value.field+":"+d.value.by)},b=c(null),L=async()=>{m().loading_full=!0,l.value.may_get_data=!1,u.page=l.value.page,u.page==1&&(n.value=[]);const{data:s,error:t,status:_}=await M("/users",{method:"get",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},params:u,retry:0});if(m().loading_full=!1,l.value.may_get_data=!0,_.value==="error"){T().trigger(t);return}l.value.page==1?(n.value=s.value.data,b.value&&(b.value.scrollTop=0)):l.value.page>1&&(n.value=[...n.value,...s.value.data]),s.value.data.length==0&&(l.value.is_last_record=!0)},j=async()=>{if(!l.value.may_get_data)return;let s=b.value;if(s.scrollLeft!=l.value.scrollLeft){l.value.scrollLeft=s.scrollLeft;return}l.value.is_last_record||!(Math.round(s.scrollTop)+s.clientHeight>=s.scrollHeight-1)||(l.value.page++,await L())},N=()=>{l.value.page=1,l.value.is_last_record=!1,R(),L()};re();const w=c(!1),A=c(0),V=()=>{A.value=0,w.value=!0},{display:I}=z();ue(z());const P=()=>{i.value==-1?I({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(A.value=n.value[i.value].id,w.value=!0)},U=c({}),h=c(!1),O=async()=>{h.value&&(h.value=!1)},Y=()=>{i.value==-1?I({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(U.value={id:n.value[i.value].id},h.value=!0)},K=async()=>{m().loading_full=!0;const s=new FormData;s.append("id",n.value[i.value].id),s.append("_method","DELETE");const{data:t,error:_,status:C}=await M("/user",{method:"post",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},body:s,retry:0});if(m().loading_full=!1,C.value==="error"){T().trigger(_);return}n.value.splice(i.value,1),i.value=-1,h.value=!1};return(s,t)=>{const _=W,C=X,q=ee,J=te,Z=se,G=ae,Q=oe;return y(),g(F,null,[e("div",ge,[f(_,{title:"List User"}),e("div",ye,[e("div",ke,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[0]||(t[0]=a=>V())},[f(C)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=a=>P())},[f(q)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=a=>Y())},[f(J)])]),e("div",xe,[e("div",be,[we,$(e("input",{class:"",type:"text","onUpdate:modelValue":t[3]||(t[3]=a=>ce(p)?p.value=a:null),name:"search",placeholder:"Keyword"},null,512),[[ie,o(p)]])]),e("div",De,[Se,$(e("select",{class:"","onUpdate:modelValue":t[4]||(t[4]=a=>o(d).field=a)},Me,512),[[E,o(d).field]])]),e("div",He,[Be,$(e("select",{class:"","onUpdate:modelValue":t[5]||(t[5]=a=>o(d).by=a)},Ue,512),[[E,o(d).by]])]),e("div",ze,[e("button",{class:"",type:"button",name:"button",onClick:t[6]||(t[6]=a=>N())},[f(Z,{class:"text-2xl"})])])]),e("div",Ee,[o(n).length==0?(y(),g("div",Fe," Maaf Tidak Ada Record ")):(y(),g("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:j},[e("table",Re,[je,e("tbody",null,[(y(!0),g(F,null,de(o(n),(a,D)=>(y(),g("tr",{key:D,onClick:Oe=>i.value=D,class:fe(o(i)==D?"active":"")},[e("td",null,v(D+1)+".",1),e("td",Ve,v(a.username),1),e("td",null,v(a.hak_akses),1),e("td",null,v(a.is_active?"Aktif":"Nonaktif"),1),e("td",null,v(o(B)(a.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,v(o(B)(a.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,Ne))),128))])])],544))])])]),f(G,{type:"delete",show:o(h),data:o(U),fnClose:O,fnConfirm:K},null,8,["show","data"]),f(Q,{show:o(w),fnClose:()=>{w.value=!1},id:o(A),p_data:o(n)},null,8,["show","fnClose","id","p_data"])],64)}}},lt=he(Pe,[["__scopeId","data-v-a6cba22e"]]);export{lt as default};
