import{_ as M}from"./HeaderPopup.vue.d6400a7b.js";import N from"./Refresh.c10f9dad.js";import{g as x,r as _,f as R,k as b,L as j,o as i,c as u,a as e,b as S,m as z,l as r,t as f,F as C,E as L,x as m,v as V,G as $,y as A,p as E,e as H}from"./entry.d9b45284.js";import{u as O}from"./useMyFetch.405cdccc.js";import{_ as q}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.6df50bd1.js";const J=n=>(E("data-v-8a91e945"),n=n(),H(),n),P={class:"box-fixed"},G={class:"w-full flex grow flex-col overflow-auto h-0"},U={class:"w-full flex justify-between flex-wrap"},Z={class:"grow flex"},K=["value"],Q=["value"],W={class:"w-full flex justify-center items-center grow h-0 p-1"},X={key:0,class:""},Y={class:"tacky"},ee=J(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"Jenis Tiket"),e("th",null,"No Ticket"),e("th",null,"Lebih")])],-1)),te=["onClick"],ae={__name:"trx_trp_ticket_over",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1}},setup(n){const T=n,o={};o._TimeZoneOffset=new Date().getTimezoneOffset(),o.sort="tanggal:desc";const d=x("company_code"),v=_(d.value),y=_({}),B=x("token"),c=_([]),h=_(-1),t=_({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),g=async()=>{m().loading_full=!0,y.value={},t.value.may_get_data=!1,o.page=t.value.page,o.page==1&&(c.value=[]),o.first_row&&delete o.first_row,o.page>1&&(o.first_row=JSON.stringify(c.value[0])),o.pabrik=v.value;const{data:a,error:s,status:k}=await O("/trx_trps/ticket_over",{method:"get",headers:{Authorization:`Bearer ${B.value}`,Accept:"application/json"},params:o,retry:0});if(m().loading_full=!1,t.value.may_get_data=!0,k.value==="error"){A().trigger(s,y);return}t.value.page==1?c.value=a.value.data:t.value.page>1&&(c.value=[...c.value,...a.value.data]),a.value.data.length==0&&(t.value.is_last_record=!0),m()._tv.filter_box=!1},D=()=>{h.value=-1,t.value.page=1,t.value.is_last_record=!1,g()},w=_(null),F=async()=>{if(!t.value.may_get_data)return;let a=w.value;if(a.scrollLeft!=t.value.scrollLeft){t.value.scrollLeft=a.scrollLeft;return}t.value.is_last_record||!(Math.round(a.scrollTop)+a.clientHeight>=a.scrollHeight-1)||(t.value.page++,await g())};return R(()=>T.show,(a,s)=>{a==!0&&g()},{immediate:!0}),(a,s)=>{const k=M,I=N;return b((i(),u("section",P,[e("div",null,[S(k,{title:"Form Check Tickets",fn:n.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("div",G,[e("div",U,[e("div",Z,[b(e("select",{"onUpdate:modelValue":s[0]||(s[0]=l=>z(v)?v.value=l:null)},[e("option",{value:r(d)},f(r(d)),9,K),(i(!0),u(C,null,L(r(m)().list_pabrik.filter(l=>l!=r(d)),l=>(i(),u("option",{value:l},f(l),9,Q))),256))],512),[[V,r(v)]]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:s[1]||(s[1]=l=>D())},[S(I)])])]),e("div",W,[r(c).length==0?(i(),u("div",X," Maaf Tidak Ada Record ")):(i(),u("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:w,onScroll:F},[e("table",Y,[ee,e("tbody",null,[(i(!0),u(C,null,L(r(c),(l,p)=>(i(),u("tr",{key:p,onClick:le=>h.value=p,class:$(r(h)==p?"active":"")},[e("td",null,f(p+1)+".",1),e("td",null,f(l.jenis),1),e("td",null,f(l.ticket_no),1),e("td",null,f(l.lebih),1)],10,te))),128))])])],544))])])])],512)),[[j,n.show]])}}},ue=q(ae,[["__scopeId","data-v-8a91e945"]]);export{ue as default};
