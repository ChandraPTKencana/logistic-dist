import{_ as Me}from"./Header.7ed22eaf.js";import{_ as Ve,a as Pe}from"./ac_accs.5bbe4a1b.js";import{_ as xe}from"./Plus.6051031f.js";import{_ as Be}from"./Edit.158d6997.js";import{_ as qe}from"./Eyes.5c544566.js";import{_ as Re}from"./Delete.38798261.js";import{_ as ze}from"./Signature.d00cb71d.js";import{_ as He}from"./Search.6251252c.js";import{_ as Le}from"./Line.e68bf50f.js";import{_ as Ee}from"./Check.f37651e7.js";import{_ as Ye}from"./PopupMini.vue.949c687b.js";import{_ as ye}from"./HeaderPopup.vue.7aef427f.js";import{_ as Oe,a as Ke}from"./ToolsPopup.f689f901.js";import{_ as Je}from"./Times.9fb78a7f.js";import{_ as Ge}from"./InputPointFormat.vue.341dc17f.js";import{r as u,f as ie,J as ce,g as _e,o as n,c,h as z,v as be,a as e,b as k,k as t,j as ae,t as i,G as C,d as oe,F as ee,n as fe,q as V,K as le,l as re,m as pe,x as I,y as X,p as $e,e as ge,s as ke,D as Xe,B as Ze,H as he,I as Qe,i as we,w as We,E as et}from"./entry.305f92b2.js";import{u as G}from"./useUtils.39deb1be.js";import{u as Z}from"./useMyFetch.0ca0d699.js";import{_ as Ae}from"./_plugin-vue_export-helper.c27b6911.js";const F=x=>($e("data-v-70fbf165"),x=x(),ge(),x),tt={class:"box-fixed"},st={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},lt={class:"w-full flex flex-col items-center grow overflow-auto"},at={class:"w-full flex flex-row flex-wrap"},ot={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},nt=F(()=>e("label",{for:""},"Name",-1)),it=["disabled"],ct={class:"text-red-500"},ut={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},dt=F(()=>e("label",{for:""},"Tipe",-1)),rt=["disabled"],_t={class:"text-red-500"},ft={class:"w-full sm:w-4/12 md:w-2/12 lg:w-1/12 flex flex-col flex-wrap p-1"},pt=F(()=>e("label",{for:""},"Amount",-1)),mt={class:"card-border disabled"},vt={class:"text-red-500"},ht={class:"w-full flex p-1 2xl:overflow-hidden justify-between flex-wrap"},wt={class:"w-full",role:"sticky"},xt={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},yt={class:"sticky -top-1 !z-[2]"},bt=["colspan"],$t={class:"sticky top-7 !z-[2]"},gt={key:0,class:"min-w-[30px] !w-[30px] max-w-[30px]"},kt=F(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),At={key:1,class:"min-w-[30px] !w-[30px] max-w-[30px]"},Ct=F(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),St=F(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),Dt=F(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),It=F(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),jt={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Tt=F(()=>e("br",null,null,-1)),Ft={class:"text-sm"},Ut=F(()=>e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"For",-1)),Nt={ref:"to_move"},Mt=["data-index"],Vt={key:0,class:"tools cell"},Pt={class:"w-full h-full flex items-center justify-center"},Bt=["onClick"],qt={key:1,class:"cell"},Rt={class:"w-full h-full flex items-center justify-center"},zt=["onClick"],Ht=["onClick","disabled"],Lt={class:"w-full h-full flex items-center justify-center"},Et={class:"w-full h-full flex items-center justify-center"},Yt={class:"w-full h-full flex items-center justify-center"},Ot={class:"cell"},Kt={class:"w-full h-full flex items-center justify-center"},Jt=["disabled","onUpdate:modelValue"],Gt={class:"w-full h-full flex items-center justify-center"},Xt={class:"w-full h-full flex items-center justify-center"},Zt=["onUpdate:modelValue","disabled"],Qt=F(()=>e("option",{value:"Supir"},"Supir",-1)),Wt=F(()=>e("option",{value:"Kernet"},"Kernet",-1)),es=[Qt,Wt],ts={key:0},ss={class:"tools cell"},ls={class:"w-full flex items-center justify-end"},as={__name:"standby_mst",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(x){const v=x,{pointFormat:Y}=G(),H={id:-1,name:"",tipe:"",amount:0,details:[]},_=u({...H}),s=ie("token"),j=u({});u([{xdesc:"Gaji Kernet",qty:1,harga:0},{xdesc:"U.Extrafooding",qty:1,harga:2e4}]);const d=u([]),w=u({ordinal:0,id:-1,ac_account_id:"",ac_account_name:"",ac_account_code:"",description:"",amount:0,xfor:"",p_status:""}),S=u(!1),N=()=>{S.value=!1},y=o=>{d.value[f.value].ac_account_id=o.ac_account_id,d.value[f.value].ac_account_code=o.ac_account_code,d.value[f.value].ac_account_name=o.ac_account_name,S.value=!1},A=(o,a)=>{f.value=a,S.value=!0},P=(o,a)=>{d.value[a].ac_account_id="",d.value[a].ac_account_code="",d.value[a].ac_account_name=""},b=async()=>{I().loading_full=!0,j.value={};const o=new FormData;o.append("name",_.value.name),o.append("tipe",_.value.tipe),o.append("amount",_.value.amount),o.append("details",JSON.stringify(d.value));let a="post",B=v.is_copy?0:v.id;B==0||(o.append("id",B),o.append("_method","PUT"));const{data:M,error:T,status:W}=await Z("/standby_mst",{method:a,headers:{Authorization:`Bearer ${s.value}`,Accept:"application/json"},body:o,retry:0});if(I().loading_full=!1,W.value==="error"){X().trigger(T,j);return}if(B<=0)_.value.id=M.value.id,_.value.created_at=M.value.created_at,_.value.updated_at=M.value.updated_at,v.p_data.unshift(_.value);else{_.value.updated_at=M.value.updated_at;let q=v.p_data.map(R=>R.id).indexOf(B);q>=-1&&v.p_data.splice(q,1,{..._.value})}v.fnClose()},g=ce(()=>{let o=0;return d.value.forEach(a=>{a.p_status!="Remove"&&(o+=1*a.amount)}),_.value.amount=o,o}),f=u(-1),p=u(!1),D=u({left:0,top:0}),O=(o,a)=>{f.value=a,p.value=!0,D.value={left:o.clientX,top:o.clientY}},L=()=>{d.value.push({...w.value,p_status:"Add"})},te=()=>{p.value=!1},K=(o="")=>{if(o=="insert")d.value.splice(f.value,0,{...w.value,p_status:"Add"});else if(o=="delete")d.value[f.value].p_status=="Edit"?d.value[f.value].p_status="Remove":d.value.splice(f.value,1);else if(o=="move_top"){let a=d.value[f.value];d.value.splice(f.value,1),d.value.splice(f.value-1,0,{...a})}else if(o=="move_bottom"){let a=d.value[f.value];d.value.splice(f.value,1),d.value.splice(f.value+1,0,{...a})}p.value=!1},ne=ie("role"),$=ce(()=>_.value.val&&_.value.val1||ne.value=="Logistic"&&_.value.val||ne.value=="PabrikTransport"&&_.value.val1),Q=async()=>{I().loading_full=!0;const{data:o,error:a,status:B}=await Z("/standby_mst",{method:"get",headers:{Authorization:`Bearer ${s.value}`,Accept:"application/json"},params:{id:v.id},retry:0});if(I().loading_full=!1,B.value==="error"){X().trigger(a);return}_.value=o.value.data;let M="Edit";v.is_copy&&(M="Add",_.value.val=0,_.value.val1=0),d.value=o.value.data.details.map(T=>(T.p_status=M,T.key=T.ordinal,T))};return _e(()=>v.show,(o,a)=>{o==!0&&(_.value={...H},d.value=[],v.id!=0&&Q())},{immediate:!0}),(o,a)=>{const B=ye,M=Oe,T=Je,W=Ge,q=xe,R=Ke,ue=Ve;return n(),c(ee,null,[z(e("section",tt,[e("div",null,[k(B,{title:"Form StandBy Mst",fn:x.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",st,[e("div",lt,[e("div",at,[e("div",ot,[nt,z(e("input",{"onUpdate:modelValue":a[0]||(a[0]=h=>t(_).name=h),disabled:t($)},null,8,it),[[ae,t(_).name]]),e("p",ct,i(t(j).name),1)]),e("div",ut,[dt,z(e("input",{"onUpdate:modelValue":a[1]||(a[1]=h=>t(_).tipe=h),disabled:t($)},null,8,rt),[[ae,t(_).tipe]]),e("p",_t,i(t(j).tipe),1)]),e("div",ft,[pt,e("div",mt,i(t(Y)(t(g))),1),e("p",vt,i(t(j).amount),1)])]),e("div",ht,[e("div",wt,[e("table",xt,[e("thead",null,[e("tr",yt,[e("td",{colspan:t($)?7:9,class:"!bg-slate-800 text-white font-bold"}," Detail ",8,bt)]),e("tr",$t,[t($)?C("",!0):(n(),c("th",gt)),kt,t($)?C("",!0):(n(),c("th",At)),Ct,St,Dt,It,e("th",jt,[oe("Amount "),Tt,oe(),e("span",Ft,"("+i(t(Y)(t(g)))+")",1)]),Ut])]),e("tbody",Nt,[(n(!0),c(ee,null,fe(t(d),(h,E)=>(n(),c(ee,{key:E},[h.p_status!="Remove"?(n(),c("tr",{key:0,"data-index":E},[t($)?C("",!0):(n(),c("td",Vt,[e("div",Pt,[e("button",{type:"button",name:"button",onClick:l=>O(l,E)},[k(M)],8,Bt)])])),e("td",null,i(E+1)+".",1),t($)?C("",!0):(n(),c("td",qt,[e("div",Rt,[h.ac_account_id?(n(),c("button",{key:1,type:"button",onClick:l=>P(l,E),disabled:h.confirm_by},[k(T,{class:"font-bold text-2xl"})],8,Ht)):(n(),c("button",{key:0,type:"button",name:"button",onClick:l=>A(l,E)}," ... ",8,zt))])])),e("td",{class:V(["cell bold",t($)?"unselectable":""])},[e("div",Lt,i(h.ac_account_id),1)],2),e("td",{class:V(["cell bold",t($)?"unselectable":""])},[e("div",Et,i(h.ac_account_code),1)],2),e("td",{class:V(["cell bold",t($)?"unselectable":""])},[e("div",Yt,i(h.ac_account_name),1)],2),e("td",Ot,[e("div",Kt,[z(e("textarea",{disabled:t($),class:"p-1 w-full","onUpdate:modelValue":l=>h.description=l,cols:"7",rows:"2"},null,8,Jt),[[ae,h.description]])])]),e("td",{class:V(["cell bold",t($)?"unselectable":""])},[e("div",Gt,[(n(),le(W,{key:E,class:"w-full h-full p-1",type:"text",value:h.amount||0,onInput:l=>h.amount=l,show:x.show,disabled:t($)},null,8,["value","onInput","show","disabled"]))])],2),e("td",{class:V(["cell",t($)?"unselectable":""])},[e("div",Xt,[z(e("select",{"onUpdate:modelValue":l=>h.xfor=l,disabled:t($)},es,8,Zt),[[re,h.xfor]])])],2)],8,Mt)):C("",!0)],64))),128)),t($)?C("",!0):(n(),c("tr",ts,[e("td",ss,[e("button",{type:"button",name:"button",onClick:a[2]||(a[2]=h=>L())},[k(q)])])]))],512)])])])]),e("div",ls,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:a[3]||(a[3]=h=>x.fnClose())}," Cancel "),t($)?C("",!0):(n(),c("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:a[4]||(a[4]=pe(h=>b(),["prevent"]))}," Save "))])])])],512),[[be,x.show]]),k(R,{show:t(p),coor:t(D),fn:te,data:t(d),data_index:t(f),onReplyAct:a[5]||(a[5]=h=>K(h))},null,8,["show","coor","data","data_index"]),k(ue,{show:t(S),fnClose:N,fnSelect:y},null,8,["show"])],64)}}},os=Ae(as,[["__scopeId","data-v-70fbf165"]]);const U=x=>($e("data-v-9eadc2c9"),x=x(),ge(),x),ns={class:"box-fixed"},is={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},cs={class:"w-full flex flex-col items-center grow overflow-auto"},us={class:"w-full flex flex-row flex-wrap"},ds={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},rs=U(()=>e("label",{for:""},"Name",-1)),_s={class:"card-border"},fs={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ps=U(()=>e("label",{for:""},"Tipe",-1)),ms={class:"card-border"},vs={class:"w-full sm:w-4/12 md:w-2/12 lg:w-1/12 flex flex-col flex-wrap p-1"},hs=U(()=>e("label",{for:""},"Amount",-1)),ws={class:"card-border"},xs={class:"w-full flex grow p-1 2xl:overflow-hidden justify-between flex-wrap"},ys={class:"w-full",role:"sticky"},bs={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},$s=U(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"7",class:"!bg-slate-800 text-white font-bold"}," Detail PVR ")],-1)),gs={class:"sticky top-8 !z-[2]"},ks=U(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),As=U(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),Cs=U(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),Ss=U(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),Ds=U(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),Is={class:"min-w-[100px] !w-[100px] max-w-[100px]"},js=U(()=>e("br",null,null,-1)),Ts={class:"text-sm"},Fs=U(()=>e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"For",-1)),Us={ref:"to_move"},Ns=["data-index"],Ms={class:"w-full h-full flex items-center justify-center"},Vs={class:"w-full h-full flex items-center justify-center"},Ps={class:"w-full h-full flex items-center justify-center"},Bs={key:0,class:"cell"},qs={class:"w-full h-full flex items-center justify-center"},Rs={class:"w-full h-full flex items-center justify-center"},zs={class:"w-full flex items-center justify-end"},Hs={class:"w-full flex flex-wrap p-3 items-center"},Ls=U(()=>e("div",null," Di Validasi oleh : ",-1)),Es={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},Ys={key:0},Os={key:1},Ks={__name:"standby_mst_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(x){const v=x,{$moment:Y}=ke(),{pointFormat:H}=G(),s=u({...{id:-1,name:"",tipe:"",amount:0,details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:""}}),j=ie("token"),d=u({}),w=u(null),S=u([]),N=async()=>{I().loading_full=!0,d.value={};const b=new FormData;let g="post",f=v.id;f==0||(b.append("id",f),b.append("_method","PUT"));const{data:p,error:D,status:O}=await Z("/standby_mst_validasi",{method:g,headers:{Authorization:`Bearer ${j.value}`,Accept:"application/json"},body:b,retry:0});if(I().loading_full=!1,O.value==="error"){X().trigger(D,d);return}s.value.val=p.value.val,s.value.val_user=p.value.val_user,s.value.val_by=p.value.val_by,s.value.val_at=p.value.val_at,s.value.val1=p.value.val1,s.value.val1_user=p.value.val1_user,s.value.val1_by=p.value.val1_by,s.value.val1_at=p.value.val1_at;let L=v.p_data.map(te=>te.id).indexOf(v.id);L>=-1&&v.p_data.splice(L,1,{...s.value}),v.fnClose()},y=async()=>{I().loading_full=!0;const{data:b,error:g,status:f}=await Z("/standby_mst",{method:"get",headers:{Authorization:`Bearer ${j.value}`,Accept:"application/json"},params:{id:v.id},retry:0});if(I().loading_full=!1,f.value==="error"){X().trigger(g);return}s.value=b.value.data,S.value=b.value.data.details},A=ce(()=>{let b=0;return S.value.forEach(g=>{g.p_status!="Remove"&&(b+=parseInt(g.amount))}),b}),P=ce(()=>!1);return _e(()=>v.show,(b,g)=>{b==!0&&(v.is_view==!1&&setTimeout(()=>{w.value.focus()},1),y())},{immediate:!0}),(b,g)=>{const f=ye;return z((n(),c("section",ns,[e("div",null,[k(f,{title:"Form Master Standby Validation",fn:x.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",is,[e("div",cs,[e("div",us,[e("div",ds,[rs,e("div",_s,i(t(s).name),1)]),e("div",fs,[ps,e("div",ms,i(t(s).tipe),1)]),e("div",vs,[hs,e("div",ws,i(t(H)(t(s).amount||0)),1)])]),e("div",xs,[e("div",ys,[e("table",bs,[e("thead",null,[$s,e("tr",gs,[ks,As,Cs,Ss,Ds,e("th",Is,[oe("Amount "),js,oe(),e("span",Ts,"("+i(t(H)(t(A)))+")",1)]),Fs])]),e("tbody",Us,[(n(!0),c(ee,null,fe(t(S),(p,D)=>(n(),c(ee,{key:D},[p.p_status!="Remove"?(n(),c("tr",{key:0,"data-index":D},[e("td",null,i(D+1)+".",1),e("td",{class:V(["cell bold",t(P)?"unselectable":""])},[e("div",Ms,i(p.ac_account_id),1)],2),e("td",{class:V(["cell bold",t(P)?"unselectable":""])},[e("div",Vs,i(p.ac_account_code),1)],2),e("td",{class:V(["cell bold",t(P)?"unselectable":""])},[e("div",Ps,i(p.ac_account_name),1)],2),t(P)?C("",!0):(n(),c("td",Bs,[e("div",qs,i(p.description),1)])),e("td",{class:V(["cell bold",t(P)?"unselectable":""])},[e("div",Rs,i(t(H)(p.amount||0)),1)],2),e("td",{class:V(["cell",t(P)?"unselectable":""])},i(p.xfor),3)],8,Ns)):C("",!0)],64))),128))],512)])])])]),e("div",zs,[e("div",Hs,[Ls,t(s).val||t(s).val1?(n(),c("div",Es,[t(s).val?(n(),c("div",Ys," App 1 : "+i(t(s).val_by.username)+" ( "+i(t(s).val_at?t(Y)(t(s).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):C("",!0),t(s).val1?(n(),c("div",Os," App 2 : "+i(t(s).val1_by.username)+" ( "+i(t(s).val1_at?t(Y)(t(s).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):C("",!0)])):C("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:g[0]||(g[0]=p=>x.fnClose())}," Cancel "),x.is_view==0?(n(),c("button",{key:0,ref_key:"it_val",ref:w,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:g[1]||(g[1]=pe(p=>N(),["prevent"]))}," Validasi ",512)):C("",!0)])])])],512)),[[be,x.show]])}}},Js=Ae(Ks,[["__scopeId","data-v-9eadc2c9"]]),Gs={class:"w-full h-full flex flex-col"},Xs={class:"w-full flex grow flex-col overflow-auto h-0"},Zs={class:"w-full flex"},Qs={action:"#",class:"w-full flex p-1"},Ws={class:"grow"},el=e("div",{class:"font-bold"}," Keyword ",-1),tl={class:"pl-1"},sl=e("div",{class:"font-bold"}," Sort By ",-1),ll=e("option",{value:""},null,-1),al=e("option",{value:"id"},"ID",-1),ol=e("option",{value:"name"},"Name",-1),nl=e("option",{value:"tipe"},"Tipe",-1),il=[ll,al,ol,nl],cl={class:"pl-1"},ul=e("div",{class:"font-bold"}," Sort Order ",-1),dl=e("option",{value:"asc"},"Asc",-1),rl=e("option",{value:"desc"},"Desc",-1),_l=[dl,rl],fl={class:"flex items-end pl-1"},pl={class:"w-full flex justify-center items-center grow h-0 p-1"},ml={key:0,class:""},vl={class:"tacky"},hl=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"App 2"),e("th",null,"ID"),e("th",null,"Name"),e("th",null,"Tipe"),e("th",null,"Amount"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),wl=["onClick"],xl={class:"flex items-center justify-center"},yl={class:"flex items-center justify-center"},bl={class:"bold"},$l={class:"grow mb-5"},Ll={__name:"index",async setup(x){let v,Y;const{$moment:H}=ke(),{pointFormat:_}=G(),s={};s._TimeZoneOffset=new Date().getTimezoneOffset(),s.sort="created_at:desc";const j=ie("token"),{data:d}=([v,Y]=Xe(async()=>et(async()=>{let l=[];I().loading_full=!0;const{data:r,error:J,status:se}=await Z("/standby_msts",{method:"get",headers:{Authorization:`Bearer ${j.value}`,Accept:"application/json"},params:s,retry:0});return I().loading_full=!1,se.value==="error"?(X().trigger(J),{standby_msts:l}):(l=r.value.data,{standby_msts:l})},"$rczbThuP8g")),v=await v,Y(),v),w=u(d.value.standby_msts),S=u(""),N=u({field:"created_at",by:"desc"}),y=u(-1),A=u({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),P=()=>{s.like="",S.value!=""&&(s.like=`id:%${S.value}%,name:%${S.value}%,amount:%${S.value}%`),s.sort="",N.value.field&&(s.sort=N.value.field+":"+N.value.by)},b=u(null),g=async()=>{I().loading_full=!0,A.value.may_get_data=!1,s.page=A.value.page,s.page==1&&(w.value=[]),s.first_row&&delete s.first_row,s.page>1&&(s.first_row=JSON.stringify(w.value[0]));const{data:l,error:r,status:J}=await Z("/standby_msts",{method:"get",headers:{Authorization:`Bearer ${j.value}`,Accept:"application/json"},params:s,retry:0});if(I().loading_full=!1,A.value.may_get_data=!0,J.value==="error"){X().trigger(r);return}A.value.page==1?(w.value=l.value.data,b.value&&(b.value.scrollTop=0)):A.value.page>1&&(w.value=[...w.value,...l.value.data]),l.value.data.length==0&&(A.value.is_last_record=!0)},f=async()=>{if(!A.value.may_get_data)return;let l=b.value;if(l.scrollLeft!=A.value.scrollLeft){A.value.scrollLeft=l.scrollLeft;return}A.value.is_last_record||!(Math.round(l.scrollTop)+l.clientHeight>=l.scrollHeight-1)||(A.value.page++,await g())},p=()=>{A.value.page=1,A.value.is_last_record=!1,P(),g()};Ze();const D=u(!1),O=u(0),L=u(0),te=()=>{O.value=0,D.value=!0,L.value=!1},{display:K}=he();Qe(he());const ne=()=>{y.value==-1?K({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(O.value=w.value[y.value].id,D.value=!0,L.value=!1)},$=()=>{y.value==-1?K({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(O.value=w.value[y.value].id,D.value=!0,L.value=!0)},Q=u(!1),o=u(0),a=u(!1),B=()=>{y.value==-1?K({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(o.value=w.value[y.value].id,Q.value=!0,a.value=!1)},M=()=>{y.value==-1?K({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(o.value=w.value[y.value].id,Q.value=!0,a.value=!0)},T=u(!1),W=u({}),q=u(!1),R=u(""),ue=async()=>{q.value&&(q.value=!1)},h=()=>{y.value==-1?K({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(R.value="",W.value={id:w.value[y.value].id},q.value=!0)};_e(()=>R.value,l=>{l.trim().length>0?T.value=!0:T.value=!1},{immediate:!1});const E=async()=>{I().loading_full=!0;const l=new FormData;l.append("id",w.value[y.value].id),l.append("deleted_reason",R.value),l.append("_method","DELETE");const{data:r,error:J,status:se}=await Z("/standby_mst",{method:"post",headers:{Authorization:`Bearer ${j.value}`,Accept:"application/json"},body:l,retry:0});if(I().loading_full=!1,se.value==="error"){X().trigger(J);return}w.value.splice(y.value,1),y.value=-1,q.value=!1};return(l,r)=>{const J=Me,se=Pe,Ce=xe,Se=Be,De=qe,Ie=Re,je=ze,Te=He,me=Le,ve=Ee,Fe=Ye,Ue=os,Ne=Js;return n(),c("div",Gs,[k(J,{title:"List Standby"}),e("div",Xs,[e("div",Zs,[("useUtils"in l?l.useUtils:t(G))().checkRole(["Logistic"])?C("",!0):(n(),c("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:r[0]||(r[0]=m=>$())},[k(se)])),("useUtils"in l?l.useUtils:t(G))().checkRole(["Logistic"])?C("",!0):(n(),c("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:r[1]||(r[1]=m=>te())},[k(Ce)])),("useUtils"in l?l.useUtils:t(G))().checkRole(["Logistic"])?C("",!0):(n(),c("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:r[2]||(r[2]=m=>ne())},[k(Se)])),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:r[3]||(r[3]=m=>M())},[k(De)]),("useUtils"in l?l.useUtils:t(G))().checkRole(["PabrikTransport"])?C("",!0):(n(),c("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:r[4]||(r[4]=m=>h())},[k(Ie)])),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:r[5]||(r[5]=m=>B())},[k(je)])]),e("form",Qs,[e("div",Ws,[el,z(e("input",{class:"",type:"text","onUpdate:modelValue":r[6]||(r[6]=m=>we(S)?S.value=m:null),name:"search",placeholder:"Keyword"},null,512),[[ae,t(S)]])]),e("div",tl,[sl,z(e("select",{class:"","onUpdate:modelValue":r[7]||(r[7]=m=>t(N).field=m)},il,512),[[re,t(N).field]])]),e("div",cl,[ul,z(e("select",{class:"","onUpdate:modelValue":r[8]||(r[8]=m=>t(N).by=m)},_l,512),[[re,t(N).by]])]),e("div",fl,[e("button",{class:"",type:"submit",name:"button",onClick:r[9]||(r[9]=pe(m=>p(),["prevent"]))},[k(Te,{class:"text-2xl"})])])]),e("div",pl,[t(w).length==0?(n(),c("div",ml," Maaf Tidak Ada Record ")):(n(),c("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:f},[e("table",vl,[hl,e("tbody",null,[(n(!0),c(ee,null,fe(t(w),(m,de)=>(n(),c("tr",{key:de,onClick:gl=>y.value=de,class:V(t(y)==de?"active":"")},[e("td",null,[e("div",xl,[m.val?(n(),le(ve,{key:1})):(n(),le(me,{key:0}))])]),e("td",null,[e("div",yl,[m.val1?(n(),le(ve,{key:1})):(n(),le(me,{key:0}))])]),e("td",bl,i(m.id),1),e("td",null,i(m.name),1),e("td",null,i(m.tipe),1),e("td",null,i(t(_)(m.amount)),1),e("td",null,i(m.created_at?t(H)(m.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,i(m.updated_at?t(H)(m.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,wl))),128))])])],544))])]),k(Fe,{type:"delete",show:t(q),data:t(W),fnClose:ue,fnConfirm:E,enabledOk:t(T)},{footer:We(()=>[oe(" Masukkan Alasan Penghapusan: "),e("div",$l,[z(e("textarea",{"onUpdate:modelValue":r[10]||(r[10]=m=>we(R)?R.value=m:null)},null,512),[[ae,t(R)]])])]),_:1},8,["show","data","enabledOk"]),k(Ue,{show:t(D),fnClose:()=>{D.value=!1},id:t(O),p_data:t(w),is_copy:t(L)},null,8,["show","fnClose","id","p_data","is_copy"]),k(Ne,{show:t(Q),fnClose:()=>{Q.value=!1},id:t(o),p_data:t(w),is_view:t(a)},null,8,["show","fnClose","id","p_data","is_view"])])}}};export{Ll as default};
