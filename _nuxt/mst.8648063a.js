import{_ as G}from"./HeaderPopup.vue.68fc8f64.js";import{_ as H}from"./WidthMiniList.vue.dd9b1a58.js";import{_ as K}from"./InputPointFormat.vue.51a0aad3.js";import W from"./AttachmentSingle.ce264b54.js";import Q from"./part.3a1048e2.js";import{r as c,f as X,G as j,j as Y,m as N,J as Z,o as y,c as b,a as t,b as h,k as a,v as D,t as u,F as ee,y as te,q as ae,x as le,l as V,A as g,B as J,p as oe,e as se}from"./entry.d8926042.js";import{u as P}from"./useMyFetch.ef190efc.js";import{u as ne}from"./useUtils.45af66c8.js";import{_ as ie}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.2507741c.js";import"./WidthMiniPart.vue.689d0bbc.js";import"./PDFJsView.5be0233c.js";import"./Plus.fc20c6d2.js";import"./Edit.38352e21.js";import"./Signature.3fcded29.js";import"./Calculator.b38f6aa5.js";import"./Search.cd68ed20.js";import"./Line.d52a95df.js";import"./Check.5886cf77.js";import"./trx.24f75387.js";import"./trx_validasi.8a805856.js";const m=i=>(oe("data-v-98d5748d"),i=i(),se(),i),re={class:"box-fixed"},de={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-slate-200"},_e={class:"w-full flex flex-col items-center grow overflow-auto"},ue={class:"w-full p-1"},me={class:"w-full flex flex-row flex-wrap bg-white"},pe={class:"w-full flex flex-col flex-wrap p-1"},ce=m(()=>t("label",{for:""},"Kejadian",-1)),ve=["disabled"],fe={class:"text-red-500"},we={class:"w-full sm:w-9/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},he=m(()=>t("label",{for:""},"Pekerja",-1)),xe={class:"text-red-500"},ge={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ye=m(()=>t("label",{for:""},"No Pol",-1)),be=["disabled"],ke={id:"vehicle"},Se=["value"],Ne={class:"text-red-500"},Ce={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Oe=m(()=>t("label",{for:""},"Nominal",-1)),je={class:"w-full"},Je={class:"text-red-500"},Pe={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ie=m(()=>t("label",{for:""},"Nominal Potong",-1)),Fe={class:"w-full"},$e={class:"text-red-500"},Be={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ue=m(()=>t("label",{for:""},"Sisa Potongan",-1)),Ae={class:"card-border"},De={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ve=m(()=>t("label",{for:""},"Status",-1)),qe=["disabled"],Le=m(()=>t("option",{value:"Open"},"Open",-1)),Me=m(()=>t("option",{value:"Close Clear"},"Close Clear",-1)),ze=m(()=>t("option",{value:"Close UnClear"},"Close UnClear",-1)),Ee=[Le,Me,ze],Re={class:"text-red-500"},Te={class:"w-full flex flex-col flex-wrap p-1"},Ge={class:"text-red-500"},He={class:"w-full flex flex-col flex-wrap p-1"},Ke={class:"text-red-500"},We={class:"w-full flex flex-row flex-wrap p-1 justify-end"},Qe={key:0,class:"w-full h-full p-1"},Xe={class:"w-full flex items-center justify-end bg-white"},Ye={__name:"mst",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(i){const r=i,C={id:-1,kejadian:"",employee:{id:-1,name:""},no_pol:"",nominal:0,nominal_cut:0,remaining_cut:0,status:"Open",attachment_1:"",attachment_1_preview:"",attachment_2:"",attachment_2_preview:"",val_at:""},q=c([]);c({ordinal:0,id:"",tanggal:new Date,note:"",p_status:""}),JSON.parse(JSON.stringify(C));const l=c(JSON.parse(JSON.stringify(C))),O=X("token"),_=c({}),L=async()=>{g().loading_full=!0,_.value={};const s=new FormData;s.append("kejadian",l.value.kejadian),s.append("nominal",l.value.nominal),s.append("nominal_cut",l.value.nominal_cut),s.append("status",l.value.status),s.append("employee_id",d.value.id),s.append("no_pol",l.value.no_pol),s.append("attachment_1",l.value.attachment_1),s.append("attachment_1_preview",l.value.attachment_1_preview),s.append("attachment_2",l.value.attachment_2),s.append("attachment_2_preview",l.value.attachment_2_preview);let e="post",p=r.id;p==0||(s.append("id",p),s.append("_method","PUT"));const{data:n,error:v,status:f}=await P("/potongan_mst",{method:e,headers:{Authorization:`Bearer ${O.value}`,Accept:"application/json"},body:s,retry:0});if(g().loading_full=!1,f.value==="error"){J().trigger(v,_);return}if(l.value.employee.id=d.value.id,l.value.employee.name=d.value.name,l.value.remaining_cut=n.value.remaining_cut,l.value.updated_at=n.value.updated_at,r.id<=0)l.value.id=n.value.id,l.value.created_at=n.value.created_at,r.p_data.unshift(l.value);else{let w=r.p_data.map(o=>o.id).indexOf(r.id);w>=-1&&r.p_data.splice(w,1,{...l.value})}r.fnClose()},k={_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:"",name:"",title:""},d=c(JSON.parse(JSON.stringify(k))),M=j(()=>{let s=[];return F.value.forEach((e,p)=>{let n=JSON.parse(JSON.stringify(k));n._.id.val=e.id,n._.name.val=e.name,n._.rek_no.val=e.rek_no,n._.rek_name.val=e.rek_name,n.id=e.id,n.name=e.name,n.title=(e.rek_no||"")+" "+(e.rek_name||""),s.push(JSON.parse(JSON.stringify(n)))}),s}),x=j(()=>l.value.val1==1||r.is_view),S=j(()=>l.value.val_at!=""||r.is_view),z=async()=>{var v,f,w,o,$,B,U,A;g().loading_full=!0;const{data:s,error:e,status:p}=await P("/potongan_mst",{method:"get",headers:{Authorization:`Bearer ${O.value}`,Accept:"application/json"},params:{id:r.id},retry:0});if(g().loading_full=!1,p.value==="error"){J().trigger(e);return}let n=s.value.data;l.value=n,{...n},d.value._.id.val=(v=n.employee)==null?void 0:v.id,d.value._.name.val=(f=n.employee)==null?void 0:f.name,d.value._.rek_no.val=(w=n.employee)==null?void 0:w.rek_no,d.value._.rek_name.val=(o=n.employee)==null?void 0:o.rek_name,d.value.id=($=n.employee)==null?void 0:$.id,d.value.name=(B=n.employee)==null?void 0:B.name,d.value.rek_no=(((U=n.employee)==null?void 0:U.rek_no)||"")+" "+(((A=n.employee)==null?void 0:A.rek_name)||"")},E=c([]),R=c([]),I=c([]),F=c([]),T=async()=>{g().loading_full=!0;const{data:s,error:e,status:p}=await P("/potongan_mst_load_local",{method:"get",headers:{Authorization:`Bearer ${O.value}`,Accept:"application/json"},retry:0});if(g().loading_full=!1,p.value==="error"){J().trigger(e);return}E.value=s.value.list_potongan_mst,R.value=s.value.list_xto,I.value=s.value.list_vehicle,F.value=s.value.list_employee};return Y(()=>r.show,async(s,e)=>{s==!0&&(r.is_view||await T(),l.value=JSON.parse(JSON.stringify(C)),d.value=JSON.parse(JSON.stringify(k)),q.value=[],_.value={},r.id!=0&&z())},{immediate:!0}),(s,e)=>{const p=G,n=H,v=K,f=W,w=Q;return N((y(),b("section",re,[t("div",null,[h(p,{title:"Form Potongan",fn:i.fnClose,class:"w-full flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",de,[t("div",_e,[t("div",ue,[t("div",me,[t("div",pe,[ce,N(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=o=>a(l).kejadian=o),rows:"10",disabled:a(x)}," ",8,ve),[[D,a(l).kejadian]]),t("p",fe,u(a(_).kejadian),1)]),t("div",we,[he,h(n,{arr:a(M),selected:a(d),pure:k,onSetSelected:e[1]||(e[1]=o=>d.value=o),disabled:a(S)},null,8,["arr","selected","disabled"]),t("p",xe,u(a(_).employee_id),1)]),t("div",ge,[ye,N(t("input",{type:"text",list:"vehicle","onUpdate:modelValue":e[2]||(e[2]=o=>a(l).no_pol=o),disabled:a(S)},null,8,be),[[D,a(l).no_pol]]),t("datalist",ke,[(y(!0),b(ee,null,te(a(I),o=>(y(),b("option",{value:o.no_pol},u(o.no_pol),9,Se))),256))]),t("p",Ne,u(a(_).no_pol),1)]),t("div",Ce,[Oe,t("div",je,[h(v,{class:"w-full h-full",type:"text",value:a(l).nominal||0,onInput:e[3]||(e[3]=o=>a(l).nominal=o),show:i.show,disabled:a(S)},null,8,["value","show","disabled"])]),t("p",Je,u(a(_).ref),1)]),t("div",Pe,[Ie,t("div",Fe,[h(v,{class:"w-full h-full",type:"text",value:a(l).nominal_cut||0,onInput:e[4]||(e[4]=o=>a(l).nominal_cut=o),show:i.show,disabled:a(x)},null,8,["value","show","disabled"])]),t("p",$e,u(a(_).ref),1)]),t("div",Be,[Ue,t("div",Ae,u(("useUtils"in s?s.useUtils:a(ne))().pointFormat(a(l).remaining_cut)),1)]),t("div",De,[Ve,N(t("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>a(l).status=o),disabled:a(x)},Ee,8,qe),[[ae,a(l).status]]),t("p",Re,u(a(_).ref),1)]),t("div",Te,[h(f,{label:"Lampiran Pertama",value:a(l).attachment_1_preview,onSetFile:e[6]||(e[6]=o=>a(l).attachment_1=o),onSetPreview:e[7]||(e[7]=o=>a(l).attachment_1_preview=o),can_remove:!a(S)},null,8,["value","can_remove"]),t("p",Ge,u(a(_).attachment_1),1)]),t("div",He,[h(f,{label:"Lampiran Lanjutan",value:a(l).attachment_2_preview,onSetFile:e[8]||(e[8]=o=>a(l).attachment_2=o),onSetPreview:e[9]||(e[9]=o=>a(l).attachment_2_preview=o),can_remove:!a(x)},null,8,["value","can_remove"]),t("p",Ke,u(a(_).attachment_2),1)]),t("div",We,[a(x)?V("",!0):(y(),b("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:e[10]||(e[10]=le(o=>L(),["prevent"]))}," Save "))])])]),a(x)?(y(),b("div",Qe,[h(w,{id:i.id,show:i.show,onUpdateRemainingCut:e[11]||(e[11]=o=>a(l).remaining_cut=o),is_view:i.is_view},null,8,["id","show","is_view"])])):V("",!0)]),t("div",Xe,[t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:e[12]||(e[12]=o=>i.fnClose())}," Close ")])])])],512)),[[Z,i.show]])}}},gt=ie(Ye,[["__scopeId","data-v-98d5748d"]]);export{gt as default};
