import{_ as A}from"./HeaderPopup.vue.2a33db0a.js";import{_ as M}from"./client-only.39d007ad.js";import{_ as V}from"./InputPointFormat.vue.0791745e.js";import{r as v,g as B,f as N,J as P,k as x,L as S,o as q,c as F,a as e,b as c,w as T,l as s,t as _,A as j,D as U,x as p,y as h,H as z}from"./entry.53fce88d.js";import{u as y}from"./useMyFetch.bdb404b5.js";import"./Times.afe9e524.js";import"./_plugin-vue_export-helper.c27b6911.js";const E={class:"box-fixed"},H={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},I={class:"w-full flex flex-col items-center grow overflow-auto"},O={class:"w-full flex flex-row flex-wrap"},R={class:"w-6/12 sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},J=e("label",{for:""},"Tanggal",-1),K={class:"grow"},L={class:"text-red-500"},Y={class:"w-6/12 sm:w-3/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},G=e("label",{for:""},"Nominal Potong",-1),Q={class:"w-full"},W={class:"text-red-500"},X={class:"w-full flex flex-col flex-wrap p-1"},Z=e("label",{for:""},"Keterangan",-1),ee={class:"text-red-500"},te={class:"w-full flex items-center justify-end"},de={__name:"trx",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},potongan_mst_id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},emits:["updateRemainingCut"],setup(u,{emit:b}){const l=u,{$moment:C}=z(),w={id:-1,note:"",nominal_cut:"",tanggal:new Date},t=v({...w}),g=B("token"),i=v({}),k=async()=>{p().loading_full=!0,i.value={};const o=new FormData;o.append("tanggal",C(t.value.tanggal).format("Y-MM-DD")),o.append("potongan_mst_id",l.potongan_mst_id),o.append("note",t.value.note),o.append("nominal_cut",t.value.nominal_cut);let a="post",r=l.id;r==0||(o.append("id",r),o.append("_method","PUT"));const{data:d,error:f,status:m}=await y("/potongan_trx",{method:a,headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},body:o,retry:0});if(p().loading_full=!1,m.value==="error"){h().trigger(f,i);return}if(t.value.updated_at=d.value.updated_at,l.id<=0)t.value.id=d.value.id,t.value.created_at=d.value.created_at,l.p_data.unshift(t.value);else{let n=l.p_data.map($=>$.id).indexOf(l.id);n>-1&&l.p_data.splice(n,1,{...t.value})}b("updateRemainingCut",d.value.remaining_cut),l.fnClose()},D=async()=>{p().loading_full=!0;const{data:o,error:a,status:r}=await y("/potongan_trx",{method:"get",headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},params:{id:l.id},retry:0});if(p().loading_full=!1,r.value==="error"){h().trigger(a);return}t.value=o.value.data};return N(()=>l.show,(o,a)=>{o==!0&&(t.value={...w},i.value={},l.id!=0&&D())},{immediate:!0}),(o,a)=>{const r=A,d=P("vue-date-picker"),f=M,m=V;return x((q(),F("section",E,[e("div",null,[c(r,{title:"Form Potongan Trx",fn:u.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",H,[e("div",I,[e("div",O,[e("div",R,[J,e("div",K,[c(f,null,{default:T(()=>[c(d,{modelValue:s(t).tanggal,"onUpdate:modelValue":a[0]||(a[0]=n=>s(t).tanggal=n),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1})]),e("p",L,_(s(i).tanggal),1)]),e("div",Y,[G,e("div",Q,[c(m,{class:"w-full h-full",type:"text",value:s(t).nominal_cut||0,onInput:a[1]||(a[1]=n=>s(t).nominal_cut=n),show:u.show,disabled:s(t).trx_trp_id},null,8,["value","show","disabled"])]),e("p",W,_(s(i).ref),1)]),e("div",X,[Z,x(e("textarea",{"onUpdate:modelValue":a[2]||(a[2]=n=>s(t).note=n),rows:"10"}," ",512),[[j,s(t).note]]),e("p",ee,_(s(i).note),1)])])]),e("div",te,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:a[3]||(a[3]=n=>u.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:a[4]||(a[4]=U(n=>k(),["prevent"]))}," Save ")])])])],512)),[[S,u.show]])}}};export{de as default};
