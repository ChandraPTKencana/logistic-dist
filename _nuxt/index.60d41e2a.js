import it from"./Header.65e61add.js";import nt from"./PrinterEye.08af2fba.js";import _t from"./Table2Column.1dd0cabe.js";import ct from"./Line.6b319695.js";import ut from"./Check.26eac6b4.js";import pt from"./TableView.95051249.js";import dt from"./Times.4d579b45.js";import{_ as ft}from"./HeaderPopup.vue.dd4f94fe.js";import{r as u,f as bt,g as mt,h as yt,x as p,i as kt,c as k,b as h,a as s,k as G,v as ht,l,m as vt,d as c,w as n,n as gt,J as xt,t as a,F as Z,D as Q,q as wt,y as $,o as f,E as Dt,z as S,H as Tt,G as $t}from"./entry.e1380d08.js";import{u as W}from"./useUtils.54831224.js";import{u as N}from"./useMyFetch.814350fc.js";import{u as St}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.64d837d8.js";import"./Adjust.7e796b55.js";import"./TableHeaderEye.0edadded.js";import"./ClearAll.02fba18d.js";import"./client-only.385a23fb.js";import"./ClearEach.d90a0f42.js";import"./CaretLeftDoubleBold.a9d80f7f.js";import"./CaretLeftBold.f7a6fe98.js";import"./CaretRightBold.bf5eb119.js";import"./CaretRightDoubleBold.9f8ed592.js";const Nt={class:"w-full h-full flex flex-col"},At={class:"w-full flex grow flex-col overflow-auto h-0"},Ct={class:"w-full flex"},Mt={class:"m-1"},Bt=Tt('<option value="ticket_not_done">Undone</option><option value="ticket_done">Done</option><option value="deleted">Trash</option><option value="all">All</option><option value="req_deleted">Req Delete</option>',5),Pt=[Bt],Ft=s("span",{class:"text-xs ml-1"}," PDF ",-1),Ht=s("span",{class:"text-xs ml-1"}," Excel ",-1),Rt={key:0,class:"w-full h-full flex items-center justify-center fixed top-0 left-0 z-20 p-3",style:{"background-color":"rgba(255,255,255,0.9)"}},Yt={class:"relative",style:{width:"95%",height:"90%"}},jt={class:"absolute -top-7 right-0 bg-white",style:{position:"absolute",padding:"5px 10px",border:"solid 1px #ccc","border-bottom":"none","border-top-right-radius":"5px","border-top-left-radius":"5px"}},Et=["src"],Ot={class:"w-full h-full fixed top-0 left-0 bg-gray-100 bg-opacity-80 flex items-center justify-center z-10"},Kt={class:"w-full sm:w-10/12 md:w-8/12 lg:w-6/12 bg-white flex flex-col border-solid border-gray-200 max-w-full max-h-full",style:{"border-width":"1px"}},qt={class:"p-1 flex flex-wrap overflow-auto items-start"},zt={class:"w-full sm:w-1/2 flex flex-wrap"},Vt={class:"flex flex-col m-2"},It=s("span",{class:"text-xs"}," To ",-1),Jt={class:""},Ut={class:"flex flex-col m-2"},Lt=s("span",{class:"text-xs"}," Tipe ",-1),Gt={class:""},Zt={class:"flex flex-col m-2"},Qt=s("span",{class:"text-xs"}," Jenis ",-1),Wt={class:""},Xt={class:"flex flex-col m-2"},te=s("span",{class:"text-xs"}," Ket. Untuk Remarks ",-1),ee={class:""},se={class:"w-full sm:w-1/2 text-sm flex justify-center"},oe={class:"border border-collapse border-black"},le=s("tr",null,[s("th",{colspan:"4",class:"bg-blue-400"}," List Uang Jalan ")],-1),ae={class:"p-1"},re={class:"p-1"},ie=s("td",{class:"p-1"},"= Rp.",-1),ne={class:"text-right p-1"},_e={class:"border-t-black border-dashed",style:{"border-top-width":"1px"}},ce=s("th",{colspan:"2",class:"text-right"},"Total",-1),ue=s("th",{class:"p-1 text-right"},"Rp.",-1),pe={class:"p-1 text-right"},de={class:"w-full mt-2 text-sm flex justify-center"},fe={class:"border border-collapse border-black"},be=s("tr",null,[s("th",{colspan:"5",class:"bg-blue-400"}," List PVR ")],-1),me={class:"p-1"},ye={class:"p-1"},ke={class:"p-1"},he=s("td",{class:"p-1"},"= Rp.",-1),ve={class:"text-right p-1"},ge={class:"border-t-black border-dashed",style:{"border-top-width":"1px"}},xe=s("th",{colspan:"2",class:"text-right"},"Total",-1),we=s("th",{class:"p-1 text-right"},"Rp.",-1),De={class:"p-1 text-right"},Te={class:"flex p-1 justify-end flex-wrap"},We={__name:"index",async setup($e){let g,Y;const{$moment:j}=$t(),{pointFormat:i}=W(),A=e=>e.deleted==1?"!bg-red-400":e.req_deleted==1?"!bg-yellow-300":e.val_ticket==1&&(["CPO","PK"].indexOf(e.jenis)>-1&&e.ticket_a_id!=""&&e.ticket_b_bruto!=""&&e.ticket_b_tara!=""&&e.ticket_b_netto!=""&&e.ticket_b_in_at!=""&&e.ticket_b_out_at!=""||e.jenis=="TBS"&&e.ticket_a_id!=""&&e.ticket_b_id!=""||e.jenis=="TBSK"&&e.ticket_b_id!="")?"!bg-blue-300":"",C=e=>(e.map(o=>{o.class_h=A(o)}),e),m=u("ticket_not_done");bt(()=>m.value,e=>{z()},{immediate:!1});const r={};r._TimeZoneOffset=new Date().getTimezoneOffset(),r.sort="tanggal:desc";const E=u({}),x=mt("token"),w=u({from:"",to:""}),{data:X}=([g,Y]=yt(async()=>wt(async()=>{p().loading_full=!0;let e=[];const[o,_]=await Promise.all([N("/trx_trp_susuts/data",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:{filter_status:m},retry:0})]);return o.status.value!=="error"&&(e=C(o.data.value.data)),o.status.value==="error"?($().trigger(o.error),{trx_trps:e}):(p().loading_full=!1,{trx_trps:e})},"$8KmJHfPiB5")),g=await g,Y(),g),y=u(X.value.trx_trps||[]),M=u({field:"tanggal",by:"desc"}),O=u(-1),d=u({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),B=()=>{r.like="";let e=JSON.parse(JSON.stringify(p()._tv.global_keyword));e!=""&&(r.like=`id:%${e}%,xto:%${e}%,jenis:%${e}%,pv_no:%${e}%,ticket_a_no:%${e}%,ticket_b_no:%${e}%,no_pol:%${e}%,supir:%${e}%,kernet:%${e}%,cost_center_code:%${e}%,cost_center_desc:%${e}%,pvr_no:%${e}%,tanggal:%${e}%,transition_target:%${e}%,uj_asst_opt:%${e}%`),r.sort="",M.value.field&&(r.sort=M.value.field+":"+M.value.by),r._TimeZoneOffset=new Date().getTimezoneOffset(),r.date_from=w.value.from?j(w.value.from).format("YYYY-MM-DD"):"",r.date_to=w.value.to?j(w.value.to).format("YYYY-MM-DD"):"",r.filter_model=JSON.stringify(p()._tv.filter_model),r.filter_status=m.value},K=u(null),q=async()=>{p().loading_full=!0,E.value={},d.value.may_get_data=!1,r.page=d.value.page,r.page==1&&(y.value=[]),r.first_row&&delete r.first_row,r.page>1&&(r.first_row=JSON.stringify(y.value[0])),r.filter_status=m.value;const{data:e,error:o,status:_}=await N("/trx_trp_susuts/data",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:r,retry:0});if(p().loading_full=!1,d.value.may_get_data=!0,_.value==="error"){$().trigger(o,E);return}d.value.page==1?(y.value=C(e.value.data),K.value&&(K.value.scrollTop=0)):d.value.page>1&&(y.value=[...y.value,...C(e.value.data)]),e.value.data.length==0&&(d.value.is_last_record=!0),p()._tv.filter_box=!1},z=()=>{d.value.page=1,d.value.is_last_record=!1,B(),q()},{downloadFile:V,viewFile:Se}=St(),D=u(!1),P=u(""),I=async()=>{if(D.value==!0){D.value=!1;return}B(),p().loading_full=!0;const{data:e,error:o,status:_}=await N("/trx_trp_susuts/report_PDF",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:r,retry:0});if(p().loading_full=!1,_.value==="error"){$().trigger(o);return}P.value=e.value,D.value=!0},tt=async()=>{B(),p().loading_full=!0;const{data:e,error:o,status:_}=await N("/trx_trp_susuts/report_Excel",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:r,retry:0});if(p().loading_full=!1,_.value==="error"){$().trigger(o);return}V(e.value)},et=()=>{V(P.value)},st=u([{key:"no",label:"No",isai:!0},{key:"val_ticket",label:"App",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"tanggal",label:"U.Jalan Per",type:"date",dateformat:"DD-MM-Y",filter_on:1,sort:{priority:1,type:"desc"}},{key:"no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"xto",label:"Tujuan",filter_on:1,type:"string"},{key:"uj_asst_opt",label:"Info",filter_on:1,type:"select",select_item:["DENGAN KERNET","TANPA KERNET"]},{key:"tipe",label:"Tipe",filter_on:1,type:"string"},{key:"jenis",label:"Jenis",filter_on:1,type:"select",select_item:["TBS","TBSK","CPO","PK"]},{key:"amount",label:"Amount",class:" justify-end",filter_on:1,type:"number"},{key:"cost_center",label:"Cost Center",childs:[{key:"cost_center_code",label:"Code",class:" justify-start",filter_on:1,type:"string"},{key:"cost_center_desc",label:"Desc",filter_on:1,type:"string"}]},{key:"pvr",label:"PVR",childs:[{key:"pvr_no",label:"No",filter_on:1,type:"string"},{key:"pvr_total",label:"Total",filter_on:1,type:"number"},{key:"pvr_had_detail",label:"Completed",filter_on:1,type:"select",select_item:[{k:"1",v:"Completed"},{k:"0",v:"Uncompleted"}]}]},{key:"pv",label:"PV",childs:[{key:"pv_datetime",label:"Date",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"pv_no",label:"No",filter_on:1,type:"string"},{key:"pv_total",label:"Total",filter_on:1,type:"number"}]},{key:"transition",label:"Peralihan",childs:[{key:"transition_type",label:"Type",type:"select",filter_on:1,select_item:["To","From"]},{key:"transition_target",label:"Target",type:"select",filter_on:1,select_item:p().list_pabrik}]},{key:"ticket_a",label:"Ticket A",childs:[{key:"ticket_a_no",label:"No",filter_on:1,type:"string"},{key:"ticket_a_bruto",label:"Bruto",filter_on:1,type:"number"},{key:"ticket_a_tara",label:"Tara",filter_on:1,type:"number"},{key:"ticket_a_netto",label:"Netto",filter_on:1,type:"number"},{key:"ticket_a_supir",label:"Supir",filter_on:1,type:"string"},{key:"ticket_a_no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"ticket_a_in_at",label:"In At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"ticket_a_out_at",label:"Out At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1}]},{key:"ticket_b",label:"Ticket B",childs:[{key:"ticket_b_no",label:"No",filter_on:1,type:"string"},{key:"ticket_b_bruto",label:"Bruto",filter_on:1,type:"number"},{key:"ticket_b_tara",label:"Tara",filter_on:1,type:"number"},{key:"ticket_b_netto",label:"Netto",filter_on:1,type:"number"},{key:"ticket_b_supir",label:"Supir",filter_on:1,type:"string"},{key:"ticket_b_no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"ticket_b_in_at",label:"In At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"ticket_b_out_at",label:"Out At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1}]},{key:"susut",label:"Susut",childs:[{key:"susut_bruto",label:"Bruto",childs:[{key:"susut_bruto_a",label:"Berangkat"},{key:"susut_bruto_b",label:"Kembali"},{key:"susut_bruto_b_a",label:"Selisih"},{key:"susut_bruto_b_a_persen",label:"%"}]},{key:"susut_tara",label:"Tara",childs:[{key:"susut_tara_a",label:"Berangkat"},{key:"susut_tara_b",label:"Kembali"},{key:"susut_tara_b_a",label:"Selisih"},{key:"susut_tara_b_a_persen",label:"%"}]},{key:"susut_netto",label:"Netto",childs:[{key:"susut_netto_a",label:"Berangkat"},{key:"susut_netto_b",label:"Kembali"},{key:"susut_netto_b_a",label:"Selisih"},{key:"susut_netto_b_a_persen",label:"%"}]}]},{key:"supir",label:"Supir",filter_on:1,type:"string"},{key:"kernet",label:"Kernet",filter_on:1,type:"string"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1}]),F=(e,o)=>{e=parseFloat(e)||0,o=parseFloat(o)||0;let _=parseFloat(o-e),T=_>0?o:e;if(T==0)return 0;let v=W().round(_/T*100,2);return v<0?"("+Math.abs(v*100)/100+")":v},H=(e,o)=>{e=parseFloat(e)||0,o=parseFloat(o)||0;let _=parseFloat(o-e);return _<0?"("+i(Math.abs(_))+")":i(_)},R=u(!1),b=u({...{id:-1,xto:"",tipe:"",jenis:"",harga:0,note_for_remarks:"",details:[],details2:[]}}),ot=kt(()=>{let e=0;return b.value.details2.forEach(o=>{o.p_status!="Remove"&&(e+=o.qty*o.amount)}),e});return(e,o)=>{const _=it,T=nt,v=_t,J=ct,U=ut,lt=pt,at=dt,rt=ft;return f(),k("div",Nt,[h(_,{title:"Report Transaction"}),s("div",At,[s("div",Ct,[s("div",Mt,[G(s("select",{class:"","onUpdate:modelValue":o[0]||(o[0]=t=>vt(m)?m.value=t:null)},Pt,512),[[ht,l(m)]])]),s("button",{type:"button",name:"button",class:"m-1 text-2xl flex items-center",onClick:o[1]||(o[1]=t=>I())},[h(T),c(),Ft]),s("button",{type:"button",name:"button",class:"m-1 text-2xl flex items-center",onClick:o[2]||(o[2]=t=>tt())},[h(v),c(),Ht])]),h(lt,{thead:l(st),selected:l(O),onSetSelected:o[3]||(o[3]=t=>O.value=t),tbody:l(y),fnCallData:q,scrolling:l(d),onSetScrollingPage:o[4]||(o[4]=t=>l(d).page=t),onDoFilter:o[5]||(o[5]=t=>z())},{status:n(({item:t})=>[s("div",{class:Dt(["text-white text-xs px-2 py-1 rounded-lg",A(t)?"bg-green-600":"bg-red-600"])},a(A(t)?"Done":"Not Done"),3)]),val_ticket:n(({item:t})=>[t.val_ticket?(f(),S(U,{key:1})):(f(),S(J,{key:0}))]),uj_asst_opt:n(({item:t})=>{var L;return[c(a((L=t.uj)==null?void 0:L.asst_opt),1)]}),pvr_had_detail:n(({item:t})=>[t.pvr_had_detail?(f(),S(U,{key:1})):(f(),S(J,{key:0}))]),susut_bruto_a:n(({item:t})=>[c(a(l(i)(t.ticket_a_bruto)),1)]),susut_tara_a:n(({item:t})=>[c(a(l(i)(t.ticket_a_tara)),1)]),susut_netto_a:n(({item:t})=>[c(a(l(i)(t.ticket_a_netto)),1)]),susut_bruto_b:n(({item:t})=>[c(a(l(i)(t.ticket_b_bruto)),1)]),susut_tara_b:n(({item:t})=>[c(a(l(i)(t.ticket_b_tara)),1)]),susut_netto_b:n(({item:t})=>[c(a(l(i)(t.ticket_b_netto)),1)]),susut_bruto_b_a:n(({item:t})=>[c(a(H(t.ticket_a_bruto,t.ticket_b_bruto)),1)]),susut_tara_b_a:n(({item:t})=>[c(a(H(t.ticket_a_tara,t.ticket_b_tara)),1)]),susut_netto_b_a:n(({item:t})=>[c(a(H(t.ticket_a_netto,t.ticket_b_netto)),1)]),susut_bruto_b_a_persen:n(({item:t})=>[c(a(F(t.ticket_a_bruto,t.ticket_b_bruto)),1)]),susut_tara_b_a_persen:n(({item:t})=>[c(a(F(t.ticket_a_tara,t.ticket_b_tara)),1)]),susut_netto_b_a_persen:n(({item:t})=>[c(a(F(t.ticket_a_netto,t.ticket_b_netto)),1)]),_:2},1032,["thead","selected","tbody","scrolling"])]),l(D)?(f(),k("div",Rt,[s("div",Yt,[s("div",jt,[h(at,{style:{color:"black",cursor:"pointer"},onClick:o[6]||(o[6]=t=>I())})]),s("iframe",{ref:"iframe",width:"100%",height:"100%",src:l(P).dataBase64},null,8,Et),s("div",{style:{position:"absolute",top:"12px",right:"88px","background-color":"rgba(255,255,255,0)",width:"37px",height:"36px","z-index":"1",cursor:"pointer"},onClick:o[7]||(o[7]=t=>et())})])])):gt("",!0),G(s("div",Ot,[s("div",Kt,[h(rt,{title:"Detail Information",fn:()=>{R.value=!1,e.show_confirm=!1},class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),s("div",qt,[s("div",zt,[s("div",Vt,[It,s("div",Jt,a(l(b).xto)+" ",1)]),s("div",Ut,[Lt,s("div",Gt,a(l(b).tipe),1)]),s("div",Zt,[Qt,s("div",Wt,a(l(b).jenis),1)]),s("div",Xt,[te,s("div",ee,a(l(b).note_for_remarks),1)])]),s("div",se,[s("table",oe,[le,(f(!0),k(Z,null,Q(l(b).details,t=>(f(),k("tr",null,[s("td",ae,a(t.ordinal)+". ",1),s("td",re,a(t.xdesc)+" "+a(t.qty<=1?"":l(i)(t.qty||0)+" x Rp."+l(i)(t.harga||0)),1),ie,s("td",ne,a(l(i)(t.qty*t.harga)),1)]))),256)),s("tr",_e,[ce,ue,s("th",pe,a(l(i)(l(b).harga)),1)])])]),s("div",de,[s("table",fe,[be,(f(!0),k(Z,null,Q(l(b).details2,t=>(f(),k("tr",null,[s("td",me,a(t.ordinal)+". ",1),s("td",ye,a(t.ac_account_code),1),s("td",ke,a(t.description)+" "+a(t.qty<=1?"":l(i)(t.qty||0)+" x Rp."+l(i)(t.amount||0)),1),he,s("td",ve,a(l(i)(t.qty*t.amount)),1)]))),256)),s("tr",ge,[xe,we,s("th",De,a(l(i)(l(ot))),1)])])])]),s("div",Te,[s("button",{class:"rounded m-1",onClick:o[8]||(o[8]=t=>R.value=!1)}," Cancel ")])])],512),[[xt,l(R)]])])}}};export{We as default};
