import{_ as Y}from"./HeaderPopup.vue.5e43446c.js";import{r as x,f as z,G as f,j as R,m as H,J as G,o as c,c as v,a as e,b as J,t as n,k as t,d as k,F as P,y as U,l as y,x as K,E as L,A as g,B as $,p as O,e as Q}from"./entry.44d5fc3d.js";import{u as W}from"./useUtils.f69303a2.js";import{u as q}from"./useMyFetch.7cc1a605.js";import{_ as X}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.5282973f.js";const r=i=>(O("data-v-465e076c"),i=i(),Q(),i),Z={class:"box-fixed"},ee={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},ae={class:"w-full flex flex-col items-center grow overflow-auto"},te={class:"w-full flex flex-row flex-wrap"},le={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},se=r(()=>e("label",{for:""},"Period End",-1)),oe={class:"card-border"},ne={class:"w-full flex flex-row flex-wrap"},re={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ie=r(()=>e("label",{for:""},"Period Part",-1)),ue={class:"card-border"},_e={key:0,class:"w-full flex p-1 justify-between flex-wrap"},de={class:"w-full",role:"sticky"},ce={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},ve=r(()=>e("tr",{class:"sticky -top-1 !z-[2]"},[e("td",{colspan:"11",class:"!bg-slate-800 text-white font-bold"}," Detail ")],-1)),pe={class:"sticky top-7 !z-[2]"},fe=r(()=>e("th",null,"No",-1)),me=r(()=>e("th",null,"Jabatan",-1)),he=r(()=>e("th",null,"Nama Pekerja",-1)),ye=r(()=>e("th",null,"No KTP",-1)),we=r(()=>e("th",null,"Rek No",-1)),be=r(()=>e("th",null,"Rek Nama",-1)),xe=r(()=>e("th",null,"Bank Name",-1)),ke={class:"text-sm"},ge={class:"text-sm"},Fe={class:"text-sm"},Ne={class:"text-sm"},Be={ref:"to_move"},Se=["data-index"],je={class:"w-full flex items-center justify-end"},Ce={class:"w-full flex flex-wrap p-3 items-center"},Ee=r(()=>e("div",null," Di Validasi oleh : ",-1)),Ae={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},De={key:0},Me={__name:"salary_paid_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(i){const u=i,{$moment:F}=L(),{pointFormat:_}=W(),s=x({...{id:-1,name:"",tipe:"",is_transition:!1,amount:0,details:[],val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:"",val3:0,val3_by:{username:""},val3_at:""}}),N=z("token"),B=x({}),S=x(null),d=x([]),I=async()=>{g().loading_full=!0,B.value={};const l=new FormData;let o="post",p=u.id;p==0||(l.append("id",p),l.append("_method","PUT"));const{data:a,error:m,status:w}=await q("/salary_paid_validasi",{method:o,headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},body:l,retry:0});if(g().loading_full=!1,w.value==="error"){$().trigger(m,B);return}s.value.val1=a.value.val1,s.value.val1_user=a.value.val1_user,s.value.val1_by=a.value.val1_by,s.value.val1_at=a.value.val1_at,s.value.val2=a.value.val2,s.value.val2_user=a.value.val2_user,s.value.val2_by=a.value.val2_by,s.value.val2_at=a.value.val2_at,s.value.val3=a.value.val3,s.value.val3_user=a.value.val3_user,s.value.val3_by=a.value.val3_by,s.value.val3_at=a.value.val3_at;let h=u.p_data.map(b=>b.id).indexOf(u.id);h>=-1&&u.p_data.splice(h,1,{...s.value}),u.fnClose()};f(()=>{let l=0;return d.value.forEach(o=>{l+=parseFloat(o.standby_nominal)}),l});const j=f(()=>{let l=0;return d.value.forEach(o=>{l+=parseFloat(o.sb_gaji)}),l}),C=f(()=>{let l=0;return d.value.forEach(o=>{l+=parseFloat(o.sb_makan)}),l}),E=f(()=>{let l=0;return d.value.forEach(o=>{l+=parseFloat(o.salary_bonus_nominal)}),l}),T=async()=>{g().loading_full=!0;const{data:l,error:o,status:p}=await q("/salary_paid",{method:"get",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},params:{id:u.id},retry:0});if(g().loading_full=!1,p.value==="error"){$().trigger(o);return}s.value=l.value.data,d.value=l.value.data.details};return f(()=>{let l=0;return d.value.forEach(o=>{o.p_status!="Remove"&&(l+=parseInt(o.amount))}),l}),f(()=>!1),R(()=>u.show,(l,o)=>{l==!0&&(u.is_view==!1&&setTimeout(()=>{S.value.focus()},1),T())},{immediate:!0}),(l,o)=>{const p=Y;return H((c(),v("section",Z,[e("div",null,[J(p,{title:"Form Master Standby Validation",fn:i.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",ee,[e("div",ae,[e("div",te,[e("div",le,[se,e("div",oe,n(t(F)(t(s).period_end).format("MM-Y")),1)])]),e("div",ne,[e("div",re,[ie,e("div",ue,n(t(s).period_part),1)])]),t(d).length?(c(),v("div",_e,[e("div",de,[e("table",ce,[e("thead",null,[ve,e("tr",pe,[fe,me,he,ye,we,be,xe,e("th",null,[k("SB.Gaji "),e("span",ke,"("+n(t(_)(t(j)||0))+")",1)]),e("th",null,[k("SB.Makan "),e("span",ge,"("+n(t(_)(t(C)||0))+")",1)]),e("th",null,[k("Nominal Bonus "),e("span",Fe,"("+n(t(_)(t(E)||0))+")",1)]),e("th",null,[k("Total "),e("span",Ne,"("+n(t(_)(t(j)+t(C)+t(E)||0))+")",1)])])]),e("tbody",Be,[(c(!0),v(P,null,U(t(d),(a,m)=>{var w,h,b,A,D,M,V;return c(),v(P,{key:m},[a.p_status!="Remove"?(c(),v("tr",{key:0,"data-index":m},[e("td",null,n(m+1)+".",1),e("td",null,n((w=a.employee)==null?void 0:w.role),1),e("td",null,n((h=a.employee)==null?void 0:h.name),1),e("td",null,n((b=a.employee)==null?void 0:b.ktp_no),1),e("td",null,n((A=a.employee)==null?void 0:A.rek_no),1),e("td",null,n((D=a.employee)==null?void 0:D.rek_name),1),e("td",null,n((V=(M=a.employee)==null?void 0:M.bank)==null?void 0:V.code),1),e("td",null,n(t(_)(a.sb_gaji)),1),e("td",null,n(t(_)(a.sb_makan)),1),e("td",null,n(t(_)(a.salary_bonus_nominal)),1),e("td",null,n(t(_)(parseFloat(a.sb_gaji)+parseFloat(a.sb_makan)+parseFloat(a.salary_bonus_nominal))),1)],8,Se)):y("",!0)],64)}),128))],512)])])])):y("",!0)]),e("div",je,[e("div",Ce,[Ee,t(s).val1||t(s).val2||t(s).val3?(c(),v("div",Ae,[t(s).val1?(c(),v("div",De," App 1 : "+n(t(s).val1_by.username)+" ( "+n(t(s).val1_at?t(F)(t(s).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):y("",!0)])):y("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:o[0]||(o[0]=a=>i.fnClose())}," Cancel "),i.is_view==0?(c(),v("button",{key:0,ref_key:"it_val",ref:S,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:o[1]||(o[1]=K(a=>I(),["prevent"]))}," Validasi ",512)):y("",!0)])])])],512)),[[G,i.show]])}}},ze=X(Me,[["__scopeId","data-v-465e076c"]]);export{ze as default};
