import{_ as $}from"./HeaderPopup.vue.f506d3a2.js";import B from"./CaretTop.70371436.js";import T from"./CaretDown.f75b0f8f.js";import{Q as E,r as y,g as N,f as V,k as L,K as P,o as c,c as u,a as e,b as Y,t as a,l as s,n as v,C as q,G as F,x as h,y as A,p as O,e as U}from"./entry.e56859e6.js";import{u as C}from"./useMyFetch.3d0a045f.js";import{_ as G}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.cab95edf.js";const _=n=>(O("data-v-9845db3c"),n=n(),U(),n),K={class:"box-fixed"},z={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},R={class:"w-full flex flex-col items-center grow overflow-auto"},J={class:"w-full"},Q={class:"w-full flex flex-wrap p-3 items-center text-xs"},W=_(()=>e("label",{for:""},"ID",-1)),X={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},Z=_(()=>e("label",{for:""},"U.jalan Per",-1)),ee={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},te=_(()=>e("label",{for:""},"Jenis",-1)),se={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},ae=_(()=>e("label",{for:""},"Supir",-1)),ie={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},le={key:0},oe=_(()=>e("label",{for:""},"Kernet",-1)),re={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},_e=_(()=>e("label",{for:""},"No Pol",-1)),ne={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},de=_(()=>e("label",{for:""},"Tujuan",-1)),ce={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},ue=_(()=>e("label",{for:""},"Tipe",-1)),ve={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},me={class:"w-full flex flex-wrap items-center grow overflow-auto"},fe={class:"w-full sm:w-1/2 text-center p-1"},pe={class:"border-[1px] p-1"},be={class:"font-bold"},he={class:"w-full flex justify-center items-center"},we=["src"],xe={class:"w-full sm:w-1/2 text-center p-1"},ge={class:"border-[1px] p-1"},ye={class:"border-[1px] p-1"},Ye={class:"font-bold"},De={class:"w-full flex justify-center items-center"},ke=["src"],Me={class:"w-full sm:w-1/2 text-center p-1"},Se={class:"border-[1px] p-1"},He={class:"border-[1px] p-1"},Ae={class:"font-bold"},Ce={class:"w-full flex justify-center items-center"},Ie=["src"],je={class:"w-full sm:w-1/2 text-center p-1"},$e={class:"border-[1px] p-1"},Be={class:"border-[1px] p-1"},Te={class:"font-bold"},Ee={class:"w-full flex justify-center items-center"},Ne=["src"],Ve={class:"w-full p-1"},Le=_(()=>e("label",{for:""}," Note ",-1)),Pe={class:"card-border"},qe={class:"w-full flex items-center justify-end"},Fe={class:"w-full flex flex-wrap p-3 items-center"},Oe=_(()=>e("div",null," Di Validasi oleh : ",-1)),Ue={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},Ge={key:0},Ke={key:1},ze={key:2},Re=_(()=>e("div",null," Validasi ",-1)),Je={key:0,class:"text-xs font-bold"},Qe={__name:"trx_trp_absen_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},emits:["setID","setIndex"],setup(n,{emit:b}){const o=n,{$moment:d}=F();let w=i=>{i.key=="ArrowUp"&&S(),i.key=="ArrowDown"&&M()};E(()=>{document.removeEventListener("keydown",w)});const t=y({...{id:-1,tanggal:new Date,id_uj:-1,xto:"",tipe:"",jenis:"",amount:0,img_leaves:[],img_leave:"",img_arrive:"",img_return:"",img_till:"",img_leave_file:"",img_arrive_file:"",img_return_file:"",img_till_file:"",img_leave_ts:"",img_arrive_ts:"",img_return_ts:"",img_till_ts:"",ritase_note:"",ritase_val:0,ritase_val_by:{username:""},ritase_val_at:"",ritase_val1:0,ritase_val1_by:{username:""},ritase_val1_at:"",ritase_val2:0,ritase_val2_by:{username:""},ritase_val2_at:""}}),D=N("token"),k=y(null),m=y(""),I=async()=>{m.value="PROSES...",h().loading_full=!0;const i=new FormData;let l="post",f=o.id;f==0||(i.append("id",f),i.append("_method","PUT"));const{data:r,error:g,status:p}=await C("/trx_trp/absen/validasi",{method:l,headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},body:i,retry:0});if(h().loading_full=!1,p.value==="error"){m.value="GAGAL",A().trigger(g);return}t.value.ritase_val=r.value.ritase_val,t.value.ritase_val_by=r.value.ritase_val_by,t.value.ritase_val_at=r.value.ritase_val_at,t.value.ritase_val1=r.value.ritase_val1,t.value.ritase_val1_by=r.value.ritase_val1_by,t.value.ritase_val1_at=r.value.ritase_val1_at,t.value.ritase_val2=r.value.ritase_val2,t.value.ritase_val2_by=r.value.ritase_val2_by,t.value.ritase_val2_at=r.value.ritase_val2_at;let H=o.p_data.map(j=>j.id).indexOf(o.id);H>=-1&&o.p_data.splice(H,1,{...t.value}),m.value="BERHASIL"},x=async()=>{m.value="",h().loading_full=!0;const{data:i,error:l,status:f}=await C("/trx_trp/absen",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},params:{id:o.id},retry:0});if(h().loading_full=!1,f.value==="error"){A().trigger(l);return}t.value=i.value.data};V(()=>o.show,(i,l)=>{i==!0?(document.addEventListener("keydown",w),o.is_view==!1&&setTimeout(()=>{k.value.focus()},1),x()):document.removeEventListener("keydown",w)},{immediate:!0});const M=()=>{let i=o.p_data.map(l=>l.id).indexOf(o.id);i!=o.p_data.length-1&&(i++,b("setID",o.p_data[i].id),b("setIndex",i),setTimeout(()=>{x()},100))},S=()=>{let i=o.p_data.map(l=>l.id).indexOf(o.id);i!=0&&(i--,b("setID",o.p_data[i].id),b("setIndex",i),setTimeout(()=>{x()},100))};return(i,l)=>{const f=$,r=B,g=T;return L((c(),u("section",K,[e("div",null,[Y(f,{title:"Form Transaction Validation",fn:n.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",z,[e("div",R,[e("div",J,[e("div",Q,[e("div",null,[W,e("div",X,a(s(t).id),1)]),e("div",null,[Z,e("div",ee,a(s(t).tanggal?s(d)(s(t).tanggal).format("DD-MM-YYYY"):""),1)]),e("div",null,[te,e("div",se,a(s(t).jenis),1)]),e("div",null,[ae,e("div",ie,a(s(t).supir),1)]),s(t).kernet?(c(),u("div",le,[oe,e("div",re,a(s(t).kernet),1)])):v("",!0),e("div",null,[_e,e("div",ne,a(s(t).no_pol),1)]),e("div",null,[de,e("div",ce,a(s(t).xto),1)]),e("div",null,[ue,e("div",ve,a(s(t).tipe),1)])])]),e("div",me,[e("div",fe,[e("div",pe,[e("label",be,"Berangkat : "+a(s(t).img_leave_ts?s(d)(s(t).img_leave_ts).format("DD-MM-YYYY HH:mm"):"")+" "+a(s(t).img_leave_is_manual?"(Manual)":"(System)"),1),e("div",he,[e("img",{src:s(t).img_leave,alt:""},null,8,we)])])]),e("div",xe,[e("div",ge,[e("div",ye,[e("label",Ye,"Tiba : "+a(s(t).img_arrive_ts?s(d)(s(t).img_arrive_ts).format("DD-MM-YYYY HH:mm"):"")+" "+a(s(t).img_arrive_is_manual?"(Manual)":"(System)"),1),e("div",De,[e("img",{src:s(t).img_arrive,alt:""},null,8,ke)])])])]),e("div",Me,[e("div",Se,[e("div",He,[e("label",Ae,"Kembali : "+a(s(t).img_return_ts?s(d)(s(t).img_return_ts).format("DD-MM-YYYY HH:mm"):"")+" "+a(s(t).img_return_is_manual?"(Manual)":"(System)"),1),e("div",Ce,[e("img",{src:s(t).img_return,alt:""},null,8,Ie)])])])]),e("div",je,[e("div",$e,[e("div",Be,[e("label",Te,"Sampai : "+a(s(t).img_till_ts?s(d)(s(t).img_till_ts).format("DD-MM-YYYY HH:mm"):"")+" "+a(s(t).img_till_is_manual?"(Manual)":"(System)"),1),e("div",Ee,[e("img",{src:s(t).img_till,alt:""},null,8,Ne)])])])]),e("div",Ve,[Le,e("div",Pe,a(s(t).ritase_note),1)])])]),e("div",qe,[e("div",Fe,[Oe,s(t).ritase_val||s(t).ritase_val1||s(t).ritase_val2?(c(),u("div",Ue,[s(t).ritase_val?(c(),u("div",Ge," App 1 : "+a(s(t).ritase_val_by.username)+" ( "+a(s(t).ritase_val_at?s(d)(s(t).ritase_val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):v("",!0),s(t).ritase_val1?(c(),u("div",Ke," App 2 : "+a(s(t).ritase_val1_by.username)+" ( "+a(s(t).ritase_val1_at?s(d)(s(t).ritase_val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):v("",!0),s(t).ritase_val2?(c(),u("div",ze," App 3 : "+a(s(t).ritase_val2_by.username)+" ( "+a(s(t).ritase_val2_at?s(d)(s(t).ritase_val2_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):v("",!0)])):v("",!0)]),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:l[0]||(l[0]=p=>S())},[Y(r,{class:"black"})]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:l[1]||(l[1]=p=>n.fnClose())}," Cancel "),n.is_view==0?(c(),u("button",{key:0,ref_key:"it_val",ref:k,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm flex flex-col items-center justify-center",onClick:l[2]||(l[2]=q(p=>I(),["prevent"]))},[Re,s(m)!=""?(c(),u("div",Je,a(s(m)),1)):v("",!0)],512)):v("",!0),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:l[3]||(l[3]=p=>M())},[Y(g,{class:"black"})])])])])],512)),[[P,n.show]])}}},lt=G(Qe,[["__scopeId","data-v-9845db3c"]]);export{lt as default};
