import{r as a,f as H,g as de,h as _e,i as f,j as F,s as fe,c as g,b as d,a as T,l,n as O,q as ce,x as c,y as I,o as h,B as J,_ as R,H as me}from"./entry.2c798c4f.js";import pe from"./Header.0187adba.js";import ve from"./Copy.fffc3bbd.js";import ye from"./Plus.c2822e5c.js";import be from"./Edit.76169185.js";import ge from"./Eyes.7efe1cae.js";import he from"./TableView.2b97c741.js";import{u as m}from"./useUtils.437b3e73.js";import{u as V}from"./useMyFetch.79160f08.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.3043f934.js";import"./Adjust.128330ca.js";import"./TableHeaderEye.5e114b42.js";import"./Times.a570b43c.js";import"./ClearAll.82a76196.js";import"./client-only.c834acb6.js";import"./ClearEach.611de72c.js";import"./CaretLeftDoubleBold.718f916e.js";import"./CaretLeftBold.c9427645.js";import"./CaretRightBold.04d147af.js";import"./CaretRightDoubleBold.4149bc18.js";const xe=J(()=>R(()=>import("./destination_location.b93078bf.js"),["./destination_location.b93078bf.js","./HeaderPopup.vue.65f721df.js","./Times.a570b43c.js","./_plugin-vue_export-helper.c27b6911.js","./entry.2c798c4f.js","./entry.493f9183.css","./InputPointFormat.vue.afbdaa92.js","./useMyFetch.79160f08.js"],import.meta.url).then(p=>p.default||p)),ke=J(()=>R(()=>import("./destination_location_validasi.5e1fccb5.js"),["./destination_location_validasi.5e1fccb5.js","./HeaderPopup.vue.65f721df.js","./Times.a570b43c.js","./_plugin-vue_export-helper.c27b6911.js","./entry.2c798c4f.js","./entry.493f9183.css","./useUtils.437b3e73.js","./useMyFetch.79160f08.js"],import.meta.url).then(p=>p.default||p)),we={class:"w-full h-full flex flex-col"},De={class:"w-full flex grow flex-col overflow-auto h-0"},Oe={class:"w-full flex justify-between flex-wrap"},Pe={class:"grow flex"},Ze={__name:"index",async setup(p){let x,A;const{$moment:B}=me(),K=e=>e.deleted==1?"!bg-red-400":e.pv_id>0?"!bg-blue-300":"",P=e=>(e.map(t=>{t.class_h=K(t)}),e),k=a("available");H(()=>k.value,e=>{E.value.map(t=>{let _=["deleted_by_username","deleted_at","deleted_reason"].indexOf(t.key)>-1;return["all","deleted"].indexOf(e)>-1?_&&(t.tbl_show=1):_&&(t.tbl_show=0),t}),Y()},{immediate:!1});const o={};o._TimeZoneOffset=new Date().getTimezoneOffset(),o.sort="tanggal:desc";const M=a({}),w=a({from:"",to:""}),j=de("token"),{data:U}=([x,A]=_e(async()=>ce(async()=>{c().loading_full=!0;let e=[];const[t,_]=await Promise.all([V("/destination_locations",{method:"get",headers:{Authorization:`Bearer ${j.value}`,Accept:"application/json"},params:{filter_status:k},retry:0})]);return t.status.value!=="error"&&(e=P(t.data.value.data)),t.status.value==="error"?(I().trigger(t.error),{destination_locations:e}):(c().loading_full=!1,{destination_locations:e})},"$xzB8heZwKP")),x=await x,A(),x),s=a(U.value.destination_locations||[]),$=a({field:"tanggal",by:"desc"}),n=a(-1),i=f(()=>s.value[n.value]),r=a({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),Z=()=>{o.like="";let e=JSON.parse(JSON.stringify(c()._tv.global_keyword));e!=""&&(o.like=`id:%${e}%,transition_target:%${e}%,transition_type:%${e}%,destination_location_name:%${e}%,destination_location_type:%${e}%,xto:%${e}%,transition_target:%${e}%`),o.sort="",$.value.field&&(o.sort=$.value.field+":"+$.value.by),o.date_from=w.value.from?B(w.value.from).format("YYYY-MM-DD"):"",o.date_to=w.value.to?B(w.value.to).format("YYYY-MM-DD"):"",o.filter_model=JSON.stringify(c()._tv.filter_model)},N=async()=>{c().loading_full=!0,M.value={},r.value.may_get_data=!1,o.page=r.value.page,o.page==1&&(s.value=[]),o.first_row&&delete o.first_row,o.page>1&&(o.first_row=JSON.stringify(s.value[0])),o.filter_status=k.value;const{data:e,error:t,status:_}=await V("/destination_locations",{method:"get",headers:{Authorization:`Bearer ${j.value}`,Accept:"application/json"},params:o,retry:0});if(c().loading_full=!1,r.value.may_get_data=!0,_.value==="error"){I().trigger(t,M);return}r.value.page==1?s.value=P(e.value.data):r.value.page>1&&(s.value=[...s.value,...P(e.value.data)]),e.value.data.length==0&&(r.value.is_last_record=!0),c()._tv.filter_box=!1},Y=()=>{n.value=-1,r.value.page=1,r.value.is_last_record=!1,Z(),N()},v=a(!1),D=a(0),y=a(0),b=a(!1),q=()=>{D.value=0,b.value=!1,y.value=!1,v.value=!0},{display:C}=F();fe(F());const G=()=>{n.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(D.value=s.value[n.value].id,b.value=!1,y.value=!1,v.value=!0)},Q=()=>{n.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(D.value=s.value[n.value].id,b.value=!1,y.value=!0,v.value=!0)},S=a(!1),z=a(0),W=()=>{n.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(z.value=s.value[n.value].id,b.value=!0,y.value=!1,S.value=!0)},L=a(!1);a({}),a(!1);const X=a("");H(()=>X.value,e=>{e.trim().length>0?L.value=!0:L.value=!1},{immediate:!1});const E=a([{key:"no",label:"No",isai:!0},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"xto",label:"Tujuan",freeze:1,filter_on:1,type:"string"},{key:"minimal_trip",label:"Min Trip",class:" justify-end",type:"number"},{key:"bonus_trip_supir",label:"Bonus Trip Supir",class:" justify-end",type:"number"},{key:"bonus_next_trip_supir",label:"Bonus Next Trip Supir",class:" justify-end",type:"number"},{key:"bonus_trip_kernet",label:"Bonus Trip Kernet",class:" justify-end",type:"number"},{key:"bonus_next_trip_kernet",label:"Bonus Next Trip Kernet",class:" justify-end",type:"number"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:0},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:0},{key:"deleted_reason",label:"Deleted Reason",tbl_show:0,type:"string",filter_on:1}]),ee=f(()=>n.value>-1&&[void 0,0].indexOf(i.value.deleted)>-1&&m().checkPermission("destination_location.create")),te=f(()=>["available","all"].indexOf(k.value)>-1&&m().checkPermission("destination_location.create")),ae=f(()=>n.value>-1&&[void 0,0].indexOf(i.value.deleted)>-1&&[void 0,0].indexOf(i.value.val1)>-1&&[void 0,""].indexOf(i.value.pvr_id)>-1&&m().checkPermission("destination_location.modify"));return f(()=>n.value>-1&&[void 0,0].indexOf(i.value.deleted)>-1&&[void 0,""].indexOf(i.value.pvr_id)>-1&&(m().checkPermission("destination_location.val1")&&[void 0,0].indexOf(i.value.val1)>-1||m().checkPermission("destination_location.val2")&&[void 0,0].indexOf(i.value.val2)>-1)),f(()=>m().checkPermission("destination_location.remove")&&n.value>-1&&[void 0,0].indexOf(i.value.deleted)>-1&&[void 0,""].indexOf(i.value.pvr_id)>-1),f(()=>m().checkPermission("destination_location.preview_file")&&n.value>-1&&[void 0,0].indexOf(i.value.deleted)>-1&&i.value.val==1),(e,t)=>{const _=pe,oe=ve,le=ye,ne=be,se=ge,ie=he,re=xe,ue=ke;return h(),g("div",we,[d(_,{title:"List Location"}),T("div",De,[T("div",Oe,[T("div",Pe,[l(ee)?(h(),g("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[0]||(t[0]=u=>Q())},[d(oe)])):O("",!0),l(te)?(h(),g("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=u=>q())},[d(le)])):O("",!0),l(ae)?(h(),g("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=u=>G())},[d(ne)])):O("",!0),l(n)>-1?(h(),g("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[3]||(t[3]=u=>W())},[d(se)])):O("",!0)])]),d(ie,{thead:l(E),selected:l(n),onSetSelected:t[4]||(t[4]=u=>n.value=u),tbody:l(s),fnCallData:N,scrolling:l(r),onSetScrollingPage:t[5]||(t[5]=u=>l(r).page=u),onDoFilter:t[6]||(t[6]=u=>Y())},null,8,["thead","selected","tbody","scrolling"])]),d(re,{show:l(v),fnClose:()=>{v.value=!1},id:l(D),p_data:l(s),is_copy:l(y)},null,8,["show","fnClose","id","p_data","is_copy"]),d(ue,{show:l(S),fnClose:()=>{S.value=!1},id:l(z),p_data:l(s),is_view:l(b)},null,8,["show","fnClose","id","p_data","is_view"])])}}};export{Ze as default};
