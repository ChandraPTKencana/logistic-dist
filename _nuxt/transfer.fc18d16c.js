import ct from"./Header.a5d2495b.js";import dt from"./Table2Column.bb6352fc.js";import _t from"./Calendar.fd1c42be.js";import ut from"./CarTag.64669695.js";import ft from"./TruckDriver.9a5fb84e.js";import xt from"./TruckDriverOutline.8da5397f.js";import pt from"./LocationOn.50e95e47.js";import{_ as ht}from"./HeaderPopup.vue.64aaea54.js";import mt from"./Image.ace8a0a8.js";import vt from"./GAPIN.5cfcba29.js";import{g as gt,h as bt,r as f,j as yt,i as wt,f as kt,c as i,b as x,a as t,k as T,A as Dt,l as e,m as Tt,F as L,D as $,K as N,t as o,n as u,d as S,q as Yt,x as v,y as Y,o as c,G as jt}from"./entry.adb276f4.js";import{u as Mt}from"./useUtils.1c7b5096.js";import{u as j}from"./useMyFetch.08dd8a2e.js";import{u as At}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.1f480aaf.js";const Ct={class:"w-full h-full flex flex-col relative"},Ht={class:"grow flex flex-col"},It={class:"w-full flex items-center p-1"},Lt={class:"grow"},$t={class:"grow overflow-auto h-0"},Nt={class:"p-1 grow"},St={class:"bg-white flex py-2 justify-between"},Pt={class:"flex flex-wrap"},Bt={class:"flex items-center justify-center m-2 text-xs"},Ft={class:"bg-blue-400 p-2 font-bold text-white"},Kt={class:"flex flex-col m-2"},Rt=t("span",{class:"text-xs"}," Tgl Terima U.Jalan ",-1),Vt={class:"flex items-center justify-center"},Ut={class:"flex flex-col m-2"},qt=t("span",{class:"text-xs"}," Nomor Kendaraan ",-1),zt={class:"flex items-center justify-center"},Et=["data-real"],Jt={class:"flex flex-col m-2"},Ot=t("span",{class:"text-xs"}," Nama Supir ",-1),Gt={class:"flex items-center justify-center"},Wt=["data-real"],Qt={key:0,class:"flex flex-col m-2"},Xt=t("span",{class:"text-xs"}," Nama Kernet ",-1),Zt={class:"flex items-center justify-center"},te=["data-real"],ee={class:"flex flex-col m-2"},se=t("span",{class:"text-xs"}," Tujuan ",-1),oe={class:"flex items-center justify-center"},le=["onClick"],ne={class:"w-full h-full fixed top-0 left-0 bg-gray-100 bg-opacity-80 flex items-center justify-center z-10"},ae={class:"w-full sm:w-10/12 md:w-10/12 lg:w-8/12 bg-white flex flex-col border-solid border-gray-200 max-w-full max-h-full overflow-auto",style:{"border-width":"1px"}},re={class:"p-1 flex flex-wrap overflow-auto items-start"},ie={class:"w-full flex flex-wrap"},ce={class:"w-full flex flex-wrap"},de={class:"flex flex-col m-2 border-solid border-l-4 border-blue-400 px-2 bg-gray-200"},_e=t("span",{class:"text-xs font-bold"}," ID ",-1),ue={class:""},fe={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},xe=t("span",{class:"text-xs font-bold"}," Tgl Terima U.Jalan ",-1),pe={class:""},he={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},me=t("span",{class:"text-xs font-bold"}," Nomor Kendaraan ",-1),ve={class:""},ge={class:"flex flex-row flex-wrap m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},be={class:"flex flex-col"},ye=t("span",{class:"text-xs font-bold"}," Nama Supir ",-1),we={class:""},ke={class:"flex flex-col pl-2"},De=t("span",{class:"text-xs font-bold"}," No rek ",-1),Te={class:""},Ye={key:0,class:"flex flex-row flex-wrap m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},je={class:"flex flex-col"},Me=t("span",{class:"text-xs font-bold"}," Nama Kernet ",-1),Ae={class:""},Ce={class:"flex flex-col pl-2"},He=t("span",{class:"text-xs font-bold"}," No rek ",-1),Ie={class:""},Le={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},$e=t("span",{class:"text-xs font-bold"}," Tujuan ",-1),Ne={class:""},Se={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},Pe=t("span",{class:"text-xs font-bold"}," Info ",-1),Be={class:""},Fe={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},Ke=t("span",{class:"text-xs font-bold"}," Tipe ",-1),Re={class:""},Ve={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},Ue=t("span",{class:"text-xs font-bold"}," Jenis ",-1),qe={class:""},ze={key:1,class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},Ee=t("span",{class:"text-xs font-bold"}," Pengalihan ",-1),Je={class:""},Oe={class:"w-full flex flex-wrap justify-center"},Ge={key:0,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},We=t("span",{class:"text-xs font-bold"}," App Kasir ",-1),Qe={class:"text-xs"},Xe={key:1,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},Ze=t("span",{class:"text-xs font-bold"}," App Mandor ",-1),ts={class:"text-xs"},es={key:2,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},ss=t("span",{class:"text-xs font-bold"}," App KTU/W ",-1),os={class:"text-xs"},ls={key:3,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},ns=t("span",{class:"text-xs font-bold"}," App Marketing ",-1),as={class:"text-xs"},rs={key:4,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},is=t("span",{class:"text-xs font-bold"}," App Logistik ",-1),cs={class:"text-xs"},ds={key:5,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},_s=t("span",{class:"text-xs font-bold"}," App SPV Logistik ",-1),us={class:"text-xs"},fs={class:"w-full sm:w-1/2 text-sm flex justify-center"},xs={class:"border border-collapse border-black"},ps=t("tr",null,[t("th",{colspan:"4",class:"bg-blue-400"}," List Uang Jalan ")],-1),hs={class:"p-1"},ms={class:"p-1"},vs=t("td",{class:"p-1"},"= Rp.",-1),gs={class:"text-right p-1"},bs={class:"border-t-black border-dashed",style:{"border-top-width":"1px"}},ys=t("th",{colspan:"2",class:"text-right"},"Total",-1),ws=t("th",{class:"p-1 text-right"},"Rp.",-1),ks={class:"p-1 text-right"},Ds={key:0,class:"text-red-500 font-bold"},Ts=t("td",{colspan:"2",class:"text-right"},"Potongan Supir",-1),Ys=t("td",{class:"p-1 text-right"},"Rp.",-1),js={class:"p-1 text-right"},Ms={key:1,class:"text-red-500 font-bold"},As=t("td",{colspan:"2",class:"text-right"},"Potongan Kernet",-1),Cs=t("td",{class:"p-1 text-right"},"Rp.",-1),Hs={class:"p-1 text-right"},Is={key:2,class:"text-red-500 font-bold"},Ls=t("td",{colspan:"2",class:"text-right"},"Total Potongan",-1),$s=t("td",{class:"p-1 text-right"},"Rp.",-1),Ns={class:"p-1 text-right"},Ss={key:3,class:"font-bold"},Ps=t("td",{colspan:"2",class:"text-right"},"Total Diterima",-1),Bs=t("td",{class:"p-1 text-right"},"Rp.",-1),Fs={class:"p-1 text-right"},Ks={class:"w-full sm:w-1/2 h-full"},Rs=["src"],Vs={key:1,class:"flex flex-col justify-center items-center px-2 py-8 border border-gray-700 bg-gray-300"},Us={class:"w-full border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200 mt-2 flex flex-row flex-wrap"},qs={class:"flex flex-col mr-5"},zs=t("span",{class:"text-xs font-bold"}," EM#ID ",-1),Es={class:""},Js={class:"flex flex-col mr-5"},Os=t("span",{class:"text-xs font-bold"}," Nama Penerima ",-1),Gs={class:""},Ws={class:"flex flex-col mr-5"},Qs=t("span",{class:"text-xs font-bold"}," No rek ",-1),Xs={class:""},Zs={class:"flex flex-col mr-5"},to=t("span",{class:"text-xs font-bold"}," Tanggal ",-1),eo={class:""},so={class:"flex flex-col mr-5"},oo=t("span",{class:"text-xs font-bold"}," Tujuan ",-1),lo={class:""},no={class:"flex flex-col mr-5"},ao=t("span",{class:"text-xs font-bold"}," Desc ",-1),ro={class:""},io={class:"flex flex-col mr-5"},co=t("span",{class:"text-xs font-bold"}," Total ",-1),_o={class:""},uo={class:"flex p-1 justify-end flex-wrap"},fo={class:"flex p-1 justify-center flex-wrap bg-yellow-100"},xo=t("div",{class:"w-full text-center"}," Akan dilakukan Transfer dengan data diatas. Apakah Informasi Diatas Sudah Benar Dan Tepat? ",-1),Lo={__name:"transfer",async setup(po){let y,P;const{$moment:h}=jt(),{pointFormat:p}=Mt(),w=gt("token");new Date().getTimezoneOffset();const{data:O}=([y,P]=bt(async()=>Yt(async()=>{v().loading_full=!0;let n=[];const[l,d]=await Promise.all([j("/trx_trp/transfers",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},retry:0})]);return l.status.value==="error"?(Y().trigger(l.error),{trx_trps:n}):(v().loading_full=!1,n=l.data.value.data,{trx_trps:n})},"$pIgiM26TjW")),y=await y,P(),y),M=f(O.value.trx_trps||[]),A=f({}),s=f({id:-1,tanggal:new Date,xto:"",tipe:"",jenis:"",amount:0,supir:"",kernet:"",no_pol:"",details_uj:[]}),C=f(-1),m=f(""),G=async n=>{v().loading_full=!0;const{data:l,error:d,status:r}=await j("/trx_trp/transfer/detail",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:{id:n.id},retry:0});if(v().loading_full=!1,r.value==="error"){Y().trigger(d,A);return}s.value=l.value.data},H=f(!1),W=async()=>{if(H.value)return;H.value=!0,v().loading_full=!0,A.value={};const n=new FormData;n.append("id",s.value.id),n.append("_method","PUT");let l="post";const{data:d,error:r,status:_}=await j("/trx_trp/transfer",{method:l,headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},body:n,retry:0});if(v().loading_full=!1,H.value=!1,_.value==="error"){Y().trigger(r,A);return}M.value.splice(C.value,1),C.value=-1,b.value=!1,g.value=!1},g=f(!1),Q=f(0),b=f(!1);yt();const X=(n,l)=>{C.value=n,Q.value=l,g.value=!0,G(l)},B=wt(()=>m.value!=""?M.value.filter(n=>n.no_pol.toLowerCase().includes(m.value.toLowerCase())||n.supir.toLowerCase().includes(m.value.toLowerCase())||n.kernet.toLowerCase().includes(m.value.toLowerCase())):M.value),k=n=>n.potongan&&n.potongan.length>0?n.potongan.map(l=>parseInt(l.nominal_cut)).reduce((l,d)=>(l+=d,l)):0,F=n=>{if(n.potongan&&n.potongan.length>0){let l=n.potongan.filter(r=>r.potongan_mst.employee_id==n.supir_id);if(l.length==0)return 0;let d=l.map(r=>parseInt(r.nominal_cut));return d.length==0?0:d.reduce((r,_)=>(r+=_,r))}return 0},K=n=>{if(n.potongan&&n.potongan.length>0){let l=n.potongan.filter(r=>r.potongan_mst.employee_id==n.kernet_id);if(l.length==0)return 0;let d=l.map(r=>parseInt(r.nominal_cut));return d.length==0?0:d.reduce((r,_)=>(r+=_,r))}return 0},Z=()=>{let n=m.value;document.querySelectorAll(".to_hl").forEach(l=>{let d=l.dataset.real;var r=l.innerHTML,_=d.toLowerCase().indexOf(n.toLowerCase());_>-1&&n!=""?(r=d.substring(0,_)+"<span class='highlight'>"+d.substring(_,_+n.length)+"</span>"+d.substring(_+n.length),l.innerHTML=r):l.innerHTML=r=d})};kt(()=>B,(n,l)=>{setTimeout(()=>{Z()},0)},{deep:!0,immediate:!0});const{downloadFile:tt,viewFile:ho}=At(),et=async()=>{v().loading_full=!0;const{data:n,error:l,status:d}=await j("/trx_trp/manual_tf",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:{},retry:0});if(v().loading_full=!1,d.value==="error"){Y().trigger(l);return}tt(n.value)},R=f(0);return(n,l)=>{var V,U;const d=ct,r=dt,_=_t,st=ut,ot=ft,lt=xt,nt=pt,at=ht,rt=mt,it=vt;return c(),i("div",Ct,[x(d,{title:"List Transaction"}),t("section",Ht,[t("div",It,[t("div",Lt,[T(t("input",{class:"flex-grow",type:"text","onUpdate:modelValue":l[0]||(l[0]=a=>Tt(m)?m.value=a:null),name:"search",placeholder:"Keyword"},null,512),[[Dt,e(m)]])]),t("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:l[1]||(l[1]=a=>et())},[x(r)])]),t("div",$t,[(c(!0),i(L,null,$(e(B),(a,D)=>(c(),i("div",Nt,[t("div",St,[t("div",Pt,[t("div",Bt,[t("div",Ft,o(a.id),1)]),t("div",Kt,[Rt,t("div",Vt,[x(_,{class:"mr-1"}),S(" "+o(e(h)(a.tanggal).format("DD-MM-YYYY")),1)])]),t("div",Ut,[qt,t("div",zt,[x(st,{class:"mr-1"}),t("span",{class:"to_hl","data-real":a.no_pol},o(a.no_pol),9,Et)])]),t("div",Jt,[Ot,t("div",Gt,[x(ot,{class:"mr-1"}),t("span",{class:"to_hl","data-real":a.supir},o(a.supir),9,Wt)])]),a.kernet?(c(),i("div",Qt,[Xt,t("div",Zt,[x(lt,{class:"mr-1"}),t("span",{class:"to_hl","data-real":a.kernet},o(a.kernet),9,te)])])):u("",!0),t("div",ee,[se,t("div",oe,[x(nt,{class:"mr-1"}),S(" "+o(a.xto),1)])])]),t("button",{class:"bg-blue-500 text-white rounded",onClick:I=>X(D,a)}," Detail ",8,le)])]))),256))])]),T(t("div",ne,[t("div",ae,[x(at,{title:"Detail Information",fn:()=>{g.value=!1,b.value=!1},class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("div",re,[t("div",ie,[t("div",ce,[t("div",de,[_e,t("div",ue,o(e(s).id),1)]),t("div",fe,[xe,t("div",pe,o(e(h)(e(s).tanggal).format("DD-MM-YYYY")),1)]),t("div",he,[me,t("div",ve,o(e(s).no_pol),1)]),t("div",ge,[t("div",be,[ye,t("div",we,o(e(s).supir),1)]),t("div",ke,[De,t("div",Te,o(e(s).supir_rek_no),1)])]),e(s).kernet?(c(),i("div",Ye,[t("div",je,[Me,t("div",Ae,o(e(s).kernet),1)]),t("div",Ce,[He,t("div",Ie,o(e(s).kernet_rek_no),1)])])):u("",!0),t("div",Le,[$e,t("div",Ne,o(e(s).xto),1)]),t("div",Se,[Pe,t("div",Be,o((V=e(s).uj)==null?void 0:V.asst_opt),1)]),t("div",Fe,[Ke,t("div",Re,o(e(s).tipe),1)]),t("div",Ve,[Ue,t("div",qe,o(e(s).jenis),1)]),e(s).transition_type=="From"?(c(),i("div",ze,[Ee,t("div",Je,o(e(s).transition_target),1)])):u("",!0)]),t("div",Oe,[e(s).val?(c(),i("div",Ge,[We,t("div",null," ( "+o(e(s).val_by.username)+" ) ",1),t("div",Qe,o(e(h)(e(s).val_at).format("DD-MM-YYYY HH:mm:ss")),1)])):u("",!0),e(s).val1?(c(),i("div",Xe,[Ze,t("div",null," ( "+o(e(s).val1_by.username)+" ) ",1),t("div",ts,o(e(h)(e(s).val1_at).format("DD-MM-YYYY HH:mm:ss")),1)])):u("",!0),e(s).val2?(c(),i("div",es,[ss,t("div",null," ( "+o(e(s).val2_by.username)+" ) ",1),t("div",os,o(e(h)(e(s).val2_at).format("DD-MM-YYYY HH:mm:ss")),1)])):u("",!0),e(s).val3?(c(),i("div",ls,[ns,t("div",null," ( "+o(e(s).val3_by.username)+" ) ",1),t("div",as,o(e(h)(e(s).val3_at).format("DD-MM-YYYY HH:mm:ss")),1)])):u("",!0),e(s).val4?(c(),i("div",rs,[is,t("div",null," ( "+o(e(s).val4_by.username)+" ) ",1),t("div",cs,o(e(h)(e(s).val4_at).format("DD-MM-YYYY HH:mm:ss")),1)])):u("",!0),e(s).val5?(c(),i("div",ds,[_s,t("div",null," ( "+o(e(s).val5_by.username)+" ) ",1),t("div",us,o(e(h)(e(s).val5_at).format("DD-MM-YYYY HH:mm:ss")),1)])):u("",!0)])]),t("div",fs,[t("table",xs,[ps,(c(!0),i(L,null,$(e(s).details_uj,a=>(c(),i("tr",null,[t("td",hs,o(a.ordinal)+". ",1),t("td",ms,o(a.xdesc)+" "+o(a.qty<=1?"":e(p)(a.qty||0)+" x Rp."+e(p)(a.harga||0)),1),vs,t("td",gs,o(e(p)(a.qty*a.harga)),1)]))),256)),t("tr",bs,[ys,ws,t("th",ks,o(e(p)(e(s).amount)),1)]),F(e(s))>0?(c(),i("tr",Ds,[Ts,Ys,t("td",js,o(e(p)(F(e(s)))),1)])):u("",!0),K(e(s))>0?(c(),i("tr",Ms,[As,Cs,t("td",Hs,o(e(p)(K(e(s)))),1)])):u("",!0),k(e(s))>0?(c(),i("tr",Is,[Ls,$s,t("td",Ns,o(e(p)(k(e(s)))),1)])):u("",!0),k(e(s))>0?(c(),i("tr",Ss,[Ps,Bs,t("td",Fs,o(e(p)(e(s).amount-k(e(s)))),1)])):u("",!0)])]),t("div",Ks,[((U=e(s).trx_absens)==null?void 0:U.length)>0?(c(),i("img",{key:0,class:"w-full",src:e(s).trx_absens[0].gambar},null,8,Rs)):(c(),i("div",Vs,[x(rt),S(" Tidak Ada Foto Berangkat ")]))]),(c(!0),i(L,null,$(e(s).extra_money_trxs,a=>{var D,I,q,z,E,J;return c(),i("div",Us,[t("div",qs,[zs,t("div",Es,o(a.id),1)]),t("div",Js,[Os,t("div",Gs,o((D=a.employee)==null?void 0:D.name),1)]),t("div",Ws,[Qs,t("div",Xs,o((I=a.employee)==null?void 0:I.rek_no),1)]),t("div",Zs,[to,t("div",eo,o(a.tanggal),1)]),t("div",so,[oo,t("div",lo,o((q=a.extra_money)==null?void 0:q.xto),1)]),t("div",no,[ao,t("div",ro,o((z=a.extra_money)==null?void 0:z.description),1)]),t("div",io,[co,t("div",_o,o(e(p)(((E=a.extra_money)==null?void 0:E.nominal)*((J=a.extra_money)==null?void 0:J.qty))),1)])])}),256))]),T(t("div",uo,[t("button",{class:"rounded m-1",onClick:l[2]||(l[2]=a=>g.value=!1)}," Cancel "),t("button",{class:"rounded m-1 text-white bg-blue-500",onClick:l[3]||(l[3]=a=>b.value=!0)}," Transfer ")],512),[[N,!e(b)]]),T(t("div",fo,[xo,t("button",{class:"rounded m-1 bg-white",onClick:l[4]||(l[4]=a=>(b.value=!1,g.value=!1))}," Tidak "),t("button",{class:"rounded m-1 text-white bg-blue-500",onClick:l[5]||(l[5]=a=>W())}," Ya ")],512),[[N,e(b)]])])],512),[[N,e(g)]]),x(it,{show:e(R),onSetTimeout:l[6]||(l[6]=a=>R.value=a)},null,8,["show"])])}}};export{Lo as default};
