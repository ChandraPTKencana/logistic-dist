import{_ as pe}from"./Header.906a4f14.js";import{u as me,_ as fe,a as ve}from"./useDownload.9ed1891b.js";import{_ as ye}from"./Table2Column.45eb96e8.js";import{_ as Te}from"./client-only.ade685a0.js";import{u as ge,_ as be}from"./useUtils.0499e5ee.js";import{_ as Ae,a as we}from"./Check.6f177a22.js";import{_ as Ce}from"./PopupMini.vue.543b41b7.js";import{_ as Be}from"./Times.1d70f46d.js";import{r as _,f as xe,D as Ne,B as Pe,H as Q,I as De,J as $e,c as t,b as p,a as i,w as W,t as l,k as r,h as Y,j as Ve,i as Se,l as X,m as Me,G as o,F as ee,n as te,E as je,x as m,y as B,o as e,q as U,N as A,O as Ie,s as Oe}from"./entry.1eda34e7.js";import{u as x}from"./useMyFetch.c9dacd92.js";import"./_plugin-vue_export-helper.c27b6911.js";const Re={class:"w-full h-full flex flex-col"},He={class:"w-full flex grow flex-col overflow-auto h-0"},Ye={class:"w-full flex"},Ue={action:"#",class:"w-full flex p-1"},ze=i("div",{class:"font-bold"}," Tgl Dari ",-1),Je={class:"text-red-500"},Fe=i("div",{class:"font-bold"}," Tgl Sampai ",-1),Ke={class:"text-red-500"},Ee={class:"grow"},Le=i("div",{class:"font-bold"}," Keyword ",-1),Ze={class:"pl-1"},qe=i("div",{class:"font-bold"}," Sort By ",-1),Ge=Ie('<option value=""></option><option value="id">ID</option><option value="xto">To</option><option value="jenis">Jenis</option><option value="tipe">Tipe</option><option value="pv_no">PV No</option><option value="ticket_a_no">Ticket A No</option><option value="ticket_b_no">Ticket B No</option>',8),Qe=[Ge],We={class:"pl-1"},Xe=i("div",{class:"font-bold"}," Sort Order ",-1),et=i("option",{value:"asc"},"Asc",-1),tt=i("option",{value:"desc"},"Desc",-1),ot=[et,tt],st={class:"flex items-end pl-1"},nt={class:"w-full flex justify-center items-center grow h-0 p-1"},at={key:0,class:""},it={class:"tacky"},ct={class:"sticky top-0 !z-[2]"},lt={key:0},rt={key:1},dt={key:2},ut={key:3},_t={key:4},kt={key:5},ht={key:6},pt={key:7},mt={key:8},ft={key:9},vt={key:10},yt={key:11},Tt={key:12},gt={key:13},bt={key:14},At={key:15},wt={key:16},Ct={key:17},Bt={key:18},xt={key:19},Nt={key:20},Pt={key:21},Dt={key:22},$t={key:23},Vt={key:24},St={key:25},Mt={key:26},jt={key:27},It={key:28},Ot={key:29},Rt={key:30},Ht={key:31},Yt={key:32},Ut={key:33},zt={key:34},Jt={key:35},Ft={key:36},Kt=["onClick"],Et={key:0},Lt={class:"flex items-center justify-center"},Zt={key:1},qt={class:"flex items-center justify-center"},Gt={key:2},Qt={class:"flex items-center justify-center"},Wt={key:3,class:"bold"},Xt={key:4},eo={key:5},to={key:6},oo={key:7},so={key:8},no={key:9},ao={key:10},io={key:11},co={key:12},lo={key:13},ro={key:14},uo={key:15},_o={key:16},ko={key:17},ho={key:18},po={key:19},mo={key:20},fo={key:21},vo={key:22},yo={key:23},To={key:24},go={key:25},bo={key:26},Ao={key:27},wo={key:28},Co={key:29},Bo={key:30},xo={key:31},No={key:32},Po={key:33},Do={key:34},$o={key:35},Vo={key:36},So={key:0,class:"w-full h-full flex items-center justify-center fixed top-0 left-0 z-20 p-3",style:{"background-color":"rgba(255,255,255,0.9)"}},Mo={class:"relative",style:{width:"95%",height:"90%"}},jo={class:"absolute -top-7 right-0 bg-white",style:{position:"absolute",padding:"5px 10px",border:"solid 1px #ccc","border-bottom":"none","border-top-right-radius":"5px","border-top-left-radius":"5px"}},Io=["src"],Oo={key:1,class:"w-full h-full flex items-center justify-center fixed top-0 left-0 z-20 p-3",style:{"background-color":"rgba(255,255,255,0.9)"}},Ro={class:"relative",style:{width:"95%",height:"90%"}},Ho={class:"absolute -top-7 right-0 bg-white",style:{position:"absolute",padding:"5px 10px",border:"solid 1px #ccc","border-bottom":"none","border-top-right-radius":"5px","border-top-left-radius":"5px"}},Yo={class:"w-full h-full flex flex-col items-center justify-content-center bg-white"},Uo={class:"w-full p-1"},zo={class:"w-full p-1 bg-gray-200"},Jo=i("div",{class:"w-full text-blue-600 font-bold grid-"}," Set Show Column Field ",-1),Fo={class:"w-full flex flex-wrap"},Ko=["onClick"],Eo={class:"w-full flex justify-end"},is={__name:"index",async setup(Lo){let N,z;const{$moment:f}=Oe(),{pointFormat:y}=ge(),d={};d._TimeZoneOffset=new Date().getTimezoneOffset(),d.sort="tanggal:desc";const P=_({}),w=xe("token"),T=_({from:"",to:""}),{data:oe}=([N,z]=Ne(async()=>je(async()=>{m().loading_full=!0;let c=[];const[a,h]=await Promise.all([x("/trx_trps",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},retry:0})]);return a.status.value!=="error"&&(c=a.data.value.data),a.status.value==="error"?(B().trigger(a.error),{trx_trps:c}):(m().loading_full=!1,{trx_trps:c})},"$8KmJHfPiB5")),N=await N,z(),N),v=_(oe.value.trx_trps||[]),u=_(""),g=_({field:"tanggal",by:"desc"}),C=_(-1),k=_({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),j=()=>{d.like="",u.value!=""&&(d.like=`id:%${u.value}%,xto:%${u.value}%,jenis:%${u.value}%,pv_no:%${u.value}%,ticket_a_no:%${u.value}%,ticket_b_no:%${u.value}%,no_pol:%${u.value}%,supir:%${u.value}%,kernet:%${u.value}%,cost_center_code:%${u.value}%,cost_center_desc:%${u.value}%,pvr_id:%${u.value}%,pvr_no:%${u.value}%,tanggal:%${u.value}%`),d.sort="",g.value.field&&(d.sort=g.value.field+":"+g.value.by),d._TimeZoneOffset=new Date().getTimezoneOffset(),d.date_from=T.value.from?f(T.value.from).format("YYYY-MM-DD"):"",d.date_to=T.value.to?f(T.value.to).format("YYYY-MM-DD"):""},D=_(null),J=async()=>{m().loading_full=!0,P.value={},k.value.may_get_data=!1,d.page=k.value.page,d.page==1&&(v.value=[]),d.first_row&&delete d.first_row,d.page>1&&(d.first_row=JSON.stringify(v.value[0]));const{data:c,error:a,status:h}=await x("/trx_trps",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:d,retry:0});if(m().loading_full=!1,k.value.may_get_data=!0,h.value==="error"){B().trigger(a,P);return}k.value.page==1?(v.value=c.value.data,D.value&&(D.value.scrollTop=0)):k.value.page>1&&(v.value=[...v.value,...c.value.data]),c.value.data.length==0&&(k.value.is_last_record=!0)},se=async()=>{if(!k.value.may_get_data)return;let c=D.value;if(c.scrollLeft!=k.value.scrollLeft){k.value.scrollLeft=c.scrollLeft;return}k.value.is_last_record||!(Math.round(c.scrollTop)+c.clientHeight>=c.scrollHeight-1)||(k.value.page++,await J())},ne=()=>{k.value.page=1,k.value.is_last_record=!1,j(),J()};Pe(),_(!1),_(0),Q(),De(Q());const ae=_({}),$=_(!1),ie=async()=>{$.value&&($.value=!1)},ce=async()=>{m().loading_full=!0;const c=new FormData;c.append("id",v.value[C.value].id),c.append("_method","DELETE");const{data:a,error:h,status:O}=await x("/trx_trp",{method:"post",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},body:c,retry:0});if(m().loading_full=!1,O.value==="error"){B().trigger(h);return}v.value.splice(C.value,1),C.value=-1,$.value=!1},{downloadFile:F,viewFile:Zo}=me(),V=_(!1),I=_(""),K=async()=>{if(V.value==!0){V.value=!1;return}j(),m().loading_full=!0;const{data:c,error:a,status:h}=await x("/trx_trps_preview_file",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:d,retry:0});if(m().loading_full=!1,h.value==="error"){B().trigger(a);return}I.value=c.value,V.value=!0},le=async()=>{j(),m().loading_full=!0;const{data:c,error:a,status:h}=await x("/trx_trps_download_excel",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:d,retry:0});if(m().loading_full=!1,h.value==="error"){B().trigger(a);return}F(c.value)},re=()=>{F(I.value)},S=_(!1),E=c=>{c=="select"?b.value=b.value.map(a=>(a.checked=1,a)):b.value=b.value.map(a=>(a.checked=0,a))},b=_([{checked:1,name:"Status"},{checked:1,name:"App 1"},{checked:1,name:"App 2"},{checked:1,name:"ID"},{checked:1,name:"U.Jalan Per"},{checked:1,name:"No Pol"},{checked:1,name:"Tujuan"},{checked:1,name:"Tipe"},{checked:1,name:"Jenis"},{checked:1,name:"Amount"},{checked:1,name:"Cost Center Code"},{checked:1,name:"Cost Center Desc"},{checked:1,name:"PVR No"},{checked:1,name:"PVR Total"},{checked:1,name:"PVR Completed"},{checked:1,name:"PV No"},{checked:1,name:"PV Total"},{checked:1,name:"Ticket A No"},{checked:1,name:"Ticket A Bruto"},{checked:1,name:"Ticket A Tara"},{checked:1,name:"Ticket A Netto"},{checked:1,name:"Ticket A Supir"},{checked:1,name:"Ticket A No Pol"},{checked:1,name:"Ticket A In At"},{checked:1,name:"Ticket A Out At"},{checked:1,name:"Ticket B No"},{checked:1,name:"Ticket B Bruto"},{checked:1,name:"Ticket B Tara"},{checked:1,name:"Ticket B Netto"},{checked:1,name:"Ticket B Supir"},{checked:1,name:"Ticket B No Pol"},{checked:1,name:"Ticket B In At"},{checked:1,name:"Ticket B Out At"},{checked:1,name:"Supir"},{checked:1,name:"Kernet"},{checked:1,name:"Created At"},{checked:1,name:"Updated At"}]),s=c=>{let a=b.value.map(h=>h.name).indexOf(c);return b.value[a].checked},L=c=>c.pv_id<=0||["CPO","PK"].indexOf(c.jenis)>-1&&(c.ticket_a_id<=0||c.ticket_b_bruto<=0||c.ticket_b_tara<=0||c.ticket_b_netto<=0||c.ticket_b_in_at==""||c.ticket_b_out_at=="")||c.jenis=="TBS"&&(c.ticket_a_id<=0||c.ticket_b_id<=0)||c.jenis=="TBSK"&&c.ticket_b_id<=0?0:1;return(c,a)=>{const h=pe,O=fe,de=ye,ue=ve,Z=$e("vue-date-picker"),q=Te,_e=be,R=Ae,H=we,ke=Ce,G=Be;return e(),t("div",Re,[p(h,{title:"Report Transaction"}),i("div",He,[i("div",Ye,[i("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:a[0]||(a[0]=n=>K())},[p(O)]),i("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:a[1]||(a[1]=n=>le())},[p(de)]),i("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:a[2]||(a[2]=n=>S.value=!0)},[p(ue)])]),i("form",Ue,[i("div",null,[ze,p(q,null,{default:W(()=>[p(Z,{modelValue:r(T).from,"onUpdate:modelValue":a[3]||(a[3]=n=>r(T).from=n),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1}),i("p",Je,l(r(P).date_from),1)]),i("div",null,[Fe,p(q,null,{default:W(()=>[p(Z,{modelValue:r(T).to,"onUpdate:modelValue":a[4]||(a[4]=n=>r(T).to=n),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1}),i("p",Ke,l(r(P).date_to),1)]),i("div",Ee,[Le,Y(i("input",{class:"",type:"text","onUpdate:modelValue":a[5]||(a[5]=n=>Se(u)?u.value=n:null),name:"search",placeholder:"Keyword"},null,512),[[Ve,r(u)]])]),i("div",Ze,[qe,Y(i("select",{class:"","onUpdate:modelValue":a[6]||(a[6]=n=>r(g).field=n)},Qe,512),[[X,r(g).field]])]),i("div",We,[Xe,Y(i("select",{class:"","onUpdate:modelValue":a[7]||(a[7]=n=>r(g).by=n)},ot,512),[[X,r(g).by]])]),i("div",st,[i("button",{class:"",type:"submit",name:"button",onClick:a[8]||(a[8]=Me(n=>ne(),["prevent"]))},[p(_e,{class:"text-2xl"})])])]),i("div",nt,[r(v).length==0?(e(),t("div",at," Maaf Tidak Ada Record ")):(e(),t("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:D,onScroll:se},[i("table",it,[i("thead",null,[i("tr",ct,[s("Status")?(e(),t("th",lt,"Status")):o("",!0),s("App 1")?(e(),t("th",rt,"App 1")):o("",!0),s("App 2")?(e(),t("th",dt,"App 2")):o("",!0),s("ID")?(e(),t("th",ut,"ID")):o("",!0),s("U.Jalan Per")?(e(),t("th",_t,"U.Jalan Per")):o("",!0),s("No Pol")?(e(),t("th",kt,"No Pol")):o("",!0),s("Tujuan")?(e(),t("th",ht,"Tujuan")):o("",!0),s("Tipe")?(e(),t("th",pt,"Tipe")):o("",!0),s("Jenis")?(e(),t("th",mt,"Jenis")):o("",!0),s("Amount")?(e(),t("th",ft,"Amount")):o("",!0),s("Cost Center Code")?(e(),t("th",vt,"Cost Center Code")):o("",!0),s("Cost Center Desc")?(e(),t("th",yt,"Cost Center Desc")):o("",!0),s("PVR No")?(e(),t("th",Tt,"PVR No")):o("",!0),s("PVR Total")?(e(),t("th",gt,"PVR Total")):o("",!0),s("PVR Completed")?(e(),t("th",bt,"PVR Completed")):o("",!0),s("PV No")?(e(),t("th",At,"PV No")):o("",!0),s("PV Total")?(e(),t("th",wt,"PV Total")):o("",!0),s("Ticket A No")?(e(),t("th",Ct,"Ticket A No")):o("",!0),s("Ticket A Bruto")?(e(),t("th",Bt,"Ticket A Bruto")):o("",!0),s("Ticket A Tara")?(e(),t("th",xt,"Ticket A Tara")):o("",!0),s("Ticket A Netto")?(e(),t("th",Nt,"Ticket A Netto")):o("",!0),s("Ticket A Supir")?(e(),t("th",Pt,"Ticket A Supir")):o("",!0),s("Ticket A No Pol")?(e(),t("th",Dt,"Ticket A No Pol")):o("",!0),s("Ticket A In At")?(e(),t("th",$t,"Ticket A In At")):o("",!0),s("Ticket A Out At")?(e(),t("th",Vt,"Ticket A Out At")):o("",!0),s("Ticket B No")?(e(),t("th",St,"Ticket B No")):o("",!0),s("Ticket B Bruto")?(e(),t("th",Mt,"Ticket B Bruto")):o("",!0),s("Ticket B Tara")?(e(),t("th",jt,"Ticket B Tara")):o("",!0),s("Ticket B Netto")?(e(),t("th",It,"Ticket B Netto")):o("",!0),s("Ticket B Supir")?(e(),t("th",Ot,"Ticket B Supir")):o("",!0),s("Ticket B No Pol")?(e(),t("th",Rt,"Ticket B No Pol")):o("",!0),s("Ticket B In At")?(e(),t("th",Ht,"Ticket B In At")):o("",!0),s("Ticket B Out At")?(e(),t("th",Yt,"Ticket B Out At")):o("",!0),s("Supir")?(e(),t("th",Ut,"Supir")):o("",!0),s("Kernet")?(e(),t("th",zt,"Kernet")):o("",!0),s("Created At")?(e(),t("th",Jt,"Created At")):o("",!0),s("Updated At")?(e(),t("th",Ft,"Updated At")):o("",!0)])]),i("tbody",null,[(e(!0),t(ee,null,te(r(v),(n,M)=>(e(),t("tr",{key:M,onClick:he=>C.value=M,class:U(r(C)==M?"active":"")},[s("Status")?(e(),t("td",Et,[i("div",Lt,[i("div",{class:U(["text-white text-xs px-2 py-1 rounded-lg",L(n)?"bg-green-600":"bg-red-600"])},l(L(n)?"Done":"Not Done"),3)])])):o("",!0),s("App 1")?(e(),t("td",Zt,[i("div",qt,[n.val?(e(),A(H,{key:1})):(e(),A(R,{key:0}))])])):o("",!0),s("App 2")?(e(),t("td",Gt,[i("div",Qt,[n.val1?(e(),A(H,{key:1})):(e(),A(R,{key:0}))])])):o("",!0),s("ID")?(e(),t("td",Wt,l(n.id),1)):o("",!0),s("U.Jalan Per")?(e(),t("td",Xt,l(n.tanggal?r(f)(n.tanggal).format("DD-MM-Y"):""),1)):o("",!0),s("No Pol")?(e(),t("td",eo,l(n.no_pol),1)):o("",!0),s("Tujuan")?(e(),t("td",to,l(n.xto),1)):o("",!0),s("Tipe")?(e(),t("td",oo,l(n.tipe),1)):o("",!0),s("Jenis")?(e(),t("td",so,l(n.jenis),1)):o("",!0),s("Amount")?(e(),t("td",no,l(r(y)(n.amount)),1)):o("",!0),s("Cost Center Code")?(e(),t("td",ao,l(n.cost_center_code),1)):o("",!0),s("Cost Center Desc")?(e(),t("td",io,l(n.cost_center_desc),1)):o("",!0),s("PVR No")?(e(),t("td",co,l(n.pvr_no),1)):o("",!0),s("PVR Total")?(e(),t("td",lo,l(n.pv_amount),1)):o("",!0),s("PVR Completed")?(e(),t("td",ro,[n.pvr_had_detail?(e(),A(H,{key:1})):(e(),A(R,{key:0}))])):o("",!0),s("PV No")?(e(),t("td",uo,l(n.pv_no),1)):o("",!0),s("PV Total")?(e(),t("td",_o,l(r(y)(n.pv_total)),1)):o("",!0),s("Ticket A No")?(e(),t("td",ko,l(n.ticket_a_no),1)):o("",!0),s("Ticket A Bruto")?(e(),t("td",ho,l(r(y)(n.ticket_a_bruto)),1)):o("",!0),s("Ticket A Tara")?(e(),t("td",po,l(r(y)(n.ticket_a_tara)),1)):o("",!0),s("Ticket A Netto")?(e(),t("td",mo,l(r(y)(n.ticket_a_netto)),1)):o("",!0),s("Ticket A Supir")?(e(),t("td",fo,l(n.ticket_a_supir),1)):o("",!0),s("Ticket A No Pol")?(e(),t("td",vo,l(n.ticket_a_no_pol),1)):o("",!0),s("Ticket A In At")?(e(),t("td",yo,l(n.ticket_a_in_at?r(f)(n.ticket_a_in_at).format("DD-MM-Y HH:mm:ss"):""),1)):o("",!0),s("Ticket A Out At")?(e(),t("td",To,l(n.ticket_a_out_at?r(f)(n.ticket_a_out_at).format("DD-MM-Y HH:mm:ss"):""),1)):o("",!0),s("Ticket B No")?(e(),t("td",go,l(n.ticket_b_no),1)):o("",!0),s("Ticket B Bruto")?(e(),t("td",bo,l(r(y)(n.ticket_b_bruto)),1)):o("",!0),s("Ticket B Tara")?(e(),t("td",Ao,l(r(y)(n.ticket_b_tara)),1)):o("",!0),s("Ticket B Netto")?(e(),t("td",wo,l(r(y)(n.ticket_b_netto)),1)):o("",!0),s("Ticket B Supir")?(e(),t("td",Co,l(n.ticket_b_supir),1)):o("",!0),s("Ticket B No Pol")?(e(),t("td",Bo,l(n.ticket_b_no_pol),1)):o("",!0),s("Ticket B In At")?(e(),t("td",xo,l(n.ticket_b_in_at?r(f)(n.ticket_b_in_at).format("DD-MM-Y HH:mm:ss"):""),1)):o("",!0),s("Ticket B Out At")?(e(),t("td",No,l(n.ticket_b_out_at?r(f)(n.ticket_b_out_at).format("DD-MM-Y HH:mm:ss"):""),1)):o("",!0),s("Supir")?(e(),t("td",Po,l(n.supir),1)):o("",!0),s("Kernet")?(e(),t("td",Do,l(n.kernet),1)):o("",!0),s("Created At")?(e(),t("td",$o,l(n.created_at?r(f)(n.created_at).format("DD-MM-Y HH:mm:ss"):""),1)):o("",!0),s("Updated At")?(e(),t("td",Vo,l(n.updated_at?r(f)(n.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)):o("",!0)],10,Kt))),128))])])],544))])]),p(ke,{type:"delete",show:r($),data:r(ae),fnClose:ie,fnConfirm:ce},null,8,["show","data"]),r(V)?(e(),t("div",So,[i("div",Mo,[i("div",jo,[p(G,{style:{color:"black",cursor:"pointer"},onClick:a[9]||(a[9]=n=>K())})]),i("iframe",{ref:"iframe",width:"100%",height:"100%",src:r(I).dataBase64},null,8,Io),i("div",{style:{position:"absolute",top:"12px",right:"88px","background-color":"rgba(255,255,255,0)",width:"37px",height:"36px","z-index":"1",cursor:"pointer"},onClick:a[10]||(a[10]=n=>re())})])])):o("",!0),r(S)?(e(),t("div",Oo,[i("div",Ro,[i("div",Ho,[p(G,{style:{color:"black",cursor:"pointer"},onClick:a[11]||(a[11]=n=>S.value=!1)})]),i("div",Yo,[i("div",Uo,[i("div",zo,[Jo,i("div",Fo,[(e(!0),t(ee,null,te(r(b),(n,M)=>(e(),t("div",{class:U(["p-2 m-1 font-bold cursor-pointer",n.checked?"bg-green-600 text-white":"bg-gray-400 text-black"]),onClick:he=>n.checked=!n.checked},l(n.name),11,Ko))),256))]),i("div",Eo,[i("button",{class:"bg-white font-bold mr-2",onClick:a[12]||(a[12]=n=>E("select"))}," Select All "),i("button",{class:"bg-white font-bold",onClick:a[13]||(a[13]=n=>E("invert"))}," Invert All ")])])])]),i("div",{style:{position:"absolute",top:"12px",right:"98px","background-color":"rgba(255,255,255,0)",width:"37px",height:"36px","z-index":"1",cursor:"pointer"},onClick:a[14]||(a[14]=n=>S.value=!1)})])])):o("",!0)])}}};export{is as default};
