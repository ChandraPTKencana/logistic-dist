import{_ as z}from"./HeaderPopup.vue.277b1e3b.js";import{_ as K}from"./client-only.8e6a0e1e.js";import{r as y,g as R,i as S,f as U,I as E,k as B,K as Y,o as u,c as d,a as t,b as D,l as a,t as n,w as I,m as O,A as H,n as v,d as i,F as V,D as Q,C as W,G as X,x as w,y as A}from"./entry.4e8b375c.js";import{u as M}from"./useUtils.6a422976.js";import{u as G}from"./useMyFetch.0b4b0401.js";import"./Times.e4560de7.js";import"./_plugin-vue_export-helper.c27b6911.js";const Z={class:"box-fixed"},x={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},tt={class:"w-full flex flex-col items-center grow overflow-auto"},at={class:"w-full flex flex-row flex-wrap"},st={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},nt=t("label",{for:""},"Period End",-1),_t={key:0,class:"card-border"},et={key:1},lt={class:"text-red-500"},ot={key:0,class:"w-full sm:w-6/12 md:w-4/12 lg:w-4/12 p-1"},it=t("div",{class:"font-bold"}," Filter Nama ",-1),rt={key:0,class:"w-full flex p-1 justify-between flex-wrap"},pt={class:"w-full",role:"sticky"},ut={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},dt=t("tr",{class:"sticky -top-1 !z-[2]"},[t("td",{colspan:"44",class:"!bg-slate-800 text-white font-bold"}," Detail ")],-1),ct={class:"sticky top-7 !z-[2]"},mt=t("th",{rowspan:"2"},"No",-1),ht=t("th",{rowspan:"2"},"ID",-1),bt=t("th",{rowspan:"2"},"Nama Pekerja",-1),gt=t("th",{rowspan:"2"},"Jabatan",-1),yt=t("th",{rowspan:"2"},"Tmpt Lahir",-1),jt=t("th",{rowspan:"2"},"Tgl Lahir",-1),ft=t("th",{rowspan:"2"},"TMK",-1),kt=t("th",{rowspan:"2"},"No KTP",-1),vt=t("th",{rowspan:"2"},"Alamat",-1),wt=t("th",{rowspan:"2"},"Status",-1),Ft=t("th",{rowspan:"2"},"No Rek",-1),Dt=t("th",{rowspan:"2"},"Nama Rek",-1),Mt=t("th",{rowspan:"2"},"Nama Bank",-1),Pt={colspan:"3"},Ct={class:"text-sm"},Nt={rowspan:"2"},Tt={class:"text-sm"},St={rowspan:"2"},Bt={class:"text-sm"},Vt={colspan:"3"},At={class:"text-sm"},Gt={rowspan:"2"},qt={class:"text-sm"},Jt={rowspan:"2"},$t={class:"text-sm"},Lt={colspan:"3"},zt={class:"text-sm"},Kt={rowspan:"2"},Rt={class:"text-sm"},Ut={rowspan:"2"},Et={class:"text-sm"},Yt={colspan:"4"},It={class:"text-sm"},Ot={colspan:"4"},Ht={class:"text-sm"},Qt={colspan:"3",class:"whitespace-nowrap"},Wt={class:"text-sm"},Xt={rowspan:"2"},Zt={class:"text-sm"},xt={rowspan:"2"},ta={class:"text-sm"},aa={rowspan:"2"},sa={class:"text-sm"},na={rowspan:"2"},_a={class:"text-sm"},ea={rowspan:"2"},la={class:"text-sm"},oa={class:"sticky top-[60px] !z-[2]"},ia={class:"text-sm"},ra={class:"text-sm"},pa={class:"text-sm"},ua={class:"text-sm"},da={class:"text-sm"},ca={class:"text-sm"},ma={class:"text-sm"},ha={class:"text-sm"},ba={class:"text-sm"},ga={class:"text-sm"},ya={class:"text-sm"},ja={class:"text-sm"},fa={class:"text-sm"},ka={class:"text-sm"},va={class:"text-sm"},wa={class:"text-sm"},Fa={class:"text-sm"},Da={class:"text-sm"},Ma={class:"text-sm"},Pa={class:"text-sm"},Ca={ref:"to_move"},Na=["data-index"],Ta={class:"w-full flex items-center justify-end"},$a={__name:"rpt_salary",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(j){const c=j,{$moment:f}=X(),{pointFormat:e}=M(),P={id:"",period_end:new Date},r=y({...P}),C=R("token"),k=y({}),m=y([]),o=y([]),q=async()=>{w().loading_full=!0,k.value={};const p=new FormData;p.append("period_end",r.value.period_end?f(r.value.period_end).format("Y-MM"):"");let s="post",_=r.value.id;_==""||(p.append("id",_),p.append("_method","PUT"));const{data:h,error:F,status:l}=await G("/rpt_salary",{method:s,headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},body:p,retry:0});if(w().loading_full=!1,l.value==="error"){A().trigger(F,k);return}if(m.value=h.value.details,_<=0)r.value.id=h.value.id,r.value.created_at=h.value.created_at,r.value.updated_at=h.value.updated_at,c.p_data.unshift(r.value);else{r.value.updated_at=h.value.updated_at;let b=c.p_data.map(L=>L.id).indexOf(_);b>-1&&c.p_data.splice(b,1,{...r.value})}N(m.value)},J=S(()=>r.value.val&&r.value.val1||M().checkPermission("rpt_salary.val")&&r.value.val||M().checkPermission("rpt_salary.val1")&&r.value.val1),$=async()=>{w().loading_full=!0;const{data:p,error:s,status:_}=await G("/rpt_salary",{method:"get",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},params:{id:c.id},retry:0});if(w().loading_full=!1,_.value==="error"){A().trigger(s);return}r.value=p.value.data,c.is_copy&&(r.value.val=0,r.value.val1=0),m.value=p.value.data.details,N(p.value.data.details)},N=p=>{let s={details:p,standby_1_ttl:0,standby_1_gaji:0,standby_1_makan:0,standby_1_dinas:0,perubahaan_lainnya_1_ttl:0,periode_1_ttl:0,standby_2_ttl:0,standby_2_gaji:0,standby_2_makan:0,standby_2_dinas:0,perubahaan_lainnya_2_ttl:0,perubahaan_kerajinan_ttl:0,periode_2_ttl:0,periode_ttl:0,trip_umum_ttl:0,trip_umum_gaji:0,trip_umum_makan:0,trip_umum_dinas:0,trip_lain_ttl:0,trip_lain_jlh:0,trip_lain_gaji:0,trip_lain_makan:0,trip_lain_dinas:0,trip_tunggu_ttl:0,trip_tunggu_jlh:0,trip_tunggu_gaji:0,trip_tunggu_dinas:0,bonus_trip_ttl:0,trip_jumlah:0,bonus_trip_gaji:0,bonus_trip_dinas:0,bonus_trip_perubahaan:0,potongan_trip:0,total:0,bpjs_kesehatan_ttl:0,bpjs_jamsos_ttl:0,total_grand:0};s.details.forEach(_=>{_.periode_1_ttl=parseFloat(_.sb_gaji)+parseFloat(_.sb_makan)+parseFloat(_.sb_dinas)+parseFloat(_.salary_bonus_nominal),_.trip_jumlah=_.trip_cpo+_.trip_pk+_.trip_tbs+_.trip_tbsk,_.bonus_trip_gaji=parseFloat(_.trip_cpo_bonus_gaji)+parseFloat(_.trip_pk_bonus_gaji)+parseFloat(_.trip_tbs_bonus_gaji)+parseFloat(_.trip_tbsk_bonus_gaji),_.bonus_trip_dinas=parseFloat(_.trip_cpo_bonus_dinas)+parseFloat(_.trip_pk_bonus_dinas)+parseFloat(_.trip_tbs_bonus_dinas)+parseFloat(_.trip_tbsk_bonus_dinas),_.periode_2_ttl=parseFloat(_.sb_gaji_2)+parseFloat(_.sb_makan_2)+parseFloat(_.sb_dinas_2)+parseFloat(_.salary_bonus_nominal_2)+parseFloat(_.kerajinan)+parseFloat(_.bonus_trip_gaji)+parseFloat(_.bonus_trip_dinas)+parseFloat(_.salary_bonus_bonus_trip),_.periode_ttl=_.periode_1_ttl+_.periode_2_ttl,_.total=parseFloat(_.uj_gaji)+parseFloat(_.uj_makan)+parseFloat(_.uj_dinas)+parseFloat(_.trip_lain_gaji)+parseFloat(_.trip_lain_makan)+parseFloat(_.trip_lain_dinas)+parseFloat(_.trip_tunggu_gaji)+parseFloat(_.trip_tunggu_dinas)-parseFloat(_.nominal_cut),_.total_grand=_.periode_ttl+_.total-parseFloat(_.employee_bpjs_kesehatan)-parseFloat(_.employee_bpjs_jamsos),s.standby_1_gaji+=parseFloat(_.sb_gaji),s.standby_1_makan+=parseFloat(_.sb_makan),s.standby_1_dinas+=parseFloat(_.sb_dinas),s.perubahaan_lainnya_1_ttl+=parseFloat(_.salary_bonus_nominal),s.standby_2_gaji+=parseFloat(_.sb_gaji_2),s.standby_2_makan+=parseFloat(_.sb_makan_2),s.standby_2_dinas+=parseFloat(_.sb_dinas_2),s.perubahaan_lainnya_2_ttl+=parseFloat(_.salary_bonus_nominal_2),s.perubahaan_kerajinan_ttl+=parseFloat(_.kerajinan),s.trip_umum_gaji+=parseFloat(_.uj_gaji),s.trip_umum_makan+=parseFloat(_.uj_makan),s.trip_umum_dinas+=parseFloat(_.uj_dinas),s.trip_lain_jlh+=_.trip_lain,s.trip_lain_gaji+=parseFloat(_.trip_lain_gaji),s.trip_lain_makan+=parseFloat(_.trip_lain_makan),s.trip_lain_dinas+=parseFloat(_.trip_lain_dinas),s.trip_tunggu_jlh+=_.trip_tunggu,s.trip_tunggu_gaji+=parseFloat(_.trip_tunggu_gaji),s.trip_tunggu_dinas+=parseFloat(_.trip_tunggu_dinas),s.trip_jumlah+=_.trip_jumlah,s.bonus_trip_gaji+=_.bonus_trip_gaji,s.bonus_trip_dinas+=_.bonus_trip_dinas,s.bonus_trip_perubahaan+=parseFloat(_.salary_bonus_bonus_trip),s.potongan_trip+=parseFloat(_.nominal_cut),s.bpjs_kesehatan_ttl+=parseFloat(_.employee_bpjs_kesehatan),s.bpjs_jamsos_ttl+=parseFloat(_.employee_bpjs_jamsos)}),s.standby_1_ttl=s.standby_1_gaji+s.standby_1_makan+s.standby_1_dinas,s.periode_1_ttl=s.standby_1_ttl+s.perubahaan_lainnya_1_ttl,s.standby_2_ttl=s.standby_2_gaji+s.standby_2_makan+s.standby_2_dinas,s.bonus_trip_ttl=s.bonus_trip_gaji+s.bonus_trip_dinas+s.bonus_trip_perubahaan,s.periode_2_ttl=s.standby_2_ttl+s.perubahaan_lainnya_2_ttl+s.perubahaan_kerajinan_ttl+s.bonus_trip_ttl,s.periode_ttl=s.periode_1_ttl+s.periode_2_ttl,s.trip_umum_ttl=s.trip_umum_gaji+s.trip_umum_makan+s.trip_umum_dinas,s.trip_lain_ttl=s.trip_lain_gaji+s.trip_lain_makan+s.trip_lain_dinas,s.trip_tunggu_ttl=s.trip_tunggu_gaji+s.trip_tunggu_dinas,s.total=s.trip_umum_ttl+s.trip_lain_ttl+s.trip_tunggu_ttl-s.potongan_trip,s.total_grand=s.periode_ttl+s.total-s.bpjs_kesehatan_ttl-s.bpjs_jamsos_ttl,o.value=s},g=y(""),T=S(()=>g.value!=""?m.value.filter(p=>p.employee.name.toLowerCase().includes(g.value.toLowerCase())):m.value);return U(()=>c.show,(p,s)=>{p==!0&&(r.value={...P},m.value=[],k.value={},c.id!=0&&$())},{immediate:!0}),(p,s)=>{const _=z,h=E("vue-date-picker"),F=K;return B((u(),d("section",Z,[t("div",null,[D(_,{title:"Form Salary Report",fn:j.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",x,[t("div",tt,[t("div",at,[t("div",st,[nt,a(r).id?(u(),d("div",_t,n(a(f)(a(r).period_end).format("MM-Y")),1)):(u(),d("div",et,[D(F,null,{default:I(()=>[D(h,{modelValue:a(r).period_end,"onUpdate:modelValue":s[0]||(s[0]=l=>a(r).period_end=l),format:"MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"","month-picker":""},null,8,["modelValue"])]),_:1})])),t("p",lt,n(a(k).period_end),1)]),a(m).length?(u(),d("div",ot,[it,B(t("input",{class:"",type:"text","onUpdate:modelValue":s[1]||(s[1]=l=>O(g)?g.value=l:null),name:"search",placeholder:"Nama"},null,512),[[H,a(g)]])])):v("",!0)]),a(T).length?(u(),d("div",rt,[t("div",pt,[t("table",ut,[t("thead",null,[dt,t("tr",ct,[mt,ht,bt,gt,yt,jt,ft,kt,vt,wt,Ft,Dt,Mt,t("th",Pt,[i("Standby 1 "),t("span",Ct,"("+n(a(e)(a(o).standby_1_ttl))+")",1)]),t("th",Nt,[i("Potongan 1 "),t("span",Tt,"("+n(a(e)(a(o).perubahaan_lainnya_1_ttl))+")",1)]),t("th",St,[i("Periode 1 "),t("span",Bt,"("+n(a(e)(a(o).periode_1_ttl))+")",1)]),t("th",Vt,[i("Standby 2 "),t("span",At,"("+n(a(e)(a(o).standby_2_ttl))+")",1)]),t("th",Gt,[i("Potongan 2 "),t("span",qt,"("+n(a(e)(a(o).perubahaan_lainnya_2_ttl))+")",1)]),t("th",Jt,[i("U.Kerajinan "),t("span",$t,"("+n(a(e)(a(o).perubahaan_kerajinan_ttl))+")",1)]),t("th",Lt,[i("Bonus Trip "),t("span",zt,"("+n(a(e)(a(o).bonus_trip_ttl))+")",1)]),t("th",Kt,[i("Periode 2 "),t("span",Rt,"("+n(a(e)(a(o).periode_2_ttl))+")",1)]),t("th",Ut,[i("Periode 1+2 "),t("span",Et,"("+n(a(e)(a(o).periode_ttl))+")",1)]),t("th",Yt,[i("Trip "),t("span",It,"("+n(a(e)(a(o).trip_umum_ttl))+")",1)]),t("th",Ot,[i("Trip Lain "),t("span",Ht,"("+n(a(e)(a(o).trip_lain_ttl))+")",1)]),t("th",Qt,[i("Trip Tunggu "),t("span",Wt,"("+n(a(e)(a(o).trip_tunggu_ttl))+")",1)]),t("th",Xt,[i("Potongan Trip "),t("span",Zt,"("+n(a(e)(a(o).potongan_trip))+")",1)]),t("th",xt,[i("Total "),t("span",ta,"("+n(a(e)(a(o).total))+")",1)]),t("th",aa,[i("BPJS Kesehatan "),t("span",sa,"("+n(a(e)(a(o).bpjs_kesehatan_ttl))+")",1)]),t("th",na,[i("BPJS Jamsos "),t("span",_a,"("+n(a(e)(a(o).bpjs_jamsos_ttl))+")",1)]),t("th",ea,[i("Grand Total "),t("span",la,"("+n(a(e)(a(o).total_grand))+")",1)])]),t("tr",oa,[t("th",null,[i("Gaji "),t("span",ia,"("+n(a(e)(a(o).standby_1_gaji))+")",1)]),t("th",null,[i("Makan "),t("span",ra,"("+n(a(e)(a(o).standby_1_makan))+")",1)]),t("th",null,[i("Dinas "),t("span",pa,"("+n(a(e)(a(o).standby_1_dinas))+")",1)]),t("th",null,[i("Gaji "),t("span",ua,"("+n(a(e)(a(o).standby_2_gaji))+")",1)]),t("th",null,[i("Makan "),t("span",da,"("+n(a(e)(a(o).standby_2_makan))+")",1)]),t("th",null,[i("Dinas "),t("span",ca,"("+n(a(e)(a(o).standby_2_dinas))+")",1)]),t("th",null,[i("Gaji "),t("span",ma,"("+n(a(e)(a(o).bonus_trip_gaji))+")",1)]),t("th",null,[i("Dinas "),t("span",ha,"("+n(a(e)(a(o).bonus_trip_dinas))+")",1)]),t("th",null,[i("Potongan "),t("span",ba,"("+n(a(e)(a(o).bonus_trip_perubahaan||0))+" )",1)]),t("th",null,[i("Jmlh "),t("span",ga,"("+n(a(e)(a(o).trip_jumlah))+")",1)]),t("th",null,[i("Gaji "),t("span",ya,"("+n(a(e)(a(o).trip_umum_gaji))+")",1)]),t("th",null,[i("Makan "),t("span",ja,"("+n(a(e)(a(o).trip_umum_makan))+")",1)]),t("th",null,[i("Dinas "),t("span",fa,"("+n(a(e)(a(o).trip_umum_dinas))+")",1)]),t("th",null,[i("Jmlh "),t("span",ka,"("+n(a(e)(a(o).trip_lain_jlh))+")",1)]),t("th",null,[i("Gaji "),t("span",va,"("+n(a(e)(a(o).trip_lain_gaji))+")",1)]),t("th",null,[i("Makan "),t("span",wa,"("+n(a(e)(a(o).trip_lain_makan))+")",1)]),t("th",null,[i("Dinas "),t("span",Fa,"("+n(a(e)(a(o).trip_lain_dinas))+")",1)]),t("th",null,[i("Jmlh "),t("span",Da,"("+n(a(e)(a(o).trip_tunggu_jlh))+")",1)]),t("th",null,[i("Gaji "),t("span",Ma,"("+n(a(e)(a(o).trip_tunggu_gaji))+")",1)]),t("th",null,[i("Dinas "),t("span",Pa,"("+n(a(e)(a(o).trip_tunggu_dinas))+")",1)])])]),t("tbody",Ca,[(u(!0),d(V,null,Q(a(T),(l,b)=>(u(),d(V,{key:b},[l.p_status!="Remove"?(u(),d("tr",{key:0,"data-index":b},[t("td",null,n(b+1)+".",1),t("td",null,n(l.employee_id),1),t("td",null,n(l.employee_name),1),t("td",null,n(l.employee_role),1),t("td",null,n(l.employee_birth_place),1),t("td",null,n(l.employee_birth_date?a(f)(l.employee_birth_date).format("DD-MM-Y"):""),1),t("td",null,n(l.employee_tmk?a(f)(l.employee_tmk).format("DD-MM-Y"):""),1),t("td",null,n(l.employee_ktp_no),1),t("td",null,n(l.employee_address),1),t("td",null,n(l.employee_status),1),t("td",null,n(l.employee_rek_no),1),t("td",null,n(l.employee_rek_name),1),t("td",null,n(l.employee_bank_name),1),t("td",null,n(a(e)(l.sb_gaji)),1),t("td",null,n(a(e)(l.sb_makan)),1),t("td",null,n(a(e)(l.sb_dinas)),1),t("td",null,n(a(e)(l.salary_bonus_nominal)),1),t("td",null,n(a(e)(l.periode_1_ttl)),1),t("td",null,n(a(e)(l.sb_gaji_2)),1),t("td",null,n(a(e)(l.sb_makan_2)),1),t("td",null,n(a(e)(l.sb_dinas_2)),1),t("td",null,n(a(e)(l.salary_bonus_nominal_2)),1),t("td",null,n(a(e)(l.kerajinan)),1),t("td",null,n(a(e)(l.bonus_trip_gaji)),1),t("td",null,n(a(e)(l.bonus_trip_dinas)),1),t("td",null,n(a(e)(l.salary_bonus_bonus_trip)),1),t("td",null,n(a(e)(l.periode_2_ttl)),1),t("td",null,n(a(e)(l.periode_ttl)),1),t("td",null,n(a(e)(l.trip_jumlah)),1),t("td",null,n(a(e)(l.uj_gaji)),1),t("td",null,n(a(e)(l.uj_makan)),1),t("td",null,n(a(e)(l.uj_dinas)),1),t("td",null,n(a(e)(l.trip_lain)),1),t("td",null,n(a(e)(l.trip_lain_gaji)),1),t("td",null,n(a(e)(l.trip_lain_makan)),1),t("td",null,n(a(e)(l.trip_lain_dinas)),1),t("td",null,n(a(e)(l.trip_tunggu)),1),t("td",null,n(a(e)(l.trip_tunggu_gaji)),1),t("td",null,n(a(e)(l.trip_tunggu_dinas)),1),t("td",null,n(a(e)(l.nominal_cut)),1),t("td",null,n(a(e)(l.total)),1),t("td",null,n(a(e)(l.employee_bpjs_kesehatan)),1),t("td",null,n(a(e)(l.employee_bpjs_jamsos)),1),t("td",null,n(a(e)(l.total_grand)),1)],8,Na)):v("",!0)],64))),128))],512)])])])):v("",!0)]),t("div",Ta,[t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:s[2]||(s[2]=l=>j.fnClose())}," Cancel "),a(J)?v("",!0):(u(),d("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:s[3]||(s[3]=W(l=>q(),["prevent"]))}," Generate "+n(a(r).id==""?"& Save":""),1))])])])],512)),[[Y,j.show]])}}};export{$a as default};
