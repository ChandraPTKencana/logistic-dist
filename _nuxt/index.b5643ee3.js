import ce from"./Header.86c6b10b.js";import de from"./Plus.8c47e3d7.js";import me from"./Edit.a4cf08c9.js";import _e from"./Eyes.97d29e74.js";import fe from"./Delete.c69f6fbe.js";import pe from"./Signature.ad488d94.js";import ve from"./Line.2ec53f8e.js";import he from"./Check.a5f31884.js";import ye from"./TypeIcon.d8c94992.js";import{_ as ge}from"./PopupMini.vue.2de75956.js";import ke from"./salary_bonus.c78cff69.js";import we from"./salary_bonus_validasi.1ae4f3fe.js";import{f as be,g as xe,r,h as De,i as V,s as Ce,j as Ae,c as d,b as m,a as e,k as a,l as w,F as Te,y as $e,w as Se,z as Me,A as v,B as L,o as i,C as Pe,D as h,t as _,d as Ue,m as Fe,v as Be,n as Ne,E as Ie}from"./entry.500a4a42.js";import{u as y}from"./useUtils.8ab9ce04.js";import{u as j}from"./useMyFetch.39de1512.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./DocJPEG.efccc660.js";import"./DocJPG.c0c5f82b.js";import"./DocPNG.fb7819c5.js";import"./DocPDF.4c6dedba.js";import"./Times.a832512a.js";import"./Exclamation.998c2f17.js";import"./HeaderPopup.vue.25b10ac1.js";import"./client-only.aea494d5.js";import"./WidthMiniList.vue.15bb216b.js";import"./WidthMiniPart.vue.3dbbb6a0.js";import"./InputPointFormat.vue.b3addfb7.js";import"./AttachmentSingle.44bba5b2.js";import"./PDFJsView.22d9055d.js";const Le={class:"w-full h-full flex flex-col"},je={class:"w-full flex grow flex-col overflow-auto h-0"},Ee={class:"w-full flex"},Oe={class:"w-full flex justify-center items-center grow h-0 p-1"},ze={key:0,class:""},He={class:"tacky"},Re=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"App 2"),e("th",null,"App 3"),e("th",null,"ID"),e("th",null,"Tanggal"),e("th",null,"Tipe"),e("th",null,"Nama Karyawan"),e("th",null,"No KTP"),e("th",null,"No SIM"),e("th",null,"Nominal"),e("th",null,"Note"),e("th",null,"File"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),Ve=["onClick"],Ye={class:"flex items-center justify-center"},Ke={class:"flex items-center justify-center"},Je={class:"flex items-center justify-center"},Ze={class:"bold"},qe={class:"grow mb-5"},Tt={__name:"index",async setup(Ge){let b,E;const{$moment:T}=Ie(),{pointFormat:Y}=y(),c={};c._TimeZoneOffset=new Date().getTimezoneOffset(),c.sort="created_at:desc";const $=be("token"),{data:K}=([b,E]=xe(async()=>Me(async()=>{let t=[];v().loading_full=!0;const{data:o,error:f,status:k}=await j("/salary_bonuses",{method:"get",headers:{Authorization:`Bearer ${$.value}`,Accept:"application/json"},params:c,retry:0});return v().loading_full=!1,k.value==="error"?(L().trigger(f),{salary_bonuses:t}):(t=o.value.data,{salary_bonuses:t})},"$tya7A7egnO")),b=await b,E(),b),n=r(K.value.salary_bonuses);r(""),r({field:"created_at",by:"desc"});const s=r(-1),u=r({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),x=r(null),J=async()=>{v().loading_full=!0,u.value.may_get_data=!1,c.page=u.value.page,c.page==1&&(n.value=[]),c.first_row&&delete c.first_row,c.page>1&&(c.first_row=JSON.stringify(n.value[0]));const{data:t,error:o,status:f}=await j("/salary_bonuses",{method:"get",headers:{Authorization:`Bearer ${$.value}`,Accept:"application/json"},params:c,retry:0});if(v().loading_full=!1,u.value.may_get_data=!0,f.value==="error"){L().trigger(o);return}u.value.page==1?(n.value=t.value.data,x.value&&(x.value.scrollTop=0)):u.value.page>1&&(n.value=[...n.value,...t.value.data]),t.value.data.length==0&&(u.value.is_last_record=!0)},Z=async()=>{if(!u.value.may_get_data)return;let t=x.value;if(t.scrollLeft!=u.value.scrollLeft){u.value.scrollLeft=t.scrollLeft;return}u.value.is_last_record||!(Math.round(t.scrollTop)+t.clientHeight>=t.scrollHeight-1)||(u.value.page++,await J())};De();const D=r(!1),S=r(0),M=r(0),q=()=>{S.value=0,D.value=!0,M.value=!1},{display:C}=V();Ce(V());const G=()=>{s.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(S.value=n.value[s.value].id,D.value=!0,M.value=!1)},A=r(!1),P=r(0),U=r(!1),Q=()=>{s.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=n.value[s.value].id,A.value=!0,U.value=!1)},W=()=>{s.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=n.value[s.value].id,A.value=!0,U.value=!0)},F=r(!1),O=r({}),g=r(!1),p=r(""),X=async()=>{g.value&&(g.value=!1)},ee=()=>{s.value==-1?C({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(p.value="",O.value={id:n.value[s.value].id},g.value=!0)};Ae(()=>p.value,t=>{t.trim().length>0?F.value=!0:F.value=!1},{immediate:!1});const te=async()=>{v().loading_full=!0;const t=new FormData;t.append("id",n.value[s.value].id),t.append("deleted_reason",p.value),t.append("_method","DELETE");const{data:o,error:f,status:k}=await j("/salary_bonus",{method:"post",headers:{Authorization:`Bearer ${$.value}`,Accept:"application/json"},body:t,retry:0});if(v().loading_full=!1,k.value==="error"){L().trigger(f);return}n.value.splice(s.value,1),s.value=-1,g.value=!1};return(t,o)=>{const f=ce,k=de,ae=me,le=_e,se=fe,oe=pe,B=ve,N=he,ne=ye,re=ge,ie=ke,ue=we;return i(),d("div",Le,[m(f,{title:"List Salary Additional"}),e("div",je,[e("div",Ee,[("useUtils"in t?t.useUtils:a(y))().checkPermission("salary_bonus.create")?(i(),d("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[0]||(o[0]=l=>q())},[m(k)])):w("",!0),("useUtils"in t?t.useUtils:a(y))().checkPermissions(["salary_bonus.modify"])&&a(s)>-1&&[void 0,0].indexOf(a(n)[a(s)].val3)>-1?(i(),d("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[1]||(o[1]=l=>G())},[m(ae)])):w("",!0),("useUtils"in t?t.useUtils:a(y))().checkPermissions(["salary_bonus.view"])&&a(s)>-1?(i(),d("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[2]||(o[2]=l=>W())},[m(le)])):w("",!0),("useUtils"in t?t.useUtils:a(y))().checkPermission("salary_bonus.remove")&&a(s)>-1?(i(),d("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[3]||(o[3]=l=>ee())},[m(se)])):w("",!0),("useUtils"in t?t.useUtils:a(y))().checkPermissions(["salary_bonus.val1","salary_bonus.val2","salary_bonus.val3"])&&a(s)>-1?(i(),d("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[4]||(o[4]=l=>Q())},[m(oe)])):w("",!0)]),e("div",Oe,[a(n).length==0?(i(),d("div",ze," Maaf Tidak Ada Record ")):(i(),d("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:x,onScroll:Z},[e("table",He,[Re,e("tbody",null,[(i(!0),d(Te,null,$e(a(n),(l,I)=>{var z,H,R;return i(),d("tr",{key:I,onClick:Qe=>s.value=I,class:Pe(a(s)==I?"active":"")},[e("td",null,[e("div",Ye,[l.val1?(i(),h(N,{key:1})):(i(),h(B,{key:0}))])]),e("td",null,[e("div",Ke,[l.val2?(i(),h(N,{key:1})):(i(),h(B,{key:0}))])]),e("td",null,[e("div",Je,[l.val3?(i(),h(N,{key:1})):(i(),h(B,{key:0}))])]),e("td",Ze,_(l.id),1),e("td",null,_(l.tanggal?a(T)(l.tanggal).format("DD-MM-Y"):""),1),e("td",null,_(l.type),1),e("td",null,_((z=l.employee)==null?void 0:z.name),1),e("td",null,_((H=l.employee)==null?void 0:H.ktp_no),1),e("td",null,_((R=l.employee)==null?void 0:R.sim_no),1),e("td",null,_(a(Y)(l.nominal||0)),1),e("td",null,_(l.note),1),e("td",null,[m(ne,{value:l.attachment_1_type},null,8,["value"])]),e("td",null,_(l.created_at?a(T)(l.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,_(l.updated_at?a(T)(l.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,Ve)}),128))])])],544))])]),m(re,{type:"delete",show:a(g),data:a(O),fnClose:X,fnConfirm:te,enabledOk:a(F)},{footer:Se(()=>[Ue(" Masukkan Alasan Penghapusan: "),e("div",qe,[Fe(e("textarea",{"onUpdate:modelValue":o[5]||(o[5]=l=>Ne(p)?p.value=l:null)},null,512),[[Be,a(p)]])])]),_:1},8,["show","data","enabledOk"]),m(ie,{show:a(D),fnClose:()=>{D.value=!1},id:a(S),p_data:a(n),is_copy:a(M)},null,8,["show","fnClose","id","p_data","is_copy"]),m(ue,{show:a(A),fnClose:()=>{A.value=!1},id:a(P),p_data:a(n),is_view:a(U)},null,8,["show","fnClose","id","p_data","is_view"])])}}};export{Tt as default};
