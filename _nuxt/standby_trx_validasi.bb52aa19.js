import{_ as le}from"./HeaderPopup.vue.efc68b23.js";import{_ as se}from"./WidthMiniPart.vue.3b76fcc0.js";import oe from"./AttachmentSingleV1.c706ed52.js";import ie from"./Times.1c210fa8.js";import ne from"./Check.c189fe37.js";import re from"./CaretTop.490ab939.js";import _e from"./CaretDown.333e9166.js";import{r as h,g as de,R as ve,i as W,f as ce,k as ue,L as pe,o as r,c as v,a as t,b as S,t as o,l as a,F as Q,E as me,G as X,z as H,n as u,D as U,d as Z,H as fe,x as Y,y as O,p as we,e as xe}from"./entry.36c38a87.js";import{u as N}from"./useUtils.a0510d7f.js";import{u as z}from"./useMyFetch.933fc75d.js";import{_ as be}from"./_plugin-vue_export-helper.c27b6911.js";const _=p=>(we("data-v-6bcfc152"),p=p(),xe(),p),he={class:"box-fixed"},ye={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},ke={class:"w-full flex flex-col items-center grow overflow-auto"},ge={class:"w-full flex flex-row flex-wrap"},De={class:"w-full sm:w-9/12 flex px-2 py-3"},Se={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},Ye=_(()=>t("div",{class:"absolute bg-white -top-3"}," Standby ",-1)),Ce={class:"w-6/12 sm:w-2/12 flex flex-col flex-wrap p-1"},Ne=_(()=>t("label",{for:""},"ID",-1)),Ie={class:"card-border"},Pe={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Ae=_(()=>t("label",{for:""},"Name",-1)),Me={class:"card-border"},$e={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Te=_(()=>t("label",{for:""},"Type",-1)),He={class:"card-border"},Ue={class:"w-6/12 sm:w-2/12 flex flex-col flex-wrap p-1"},Le=_(()=>t("label",{for:""},"Amount",-1)),Ve={class:"card-border"},Fe={class:"w-full sm:w-3/12 flex px-2 py-3"},Be={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative items-end"},Re=_(()=>t("div",{class:"absolute bg-white -top-3"}," Peralihan ",-1)),je={class:"w-6/12 flex flex-col flex-wrap p-1"},Ee={class:"card-border"},Oe={class:"w-6/12 flex flex-col flex-wrap p-1"},ze={class:"card-border"},qe={class:"w-full flex flex-wrap"},Ge={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Je=_(()=>t("label",{for:""},"Supir",-1)),Ke={class:"card-border"},We={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Qe=_(()=>t("label",{for:""},"Kernet",-1)),Xe={class:"card-border"},Ze={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},et=_(()=>t("label",{for:""},"No Pol",-1)),tt={class:"card-border"},at={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},lt=_(()=>t("label",{for:""},"Tujuan",-1)),st={class:"card-border"},ot={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},it=_(()=>t("label",{for:""},"Note For Remarks",-1)),nt={class:"card-border"},rt={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},_t=_(()=>t("label",{for:""},"Trx Trp ID#",-1)),dt={class:"card-border"},vt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},ct={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},ut=_(()=>t("div",{class:"absolute bg-white -top-3"}," Cost Center ",-1)),pt={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},mt=_(()=>t("label",{for:""}," Code",-1)),ft={class:"card-border"},wt={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},xt=_(()=>t("label",{for:""},"Desc",-1)),bt={class:"card-border disabled"},ht={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},yt={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},kt=_(()=>t("div",{class:"absolute bg-white -top-3"}," PVR ",-1)),gt={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},Dt=_(()=>t("label",{for:""},"No",-1)),St={class:"card-border disabled"},Yt={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Ct=_(()=>t("label",{for:""},"Total",-1)),Nt={class:"card-border disabled"},It={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},Pt={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},At=_(()=>t("div",{class:"absolute bg-white -top-3"}," PV ",-1)),Mt={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},$t=_(()=>t("label",{for:""},"No",-1)),Tt={class:"card-border disabled"},Ht={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Ut=_(()=>t("label",{for:""},"Total",-1)),Lt={class:"card-border disabled"},Vt={class:"w-full flex grow p-1 overflow-auto 2xl:overflow-hidden justify-between flex-wrap"},Ft={class:"w-full",role:"sticky"},Bt={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},Rt={class:"sticky -top-1 !z-[2]"},jt=["colspan"],Et=_(()=>t("tr",{class:"sticky top-7 !z-[2]"},[t("th",{class:"!min-w-[50px] !w-[50px] !max-w-[50px]"},"No"),t("th",{class:"!min-w-[90px] !w-[90px] !max-w-[90px]"},"Tanggal"),t("th",{class:"!min-w-[55px] !w-[55px] !max-w-[55px]"},"Waktu"),t("th",{class:"!min-w-[200px] !w-[200px] !max-w-[200px]"},"Foto"),t("th",{class:"!min-w-[200px] !w-[200px] !max-w-[200px]"},"Note"),t("th",{class:"!min-w-[70px] !w-[70px] !max-w-[70px]"},"Dibayar")],-1)),Ot={ref:"to_move"},zt=["data-index"],qt={class:"cell"},Gt={class:"w-full h-auto flex items-center justify-center relative"},Jt={class:"cell"},Kt={class:"w-full h-auto flex items-center justify-center relative"},Wt={class:"cell"},Qt={style:{width:"60vw"},class:"h-auto flex items-center justify-center"},Xt={class:"cell"},Zt={class:"h-auto flex items-center justify-center"},ea={class:"w-full h-auto flex items-center justify-center"},ta={key:0,class:"text-3xl"},aa=["onClick"],la={class:"w-full flex items-center justify-end"},sa={class:"w-full flex flex-wrap p-3 items-center"},oa=_(()=>t("div",null," Di Validasi oleh : ",-1)),ia={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},na={key:0},ra={key:1},_a={key:2},da={key:3},va={key:4},ca={key:5},ua={key:0,class:"text-xs font-bold"},pa={key:0,class:"text-xs font-bold"},ma={__name:"standby_trx_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},it_state:{type:Number,required:!1,default:-1}},emits:["setID","setIndex"],setup(p,{emit:I}){const c=p,{$moment:y}=fe(),{pointFormat:L}=N(),P={id:-1,transition_target:"",transition_type:"",standby_mst_id:"",standby_mst_:{name:"",tipe:"",amount:0},supir:"",kernet:"",no_pol:"",xto:"",note_for_remarks:"",trx_trp_id:"",cost_center_code:"",cost_center_desc:"",pvr_id:"",pvr_no:"",pvr_total:0,pvr_had_detail:0,pv_id:"",pv_no:"",pv_total:0,pv_datetime:"",rv_id:"",rv_no:"",rv_total:0,rv_had_detail:"",details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:"",val3:0,val3_by:{username:""},val3_at:"",val4:0,val4_by:{username:""},val4_at:"",val5:0,val5_by:{username:""},val5_at:""},e=h({...P}),V=de("token"),A=h({}),ee=h(null),te=h(null),k=h([]),q={_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:-1,name:"",title:""};let F=s=>{s.key=="ArrowUp"&&J(),s.key=="ArrowDown"&&G()};ve(()=>{document.removeEventListener("keydown",F)});const x=h(JSON.parse(JSON.stringify(q))),b=h(JSON.parse(JSON.stringify(q))),f=h(""),B=async s=>{f.value="PROSES...",Y().loading_full=!0,A.value={};const i=new FormData;let m=[...k.value];s=="paid"?m=m.map((w,$)=>(w.be_paid=1,w)):s=="nopaid"&&(m=m.map((w,$)=>(w.be_paid=0,w))),i.append("details",JSON.stringify(m));let l="post",D=c.id;D==0||(i.append("id",D),i.append("_method","PUT"));const{data:n,error:g,status:C}=await z("/standby_trx_validasi",{method:l,headers:{Authorization:`Bearer ${V.value}`,Accept:"application/json"},body:i,retry:0});if(Y().loading_full=!1,C.value==="error"){f.value="GAGAL",O().trigger(g,A);return}e.value.val=n.value.val,e.value.val_user=n.value.val_user,e.value.val_by=n.value.val_by,e.value.val_at=n.value.val_at,e.value.val1=n.value.val1,e.value.val1_user=n.value.val1_user,e.value.val1_by=n.value.val1_by,e.value.val1_at=n.value.val1_at,e.value.val2=n.value.val2,e.value.val2_user=n.value.val2_user,e.value.val2_by=n.value.val2_by,e.value.val2_at=n.value.val2_at,e.value.val3=n.value.val3,e.value.val3_user=n.value.val3_user,e.value.val3_by=n.value.val3_by,e.value.val3_at=n.value.val3_at,e.value.val4=n.value.val4,e.value.val4_user=n.value.val4_user,e.value.val4_by=n.value.val4_by,e.value.val4_at=n.value.val4_at,e.value.val5=n.value.val5,e.value.val5_user=n.value.val5_user,e.value.val5_by=n.value.val5_by,e.value.val5_at=n.value.val5_at;let M=c.p_data.map(w=>w.id).indexOf(c.id);M>-1&&c.p_data.splice(M,1,{...e.value}),f.value="BERHASIL"},ae=async()=>{f.value="PROSES...",Y().loading_full=!0,A.value={};const s=new FormData;let i="post",m=c.id;m==0||(s.append("id",m),s.append("_method","PUT"));const{data:l,error:D,status:n}=await z("/standby_trx_unvalidasi",{method:i,headers:{Authorization:`Bearer ${V.value}`,Accept:"application/json"},body:s,retry:0});if(Y().loading_full=!1,n.value==="error"){f.value="GAGAL",O().trigger(D,A);return}e.value.val=l.value.val,e.value.val_user=l.value.val_user,e.value.val_by=l.value.val_by,e.value.val_at=l.value.val_at,e.value.val1=l.value.val1,e.value.val1_user=l.value.val1_user,e.value.val1_by=l.value.val1_by,e.value.val1_at=l.value.val1_at,e.value.val2=l.value.val2,e.value.val2_user=l.value.val2_user,e.value.val2_by=l.value.val2_by,e.value.val2_at=l.value.val2_at,e.value.val3=l.value.val3,e.value.val3_user=l.value.val3_user,e.value.val3_by=l.value.val3_by,e.value.val3_at=l.value.val3_at,e.value.val4=l.value.val4,e.value.val4_user=l.value.val4_user,e.value.val4_by=l.value.val4_by,e.value.val4_at=l.value.val4_at,e.value.val5=l.value.val5,e.value.val5_user=l.value.val5_user,e.value.val5_by=l.value.val5_by,e.value.val5_at=l.value.val5_at;let g=c.p_data.map(C=>C.id).indexOf(c.id);g>-1&&c.p_data.splice(g,1,{...e.value}),f.value="BERHASIL"},R=async()=>{f.value="",Y().loading_full=!0;const{data:s,error:i,status:m}=await z("/standby_trx",{method:"get",headers:{Authorization:`Bearer ${V.value}`,Accept:"application/json"},params:{id:c.id},retry:0});if(Y().loading_full=!1,m.value==="error"){O().trigger(i);return}let l=s.value.data;e.value=l,x.value._.id.val=l.supir_id,x.value._.name.val=l.supir,x.value._.rek_no.val=l.supir_rek_no,x.value._.rek_name.val=l.supir_rek_name,x.value.id=l.supir_id,x.value.name=l.supir,x.value.rek_no=(l.supir_rek_no||"")+" "+(l.supir_rek_name||""),b.value._.id.val=l.kernet_id,b.value._.name.val=l.kernet,b.value._.rek_no.val=l.kernet_rek_no,b.value._.rek_name.val=l.kernet_rek_name,b.value.id=l.kernet_id,b.value.name=l.kernet,b.value.rek_no=(l.kernet_rek_no||"")+" "+(l.kernet_rek_name||""),k.value=s.value.data.details};W(()=>{let s=0;return k.value.forEach(i=>{i.p_status!="Remove"&&(s+=i.amount)}),s});const j=W(()=>e.value.val5==1);ce(()=>c.show,(s,i)=>{s==!0?(document.addEventListener("keydown",F),e.value={...P},k.value=[],R()):document.removeEventListener("keydown",F)},{immediate:!0});const G=()=>{let s=c.p_data.map(i=>i.id).indexOf(c.id);s!=c.p_data.length-1&&(s++,I("setID",c.p_data[s].id),I("setIndex",s),setTimeout(()=>{e.value={...P},k.value=[],R()},100))},J=()=>{let s=c.p_data.map(i=>i.id).indexOf(c.id);s!=0&&(s--,I("setID",c.p_data[s].id),I("setIndex",s),setTimeout(()=>{e.value={...P},k.value=[],R()},100))};return(s,i)=>{var w,$,K;const m=le,l=se,D=oe,n=ie,g=ne,C=re,M=_e;return ue((r(),v("section",he,[t("div",null,[S(m,{title:"Form Transaction Standby Validation",fn:p.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",ye,[t("div",ke,[t("div",ge,[t("div",De,[t("div",Se,[Ye,t("div",Ce,[Ne,t("div",Ie,o(a(e).standby_mst_id),1)]),t("div",Pe,[Ae,t("div",Me,o((w=a(e).standby_mst_)==null?void 0:w.name),1)]),t("div",$e,[Te,t("div",He,o(($=a(e).standby_mst_)==null?void 0:$.tipe),1)]),t("div",Ue,[Le,t("div",Ve,o(a(L)((K=a(e).standby_mst_)==null?void 0:K.amount)),1)])])]),t("div",Fe,[t("div",Be,[Re,t("div",je,[t("div",Ee,o(a(e).transition_type),1)]),t("div",Oe,[t("div",ze,o(a(e).transition_target),1)])])]),t("div",qe,[t("div",Ge,[Je,t("div",Ke,[S(l,{selected:a(x)},null,8,["selected"])])]),t("div",We,[Qe,t("div",Xe,[S(l,{selected:a(b)},null,8,["selected"])])]),t("div",Ze,[et,t("div",tt,o(a(e).no_pol),1)]),t("div",at,[lt,t("div",st,o(a(e).xto),1)]),t("div",ot,[it,t("div",nt,o(a(e).note_for_remarks),1)]),t("div",rt,[_t,t("div",dt,o(a(e).trx_trp_id),1)])]),t("div",vt,[t("div",ct,[ut,t("div",pt,[mt,t("div",ft,o(a(e).cost_center_code),1)]),t("div",wt,[xt,t("div",bt,o(a(e).cost_center_desc),1)])])]),t("div",ht,[t("div",yt,[kt,t("div",gt,[Dt,t("div",St,o(a(e).pvr_no),1)]),t("div",Yt,[Ct,t("div",Nt,o(a(L)(a(e).pvr_total||0)),1)])])]),t("div",It,[t("div",Pt,[At,t("div",Mt,[$t,t("div",Tt,o(a(e).pv_no),1)]),t("div",Ht,[Ut,t("div",Lt,o(a(L)(a(e).pv_total)),1)])])]),t("div",Vt,[t("div",Ft,[t("table",Bt,[t("thead",null,[t("tr",Rt,[t("td",{colspan:a(j)?6:7,class:"!bg-slate-800 text-white font-bold"}," Detail Transaction ",8,jt)]),Et]),t("tbody",Ot,[(r(!0),v(Q,null,me(a(k),(d,E)=>(r(),v(Q,{key:E},[d.p_status!="Remove"?(r(),v("tr",{key:0,"data-index":E},[t("td",null,o(E+1)+".",1),t("td",qt,[t("div",Gt,o(a(y)(d.tanggal).format("DD-MM-YYYY")),1)]),t("td",Jt,[t("div",Kt,o(d.waktu.substring(0,5)),1)]),t("td",Wt,[t("div",Qt,[S(D,{show:p.show,link:d.attachment_1_preview,onSetFile:T=>d.attachment_1=T,onSetPreview:T=>d.attachment_1_preview=T},null,8,["show","link","onSetFile","onSetPreview"])])]),t("td",Xt,[t("div",Zt,o(d.note),1)]),t("td",{class:X(["cell",!("useUtils"in s?s.useUtils:a(N))().checkPermissions(["standby_trx.detail.decide_paid"])||a(j)?"unselectable":""])},[t("div",ea,[!("useUtils"in s?s.useUtils:a(N))().checkPermissions(["standby_trx.detail.decide_paid"])||a(j)?(r(),v("div",ta,[d.be_paid==0?(r(),H(n,{key:0,class:"text-red-800"})):(r(),H(g,{key:1,class:"text-green-800"}))])):(r(),v("button",{key:1,type:"button",onClick:T=>d.be_paid=d.be_paid?0:1,class:X(["text-white w-auto rounded text-xl",d.be_paid?"bg-green-600":"bg-red-600"])},[d.be_paid==0?(r(),H(n,{key:0})):(r(),H(g,{key:1}))],10,aa))])],2)],8,zt)):u("",!0)],64))),128))],512)])])])])]),t("div",la,[t("div",sa,[oa,a(e).val||a(e).val1||a(e).val2||a(e).val3||a(e).val4||a(e).val5?(r(),v("div",ia,[a(e).val?(r(),v("div",na," Kasir : "+o(a(e).val_by.username)+" ( "+o(a(e).val_at?a(y)(a(e).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):u("",!0),a(e).val1?(r(),v("div",ra," Mandor : "+o(a(e).val1_by.username)+" ( "+o(a(e).val1_at?a(y)(a(e).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):u("",!0),a(e).val2?(r(),v("div",_a," Staff Logistik : "+o(a(e).val2_by.username)+" ( "+o(a(e).val2_at?a(y)(a(e).val2_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):u("",!0),a(e).val3?(r(),v("div",da," Admin Logistik : "+o(a(e).val3_by.username)+" ( "+o(a(e).val3_at?a(y)(a(e).val3_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):u("",!0),a(e).val4?(r(),v("div",va," SPV Logistik : "+o(a(e).val4_by.username)+" ( "+o(a(e).val4_at?a(y)(a(e).val4_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):u("",!0),a(e).val5?(r(),v("div",ca," MGR Logistik : "+o(a(e).val5_by.username)+" ( "+o(a(e).val5_at?a(y)(a(e).val5_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):u("",!0)])):u("",!0)]),t("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:i[0]||(i[0]=d=>J())},[S(C,{class:"black"})]),t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:i[1]||(i[1]=d=>p.fnClose())}," Cancel "),p.it_state==1&&("useUtils"in s?s.useUtils:a(N))().checkPermissions(["standby_trx.detail.decide_paid"])&&a(e).val5=="0"?(r(),v("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-green-600 text-white text-xs rounded-sm",onClick:i[2]||(i[2]=U(d=>B("paid"),["prevent"]))}," Paid ")):u("",!0),p.it_state==1&&("useUtils"in s?s.useUtils:a(N))().checkPermissions(["standby_trx.detail.decide_paid"])&&a(e).val5=="0"?(r(),v("button",{key:1,type:"submit",name:"button",class:"w-36 m-1 bg-red-600 text-white text-xs rounded-sm",onClick:i[3]||(i[3]=U(d=>B("nopaid"),["prevent"]))}," NoPaid ")):u("",!0),p.it_state==1?(r(),v("button",{key:2,ref_key:"it_val",ref:ee,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:i[4]||(i[4]=U(d=>B(),["prevent"]))},[Z(" Validasi "),a(f)!=""?(r(),v("div",ua,o(a(f)),1)):u("",!0)],512)):u("",!0),p.it_state==0?(r(),v("button",{key:3,ref_key:"it_unval",ref:te,type:"submit",name:"button",class:"w-36 m-1 bg-yellow-600 text-white rounded-sm",onClick:i[5]||(i[5]=U(d=>ae(),["prevent"]))},[Z(" Unvalidasi "),a(f)!=""?(r(),v("div",pa,o(a(f)),1)):u("",!0)],512)):u("",!0),t("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:i[6]||(i[6]=d=>G())},[S(M,{class:"black"})])])])])],512)),[[pe,p.show]])}}},Ca=be(ma,[["__scopeId","data-v-6bcfc152"]]);export{Ca as default};
