import Ge from"./Header.e4a1a891.js";import Qe from"./Copy.5174b2f1.js";import Ze from"./Plus.5671d5d2.js";import We from"./Edit.8751ac8d.js";import Xe from"./Eyes.7918e679.js";import et from"./Delete.4fb71299.js";import tt from"./Void.4717070d.js";import at from"./Signature.f9ad2533.js";import lt from"./PrinterEye.f36d1bb6.js";import ot from"./Line.4ccac0fe.js";import nt from"./Check.8c08b749.js";import st from"./TableView.78d250ac.js";import{_ as rt}from"./PopupMini.vue.108b20ce.js";import it from"./extra_money.5c406572.js";import ut from"./extra_money_validasi.a45c620c.js";import{r,j as G,f as dt,g as _t,G as x,i as _e,s as vt,A as d,c as b,b as _,a as c,m as Q,q as mt,k as o,n as Z,l as k,w as h,z as pt,B as C,o as m,D as Y,d as g,t as W,v as ve,H as ct,E as ft}from"./entry.4e0470ce.js";import{u as p}from"./useUtils.0aec33fe.js";import{u as P}from"./useMyFetch.27e207cb.js";import{u as yt}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.153a2eb2.js";import"./Adjust.b48315ca.js";import"./TableHeaderEye.d8326c95.js";import"./Times.d6c51406.js";import"./ClearAll.518af690.js";import"./client-only.0c88ab56.js";import"./ClearEach.f7cbb750.js";import"./CaretLeftDoubleBold.befcce69.js";import"./CaretLeftBold.d24e26af.js";import"./CaretRightBold.3e09802c.js";import"./CaretRightDoubleBold.d7cc5147.js";import"./Exclamation.8cc0e688.js";import"./HeaderPopup.vue.7d6675e4.js";import"./WidthMiniList.vue.7770a4a2.js";import"./WidthMiniPart.vue.3e92c63e.js";import"./InputPointFormat.vue.c518a3ca.js";const bt={class:"w-full h-full flex flex-col"},xt={class:"w-full flex grow flex-col overflow-auto h-0"},kt={class:"w-full flex justify-between flex-wrap"},ht={class:"grow flex"},gt={class:"m-1"},wt=ct('<option value="available">Available</option><option value="unapprove">Unapprove</option><option value="deleted">Trash</option><option value="all">All</option><option value="req_deleted">Req Delete</option>',5),Dt=[wt],qt={class:"grow mb-5"},At=c("b",null,"tidak dapat dibatalkan lagi",-1),Ot={class:"grow mb-5"},Ct=c("b",null,"tidak dapat dibatalkan lagi",-1),va={__name:"index",async setup(Pt){let B,X;const{$moment:ee}=ft(),{pointFormat:me}=p(),E=t=>t.deleted==1?"!bg-red-400":t.pvr_id>0&&t.req_deleted==1?"!bg-yellow-300":t.pv_id>0?"!bg-blue-300":"",H=t=>(t.map(e=>{e.class_h=E(e)}),t),f=r("available");G(()=>f.value,t=>{re.value.map(e=>{let v=["deleted_by_username","deleted_at","deleted_reason","req_deleted_by_username","req_deleted_at","req_deleted_reason"].indexOf(e.key)>-1;return["all","deleted","req_deleted"].indexOf(t)>-1?v&&(e.tbl_show=1):v&&(e.tbl_show=0),e}),le()},{immediate:!1});const u={};u._TimeZoneOffset=new Date().getTimezoneOffset(),u.sort="tanggal:desc";const te=r({}),F=r({from:"",to:""}),q=dt("token"),{data:pe}=([B,X]=_t(async()=>pt(async()=>{d().loading_full=!0;let t=[];const[e,v]=await Promise.all([P("/extra_moneys",{method:"get",headers:{Authorization:`Bearer ${q.value}`,Accept:"application/json"},params:{filter_status:f},retry:0})]);return e.status.value!=="error"&&(t=H(e.data.value.data)),e.status.value==="error"?(C().trigger(e.error),{extra_moneys:t}):(d().loading_full=!1,{extra_moneys:t})},"$pjdlE6mDqg")),B=await B,X(),B),l=r(pe.value.extra_moneys||[]);r(!1);const R=r({field:"tanggal",by:"desc"}),a=r(-1),i=x(()=>l.value[a.value]),y=r({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),ce=()=>{u.like="";let t=JSON.parse(JSON.stringify(d()._tv.global_keyword));t!=""&&(u.like=`id:%${t}%,transition_target:%${t}%,transition_type:%${t}%,extra_money_name:%${t}%,extra_money_type:%${t}%,xto:%${t}%,transition_target:%${t}%`),u.sort="",R.value.field&&(u.sort=R.value.field+":"+R.value.by),u.date_from=F.value.from?ee(F.value.from).format("YYYY-MM-DD"):"",u.date_to=F.value.to?ee(F.value.to).format("YYYY-MM-DD"):"",u.filter_model=JSON.stringify(d()._tv.filter_model)},ae=async()=>{d().loading_full=!0,te.value={},y.value.may_get_data=!1,u.page=y.value.page,u.page==1&&(l.value=[]),u.first_row&&delete u.first_row,u.page>1&&(u.first_row=JSON.stringify(l.value[0])),u.filter_status=f.value;const{data:t,error:e,status:v}=await P("/extra_moneys",{method:"get",headers:{Authorization:`Bearer ${q.value}`,Accept:"application/json"},params:u,retry:0});if(d().loading_full=!1,y.value.may_get_data=!0,v.value==="error"){C().trigger(e,te);return}y.value.page==1?l.value=H(t.value.data):y.value.page>1&&(l.value=[...l.value,...H(t.value.data)]),t.value.data.length==0&&(y.value.is_last_record=!0),d()._tv.filter_box=!1},le=()=>{a.value=-1,y.value.page=1,y.value.is_last_record=!1,ce(),ae()},$=r(!1),V=r(0),N=r(0),fe=()=>{V.value=0,$.value=!0,N.value=!1},{display:w}=_e();vt(_e());const ye=()=>{a.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(V.value=l.value[a.value].id,$.value=!0,N.value=!1)},be=()=>{a.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(V.value=l.value[a.value].id,$.value=!0,N.value=!0)},I=r(!1),z=r(0),U=r(!1),xe=()=>{a.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(z.value=l.value[a.value].id,I.value=!0,U.value=!1)},ke=()=>{a.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(z.value=l.value[a.value].id,I.value=!0,U.value=!0)},L=r(!1),oe=r({}),T=r(!1),A=r(""),he=async()=>{T.value&&(T.value=!1)},ge=()=>{a.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(A.value="",oe.value={id:l.value[a.value].id,tujuan:l.value[a.value].xto},T.value=!0)};G(()=>A.value,t=>{t.trim().length>0?L.value=!0:L.value=!1},{immediate:!1});const we=async()=>{d().loading_full=!0;const t=new FormData;t.append("id",l.value[a.value].id),t.append("deleted_reason",A.value),t.append("_method","DELETE");const{data:e,error:v,status:D}=await P("/extra_money",{method:"post",headers:{Authorization:`Bearer ${q.value}`,Accept:"application/json"},body:t,retry:0});if(d().loading_full=!1,D.value==="error"){C().trigger(v);return}let s={...l.value[a.value]};s.deleted=e.value.deleted,s.deleted_user=e.value.deleted_user,s.deleted_at=e.value.deleted_at,s.deleted_by=e.value.deleted_by,s.deleted_reason=e.value.deleted_reason,s.class_h=E(s),f.value!="all"?l.value.splice(a.value,1):l.value.splice(a.value,1,{...s}),a.value=-1,T.value=!1},J=r(!1),ne=r({}),S=r(!1),O=r(""),De=async()=>{S.value&&(S.value=!1)},qe=()=>{a.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(O.value="",ne.value={id:l.value[a.value].id,tujuan:l.value[a.value].xto},S.value=!0)},se=r({}),j=r(!1),Ae=r(""),Oe=async()=>{j.value&&(j.value=!1)},Ce=()=>{var t;a.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(Ae.value="",se.value={id:l.value[a.value].id,tujuan:l.value[a.value].xto,permintaan:(t=l.value[a.value].approve_void_by)==null?void 0:t.username,alasan:l.value[a.value].approve_void_reason},j.value=!0)},Pe=async()=>{d().loading_full=!0;const t=new FormData;t.append("id",l.value[a.value].id),t.append("_method","DELETE");const{data:e,error:v,status:D}=await P("/extra_money_approve_void",{method:"post",headers:{Authorization:`Bearer ${q.value}`,Accept:"application/json"},body:t,retry:0});if(d().loading_full=!1,D.value==="error"){C().trigger(v);return}let s={...l.value[a.value]};s.deleted=e.value.deleted,s.deleted_user=e.value.deleted_user,s.deleted_at=e.value.deleted_at,s.deleted_by=e.value.deleted_by,s.deleted_reason=e.value.deleted_reason,s.class_h=E(s),f.value!="all"?l.value.splice(a.value,1):l.value.splice(a.value,1,{...s}),a.value=-1,j.value=!1};G(()=>O.value,t=>{t.trim().length>0?J.value=!0:J.value=!1},{immediate:!1});const $e=async()=>{d().loading_full=!0;const t=new FormData;t.append("id",l.value[a.value].id),t.append("req_deleted_reason",O.value),t.append("_method","DELETE");const{data:e,error:v,status:D}=await P("/extra_money_req_delete",{method:"post",headers:{Authorization:`Bearer ${q.value}`,Accept:"application/json"},body:t,retry:0});if(d().loading_full=!1,D.value==="error"){C().trigger(v);return}let s={...l.value[a.value]};s.req_deleted=e.value.req_deleted,s.req_deleted_user=e.value.req_deleted_user,s.req_deleted_by=e.value.req_deleted_by,s.req_deleted_at=e.value.req_deleted_at,s.req_deleted_reason=e.value.req_deleted_reason,s.class_h=E(s),f.value!="all"?l.value.splice(a.value,1):l.value.splice(a.value,1,{...s}),a.value=-1,S.value=!1},{printHtml:Te}=yt(),Se=async()=>{if(a.value==-1){w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"});return}d().loading_full=!0;const{data:t,error:e,status:v}=await P("/extra_money_preview_file",{method:"get",headers:{Authorization:`Bearer ${q.value}`,Accept:"application/json"},params:{id:l.value[a.value].id},retry:0});if(d().loading_full=!1,v.value==="error"){C().trigger(e);return}Te(t.value.html,318)},re=r([{key:"no",label:"No",isai:!0},{key:"val1",label:"App 2",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val2",label:"App 3",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"xto",label:"Tujuan",freeze:1,filter_on:1,type:"string"},{key:"jenis",label:"Jenis",filter_on:1,type:"select",select_item:["TBS","TBSK","CPO","PK"]},{key:"transition_target",label:"Pengalihan",filter_on:1,type:"select",select_item:d().list_pabrik},{key:"transition_type",label:"Tipe Pengalihan",type:"select",select_item:[{k:"From",v:"Dari"},{k:"To",v:"Ke"}]},{key:"ac_account",label:"Account",childs:[{key:"ac_account_id",label:"Account ID",filter_on:1,type:"string"},{key:"ac_account_code",label:"Account Code",filter_on:1,type:"string"},{key:"ac_account_name",label:"Account Name",filter_on:1,type:"string"}]},{key:"description",label:"Deskripsi",filter_on:1,type:"string"},{key:"qty",label:"Qty",class:" justify-end",type:"number"},{key:"nominal",label:"Nominal",class:" justify-end",type:"number"},{key:"qn_total",label:"Total",class:" justify-end",type:"number"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:0},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:0},{key:"deleted_reason",label:"Deleted Reason",tbl_show:0,type:"string",filter_on:1},{key:"req_deleted_by_username",label:"Req Deleted By",tbl_show:0},{key:"req_deleted_at",label:"Req Delete At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:0},{key:"req_deleted_reason",label:"Req Delete Reason",tbl_show:0,type:"string",filter_on:1}]),je=x(()=>a.value>-1&&[void 0,0].indexOf(i.value.deleted)>-1&&[void 0,0].indexOf(i.value.req_deleted)>-1&&p().checkPermission("extra_money.create")),Me=x(()=>["available","all"].indexOf(f.value)>-1&&p().checkPermission("extra_money.create")),Be=x(()=>a.value>-1&&[void 0,0].indexOf(i.value.deleted)>-1&&[void 0,0].indexOf(i.value.req_deleted)>-1&&[void 0,0].indexOf(i.value.val)>-1&&[void 0,""].indexOf(i.value.pvr_id)>-1&&p().checkPermission("extra_money.modify")),Ee=x(()=>a.value>-1&&[void 0,0].indexOf(i.value.deleted)>-1&&[void 0,0].indexOf(i.value.req_deleted)>-1&&([void 0,""].indexOf(i.value.pvr_id)>-1&&(p().checkPermission("extra_money.val")&&[void 0,0].indexOf(i.value.val)>-1||p().checkPermission("extra_money.val1")&&[void 0,0].indexOf(i.value.val1)>-1)||i.value.pvr_id>-1&&p().checkPermission("extra_money.val2")&&[void 0,0].indexOf(i.value.val2)>-1)),Fe=x(()=>p().checkPermission("extra_money.remove")&&a.value>-1&&[void 0,0].indexOf(i.value.deleted)>-1&&[void 0,0].indexOf(i.value.req_deleted)>-1&&[void 0,""].indexOf(i.value.pvr_id)>-1),Ve=x(()=>p().checkPermission("extra_money.request_remove")&&a.value>-1&&[void 0,0].indexOf(i.value.deleted)>-1&&[void 0,0].indexOf(i.value.req_deleted)>-1&&i.value.pvr_id!=""),Ne=x(()=>p().checkPermission("extra_money.approve_request_remove")&&a.value>-1&&i.value.deleted==0&&i.value.req_deleted==1&&i.value.val2==0),Ie=x(()=>p().checkPermission("extra_money.preview_file")&&a.value>-1&&[void 0,0].indexOf(i.value.deleted)>-1&&[void 0,0].indexOf(i.value.req_deleted)>-1&&i.value.val==1);return(t,e)=>{const v=Ge,D=Qe,s=Ze,Ye=We,He=Xe,Re=et,ie=tt,ze=at,Ue=lt,ue=ot,de=nt,Le=st,K=rt,Je=it,Ke=ut;return m(),b("div",bt,[_(v,{title:"List Transaction"}),c("div",xt,[c("div",kt,[c("div",ht,[c("div",gt,[Q(c("select",{class:"","onUpdate:modelValue":e[0]||(e[0]=n=>Z(f)?f.value=n:null)},Dt,512),[[mt,o(f)]])]),o(je)?(m(),b("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[1]||(e[1]=n=>be())},[_(D)])):k("",!0),o(Me)?(m(),b("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[2]||(e[2]=n=>fe())},[_(s)])):k("",!0),o(Be)?(m(),b("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[3]||(e[3]=n=>ye())},[_(Ye)])):k("",!0),o(a)>-1?(m(),b("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[4]||(e[4]=n=>ke())},[_(He)])):k("",!0),o(Fe)?(m(),b("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[5]||(e[5]=n=>ge())},[_(Re)])):k("",!0),o(Ve)?(m(),b("button",{key:5,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[6]||(e[6]=n=>qe())},[_(ie)])):k("",!0),o(Ne)?(m(),b("button",{key:6,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[7]||(e[7]=n=>Ce())},[_(ie)])):k("",!0),o(Ee)?(m(),b("button",{key:7,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[8]||(e[8]=n=>xe())},[_(ze)])):k("",!0),o(Ie)?(m(),b("button",{key:8,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[9]||(e[9]=n=>Se())},[_(Ue)])):k("",!0)])]),_(Le,{thead:o(re),selected:o(a),onSetSelected:e[10]||(e[10]=n=>a.value=n),tbody:o(l),fnCallData:ae,scrolling:o(y),onSetScrollingPage:e[11]||(e[11]=n=>o(y).page=n),onDoFilter:e[12]||(e[12]=n=>le())},{val1:h(({item:n})=>[n.val1?(m(),Y(de,{key:1})):(m(),Y(ue,{key:0}))]),val2:h(({item:n})=>[n.val2?(m(),Y(de,{key:1})):(m(),Y(ue,{key:0}))]),qn_total:h(({item:n})=>[g(" Rp. "+W(o(me)(parseFloat(n.total)||0)),1)]),deleted_by_username:h(({item:n})=>{var M;return[g(W((M=n.deleted_by)==null?void 0:M.username),1)]}),req_deleted_by_username:h(({item:n})=>{var M;return[g(W((M=n.req_deleted_by)==null?void 0:M.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])]),_(K,{type:"delete",show:o(T),data:o(oe),fnClose:he,fnConfirm:we,enabledOk:o(L)},{footer:h(()=>[g(" Masukkan Alasan Penghapusan: "),c("div",qt,[Q(c("textarea",{"onUpdate:modelValue":e[13]||(e[13]=n=>Z(A)?A.value=n:null)},null,512),[[ve,o(A)]])])]),_:1},8,["show","data","enabledOk"]),_(K,{type:"custome",show:o(S),data:o(ne),fnClose:De,fnConfirm:$e,enabledOk:o(J)},{words:h(()=>[g(" Data akan diproses dan "),At,g(", yakin untuk melanjutkan ? ")]),footer:h(()=>[g(" Masukkan Alasan Permintaan Penghapusan: "),c("div",Ot,[Q(c("textarea",{"onUpdate:modelValue":e[14]||(e[14]=n=>Z(O)?O.value=n:null)},null,512),[[ve,o(O)]])])]),_:1},8,["show","data","enabledOk"]),_(K,{type:"custome",show:o(j),data:o(se),fnClose:Oe,fnConfirm:Pe},{words:h(()=>[g(" Data akan diproses dan "),Ct,g(", apakah Anda menyetujui permintaan penghapusan data berikut? ")]),_:1},8,["show","data"]),_(Je,{show:o($),fnClose:()=>{$.value=!1},id:o(V),p_data:o(l),is_copy:o(N)},null,8,["show","fnClose","id","p_data","is_copy"]),_(Ke,{show:o(I),fnClose:()=>{I.value=!1},id:o(z),p_data:o(l),is_view:o(U)},null,8,["show","fnClose","id","p_data","is_view"])])}}};export{va as default};
