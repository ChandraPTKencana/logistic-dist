import Z from"./Header.76f0bae4.js";import Q from"./Copy.8319ee11.js";import W from"./Plus.95aa9d47.js";import X from"./Edit.8a97a15f.js";import Y from"./Search.ae8ae8d4.js";import ee from"./permission_group.7b265a7b.js";import{h as te,k as se,r as o,i as oe,z as U,A as ae,I as le,c as u,b as p,a as e,m as a,G as C,n as D,q as ne,B as ie,C as B,s as re,F as ue,D as ce,l as de,o as c,E as _e,t as I,x as w,y as M}from"./entry.1cedbe8d.js";import{u as $}from"./useUtils.11657bdd.js";import{u as z}from"./useMyFetch.82b8d51f.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./HeaderPopup.vue.48611918.js";import"./Times.068b4b36.js";const fe={class:"w-full h-full flex flex-col"},pe={class:"w-full flex grow flex-col overflow-auto h-0"},me={class:"w-full flex"},ve={action:"#",class:"w-full flex p-1"},he={class:"grow"},ge=e("div",{class:"font-bold"}," Keyword ",-1),ye={class:"pl-1"},ke=e("div",{class:"font-bold"}," Sort By ",-1),we=e("option",{value:""},null,-1),be=e("option",{value:"id"},"ID",-1),xe=e("option",{value:"name"},"Name",-1),Ce=e("option",{value:"tipe"},"Tipe",-1),De=[we,be,xe,Ce],$e={class:"pl-1"},Se=e("div",{class:"font-bold"}," Sort Order ",-1),Le=e("option",{value:"asc"},"Asc",-1),Re=e("option",{value:"desc"},"Desc",-1),Ae=[Le,Re],Te={class:"flex items-end pl-1"},Ue={class:"w-full flex justify-center items-center grow h-0 p-1"},Be={key:0,class:""},Ie={class:"tacky"},Me=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"ID"),e("th",null,"Name")])],-1),ze=["onClick"],Fe={class:"bold"},Xe={__name:"index",async setup(Ne){let h,S;const l={};l._TimeZoneOffset=new Date().getTimezoneOffset(),l.sort="created_at:desc";const L=te("token"),{data:F}=([h,S]=se(async()=>de(async()=>{let t=[];w().loading_full=!0;const{data:s,error:v,status:b}=await z("/permission_groups",{method:"get",headers:{Authorization:`Bearer ${L.value}`,Accept:"application/json"},params:l,retry:0});return w().loading_full=!1,b.value==="error"?(M().trigger(v),{permission_groups:t}):(t=s.value.data,{permission_groups:t})},"$RBOosuv6RL")),h=await h,S(),h),r=o(F.value.permission_groups),d=o(""),_=o({field:"created_at",by:"desc"}),f=o(-1),n=o({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),N=()=>{l.like="",d.value!=""&&(l.like=`id:%${d.value}%,name:%${d.value}%,amount:%${d.value}%`),l.sort="",_.value.field&&(l.sort=_.value.field+":"+_.value.by)},g=o(null),R=async()=>{w().loading_full=!0,n.value.may_get_data=!1,l.page=n.value.page,l.page==1&&(r.value=[]),l.first_row&&delete l.first_row,l.page>1&&(l.first_row=JSON.stringify(r.value[0]));const{data:t,error:s,status:v}=await z("/permission_groups",{method:"get",headers:{Authorization:`Bearer ${L.value}`,Accept:"application/json"},params:l,retry:0});if(w().loading_full=!1,n.value.may_get_data=!0,v.value==="error"){M().trigger(s);return}n.value.page==1?(r.value=t.value.data,g.value&&(g.value.scrollTop=0)):n.value.page>1&&(r.value=[...r.value,...t.value.data]),t.value.data.length==0&&(n.value.is_last_record=!0)},O=async()=>{if(!n.value.may_get_data)return;let t=g.value;if(t.scrollLeft!=n.value.scrollLeft){n.value.scrollLeft=t.scrollLeft;return}n.value.is_last_record||!(Math.round(t.scrollTop)+t.clientHeight>=t.scrollHeight-1)||(n.value.page++,await R())},V=()=>{n.value.page=1,n.value.is_last_record=!1,N(),R()};oe();const m=o(!1),y=o(0),k=o(0),P=()=>{y.value=0,m.value=!0,k.value=!1},{display:A}=U();ae(U());const j=()=>{f.value==-1?A({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(y.value=r.value[f.value].id,m.value=!0,k.value=!1)},E=()=>{f.value==-1?A({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(y.value=r.value[f.value].id,m.value=!0,k.value=!0)};o(!1),o(0),o(!1);const T=o(!1);o({}),o(!1);const G=o("");return le(()=>G.value,t=>{t.trim().length>0?T.value=!0:T.value=!1},{immediate:!1}),(t,s)=>{const v=Z,b=Q,H=W,K=X,q=Y,J=ee;return c(),u("div",fe,[p(v,{title:"List Permission Group"}),e("div",pe,[e("div",me,[("useUtils"in t?t.useUtils:a($))().checkRole(["Logistic"])?C("",!0):(c(),u("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[0]||(s[0]=i=>E())},[p(b)])),("useUtils"in t?t.useUtils:a($))().checkRole(["Logistic"])?C("",!0):(c(),u("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[1]||(s[1]=i=>P())},[p(H)])),("useUtils"in t?t.useUtils:a($))().checkRole(["Logistic"])?C("",!0):(c(),u("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[2]||(s[2]=i=>j())},[p(K)]))]),e("form",ve,[e("div",he,[ge,D(e("input",{class:"",type:"text","onUpdate:modelValue":s[3]||(s[3]=i=>ie(d)?d.value=i:null),name:"search",placeholder:"Keyword"},null,512),[[ne,a(d)]])]),e("div",ye,[ke,D(e("select",{class:"","onUpdate:modelValue":s[4]||(s[4]=i=>a(_).field=i)},De,512),[[B,a(_).field]])]),e("div",$e,[Se,D(e("select",{class:"","onUpdate:modelValue":s[5]||(s[5]=i=>a(_).by=i)},Ae,512),[[B,a(_).by]])]),e("div",Te,[e("button",{class:"",type:"submit",name:"button",onClick:s[6]||(s[6]=re(i=>V(),["prevent"]))},[p(q,{class:"text-2xl"})])])]),e("div",Ue,[a(r).length==0?(c(),u("div",Be," Maaf Tidak Ada Record ")):(c(),u("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:g,onScroll:O},[e("table",Ie,[Me,e("tbody",null,[(c(!0),u(ue,null,ce(a(r),(i,x)=>(c(),u("tr",{key:x,onClick:Oe=>f.value=x,class:_e(a(f)==x?"active":"")},[e("td",Fe,I(i.id),1),e("td",null,I(i.name),1)],10,ze))),128))])])],544))])]),p(J,{show:a(m),fnClose:()=>{m.value=!1},id:a(y),p_data:a(r),is_copy:a(k)},null,8,["show","fnClose","id","p_data","is_copy"])])}}};export{Xe as default};
