import{_ as $}from"./HeaderPopup.vue.028c81bf.js";import{_ as M}from"./client-only.8940b8e1.js";import{_ as V}from"./InputPointFormat.vue.4b090da7.js";import{r as v,g as A,f as B,J as P,k as x,L as S,o as q,c as F,a as e,b as c,w as N,l as s,t as _,A as T,D as j,x as p,y as h}from"./entry.c8fa0da5.js";import{u as y}from"./useMyFetch.caa6cdd4.js";import"./Times.00c8a916.js";import"./_plugin-vue_export-helper.c27b6911.js";const U={class:"box-fixed"},z={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},E={class:"w-full flex flex-col items-center grow overflow-auto"},I={class:"w-full flex flex-row flex-wrap"},O={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},R=e("label",{for:""},"Tanggal",-1),H={class:"grow"},J={class:"text-red-500"},K={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},L=e("label",{for:""},"Nominal Potong",-1),Y={class:"w-full"},G={class:"text-red-500"},Q={class:"w-full flex flex-col flex-wrap p-1"},W=e("label",{for:""},"Keterangan",-1),X={class:"text-red-500"},Z={class:"w-full flex items-center justify-end"},ie={__name:"trx",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},potongan_mst_id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},emits:["updateRemainingCut"],setup(u,{emit:b}){const l=u,w={id:-1,note:"",nominal_cut:"",tanggal:new Date},t=v({...w}),g=A("token"),i=v({}),C=async()=>{p().loading_full=!0,i.value={};const o=new FormData;o.append("tanggal",$moment(t.value.tanggal).format("Y-MM-DD")),o.append("potongan_mst_id",l.potongan_mst_id),o.append("note",t.value.note),o.append("nominal_cut",t.value.nominal_cut);let a="post",r=l.id;r==0||(o.append("id",r),o.append("_method","PUT"));const{data:d,error:f,status:m}=await y("/potongan_trx",{method:a,headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},body:o,retry:0});if(p().loading_full=!1,m.value==="error"){h().trigger(f,i);return}if(t.value.updated_at=d.value.updated_at,l.id<=0)t.value.id=d.value.id,t.value.created_at=d.value.created_at,l.p_data.unshift(t.value);else{let n=l.p_data.map(D=>D.id).indexOf(l.id);n>-1&&l.p_data.splice(n,1,{...t.value})}b("updateRemainingCut",d.value.remaining_cut),l.fnClose()},k=async()=>{p().loading_full=!0;const{data:o,error:a,status:r}=await y("/potongan_trx",{method:"get",headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},params:{id:l.id},retry:0});if(p().loading_full=!1,r.value==="error"){h().trigger(a);return}t.value=o.value.data};return B(()=>l.show,(o,a)=>{o==!0&&(t.value={...w},i.value={},l.id!=0&&k())},{immediate:!0}),(o,a)=>{const r=$,d=P("vue-date-picker"),f=M,m=V;return x((q(),F("section",U,[e("div",null,[c(r,{title:"Form Potongan Trx",fn:u.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",z,[e("div",E,[e("div",I,[e("div",O,[R,e("div",H,[c(f,null,{default:N(()=>[c(d,{modelValue:s(t).tanggal,"onUpdate:modelValue":a[0]||(a[0]=n=>s(t).tanggal=n),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1})]),e("p",J,_(s(i).tanggal),1)]),e("div",K,[L,e("div",Y,[c(m,{class:"w-full h-full",type:"text",value:s(t).nominal_cut||0,onInput:a[1]||(a[1]=n=>s(t).nominal_cut=n),show:u.show,disabled:s(t).trx_trp_id},null,8,["value","show","disabled"])]),e("p",G,_(s(i).ref),1)]),e("div",Q,[W,x(e("textarea",{"onUpdate:modelValue":a[2]||(a[2]=n=>s(t).note=n),rows:"10"}," ",512),[[T,s(t).note]]),e("p",X,_(s(i).note),1)])])]),e("div",Z,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:a[3]||(a[3]=n=>u.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:a[4]||(a[4]=j(n=>C(),["prevent"]))}," Save ")])])])],512)),[[S,u.show]])}}};export{ie as default};
