import{_ as $}from"./HeaderPopup.vue.174cb466.js";import B from"./CaretTop.1d701c45.js";import T from"./CaretDown.77862758.js";import{P as E,r as y,g as N,f as V,k as L,J as P,o as c,c as u,a as e,b as Y,t as i,l as s,n as v,C as q,G as F,x as h,y as C,p as O,e as U}from"./entry.76310763.js";import"./useUtils.010c4004.js";import{u as I}from"./useMyFetch.0a78e1d7.js";import{_ as G}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.462b07df.js";const _=n=>(O("data-v-8fd12a78"),n=n(),U(),n),z={class:"box-fixed"},J={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},K={class:"w-full flex flex-col items-center grow overflow-auto"},R={class:"w-full"},Q={class:"w-full flex flex-wrap p-3 items-center text-xs"},W=_(()=>e("label",{for:""},"ID",-1)),X={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},Z=_(()=>e("label",{for:""},"U.jalan Per",-1)),ee={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},te=_(()=>e("label",{for:""},"Jenis",-1)),se={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},ae=_(()=>e("label",{for:""},"Supir",-1)),ie={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},oe={key:0},le=_(()=>e("label",{for:""},"Kernet",-1)),re={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},_e=_(()=>e("label",{for:""},"No Pol",-1)),ne={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},de=_(()=>e("label",{for:""},"Tujuan",-1)),ce={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},ue=_(()=>e("label",{for:""},"Tipe",-1)),ve={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},me={class:"w-full flex flex-wrap items-center grow overflow-auto"},fe={class:"w-full sm:w-1/2 text-center p-1"},pe={class:"border-[1px] p-1"},be={class:"font-bold"},he={class:"w-full flex justify-center items-center"},we=["src"],xe={class:"w-full sm:w-1/2 text-center p-1"},ge={class:"border-[1px] p-1"},ye={class:"border-[1px] p-1"},Ye={class:"font-bold"},ke={class:"w-full flex justify-center items-center"},De=["src"],Me={class:"w-full sm:w-1/2 text-center p-1"},He={class:"border-[1px] p-1"},Ae={class:"border-[1px] p-1"},Ce={class:"font-bold"},Ie={class:"w-full flex justify-center items-center"},je=["src"],Se={class:"w-full sm:w-1/2 text-center p-1"},$e={class:"border-[1px] p-1"},Be={class:"border-[1px] p-1"},Te={class:"font-bold"},Ee={class:"w-full flex justify-center items-center"},Ne=["src"],Ve={class:"w-full p-1"},Le=_(()=>e("label",{for:""}," Note ",-1)),Pe={class:"card-border"},qe={class:"w-full flex items-center justify-end"},Fe={class:"w-full flex flex-wrap p-3 items-center"},Oe=_(()=>e("div",null," Di Validasi oleh : ",-1)),Ue={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},Ge={key:0},ze={key:1},Je={key:2},Ke=_(()=>e("div",null," Validasi ",-1)),Re={key:0,class:"text-xs font-bold"},Qe={__name:"trx_trp_absen_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},emits:["setID","setIndex"],setup(n,{emit:b}){const l=n,{$moment:d}=F();let w=a=>{a.key=="ArrowUp"&&H(),a.key=="ArrowDown"&&M()};E(()=>{document.removeEventListener("keydown",w)});const t=y({...{id:-1,tanggal:new Date,id_uj:-1,xto:"",tipe:"",jenis:"",amount:0,img_leaves:[],img_leave:"",img_arrive:"",img_return:"",img_till:"",img_leave_file:"",img_arrive_file:"",img_return_file:"",img_till_file:"",img_leave_ts:"",img_arrive_ts:"",img_return_ts:"",img_till_ts:"",ritase_note:"",ritase_val:0,ritase_val_by:{username:""},ritase_val_at:"",ritase_val1:0,ritase_val1_by:{username:""},ritase_val1_at:"",ritase_val2:0,ritase_val2_by:{username:""},ritase_val2_at:""}}),k=N("token"),D=y(null),m=y(""),j=async()=>{m.value="PROSES...",h().loading_full=!0;const a=new FormData;let o="post",f=l.id;f==0||(a.append("id",f),a.append("_method","PUT"));const{data:r,error:g,status:p}=await I("/trx_trp/absen/validasi",{method:o,headers:{Authorization:`Bearer ${k.value}`,Accept:"application/json"},body:a,retry:0});if(h().loading_full=!1,p.value==="error"){m.value="GAGAL",C().trigger(g);return}t.value.ritase_val=r.value.ritase_val,t.value.ritase_val_by=r.value.ritase_val_by,t.value.ritase_val_at=r.value.ritase_val_at,t.value.ritase_val1=r.value.ritase_val1,t.value.ritase_val1_by=r.value.ritase_val1_by,t.value.ritase_val1_at=r.value.ritase_val1_at,t.value.ritase_val2=r.value.ritase_val2,t.value.ritase_val2_by=r.value.ritase_val2_by,t.value.ritase_val2_at=r.value.ritase_val2_at;let A=l.p_data.map(S=>S.id).indexOf(l.id);A>=-1&&l.p_data.splice(A,1,{...t.value}),m.value="BERHASIL"},x=async()=>{m.value="",h().loading_full=!0;const{data:a,error:o,status:f}=await I("/trx_trp/absen",{method:"get",headers:{Authorization:`Bearer ${k.value}`,Accept:"application/json"},params:{id:l.id},retry:0});if(h().loading_full=!1,f.value==="error"){C().trigger(o);return}t.value=a.value.data};V(()=>l.show,(a,o)=>{a==!0?(document.addEventListener("keydown",w),l.is_view==!1&&setTimeout(()=>{D.value.focus()},1),x()):document.removeEventListener("keydown",w)},{immediate:!0});const M=()=>{let a=l.p_data.map(o=>o.id).indexOf(l.id);a!=l.p_data.length-1&&(a++,b("setID",l.p_data[a].id),b("setIndex",a),setTimeout(()=>{x()},100))},H=()=>{let a=l.p_data.map(o=>o.id).indexOf(l.id);a!=0&&(a--,b("setID",l.p_data[a].id),b("setIndex",a),setTimeout(()=>{x()},100))};return(a,o)=>{const f=$,r=B,g=T;return L((c(),u("section",z,[e("div",null,[Y(f,{title:"Form Transaction Validation",fn:n.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",J,[e("div",K,[e("div",R,[e("div",Q,[e("div",null,[W,e("div",X,i(s(t).id),1)]),e("div",null,[Z,e("div",ee,i(s(t).tanggal?s(d)(s(t).tanggal).format("DD-MM-YYYY"):""),1)]),e("div",null,[te,e("div",se,i(s(t).jenis),1)]),e("div",null,[ae,e("div",ie,i(s(t).supir),1)]),s(t).kernet?(c(),u("div",oe,[le,e("div",re,i(s(t).kernet),1)])):v("",!0),e("div",null,[_e,e("div",ne,i(s(t).no_pol),1)]),e("div",null,[de,e("div",ce,i(s(t).xto),1)]),e("div",null,[ue,e("div",ve,i(s(t).tipe),1)])])]),e("div",me,[e("div",fe,[e("div",pe,[e("label",be,"Berangkat : "+i(s(t).img_leave_ts?s(d)(s(t).img_leave_ts).format("DD-MM-YYYY HH:mm"):""),1),e("div",he,[e("img",{src:s(t).img_leave,alt:""},null,8,we)])])]),e("div",xe,[e("div",ge,[e("div",ye,[e("label",Ye,"Tiba : "+i(s(t).img_arrive_ts?s(d)(s(t).img_arrive_ts).format("DD-MM-YYYY HH:mm"):""),1),e("div",ke,[e("img",{src:s(t).img_arrive,alt:""},null,8,De)])])])]),e("div",Me,[e("div",He,[e("div",Ae,[e("label",Ce,"Kembali : "+i(s(t).img_return_ts?s(d)(s(t).img_return_ts).format("DD-MM-YYYY HH:mm"):""),1),e("div",Ie,[e("img",{src:s(t).img_return,alt:""},null,8,je)])])])]),e("div",Se,[e("div",$e,[e("div",Be,[e("label",Te,"Sampai : "+i(s(t).img_till_ts?s(d)(s(t).img_till_ts).format("DD-MM-YYYY HH:mm"):""),1),e("div",Ee,[e("img",{src:s(t).img_till,alt:""},null,8,Ne)])])])]),e("div",Ve,[Le,e("div",Pe,i(s(t).ritase_note),1)])])]),e("div",qe,[e("div",Fe,[Oe,s(t).ritase_val||s(t).ritase_val1||s(t).ritase_val2?(c(),u("div",Ue,[s(t).ritase_val?(c(),u("div",Ge," App 1 : "+i(s(t).ritase_val_by.username)+" ( "+i(s(t).ritase_val_at?s(d)(s(t).ritase_val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):v("",!0),s(t).ritase_val1?(c(),u("div",ze," App 2 : "+i(s(t).ritase_val1_by.username)+" ( "+i(s(t).ritase_val1_at?s(d)(s(t).ritase_val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):v("",!0),s(t).ritase_val2?(c(),u("div",Je," App 3 : "+i(s(t).ritase_val2_by.username)+" ( "+i(s(t).ritase_val2_at?s(d)(s(t).ritase_val2_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):v("",!0)])):v("",!0)]),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:o[0]||(o[0]=p=>H())},[Y(r,{class:"black"})]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:o[1]||(o[1]=p=>n.fnClose())}," Cancel "),n.is_view==0?(c(),u("button",{key:0,ref_key:"it_val",ref:D,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm flex flex-col items-center justify-center",onClick:o[2]||(o[2]=q(p=>j(),["prevent"]))},[Ke,s(m)!=""?(c(),u("div",Re,i(s(m)),1)):v("",!0)],512)):v("",!0),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:o[3]||(o[3]=p=>M())},[Y(g,{class:"black"})])])])])],512)),[[P,n.show]])}}},lt=G(Qe,[["__scopeId","data-v-8fd12a78"]]);export{lt as default};
