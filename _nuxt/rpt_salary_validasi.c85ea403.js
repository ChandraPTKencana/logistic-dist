import{_ as it}from"./HeaderPopup.vue.3900fd5e.js";import{r as w,g as ct,i as _,f as pt,k as tt,K as dt,o as d,c as m,a as t,b as mt,t as s,l as a,m as ht,A as vt,n as f,d as r,F as et,D as ft,C as bt,G as yt,x as k,y as at,p as wt,e as xt}from"./entry.98e7da62.js";import{u as kt}from"./useUtils.da9425db.js";import{u as st}from"./useMyFetch.279f859a.js";import{_ as jt}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.2c682f3c.js";const c=p=>(wt("data-v-0022977b"),p=p(),xt(),p),gt={class:"box-fixed"},Ft={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},Et={class:"w-full flex flex-col items-center grow overflow-auto"},Dt={class:"w-full flex flex-row flex-wrap"},Mt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},St=c(()=>t("label",{for:""},"Period End",-1)),Nt={class:"card-border"},Ct={key:0,class:"w-full sm:w-6/12 md:w-4/12 lg:w-4/12 p-1"},Pt=c(()=>t("div",{class:"font-bold"}," Filter Nama ",-1)),Tt={key:0,class:"w-full flex p-1 justify-between flex-wrap"},Bt={class:"w-full",role:"sticky"},At={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},Vt=c(()=>t("tr",{class:"sticky -top-1 !z-[2]"},[t("td",{colspan:"33",class:"!bg-slate-800 text-white font-bold"}," Detail ")],-1)),Yt={class:"sticky top-7 !z-[2]"},$t=c(()=>t("th",{rowspan:"2"},"No",-1)),qt=c(()=>t("th",{rowspan:"2"},"ID",-1)),It=c(()=>t("th",{rowspan:"2"},"Nama Pekerja",-1)),zt=c(()=>t("th",{rowspan:"2"},"Jabatan",-1)),Gt=c(()=>t("th",{rowspan:"2"},"Tmpt Lahir",-1)),Kt=c(()=>t("th",{rowspan:"2"},"Tgl Lahir",-1)),Lt=c(()=>t("th",{rowspan:"2"},"TMK",-1)),Rt=c(()=>t("th",{rowspan:"2"},"No KTP",-1)),Jt=c(()=>t("th",{rowspan:"2"},"Alamat",-1)),Ut=c(()=>t("th",{rowspan:"2"},"Status",-1)),Ht=c(()=>t("th",{rowspan:"2"},"No Rek",-1)),Ot=c(()=>t("th",{rowspan:"2"},"Nama Rek",-1)),Qt=c(()=>t("th",{rowspan:"2"},"Nama Bank",-1)),Wt={colspan:"3"},Xt={class:"text-sm"},Zt={rowspan:"2"},te={class:"text-sm"},ee={rowspan:"2"},ae={class:"text-sm"},se={colspan:"3"},oe={class:"text-sm"},le={rowspan:"2"},ne={class:"text-sm"},_e={rowspan:"2"},re={class:"text-sm"},ue={rowspan:"2"},ie={class:"text-sm"},ce={rowspan:"2"},pe={class:"text-sm"},de={colspan:"3"},me={class:"text-sm"},he={rowspan:"2"},ve={class:"text-sm"},fe={rowspan:"2"},be={class:"text-sm"},ye={rowspan:"2"},we={class:"text-sm"},xe={rowspan:"2"},ke={class:"text-sm"},je={rowspan:"2"},ge={class:"text-sm"},Fe={class:"sticky top-[60px] !z-[2]"},Ee={class:"text-sm"},De={class:"text-sm"},Me={class:"text-sm"},Se={class:"text-sm"},Ne={class:"text-sm"},Ce={class:"text-sm"},Pe={class:"text-sm"},Te={class:"text-sm"},Be={class:"text-sm"},Ae={ref:"to_move"},Ve=["data-index"],Ye={class:"w-full flex items-center justify-end"},$e={class:"w-full flex flex-wrap p-3 items-center"},qe=c(()=>t("div",null," Di Validasi oleh : ",-1)),Ie={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},ze={key:0},Ge={__name:"rpt_salary_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(p){const h=p,{$moment:x}=yt(),{pointFormat:n}=kt(),u=w({...{id:-1,name:"",tipe:"",is_transition:!1,amount:0,details:[],val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:"",val3:0,val3_by:{username:""},val3_at:""}}),j=ct("token"),g=w({}),F=w(null),i=w([]),ot=async()=>{k().loading_full=!0,g.value={};const e=new FormData;let l="post",v=h.id;v==0||(e.append("id",v),e.append("_method","PUT"));const{data:o,error:y,status:rt}=await st("/rpt_salary_validasi",{method:l,headers:{Authorization:`Bearer ${j.value}`,Accept:"application/json"},body:e,retry:0});if(k().loading_full=!1,rt.value==="error"){at().trigger(y,g);return}u.value.val1=o.value.val1,u.value.val1_user=o.value.val1_user,u.value.val1_by=o.value.val1_by,u.value.val1_at=o.value.val1_at,u.value.val2=o.value.val2,u.value.val2_user=o.value.val2_user,u.value.val2_by=o.value.val2_by,u.value.val2_at=o.value.val2_at,u.value.val3=o.value.val3,u.value.val3_user=o.value.val3_user,u.value.val3_by=o.value.val3_by,u.value.val3_at=o.value.val3_at;let Z=h.p_data.map(ut=>ut.id).indexOf(h.id);Z>=-1&&h.p_data.splice(Z,1,{...u.value}),h.fnClose()};_(()=>{let e=0;return i.value.forEach(l=>{e+=parseFloat(l.standby_nominal)}),e});const E=_(()=>{let e=0;return i.value.forEach(l=>{e+=parseFloat(l.sb_gaji)}),e}),D=_(()=>{let e=0;return i.value.forEach(l=>{e+=parseFloat(l.sb_makan)}),e}),M=_(()=>{let e=0;return i.value.forEach(l=>{e+=parseFloat(l.sb_dinas)}),e}),S=_(()=>{let e=0;return i.value.forEach(l=>{e+=parseFloat(l.sb_gaji_2)}),e}),N=_(()=>{let e=0;return i.value.forEach(l=>{e+=parseFloat(l.sb_makan_2)}),e}),C=_(()=>{let e=0;return i.value.forEach(l=>{e+=parseFloat(l.sb_dinas_2)}),e}),P=_(()=>{let e=0;return i.value.forEach(l=>{e+=parseFloat(l.uj_gaji)}),e}),T=_(()=>{let e=0;return i.value.forEach(l=>{e+=parseFloat(l.uj_makan)}),e}),B=_(()=>{let e=0;return i.value.forEach(l=>{e+=parseFloat(l.uj_dinas)}),e}),A=_(()=>{let e=0;return i.value.forEach(l=>{e+=parseFloat(l.employee_bpjs_kesehatan)}),e}),V=_(()=>{let e=0;return i.value.forEach(l=>{e+=parseFloat(l.employee_bpjs_jamsos)}),e}),Y=_(()=>{let e=0;return i.value.forEach(l=>{e+=parseFloat(l.nominal_cut)}),e}),$=_(()=>{let e=0;return i.value.forEach(l=>{e+=parseFloat(l.salary_bonus_nominal)}),e}),q=_(()=>{let e=0;return i.value.forEach(l=>{e+=parseFloat(l.salary_bonus_nominal_2)}),e}),I=_(()=>{let e=0;return i.value.forEach(l=>{e+=parseFloat(l.kerajinan)}),e}),z=_(()=>E.value+D.value+M.value||0),G=_(()=>z.value+$.value||0),K=_(()=>S.value+N.value+C.value||0),L=_(()=>K.value+q.value+I.value||0),R=_(()=>G.value+L.value||0),J=_(()=>P.value+T.value+B.value||0),U=_(()=>R.value+J.value-Y.value||0),lt=_(()=>U.value+A.value+V.value||0),H=e=>parseFloat(e.sb_gaji)+parseFloat(e.sb_makan)+parseFloat(e.sb_dinas)+parseFloat(e.salary_bonus_nominal),O=e=>parseFloat(e.sb_gaji_2)+parseFloat(e.sb_makan_2)+parseFloat(e.sb_dinas_2)+parseFloat(e.salary_bonus_nominal_2)+parseFloat(e.kerajinan),Q=e=>H(e)+O(e),W=e=>Q(e)+parseFloat(e.uj_gaji)+parseFloat(e.uj_gaji)+parseFloat(e.uj_dinas)-parseFloat(e.nominal_cut),nt=e=>W(e)+parseFloat(e.employee_bpjs_kesehatan)+parseFloat(e.employee_bpjs_jamsos),_t=async()=>{k().loading_full=!0;const{data:e,error:l,status:v}=await st("/rpt_salary",{method:"get",headers:{Authorization:`Bearer ${j.value}`,Accept:"application/json"},params:{id:h.id},retry:0});if(k().loading_full=!1,v.value==="error"){at().trigger(l);return}u.value=e.value.data,i.value=e.value.data.details};_(()=>{let e=0;return i.value.forEach(l=>{l.p_status!="Remove"&&(e+=parseInt(l.amount))}),e}),_(()=>!1);const b=w(""),X=_(()=>b.value!=""?i.value.filter(e=>e.employee.name.toLowerCase().includes(b.value.toLowerCase())):i.value);return pt(()=>h.show,(e,l)=>{e==!0&&(h.is_view==!1&&setTimeout(()=>{F.value.focus()},1),_t())},{immediate:!0}),(e,l)=>{const v=it;return tt((d(),m("section",gt,[t("div",null,[mt(v,{title:"Form Master Standby Validation",fn:p.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",Ft,[t("div",Et,[t("div",Dt,[t("div",Mt,[St,t("div",Nt,s(a(x)(a(u).period_end).format("MM-Y")),1)]),a(i).length?(d(),m("div",Ct,[Pt,tt(t("input",{class:"",type:"text","onUpdate:modelValue":l[0]||(l[0]=o=>ht(b)?b.value=o:null),name:"search",placeholder:"Nama"},null,512),[[vt,a(b)]])])):f("",!0)]),a(X).length?(d(),m("div",Tt,[t("div",Bt,[t("table",At,[t("thead",null,[Vt,t("tr",Yt,[$t,qt,It,zt,Gt,Kt,Lt,Rt,Jt,Ut,Ht,Ot,Qt,t("th",Wt,[r("Standby 1 "),t("span",Xt,"("+s(a(n)(a(z)))+")",1)]),t("th",Zt,[r("Potongan 1 "),t("span",te,"("+s(a(n)(a($)||0))+")",1)]),t("th",ee,[r("Periode 1 "),t("span",ae,"("+s(a(n)(a(G)))+")",1)]),t("th",se,[r("Standby 2 "),t("span",oe,"("+s(a(n)(a(K)))+")",1)]),t("th",le,[r("Potongan 2 "),t("span",ne,"("+s(a(n)(a(q)||0))+")",1)]),t("th",_e,[r("U.Kerajinan "),t("span",re,"("+s(a(n)(a(I)||0))+")",1)]),t("th",ue,[r("Periode 2 "),t("span",ie,"("+s(a(n)(a(L)))+")",1)]),t("th",ce,[r("Periode 1+2 "),t("span",pe,"("+s(a(n)(a(R)))+")",1)]),t("th",de,[r("Trip "),t("span",me,"("+s(a(n)(a(J)))+")",1)]),t("th",he,[r("Potongan Trip "),t("span",ve,"("+s(a(n)(a(Y)||0))+")",1)]),t("th",fe,[r("Total "),t("span",be,"("+s(a(n)(a(U)))+")",1)]),t("th",ye,[r("BPJS Kesehatan "),t("span",we,"("+s(a(n)(a(A)||0))+")",1)]),t("th",xe,[r("BPJS Jamsos "),t("span",ke,"("+s(a(n)(a(V)||0))+")",1)]),t("th",je,[r("Grand Total "),t("span",ge,"("+s(a(n)(a(lt)))+")",1)])]),t("tr",Fe,[t("th",null,[r("Gaji "),t("span",Ee,"("+s(a(n)(a(E)||0))+")",1)]),t("th",null,[r("Makan "),t("span",De,"("+s(a(n)(a(D)||0))+")",1)]),t("th",null,[r("Dinas "),t("span",Me,"("+s(a(n)(a(M)||0))+")",1)]),t("th",null,[r("Gaji "),t("span",Se,"("+s(a(n)(a(S)||0))+")",1)]),t("th",null,[r("Makan "),t("span",Ne,"("+s(a(n)(a(N)||0))+")",1)]),t("th",null,[r("Dinas "),t("span",Ce,"("+s(a(n)(a(C)||0))+")",1)]),t("th",null,[r("Gaji "),t("span",Pe,"("+s(a(n)(a(P)||0))+")",1)]),t("th",null,[r("Makan "),t("span",Te,"("+s(a(n)(a(T)||0))+")",1)]),t("th",null,[r("Dinas "),t("span",Be,"("+s(a(n)(a(B)||0))+")",1)])])]),t("tbody",Ae,[(d(!0),m(et,null,ft(a(X),(o,y)=>(d(),m(et,{key:y},[o.p_status!="Remove"?(d(),m("tr",{key:0,"data-index":y},[t("td",null,s(y+1)+".",1),t("td",null,s(o.employee_id),1),t("td",null,s(o.employee_name),1),t("td",null,s(o.employee_role),1),t("td",null,s(o.employee_birth_place),1),t("td",null,s(o.employee_birth_date?a(x)(o.employee_birth_date).format("DD-MM-Y"):""),1),t("td",null,s(o.employee_tmk?a(x)(o.employee_tmk).format("DD-MM-Y"):""),1),t("td",null,s(o.employee_ktp_no),1),t("td",null,s(o.employee_address),1),t("td",null,s(o.employee_status),1),t("td",null,s(o.employee_rek_no),1),t("td",null,s(o.employee_rek_name),1),t("td",null,s(o.employee_bank_name),1),t("td",null,s(a(n)(o.sb_gaji)),1),t("td",null,s(a(n)(o.sb_makan)),1),t("td",null,s(a(n)(o.sb_dinas)),1),t("td",null,s(a(n)(o.salary_bonus_nominal)),1),t("td",null,s(a(n)(H(o))),1),t("td",null,s(a(n)(o.sb_gaji_2)),1),t("td",null,s(a(n)(o.sb_makan_2)),1),t("td",null,s(a(n)(o.sb_dinas_2)),1),t("td",null,s(a(n)(o.salary_bonus_nominal_2)),1),t("td",null,s(a(n)(o.kerajinan)),1),t("td",null,s(a(n)(O(o))),1),t("td",null,s(a(n)(Q(o))),1),t("td",null,s(a(n)(o.uj_gaji)),1),t("td",null,s(a(n)(o.uj_makan)),1),t("td",null,s(a(n)(o.uj_dinas)),1),t("td",null,s(a(n)(o.nominal_cut)),1),t("td",null,s(a(n)(W(o))),1),t("td",null,s(a(n)(o.employee_bpjs_kesehatan)),1),t("td",null,s(a(n)(o.employee_bpjs_jamsos)),1),t("td",null,s(a(n)(nt(o))),1)],8,Ve)):f("",!0)],64))),128))],512)])])])):f("",!0)]),t("div",Ye,[t("div",$e,[qe,a(u).val1||a(u).val2||a(u).val3?(d(),m("div",Ie,[a(u).val1?(d(),m("div",ze," App 1 : "+s(a(u).val1_by.username)+" ( "+s(a(u).val1_at?a(x)(a(u).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):f("",!0)])):f("",!0)]),t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:l[1]||(l[1]=o=>p.fnClose())}," Cancel "),p.is_view==0?(d(),m("button",{key:0,ref_key:"it_val",ref:F,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:l[2]||(l[2]=bt(o=>ot(),["prevent"]))}," Validasi ",512)):f("",!0)])])])],512)),[[dt,p.show]])}}},Qe=jt(Ge,[["__scopeId","data-v-0022977b"]]);export{Qe as default};
