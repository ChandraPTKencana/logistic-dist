import{_ as B}from"./HeaderCustom.vue.fc8d587f.js";import{M as R,N as F,r as _,g as x,C as M,O as N,h as q,q as z,o as E,c as L,b as T,D as I,a as e,k as r,A as h,l as s,t as d,L as S,x as v,y as A,j as H}from"./entry.d9b45284.js";import{u as C}from"./useMyFetch.405cdccc.js";import"./CaretLeft.3d8e6a26.js";import"./_plugin-vue_export-helper.c27b6911.js";const O={class:"w-full h-full flex flex-col"},G={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},J={class:"w-full align-items-center justify-content-center grow overflow-auto"},K={class:"w-full flex flex-col flex-wrap p-1"},Q=e("label",{for:"username"},"Username",-1),W={class:"text-red-500"},X={class:"w-full flex flex-col flex-wrap p-1"},Y=e("label",{for:"fullname"},"Nama Identitas",-1),Z={class:"text-red-500"},ee={class:"w-full flex flex-col flex-wrap p-1"},te=e("label",{for:"email"},"Email",-1),le={class:"text-red-500"},oe={class:"w-full flex flex-col flex-wrap p-1"},ae=e("label",{for:"phone_number"},"Telepon",-1),se={class:"text-red-500"},ne={class:"w-full flex flex-col flex-wrap p-1"},ue=e("label",{for:"photo"},"Foto",-1),re={class:"flex justify-center items-center w-24 h-24"},ie=["src"],pe=e("small",null,"Upload file image : jpg, jpeg",-1),de={class:"help-err"},fe={class:"w-full flex items-center justify-end"},me=e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm"}," Save ",-1),ge=R({__name:"index",async setup(ce){let f,g;F();const i=_(!1),y=x("token"),u=_({});M();const j=N(),{data:l}=([f,g]=q(async()=>z(async()=>{v().loading_full=!0;const{data:o,error:t,status:n}=await C("/profile",{method:"get",headers:{Authorization:`Bearer ${y.value}`,Accept:"application/json"},retry:0});if(v().loading_full=!1,n.value==="error")A().trigger(t,u);else return o.value.photo&&(i.value=!0),o.value;return{username:"",fullname:"",email:"",phone_number:"",photo:""}},{lazy:!0,server:!1},"$161L0imkVP")),f=await f,g(),f),p=_(null),U=o=>{var t=o.target.files;if(t.length>0){let n=new FileReader;n.onload=function(a){var c;let m=(c=a.target)==null?void 0:c.result;m.match(/image/)&&(l.value.photo=m)},n.readAsDataURL(t[0]),i.value=!0}},$=()=>{i.value=!1,l.value.photo="";let o=p.value;o&&(o.value="")},D=x("username"),P=x("fullname"),w=_(!1),V=async()=>{var b,k;if(w.value)return;w.value=!0,v().loading_full=!0,u.value={};const o=new FormData;o.append("username",l.value.username),o.append("email",l.value.email),o.append("phone_number",l.value.phone_number),o.append("fullname",l.value.fullname),l.value.password&&o.append("password",l.value.password),typeof l.value.can_login<"u"&&o.append("can_login",l.value.can_login),(k=(b=p.value)==null?void 0:b.files)!=null&&k[0]&&o.append("photo",p.value.files[0]||""),p.value&&o.append("photo_preview",l.value.photo);let t="post",n=j.query.id;n===""||(t="post",o.append("id",n),o.append("_method","PUT"));const{data:a,error:m,status:c}=await C("/update_profile",{method:t,headers:{Authorization:`Bearer ${y.value}`,Accept:"application/json"},body:o,retry:0});if(v().loading_full=!1,w.value=!1,c.value==="error"){A().trigger(m,u);return}else D.value=l.value.username,P.value=l.value.fullname,H().display({show:!0,status:"Success",message:a.value.message})};return(o,t)=>{const n=B;return E(),L("div",O,[T(n,{title:"Profile",back:!0,onSubmit:t[0]||(t[0]=I(a=>V(),["prevent"]))}),e("form",G,[e("div",J,[e("div",K,[Q,r(e("input",{id:"username",type:"text","onUpdate:modelValue":t[1]||(t[1]=a=>s(l).username=a)},null,512),[[h,s(l).username]]),e("p",W,d(s(u).username),1)]),e("div",X,[Y,r(e("input",{id:"fullname",type:"text","onUpdate:modelValue":t[2]||(t[2]=a=>s(l).fullname=a)},null,512),[[h,s(l).fullname]]),e("p",Z,d(s(u).fullname),1)]),e("div",ee,[te,r(e("input",{id:"email",type:"text","onUpdate:modelValue":t[3]||(t[3]=a=>s(l).email=a)},null,512),[[h,s(l).email]]),e("p",le,d(s(u).email),1)]),e("div",oe,[ae,r(e("input",{id:"phone_number",type:"text","onUpdate:modelValue":t[4]||(t[4]=a=>s(l).phone_number=a)},null,512),[[h,s(l).phone_number]]),e("p",se,d(s(u).phone_number),1)]),e("div",ne,[ue,e("div",re,[e("img",{src:s(l).photo||"/logistik/user-default.png",alt:"",class:"max-w-full max-h-full"},null,8,ie)]),r(e("button",{type:"button",class:"bg-gray-600 w-24 text-white",onClick:t[5]||(t[5]=a=>$())},"Remove",512),[[S,s(i)]]),r(e("input",{id:"photo",onChange:t[6]||(t[6]=a=>U(a)),ref_key:"photo_input",ref:p,type:"file",name:"photo",value:""},null,544),[[S,!s(i)]]),pe,e("p",de,d(s(u).photo),1)])]),e("div",fe,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:t[7]||(t[7]=a=>o.$router.go(-1))}," Cancel "),me])])])}}});export{ge as default};
