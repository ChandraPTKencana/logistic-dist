import{r as n,f as L,g as Ae,h as Te,i as x,j as W,s as $e,c as b,b as r,a as _,k as X,v as Fe,l as s,m as ee,n as w,w as C,q as ze,x as f,y as N,o as u,z as E,d as I,t as U,A as Ee,B as H,_ as Y}from"./entry.1b15191a.js";import Ie from"./Header.49bdc5a7.js";import Me from"./Copy.faf4db5f.js";import Ve from"./Plus.a2c1399c.js";import Be from"./Edit.e5165596.js";import Le from"./Eyes.f0ae10ea.js";import Ne from"./Delete.4c7d8ba6.js";import Ue from"./Signature.19d62bd5.js";import je from"./SignatureOff.13589797.js";import He from"./Line.08e94925.js";import Ye from"./Check.90e0d946.js";import Re from"./TableView.2e7b8b1d.js";import{u as v}from"./useUtils.2be0fb7d.js";import{u as j}from"./useMyFetch.53166450.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.7ff5c253.js";import"./Adjust.c6299a93.js";import"./TableHeaderEye.9d9366ed.js";import"./Times.a77dacc1.js";import"./ClearAll.7fc72b36.js";import"./client-only.d396e9df.js";import"./ClearEach.497b4e1b.js";import"./CaretLeftDoubleBold.71f1ebf1.js";import"./CaretLeftBold.57df363c.js";import"./CaretRightBold.fc2b1475.js";import"./CaretRightDoubleBold.f57e2ebe.js";const Je=H(()=>Y(()=>import("./PopupMini.18b8c398.js"),["./PopupMini.18b8c398.js","./PopupMini.vue.122022e9.js","./Times.a77dacc1.js","./_plugin-vue_export-helper.c27b6911.js","./entry.1b15191a.js","./entry.c5f8f180.css","./Exclamation.013a1160.js"],import.meta.url).then(c=>c.default||c)),qe=H(()=>Y(()=>import("./standby_mst.6d8e261a.js"),["./standby_mst.6d8e261a.js","./HeaderPopup.vue.cc33d5aa.js","./Times.a77dacc1.js","./_plugin-vue_export-helper.c27b6911.js","./entry.1b15191a.js","./entry.c5f8f180.css","./Tools.162ed40d.js","./InputPointFormat.vue.66eaebc4.js","./Plus.a2c1399c.js","./ToolsPopup.43ece693.js","./ToolsPopup.13c08491.css","./ac_accs.7c35e342.js","./Search.7ff5c253.js","./useUtils.2be0fb7d.js","./useMyFetch.53166450.js","./ac_accs.2900e1e1.css"],import.meta.url).then(c=>c.default||c)),Ke=H(()=>Y(()=>import("./standby_mst_validasi.4fa8d663.js"),["./standby_mst_validasi.4fa8d663.js","./HeaderPopup.vue.cc33d5aa.js","./Times.a77dacc1.js","./_plugin-vue_export-helper.c27b6911.js","./entry.1b15191a.js","./entry.c5f8f180.css","./useUtils.2be0fb7d.js","./useMyFetch.53166450.js"],import.meta.url).then(c=>c.default||c)),Ze={class:"w-full h-full flex flex-col"},Ge={class:"w-full flex grow flex-col overflow-auto h-0"},Qe={class:"w-full flex justify-between flex-wrap"},We={class:"grow flex"},Xe={class:"m-1"},et=_("option",{value:"available"},"Available",-1),tt=_("option",{value:"unapprove"},"Unapprove",-1),at=_("option",{value:"deleted"},"Trash",-1),lt=_("option",{value:"all"},"All",-1),st=[et,tt,at,lt],ot={class:"grow mb-5"},Ft={__name:"index",async setup(c){let $,R;const te=e=>e.deleted==1?"!bg-red-400":e.val==0||e.val1==0?"!bg-gray-300":"",p=n("available");L(()=>p.value,e=>{q()},{immediate:!1});const i={};i._TimeZoneOffset=new Date().getTimezoneOffset(),i.sort="created_at:desc";const M=Ae("token"),{data:ae}=([$,R]=Te(async()=>ze(async()=>{let e=[];f().loading_full=!0;const{data:t,error:g,status:T}=await j("/standby_msts",{method:"get",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},params:{filter_status:p},retry:0});return f().loading_full=!1,T.value==="error"?(N().trigger(g),{standby_msts:e}):(e=t.value.data,{standby_msts:e})},{lazy:!0,server:!1,default:()=>({standby_msts:[]})},"$rczbThuP8g")),$=await $,R(),$),o=n([]);L(()=>{var e;return(e=ae.value)==null?void 0:e.standby_msts},e=>{e&&(o.value=[...e])},{immediate:!0}),n("");const V=n({field:"created_at",by:"desc"}),a=n(-1),m=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),d=x(()=>o.value[a.value]),le=()=>{i.like="";let e=JSON.parse(JSON.stringify(f()._tv.global_keyword));e!=""&&(i.like=`id:%${e}%,name:%${e}%,amount:%${e}%`),i.sort="",V.value.field&&(i.sort=V.value.field+":"+V.value.by),i.filter_model=JSON.stringify(f()._tv.filter_model)};n(null);const J=async()=>{f().loading_full=!0,m.value.may_get_data=!1,i.page=m.value.page,i.page==1&&(o.value=[]),i.first_row&&delete i.first_row,i.page>1&&(i.first_row=JSON.stringify(o.value[0])),i.filter_status=p.value;const{data:e,error:t,status:g}=await j("/standby_msts",{method:"get",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},params:i,retry:0});if(f().loading_full=!1,m.value.may_get_data=!0,g.value==="error"){N().trigger(t);return}m.value.page==1?o.value=e.value.data:m.value.page>1&&(o.value=[...o.value,...e.value.data]),e.value.data.length==0&&(m.value.is_last_record=!0),f()._tv.filter_box=!1},q=()=>{a.value=-1,m.value.page=1,m.value.is_last_record=!1,le(),J()},O=n(!1),F=n(0),k=n(0),h=n(-1),se=()=>{F.value=0,h.value=-1,k.value=!1,O.value=!0},{display:D}=W();$e(W());const oe=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=o.value[a.value].id,h.value=-1,k.value=!1,O.value=!0)},ne=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=o.value[a.value].id,h.value=-1,k.value=!0,O.value=!0)},S=n(!1),z=n(0),ie=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(z.value=o.value[a.value].id,h.value=1,k.value=!1,S.value=!0)},re=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(z.value=o.value[a.value].id,h.value=0,k.value=!1,S.value=!0)},ue=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(z.value=o.value[a.value].id,h.value=-1,k.value=!1,S.value=!0)},B=n(!1),K=n({}),A=n(!1),P=n(""),de=async()=>{A.value&&(A.value=!1)},_e=()=>{a.value==-1?D({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value="",K.value={id:o.value[a.value].id},A.value=!0)};L(()=>P.value,e=>{e.trim().length>0?B.value=!0:B.value=!1},{immediate:!1});const me=async()=>{f().loading_full=!0;const e=new FormData;e.append("id",o.value[a.value].id),e.append("deleted_reason",P.value),e.append("_method","DELETE");const{data:t,error:g,status:T}=await j("/standby_mst",{method:"post",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},body:e,retry:0});if(f().loading_full=!1,T.value==="error"){N().trigger(g);return}let y={...o.value[a.value]};y.deleted=t.value.deleted,y.deleted_user=t.value.deleted_user,y.deleted_at=t.value.deleted_at,y.deleted_by=t.value.deleted_by,y.deleted_reason=t.value.deleted_reason,p.value!="all"?o.value.splice(a.value,1):o.value.splice(a.value,1,{...y}),a.value=-1,A.value=!1},ve=n([{key:"no",label:"No",isai:!0},{key:"valx",label:"APP",childs:[{key:"val",label:"Kasir",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val1",label:"Logistik",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]}]},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"name",label:"Nama",freeze:1,filter_on:1,type:"string",sort:{priority:1,type:"asc"}},{key:"tipe",label:"Tipe",filter_on:1,type:"string"},{key:"amount",label:"Amount",class:" justify-end",type:"number"},{key:"is_transition",label:"Peralihan",filter_on:1,type:"select",select_item:[{k:"1",v:"Ya"},{k:"0",v:"Tidak"}]},{key:"is_trip",label:"Trip",filter_on:1,type:"select",select_item:[{k:"1",v:"Ya"},{k:"0",v:"Tidak"}]},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]),ce=x(()=>a.value>-1&&[void 0,0].indexOf(d.value.deleted)>-1&&v().checkPermission("standby_mst.create")),fe=x(()=>["available","all","unapprove"].indexOf(p.value)>-1&&v().checkPermission("standby_mst.create")),pe=x(()=>a.value>-1&&[void 0,0].indexOf(d.value.deleted)>-1&&(v().checkPermission("standby_mst.val")&&[void 0,0].indexOf(d.value.val)>-1||v().checkPermission("standby_mst.val1")&&[void 0,0].indexOf(d.value.val1)>-1)&&v().checkPermissions(["standby_mst.modify"])),ye=x(()=>a.value>-1&&[void 0,0].indexOf(d.value.deleted)>-1&&(v().checkPermission("standby_mst.val")&&[void 0,0].indexOf(d.value.val)>-1||v().checkPermission("standby_mst.val1")&&[void 0,0].indexOf(d.value.val1)>-1)),be=x(()=>a.value>-1&&[void 0,0].indexOf(d.value.deleted)>-1&&(v().checkPermission("standby_mst.unval")&&[1].indexOf(d.value.val)>-1||v().checkPermission("standby_mst.unval1")&&[1].indexOf(d.value.val1)>-1)),ke=x(()=>a.value>-1&&v().checkPermission("standby_mst.remove")&&[void 0,0].indexOf(d.value.deleted)>-1);return(e,t)=>{const g=Ie,T=Me,y=Ve,he=Be,ge=Le,xe=Ne,we=Ue,De=je,Z=He,G=Ye,Pe=Re,Ce=Je,Oe=qe,Se=Ke;return u(),b("div",Ze,[r(g,{title:"List Standby"}),_("div",Ge,[_("div",Qe,[_("div",We,[_("div",Xe,[X(_("select",{"aria-label":"Filter Status","onUpdate:modelValue":t[0]||(t[0]=l=>ee(p)?p.value=l:null)},st,512),[[Fe,s(p)]])]),s(ce)?(u(),b("button",{key:0,type:"button",name:"button","aria-label":"Copy Data",class:"m-1 text-2xl",onClick:t[1]||(t[1]=l=>ne())},[r(T)])):w("",!0),s(fe)?(u(),b("button",{key:1,type:"button",name:"button","aria-label":"New Form",class:"m-1 text-2xl",onClick:t[2]||(t[2]=l=>se())},[r(y)])):w("",!0),s(pe)?(u(),b("button",{key:2,type:"button",name:"button","aria-label":"Edit Form",class:"m-1 text-2xl",onClick:t[3]||(t[3]=l=>oe())},[r(he)])):w("",!0),s(a)>-1?(u(),b("button",{key:3,type:"button",name:"button","aria-label":"View Form",class:"m-1 text-2xl",onClick:t[4]||(t[4]=l=>ue())},[r(ge)])):w("",!0),s(ke)?(u(),b("button",{key:4,type:"button",name:"button","aria-label":"Delete Data",class:"m-1 text-2xl",onClick:t[5]||(t[5]=l=>_e())},[r(xe)])):w("",!0),s(ye)?(u(),b("button",{key:5,type:"button",name:"button","aria-label":"Validate Data",class:"m-1 text-2xl",onClick:t[6]||(t[6]=l=>ie())},[r(we)])):w("",!0),s(be)?(u(),b("button",{key:6,type:"button",name:"button","aria-label":"Unvalidate Data",class:"m-1 text-2xl",onClick:t[7]||(t[7]=l=>re())},[r(De)])):w("",!0)])]),r(Pe,{thead:s(ve),selected:s(a),onSetSelected:t[8]||(t[8]=l=>a.value=l),tbody:s(o),fnCallData:J,scrolling:s(m),onSetScrollingPage:t[9]||(t[9]=l=>s(m).page=l),onDoFilter:t[10]||(t[10]=l=>q()),rowBgColor:te},{val:C(({item:l})=>[l.val?(u(),E(G,{key:1})):(u(),E(Z,{key:0}))]),val1:C(({item:l})=>[l.val1?(u(),E(G,{key:1})):(u(),E(Z,{key:0}))]),is_transition:C(({item:l})=>[I(U(l.is_transition?"Ya":"Tidak"),1)]),is_trip:C(({item:l})=>[I(U(l.is_trip?"Ya":"Tidak"),1)]),deleted_by_username:C(({item:l})=>{var Q;return[I(U((Q=l.deleted_by)==null?void 0:Q.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])]),r(Ce,{type:"delete",show:s(A),data:s(K),fnClose:de,fnConfirm:me,enabledOk:s(B)},{footer:C(()=>[I(" Masukkan Alasan Penghapusan: "),_("div",ot,[X(_("textarea",{"onUpdate:modelValue":t[11]||(t[11]=l=>ee(P)?P.value=l:null)},null,512),[[Ee,s(P)]])])]),_:1},8,["show","data","enabledOk"]),r(Oe,{show:s(O),fnClose:()=>{O.value=!1},id:s(F),p_data:s(o),is_copy:s(k)},null,8,["show","fnClose","id","p_data","is_copy"]),r(Se,{show:s(S),fnClose:()=>{S.value=!1},id:s(z),p_data:s(o),it_state:s(h)},null,8,["show","fnClose","id","p_data","it_state"])])}}};export{Ft as default};
