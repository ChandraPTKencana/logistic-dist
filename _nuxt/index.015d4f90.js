import ie from"./Header.74a3a8db.js";import ue from"./Plus.0c96f51d.js";import de from"./Edit.4a9a4d8c.js";import ce from"./Signature.72863c78.js";import _e from"./PrinterEye.2d90e84c.js";import fe from"./Table2Column.93509bf4.js";import me from"./Line.1e6df362.js";import pe from"./Check.e9dc6d17.js";import{_ as ve}from"./PopupMini.vue.6e2bd2aa.js";import ye from"./salary_paid.b2523f49.js";import he from"./salary_paid_validasi.067548a2.js";import{_ as ge}from"./PDFView.vue.2bd0977c.js";import{f as we,g as ke,r as n,h as xe,i as U,s as be,j as Ce,c as _,b as f,a as o,k as t,l as g,F as De,y as Ae,w as Pe,z as $e,A as m,B as w,o as i,C as Me,D as I,t as k,d as Se,m as Te,v as Be,n as Fe,E as ze}from"./entry.e2a8d927.js";import{u as F}from"./useUtils.a689ea1e.js";import{u as x}from"./useMyFetch.7ab7b454.js";import{u as Ee}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.23971e09.js";import"./Exclamation.ac57cfea.js";import"./HeaderPopup.vue.eef7144c.js";import"./client-only.d142bf24.js";const Le={class:"w-full h-full flex flex-col"},je={class:"w-full flex grow flex-col overflow-auto h-0"},Ue={class:"w-full flex"},Ie={class:"w-full flex justify-center items-center grow h-0 p-1"},Ve={key:0,class:""},He={class:"tacky"},Ne=o("thead",null,[o("tr",{class:"sticky top-0 !z-[2]"},[o("th",null,"Logistik"),o("th",null,"ID"),o("th",null,"Period End"),o("th",null,"Period Part"),o("th",null,"Created At"),o("th",null,"Updated At")])],-1),Oe=["onClick"],Re={class:"flex items-center justify-center"},Ye={class:"bold"},Je={class:"grow mb-5"},yt={__name:"index",async setup(Ze){let b,z;const{$moment:P}=ze(),c={};c._TimeZoneOffset=new Date().getTimezoneOffset(),c.sort="created_at:desc";const v=we("token"),{data:V}=([b,z]=ke(async()=>$e(async()=>{let e=[];m().loading_full=!0;const{data:a,error:d,status:h}=await x("/salary_paids",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:c,retry:0});return m().loading_full=!1,h.value==="error"?(w().trigger(d),{salary_paids:e}):(e=a.value.data,{salary_paids:e})},"$5DNPjgzs1s")),b=await b,z(),b),s=n(V.value.salary_paids);n(""),n({field:"created_at",by:"desc"});const r=n(-1),u=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),C=n(null),H=async()=>{m().loading_full=!0,u.value.may_get_data=!1,c.page=u.value.page,c.page==1&&(s.value=[]),c.first_row&&delete c.first_row,c.page>1&&(c.first_row=JSON.stringify(s.value[0]));const{data:e,error:a,status:d}=await x("/salary_paids",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:c,retry:0});if(m().loading_full=!1,u.value.may_get_data=!0,d.value==="error"){w().trigger(a);return}u.value.page==1?(s.value=e.value.data,C.value&&(C.value.scrollTop=0)):u.value.page>1&&(s.value=[...s.value,...e.value.data]),e.value.data.length==0&&(u.value.is_last_record=!0)},N=async()=>{if(!u.value.may_get_data)return;let e=C.value;if(e.scrollLeft!=u.value.scrollLeft){u.value.scrollLeft=e.scrollLeft;return}u.value.is_last_record||!(Math.round(e.scrollTop)+e.clientHeight>=e.scrollHeight-1)||(u.value.page++,await H())};xe();const D=n(!1),$=n(0),M=n(0),O=()=>{$.value=0,D.value=!0,M.value=!1},{display:E}=U();be(U());const R=()=>{r.value==-1?E({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):($.value=s.value[r.value].id,D.value=!0,M.value=!1)},S=n(!1),L=n(0),Y=()=>{r.value==-1?E({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(L.value=s.value[r.value].id,S.value=!0)},T=n(!1),J=n({}),A=n(!1),y=n(""),Z=async()=>{A.value&&(A.value=!1)};Ce(()=>y.value,e=>{e.trim().length>0?T.value=!0:T.value=!1},{immediate:!1});const q=async()=>{m().loading_full=!0;const e=new FormData;e.append("id",s.value[r.value].id),e.append("deleted_reason",y.value),e.append("_method","DELETE");const{data:a,error:d,status:h}=await x("/salary_paid",{method:"post",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},body:e,retry:0});if(m().loading_full=!1,h.value==="error"){w().trigger(d);return}s.value.splice(r.value,1),r.value=-1,A.value=!1},{downloadFile:G,viewFile:qe}=Ee(),p=n(!1),j=n({}),K=async()=>{if(p.value==!0){p.value=!1;return}m().loading_full=!0;const{data:e,error:a,status:d}=await x("/salary_paid/pdf_preview",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:{id:s.value[r.value].id},retry:0});if(m().loading_full=!1,d.value==="error"){w().trigger(a);return}j.value=e.value,p.value=!0},Q=async()=>{m().loading_full=!0;const{data:e,error:a,status:d}=await x("/salary_paid/excel_download",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:{id:s.value[r.value].id},retry:0});if(m().loading_full=!1,d.value==="error"){w().trigger(a);return}G(e.value)};return(e,a)=>{const d=ie,h=ue,W=de,X=ce,ee=_e,te=fe,ae=me,oe=pe,se=ve,le=ye,ne=he,re=ge;return i(),_("div",Le,[f(d,{title:"List Salary Paid"}),o("div",je,[o("div",Ue,[("useUtils"in e?e.useUtils:t(F))().checkPermission("salary_paid.create")?(i(),_("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[0]||(a[0]=l=>O())},[f(h)])):g("",!0),("useUtils"in e?e.useUtils:t(F))().checkPermissions(["salary_paid.modify"])?(i(),_("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[1]||(a[1]=l=>R())},[f(W)])):g("",!0),("useUtils"in e?e.useUtils:t(F))().checkPermissions(["salary_paid.val1","salary_paid.val2","salary_paid.val3"])?(i(),_("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[2]||(a[2]=l=>Y())},[f(X)])):g("",!0),t(r)>-1&&t(s)[t(r)].val1==1?(i(),_("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[3]||(a[3]=l=>K())},[f(ee)])):g("",!0),t(r)>-1&&t(s)[t(r)].val1==1?(i(),_("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[4]||(a[4]=l=>Q())},[f(te)])):g("",!0)]),o("div",Ie,[t(s).length==0?(i(),_("div",Ve," Maaf Tidak Ada Record ")):(i(),_("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:C,onScroll:N},[o("table",He,[Ne,o("tbody",null,[(i(!0),_(De,null,Ae(t(s),(l,B)=>(i(),_("tr",{key:B,onClick:Ge=>r.value=B,class:Me(t(r)==B?"active":"")},[o("td",null,[o("div",Re,[l.val1?(i(),I(oe,{key:1})):(i(),I(ae,{key:0}))])]),o("td",Ye,k(l.id),1),o("td",null,k(l.period_end?t(P)(l.period_end).format("MM-Y"):""),1),o("td",null,k(l.period_part),1),o("td",null,k(l.created_at?t(P)(l.created_at).format("DD-MM-Y HH:mm:ss"):""),1),o("td",null,k(l.updated_at?t(P)(l.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,Oe))),128))])])],544))])]),f(se,{type:"delete",show:t(A),data:t(J),fnClose:Z,fnConfirm:q,enabledOk:t(T)},{footer:Pe(()=>[Se(" Masukkan Alasan Penghapusan: "),o("div",Je,[Te(o("textarea",{"onUpdate:modelValue":a[5]||(a[5]=l=>Fe(y)?y.value=l:null)},null,512),[[Be,t(y)]])])]),_:1},8,["show","data","enabledOk"]),f(le,{show:t(D),fnClose:()=>{D.value=!1},id:t($),p_data:t(s),is_copy:t(M)},null,8,["show","fnClose","id","p_data","is_copy"]),f(ne,{show:t(S),fnClose:()=>{S.value=!1},id:t(L),p_data:t(s)},null,8,["show","fnClose","id","p_data"]),f(re,{show:t(p),pdfContent:t(j),onClose:a[6]||(a[6]=l=>p.value=!t(p))},null,8,["show","pdfContent"])])}}};export{yt as default};
