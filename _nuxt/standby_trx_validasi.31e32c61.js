import{_ as Z}from"./HeaderPopup.vue.6fbf20a0.js";import{_ as ee}from"./WidthMiniPart.vue.55fcb927.js";import te from"./AttachmentSingle.43a6dd9d.js";import se from"./Times.04ecc2cb.js";import ae from"./Check.12520d4f.js";import le from"./CaretTop.2d5b4475.js";import oe from"./CaretDown.9a8eeef6.js";import{r as p,f as ne,P as ie,G as J,j as re,m as de,J as _e,o as r,c,a as e,b as h,t as o,k as t,F as z,y as ce,C as G,D as C,l as m,x as ve,d as ue,E as fe,A as N,B as K,p as pe,e as me}from"./entry.fd6a4a17.js";import{u as F}from"./useUtils.87b4951b.js";import{u as W}from"./useMyFetch.62b847cb.js";import{_ as we}from"./_plugin-vue_export-helper.c27b6911.js";import"./PDFJsView.e03aa2d0.js";const n=v=>(pe("data-v-f73a2e2e"),v=v(),me(),v),xe={class:"box-fixed"},he={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},be={class:"w-full flex flex-col items-center grow overflow-auto"},ye={class:"w-full flex flex-row flex-wrap"},ke={class:"w-full sm:w-9/12 flex px-2 py-3"},ge={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},De=n(()=>e("div",{class:"absolute bg-white -top-3"}," Standby ",-1)),Se={class:"w-6/12 sm:w-2/12 flex flex-col flex-wrap p-1"},Ce=n(()=>e("label",{for:""},"ID",-1)),Ne={class:"card-border"},Ie={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Ae=n(()=>e("label",{for:""},"Name",-1)),Ye={class:"card-border"},Te={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Pe=n(()=>e("label",{for:""},"Type",-1)),$e={class:"card-border"},Be={class:"w-6/12 sm:w-2/12 flex flex-col flex-wrap p-1"},Fe=n(()=>e("label",{for:""},"Amount",-1)),Me={class:"card-border"},je={class:"w-full sm:w-3/12 flex px-2 py-3"},Ve={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative items-end"},Ee=n(()=>e("div",{class:"absolute bg-white -top-3"}," Peralihan ",-1)),Oe={class:"w-6/12 flex flex-col flex-wrap p-1"},Re={class:"card-border"},He={class:"w-6/12 flex flex-col flex-wrap p-1"},Ue={class:"card-border"},Le={class:"w-full flex flex-wrap"},qe={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Je=n(()=>e("label",{for:""},"Supir",-1)),ze={class:"card-border"},Ge={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Ke=n(()=>e("label",{for:""},"Kernet",-1)),We={class:"card-border"},Qe={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Xe=n(()=>e("label",{for:""},"No Pol",-1)),Ze={class:"card-border"},et={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},tt=n(()=>e("label",{for:""},"Tujuan",-1)),st={class:"card-border"},at={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},lt=n(()=>e("label",{for:""},"Note For Remarks",-1)),ot={class:"card-border"},nt={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},it=n(()=>e("label",{for:""},"Referensi",-1)),rt={class:"card-border"},dt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},_t={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},ct=n(()=>e("div",{class:"absolute bg-white -top-3"}," Cost Center ",-1)),vt={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},ut=n(()=>e("label",{for:""}," Code",-1)),ft={class:"card-border"},pt={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},mt=n(()=>e("label",{for:""},"Desc",-1)),wt={class:"card-border disabled"},xt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},ht={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},bt=n(()=>e("div",{class:"absolute bg-white -top-3"}," PVR ",-1)),yt={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},kt=n(()=>e("label",{for:""},"No",-1)),gt={class:"card-border disabled"},Dt={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},St=n(()=>e("label",{for:""},"Total",-1)),Ct={class:"card-border disabled"},Nt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},It={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},At=n(()=>e("div",{class:"absolute bg-white -top-3"}," PV ",-1)),Yt={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},Tt=n(()=>e("label",{for:""},"No",-1)),Pt={class:"card-border disabled"},$t={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Bt=n(()=>e("label",{for:""},"Total",-1)),Ft={class:"card-border disabled"},Mt={class:"w-full flex grow p-1 overflow-auto 2xl:overflow-hidden justify-between flex-wrap"},jt={class:"w-full",role:"sticky"},Vt={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},Et={class:"sticky -top-1 !z-[2]"},Ot=["colspan"],Rt=n(()=>e("tr",{class:"sticky top-7 !z-[2]"},[e("th",{class:"!min-w-[50px] !w-[50px] !max-w-[50px]"},"No"),e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Tanggal"),e("th",{class:"!min-w-[200px] !w-[200px] !max-w-[200px]"},"Foto"),e("th",{class:"!min-w-[200px] !w-[200px] !max-w-[200px]"},"Note"),e("th",{class:"!min-w-[70px] !w-[70px] !max-w-[70px]"},"Dibayar")],-1)),Ht={ref:"to_move"},Ut=["data-index"],Lt={class:"cell"},qt={class:"w-full h-full flex items-center justify-center relative"},Jt={class:"cell"},zt={style:{width:"60vw"},class:"h-full flex items-center justify-center"},Gt={class:"cell"},Kt={class:"h-full flex items-center justify-center"},Wt={class:"w-full h-full flex items-center justify-center"},Qt={key:0,class:"text-3xl"},Xt=["onClick"],Zt={class:"w-full flex items-center justify-end"},es={class:"w-full flex flex-wrap p-3 items-center"},ts=n(()=>e("div",null," Di Validasi oleh : ",-1)),ss={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},as={key:0},ls={key:1},os={key:2},ns={key:0,class:"text-xs font-bold"},is={__name:"standby_trx_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},emits:["setID","setIndex"],setup(v,{emit:y}){const _=v,{$moment:k}=fe(),{pointFormat:I}=F(),M={id:-1,transition_target:"",transition_type:"",standby_mst_id:"",standby_mst_:{name:"",tipe:"",amount:0},supir:"",kernet:"",no_pol:"",xto:"",note_for_remarks:"",ref:"",cost_center_code:"",cost_center_desc:"",pvr_id:"",pvr_no:"",pvr_total:0,pvr_had_detail:0,pv_id:"",pv_no:"",pv_total:0,pv_datetime:"",rv_id:"",rv_no:"",rv_total:0,rv_had_detail:"",details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:""},s=p({...M}),j=ne("token"),V=p({}),E=p(null),g=p([]),O={_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:-1,name:"",title:""};let A=l=>{l.key=="ArrowUp"&&H(),l.key=="ArrowDown"&&R()};ie(()=>{document.removeEventListener("keydown",A)});const u=p(JSON.parse(JSON.stringify(O))),f=p(JSON.parse(JSON.stringify(O))),w=p(""),Q=async()=>{w.value="PROSES...",N().loading_full=!0,V.value={};const l=new FormData;l.append("details",JSON.stringify(g.value));let i="post",x=_.id;x==0||(l.append("id",x),l.append("_method","PUT"));const{data:a,error:P,status:D}=await W("/standby_trx_validasi",{method:i,headers:{Authorization:`Bearer ${j.value}`,Accept:"application/json"},body:l,retry:0});if(N().loading_full=!1,D.value==="error"){w.value="GAGAL",K().trigger(P,V);return}s.value.val=a.value.val,s.value.val_user=a.value.val_user,s.value.val_by=a.value.val_by,s.value.val_at=a.value.val_at,s.value.val1=a.value.val1,s.value.val1_user=a.value.val1_user,s.value.val1_by=a.value.val1_by,s.value.val1_at=a.value.val1_at,s.value.val2=a.value.val2,s.value.val2_user=a.value.val2_user,s.value.val2_by=a.value.val2_by,s.value.val2_at=a.value.val2_at;let b=_.p_data.map($=>$.id).indexOf(_.id);b>=-1&&_.p_data.splice(b,1,{...s.value}),w.value="BERHASIL"},Y=async()=>{w.value="",N().loading_full=!0;const{data:l,error:i,status:x}=await W("/standby_trx",{method:"get",headers:{Authorization:`Bearer ${j.value}`,Accept:"application/json"},params:{id:_.id},retry:0});if(N().loading_full=!1,x.value==="error"){K().trigger(i);return}let a=l.value.data;s.value=a,u.value._.id.val=a.supir_id,u.value._.name.val=a.supir,u.value._.rek_no.val=a.supir_rek_no,u.value._.rek_name.val=a.supir_rek_name,u.value.id=a.supir_id,u.value.name=a.supir,u.value.rek_no=(a.supir_rek_no||"")+" "+(a.supir_rek_name||""),f.value._.id.val=a.kernet_id,f.value._.name.val=a.kernet,f.value._.rek_no.val=a.kernet_rek_no,f.value._.rek_name.val=a.kernet_rek_name,f.value.id=a.kernet_id,f.value.name=a.kernet,f.value.rek_no=(a.kernet_rek_no||"")+" "+(a.kernet_rek_name||""),g.value=l.value.data.details};J(()=>{let l=0;return g.value.forEach(i=>{i.p_status!="Remove"&&(l+=i.amount)}),l});const T=J(()=>s.value.val2==1);re(()=>_.show,(l,i)=>{l==!0?(document.addEventListener("keydown",A),s.value={...M},_.is_view==!1&&setTimeout(()=>{E.value.focus()},1),Y()):document.removeEventListener("keydown",A)},{immediate:!0});const R=()=>{let l=_.p_data.map(i=>i.id).indexOf(_.id);l!=_.p_data.length-1&&(l++,y("setID",_.p_data[l].id),y("setIndex",l),setTimeout(()=>{Y()},100))},H=()=>{let l=_.p_data.map(i=>i.id).indexOf(_.id);l!=0&&(l--,y("setID",_.p_data[l].id),y("setIndex",l),setTimeout(()=>{Y()},100))};return(l,i)=>{var U,L,q;const x=Z,a=ee,P=te,D=se,b=ae,$=le,X=oe;return de((r(),c("section",xe,[e("div",null,[h(x,{title:"Form Transaction Standby Validation",fn:v.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",he,[e("div",be,[e("div",ye,[e("div",ke,[e("div",ge,[De,e("div",Se,[Ce,e("div",Ne,o(t(s).standby_mst_id),1)]),e("div",Ie,[Ae,e("div",Ye,o((U=t(s).standby_mst_)==null?void 0:U.name),1)]),e("div",Te,[Pe,e("div",$e,o((L=t(s).standby_mst_)==null?void 0:L.tipe),1)]),e("div",Be,[Fe,e("div",Me,o(t(I)((q=t(s).standby_mst_)==null?void 0:q.amount)),1)])])]),e("div",je,[e("div",Ve,[Ee,e("div",Oe,[e("div",Re,o(t(s).transition_type),1)]),e("div",He,[e("div",Ue,o(t(s).transition_target),1)])])]),e("div",Le,[e("div",qe,[Je,e("div",ze,[h(a,{selected:t(u)},null,8,["selected"])])]),e("div",Ge,[Ke,e("div",We,[h(a,{selected:t(f)},null,8,["selected"])])]),e("div",Qe,[Xe,e("div",Ze,o(t(s).no_pol),1)]),e("div",et,[tt,e("div",st,o(t(s).xto),1)]),e("div",at,[lt,e("div",ot,o(t(s).note_for_remarks),1)]),e("div",nt,[it,e("div",rt,o(t(s).ref),1)])]),e("div",dt,[e("div",_t,[ct,e("div",vt,[ut,e("div",ft,o(t(s).cost_center_code),1)]),e("div",pt,[mt,e("div",wt,o(t(s).cost_center_desc),1)])])]),e("div",xt,[e("div",ht,[bt,e("div",yt,[kt,e("div",gt,o(t(s).pvr_no),1)]),e("div",Dt,[St,e("div",Ct,o(t(I)(t(s).pvr_total||0)),1)])])]),e("div",Nt,[e("div",It,[At,e("div",Yt,[Tt,e("div",Pt,o(t(s).pv_no),1)]),e("div",$t,[Bt,e("div",Ft,o(t(I)(t(s).pv_total)),1)])])]),e("div",Mt,[e("div",jt,[e("table",Vt,[e("thead",null,[e("tr",Et,[e("td",{colspan:t(T)?5:6,class:"!bg-slate-800 text-white font-bold"}," Detail Transaction ",8,Ot)]),Rt]),e("tbody",Ht,[(r(!0),c(z,null,ce(t(g),(d,B)=>(r(),c(z,{key:B},[d.p_status!="Remove"?(r(),c("tr",{key:0,"data-index":B},[e("td",null,o(B+1)+".",1),e("td",Lt,[e("div",qt,o(t(k)(d.tanggal).format("DD-MM-YYYY")),1)]),e("td",Jt,[e("div",zt,[h(P,{value:d.attachment_1_preview,onSetFile:S=>d.attachment_1=S,onSetPreview:S=>d.attachment_1_preview=S},null,8,["value","onSetFile","onSetPreview"])])]),e("td",Gt,[e("div",Kt,o(d.note),1)]),e("td",{class:G(["cell",!("useUtils"in l?l.useUtils:t(F))().checkPermissions(["standby_trx.detail.decide_paid"])||t(T)||v.is_view?"unselectable":""])},[e("div",Wt,[!("useUtils"in l?l.useUtils:t(F))().checkPermissions(["standby_trx.detail.decide_paid"])||t(T)||v.is_view?(r(),c("div",Qt,[d.be_paid==0?(r(),C(D,{key:0,class:"text-red-800"})):(r(),C(b,{key:1,class:"text-green-800"}))])):(r(),c("button",{key:1,type:"button",onClick:S=>d.be_paid=d.be_paid?0:1,class:G(["text-white w-auto rounded text-xl",d.be_paid?"bg-green-600":"bg-red-600"])},[d.be_paid==0?(r(),C(D,{key:0})):(r(),C(b,{key:1}))],10,Xt))])],2)],8,Ut)):m("",!0)],64))),128))],512)])])])])]),e("div",Zt,[e("div",es,[ts,t(s).val||t(s).val1||t(s).val2?(r(),c("div",ss,[t(s).val?(r(),c("div",as," App 1 : "+o(t(s).val_by.username)+" ( "+o(t(s).val_at?t(k)(t(s).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0),t(s).val1?(r(),c("div",ls," App 2 : "+o(t(s).val1_by.username)+" ( "+o(t(s).val1_at?t(k)(t(s).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0),t(s).val2?(r(),c("div",os," App 3 : "+o(t(s).val2_by.username)+" ( "+o(t(s).val2_at?t(k)(t(s).val2_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0)])):m("",!0)]),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:i[0]||(i[0]=d=>H())},[h($,{class:"black"})]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:i[1]||(i[1]=d=>v.fnClose())}," Cancel "),v.is_view==0?(r(),c("button",{key:0,ref_key:"it_val",ref:E,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:i[2]||(i[2]=ve(d=>Q(),["prevent"]))},[ue(" Validasi "),t(w)!=""?(r(),c("div",ns,o(t(w)),1)):m("",!0)],512)):m("",!0),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:i[3]||(i[3]=d=>R())},[h(X,{class:"black"})])])])])],512)),[[_e,v.show]])}}},bs=we(is,[["__scopeId","data-v-f73a2e2e"]]);export{bs as default};
