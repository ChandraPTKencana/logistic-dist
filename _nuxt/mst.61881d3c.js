import{_ as G}from"./HeaderPopup.vue.a430cf19.js";import{_ as H}from"./WidthMiniList.vue.c39af1e8.js";import{_ as K}from"./InputPointFormat.vue.06d16ed7.js";import W from"./AttachmentSingle.44b05fe4.js";import Q from"./part.6cd3eb91.js";import{r as c,f as X,G as j,j as Y,m as N,J as Z,o as y,c as b,a as t,b as h,k as a,v as D,t as u,F as ee,y as te,q as ae,x as le,l as V,A as g,B as J,p as oe,e as se}from"./entry.85fb43e9.js";import{u as P}from"./useMyFetch.dc2476c7.js";import{u as ne}from"./useUtils.0bc8ee6c.js";import{_ as ie}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.c820c732.js";import"./WidthMiniPart.vue.1baefb40.js";import"./PDFJsView.d3895751.js";import"./Plus.88c9e778.js";import"./Edit.0b418adf.js";import"./Signature.67e6e31b.js";import"./Calculator.1e424380.js";import"./Search.333e72c9.js";import"./Line.732215e4.js";import"./Check.1f9b2306.js";import"./trx.7e3af81a.js";import"./trx_validasi.7d227959.js";const p=r=>(oe("data-v-82a660a6"),r=r(),se(),r),re={class:"box-fixed"},de={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-slate-200"},_e={class:"w-full flex flex-col items-center grow overflow-auto"},ue={class:"w-full p-1"},pe={class:"w-full flex flex-row flex-wrap bg-white"},me={class:"w-full flex flex-col flex-wrap p-1"},ce=p(()=>t("label",{for:""},"Kejadian",-1)),ve=["disabled"],fe={class:"text-red-500"},we={class:"w-full sm:w-9/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},he=p(()=>t("label",{for:""},"Pekerja",-1)),xe={class:"text-red-500"},ge={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ye=p(()=>t("label",{for:""},"No Pol",-1)),be=["disabled"],ke={id:"vehicle"},Se=["value"],Ne={class:"text-red-500"},Ce={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Oe=p(()=>t("label",{for:""},"Nominal",-1)),je={class:"w-full"},Je={class:"text-red-500"},Pe={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ie=p(()=>t("label",{for:""},"Nominal Potong",-1)),Fe={class:"w-full"},$e={class:"text-red-500"},Ue={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ae=p(()=>t("label",{for:""},"Sisa Potongan",-1)),Be={class:"card-border"},De={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ve=p(()=>t("label",{for:""},"Status",-1)),Le=["disabled"],qe=p(()=>t("option",{value:"Open"},"Open",-1)),Me=p(()=>t("option",{value:"Close Clear"},"Close Clear",-1)),ze=p(()=>t("option",{value:"Close UnClear"},"Close UnClear",-1)),Ee=[qe,Me,ze],Re={class:"text-red-500"},Te={class:"w-full flex flex-col flex-wrap p-1"},Ge={class:"text-red-500"},He={class:"w-full flex flex-col flex-wrap p-1"},Ke={class:"text-red-500"},We={class:"w-full flex flex-row flex-wrap p-1 justify-end"},Qe={key:0,class:"w-full h-full p-1"},Xe={class:"w-full flex items-center justify-end bg-white"},Ye={__name:"mst",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},setup(r){const _=r,C={id:-1,kejadian:"",employee:{id:-1,name:""},no_pol:"",nominal:0,nominal_cut:0,remaining_cut:0,status:"Open",attachment_1:"",attachment_1_preview:"",attachment_2:"",attachment_2_preview:"",val_at:""},L=c([]);c({ordinal:0,id:"",tanggal:new Date,note:"",p_status:""}),JSON.parse(JSON.stringify(C));const l=c(JSON.parse(JSON.stringify(C))),O=X("token"),d=c({}),q=async()=>{g().loading_full=!0,d.value={};const s=new FormData;s.append("kejadian",l.value.kejadian),s.append("nominal",l.value.nominal),s.append("nominal_cut",l.value.nominal_cut),s.append("status",l.value.status),s.append("employee_id",i.value.id),s.append("no_pol",l.value.no_pol),s.append("attachment_1",l.value.attachment_1),s.append("attachment_1_preview",l.value.attachment_1_preview),s.append("attachment_2",l.value.attachment_2),s.append("attachment_2_preview",l.value.attachment_2_preview);let e="post",m=_.id;m==0||(s.append("id",m),s.append("_method","PUT"));const{data:n,error:v,status:f}=await P("/potongan_mst",{method:e,headers:{Authorization:`Bearer ${O.value}`,Accept:"application/json"},body:s,retry:0});if(g().loading_full=!1,f.value==="error"){J().trigger(v,d);return}if(l.value.employee.id=i.value.id,l.value.employee.name=i.value.name,l.value.remaining_cut=n.value.remaining_cut,l.value.updated_at=n.value.updated_at,_.id<=0)l.value.id=n.value.id,l.value.created_at=n.value.created_at,_.p_data.unshift(l.value);else{let w=_.p_data.map(o=>o.id).indexOf(_.id);w>=-1&&_.p_data.splice(w,1,{...l.value})}_.fnClose()},k={_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:"",name:"",title:""},i=c(JSON.parse(JSON.stringify(k))),M=j(()=>{let s=[];return F.value.forEach((e,m)=>{let n=JSON.parse(JSON.stringify(k));n._.id.val=e.id,n._.name.val=e.name,n._.rek_no.val=e.rek_no,n._.rek_name.val=e.rek_name,n.id=e.id,n.name=e.name,n.title=(e.rek_no||"")+" "+(e.rek_name||""),s.push(JSON.parse(JSON.stringify(n)))}),s}),x=j(()=>l.value.val1==1),S=j(()=>l.value.val_at),z=async()=>{var v,f,w,o,$,U,A,B;g().loading_full=!0;const{data:s,error:e,status:m}=await P("/potongan_mst",{method:"get",headers:{Authorization:`Bearer ${O.value}`,Accept:"application/json"},params:{id:_.id},retry:0});if(g().loading_full=!1,m.value==="error"){J().trigger(e);return}let n=s.value.data;l.value=n,{...n},i.value._.id.val=(v=n.employee)==null?void 0:v.id,i.value._.name.val=(f=n.employee)==null?void 0:f.name,i.value._.rek_no.val=(w=n.employee)==null?void 0:w.rek_no,i.value._.rek_name.val=(o=n.employee)==null?void 0:o.rek_name,i.value.id=($=n.employee)==null?void 0:$.id,i.value.name=(U=n.employee)==null?void 0:U.name,i.value.rek_no=(((A=n.employee)==null?void 0:A.rek_no)||"")+" "+(((B=n.employee)==null?void 0:B.rek_name)||"")},E=c([]),R=c([]),I=c([]),F=c([]),T=async()=>{g().loading_full=!0;const{data:s,error:e,status:m}=await P("/potongan_mst_load_local",{method:"get",headers:{Authorization:`Bearer ${O.value}`,Accept:"application/json"},retry:0});if(g().loading_full=!1,m.value==="error"){J().trigger(e);return}E.value=s.value.list_potongan_mst,R.value=s.value.list_xto,I.value=s.value.list_vehicle,F.value=s.value.list_employee};return Y(()=>_.show,async(s,e)=>{s==!0&&(await T(),l.value=JSON.parse(JSON.stringify(C)),i.value=JSON.parse(JSON.stringify(k)),L.value=[],d.value={},_.id!=0&&z())},{immediate:!0}),(s,e)=>{const m=G,n=H,v=K,f=W,w=Q;return N((y(),b("section",re,[t("div",null,[h(m,{title:"Form Potongan",fn:r.fnClose,class:"w-full flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",de,[t("div",_e,[t("div",ue,[t("div",pe,[t("div",me,[ce,N(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=o=>a(l).kejadian=o),rows:"10",disabled:a(x)}," ",8,ve),[[D,a(l).kejadian]]),t("p",fe,u(a(d).kejadian),1)]),t("div",we,[he,h(n,{arr:a(M),selected:a(i),pure:k,onSetSelected:e[1]||(e[1]=o=>i.value=o),disabled:a(S)},null,8,["arr","selected","disabled"]),t("p",xe,u(a(d).employee_id),1)]),t("div",ge,[ye,N(t("input",{type:"text",list:"vehicle","onUpdate:modelValue":e[2]||(e[2]=o=>a(l).no_pol=o),disabled:a(S)},null,8,be),[[D,a(l).no_pol]]),t("datalist",ke,[(y(!0),b(ee,null,te(a(I),o=>(y(),b("option",{value:o.no_pol},u(o.no_pol),9,Se))),256))]),t("p",Ne,u(a(d).no_pol),1)]),t("div",Ce,[Oe,t("div",je,[h(v,{class:"w-full h-full",type:"text",value:a(l).nominal||0,onInput:e[3]||(e[3]=o=>a(l).nominal=o),show:r.show,disabled:a(S)},null,8,["value","show","disabled"])]),t("p",Je,u(a(d).ref),1)]),t("div",Pe,[Ie,t("div",Fe,[h(v,{class:"w-full h-full",type:"text",value:a(l).nominal_cut||0,onInput:e[4]||(e[4]=o=>a(l).nominal_cut=o),show:r.show,disabled:a(x)},null,8,["value","show","disabled"])]),t("p",$e,u(a(d).ref),1)]),t("div",Ue,[Ae,t("div",Be,u(("useUtils"in s?s.useUtils:a(ne))().pointFormat(a(l).remaining_cut)),1)]),t("div",De,[Ve,N(t("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>a(l).status=o),disabled:a(x)},Ee,8,Le),[[ae,a(l).status]]),t("p",Re,u(a(d).ref),1)]),t("div",Te,[h(f,{label:"Lampiran Pertama",value:a(l).attachment_1_preview,onSetFile:e[6]||(e[6]=o=>a(l).attachment_1=o),onSetPreview:e[7]||(e[7]=o=>a(l).attachment_1_preview=o),can_remove:!a(S)},null,8,["value","can_remove"]),t("p",Ge,u(a(d).attachment_1),1)]),t("div",He,[h(f,{label:"Lampiran Lanjutan",value:a(l).attachment_2_preview,onSetFile:e[8]||(e[8]=o=>a(l).attachment_2=o),onSetPreview:e[9]||(e[9]=o=>a(l).attachment_2_preview=o),can_remove:!a(x)},null,8,["value","can_remove"]),t("p",Ke,u(a(d).attachment_2),1)]),t("div",We,[a(x)?V("",!0):(y(),b("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:e[10]||(e[10]=le(o=>q(),["prevent"]))}," Save "))])])]),a(x)?(y(),b("div",Qe,[h(w,{id:r.id,show:r.show,onUpdateRemainingCut:e[11]||(e[11]=o=>a(l).remaining_cut=o)},null,8,["id","show"])])):V("",!0)]),t("div",Xe,[t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:e[12]||(e[12]=o=>r.fnClose())}," Close ")])])])],512)),[[Z,r.show]])}}},gt=ie(Ye,[["__scopeId","data-v-82a660a6"]]);export{gt as default};
