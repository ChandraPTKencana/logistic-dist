import Pe from"./Header.76322b0a.js";import Se from"./Copy.9140d98a.js";import Oe from"./Plus.475573fa.js";import Te from"./Edit.5457b85d.js";import Ae from"./Eyes.ff9c81e8.js";import $e from"./Delete.2eb7d8e8.js";import Fe from"./Signature.7e970caf.js";import Me from"./SignatureOff.4788ef0b.js";import Be from"./Line.4c8028ad.js";import Ne from"./Check.376576d2.js";import Ie from"./TableView.586b5ef3.js";import{_ as Ve}from"./PopupMini.vue.9c6ea634.js";import Ee from"./standby_mst.80d64bb1.js";import Ue from"./standby_mst_validasi.537b31b1.js";import{r as n,f as K,g as je,h as ze,i as g,j as Z,s as He,c as y,b as r,a as _,k as G,v as Ye,l as s,m as Q,n as x,w as C,q as Le,x as c,y as E,o as u,z as M,d as B,t as U,A as Je}from"./entry.1708309d.js";import{u as v}from"./useUtils.800ea8a5.js";import{u as j}from"./useMyFetch.4a25296e.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.440fbf2a.js";import"./Adjust.0ff14669.js";import"./TableHeaderEye.52e6db4c.js";import"./Times.5d3911b6.js";import"./ClearAll.19411f5c.js";import"./client-only.c5e623b3.js";import"./ClearEach.2adfab9f.js";import"./CaretLeftDoubleBold.61adcbd3.js";import"./CaretLeftBold.15b2b6bd.js";import"./CaretRightBold.6faaf415.js";import"./CaretRightDoubleBold.b5d18650.js";import"./Exclamation.5e9a213f.js";import"./HeaderPopup.vue.5a4865a4.js";import"./Tools.02c2b7ce.js";import"./InputPointFormat.vue.b3ceec7e.js";import"./ToolsPopup.c5fa210c.js";import"./ac_accs.a0991740.js";const Re={class:"w-full h-full flex flex-col"},qe={class:"w-full flex grow flex-col overflow-auto h-0"},Ke={class:"w-full flex justify-between flex-wrap"},Ze={class:"grow flex"},Ge={class:"m-1"},Qe=_("option",{value:"available"},"Available",-1),We=_("option",{value:"unapprove"},"Unapprove",-1),Xe=_("option",{value:"deleted"},"Trash",-1),et=_("option",{value:"all"},"All",-1),tt=[Qe,We,Xe,et],at={class:"grow mb-5"},Ut={__name:"index",async setup(lt){let A,z;const W=t=>t.deleted==1?"!bg-red-400":t.val==0||t.val1==0?"!bg-gray-300":"",f=n("available");K(()=>f.value,t=>{Y()},{immediate:!1});const i={};i._TimeZoneOffset=new Date().getTimezoneOffset(),i.sort="created_at:desc";const N=je("token"),{data:X}=([A,z]=ze(async()=>Le(async()=>{let t=[];c().loading_full=!0;const{data:e,error:h,status:T}=await j("/standby_msts",{method:"get",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},params:{filter_status:f},retry:0});return c().loading_full=!1,T.value==="error"?(E().trigger(h),{standby_msts:t}):(t=e.value.data,{standby_msts:t})},"$rczbThuP8g")),A=await A,z(),A),o=n(X.value.standby_msts);n("");const I=n({field:"created_at",by:"desc"}),a=n(-1),m=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),d=g(()=>o.value[a.value]),ee=()=>{i.like="";let t=JSON.parse(JSON.stringify(c()._tv.global_keyword));t!=""&&(i.like=`id:%${t}%,name:%${t}%,amount:%${t}%`),i.sort="",I.value.field&&(i.sort=I.value.field+":"+I.value.by),i.filter_model=JSON.stringify(c()._tv.filter_model)};n(null);const H=async()=>{c().loading_full=!0,m.value.may_get_data=!1,i.page=m.value.page,i.page==1&&(o.value=[]),i.first_row&&delete i.first_row,i.page>1&&(i.first_row=JSON.stringify(o.value[0])),i.filter_status=f.value;const{data:t,error:e,status:h}=await j("/standby_msts",{method:"get",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},params:i,retry:0});if(c().loading_full=!1,m.value.may_get_data=!0,h.value==="error"){E().trigger(e);return}m.value.page==1?o.value=t.value.data:m.value.page>1&&(o.value=[...o.value,...t.value.data]),t.value.data.length==0&&(m.value.is_last_record=!0),c()._tv.filter_box=!1},Y=()=>{a.value=-1,m.value.page=1,m.value.is_last_record=!1,ee(),H()},P=n(!1),$=n(0),b=n(0),k=n(-1),te=()=>{$.value=0,k.value=-1,b.value=!1,P.value=!0},{display:w}=Z();He(Z());const ae=()=>{a.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):($.value=o.value[a.value].id,k.value=-1,b.value=!1,P.value=!0)},le=()=>{a.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):($.value=o.value[a.value].id,k.value=-1,b.value=!0,P.value=!0)},S=n(!1),F=n(0),se=()=>{a.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=o.value[a.value].id,k.value=1,b.value=!1,S.value=!0)},oe=()=>{a.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=o.value[a.value].id,k.value=0,b.value=!1,S.value=!0)},ne=()=>{a.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=o.value[a.value].id,k.value=-1,b.value=!1,S.value=!0)},V=n(!1),L=n({}),O=n(!1),D=n(""),ie=async()=>{O.value&&(O.value=!1)},re=()=>{a.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(D.value="",L.value={id:o.value[a.value].id},O.value=!0)};K(()=>D.value,t=>{t.trim().length>0?V.value=!0:V.value=!1},{immediate:!1});const ue=async()=>{c().loading_full=!0;const t=new FormData;t.append("id",o.value[a.value].id),t.append("deleted_reason",D.value),t.append("_method","DELETE");const{data:e,error:h,status:T}=await j("/standby_mst",{method:"post",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},body:t,retry:0});if(c().loading_full=!1,T.value==="error"){E().trigger(h);return}let p={...o.value[a.value]};p.deleted=e.value.deleted,p.deleted_user=e.value.deleted_user,p.deleted_at=e.value.deleted_at,p.deleted_by=e.value.deleted_by,p.deleted_reason=e.value.deleted_reason,f.value!="all"?o.value.splice(a.value,1):o.value.splice(a.value,1,{...p}),a.value=-1,O.value=!1},de=n([{key:"no",label:"No",isai:!0},{key:"valx",label:"APP",childs:[{key:"val",label:"Kasir",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val1",label:"Logistik",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]}]},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"name",label:"Nama",freeze:1,filter_on:1,type:"string",sort:{priority:1,type:"asc"}},{key:"tipe",label:"Tipe",filter_on:1,type:"string"},{key:"amount",label:"Amount",class:" justify-end",type:"number"},{key:"is_transition",label:"Peralihan",filter_on:1,type:"select",select_item:[{k:"1",v:"Ya"},{k:"0",v:"Tidak"}]},{key:"is_trip",label:"Trip",filter_on:1,type:"select",select_item:[{k:"1",v:"Ya"},{k:"0",v:"Tidak"}]},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]),_e=g(()=>a.value>-1&&[void 0,0].indexOf(d.value.deleted)>-1&&v().checkPermission("standby_mst.create")),me=g(()=>["available","all","unapprove"].indexOf(f.value)>-1&&v().checkPermission("standby_mst.create")),ve=g(()=>a.value>-1&&[void 0,0].indexOf(d.value.deleted)>-1&&(v().checkPermission("standby_mst.val")&&[void 0,0].indexOf(d.value.val)>-1||v().checkPermission("standby_mst.val1")&&[void 0,0].indexOf(d.value.val1)>-1)&&v().checkPermissions(["standby_mst.modify"])),ce=g(()=>a.value>-1&&[void 0,0].indexOf(d.value.deleted)>-1&&(v().checkPermission("standby_mst.val")&&[void 0,0].indexOf(d.value.val)>-1||v().checkPermission("standby_mst.val1")&&[void 0,0].indexOf(d.value.val1)>-1)),fe=g(()=>a.value>-1&&[void 0,0].indexOf(d.value.deleted)>-1&&(v().checkPermission("standby_mst.unval")&&[1].indexOf(d.value.val)>-1||v().checkPermission("standby_mst.unval1")&&[1].indexOf(d.value.val1)>-1)),pe=g(()=>a.value>-1&&v().checkPermission("standby_mst.remove")&&[void 0,0].indexOf(d.value.deleted)>-1);return(t,e)=>{const h=Pe,T=Se,p=Oe,ye=Te,be=Ae,ke=$e,he=Fe,ge=Me,J=Be,R=Ne,xe=Ie,we=Ve,De=Ee,Ce=Ue;return u(),y("div",Re,[r(h,{title:"List Standby"}),_("div",qe,[_("div",Ke,[_("div",Ze,[_("div",Ge,[G(_("select",{"aria-label":"Filter Status","onUpdate:modelValue":e[0]||(e[0]=l=>Q(f)?f.value=l:null)},tt,512),[[Ye,s(f)]])]),s(_e)?(u(),y("button",{key:0,type:"button",name:"button","aria-label":"Copy Data",class:"m-1 text-2xl",onClick:e[1]||(e[1]=l=>le())},[r(T)])):x("",!0),s(me)?(u(),y("button",{key:1,type:"button",name:"button","aria-label":"New Form",class:"m-1 text-2xl",onClick:e[2]||(e[2]=l=>te())},[r(p)])):x("",!0),s(ve)?(u(),y("button",{key:2,type:"button",name:"button","aria-label":"Edit Form",class:"m-1 text-2xl",onClick:e[3]||(e[3]=l=>ae())},[r(ye)])):x("",!0),s(a)>-1?(u(),y("button",{key:3,type:"button",name:"button","aria-label":"View Form",class:"m-1 text-2xl",onClick:e[4]||(e[4]=l=>ne())},[r(be)])):x("",!0),s(pe)?(u(),y("button",{key:4,type:"button",name:"button","aria-label":"Delete Data",class:"m-1 text-2xl",onClick:e[5]||(e[5]=l=>re())},[r(ke)])):x("",!0),s(ce)?(u(),y("button",{key:5,type:"button",name:"button","aria-label":"Validate Data",class:"m-1 text-2xl",onClick:e[6]||(e[6]=l=>se())},[r(he)])):x("",!0),s(fe)?(u(),y("button",{key:6,type:"button",name:"button","aria-label":"Unvalidate Data",class:"m-1 text-2xl",onClick:e[7]||(e[7]=l=>oe())},[r(ge)])):x("",!0)])]),r(xe,{thead:s(de),selected:s(a),onSetSelected:e[8]||(e[8]=l=>a.value=l),tbody:s(o),fnCallData:H,scrolling:s(m),onSetScrollingPage:e[9]||(e[9]=l=>s(m).page=l),onDoFilter:e[10]||(e[10]=l=>Y()),rowBgColor:W},{val:C(({item:l})=>[l.val?(u(),M(R,{key:1})):(u(),M(J,{key:0}))]),val1:C(({item:l})=>[l.val1?(u(),M(R,{key:1})):(u(),M(J,{key:0}))]),is_transition:C(({item:l})=>[B(U(l.is_transition?"Ya":"Tidak"),1)]),is_trip:C(({item:l})=>[B(U(l.is_trip?"Ya":"Tidak"),1)]),deleted_by_username:C(({item:l})=>{var q;return[B(U((q=l.deleted_by)==null?void 0:q.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])]),r(we,{type:"delete",show:s(O),data:s(L),fnClose:ie,fnConfirm:ue,enabledOk:s(V)},{footer:C(()=>[B(" Masukkan Alasan Penghapusan: "),_("div",at,[G(_("textarea",{"onUpdate:modelValue":e[11]||(e[11]=l=>Q(D)?D.value=l:null)},null,512),[[Je,s(D)]])])]),_:1},8,["show","data","enabledOk"]),r(De,{show:s(P),fnClose:()=>{P.value=!1},id:s($),p_data:s(o),is_copy:s(b)},null,8,["show","fnClose","id","p_data","is_copy"]),r(Ce,{show:s(S),fnClose:()=>{S.value=!1},id:s(F),p_data:s(o),it_state:s(k)},null,8,["show","fnClose","id","p_data","it_state"])])}}};export{Ut as default};
