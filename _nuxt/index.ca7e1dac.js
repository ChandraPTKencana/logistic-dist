import Ce from"./Header.e3b30412.js";import $e from"./Plus.5d59a214.js";import Pe from"./Edit.c4f7cd1c.js";import Ae from"./Eyes.f34ec855.js";import Oe from"./Delete.cbeec940.js";import Te from"./Signature.491719ff.js";import Me from"./SignatureOff.1e0d38b4.js";import Be from"./Line.368420c0.js";import Ie from"./Check.0e1d49d7.js";import Ne from"./TypeIcon.d3c484b5.js";import je from"./TableView.0615b6c7.js";import{_ as Fe}from"./PopupMini.vue.bb8b380b.js";import Ee from"./employee.f648b6e7.js";import ze from"./employee_validasi.19b7b179.js";import{r as n,f as G,g as Ve,h as He,i as b,B as Je,j as Q,s as Re,c as k,a as i,b as r,k as W,v as Le,l as o,m as X,n as w,w as D,F as Ue,q as Ye,x as p,y as V,o as u,z as B,d as H,t as ee,A as Ke,p as qe,e as Ze}from"./entry.6ca1c6bc.js";import{u as J}from"./useMyFetch.e2f36d6a.js";import{u as c}from"./useUtils.629df00e.js";import{_ as Ge}from"./_plugin-vue_export-helper.c27b6911.js";import"./DocJPEG.7e47d608.js";import"./DocJPG.a42e7615.js";import"./DocPNG.399f0a6f.js";import"./DocPDF.c54ecfe0.js";import"./Search.d308af9e.js";import"./Adjust.b588b61f.js";import"./TableHeaderEye.0e9e2a1a.js";import"./Times.9b59cca5.js";import"./ClearAll.6d41149f.js";import"./client-only.5b47db8e.js";import"./ClearEach.e200ae37.js";import"./CaretLeftDoubleBold.5934e0e0.js";import"./CaretLeftBold.a762378e.js";import"./CaretRightBold.c4b0eac0.js";import"./CaretRightDoubleBold.7d93484e.js";import"./Exclamation.65a33820.js";import"./HeaderPopup.vue.145d40e0.js";import"./InputPointFormat.vue.20ce3e53.js";import"./AttachmentSingle.c7eda898.js";import"./PDFJsView.687b62a9.js";const I=A=>(qe("data-v-880eb7cc"),A=A(),Ze(),A),Qe={class:"w-full h-full flex flex-col"},We={class:"w-full flex grow flex-col overflow-auto h-0"},Xe={class:"w-full flex justify-between flex-wrap"},et={class:"grow flex"},tt={class:"m-1"},lt=I(()=>i("option",{value:"available"},"Available",-1)),at=I(()=>i("option",{value:"unapprove"},"Unapprove",-1)),ot=I(()=>i("option",{value:"deleted"},"Trash",-1)),st=I(()=>i("option",{value:"all"},"All",-1)),nt=[lt,at,ot,st],rt={class:"grow mb-5"},it={__name:"index",async setup(A){let O,R;const te=e=>e.deleted==1?"!bg-red-400":e.val==0||e.val1==0?"!bg-gray-300":"",f=n("available");G(()=>f.value,e=>{Y()},{immediate:!1});const d={};d._TimeZoneOffset=new Date().getTimezoneOffset();const N=Ve("token"),{data:s}=([O,R]=He(async()=>Ye(async()=>{p().loading_full=!0;const{data:e,error:t,status:y}=await J("/employees",{method:"get",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},params:{filter_status:f},retry:0});return p().loading_full=!1,y.value==="error"?(V().trigger(t),[]):e.value.data},"$p5jj5crAgd")),O=await O,R(),O),j=n({field:"",by:"desc"}),l=n(-1),_=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),m=b(()=>s.value[l.value]),le=()=>{d.like="";let e=JSON.parse(JSON.stringify(p()._tv.global_keyword));e!=""&&(d.like=`id:%${e}%,name:%${e}%,ktp_no:%${e}%,sim_no:%${e}%,phone_number:%${e}%,rek_no:%${e}%`),d.sort="",j.value.field&&(d.sort=j.value.field+":"+j.value.by),d.filter_model=JSON.stringify(p()._tv.filter_model)},L=n(null),U=async()=>{p().loading_full=!0,_.value.may_get_data=!1,d.page=_.value.page,d.page==1&&(s.value=[]),d.filter_status=f.value;const{data:e,error:t,status:y}=await J("/employees",{method:"get",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},params:d,retry:0});if(p().loading_full=!1,_.value.may_get_data=!0,y.value==="error"){V().trigger(t);return}_.value.page==1?(s.value=e.value.data,L.value&&(L.value.scrollTop=0)):_.value.page>1&&(s.value=[...s.value,...e.value.data]),e.value.data.length==0&&(_.value.is_last_record=!0),p()._tv.filter_box=!1},Y=()=>{l.value=-1,_.value.page=1,_.value.is_last_record=!1,le(),U()};Je();const T=n(!1),F=n(0),g=n(0),h=n(1),ae=()=>{F.value=0,h.value=-1,g.value=!1,T.value=!0},{display:S}=Q();Re(Q());const oe=()=>{l.value==-1?S({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=s.value[l.value].id,h.value=-1,g.value=!1,T.value=!0)},C=n(!1),M=n(0),se=()=>{l.value==-1?S({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(M.value=s.value[l.value].id,h.value=1,g.value=!1,C.value=!0)},ne=()=>{l.value==-1?S({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(M.value=s.value[l.value].id,h.value=0,g.value=!1,C.value=!0)},re=()=>{l.value==-1?S({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(M.value=s.value[l.value].id,g.value=!1,h.value=-1,C.value=!0)},E=n(!1),K=n({}),$=n(!1),x=n(""),ie=async()=>{$.value&&($.value=!1)},ue=()=>{l.value==-1?S({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(x.value="",K.value={id:s.value[l.value].id},$.value=!0)};G(()=>x.value,e=>{e.trim().length>0?E.value=!0:E.value=!1},{immediate:!1});const de=async()=>{p().loading_full=!0;const e=new FormData;e.append("id",s.value[l.value].id),e.append("deleted_reason",x.value),e.append("_method","DELETE");const{data:t,error:y,status:z}=await J("/employee",{method:"post",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},body:e,retry:0});if(p().loading_full=!1,z.value==="error"){V().trigger(y);return}let v={...s.value[l.value]};v.deleted=t.value.deleted,v.deleted_user=t.value.deleted_user,v.deleted_at=t.value.deleted_at,v.deleted_by=t.value.deleted_by,v.deleted_reason=t.value.deleted_reason,f.value!="all"?s.value.splice(l.value,1):s.value.splice(l.value,1,{...v}),l.value=-1,$.value=!1},_e=n([{key:"no",label:"No",isai:!0},{key:"val",label:"App 1",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"id",label:"ID",freeze:1,filter_on:1,type:"number"},{key:"name",label:"Nama",freeze:1,freeze_left:"44px",filter_on:1,type:"string",sort:{priority:1,type:"asc"}},{key:"role",label:"Jabatan",filter_on:1,type:"string"},{key:"ktp_no",label:"No KTP",filter_on:1,type:"string"},{key:"sim_no",label:"No SIM",filter_on:1,type:"string"},{key:"bank_code",label:"Nama Bank",filter_on:1,type:"string"},{key:"rek_no",label:"No Rek",filter_on:1,type:"string"},{key:"rek_name",label:"Nama Rek",filter_on:1,type:"string"},{key:"phone_number",label:"No Tlp",filter_on:1,type:"string"},{key:"birth_place",label:"Tempat Lahir",filter_on:1,type:"string"},{key:"birth_date",label:"Tanggal Lahir",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"tmk",label:"TMK",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"address",label:"Alamat",filter_on:1,type:"string"},{key:"status",label:"Status",filter_on:1,type:"string"},{key:"attachment_1_type",label:"File",type:"string"},{key:"bpjs_kesehatan",label:"BPJS Kesehatan",class:" justify-end",type:"number",filter_on:1},{key:"bpjs_jamsos",label:"BPJS Jamsos",class:" justify-end",type:"number",filter_on:1},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]);b(()=>l.value>-1&&[void 0,0].indexOf(m.value.deleted)>-1&&c().checkPermission("employee.create"));const me=b(()=>["available","all","unapprove"].indexOf(f.value)>-1&&c().checkPermission("employee.create")),pe=b(()=>l.value>-1&&[void 0,0].indexOf(m.value.deleted)>-1&&(c().checkPermission("employee.val")&&[void 0,0].indexOf(m.value.val)>-1||c().checkPermission("employee.val1")&&[void 0,0].indexOf(m.value.val1)>-1)&&c().checkPermissions(["employee.modify","employee.detail.modify","employee.detail2.modify"])),ce=b(()=>l.value>-1&&[void 0,0].indexOf(m.value.deleted)>-1&&(c().checkPermission("employee.val")&&[void 0,0].indexOf(m.value.val)>-1||c().checkPermission("employee.val1")&&[void 0,0].indexOf(m.value.val1)>-1)),fe=b(()=>l.value>-1&&[void 0,0].indexOf(m.value.deleted)>-1&&c().checkPermission("employee.unval")&&[1].indexOf(m.value.val)>-1),ve=b(()=>l.value>-1&&c().checkPermission("employee.remove")&&[void 0,0].indexOf(m.value.deleted)>-1);return(e,t)=>{const y=Ce,z=$e,v=Pe,ye=Ae,be=Oe,ke=Te,ge=Me,q=Be,Z=Ie,he=Ne,xe=je,we=Fe,De=Ee,Se=ze;return u(),k(Ue,null,[i("div",Qe,[r(y,{title:"List Employee"}),i("div",We,[i("div",Xe,[i("div",et,[i("div",tt,[W(i("select",{class:"","onUpdate:modelValue":t[0]||(t[0]=a=>X(f)?f.value=a:null)},nt,512),[[Le,o(f)]])]),o(me)?(u(),k("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=a=>ae())},[r(z)])):w("",!0),o(pe)?(u(),k("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=a=>oe())},[r(v)])):w("",!0),o(l)>-1?(u(),k("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[3]||(t[3]=a=>re())},[r(ye)])):w("",!0),o(ve)?(u(),k("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[4]||(t[4]=a=>ue())},[r(be)])):w("",!0),o(ce)?(u(),k("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[5]||(t[5]=a=>se())},[r(ke)])):w("",!0),o(fe)?(u(),k("button",{key:5,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[6]||(t[6]=a=>ne())},[r(ge)])):w("",!0)])]),r(xe,{thead:o(_e),selected:o(l),onSetSelected:t[7]||(t[7]=a=>l.value=a),tbody:o(s),fnCallData:U,scrolling:o(_),onSetScrollingPage:t[8]||(t[8]=a=>o(_).page=a),onDoFilter:t[9]||(t[9]=a=>Y()),rowBgColor:te},{val:D(({item:a})=>[a.val?(u(),B(Z,{key:1})):(u(),B(q,{key:0}))]),val1:D(({item:a})=>[a.val1?(u(),B(Z,{key:1})):(u(),B(q,{key:0}))]),bank_code:D(({item:a})=>{var P;return[H(ee((P=a.bank)==null?void 0:P.code),1)]}),attachment_1_type:D(({item:a})=>[r(he,{value:a.attachment_1_type},null,8,["value"])]),deleted_by_username:D(({item:a})=>{var P;return[H(ee((P=a.deleted_by)==null?void 0:P.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])])]),r(we,{type:"delete",show:o($),data:o(K),fnClose:ie,fnConfirm:de,enabledOk:o(E)},{footer:D(()=>[H(" Masukkan Alasan Penghapusan: "),i("div",rt,[W(i("textarea",{"onUpdate:modelValue":t[10]||(t[10]=a=>X(x)?x.value=a:null)},null,512),[[Ke,o(x)]])])]),_:1},8,["show","data","enabledOk"]),r(De,{show:o(T),fnClose:()=>{T.value=!1},id:o(F),p_data:o(s),is_copy:o(g)},null,8,["show","fnClose","id","p_data","is_copy"]),r(Se,{show:o(C),fnClose:()=>{C.value=!1},id:o(M),p_data:o(s),it_state:o(h)},null,8,["show","fnClose","id","p_data","it_state"])],64)}}},Kt=Ge(it,[["__scopeId","data-v-880eb7cc"]]);export{Kt as default};
