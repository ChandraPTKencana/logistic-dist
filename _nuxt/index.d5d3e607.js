import De from"./Header.9afe217e.js";import Se from"./Plus.4743b2ce.js";import Ae from"./Edit.071e0c88.js";import Ce from"./Eyes.b44fc1ab.js";import Pe from"./Delete.b643154f.js";import Oe from"./Signature.2a47c587.js";import $e from"./Table2Column.333f685b.js";import Te from"./Line.608cfb17.js";import Me from"./Check.57fd5950.js";import Be from"./TypeIcon.1cea1e23.js";import Ne from"./TableView.65785b3b.js";import{_ as Fe}from"./PopupMini.vue.498d7ed1.js";import Ie from"./salary_bonus.6bc5c85a.js";import Ve from"./salary_bonus_validasi.1bc0a098.js";import{r,f as K,g as je,h as Ee,i as O,j as Z,s as Ue,c as w,b as d,a as u,k as Q,v as ze,l,m as W,n as $,d as k,w as m,q as He,x as p,y as I,o as _,z as x,t as D,A as Je}from"./entry.e56859e6.js";import{u as g}from"./useUtils.2b82e95a.js";import{u as V}from"./useMyFetch.3d0a045f.js";import{u as Le}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./DocJPEG.8776e127.js";import"./DocJPG.e35a43cf.js";import"./DocPNG.95c63089.js";import"./DocPDF.6ca974eb.js";import"./Search.7f824c2a.js";import"./Adjust.48e00cd9.js";import"./TableHeaderEye.bfb9ecf7.js";import"./Times.cab95edf.js";import"./ClearAll.009fd8f2.js";import"./client-only.7a002eb3.js";import"./ClearEach.1d03ff3e.js";import"./CaretLeftDoubleBold.b9f5664a.js";import"./CaretLeftBold.d633bfed.js";import"./CaretRightBold.6c52dec7.js";import"./CaretRightDoubleBold.248d094c.js";import"./Exclamation.bfc55307.js";import"./HeaderPopup.vue.f506d3a2.js";import"./WidthMiniList.vue.b440ad31.js";import"./WidthMiniPart.vue.f571fff1.js";import"./InputPointFormat.vue.b706f010.js";import"./AttachmentSingle.d722fc0c.js";import"./PDFJsView.84e4f052.js";const Re={class:"w-full h-full flex flex-col"},Ye={class:"w-full flex grow flex-col overflow-auto h-0"},qe={class:"w-full flex justify-between flex-wrap"},Ge={class:"grow flex"},Ke={class:"m-1"},Ze=u("option",{value:"undone"},"Undone",-1),Qe=u("option",{value:"done"},"Done",-1),We=u("option",{value:"deleted"},"Trash",-1),Xe=u("option",{value:"all"},"All",-1),et=[Ze,Qe,We,Xe],tt=u("span",{class:"text-xs ml-1"}," Download ",-1),at={style:{"min-width":"350px","text-wrap":"wrap"}},lt={class:"grow mb-5"},qt={__name:"index",async setup(ot){let T,L;const X=a=>a.deleted==1?"!bg-red-400":a.val1>0&&a.val2>0&&a.val3>0&&a.salary_paid_id>0?"!bg-blue-300":"",v=r("undone");K(()=>v.value,a=>{q()},{immediate:!1});const s={};s._TimeZoneOffset=new Date().getTimezoneOffset(),s.sort="created_at:desc";const M=je("token"),{data:ee}=([T,L]=Ee(async()=>He(async()=>{let a=[];p().loading_full=!0;const{data:e,error:f,status:P}=await V("/salary_bonuses",{method:"get",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},params:{filter_status:v},retry:0});return p().loading_full=!1,P.value==="error"?(I().trigger(f),{salary_bonuses:a}):(a=e.value.data,{salary_bonuses:a})},"$tya7A7egnO")),T=await T,L(),T),n=r(ee.value.salary_bonuses);r("");const j=r({field:"created_at",by:"desc"}),o=r(-1),y=O(()=>n.value[o.value]),c=r({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),R=()=>{s.like="";let a=JSON.parse(JSON.stringify(p()._tv.global_keyword));a!=""&&(s.like=`id:%${a}%,employee_name:%${a}%`),s.sort="",j.value.field&&(s.sort=j.value.field+":"+j.value.by),s.filter_model=JSON.stringify(p()._tv.filter_model)},Y=async()=>{p().loading_full=!0,c.value.may_get_data=!1,s.page=c.value.page,s.page==1&&(n.value=[]),s.first_row&&delete s.first_row,s.page>1&&(s.first_row=JSON.stringify(n.value[0])),s.filter_status=v.value;const{data:a,error:e,status:f}=await V("/salary_bonuses",{method:"get",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},params:s,retry:0});if(p().loading_full=!1,c.value.may_get_data=!0,f.value==="error"){I().trigger(e);return}c.value.page==1?n.value=a.value.data:c.value.page>1&&(n.value=[...n.value,...a.value.data]),a.value.data.length==0&&(c.value.is_last_record=!0),p()._tv.filter_box=!1},q=()=>{o.value=-1,o.value=-1,c.value.page=1,c.value.is_last_record=!1,R(),Y()},B=r(!1),E=r(0),S=r(0),A=r(!1),te=()=>{E.value=0,A.value=!1,S.value=!1,B.value=!0},{display:N}=Z();Ue(Z());const ae=()=>{o.value==-1?N({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(E.value=n.value[o.value].id,A.value=!1,S.value=!1,B.value=!0)},F=r(!1),U=r(0),le=()=>{o.value==-1?N({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(U.value=n.value[o.value].id,A.value=!1,S.value=!1,F.value=!0)},oe=()=>{o.value==-1?N({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(U.value=n.value[o.value].id,A.value=!0,S.value=!1,F.value=!0)},z=r(!1),G=r({}),C=r(!1),h=r(""),se=async()=>{C.value&&(C.value=!1)},ne=()=>{o.value==-1?N({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(h.value="",G.value={id:n.value[o.value].id},C.value=!0)};K(()=>h.value,a=>{a.trim().length>0?z.value=!0:z.value=!1},{immediate:!1});const re=async()=>{p().loading_full=!0;const a=new FormData;a.append("id",n.value[o.value].id),a.append("deleted_reason",h.value),a.append("_method","DELETE");const{data:e,error:f,status:P}=await V("/salary_bonus",{method:"post",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},body:a,retry:0});if(p().loading_full=!1,P.value==="error"){I().trigger(f);return}let b={...n.value[o.value]};b.deleted=e.value.deleted,b.deleted_user=e.value.deleted_user,b.deleted_at=e.value.deleted_at,b.deleted_by=e.value.deleted_by,b.deleted_reason=e.value.deleted_reason,v.value!="all"?n.value.splice(o.value,1):n.value.splice(o.value,1,{...b}),o.value=-1,C.value=!1},ie=r([{key:"no",label:"No",isai:!0},{key:"val",label:"APP",childs:[{key:"val1",label:"Staff",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val2",label:"SPV",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val3",label:"MGR",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]}]},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"tanggal",label:"Tanggal",type:"date",dateformat:"DD-MM-Y",filter_on:1,sort:{priority:1,type:"desc"}},{key:"type",label:"Tipe",filter_on:1,type:"string"},{key:"employee_name",label:"Nama",freeze:1,filter_on:1,type:"string"},{key:"employee_ktp_no",label:"No KTP",filter_on:1,type:"string"},{key:"employee_sim_no",label:"No SIM",filter_on:1,type:"string"},{key:"nominal",label:"Nominal",class:" justify-end",type:"number"},{key:"note",label:"Note",filter_on:1,type:"string"},{key:"attachment_1_type",label:"File",filter_on:1,type:"string"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]),ue=O(()=>["undone","all"].indexOf(v.value)>-1&&g().checkPermission("salary_bonus.create")),de=O(()=>o.value>-1&&[void 0,0].indexOf(y.value.deleted)>-1&&(g().checkPermission("salary_bonus.val1")&&[void 0,0,1].indexOf(y.value.val1)>-1||g().checkPermission("salary_bonus.val2")&&[void 0,0].indexOf(y.value.val2)>-1)&&g().checkPermissions(["salary_bonus.modify"])),_e=O(()=>o.value>-1&&[void 0,0].indexOf(y.value.deleted)>-1&&(g().checkPermission("salary_bonus.val1")&&[void 0,0].indexOf(y.value.val1)>-1||g().checkPermission("salary_bonus.val2")&&[void 0,0].indexOf(y.value.val2)>-1||g().checkPermission("salary_bonus.val3")&&[void 0,0].indexOf(y.value.val3)>-1)),me=O(()=>o.value>-1&&g().checkPermission("salary_bonus.remove")&&[void 0,0].indexOf(y.value.deleted)>-1),{downloadFile:pe,viewFile:st}=Le(),ce=async()=>{R(),p().loading_full=!0,s.filter_status=v.value;const{data:a,error:e,status:f}=await V("/salary_bonus/download_excel",{method:"get",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},params:s,retry:0});if(p().loading_full=!1,f.value==="error"){I().trigger(e);return}pe(a.value)};return(a,e)=>{const f=De,P=Se,b=Ae,ve=Ce,fe=Pe,ye=Oe,be=$e,H=Te,J=Me,ge=Be,ke=Ne,he=Fe,we=Ie,xe=Ve;return _(),w("div",Re,[d(f,{title:"List Salary Additional"}),u("div",Ye,[u("div",qe,[u("div",Ge,[u("div",Ke,[Q(u("select",{class:"","onUpdate:modelValue":e[0]||(e[0]=t=>W(v)?v.value=t:null)},et,512),[[ze,l(v)]])]),l(ue)?(_(),w("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[1]||(e[1]=t=>te())},[d(P)])):$("",!0),l(de)?(_(),w("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[2]||(e[2]=t=>ae())},[d(b)])):$("",!0),l(o)>-1?(_(),w("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[3]||(e[3]=t=>oe())},[d(ve)])):$("",!0),l(me)?(_(),w("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[4]||(e[4]=t=>ne())},[d(fe)])):$("",!0),l(_e)?(_(),w("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[5]||(e[5]=t=>le())},[d(ye)])):$("",!0),u("button",{type:"button",name:"button",class:"m-1 text-2xl flex items-center",onClick:e[6]||(e[6]=t=>ce())},[d(be),k(),tt])])]),d(ke,{thead:l(ie),selected:l(o),onSetSelected:e[7]||(e[7]=t=>o.value=t),tbody:l(n),fnCallData:Y,scrolling:l(c),onSetScrollingPage:e[8]||(e[8]=t=>l(c).page=t),onDoFilter:e[9]||(e[9]=t=>q()),rowBgColor:X},{val1:m(({item:t})=>[t.val1?(_(),x(J,{key:1})):(_(),x(H,{key:0}))]),val2:m(({item:t})=>[t.val2?(_(),x(J,{key:1})):(_(),x(H,{key:0}))]),val3:m(({item:t})=>[t.val3?(_(),x(J,{key:1})):(_(),x(H,{key:0}))]),employee_name:m(({item:t})=>{var i;return[k(D((i=t.employee)==null?void 0:i.name),1)]}),employee_ktp_no:m(({item:t})=>{var i;return[k(D((i=t.employee)==null?void 0:i.ktp_no),1)]}),employee_sim_no:m(({item:t})=>{var i;return[k(D((i=t.employee)==null?void 0:i.sim_no),1)]}),note:m(({item:t})=>[u("div",at,D(t.note),1)]),attachment_1_type:m(({item:t})=>[d(ge,{value:t.attachment_1_type},null,8,["value"])]),deleted_by_username:m(({item:t})=>{var i;return[k(D((i=t.deleted_by)==null?void 0:i.username),1)]}),req_deleted_by_username:m(({item:t})=>{var i;return[k(D((i=t.req_deleted_by)==null?void 0:i.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])]),d(he,{type:"delete",show:l(C),data:l(G),fnClose:se,fnConfirm:re,enabledOk:l(z)},{footer:m(()=>[k(" Masukkan Alasan Penghapusan: "),u("div",lt,[Q(u("textarea",{"onUpdate:modelValue":e[10]||(e[10]=t=>W(h)?h.value=t:null)},null,512),[[Je,l(h)]])])]),_:1},8,["show","data","enabledOk"]),d(we,{show:l(B),fnClose:()=>{B.value=!1},id:l(E),p_data:l(n),is_copy:l(S)},null,8,["show","fnClose","id","p_data","is_copy"]),d(xe,{show:l(F),fnClose:()=>{F.value=!1},id:l(U),p_data:l(n),is_view:l(A)},null,8,["show","fnClose","id","p_data","is_view"])])}}};export{qt as default};
