import{_ as I}from"./HeaderPopup.vue.7637dd55.js";import{r as x,g as P,i as Y,f as H,k as U,K as E,o as r,c as u,a as e,b as R,t as l,l as s,d as $,F as S,D as O,E as b,n as f,C as T,G,x as h,y as D,p as K,e as L}from"./entry.11d2f466.js";import{u as J}from"./useUtils.c0fae8e9.js";import{u as V}from"./useMyFetch.d91d84b6.js";import{_ as Q}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.ac9ba064.js";const c=d=>(K("data-v-069c679e"),d=d(),L(),d),W={class:"box-fixed"},X={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},Z={class:"w-full flex flex-col items-center grow overflow-auto"},ee={class:"w-full flex flex-row flex-wrap"},te={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},se=c(()=>e("label",{for:""},"Name",-1)),ae={class:"card-border"},le={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},oe=c(()=>e("label",{for:""},"Tipe",-1)),ie={class:"card-border"},ne={class:"w-full sm:w-4/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},ce=c(()=>e("label",{for:""},"Amount",-1)),de={class:"card-border"},re={class:"w-1/2 sm:w-4/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},ue=c(()=>e("label",{for:""},"Peralihan?",-1)),_e={class:"card-border !flex flex-row items-center"},ve=["checked"],fe={class:"w-full ml-1"},me={class:"text-red-500"},pe={class:"w-1/2 sm:w-4/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},he=c(()=>e("label",{for:""},"Trip?",-1)),we={class:"card-border !flex flex-row items-center"},xe=["checked"],be={class:"w-full ml-1"},ye={class:"text-red-500"},ge={class:"w-full flex grow p-1 2xl:overflow-hidden justify-between flex-wrap"},ke={class:"w-full",role:"sticky"},Ae={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},Ce=c(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"7",class:"!bg-slate-800 text-white font-bold"}," Detail PVR ")],-1)),De={class:"sticky top-8 !z-[2]"},Ve=c(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),je=c(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),Fe=c(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),Ne=c(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),Ye=c(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),$e={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Se=c(()=>e("br",null,null,-1)),Te={class:"text-sm"},Be=c(()=>e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"For",-1)),Me={ref:"to_move"},qe=["data-index"],ze={class:"w-full h-auto flex items-center justify-center"},Ie={class:"w-full h-auto flex items-center justify-center"},Pe={class:"w-full h-auto flex items-center justify-center"},He={key:0,class:"cell"},Ue={class:"w-full h-auto flex items-center justify-center"},Ee={class:"w-full h-auto flex items-center justify-center"},Re={class:"w-full flex items-center justify-end"},Oe={class:"w-full flex flex-wrap p-3 items-center"},Ge=c(()=>e("div",null," Di Validasi oleh : ",-1)),Ke={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},Le={key:0},Je={key:1},Qe={__name:"standby_mst_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},it_state:{type:Number,required:!1,default:-1}},setup(d){const n=d,{$moment:j}=G(),{pointFormat:y}=J(),t=x({...{id:-1,name:"",tipe:"",is_transition:!1,amount:0,details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:""}}),g=P("token"),m=x({}),F=x(null),N=x(null),k=x([]),B=async()=>{h().loading_full=!0,m.value={};const o=new FormData;let i="post",_=n.id;_==0||(o.append("id",_),o.append("_method","PUT"));const{data:a,error:v,status:A}=await V("/standby_mst_validasi",{method:i,headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},body:o,retry:0});if(h().loading_full=!1,A.value==="error"){D().trigger(v,m);return}t.value.val=a.value.val,t.value.val_user=a.value.val_user,t.value.val_by=a.value.val_by,t.value.val_at=a.value.val_at,t.value.val1=a.value.val1,t.value.val1_user=a.value.val1_user,t.value.val1_by=a.value.val1_by,t.value.val1_at=a.value.val1_at;let w=n.p_data.map(C=>C.id).indexOf(n.id);w>=-1&&n.p_data.splice(w,1,{...t.value}),n.fnClose()},M=async()=>{h().loading_full=!0,m.value={};const o=new FormData;let i="post",_=n.id;_==0||(o.append("id",_),o.append("_method","PUT"));const{data:a,error:v,status:A}=await V("/standby_mst_unvalidasi",{method:i,headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},body:o,retry:0});if(h().loading_full=!1,A.value==="error"){D().trigger(v,m);return}t.value.val=a.value.val,t.value.val_user=a.value.val_user,t.value.val_by=a.value.val_by,t.value.val_at=a.value.val_at,t.value.val1=a.value.val1,t.value.val1_user=a.value.val1_user,t.value.val1_by=a.value.val1_by,t.value.val1_at=a.value.val1_at;let w=n.p_data.map(C=>C.id).indexOf(n.id);w>=-1&&n.p_data.splice(w,1,{...t.value}),n.fnClose()},q=async()=>{h().loading_full=!0;const{data:o,error:i,status:_}=await V("/standby_mst",{method:"get",headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},params:{id:n.id},retry:0});if(h().loading_full=!1,_.value==="error"){D().trigger(i);return}t.value=o.value.data,k.value=o.value.data.details},z=Y(()=>{let o=0;return k.value.forEach(i=>{i.p_status!="Remove"&&(o+=parseInt(i.amount))}),o}),p=Y(()=>!1);return H(()=>n.show,(o,i)=>{o==!0&&(n.it_state==1&&setTimeout(()=>{F.value.focus()},1),n.it_state==0&&setTimeout(()=>{N.value.focus()},1),q())},{immediate:!0}),(o,i)=>{const _=I;return U((r(),u("section",W,[e("div",null,[R(_,{title:"Form Master Standby Validation",fn:d.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",X,[e("div",Z,[e("div",ee,[e("div",te,[se,e("div",ae,l(s(t).name),1)]),e("div",le,[oe,e("div",ie,l(s(t).tipe),1)]),e("div",ne,[ce,e("div",de,l(s(y)(s(t).amount||0)),1)]),e("div",re,[ue,e("div",_e,[e("input",{checked:s(t).is_transition,disabled:"disabled",type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded"},null,8,ve),e("label",fe,l(s(t).is_transition?"Ya":"Tidak"),1)]),e("p",me,l(s(m).is_transition),1)]),e("div",pe,[he,e("div",we,[e("input",{checked:s(t).is_trip,disabled:"disabled",type:"checkbox",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded"},null,8,xe),e("label",be,l(s(t).is_trip?"Ya":"Tidak"),1)]),e("p",ye,l(s(m).is_trip),1)])]),e("div",ge,[e("div",ke,[e("table",Ae,[e("thead",null,[Ce,e("tr",De,[Ve,je,Fe,Ne,Ye,e("th",$e,[$("Amount "),Se,$(),e("span",Te,"("+l(s(y)(s(z)))+")",1)]),Be])]),e("tbody",Me,[(r(!0),u(S,null,O(s(k),(a,v)=>(r(),u(S,{key:v},[a.p_status!="Remove"?(r(),u("tr",{key:0,"data-index":v},[e("td",null,l(v+1)+".",1),e("td",{class:b(["cell bold",s(p)?"unselectable":""])},[e("div",ze,l(a.ac_account_id),1)],2),e("td",{class:b(["cell bold",s(p)?"unselectable":""])},[e("div",Ie,l(a.ac_account_code),1)],2),e("td",{class:b(["cell bold",s(p)?"unselectable":""])},[e("div",Pe,l(a.ac_account_name),1)],2),s(p)?f("",!0):(r(),u("td",He,[e("div",Ue,l(a.description),1)])),e("td",{class:b(["cell bold",s(p)?"unselectable":""])},[e("div",Ee,l(s(y)(a.amount||0)),1)],2),e("td",{class:b(["cell",s(p)?"unselectable":""])},l(a.xfor),3)],8,qe)):f("",!0)],64))),128))],512)])])])]),e("div",Re,[e("div",Oe,[Ge,s(t).val||s(t).val1?(r(),u("div",Ke,[s(t).val?(r(),u("div",Le," App 1 : "+l(s(t).val_by.username)+" ( "+l(s(t).val_at?s(j)(s(t).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):f("",!0),s(t).val1?(r(),u("div",Je," App 2 : "+l(s(t).val1_by.username)+" ( "+l(s(t).val1_at?s(j)(s(t).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):f("",!0)])):f("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:i[0]||(i[0]=a=>d.fnClose())}," Cancel "),d.it_state==1?(r(),u("button",{key:0,ref_key:"it_val",ref:F,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:i[1]||(i[1]=T(a=>B(),["prevent"]))}," Validasi ",512)):f("",!0),d.it_state==0?(r(),u("button",{key:1,ref_key:"it_unval",ref:N,type:"submit",name:"button",class:"w-36 m-1 bg-yellow-600 text-white rounded-sm",onClick:i[2]||(i[2]=T(a=>M(),["prevent"]))}," Unvalidasi ",512)):f("",!0)])])])],512)),[[E,d.show]])}}},lt=Q(Qe,[["__scopeId","data-v-069c679e"]]);export{lt as default};
