import{_ as J}from"./HeaderPopup.vue.f45ac7d2.js";import{r as w,f as H,G as c,j as K,m as L,J as R,o as m,c as h,a as t,b as O,t as l,k as a,d as u,F as $,y as Q,l as y,x as W,E as X,A as x,B as q,p as Z,e as tt}from"./entry.56f613b3.js";import{u as at}from"./useUtils.e3bba0b1.js";import{u as I}from"./useMyFetch.76faeae6.js";import{_ as et}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.4fc43f42.js";const i=d=>(Z("data-v-c4334281"),d=d(),tt(),d),st={class:"box-fixed"},lt={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},ot={class:"w-full flex flex-col items-center grow overflow-auto"},nt={class:"w-full flex flex-row flex-wrap"},_t={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},rt=i(()=>t("label",{for:""},"Period End",-1)),ut={class:"card-border"},it={key:0,class:"w-full flex p-1 justify-between flex-wrap"},ct={class:"w-full",role:"sticky"},dt={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},pt=i(()=>t("tr",{class:"sticky -top-1 !z-[2]"},[t("td",{colspan:"21",class:"!bg-slate-800 text-white font-bold"}," Detail ")],-1)),mt={class:"sticky top-7 !z-[2]"},ht=i(()=>t("th",{rowspan:"2"},"No",-1)),vt=i(()=>t("th",{rowspan:"2"},"ID",-1)),ft=i(()=>t("th",{rowspan:"2"},"Nama Pekerja",-1)),yt=i(()=>t("th",{rowspan:"2"},"Jabatan",-1)),bt=i(()=>t("th",{rowspan:"2"},"Tmpt Lahir",-1)),wt=i(()=>t("th",{rowspan:"2"},"Tgl Lahir",-1)),xt=i(()=>t("th",{rowspan:"2"},"TMK",-1)),kt=i(()=>t("th",{rowspan:"2"},"No KTP",-1)),gt=i(()=>t("th",{rowspan:"2"},"Alamat",-1)),jt=i(()=>t("th",{rowspan:"2"},"Status",-1)),Ft=i(()=>t("th",{rowspan:"2"},"No Rek",-1)),St=i(()=>t("th",{rowspan:"2"},"Nama Bank",-1)),Et={colspan:"3"},Dt={class:"text-sm"},Bt={colspan:"3"},Mt={class:"text-sm"},Nt={colspan:"3"},Ct={class:"text-sm"},At={rowspan:"2"},Tt={class:"text-sm"},Vt={rowspan:"2"},Yt={class:"text-sm"},$t={rowspan:"2"},qt={class:"text-sm"},It={class:"sticky top-[60px] !z-[2]"},Pt={class:"text-sm"},Ut={class:"text-sm"},zt={class:"text-sm"},Gt={class:"text-sm"},Jt={class:"text-sm"},Ht={class:"text-sm"},Kt={class:"text-sm"},Lt={class:"text-sm"},Rt={class:"text-sm"},Ot={ref:"to_move"},Qt=["data-index"],Wt={class:"w-full flex items-center justify-end"},Xt={class:"w-full flex flex-wrap p-3 items-center"},Zt=i(()=>t("div",null," Di Validasi oleh : ",-1)),ta={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},aa={key:0},ea={__name:"rpt_salary_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(d){const p=d,{$moment:b}=X(),{pointFormat:n}=at(),_=w({...{id:-1,name:"",tipe:"",is_transition:!1,amount:0,details:[],val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:"",val3:0,val3_by:{username:""},val3_at:""}}),N=H("token"),C=w({}),A=w(null),r=w([]),P=async()=>{x().loading_full=!0,C.value={};const s=new FormData;let o="post",v=p.id;v==0||(s.append("id",v),s.append("_method","PUT"));const{data:e,error:f,status:z}=await I("/rpt_salary_validasi",{method:o,headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},body:s,retry:0});if(x().loading_full=!1,z.value==="error"){q().trigger(f,C);return}_.value.val1=e.value.val1,_.value.val1_user=e.value.val1_user,_.value.val1_by=e.value.val1_by,_.value.val1_at=e.value.val1_at,_.value.val2=e.value.val2,_.value.val2_user=e.value.val2_user,_.value.val2_by=e.value.val2_by,_.value.val2_at=e.value.val2_at,_.value.val3=e.value.val3,_.value.val3_user=e.value.val3_user,_.value.val3_by=e.value.val3_by,_.value.val3_at=e.value.val3_at;let Y=p.p_data.map(G=>G.id).indexOf(p.id);Y>=-1&&p.p_data.splice(Y,1,{..._.value}),p.fnClose()};c(()=>{let s=0;return r.value.forEach(o=>{s+=parseFloat(o.standby_nominal)}),s});const k=c(()=>{let s=0;return r.value.forEach(o=>{s+=parseFloat(o.sb_gaji)}),s}),g=c(()=>{let s=0;return r.value.forEach(o=>{s+=parseFloat(o.sb_makan)}),s}),j=c(()=>{let s=0;return r.value.forEach(o=>{s+=parseFloat(o.sb_dinas)}),s}),F=c(()=>{let s=0;return r.value.forEach(o=>{s+=parseFloat(o.sb_gaji_2)}),s}),S=c(()=>{let s=0;return r.value.forEach(o=>{s+=parseFloat(o.sb_makan_2)}),s}),E=c(()=>{let s=0;return r.value.forEach(o=>{s+=parseFloat(o.sb_dinas_2)}),s}),D=c(()=>{let s=0;return r.value.forEach(o=>{s+=parseFloat(o.uj_gaji)}),s}),B=c(()=>{let s=0;return r.value.forEach(o=>{s+=parseFloat(o.uj_makan)}),s}),M=c(()=>{let s=0;return r.value.forEach(o=>{s+=parseFloat(o.uj_dinas)}),s}),T=c(()=>{let s=0;return r.value.forEach(o=>{s+=parseFloat(o.nominal_cut)}),s}),V=c(()=>{let s=0;return r.value.forEach(o=>{s+=parseFloat(o.salary_bonus_nominal)}),s}),U=async()=>{x().loading_full=!0;const{data:s,error:o,status:v}=await I("/rpt_salary",{method:"get",headers:{Authorization:`Bearer ${N.value}`,Accept:"application/json"},params:{id:p.id},retry:0});if(x().loading_full=!1,v.value==="error"){q().trigger(o);return}_.value=s.value.data,r.value=s.value.data.details};return c(()=>{let s=0;return r.value.forEach(o=>{o.p_status!="Remove"&&(s+=parseInt(o.amount))}),s}),c(()=>!1),K(()=>p.show,(s,o)=>{s==!0&&(p.is_view==!1&&setTimeout(()=>{A.value.focus()},1),U())},{immediate:!0}),(s,o)=>{const v=J;return L((m(),h("section",st,[t("div",null,[O(v,{title:"Form Master Standby Validation",fn:d.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",lt,[t("div",ot,[t("div",nt,[t("div",_t,[rt,t("div",ut,l(a(b)(a(_).period_end).format("MM-Y")),1)])]),a(r).length?(m(),h("div",it,[t("div",ct,[t("table",dt,[t("thead",null,[pt,t("tr",mt,[ht,vt,ft,yt,bt,wt,xt,kt,gt,jt,Ft,St,t("th",Et,[u("Standby 1 "),t("span",Dt,"("+l(a(n)(a(k)+a(g)+a(j)||0))+")",1)]),t("th",Bt,[u("Standby 2 "),t("span",Mt,"("+l(a(n)(a(F)+a(S)+a(E)||0))+")",1)]),t("th",Nt,[u("Trip "),t("span",Ct,"("+l(a(n)(a(D)+a(B)+a(M)||0))+")",1)]),t("th",At,[u("Potongan "),t("span",Tt,"("+l(a(n)(a(T)||0))+")",1)]),t("th",Vt,[u("U.Kerajinan "),t("span",Yt,"("+l(a(n)(a(V)||0))+")",1)]),t("th",$t,[u("Grand Total "),t("span",qt,"("+l(a(n)(a(k)+a(g)+a(j)+a(F)+a(S)+a(E)+a(D)+a(B)+a(M)-a(T)+a(V)||0))+")",1)])]),t("tr",It,[t("th",null,[u("SB.Gaji "),t("span",Pt,"("+l(a(n)(a(k)||0))+")",1)]),t("th",null,[u("SB.Makan "),t("span",Ut,"("+l(a(n)(a(g)||0))+")",1)]),t("th",null,[u("SB.Dinas "),t("span",zt,"("+l(a(n)(a(j)||0))+")",1)]),t("th",null,[u("SB.Gaji "),t("span",Gt,"("+l(a(n)(a(F)||0))+")",1)]),t("th",null,[u("SB.Makan "),t("span",Jt,"("+l(a(n)(a(S)||0))+")",1)]),t("th",null,[u("SB.Dinas "),t("span",Ht,"("+l(a(n)(a(E)||0))+")",1)]),t("th",null,[u("UJ.Gaji "),t("span",Kt,"("+l(a(n)(a(D)||0))+")",1)]),t("th",null,[u("UJ.Makan "),t("span",Lt,"("+l(a(n)(a(B)||0))+")",1)]),t("th",null,[u("UJ.Dinas "),t("span",Rt,"("+l(a(n)(a(M)||0))+")",1)])])]),t("tbody",Ot,[(m(!0),h($,null,Q(a(r),(e,f)=>(m(),h($,{key:f},[e.p_status!="Remove"?(m(),h("tr",{key:0,"data-index":f},[t("td",null,l(f+1)+".",1),t("td",null,l(e.employee_id),1),t("td",null,l(e.employee_name),1),t("td",null,l(e.employee_role),1),t("td",null,l(e.employee_birth_place),1),t("td",null,l(e.employee_birth_date?a(b)(e.employee_birth_date).format("DD-MM-Y"):""),1),t("td",null,l(e.employee_tmk?a(b)(e.employee_tmk).format("DD-MM-Y"):""),1),t("td",null,l(e.employee_ktp_no),1),t("td",null,l(e.employee_address),1),t("td",null,l(e.employee_status),1),t("td",null,l(e.employee_rek_no),1),t("td",null,l(e.employee_bank_name),1),t("td",null,l(a(n)(e.sb_gaji)),1),t("td",null,l(a(n)(e.sb_makan)),1),t("td",null,l(a(n)(e.sb_dinas)),1),t("td",null,l(a(n)(e.sb_gaji_2)),1),t("td",null,l(a(n)(e.sb_makan_2)),1),t("td",null,l(a(n)(e.sb_dinas_2)),1),t("td",null,l(a(n)(e.uj_gaji)),1),t("td",null,l(a(n)(e.uj_makan)),1),t("td",null,l(a(n)(e.uj_dinas)),1),t("td",null,l(a(n)(e.nominal_cut)),1),t("td",null,l(a(n)(e.salary_bonus_nominal)),1),t("td",null,l(a(n)(parseFloat(e.sb_gaji)+parseFloat(e.sb_makan)+parseFloat(e.sb_dinas)+parseFloat(e.sb_gaji_2)+parseFloat(e.sb_makan_2)+parseFloat(e.sb_dinas_2)+parseFloat(e.uj_gaji)+parseFloat(e.uj_makan)+parseFloat(e.uj_dinas)-parseFloat(e.nominal_cut)+parseFloat(e.salary_bonus_nominal))),1)],8,Qt)):y("",!0)],64))),128))],512)])])])):y("",!0)]),t("div",Wt,[t("div",Xt,[Zt,a(_).val1||a(_).val2||a(_).val3?(m(),h("div",ta,[a(_).val1?(m(),h("div",aa," App 1 : "+l(a(_).val1_by.username)+" ( "+l(a(_).val1_at?a(b)(a(_).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):y("",!0)])):y("",!0)]),t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:o[0]||(o[0]=e=>d.fnClose())}," Cancel "),d.is_view==0?(m(),h("button",{key:0,ref_key:"it_val",ref:A,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:o[1]||(o[1]=W(e=>P(),["prevent"]))}," Validasi ",512)):y("",!0)])])])],512)),[[R,d.show]])}}},ia=et(ea,[["__scopeId","data-v-c4334281"]]);export{ia as default};
