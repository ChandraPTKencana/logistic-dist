import Te from"./Header.c3e2f5f5.js";import je from"./Plus.ff952ad4.js";import Be from"./Edit.ba11f6f3.js";import Me from"./Eyes.6a58c4c2.js";import Ie from"./Delete.efb8fc83.js";import Fe from"./DeleteOff.67488dba.js";import Ne from"./Signature.0698a826.js";import Ee from"./SignatureOff.24a8e2ec.js";import ze from"./Line.2ba45a5c.js";import Re from"./Check.d6182f2c.js";import Ve from"./TypeIcon.02775aee.js";import He from"./TableView.ae575e0e.js";import{_ as Je}from"./PopupMini.vue.8659c8b9.js";import Ue from"./employee.83d8f9b6.js";import Le from"./employee_validasi.a047c5dd.js";import{r as s,f as X,g as Ke,h as Ye,i as b,B as qe,j as ee,s as Ze,c as k,a as i,b as u,k as te,v as Ge,l as a,m as le,n as h,w as g,F as Qe,q as We,x as m,y as E,o as d,z,d as x,t as U,A as Xe,p as et,e as tt}from"./entry.ae10661a.js";import{u as R}from"./useMyFetch.fb53d751.js";import{u as c}from"./useUtils.4772637c.js";import{_ as lt}from"./_plugin-vue_export-helper.c27b6911.js";import"./DocJPEG.90e7a5ae.js";import"./DocJPG.b1bbc887.js";import"./DocPNG.e91a482d.js";import"./DocPDF.83f2cb77.js";import"./Search.4974a5a3.js";import"./Adjust.22505a24.js";import"./TableHeaderEye.473aca47.js";import"./Times.b3e1f779.js";import"./ClearAll.e6022ae0.js";import"./client-only.f2bbeaaa.js";import"./ClearEach.0aace84e.js";import"./CaretLeftDoubleBold.19a3dc27.js";import"./CaretLeftBold.194b3cd8.js";import"./CaretRightBold.68f78a81.js";import"./CaretRightDoubleBold.c30a7160.js";import"./Exclamation.80d79582.js";import"./HeaderPopup.vue.d81cefce.js";import"./InputPointFormat.vue.c51000a3.js";import"./AttachmentSingle.2a543a7c.js";import"./PDFJsView.4f91ca97.js";const P=j=>(et("data-v-4e3843d7"),j=j(),tt(),j),at={class:"w-full h-full flex flex-col"},ot={class:"w-full flex grow flex-col overflow-auto h-0"},nt={class:"w-full flex justify-between flex-wrap"},st={class:"grow flex"},rt={class:"m-1"},it=P(()=>i("option",{value:"available"},"Available",-1)),ut=P(()=>i("option",{value:"unapprove"},"Unapprove",-1)),dt=P(()=>i("option",{value:"deleted"},"Trash",-1)),_t=P(()=>i("option",{value:"all"},"All",-1)),mt=[it,ut,dt,_t],pt={class:"grow mb-5"},vt={class:"text-red-500"},ct=P(()=>i("br",null,null,-1)),ft=P(()=>i("b",{class:"text-green-500"},"Kembali Bekerja ",-1)),yt={__name:"index",async setup(j){let B,L;const ae=t=>t.deleted==1?"!bg-red-400":t.val==0||t.val1==0?"!bg-gray-300":"",f=s("available");X(()=>f.value,t=>{q()},{immediate:!1});const p={};p._TimeZoneOffset=new Date().getTimezoneOffset();const M=Ke("token"),{data:n}=([B,L]=Ye(async()=>We(async()=>{m().loading_full=!0;const{data:t,error:e,status:y}=await R("/employees",{method:"get",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},params:{filter_status:f},retry:0});return m().loading_full=!1,y.value==="error"?(E().trigger(e),[]):t.value.data},"$p5jj5crAgd")),B=await B,L(),B),V=s({field:"",by:"desc"}),l=s(-1),v=s({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),_=b(()=>n.value[l.value]),oe=()=>{p.like="";let t=JSON.parse(JSON.stringify(m()._tv.global_keyword));t!=""&&(p.like=`id:%${t}%,name:%${t}%,ktp_no:%${t}%,sim_no:%${t}%,phone_number:%${t}%,rek_no:%${t}%`),p.sort="",V.value.field&&(p.sort=V.value.field+":"+V.value.by),p.filter_model=JSON.stringify(m()._tv.filter_model)},K=s(null),Y=async()=>{m().loading_full=!0,v.value.may_get_data=!1,p.page=v.value.page,p.page==1&&(n.value=[]),p.filter_status=f.value;const{data:t,error:e,status:y}=await R("/employees",{method:"get",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},params:p,retry:0});if(m().loading_full=!1,v.value.may_get_data=!0,y.value==="error"){E().trigger(e);return}v.value.page==1?(n.value=t.value.data,K.value&&(K.value.scrollTop=0)):v.value.page>1&&(n.value=[...n.value,...t.value.data]),t.value.data.length==0&&(v.value.is_last_record=!0),m()._tv.filter_box=!1},q=()=>{l.value=-1,v.value.page=1,v.value.is_last_record=!1,oe(),Y()};qe();const I=s(!1),H=s(0),w=s(0),D=s(1),ne=()=>{H.value=0,D.value=-1,w.value=!1,I.value=!0},{display:S}=ee();Ze(ee());const se=()=>{l.value==-1?S({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(H.value=n.value[l.value].id,D.value=-1,w.value=!1,I.value=!0)},$=s(!1),F=s(0),re=()=>{l.value==-1?S({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=n.value[l.value].id,D.value=1,w.value=!1,$.value=!0)},ie=()=>{l.value==-1?S({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=n.value[l.value].id,D.value=0,w.value=!1,$.value=!0)},ue=()=>{l.value==-1?S({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=n.value[l.value].id,w.value=!1,D.value=-1,$.value=!0)},J=s(!1),Z=s({}),A=s(!1),C=s(""),de=async()=>{A.value&&(A.value=!1)},_e=()=>{l.value==-1?S({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(C.value="",Z.value={id:n.value[l.value].id},A.value=!0)},N=s(!1),me=()=>{l.value==-1?S({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):N.value=!0};X(()=>C.value,t=>{t.trim().length>0?J.value=!0:J.value=!1},{immediate:!1});const pe=async()=>{m().loading_full=!0;const t=new FormData;t.append("id",n.value[l.value].id),t.append("deleted_reason",C.value),t.append("_method","DELETE");const{data:e,error:y,status:O}=await R("/employee",{method:"post",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},body:t,retry:0});if(m().loading_full=!1,O.value==="error"){E().trigger(y);return}let r={...n.value[l.value]};r.deleted=e.value.deleted,r.deleted_user=e.value.deleted_user,r.deleted_at=e.value.deleted_at,r.deleted_by=e.value.deleted_by,r.deleted_reason=e.value.deleted_reason,f.value!="all"?n.value.splice(l.value,1):n.value.splice(l.value,1,{...r}),l.value=-1,A.value=!1},ve=async()=>{m().loading_full=!0;const t=new FormData;t.append("id",n.value[l.value].id),t.append("_method","PUT");const{data:e,error:y,status:O}=await R("/employee_unremove",{method:"post",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},body:t,retry:0});if(m().loading_full=!1,O.value==="error"){E().trigger(y);return}let r={...n.value[l.value]};r.deleted=e.value.deleted,r.deleted_user=e.value.deleted_user,r.deleted_at=e.value.deleted_at,r.deleted_by=e.value.deleted_by,r.deleted_reason=e.value.deleted_reason,f.value!="all"?n.value.splice(l.value,1):n.value.splice(l.value,1,{...r}),l.value=-1,N.value=!1},ce=s([{key:"no",label:"No",isai:!0},{key:"val",label:"App 1",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"id",label:"ID",freeze:1,filter_on:1,type:"number"},{key:"name",label:"Nama",freeze:1,freeze_left:"44px",filter_on:1,type:"string",sort:{priority:1,type:"asc"}},{key:"role",label:"Jabatan",filter_on:1,type:"string"},{key:"ktp_no",label:"No KTP",filter_on:1,type:"string"},{key:"sim_no",label:"No SIM",filter_on:1,type:"string"},{key:"bank_code",label:"Nama Bank",filter_on:1,type:"string"},{key:"rek_no",label:"No Rek",filter_on:1,type:"string"},{key:"rek_name",label:"Nama Rek",filter_on:1,type:"string"},{key:"phone_number",label:"No Tlp",filter_on:1,type:"string"},{key:"birth_place",label:"Tempat Lahir",filter_on:1,type:"string"},{key:"birth_date",label:"Tanggal Lahir",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"tmk",label:"TMK",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"address",label:"Alamat",filter_on:1,type:"string"},{key:"status",label:"Status",filter_on:1,type:"string"},{key:"attachment_1_type",label:"File",type:"string"},{key:"bpjs_kesehatan",label:"BPJS Kesehatan",class:" justify-end",type:"number",filter_on:1},{key:"bpjs_jamsos",label:"BPJS Jamsos",class:" justify-end",type:"number",filter_on:1},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]);b(()=>l.value>-1&&[void 0,0].indexOf(_.value.deleted)>-1&&c().checkPermission("employee.create"));const fe=b(()=>["available","all","unapprove"].indexOf(f.value)>-1&&c().checkPermission("employee.create")),ye=b(()=>l.value>-1&&[void 0,0].indexOf(_.value.deleted)>-1&&(c().checkPermission("employee.val")&&[void 0,0].indexOf(_.value.val)>-1||c().checkPermission("employee.val1")&&[void 0,0].indexOf(_.value.val1)>-1)&&c().checkPermissions(["employee.modify","employee.detail.modify","employee.detail2.modify"])),be=b(()=>l.value>-1&&[void 0,0].indexOf(_.value.deleted)>-1&&(c().checkPermission("employee.val")&&[void 0,0].indexOf(_.value.val)>-1||c().checkPermission("employee.val1")&&[void 0,0].indexOf(_.value.val1)>-1)),ke=b(()=>l.value>-1&&[void 0,0].indexOf(_.value.deleted)>-1&&c().checkPermission("employee.unval")&&[1].indexOf(_.value.val)>-1),he=b(()=>l.value>-1&&c().checkPermission("employee.remove")&&[void 0,0].indexOf(_.value.deleted)>-1),ge=b(()=>l.value>-1&&c().checkPermission("employee.unremove")&&[1].indexOf(_.value.deleted)>-1);return(t,e)=>{const y=Te,O=je,r=Be,xe=Me,we=Ie,De=Fe,Se=Ne,Ce=Ee,G=ze,Q=Re,Pe=Ve,$e=He,W=Je,Ae=Ue,Oe=Le;return d(),k(Qe,null,[i("div",at,[u(y,{title:"List Employee"}),i("div",ot,[i("div",nt,[i("div",st,[i("div",rt,[te(i("select",{class:"","onUpdate:modelValue":e[0]||(e[0]=o=>le(f)?f.value=o:null)},mt,512),[[Ge,a(f)]])]),a(fe)?(d(),k("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[1]||(e[1]=o=>ne())},[u(O)])):h("",!0),a(ye)?(d(),k("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[2]||(e[2]=o=>se())},[u(r)])):h("",!0),a(l)>-1?(d(),k("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[3]||(e[3]=o=>ue())},[u(xe)])):h("",!0),a(he)?(d(),k("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[4]||(e[4]=o=>_e())},[u(we)])):h("",!0),a(ge)?(d(),k("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[5]||(e[5]=o=>me())},[u(De)])):h("",!0),a(be)?(d(),k("button",{key:5,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[6]||(e[6]=o=>re())},[u(Se)])):h("",!0),a(ke)?(d(),k("button",{key:6,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[7]||(e[7]=o=>ie())},[u(Ce)])):h("",!0)])]),u($e,{thead:a(ce),selected:a(l),onSetSelected:e[8]||(e[8]=o=>l.value=o),tbody:a(n),fnCallData:Y,scrolling:a(v),onSetScrollingPage:e[9]||(e[9]=o=>a(v).page=o),onDoFilter:e[10]||(e[10]=o=>q()),rowBgColor:ae},{val:g(({item:o})=>[o.val?(d(),z(Q,{key:1})):(d(),z(G,{key:0}))]),val1:g(({item:o})=>[o.val1?(d(),z(Q,{key:1})):(d(),z(G,{key:0}))]),bank_code:g(({item:o})=>{var T;return[x(U((T=o.bank)==null?void 0:T.code),1)]}),attachment_1_type:g(({item:o})=>[u(Pe,{value:o.attachment_1_type},null,8,["value"])]),deleted_by_username:g(({item:o})=>{var T;return[x(U((T=o.deleted_by)==null?void 0:T.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])])]),u(W,{type:"delete",show:a(A),data:a(Z),fnClose:de,fnConfirm:pe,enabledOk:a(J)},{footer:g(()=>[x(" Masukkan Alasan Penghapusan: "),i("div",pt,[te(i("textarea",{"onUpdate:modelValue":e[11]||(e[11]=o=>le(C)?C.value=o:null)},null,512),[[Xe,a(C)]])])]),_:1},8,["show","data","enabledOk"]),u(Ae,{show:a(I),fnClose:()=>{I.value=!1},id:a(H),p_data:a(n),is_copy:a(w)},null,8,["show","fnClose","id","p_data","is_copy"]),u(Oe,{show:a($),fnClose:()=>{$.value=!1},id:a(F),p_data:a(n),it_state:a(D)},null,8,["show","fnClose","id","p_data","it_state"]),u(W,{type:"custome",show:a(N),fnClose:()=>N.value=!1,fnConfirm:ve},{words:g(()=>[x(" Alasan Keluar Sebelumnya : "),i("b",vt,U(a(n)[a(l)].deleted_reason),1),x(". "),ct,x(" Pekerja telah "),ft,x(" , yakin untuk melanjutkan ? ")]),_:1},8,["show","fnClose"])],64)}}},al=lt(yt,[["__scopeId","data-v-4e3843d7"]]);export{al as default};
