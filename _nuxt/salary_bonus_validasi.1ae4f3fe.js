import{_ as B}from"./HeaderPopup.vue.25b10ac1.js";import{_ as $}from"./WidthMiniPart.vue.3dbbb6a0.js";import F from"./AttachmentSingle.44bba5b2.js";import{r as m,f as H,j as P,m as V,J as j,o as d,c,a as l,b,t as n,k as t,l as f,x as q,E as T,A as y,B as N,p as E,e as J}from"./entry.500a4a42.js";import{u as O}from"./useUtils.8ab9ce04.js";import{u as A}from"./useMyFetch.39de1512.js";import{_ as z}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.a832512a.js";import"./PDFJsView.22d9055d.js";const p=s=>(E("data-v-870c7702"),s=s(),J(),s),K={class:"box-fixed"},U={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},W={class:"w-full flex flex-col items-center grow overflow-auto"},G={class:"w-full flex flex-row flex-wrap"},L={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Q=p(()=>l("label",{for:""},"Tanggal",-1)),R={class:"card-border"},X={class:"w-full sm:w-8/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Z=p(()=>l("label",{for:""},"Pekerja",-1)),ee={class:"card-border"},ae={class:"w-full sm:w-6/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},te=p(()=>l("label",{for:""},"Nominal",-1)),le={class:"card-border"},oe={class:"w-full sm:w-6/12 md:w-full lg:w-full flex flex-col flex-wrap p-1"},se=p(()=>l("label",{for:""},"Note",-1)),ne={class:"card-border"},ie={class:"p-1 w-full"},re={class:"w-full flex items-center justify-end"},_e={class:"w-full flex flex-wrap p-3 items-center"},ue=p(()=>l("div",null," Di Validasi oleh : ",-1)),ve={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},de={key:0},ce={key:1},me={key:2},fe={__name:"salary_bonus_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(s){const i=s,{$moment:w}=T(),{pointFormat:Y}=O(),x={id:"",tanggal:new Date,type:"Kerajinan",nominal:0,note:"",attachment_1:"",attachment_1_preview:""},e=m({...x}),g=H("token"),k=m({}),S=m(null);m([]);const r=m(JSON.parse(JSON.stringify({_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},ktp_no:{tcon:"IconsNumber",text:"No KTP",val:""},sim_no:{tcon:"IconsCreditCard",text:"No SIM",val:""}},id:"",name:"",title:""}))),C=async()=>{y().loading_full=!0,k.value={};const _=new FormData;let o="post",v=i.id;v==0||(_.append("id",v),_.append("_method","PUT"));const{data:a,error:h,status:u}=await A("/salary_bonus_validasi",{method:o,headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},body:_,retry:0});if(y().loading_full=!1,u.value==="error"){N().trigger(h,k);return}e.value.val=a.value.val,e.value.val_user=a.value.val_user,e.value.val_by=a.value.val_by,e.value.val_at=a.value.val_at,e.value.val1=a.value.val1,e.value.val1_user=a.value.val1_user,e.value.val1_by=a.value.val1_by,e.value.val1_at=a.value.val1_at,e.value.val2=a.value.val2,e.value.val2_user=a.value.val2_user,e.value.val2_by=a.value.val2_by,e.value.val2_at=a.value.val2_at,e.value.val3=a.value.val3,e.value.val3_user=a.value.val3_user,e.value.val3_by=a.value.val3_by,e.value.val3_at=a.value.val3_at;let D=i.p_data.map(I=>I.id).indexOf(i.id);D>=-1&&i.p_data.splice(D,1,{...e.value}),i.fnClose()},M=async()=>{y().loading_full=!0;const{data:_,error:o,status:v}=await A("/salary_bonus",{method:"get",headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},params:{id:i.id},retry:0});if(y().loading_full=!1,v.value==="error"){N().trigger(o);return}let a=_.value.data;e.value=a,r.value._.id.val=a.employee.id,r.value._.name.val=a.employee.name,r.value._.ktp_no.val=a.employee.ktp_no,r.value._.sim_no.val=a.employee.sim_no,r.value.id=a.employee.id,r.value.name=a.employee.name,r.value.ktp_no=(a.employee.ktp_no||"")+" "+(a.employee.sim_no||"")};return P(()=>i.show,(_,o)=>{_==!0&&(e.value={...x},i.is_view==!1&&setTimeout(()=>{S.value.focus()},1),M())},{immediate:!0}),(_,o)=>{const v=B,a=$,h=F;return V((d(),c("section",K,[l("div",null,[b(v,{title:"Form Salary Additional Validation",fn:s.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),l("form",U,[l("div",W,[l("div",G,[l("div",L,[Q,l("div",R,n(t(w)(t(e).tanggal).format("DD-MM-Y")),1)]),l("div",X,[Z,l("div",ee,[b(a,{selected:t(r)},null,8,["selected"])])]),l("div",ae,[te,l("div",le,n(t(Y)(t(e).nominal||0)),1)]),l("div",oe,[se,l("div",ne,n(t(e).note),1)]),l("div",ie,[b(h,{label:"Attachment",value:t(e).attachment_1_preview,onSetFile:o[0]||(o[0]=u=>t(e).attachment_1=u),onSetPreview:o[1]||(o[1]=u=>t(e).attachment_1_preview=u)},null,8,["value"])])])]),l("div",re,[l("div",_e,[ue,t(e).val1||t(e).val2||t(e).val3?(d(),c("div",ve,[t(e).val1?(d(),c("div",de," App 1 : "+n(t(e).val1_by.username)+" ( "+n(t(e).val1_at?t(w)(t(e).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):f("",!0),t(e).val2?(d(),c("div",ce," App 2 : "+n(t(e).val2_by.username)+" ( "+n(t(e).val2_at?t(w)(t(e).val2_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):f("",!0),t(e).val3?(d(),c("div",me," App 2 : "+n(t(e).val3_by.username)+" ( "+n(t(e).val3_at?t(w)(t(e).val3_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):f("",!0)])):f("",!0)]),l("button",{type:"button",name:"button",class:"w-36 m-1",onClick:o[2]||(o[2]=u=>s.fnClose())}," Cancel "),s.is_view==0?(d(),c("button",{key:0,ref_key:"it_val",ref:S,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:o[3]||(o[3]=q(u=>C(),["prevent"]))}," Validasi ",512)):f("",!0)])])])],512)),[[j,s.show]])}}},Ne=z(fe,[["__scopeId","data-v-870c7702"]]);export{Ne as default};
