import we from"./Header.bacd5d07.js";import De from"./Plus.f0b59dac.js";import Se from"./Edit.28f86a6d.js";import Ce from"./Eyes.f18663f4.js";import $e from"./Delete.a9d68ed1.js";import Ae from"./Signature.ce846c1e.js";import Te from"./Line.4ff6e51a.js";import Me from"./Check.f1a23a62.js";import Oe from"./TypeIcon.63a5b5ae.js";import Pe from"./TableView.7dab7208.js";import{_ as Ne}from"./PopupMini.vue.1c94b59f.js";import Ie from"./employee.96ba1c77.js";import Be from"./employee_validasi.58116824.js";import{r as n,f as G,g as Fe,h as Ee,i as k,B as je,j as Q,s as ze,c as g,a as r,b as i,k as W,v as Ve,l as o,m as X,n as S,w as h,F as He,q as Re,x as m,y as V,o as _,z as P,d as H,t as ee,A as Le,p as Ue,e as Ye}from"./entry.6653cba1.js";import{u as R}from"./useMyFetch.6bc70573.js";import{u as v}from"./useUtils.68ef0d10.js";import{_ as Je}from"./_plugin-vue_export-helper.c27b6911.js";import"./DocJPEG.651c2f70.js";import"./DocJPG.04853556.js";import"./DocPNG.3be478d8.js";import"./DocPDF.0a0fb2e2.js";import"./Search.2634d619.js";import"./Adjust.74eecdeb.js";import"./TableHeaderEye.ebb2feb1.js";import"./Times.6020b457.js";import"./ClearAll.bedbb2ab.js";import"./client-only.f4ef09a1.js";import"./ClearEach.3ea3b36c.js";import"./CaretLeftDoubleBold.c5c56bf7.js";import"./CaretLeftBold.a494e978.js";import"./CaretRightBold.9830d6e1.js";import"./CaretRightDoubleBold.3df596df.js";import"./Exclamation.5e8e18a8.js";import"./HeaderPopup.vue.16e7fbba.js";import"./AttachmentSingle.ed9f03bc.js";import"./PDFJsView.43ebb88c.js";const N=C=>(Ue("data-v-116b1dd5"),C=C(),Ye(),C),Ke={class:"w-full h-full flex flex-col"},qe={class:"w-full flex grow flex-col overflow-auto h-0"},Ze={class:"w-full flex justify-between flex-wrap"},Ge={class:"grow flex"},Qe={class:"m-1"},We=N(()=>r("option",{value:"available"},"Available",-1)),Xe=N(()=>r("option",{value:"unapprove"},"Unapprove",-1)),et=N(()=>r("option",{value:"deleted"},"Trash",-1)),tt=N(()=>r("option",{value:"all"},"All",-1)),lt=[We,Xe,et,tt],at={class:"grow mb-5"},ot={__name:"index",async setup(C){let $,L;const te=e=>e.deleted==1?"!bg-red-400":e.val==0||e.val1==0?"!bg-gray-300":"",p=n("available");G(()=>p.value,e=>{J()},{immediate:!1});const u={};u._TimeZoneOffset=new Date().getTimezoneOffset();const I=Fe("token"),{data:s}=([$,L]=Ee(async()=>Re(async()=>{m().loading_full=!0;const{data:e,error:t,status:y}=await R("/employees",{method:"get",headers:{Authorization:`Bearer ${I.value}`,Accept:"application/json"},params:{filter_status:p},retry:0});return m().loading_full=!1,y.value==="error"?(V().trigger(t),[]):e.value.data},"$p5jj5crAgd")),$=await $,L(),$),B=n({field:"",by:"desc"}),a=n(-1),d=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),c=k(()=>s.value[a.value]),le=()=>{u.like="";let e=JSON.parse(JSON.stringify(m()._tv.global_keyword));e!=""&&(u.like=`id:%${e}%,name:%${e}%,ktp_no:%${e}%,sim_no:%${e}%,phone_number:%${e}%,rek_no:%${e}%`),u.sort="",B.value.field&&(u.sort=B.value.field+":"+B.value.by),u.filter_model=JSON.stringify(m()._tv.filter_model)},U=n(null),Y=async()=>{m().loading_full=!0,d.value.may_get_data=!1,u.page=d.value.page,u.page==1&&(s.value=[]),u.filter_status=p.value;const{data:e,error:t,status:y}=await R("/employees",{method:"get",headers:{Authorization:`Bearer ${I.value}`,Accept:"application/json"},params:u,retry:0});if(m().loading_full=!1,d.value.may_get_data=!0,y.value==="error"){V().trigger(t);return}d.value.page==1?(s.value=e.value.data,U.value&&(U.value.scrollTop=0)):d.value.page>1&&(s.value=[...s.value,...e.value.data]),e.value.data.length==0&&(d.value.is_last_record=!0),m()._tv.filter_box=!1},J=()=>{a.value=-1,d.value.page=1,d.value.is_last_record=!1,le(),Y()};je();const A=n(!1),F=n(0),x=n(0),T=n(!1),ae=()=>{F.value=0,T.value=!1,x.value=!1,A.value=!0},{display:M}=Q();ze(Q());const oe=()=>{a.value==-1?M({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=s.value[a.value].id,T.value=!1,x.value=!1,A.value=!0)},O=n(!1),E=n(0),se=()=>{a.value==-1?M({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(E.value=s.value[a.value].id,T.value=!1,x.value=!1,O.value=!0)},ne=()=>{a.value==-1?M({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(E.value=s.value[a.value].id,T.value=!0,x.value=!1,O.value=!0)},j=n(!1),K=n({}),w=n(!1),b=n(""),re=async()=>{w.value&&(w.value=!1)},ie=()=>{a.value==-1?M({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(b.value="",K.value={id:s.value[a.value].id},w.value=!0)};G(()=>b.value,e=>{e.trim().length>0?j.value=!0:j.value=!1},{immediate:!1});const ue=async()=>{m().loading_full=!0;const e=new FormData;e.append("id",s.value[a.value].id),e.append("deleted_reason",b.value),e.append("_method","DELETE");const{data:t,error:y,status:z}=await R("/employee",{method:"post",headers:{Authorization:`Bearer ${I.value}`,Accept:"application/json"},body:e,retry:0});if(m().loading_full=!1,z.value==="error"){V().trigger(y);return}let f={...s.value[a.value]};f.deleted=t.value.deleted,f.deleted_user=t.value.deleted_user,f.deleted_at=t.value.deleted_at,f.deleted_by=t.value.deleted_by,f.deleted_reason=t.value.deleted_reason,p.value!="all"?s.value.splice(a.value,1):s.value.splice(a.value,1,{...f}),a.value=-1,w.value=!1},de=n([{key:"no",label:"No",isai:!0},{key:"val",label:"App 1",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"id",label:"ID",freeze:1,filter_on:1,type:"number"},{key:"name",label:"Nama",freeze:1,freeze_left:"44px",filter_on:1,type:"string",sort:{priority:1,type:"asc"}},{key:"role",label:"Jabatan",filter_on:1,type:"string"},{key:"ktp_no",label:"No KTP",filter_on:1,type:"string"},{key:"sim_no",label:"No SIM",filter_on:1,type:"string"},{key:"bank_code",label:"Nama Bank",filter_on:1,type:"string"},{key:"rek_no",label:"No Rek",filter_on:1,type:"string"},{key:"rek_name",label:"Nama Rek",filter_on:1,type:"string"},{key:"phone_number",label:"No Tlp",filter_on:1,type:"string"},{key:"birth_place",label:"Tempat Lahir",filter_on:1,type:"string"},{key:"birth_date",label:"Tanggal Lahir",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"tmk",label:"TMK",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"address",label:"Alamat",filter_on:1,type:"string"},{key:"status",label:"Status",filter_on:1,type:"string"},{key:"attachment_1_type",label:"File",type:"string"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]);k(()=>a.value>-1&&[void 0,0].indexOf(c.value.deleted)>-1&&v().checkPermission("employee.create"));const _e=k(()=>["available","all","unapprove"].indexOf(p.value)>-1&&v().checkPermission("employee.create")),me=k(()=>a.value>-1&&[void 0,0].indexOf(c.value.deleted)>-1&&(v().checkPermission("employee.val")&&[void 0,0].indexOf(c.value.val)>-1||v().checkPermission("employee.val1")&&[void 0,0].indexOf(c.value.val1)>-1)&&v().checkPermissions(["employee.modify","employee.detail.modify","employee.detail2.modify"])),pe=k(()=>a.value>-1&&[void 0,0].indexOf(c.value.deleted)>-1&&(v().checkPermission("employee.val")&&[void 0,0].indexOf(c.value.val)>-1||v().checkPermission("employee.val1")&&[void 0,0].indexOf(c.value.val1)>-1)),ce=k(()=>a.value>-1&&v().checkPermission("employee.remove")&&[void 0,0].indexOf(c.value.deleted)>-1);return(e,t)=>{const y=we,z=De,f=Se,fe=Ce,ve=$e,ye=Ae,q=Te,Z=Me,be=Oe,ke=Pe,ge=Ne,he=Ie,xe=Be;return _(),g(He,null,[r("div",Ke,[i(y,{title:"List Employee"}),r("div",qe,[r("div",Ze,[r("div",Ge,[r("div",Qe,[W(r("select",{class:"","onUpdate:modelValue":t[0]||(t[0]=l=>X(p)?p.value=l:null)},lt,512),[[Ve,o(p)]])]),o(_e)?(_(),g("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=l=>ae())},[i(z)])):S("",!0),o(me)?(_(),g("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=l=>oe())},[i(f)])):S("",!0),o(a)>-1?(_(),g("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[3]||(t[3]=l=>ne())},[i(fe)])):S("",!0),o(ce)?(_(),g("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[4]||(t[4]=l=>ie())},[i(ve)])):S("",!0),o(pe)?(_(),g("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[5]||(t[5]=l=>se())},[i(ye)])):S("",!0)])]),i(ke,{thead:o(de),selected:o(a),onSetSelected:t[6]||(t[6]=l=>a.value=l),tbody:o(s),fnCallData:Y,scrolling:o(d),onSetScrollingPage:t[7]||(t[7]=l=>o(d).page=l),onDoFilter:t[8]||(t[8]=l=>J()),rowBgColor:te},{val:h(({item:l})=>[l.val?(_(),P(Z,{key:1})):(_(),P(q,{key:0}))]),val1:h(({item:l})=>[l.val1?(_(),P(Z,{key:1})):(_(),P(q,{key:0}))]),bank_code:h(({item:l})=>{var D;return[H(ee((D=l.bank)==null?void 0:D.code),1)]}),attachment_1_type:h(({item:l})=>[i(be,{value:l.attachment_1_type},null,8,["value"])]),deleted_by_username:h(({item:l})=>{var D;return[H(ee((D=l.deleted_by)==null?void 0:D.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])])]),i(ge,{type:"delete",show:o(w),data:o(K),fnClose:re,fnConfirm:ue,enabledOk:o(j)},{footer:h(()=>[H(" Masukkan Alasan Penghapusan: "),r("div",at,[W(r("textarea",{"onUpdate:modelValue":t[9]||(t[9]=l=>X(b)?b.value=l:null)},null,512),[[Le,o(b)]])])]),_:1},8,["show","data","enabledOk"]),i(he,{show:o(A),fnClose:()=>{A.value=!1},id:o(F),p_data:o(s),is_copy:o(x)},null,8,["show","fnClose","id","p_data","is_copy"]),i(xe,{show:o(O),fnClose:()=>{O.value=!1},id:o(E),p_data:o(s)},null,8,["show","fnClose","id","p_data"])],64)}}},Ht=Je(ot,[["__scopeId","data-v-116b1dd5"]]);export{Ht as default};
