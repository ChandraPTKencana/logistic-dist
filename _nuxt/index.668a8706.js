import we from"./Header.f970c16c.js";import De from"./Copy.b487d2c6.js";import Ce from"./Plus.f901a1ec.js";import Se from"./Edit.ee3666b9.js";import Pe from"./Eyes.59a847e6.js";import Ae from"./Delete.5f7a979c.js";import Te from"./Signature.99f36309.js";import Oe from"./Line.8e2e53ff.js";import $e from"./Check.1b821583.js";import Me from"./TableView.7f45d6d0.js";import{_ as Be}from"./PopupMini.vue.5da54895.js";import Fe from"./standby_mst.661f038c.js";import Ne from"./standby_mst_validasi.a6c7d811.js";import{r as n,f as K,g as Ie,h as Ve,i as x,j as Z,s as je,c as b,b as r,a as d,k as G,v as ze,l as s,m as Q,n as w,w as D,q as Ee,x as m,y as j,o as u,z as M,d as B,t as z,A as He}from"./entry.09130829.js";import{u as p}from"./useUtils.75ac00df.js";import{u as E}from"./useMyFetch.b0583756.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.2fe896e0.js";import"./Adjust.4bfb5837.js";import"./TableHeaderEye.179b7fa4.js";import"./Times.40afb59c.js";import"./ClearAll.b750ec2b.js";import"./client-only.3a04226b.js";import"./ClearEach.bbcdeba7.js";import"./CaretLeftDoubleBold.4c49c2c2.js";import"./CaretLeftBold.e0bc9506.js";import"./CaretRightBold.ce0d3a64.js";import"./CaretRightDoubleBold.1bd8e8c9.js";import"./Exclamation.6e30be69.js";import"./HeaderPopup.vue.7766105d.js";import"./Tools.f66bae21.js";import"./InputPointFormat.vue.36cabddf.js";import"./ToolsPopup.6125f4ae.js";import"./ac_accs.cb34934f.js";const Ue={class:"w-full h-full flex flex-col"},Ye={class:"w-full flex grow flex-col overflow-auto h-0"},Le={class:"w-full flex justify-between flex-wrap"},Je={class:"grow flex"},Re={class:"m-1"},qe=d("option",{value:"available"},"Available",-1),Ke=d("option",{value:"unapprove"},"Unapprove",-1),Ze=d("option",{value:"deleted"},"Trash",-1),Ge=d("option",{value:"all"},"All",-1),Qe=[qe,Ke,Ze,Ge],We={class:"grow mb-5"},Ft={__name:"index",async setup(Xe){let T,H;const W=t=>t.deleted==1?"!bg-red-400":t.val==0||t.val1==0?"!bg-gray-300":"",v=n("available");K(()=>v.value,t=>{Y()},{immediate:!1});const i={};i._TimeZoneOffset=new Date().getTimezoneOffset(),i.sort="created_at:desc";const F=Ie("token"),{data:X}=([T,H]=Ve(async()=>Ee(async()=>{let t=[];m().loading_full=!0;const{data:e,error:y,status:A}=await E("/standby_msts",{method:"get",headers:{Authorization:`Bearer ${F.value}`,Accept:"application/json"},params:{filter_status:v},retry:0});return m().loading_full=!1,A.value==="error"?(j().trigger(y),{standby_msts:t}):(t=e.value.data,{standby_msts:t})},"$rczbThuP8g")),T=await T,H(),T),o=n(X.value.standby_msts);n("");const N=n({field:"created_at",by:"desc"}),a=n(-1),_=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),c=x(()=>o.value[a.value]),ee=()=>{i.like="";let t=JSON.parse(JSON.stringify(m()._tv.global_keyword));t!=""&&(i.like=`id:%${t}%,name:%${t}%,amount:%${t}%`),i.sort="",N.value.field&&(i.sort=N.value.field+":"+N.value.by),i.filter_model=JSON.stringify(m()._tv.filter_model)};n(null);const U=async()=>{m().loading_full=!0,_.value.may_get_data=!1,i.page=_.value.page,i.page==1&&(o.value=[]),i.first_row&&delete i.first_row,i.page>1&&(i.first_row=JSON.stringify(o.value[0])),i.filter_status=v.value;const{data:t,error:e,status:y}=await E("/standby_msts",{method:"get",headers:{Authorization:`Bearer ${F.value}`,Accept:"application/json"},params:i,retry:0});if(m().loading_full=!1,_.value.may_get_data=!0,y.value==="error"){j().trigger(e);return}_.value.page==1?o.value=t.value.data:_.value.page>1&&(o.value=[...o.value,...t.value.data]),t.value.data.length==0&&(_.value.is_last_record=!0),m()._tv.filter_box=!1},Y=()=>{a.value=-1,_.value.page=1,_.value.is_last_record=!1,ee(),U()},C=n(!1),O=n(0),k=n(0),h=n(!1),te=()=>{O.value=0,h.value=!1,k.value=!1,C.value=!0},{display:S}=Z();je(Z());const ae=()=>{a.value==-1?S({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(O.value=o.value[a.value].id,h.value=!1,k.value=!1,C.value=!0)},le=()=>{a.value==-1?S({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(O.value=o.value[a.value].id,h.value=!1,k.value=!0,C.value=!0)},$=n(!1),I=n(0),se=()=>{a.value==-1?S({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(I.value=o.value[a.value].id,h.value=!1,k.value=!1,$.value=!0)},oe=()=>{a.value==-1?S({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(I.value=o.value[a.value].id,h.value=!0,k.value=!1,$.value=!0)},V=n(!1),L=n({}),P=n(!1),g=n(""),ne=async()=>{P.value&&(P.value=!1)},ie=()=>{a.value==-1?S({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(g.value="",L.value={id:o.value[a.value].id},P.value=!0)};K(()=>g.value,t=>{t.trim().length>0?V.value=!0:V.value=!1},{immediate:!1});const re=async()=>{m().loading_full=!0;const t=new FormData;t.append("id",o.value[a.value].id),t.append("deleted_reason",g.value),t.append("_method","DELETE");const{data:e,error:y,status:A}=await E("/standby_mst",{method:"post",headers:{Authorization:`Bearer ${F.value}`,Accept:"application/json"},body:t,retry:0});if(m().loading_full=!1,A.value==="error"){j().trigger(y);return}let f={...o.value[a.value]};f.deleted=e.value.deleted,f.deleted_user=e.value.deleted_user,f.deleted_at=e.value.deleted_at,f.deleted_by=e.value.deleted_by,f.deleted_reason=e.value.deleted_reason,v.value!="all"?o.value.splice(a.value,1):o.value.splice(a.value,1,{...f}),a.value=-1,P.value=!1},ue=n([{key:"no",label:"No",isai:!0},{key:"valx",label:"APP",childs:[{key:"val",label:"Kasir",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val1",label:"Logistik",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]}]},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"name",label:"Nama",freeze:1,filter_on:1,type:"string",sort:{priority:1,type:"asc"}},{key:"tipe",label:"Tipe",filter_on:1,type:"string"},{key:"amount",label:"Amount",class:" justify-end",type:"number"},{key:"is_transition",label:"Peralihan",filter_on:1,type:"select",select_item:[{k:"1",v:"Ya"},{k:"0",v:"Tidak"}]},{key:"is_trip",label:"Trip",filter_on:1,type:"select",select_item:[{k:"1",v:"Ya"},{k:"0",v:"Tidak"}]},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]),de=x(()=>a.value>-1&&[void 0,0].indexOf(c.value.deleted)>-1&&p().checkPermission("standby_mst.create")),_e=x(()=>["available","all","unapprove"].indexOf(v.value)>-1&&p().checkPermission("standby_mst.create")),me=x(()=>a.value>-1&&[void 0,0].indexOf(c.value.deleted)>-1&&(p().checkPermission("standby_mst.val")&&[void 0,0].indexOf(c.value.val)>-1||p().checkPermission("standby_mst.val1")&&[void 0,0].indexOf(c.value.val1)>-1)&&p().checkPermissions(["standby_mst.modify"])),ve=x(()=>a.value>-1&&[void 0,0].indexOf(c.value.deleted)>-1&&(p().checkPermission("standby_mst.val")&&[void 0,0].indexOf(c.value.val)>-1||p().checkPermission("standby_mst.val1")&&[void 0,0].indexOf(c.value.val1)>-1)),ce=x(()=>a.value>-1&&p().checkPermission("standby_mst.remove")&&[void 0,0].indexOf(c.value.deleted)>-1);return(t,e)=>{const y=we,A=De,f=Ce,fe=Se,pe=Pe,ye=Ae,be=Te,J=Oe,R=$e,ke=Me,he=Be,ge=Fe,xe=Ne;return u(),b("div",Ue,[r(y,{title:"List Standby"}),d("div",Ye,[d("div",Le,[d("div",Je,[d("div",Re,[G(d("select",{class:"","onUpdate:modelValue":e[0]||(e[0]=l=>Q(v)?v.value=l:null)},Qe,512),[[ze,s(v)]])]),s(de)?(u(),b("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[1]||(e[1]=l=>le())},[r(A)])):w("",!0),s(_e)?(u(),b("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[2]||(e[2]=l=>te())},[r(f)])):w("",!0),s(me)?(u(),b("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[3]||(e[3]=l=>ae())},[r(fe)])):w("",!0),s(a)>-1?(u(),b("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[4]||(e[4]=l=>oe())},[r(pe)])):w("",!0),s(ce)?(u(),b("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[5]||(e[5]=l=>ie())},[r(ye)])):w("",!0),s(ve)?(u(),b("button",{key:5,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[6]||(e[6]=l=>se())},[r(be)])):w("",!0)])]),r(ke,{thead:s(ue),selected:s(a),onSetSelected:e[7]||(e[7]=l=>a.value=l),tbody:s(o),fnCallData:U,scrolling:s(_),onSetScrollingPage:e[8]||(e[8]=l=>s(_).page=l),onDoFilter:e[9]||(e[9]=l=>Y()),rowBgColor:W},{val:D(({item:l})=>[l.val?(u(),M(R,{key:1})):(u(),M(J,{key:0}))]),val1:D(({item:l})=>[l.val1?(u(),M(R,{key:1})):(u(),M(J,{key:0}))]),is_transition:D(({item:l})=>[B(z(l.is_transition?"Ya":"Tidak"),1)]),is_trip:D(({item:l})=>[B(z(l.is_trip?"Ya":"Tidak"),1)]),deleted_by_username:D(({item:l})=>{var q;return[B(z((q=l.deleted_by)==null?void 0:q.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])]),r(he,{type:"delete",show:s(P),data:s(L),fnClose:ne,fnConfirm:re,enabledOk:s(V)},{footer:D(()=>[B(" Masukkan Alasan Penghapusan: "),d("div",We,[G(d("textarea",{"onUpdate:modelValue":e[10]||(e[10]=l=>Q(g)?g.value=l:null)},null,512),[[He,s(g)]])])]),_:1},8,["show","data","enabledOk"]),r(ge,{show:s(C),fnClose:()=>{C.value=!1},id:s(O),p_data:s(o),is_copy:s(k)},null,8,["show","fnClose","id","p_data","is_copy"]),r(xe,{show:s($),fnClose:()=>{$.value=!1},id:s(I),p_data:s(o),is_view:s(h)},null,8,["show","fnClose","id","p_data","is_view"])])}}};export{Ft as default};
