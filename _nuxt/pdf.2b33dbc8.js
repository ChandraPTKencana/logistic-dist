var Wg=Object.defineProperty;var Xg=(c,e,t)=>e in c?Wg(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var z=(c,e,t)=>(Xg(c,typeof e!="symbol"?e+"":e,t),t),Wd=(c,e,t)=>{if(!e.has(c))throw TypeError("Cannot "+t)};var o=(c,e,t)=>(Wd(c,e,"read from private field"),t?t.call(c):e.get(c)),g=(c,e,t)=>{if(e.has(c))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(c):e.set(c,t)},b=(c,e,t,s)=>(Wd(c,e,"write to private field"),s?s.call(c,t):e.set(c,t),t);var se=(c,e,t,s)=>({set _(i){b(c,e,i,t)},get _(){return o(c,e,s)}}),y=(c,e,t)=>(Wd(c,e,"access private method"),t);import{_ as yi}from"./entry.dc2b24f1.js";var Yg={9306:(c,e,t)=>{var s=t(4901),i=t(6823),n=TypeError;c.exports=function(r){if(s(r))return r;throw new n(i(r)+" is not a function")}},3506:(c,e,t)=>{var s=t(3925),i=String,n=TypeError;c.exports=function(r){if(s(r))return r;throw new n("Can't set "+i(r)+" as a prototype")}},7080:(c,e,t)=>{var s=t(4402).has;c.exports=function(i){return s(i),i}},679:(c,e,t)=>{var s=t(1625),i=TypeError;c.exports=function(n,r){if(s(r,n))return n;throw new i("Incorrect invocation")}},8551:(c,e,t)=>{var s=t(34),i=String,n=TypeError;c.exports=function(r){if(s(r))return r;throw new n(i(r)+" is not an object")}},7811:c=>{c.exports=typeof ArrayBuffer<"u"&&typeof DataView<"u"},7394:(c,e,t)=>{var s=t(6706),i=t(4576),n=TypeError;c.exports=s(ArrayBuffer.prototype,"byteLength","get")||function(r){if(i(r)!=="ArrayBuffer")throw new n("ArrayBuffer expected");return r.byteLength}},3238:(c,e,t)=>{var s=t(9504),i=t(7394),n=s(ArrayBuffer.prototype.slice);c.exports=function(r){if(i(r)!==0)return!1;try{return n(r,0,0),!1}catch{return!0}}},5636:(c,e,t)=>{var s=t(4475),i=t(9504),n=t(6706),r=t(7696),a=t(3238),l=t(7394),h=t(4483),d=t(1548),u=s.structuredClone,f=s.ArrayBuffer,p=s.DataView,m=s.TypeError,v=Math.min,E=f.prototype,A=p.prototype,w=i(E.slice),S=n(E,"resizable","get"),C=n(E,"maxByteLength","get"),x=i(A.getInt8),T=i(A.setInt8);c.exports=(d||h)&&function(R,I,P){var O=l(R),L=I===void 0?O:r(I),W=!S||!S(R),H;if(a(R))throw new m("ArrayBuffer is detached");if(d&&(R=u(R,{transfer:[R]}),O===L&&(P||W)))return R;if(O>=L&&(!P||W))H=w(R,0,L);else{var X=P&&!W&&C?{maxByteLength:C(R)}:void 0;H=new f(L,X);for(var Y=new p(R),K=new p(H),F=v(L,O),k=0;k<F;k++)T(K,k,x(Y,k))}return d||h(R),H}},4644:(c,e,t)=>{var s=t(7811),i=t(3724),n=t(4475),r=t(4901),a=t(34),l=t(9297),h=t(6955),d=t(6823),u=t(6699),f=t(6840),p=t(2106),m=t(1625),v=t(2787),E=t(2967),A=t(8227),w=t(3392),S=t(1181),C=S.enforce,x=S.get,T=n.Int8Array,R=T&&T.prototype,I=n.Uint8ClampedArray,P=I&&I.prototype,O=T&&v(T),L=R&&v(R),W=Object.prototype,H=n.TypeError,X=A("toStringTag"),Y=w("TYPED_ARRAY_TAG"),K="TypedArrayConstructor",F=s&&!!E&&h(globalThis.opera)!=="Opera",k=!1,lt,bt,Qt,rt={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},ht={BigInt64Array:8,BigUint64Array:8},Bs=function(ft){if(!a(ft))return!1;var pt=h(ft);return pt==="DataView"||l(rt,pt)||l(ht,pt)},pe=function(U){var ft=v(U);if(a(ft)){var pt=x(ft);return pt&&l(pt,K)?pt[K]:pe(ft)}},D=function(U){if(!a(U))return!1;var ft=h(U);return l(rt,ft)||l(ht,ft)},M=function(U){if(D(U))return U;throw new H("Target is not a typed array")},_=function(U){if(r(U)&&(!E||m(O,U)))return U;throw new H(d(U)+" is not a typed array constructor")},G=function(U,ft,pt,Fe){if(i){if(pt)for(var Wt in rt){var Ct=n[Wt];if(Ct&&l(Ct.prototype,U))try{delete Ct.prototype[U]}catch{try{Ct.prototype[U]=ft}catch{}}}(!L[U]||pt)&&f(L,U,pt?ft:F&&R[U]||ft,Fe)}},ct=function(U,ft,pt){var Fe,Wt;if(i){if(E){if(pt){for(Fe in rt)if(Wt=n[Fe],Wt&&l(Wt,U))try{delete Wt[U]}catch{}}if(!O[U]||pt)try{return f(O,U,pt?ft:F&&O[U]||ft)}catch{}else return}for(Fe in rt)Wt=n[Fe],Wt&&(!Wt[U]||pt)&&f(Wt,U,ft)}};for(lt in rt)bt=n[lt],Qt=bt&&bt.prototype,Qt?C(Qt)[K]=bt:F=!1;for(lt in ht)bt=n[lt],Qt=bt&&bt.prototype,Qt&&(C(Qt)[K]=bt);if((!F||!r(O)||O===Function.prototype)&&(O=function(){throw new H("Incorrect invocation")},F))for(lt in rt)n[lt]&&E(n[lt],O);if((!F||!L||L===W)&&(L=O.prototype,F))for(lt in rt)n[lt]&&E(n[lt].prototype,L);if(F&&v(P)!==L&&E(P,L),i&&!l(L,X)){k=!0,p(L,X,{configurable:!0,get:function(){return a(this)?this[Y]:void 0}});for(lt in rt)n[lt]&&u(n[lt],Y,lt)}c.exports={NATIVE_ARRAY_BUFFER_VIEWS:F,TYPED_ARRAY_TAG:k&&Y,aTypedArray:M,aTypedArrayConstructor:_,exportTypedArrayMethod:G,exportTypedArrayStaticMethod:ct,getTypedArrayConstructor:pe,isView:Bs,isTypedArray:D,TypedArray:O,TypedArrayPrototype:L}},5370:(c,e,t)=>{var s=t(6198);c.exports=function(i,n,r){for(var a=0,l=arguments.length>2?r:s(n),h=new i(l);l>a;)h[a]=n[a++];return h}},9617:(c,e,t)=>{var s=t(5397),i=t(5610),n=t(6198),r=function(a){return function(l,h,d){var u=s(l),f=n(u);if(f===0)return!a&&-1;var p=i(d,f),m;if(a&&h!==h){for(;f>p;)if(m=u[p++],m!==m)return!0}else for(;f>p;p++)if((a||p in u)&&u[p]===h)return a||p||0;return!a&&-1}};c.exports={includes:r(!0),indexOf:r(!1)}},4527:(c,e,t)=>{var s=t(3724),i=t(4376),n=TypeError,r=Object.getOwnPropertyDescriptor,a=s&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(l){return l instanceof TypeError}}();c.exports=a?function(l,h){if(i(l)&&!r(l,"length").writable)throw new n("Cannot set read only .length");return l.length=h}:function(l,h){return l.length=h}},7628:(c,e,t)=>{var s=t(6198);c.exports=function(i,n){for(var r=s(i),a=new n(r),l=0;l<r;l++)a[l]=i[r-l-1];return a}},9928:(c,e,t)=>{var s=t(6198),i=t(1291),n=RangeError;c.exports=function(r,a,l,h){var d=s(r),u=i(l),f=u<0?d+u:u;if(f>=d||f<0)throw new n("Incorrect index");for(var p=new a(d),m=0;m<d;m++)p[m]=m===f?h:r[m];return p}},6319:(c,e,t)=>{var s=t(8551),i=t(9539);c.exports=function(n,r,a,l){try{return l?r(s(a)[0],a[1]):r(a)}catch(h){i(n,"throw",h)}}},4576:(c,e,t)=>{var s=t(9504),i=s({}.toString),n=s("".slice);c.exports=function(r){return n(i(r),8,-1)}},6955:(c,e,t)=>{var s=t(2140),i=t(4901),n=t(4576),r=t(8227),a=r("toStringTag"),l=Object,h=n(function(){return arguments}())==="Arguments",d=function(u,f){try{return u[f]}catch{}};c.exports=s?n:function(u){var f,p,m;return u===void 0?"Undefined":u===null?"Null":typeof(p=d(f=l(u),a))=="string"?p:h?n(f):(m=n(f))==="Object"&&i(f.callee)?"Arguments":m}},7740:(c,e,t)=>{var s=t(9297),i=t(5031),n=t(7347),r=t(4913);c.exports=function(a,l,h){for(var d=i(l),u=r.f,f=n.f,p=0;p<d.length;p++){var m=d[p];!s(a,m)&&!(h&&s(h,m))&&u(a,m,f(l,m))}}},2211:(c,e,t)=>{var s=t(9039);c.exports=!s(function(){function i(){}return i.prototype.constructor=null,Object.getPrototypeOf(new i)!==i.prototype})},2529:c=>{c.exports=function(e,t){return{value:e,done:t}}},6699:(c,e,t)=>{var s=t(3724),i=t(4913),n=t(6980);c.exports=s?function(r,a,l){return i.f(r,a,n(1,l))}:function(r,a,l){return r[a]=l,r}},6980:c=>{c.exports=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}},4659:(c,e,t)=>{var s=t(3724),i=t(4913),n=t(6980);c.exports=function(r,a,l){s?i.f(r,a,n(0,l)):r[a]=l}},2106:(c,e,t)=>{var s=t(283),i=t(4913);c.exports=function(n,r,a){return a.get&&s(a.get,r,{getter:!0}),a.set&&s(a.set,r,{setter:!0}),i.f(n,r,a)}},6840:(c,e,t)=>{var s=t(4901),i=t(4913),n=t(283),r=t(9433);c.exports=function(a,l,h,d){d||(d={});var u=d.enumerable,f=d.name!==void 0?d.name:l;if(s(h)&&n(h,f,d),d.global)u?a[l]=h:r(l,h);else{try{d.unsafe?a[l]&&(u=!0):delete a[l]}catch{}u?a[l]=h:i.f(a,l,{value:h,enumerable:!1,configurable:!d.nonConfigurable,writable:!d.nonWritable})}return a}},6279:(c,e,t)=>{var s=t(6840);c.exports=function(i,n,r){for(var a in n)s(i,a,n[a],r);return i}},9433:(c,e,t)=>{var s=t(4475),i=Object.defineProperty;c.exports=function(n,r){try{i(s,n,{value:r,configurable:!0,writable:!0})}catch{s[n]=r}return r}},3724:(c,e,t)=>{var s=t(9039);c.exports=!s(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},4483:(c,e,t)=>{var s=t(4475),i=t(9714),n=t(1548),r=s.structuredClone,a=s.ArrayBuffer,l=s.MessageChannel,h=!1,d,u,f,p;if(n)h=function(m){r(m,{transfer:[m]})};else if(a)try{l||(d=i("worker_threads"),d&&(l=d.MessageChannel)),l&&(u=new l,f=new a(2),p=function(m){u.port1.postMessage(null,[m])},f.byteLength===2&&(p(f),f.byteLength===0&&(h=p)))}catch{}c.exports=h},4055:(c,e,t)=>{var s=t(4475),i=t(34),n=s.document,r=i(n)&&i(n.createElement);c.exports=function(a){return r?n.createElement(a):{}}},6837:c=>{var e=TypeError,t=9007199254740991;c.exports=function(s){if(s>t)throw e("Maximum allowed index exceeded");return s}},5002:c=>{c.exports={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}}},7290:(c,e,t)=>{var s=t(516),i=t(9088);c.exports=!s&&!i&&typeof window=="object"&&typeof document=="object"},516:c=>{c.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},9088:(c,e,t)=>{t(4475);var s=t(4576);c.exports=s(globalThis.process)==="process"},9392:c=>{c.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},7388:(c,e,t)=>{var s=t(4475),i=t(9392),n=s.process,r=s.Deno,a=n&&n.versions||r&&r.version,l=a&&a.v8,h,d;l&&(h=l.split("."),d=h[0]>0&&h[0]<4?1:+(h[0]+h[1])),!d&&i&&(h=i.match(/Edge\/(\d+)/),(!h||h[1]>=74)&&(h=i.match(/Chrome\/(\d+)/),h&&(d=+h[1]))),c.exports=d},8727:c=>{c.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},6193:(c,e,t)=>{var s=t(9504),i=Error,n=s("".replace),r=function(h){return String(new i(h).stack)}("zxcasd"),a=/\n\s*at [^:]*:[^\n]*/,l=a.test(r);c.exports=function(h,d){if(l&&typeof h=="string"&&!i.prepareStackTrace)for(;d--;)h=n(h,a,"");return h}},6518:(c,e,t)=>{var s=t(4475),i=t(7347).f,n=t(6699),r=t(6840),a=t(9433),l=t(7740),h=t(2796);c.exports=function(d,u){var f=d.target,p=d.global,m=d.stat,v,E,A,w,S,C;if(p?E=s:m?E=s[f]||a(f,{}):E=s[f]&&s[f].prototype,E)for(A in u){if(S=u[A],d.dontCallGetSet?(C=i(E,A),w=C&&C.value):w=E[A],v=h(p?A:f+(m?".":"#")+A,d.forced),!v&&w!==void 0){if(typeof S==typeof w)continue;l(S,w)}(d.sham||w&&w.sham)&&n(S,"sham",!0),r(E,A,S,d)}}},9039:c=>{c.exports=function(e){try{return!!e()}catch{return!0}}},6080:(c,e,t)=>{var s=t(7476),i=t(9306),n=t(616),r=s(s.bind);c.exports=function(a,l){return i(a),l===void 0?a:n?r(a,l):function(){return a.apply(l,arguments)}}},616:(c,e,t)=>{var s=t(9039);c.exports=!s(function(){var i=(function(){}).bind();return typeof i!="function"||i.hasOwnProperty("prototype")})},9565:(c,e,t)=>{var s=t(616),i=Function.prototype.call;c.exports=s?i.bind(i):function(){return i.apply(i,arguments)}},350:(c,e,t)=>{var s=t(3724),i=t(9297),n=Function.prototype,r=s&&Object.getOwnPropertyDescriptor,a=i(n,"name"),l=a&&(function(){}).name==="something",h=a&&(!s||s&&r(n,"name").configurable);c.exports={EXISTS:a,PROPER:l,CONFIGURABLE:h}},6706:(c,e,t)=>{var s=t(9504),i=t(9306);c.exports=function(n,r,a){try{return s(i(Object.getOwnPropertyDescriptor(n,r)[a]))}catch{}}},7476:(c,e,t)=>{var s=t(4576),i=t(9504);c.exports=function(n){if(s(n)==="Function")return i(n)}},9504:(c,e,t)=>{var s=t(616),i=Function.prototype,n=i.call,r=s&&i.bind.bind(n,n);c.exports=s?r:function(a){return function(){return n.apply(a,arguments)}}},7751:(c,e,t)=>{var s=t(4475),i=t(4901),n=function(r){return i(r)?r:void 0};c.exports=function(r,a){return arguments.length<2?n(s[r]):s[r]&&s[r][a]}},1767:c=>{c.exports=function(e){return{iterator:e,next:e.next,done:!1}}},8646:(c,e,t)=>{var s=t(9565),i=t(8551),n=t(1767),r=t(851);c.exports=function(a,l){(!l||typeof a!="string")&&i(a);var h=r(a);return n(i(h!==void 0?s(h,a):a))}},851:(c,e,t)=>{var s=t(6955),i=t(5966),n=t(4117),r=t(6269),a=t(8227),l=a("iterator");c.exports=function(h){if(!n(h))return i(h,l)||i(h,"@@iterator")||r[s(h)]}},81:(c,e,t)=>{var s=t(9565),i=t(9306),n=t(8551),r=t(6823),a=t(851),l=TypeError;c.exports=function(h,d){var u=arguments.length<2?a(h):d;if(i(u))return n(s(u,h));throw new l(r(h)+" is not iterable")}},5966:(c,e,t)=>{var s=t(9306),i=t(4117);c.exports=function(n,r){var a=n[r];return i(a)?void 0:s(a)}},3789:(c,e,t)=>{var s=t(9306),i=t(8551),n=t(9565),r=t(1291),a=t(1767),l="Invalid size",h=RangeError,d=TypeError,u=Math.max,f=function(p,m){this.set=p,this.size=u(m,0),this.has=s(p.has),this.keys=s(p.keys)};f.prototype={getIterator:function(){return a(i(n(this.keys,this.set)))},includes:function(p){return n(this.has,this.set,p)}},c.exports=function(p){i(p);var m=+p.size;if(m!==m)throw new d(l);var v=r(m);if(v<0)throw new h(l);return new f(p,v)}},4475:function(c){var e=function(t){return t&&t.Math===Math&&t};c.exports=e(typeof globalThis=="object"&&globalThis)||e(typeof window=="object"&&window)||e(typeof self=="object"&&self)||e(typeof global=="object"&&global)||e(typeof this=="object"&&this)||function(){return this}()||Function("return this")()},9297:(c,e,t)=>{var s=t(9504),i=t(8981),n=s({}.hasOwnProperty);c.exports=Object.hasOwn||function(a,l){return n(i(a),l)}},421:c=>{c.exports={}},397:(c,e,t)=>{var s=t(7751);c.exports=s("document","documentElement")},5917:(c,e,t)=>{var s=t(3724),i=t(9039),n=t(4055);c.exports=!s&&!i(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7})},7055:(c,e,t)=>{var s=t(9504),i=t(9039),n=t(4576),r=Object,a=s("".split);c.exports=i(function(){return!r("z").propertyIsEnumerable(0)})?function(l){return n(l)==="String"?a(l,""):r(l)}:r},3167:(c,e,t)=>{var s=t(4901),i=t(34),n=t(2967);c.exports=function(r,a,l){var h,d;return n&&s(h=a.constructor)&&h!==l&&i(d=h.prototype)&&d!==l.prototype&&n(r,d),r}},3706:(c,e,t)=>{var s=t(9504),i=t(4901),n=t(7629),r=s(Function.toString);i(n.inspectSource)||(n.inspectSource=function(a){return r(a)}),c.exports=n.inspectSource},1181:(c,e,t)=>{var s=t(8622),i=t(4475),n=t(34),r=t(6699),a=t(9297),l=t(7629),h=t(6119),d=t(421),u="Object already initialized",f=i.TypeError,p=i.WeakMap,m,v,E,A=function(x){return E(x)?v(x):m(x,{})},w=function(x){return function(T){var R;if(!n(T)||(R=v(T)).type!==x)throw new f("Incompatible receiver, "+x+" required");return R}};if(s||l.state){var S=l.state||(l.state=new p);S.get=S.get,S.has=S.has,S.set=S.set,m=function(x,T){if(S.has(x))throw new f(u);return T.facade=x,S.set(x,T),T},v=function(x){return S.get(x)||{}},E=function(x){return S.has(x)}}else{var C=h("state");d[C]=!0,m=function(x,T){if(a(x,C))throw new f(u);return T.facade=x,r(x,C,T),T},v=function(x){return a(x,C)?x[C]:{}},E=function(x){return a(x,C)}}c.exports={set:m,get:v,has:E,enforce:A,getterFor:w}},4209:(c,e,t)=>{var s=t(8227),i=t(6269),n=s("iterator"),r=Array.prototype;c.exports=function(a){return a!==void 0&&(i.Array===a||r[n]===a)}},4376:(c,e,t)=>{var s=t(4576);c.exports=Array.isArray||function(n){return s(n)==="Array"}},1108:(c,e,t)=>{var s=t(6955);c.exports=function(i){var n=s(i);return n==="BigInt64Array"||n==="BigUint64Array"}},4901:c=>{var e=typeof document=="object"&&document.all;c.exports=typeof e>"u"&&e!==void 0?function(t){return typeof t=="function"||t===e}:function(t){return typeof t=="function"}},2796:(c,e,t)=>{var s=t(9039),i=t(4901),n=/#|\.prototype\./,r=function(u,f){var p=l[a(u)];return p===d?!0:p===h?!1:i(f)?s(f):!!f},a=r.normalize=function(u){return String(u).replace(n,".").toLowerCase()},l=r.data={},h=r.NATIVE="N",d=r.POLYFILL="P";c.exports=r},4117:c=>{c.exports=function(e){return e==null}},34:(c,e,t)=>{var s=t(4901);c.exports=function(i){return typeof i=="object"?i!==null:s(i)}},3925:(c,e,t)=>{var s=t(34);c.exports=function(i){return s(i)||i===null}},6395:c=>{c.exports=!1},757:(c,e,t)=>{var s=t(7751),i=t(4901),n=t(1625),r=t(7040),a=Object;c.exports=r?function(l){return typeof l=="symbol"}:function(l){var h=s("Symbol");return i(h)&&n(h.prototype,a(l))}},507:(c,e,t)=>{var s=t(9565);c.exports=function(i,n,r){for(var a=r?i:i.iterator,l=i.next,h,d;!(h=s(l,a)).done;)if(d=n(h.value),d!==void 0)return d}},2652:(c,e,t)=>{var s=t(6080),i=t(9565),n=t(8551),r=t(6823),a=t(4209),l=t(6198),h=t(1625),d=t(81),u=t(851),f=t(9539),p=TypeError,m=function(E,A){this.stopped=E,this.result=A},v=m.prototype;c.exports=function(E,A,w){var S=w&&w.that,C=!!(w&&w.AS_ENTRIES),x=!!(w&&w.IS_RECORD),T=!!(w&&w.IS_ITERATOR),R=!!(w&&w.INTERRUPTED),I=s(A,S),P,O,L,W,H,X,Y,K=function(k){return P&&f(P,"normal",k),new m(!0,k)},F=function(k){return C?(n(k),R?I(k[0],k[1],K):I(k[0],k[1])):R?I(k,K):I(k)};if(x)P=E.iterator;else if(T)P=E;else{if(O=u(E),!O)throw new p(r(E)+" is not iterable");if(a(O)){for(L=0,W=l(E);W>L;L++)if(H=F(E[L]),H&&h(v,H))return H;return new m(!1)}P=d(E,O)}for(X=x?E.next:P.next;!(Y=i(X,P)).done;){try{H=F(Y.value)}catch(k){f(P,"throw",k)}if(typeof H=="object"&&H&&h(v,H))return H}return new m(!1)}},9539:(c,e,t)=>{var s=t(9565),i=t(8551),n=t(5966);c.exports=function(r,a,l){var h,d;i(r);try{if(h=n(r,"return"),!h){if(a==="throw")throw l;return l}h=s(h,r)}catch(u){d=!0,h=u}if(a==="throw")throw l;if(d)throw h;return i(h),l}},9462:(c,e,t)=>{var s=t(9565),i=t(2360),n=t(6699),r=t(6279),a=t(8227),l=t(1181),h=t(5966),d=t(7657).IteratorPrototype,u=t(2529),f=t(9539),p=a("toStringTag"),m="IteratorHelper",v="WrapForValidIterator",E=l.set,A=function(C){var x=l.getterFor(C?v:m);return r(i(d),{next:function(){var R=x(this);if(C)return R.nextHandler();try{var I=R.done?void 0:R.nextHandler();return u(I,R.done)}catch(P){throw R.done=!0,P}},return:function(){var T=x(this),R=T.iterator;if(T.done=!0,C){var I=h(R,"return");return I?s(I,R):u(void 0,!0)}if(T.inner)try{f(T.inner.iterator,"normal")}catch(P){return f(R,"throw",P)}return f(R,"normal"),u(void 0,!0)}})},w=A(!0),S=A(!1);n(S,p,"Iterator Helper"),c.exports=function(C,x){var T=function(I,P){P?(P.iterator=I.iterator,P.next=I.next):P=I,P.type=x?v:m,P.nextHandler=C,P.counter=0,P.done=!1,E(this,P)};return T.prototype=x?w:S,T}},713:(c,e,t)=>{var s=t(9565),i=t(9306),n=t(8551),r=t(1767),a=t(9462),l=t(6319),h=a(function(){var d=this.iterator,u=n(s(this.next,d)),f=this.done=!!u.done;if(!f)return l(d,this.mapper,[u.value,this.counter++],!0)});c.exports=function(u){return n(this),i(u),new h(r(this),{mapper:u})}},7657:(c,e,t)=>{var s=t(9039),i=t(4901),n=t(34),r=t(2360),a=t(2787),l=t(6840),h=t(8227),d=t(6395),u=h("iterator"),f=!1,p,m,v;[].keys&&(v=[].keys(),"next"in v?(m=a(a(v)),m!==Object.prototype&&(p=m)):f=!0);var E=!n(p)||s(function(){var A={};return p[u].call(A)!==A});E?p={}:d&&(p=r(p)),i(p[u])||l(p,u,function(){return this}),c.exports={IteratorPrototype:p,BUGGY_SAFARI_ITERATORS:f}},6269:c=>{c.exports={}},6198:(c,e,t)=>{var s=t(8014);c.exports=function(i){return s(i.length)}},283:(c,e,t)=>{var s=t(9504),i=t(9039),n=t(4901),r=t(9297),a=t(3724),l=t(350).CONFIGURABLE,h=t(3706),d=t(1181),u=d.enforce,f=d.get,p=String,m=Object.defineProperty,v=s("".slice),E=s("".replace),A=s([].join),w=a&&!i(function(){return m(function(){},"length",{value:8}).length!==8}),S=String(String).split("String"),C=c.exports=function(x,T,R){v(p(T),0,7)==="Symbol("&&(T="["+E(p(T),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),R&&R.getter&&(T="get "+T),R&&R.setter&&(T="set "+T),(!r(x,"name")||l&&x.name!==T)&&(a?m(x,"name",{value:T,configurable:!0}):x.name=T),w&&R&&r(R,"arity")&&x.length!==R.arity&&m(x,"length",{value:R.arity});try{R&&r(R,"constructor")&&R.constructor?a&&m(x,"prototype",{writable:!1}):x.prototype&&(x.prototype=void 0)}catch{}var I=u(x);return r(I,"source")||(I.source=A(S,typeof T=="string"?T:"")),x};Function.prototype.toString=C(function(){return n(this)&&f(this).source||h(this)},"toString")},741:c=>{var e=Math.ceil,t=Math.floor;c.exports=Math.trunc||function(i){var n=+i;return(n>0?t:e)(n)}},6043:(c,e,t)=>{var s=t(9306),i=TypeError,n=function(r){var a,l;this.promise=new r(function(h,d){if(a!==void 0||l!==void 0)throw new i("Bad Promise constructor");a=h,l=d}),this.resolve=s(a),this.reject=s(l)};c.exports.f=function(r){return new n(r)}},2603:(c,e,t)=>{var s=t(655);c.exports=function(i,n){return i===void 0?arguments.length<2?"":n:s(i)}},4149:c=>{var e=RangeError;c.exports=function(t){if(t===t)return t;throw new e("NaN is not allowed")}},2360:(c,e,t)=>{var s=t(8551),i=t(6801),n=t(8727),r=t(421),a=t(397),l=t(4055),h=t(6119),d=">",u="<",f="prototype",p="script",m=h("IE_PROTO"),v=function(){},E=function(x){return u+p+d+x+u+"/"+p+d},A=function(x){x.write(E("")),x.close();var T=x.parentWindow.Object;return x=null,T},w=function(){var x=l("iframe"),T="java"+p+":",R;return x.style.display="none",a.appendChild(x),x.src=String(T),R=x.contentWindow.document,R.open(),R.write(E("document.F=Object")),R.close(),R.F},S,C=function(){try{S=new ActiveXObject("htmlfile")}catch{}C=typeof document<"u"?document.domain&&S?A(S):w():A(S);for(var x=n.length;x--;)delete C[f][n[x]];return C()};r[m]=!0,c.exports=Object.create||function(T,R){var I;return T!==null?(v[f]=s(T),I=new v,v[f]=null,I[m]=T):I=C(),R===void 0?I:i.f(I,R)}},6801:(c,e,t)=>{var s=t(3724),i=t(8686),n=t(4913),r=t(8551),a=t(5397),l=t(1072);e.f=s&&!i?Object.defineProperties:function(d,u){r(d);for(var f=a(u),p=l(u),m=p.length,v=0,E;m>v;)n.f(d,E=p[v++],f[E]);return d}},4913:(c,e,t)=>{var s=t(3724),i=t(5917),n=t(8686),r=t(8551),a=t(6969),l=TypeError,h=Object.defineProperty,d=Object.getOwnPropertyDescriptor,u="enumerable",f="configurable",p="writable";e.f=s?n?function(v,E,A){if(r(v),E=a(E),r(A),typeof v=="function"&&E==="prototype"&&"value"in A&&p in A&&!A[p]){var w=d(v,E);w&&w[p]&&(v[E]=A.value,A={configurable:f in A?A[f]:w[f],enumerable:u in A?A[u]:w[u],writable:!1})}return h(v,E,A)}:h:function(v,E,A){if(r(v),E=a(E),r(A),i)try{return h(v,E,A)}catch{}if("get"in A||"set"in A)throw new l("Accessors not supported");return"value"in A&&(v[E]=A.value),v}},7347:(c,e,t)=>{var s=t(3724),i=t(9565),n=t(8773),r=t(6980),a=t(5397),l=t(6969),h=t(9297),d=t(5917),u=Object.getOwnPropertyDescriptor;e.f=s?u:function(p,m){if(p=a(p),m=l(m),d)try{return u(p,m)}catch{}if(h(p,m))return r(!i(n.f,p,m),p[m])}},8480:(c,e,t)=>{var s=t(1828),i=t(8727),n=i.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(a){return s(a,n)}},3717:(c,e)=>{e.f=Object.getOwnPropertySymbols},2787:(c,e,t)=>{var s=t(9297),i=t(4901),n=t(8981),r=t(6119),a=t(2211),l=r("IE_PROTO"),h=Object,d=h.prototype;c.exports=a?h.getPrototypeOf:function(u){var f=n(u);if(s(f,l))return f[l];var p=f.constructor;return i(p)&&f instanceof p?p.prototype:f instanceof h?d:null}},1625:(c,e,t)=>{var s=t(9504);c.exports=s({}.isPrototypeOf)},1828:(c,e,t)=>{var s=t(9504),i=t(9297),n=t(5397),r=t(9617).indexOf,a=t(421),l=s([].push);c.exports=function(h,d){var u=n(h),f=0,p=[],m;for(m in u)!i(a,m)&&i(u,m)&&l(p,m);for(;d.length>f;)i(u,m=d[f++])&&(~r(p,m)||l(p,m));return p}},1072:(c,e,t)=>{var s=t(1828),i=t(8727);c.exports=Object.keys||function(r){return s(r,i)}},8773:(c,e)=>{var t={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,i=s&&!t.call({1:2},1);e.f=i?function(r){var a=s(this,r);return!!a&&a.enumerable}:t},2967:(c,e,t)=>{var s=t(6706),i=t(34),n=t(7750),r=t(3506);c.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var a=!1,l={},h;try{h=s(Object.prototype,"__proto__","set"),h(l,[]),a=l instanceof Array}catch{}return function(u,f){return n(u),r(f),i(u)&&(a?h(u,f):u.__proto__=f),u}}():void 0)},4270:(c,e,t)=>{var s=t(9565),i=t(4901),n=t(34),r=TypeError;c.exports=function(a,l){var h,d;if(l==="string"&&i(h=a.toString)&&!n(d=s(h,a))||i(h=a.valueOf)&&!n(d=s(h,a))||l!=="string"&&i(h=a.toString)&&!n(d=s(h,a)))return d;throw new r("Can't convert object to primitive value")}},5031:(c,e,t)=>{var s=t(7751),i=t(9504),n=t(8480),r=t(3717),a=t(8551),l=i([].concat);c.exports=s("Reflect","ownKeys")||function(d){var u=n.f(a(d)),f=r.f;return f?l(u,f(d)):u}},8235:(c,e,t)=>{var s=t(9504),i=t(9297),n=SyntaxError,r=parseInt,a=String.fromCharCode,l=s("".charAt),h=s("".slice),d=s(/./.exec),u={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},f=/^[\da-f]{4}$/i,p=/^[\u0000-\u001F]$/;c.exports=function(m,v){for(var E=!0,A="";v<m.length;){var w=l(m,v);if(w==="\\"){var S=h(m,v,v+2);if(i(u,S))A+=u[S],v+=2;else if(S==="\\u"){v+=2;var C=h(m,v,v+4);if(!d(f,C))throw new n("Bad Unicode escape at: "+v);A+=a(r(C,16)),v+=4}else throw new n('Unknown escape sequence: "'+S+'"')}else if(w==='"'){E=!1,v++;break}else{if(d(p,w))throw new n("Bad control character in string literal at: "+v);A+=w,v++}}if(E)throw new n("Unterminated string at: "+v);return{value:A,end:v}}},7750:(c,e,t)=>{var s=t(4117),i=TypeError;c.exports=function(n){if(s(n))throw new i("Can't call method on "+n);return n}},9286:(c,e,t)=>{var s=t(4402),i=t(8469),n=s.Set,r=s.add;c.exports=function(a){var l=new n;return i(a,function(h){r(l,h)}),l}},3440:(c,e,t)=>{var s=t(7080),i=t(4402),n=t(9286),r=t(5170),a=t(3789),l=t(8469),h=t(507),d=i.has,u=i.remove;c.exports=function(p){var m=s(this),v=a(p),E=n(m);return r(m)<=v.size?l(m,function(A){v.includes(A)&&u(E,A)}):h(v.getIterator(),function(A){d(m,A)&&u(E,A)}),E}},4402:(c,e,t)=>{var s=t(9504),i=Set.prototype;c.exports={Set,add:s(i.add),has:s(i.has),remove:s(i.delete),proto:i}},8750:(c,e,t)=>{var s=t(7080),i=t(4402),n=t(5170),r=t(3789),a=t(8469),l=t(507),h=i.Set,d=i.add,u=i.has;c.exports=function(p){var m=s(this),v=r(p),E=new h;return n(m)>v.size?l(v.getIterator(),function(A){u(m,A)&&d(E,A)}):a(m,function(A){v.includes(A)&&d(E,A)}),E}},4449:(c,e,t)=>{var s=t(7080),i=t(4402).has,n=t(5170),r=t(3789),a=t(8469),l=t(507),h=t(9539);c.exports=function(u){var f=s(this),p=r(u);if(n(f)<=p.size)return a(f,function(v){if(p.includes(v))return!1},!0)!==!1;var m=p.getIterator();return l(m,function(v){if(i(f,v))return h(m,"normal",!1)})!==!1}},3838:(c,e,t)=>{var s=t(7080),i=t(5170),n=t(8469),r=t(3789);c.exports=function(l){var h=s(this),d=r(l);return i(h)>d.size?!1:n(h,function(u){if(!d.includes(u))return!1},!0)!==!1}},8527:(c,e,t)=>{var s=t(7080),i=t(4402).has,n=t(5170),r=t(3789),a=t(507),l=t(9539);c.exports=function(d){var u=s(this),f=r(d);if(n(u)<f.size)return!1;var p=f.getIterator();return a(p,function(m){if(!i(u,m))return l(p,"normal",!1)})!==!1}},8469:(c,e,t)=>{var s=t(9504),i=t(507),n=t(4402),r=n.Set,a=n.proto,l=s(a.forEach),h=s(a.keys),d=h(new r).next;c.exports=function(u,f,p){return p?i({iterator:h(u),next:d},f):l(u,f)}},4916:(c,e,t)=>{var s=t(7751),i=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}};c.exports=function(n){var r=s("Set");try{new r()[n](i(0));try{return new r()[n](i(-1)),!1}catch{return!0}}catch{return!1}}},5170:(c,e,t)=>{var s=t(6706),i=t(4402);c.exports=s(i.proto,"size","get")||function(n){return n.size}},3650:(c,e,t)=>{var s=t(7080),i=t(4402),n=t(9286),r=t(3789),a=t(507),l=i.add,h=i.has,d=i.remove;c.exports=function(f){var p=s(this),m=r(f).getIterator(),v=n(p);return a(m,function(E){h(p,E)?d(v,E):l(v,E)}),v}},4204:(c,e,t)=>{var s=t(7080),i=t(4402).add,n=t(9286),r=t(3789),a=t(507);c.exports=function(h){var d=s(this),u=r(h).getIterator(),f=n(d);return a(u,function(p){i(f,p)}),f}},6119:(c,e,t)=>{var s=t(5745),i=t(3392),n=s("keys");c.exports=function(r){return n[r]||(n[r]=i(r))}},7629:(c,e,t)=>{var s=t(6395),i=t(4475),n=t(9433),r="__core-js_shared__",a=c.exports=i[r]||n(r,{});(a.versions||(a.versions=[])).push({version:"3.37.1",mode:s?"pure":"global",copyright:"Â© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.1/LICENSE",source:"https://github.com/zloirock/core-js"})},5745:(c,e,t)=>{var s=t(7629);c.exports=function(i,n){return s[i]||(s[i]=n||{})}},1548:(c,e,t)=>{var s=t(4475),i=t(9039),n=t(7388),r=t(7290),a=t(516),l=t(9088),h=s.structuredClone;c.exports=!!h&&!i(function(){if(a&&n>92||l&&n>94||r&&n>97)return!1;var d=new ArrayBuffer(8),u=h(d,{transfer:[d]});return d.byteLength!==0||u.byteLength!==8})},4495:(c,e,t)=>{var s=t(7388),i=t(9039),n=t(4475),r=n.String;c.exports=!!Object.getOwnPropertySymbols&&!i(function(){var a=Symbol("symbol detection");return!r(a)||!(Object(a)instanceof Symbol)||!Symbol.sham&&s&&s<41})},5610:(c,e,t)=>{var s=t(1291),i=Math.max,n=Math.min;c.exports=function(r,a){var l=s(r);return l<0?i(l+a,0):n(l,a)}},5854:(c,e,t)=>{var s=t(2777),i=TypeError;c.exports=function(n){var r=s(n,"number");if(typeof r=="number")throw new i("Can't convert number to bigint");return BigInt(r)}},7696:(c,e,t)=>{var s=t(1291),i=t(8014),n=RangeError;c.exports=function(r){if(r===void 0)return 0;var a=s(r),l=i(a);if(a!==l)throw new n("Wrong length or index");return l}},5397:(c,e,t)=>{var s=t(7055),i=t(7750);c.exports=function(n){return s(i(n))}},1291:(c,e,t)=>{var s=t(741);c.exports=function(i){var n=+i;return n!==n||n===0?0:s(n)}},8014:(c,e,t)=>{var s=t(1291),i=Math.min;c.exports=function(n){var r=s(n);return r>0?i(r,9007199254740991):0}},8981:(c,e,t)=>{var s=t(7750),i=Object;c.exports=function(n){return i(s(n))}},9590:(c,e,t)=>{var s=t(1291),i=RangeError;c.exports=function(n){var r=s(n);if(r<0)throw new i("The argument can't be less than 0");return r}},2777:(c,e,t)=>{var s=t(9565),i=t(34),n=t(757),r=t(5966),a=t(4270),l=t(8227),h=TypeError,d=l("toPrimitive");c.exports=function(u,f){if(!i(u)||n(u))return u;var p=r(u,d),m;if(p){if(f===void 0&&(f="default"),m=s(p,u,f),!i(m)||n(m))return m;throw new h("Can't convert object to primitive value")}return f===void 0&&(f="number"),a(u,f)}},6969:(c,e,t)=>{var s=t(2777),i=t(757);c.exports=function(n){var r=s(n,"string");return i(r)?r:r+""}},2140:(c,e,t)=>{var s=t(8227),i=s("toStringTag"),n={};n[i]="z",c.exports=String(n)==="[object z]"},655:(c,e,t)=>{var s=t(6955),i=String;c.exports=function(n){if(s(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return i(n)}},9714:(c,e,t)=>{var s=t(9088);c.exports=function(i){try{if(s)return Function('return require("'+i+'")')()}catch{}}},6823:c=>{var e=String;c.exports=function(t){try{return e(t)}catch{return"Object"}}},3392:(c,e,t)=>{var s=t(9504),i=0,n=Math.random(),r=s(1 .toString);c.exports=function(a){return"Symbol("+(a===void 0?"":a)+")_"+r(++i+n,36)}},7040:(c,e,t)=>{var s=t(4495);c.exports=s&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},8686:(c,e,t)=>{var s=t(3724),i=t(9039);c.exports=s&&i(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},2812:c=>{var e=TypeError;c.exports=function(t,s){if(t<s)throw new e("Not enough arguments");return t}},8622:(c,e,t)=>{var s=t(4475),i=t(4901),n=s.WeakMap;c.exports=i(n)&&/native code/.test(String(n))},8227:(c,e,t)=>{var s=t(4475),i=t(5745),n=t(9297),r=t(3392),a=t(4495),l=t(7040),h=s.Symbol,d=i("wks"),u=l?h.for||h:h&&h.withoutSetter||r;c.exports=function(f){return n(d,f)||(d[f]=a&&n(h,f)?h[f]:u("Symbol."+f)),d[f]}},6573:(c,e,t)=>{var s=t(3724),i=t(2106),n=t(3238),r=ArrayBuffer.prototype;s&&!("detached"in r)&&i(r,"detached",{configurable:!0,get:function(){return n(this)}})},7936:(c,e,t)=>{var s=t(6518),i=t(5636);i&&s({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return i(this,arguments.length?arguments[0]:void 0,!1)}})},8100:(c,e,t)=>{var s=t(6518),i=t(5636);i&&s({target:"ArrayBuffer",proto:!0},{transfer:function(){return i(this,arguments.length?arguments[0]:void 0,!0)}})},4114:(c,e,t)=>{var s=t(6518),i=t(8981),n=t(6198),r=t(4527),a=t(6837),l=t(9039),h=l(function(){return[].push.call({length:4294967296},1)!==4294967297}),d=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(f){return f instanceof TypeError}},u=h||!d();s({target:"Array",proto:!0,arity:1,forced:u},{push:function(p){var m=i(this),v=n(m),E=arguments.length;a(v+E);for(var A=0;A<E;A++)m[v]=arguments[A],v++;return r(m,v),v}})},4628:(c,e,t)=>{var s=t(6518),i=t(6043);s({target:"Promise",stat:!0},{withResolvers:function(){var r=i.f(this);return{promise:r.promise,resolve:r.resolve,reject:r.reject}}})},7642:(c,e,t)=>{var s=t(6518),i=t(3440),n=t(4916);s({target:"Set",proto:!0,real:!0,forced:!n("difference")},{difference:i})},8004:(c,e,t)=>{var s=t(6518),i=t(9039),n=t(8750),r=t(4916),a=!r("intersection")||i(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});s({target:"Set",proto:!0,real:!0,forced:a},{intersection:n})},3853:(c,e,t)=>{var s=t(6518),i=t(4449),n=t(4916);s({target:"Set",proto:!0,real:!0,forced:!n("isDisjointFrom")},{isDisjointFrom:i})},5876:(c,e,t)=>{var s=t(6518),i=t(3838),n=t(4916);s({target:"Set",proto:!0,real:!0,forced:!n("isSubsetOf")},{isSubsetOf:i})},2475:(c,e,t)=>{var s=t(6518),i=t(8527),n=t(4916);s({target:"Set",proto:!0,real:!0,forced:!n("isSupersetOf")},{isSupersetOf:i})},5024:(c,e,t)=>{var s=t(6518),i=t(3650),n=t(4916);s({target:"Set",proto:!0,real:!0,forced:!n("symmetricDifference")},{symmetricDifference:i})},1698:(c,e,t)=>{var s=t(6518),i=t(4204),n=t(4916);s({target:"Set",proto:!0,real:!0,forced:!n("union")},{union:i})},7467:(c,e,t)=>{var s=t(7628),i=t(4644),n=i.aTypedArray,r=i.exportTypedArrayMethod,a=i.getTypedArrayConstructor;r("toReversed",function(){return s(n(this),a(this))})},4732:(c,e,t)=>{var s=t(4644),i=t(9504),n=t(9306),r=t(5370),a=s.aTypedArray,l=s.getTypedArrayConstructor,h=s.exportTypedArrayMethod,d=i(s.TypedArrayPrototype.sort);h("toSorted",function(f){f!==void 0&&n(f);var p=a(this),m=r(l(p),p);return d(m,f)})},9577:(c,e,t)=>{var s=t(9928),i=t(4644),n=t(1108),r=t(1291),a=t(5854),l=i.aTypedArray,h=i.getTypedArrayConstructor,d=i.exportTypedArrayMethod,u=!!function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(f){return f===8}}();d("with",function(f,p){var m=l(this),v=r(f),E=n(m)?a(p):+p;return s(m,h(m),v,E)},!u)},8992:(c,e,t)=>{var s=t(6518),i=t(4475),n=t(679),r=t(8551),a=t(4901),l=t(2787),h=t(2106),d=t(4659),u=t(9039),f=t(9297),p=t(8227),m=t(7657).IteratorPrototype,v=t(3724),E=t(6395),A="constructor",w="Iterator",S=p("toStringTag"),C=TypeError,x=i[w],T=E||!a(x)||x.prototype!==m||!u(function(){x({})}),R=function(){if(n(this,m),l(this)===m)throw new C("Abstract class Iterator not directly constructable")},I=function(P,O){v?h(m,P,{configurable:!0,get:function(){return O},set:function(L){if(r(this),this===m)throw new C("You can't redefine this property");f(this,P)?this[P]=L:d(this,P,L)}}):m[P]=O};f(m,S)||I(S,w),(T||!f(m,A)||m[A]===Object)&&I(A,R),R.prototype=m,s({global:!0,constructor:!0,forced:T},{Iterator:R})},4743:(c,e,t)=>{var s=t(6518),i=t(9565),n=t(8551),r=t(1767),a=t(4149),l=t(9590),h=t(9462),d=t(6395),u=h(function(){for(var f=this.iterator,p=this.next,m,v;this.remaining;)if(this.remaining--,m=n(i(p,f)),v=this.done=!!m.done,v)return;if(m=n(i(p,f)),v=this.done=!!m.done,!v)return m.value});s({target:"Iterator",proto:!0,real:!0,forced:d},{drop:function(p){n(this);var m=l(a(+p));return new u(r(this),{remaining:m})}})},3215:(c,e,t)=>{var s=t(6518),i=t(2652),n=t(9306),r=t(8551),a=t(1767);s({target:"Iterator",proto:!0,real:!0},{every:function(h){r(this),n(h);var d=a(this),u=0;return!i(d,function(f,p){if(!h(f,u++))return p()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},4520:(c,e,t)=>{var s=t(6518),i=t(9565),n=t(9306),r=t(8551),a=t(1767),l=t(9462),h=t(6319),d=t(6395),u=l(function(){for(var f=this.iterator,p=this.predicate,m=this.next,v,E,A;;){if(v=r(i(m,f)),E=this.done=!!v.done,E)return;if(A=v.value,h(f,p,[A,this.counter++],!0))return A}});s({target:"Iterator",proto:!0,real:!0,forced:d},{filter:function(p){return r(this),n(p),new u(a(this),{predicate:p})}})},670:(c,e,t)=>{var s=t(6518),i=t(9565),n=t(9306),r=t(8551),a=t(1767),l=t(8646),h=t(9462),d=t(9539),u=t(6395),f=h(function(){for(var p=this.iterator,m=this.mapper,v,E;;){if(E=this.inner)try{if(v=r(i(E.next,E.iterator)),!v.done)return v.value;this.inner=null}catch(A){d(p,"throw",A)}if(v=r(i(this.next,p)),this.done=!!v.done)return;try{this.inner=l(m(v.value,this.counter++),!1)}catch(A){d(p,"throw",A)}}});s({target:"Iterator",proto:!0,real:!0,forced:u},{flatMap:function(m){return r(this),n(m),new f(a(this),{mapper:m,inner:null})}})},1454:(c,e,t)=>{var s=t(6518),i=t(713),n=t(6395);s({target:"Iterator",proto:!0,real:!0,forced:n},{map:i})},7550:(c,e,t)=>{var s=t(6518),i=t(2652),n=t(9306),r=t(8551),a=t(1767);s({target:"Iterator",proto:!0,real:!0},{some:function(h){r(this),n(h);var d=a(this),u=0;return i(d,function(f,p){if(h(f,u++))return p()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},8335:(c,e,t)=>{var s=t(6518),i=t(3724),n=t(4475),r=t(7751),a=t(9504),l=t(9565),h=t(4901),d=t(34),u=t(4376),f=t(9297),p=t(655),m=t(6198),v=t(4659),E=t(9039),A=t(8235),w=t(4495),S=n.JSON,C=n.Number,x=n.SyntaxError,T=S&&S.parse,R=r("Object","keys"),I=Object.getOwnPropertyDescriptor,P=a("".charAt),O=a("".slice),L=a(/./.exec),W=a([].push),H=/^\d$/,X=/^[1-9]$/,Y=/^(?:-|\d)$/,K=/^[\t\n\r ]$/,F=0,k=1,lt=function(D,M){D=p(D);var _=new ht(D,0),G=_.parse(),ct=G.value,U=_.skip(K,G.end);if(U<D.length)throw new x('Unexpected extra character: "'+P(D,U)+'" after the parsed data at: '+U);return h(M)?bt({"":ct},"",M,G):ct},bt=function(D,M,_,G){var ct=D[M],U=G&&ct===G.value,ft=U&&typeof G.source=="string"?{source:G.source}:{},pt,Fe,Wt,Ct,$n;if(d(ct)){var Vd=u(ct),ch=U?G.nodes:Vd?[]:{};if(Vd)for(pt=ch.length,Wt=m(ct),Ct=0;Ct<Wt;Ct++)Qt(ct,Ct,bt(ct,""+Ct,_,Ct<pt?ch[Ct]:void 0));else for(Fe=R(ct),Wt=m(Fe),Ct=0;Ct<Wt;Ct++)$n=Fe[Ct],Qt(ct,$n,bt(ct,$n,_,f(ch,$n)?ch[$n]:void 0))}return l(_,D,M,ct,ft)},Qt=function(D,M,_){if(i){var G=I(D,M);if(G&&!G.configurable)return}_===void 0?delete D[M]:v(D,M,_)},rt=function(D,M,_,G){this.value=D,this.end=M,this.source=_,this.nodes=G},ht=function(D,M){this.source=D,this.index=M};ht.prototype={fork:function(D){return new ht(this.source,D)},parse:function(){var D=this.source,M=this.skip(K,this.index),_=this.fork(M),G=P(D,M);if(L(Y,G))return _.number();switch(G){case"{":return _.object();case"[":return _.array();case'"':return _.string();case"t":return _.keyword(!0);case"f":return _.keyword(!1);case"n":return _.keyword(null)}throw new x('Unexpected character: "'+G+'" at: '+M)},node:function(D,M,_,G,ct){return new rt(M,G,D?null:O(this.source,_,G),ct)},object:function(){for(var D=this.source,M=this.index+1,_=!1,G={},ct={};M<D.length;){if(M=this.until(['"',"}"],M),P(D,M)==="}"&&!_){M++;break}var U=this.fork(M).string(),ft=U.value;M=U.end,M=this.until([":"],M)+1,M=this.skip(K,M),U=this.fork(M).parse(),v(ct,ft,U),v(G,ft,U.value),M=this.until([",","}"],U.end);var pt=P(D,M);if(pt===",")_=!0,M++;else if(pt==="}"){M++;break}}return this.node(k,G,this.index,M,ct)},array:function(){for(var D=this.source,M=this.index+1,_=!1,G=[],ct=[];M<D.length;){if(M=this.skip(K,M),P(D,M)==="]"&&!_){M++;break}var U=this.fork(M).parse();if(W(ct,U),W(G,U.value),M=this.until([",","]"],U.end),P(D,M)===",")_=!0,M++;else if(P(D,M)==="]"){M++;break}}return this.node(k,G,this.index,M,ct)},string:function(){var D=this.index,M=A(this.source,this.index+1);return this.node(F,M.value,D,M.end)},number:function(){var D=this.source,M=this.index,_=M;if(P(D,_)==="-"&&_++,P(D,_)==="0")_++;else if(L(X,P(D,_)))_=this.skip(H,++_);else throw new x("Failed to parse number at: "+_);if(P(D,_)==="."&&(_=this.skip(H,++_)),P(D,_)==="e"||P(D,_)==="E"){_++,(P(D,_)==="+"||P(D,_)==="-")&&_++;var G=_;if(_=this.skip(H,_),G===_)throw new x("Failed to parse number's exponent value at: "+_)}return this.node(F,C(O(D,M,_)),M,_)},keyword:function(D){var M=""+D,_=this.index,G=_+M.length;if(O(this.source,_,G)!==M)throw new x("Failed to parse value at: "+_);return this.node(F,D,_,G)},skip:function(D,M){for(var _=this.source;M<_.length&&L(D,P(_,M));M++);return M},until:function(D,M){M=this.skip(K,M);for(var _=P(this.source,M),G=0;G<D.length;G++)if(D[G]===_)return M;throw new x('Unexpected character: "'+_+'" at: '+M)}};var Bs=E(function(){var D="9007199254740993",M;return T(D,function(_,G,ct){M=ct.source}),M!==D}),pe=w&&!E(function(){return 1/T("-0 	")!==-1/0});s({target:"JSON",stat:!0,forced:Bs},{parse:function(M,_){return pe&&!h(_)?T(M):lt(M,_)}})},3375:(c,e,t)=>{t(7642)},9225:(c,e,t)=>{t(8004)},3972:(c,e,t)=>{t(3853)},9209:(c,e,t)=>{t(5876)},5714:(c,e,t)=>{t(2475)},7561:(c,e,t)=>{t(5024)},6197:(c,e,t)=>{t(1698)},4979:(c,e,t)=>{var s=t(6518),i=t(4475),n=t(7751),r=t(6980),a=t(4913).f,l=t(9297),h=t(679),d=t(3167),u=t(2603),f=t(5002),p=t(6193),m=t(3724),v=t(6395),E="DOMException",A=n("Error"),w=n(E),S=function(){h(this,C);var K=arguments.length,F=u(K<1?void 0:arguments[0]),k=u(K<2?void 0:arguments[1],"Error"),lt=new w(F,k),bt=new A(F);return bt.name=E,a(lt,"stack",r(1,p(bt.stack,1))),d(lt,this,S),lt},C=S.prototype=w.prototype,x="stack"in new A(E),T="stack"in new w(1,2),R=w&&m&&Object.getOwnPropertyDescriptor(i,E),I=!!R&&!(R.writable&&R.configurable),P=x&&!I&&!T;s({global:!0,constructor:!0,forced:v||P},{DOMException:P?S:w});var O=n(E),L=O.prototype;if(L.constructor!==O){v||a(L,"constructor",r(1,O));for(var W in f)if(l(f,W)){var H=f[W],X=H.s;l(O,X)||a(O,X,r(6,H.c))}}},4603:(c,e,t)=>{var s=t(6840),i=t(9504),n=t(655),r=t(2812),a=URLSearchParams,l=a.prototype,h=i(l.append),d=i(l.delete),u=i(l.forEach),f=i([].push),p=new a("a=1&a=2&b=3");p.delete("a",1),p.delete("b",void 0),p+""!="a=2"&&s(l,"delete",function(m){var v=arguments.length,E=v<2?void 0:arguments[1];if(v&&E===void 0)return d(this,m);var A=[];u(this,function(P,O){f(A,{key:O,value:P})}),r(v,1);for(var w=n(m),S=n(E),C=0,x=0,T=!1,R=A.length,I;C<R;)I=A[C++],T||I.key===w?(T=!0,d(this,I.key)):x++;for(;x<R;)I=A[x++],I.key===w&&I.value===S||h(this,I.key,I.value)},{enumerable:!0,unsafe:!0})},7566:(c,e,t)=>{var s=t(6840),i=t(9504),n=t(655),r=t(2812),a=URLSearchParams,l=a.prototype,h=i(l.getAll),d=i(l.has),u=new a("a=1");(u.has("a",2)||!u.has("a",void 0))&&s(l,"has",function(p){var m=arguments.length,v=m<2?void 0:arguments[1];if(m&&v===void 0)return d(this,p);var E=h(this,p);r(m,1);for(var A=n(v),w=0;w<E.length;)if(E[w++]===A)return!0;return!1},{enumerable:!0,unsafe:!0})},8721:(c,e,t)=>{var s=t(3724),i=t(9504),n=t(2106),r=URLSearchParams.prototype,a=i(r.forEach);s&&!("size"in r)&&n(r,"size",{get:function(){var h=0;return a(this,function(){h++}),h},configurable:!0,enumerable:!0})}},If={};function tt(c){var e=If[c];if(e!==void 0)return e.exports;var t=If[c]={exports:{}};return Yg[c].call(t.exports,t,t.exports,tt),t.exports}tt.d=(c,e)=>{for(var t in e)tt.o(e,t)&&!tt.o(c,t)&&Object.defineProperty(c,t,{enumerable:!0,get:e[t]})};tt.o=(c,e)=>Object.prototype.hasOwnProperty.call(c,e);var $=globalThis.pdfjsLib={};tt.d($,{AbortException:()=>Un,AnnotationEditorLayer:()=>hf,AnnotationEditorParamsType:()=>j,AnnotationEditorType:()=>J,AnnotationEditorUIManager:()=>Nn,AnnotationLayer:()=>Gv,AnnotationMode:()=>$s,CMapCompressionType:()=>tu,ColorPicker:()=>Xh,DOMSVGFactory:()=>bf,DrawLayer:()=>ff,FeatureTest:()=>te,GlobalWorkerOptions:()=>ks,ImageKind:()=>mh,InvalidPDFException:()=>Jf,MissingPDFException:()=>Hn,OPS:()=>Ee,PDFDataRangeTransport:()=>Vp,PDFDateString:()=>ip,PDFWorker:()=>Zn,PasswordResponses:()=>Zg,PermissionFlag:()=>Jg,PixelsPerInch:()=>vi,RenderingCancelledException:()=>yf,TextLayer:()=>ka,UnexpectedResponseException:()=>Nd,Util:()=>N,VerbosityLevel:()=>Dd,XfaLayer:()=>Xp,build:()=>xv,createValidAbsoluteUrl:()=>sm,fetchData:()=>$d,getDocument:()=>gv,getFilenameFromUrl:()=>um,getPdfFilenameFromUrl:()=>fm,getXfaPageViewport:()=>pm,isDataScheme:()=>zd,isPdfFile:()=>Af,noContextMenu:()=>ee,normalizeUnicode:()=>lm,setLayerDimensions:()=>kn,shadow:()=>Z,version:()=>Sv});tt(4114);tt(6573);tt(8100);tt(7936);tt(7467);tt(4732);tt(9577);tt(4603);tt(7566);tt(8721);const Vt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Qf=[1,0,0,1,0,0],qd=[.001,0,0,.001,0,0],Kg=1e7,Xd=1.35,fe={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},$s={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Qg="pdfjs_internal_editor_",J={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},j={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},Jg={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ht={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},mh={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},At={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},ma={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Dd={ERRORS:0,WARNINGS:1,INFOS:5},tu={NONE:0,BINARY:1},Ee={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},Zg={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Fd=Dd.WARNINGS;function qg(c){Number.isInteger(c)&&(Fd=c)}function tm(){return Fd}function kd(c){Fd>=Dd.INFOS&&console.log(`Info: ${c}`)}function V(c){Fd>=Dd.WARNINGS&&console.log(`Warning: ${c}`)}function nt(c){throw new Error(c)}function Tt(c,e){c||nt(e)}function em(c){switch(c==null?void 0:c.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function sm(c,e=null,t=null){if(!c)return null;try{if(t&&typeof c=="string"){if(t.addDefaultProtocol&&c.startsWith("www.")){const i=c.match(/\./g);(i==null?void 0:i.length)>=2&&(c=`http://${c}`)}if(t.tryConvertEncoding)try{c=om(c)}catch{}}const s=e?new URL(c,e):new URL(c);if(em(s))return s}catch{}return null}function Z(c,e,t,s=!1){return Object.defineProperty(c,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const bi=function(){function e(t,s){this.constructor===e&&nt("Cannot initialize BaseException."),this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class eu extends bi{constructor(e,t){super(e,"PasswordException"),this.code=t}}class su extends bi{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Jf extends bi{constructor(e){super(e,"InvalidPDFException")}}class Hn extends bi{constructor(e){super(e,"MissingPDFException")}}class Nd extends bi{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class im extends bi{constructor(e){super(e,"FormatError")}}class Un extends bi{constructor(e){super(e,"AbortException")}}function Zf(c){(typeof c!="object"||(c==null?void 0:c.length)===void 0)&&nt("Invalid argument for bytesToString");const e=c.length,t=8192;if(e<t)return String.fromCharCode.apply(null,c);const s=[];for(let i=0;i<e;i+=t){const n=Math.min(i+t,e),r=c.subarray(i,n);s.push(String.fromCharCode.apply(null,r))}return s.join("")}function Bd(c){typeof c!="string"&&nt("Invalid argument for stringToBytes");const e=c.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=c.charCodeAt(s)&255;return t}function nm(c){return String.fromCharCode(c>>24&255,c>>16&255,c>>8&255,c&255)}function mf(c){const e=Object.create(null);for(const[t,s]of c)e[t]=s;return e}function rm(){const c=new Uint8Array(4);return c[0]=1,new Uint32Array(c.buffer,0,1)[0]===1}function am(){try{return new Function(""),!0}catch{return!1}}class te{static get isLittleEndian(){return Z(this,"isLittleEndian",rm())}static get isEvalSupported(){return Z(this,"isEvalSupported",am())}static get isOffscreenCanvasSupported(){return Z(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?Z(this,"platform",{isMac:navigator.platform.includes("Mac")}):Z(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){var e,t;return Z(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Yd=Array.from(Array(256).keys(),c=>c.toString(16).padStart(2,"0"));var qn,vh,Ba,iu;class N{static makeHexColor(e,t,s){return`#${Yd[e]}${Yd[t]}${Yd[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const s=e[0]*t[0]+e[1]*t[2]+t[4],i=e[0]*t[1]+e[1]*t[3]+t[5];return[s,i]}static applyInverseTransform(e,t){const s=t[0]*t[3]-t[1]*t[2],i=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/s,n=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/s;return[i,n]}static getAxialAlignedBoundingBox(e,t){const s=this.applyTransform(e,t),i=this.applyTransform(e.slice(2,4),t),n=this.applyTransform([e[0],e[3]],t),r=this.applyTransform([e[2],e[1]],t);return[Math.min(s[0],i[0],n[0],r[0]),Math.min(s[1],i[1],n[1],r[1]),Math.max(s[0],i[0],n[0],r[0]),Math.max(s[1],i[1],n[1],r[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],s=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],n=e[2]*t[0]+e[3]*t[2],r=e[2]*t[1]+e[3]*t[3],a=(s+r)/2,l=Math.sqrt((s+r)**2-4*(s*r-n*i))/2,h=a+l||1,d=a-l||1;return[Math.sqrt(h),Math.sqrt(d)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const n=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),r=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return n>r?null:[s,n,i,r]}static bezierBoundingBox(e,t,s,i,n,r,a,l,h){return h?(h[0]=Math.min(h[0],e,a),h[1]=Math.min(h[1],t,l),h[2]=Math.max(h[2],e,a),h[3]=Math.max(h[3],t,l)):h=[Math.min(e,a),Math.min(t,l),Math.max(e,a),Math.max(t,l)],y(this,Ba,iu).call(this,e,s,n,a,t,i,r,l,3*(-e+3*(s-n)+a),6*(e-2*s+n),3*(s-e),h),y(this,Ba,iu).call(this,e,s,n,a,t,i,r,l,3*(-t+3*(i-r)+l),6*(t-2*i+r),3*(i-t),h),h}}qn=new WeakSet,vh=function(e,t,s,i,n,r,a,l,h,d){if(h<=0||h>=1)return;const u=1-h,f=h*h,p=f*h,m=u*(u*(u*e+3*h*t)+3*f*s)+p*i,v=u*(u*(u*n+3*h*r)+3*f*a)+p*l;d[0]=Math.min(d[0],m),d[1]=Math.min(d[1],v),d[2]=Math.max(d[2],m),d[3]=Math.max(d[3],v)},Ba=new WeakSet,iu=function(e,t,s,i,n,r,a,l,h,d,u,f){if(Math.abs(h)<1e-12){Math.abs(d)>=1e-12&&y(this,qn,vh).call(this,e,t,s,i,n,r,a,l,-u/d,f);return}const p=d**2-4*u*h;if(p<0)return;const m=Math.sqrt(p),v=2*h;y(this,qn,vh).call(this,e,t,s,i,n,r,a,l,(-d+m)/v,f),y(this,qn,vh).call(this,e,t,s,i,n,r,a,l,(-d-m)/v,f)},g(N,qn),g(N,Ba);function om(c){return decodeURIComponent(escape(c))}let Kd=null,Mf=null;function lm(c){return Kd||(Kd=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Mf=new Map([["ï¬","Å¿t"]])),c.replaceAll(Kd,(e,t,s)=>t?t.normalize("NFKC"):Mf.get(s))}function hm(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const c=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(c);else for(let e=0;e<32;e++)c[e]=Math.floor(Math.random()*255);return Zf(c)}const qf="pdfjs_internal_id_",ss={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8};tt(4628);tt(1454);tt(3375);tt(9225);tt(3972);tt(9209);tt(5714);tt(7561);tt(6197);tt(4979);tt(8992);tt(4743);tt(3215);tt(7550);tt(8335);tt(4520);class Hd{constructor(){this.constructor===Hd&&nt("Cannot initialize BaseFilterFactory.")}addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,n){return"none"}destroy(e=!1){}}var Ha;const Tf=class Tf{constructor({enableHWA:e=!1}={}){g(this,Ha,!1);this.constructor===Tf&&nt("Cannot initialize BaseCanvasFactory."),b(this,Ha,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!o(this,Ha)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){nt("Abstract method `_createCanvas` called.")}};Ha=new WeakMap;let $h=Tf;class Ud{constructor({baseUrl:e=null,isCompressed:t=!0}){this.constructor===Ud&&nt("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":""),s=this.isCompressed?tu.BINARY:tu.NONE;return this._fetchData(t,s).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}_fetchData(e,t){nt("Abstract method `_fetchData` called.")}}class jd{constructor({baseUrl:e=null}){this.constructor===jd&&nt("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetchData(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}_fetchData(e){nt("Abstract method `_fetchData` called.")}}class vf{constructor(){this.constructor===vf&&nt("Cannot initialize BaseSVGFactory.")}create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){nt("Abstract method `_createSVG` called.")}}const ns="http://www.w3.org/2000/svg",Si=class Si{};z(Si,"CSS",96),z(Si,"PDF",72),z(Si,"PDF_TO_CSS_UNITS",Si.CSS/Si.PDF);let vi=Si;var Ti,Ci,Ne,hs,jt,Kh,Ri,Pt,Ut,zs,zn,Gs,Gn,tr,bh,Vs,Vn,Qh,tp,Ua,nu,Ws,Wn,Pi,ya,Ii,Aa,ja,ru,Mi,Ea;class cm extends Hd{constructor({docId:t,ownerDocument:s=globalThis.document}={}){super();g(this,Pt);g(this,zs);g(this,Gs);g(this,tr);g(this,Vs);g(this,Qh);g(this,Ua);g(this,Ws);g(this,Pi);g(this,Ii);g(this,ja);g(this,Mi);g(this,Ti,void 0);g(this,Ci,void 0);g(this,Ne,void 0);g(this,hs,void 0);g(this,jt,void 0);g(this,Kh,void 0);g(this,Ri,0);b(this,hs,t),b(this,jt,s)}addFilter(t){if(!t)return"none";let s=o(this,Pt,Ut).get(t);if(s)return s;const[i,n,r]=y(this,tr,bh).call(this,t),a=t.length===1?i:`${i}${n}${r}`;if(s=o(this,Pt,Ut).get(a),s)return o(this,Pt,Ut).set(t,s),s;const l=`g_${o(this,hs)}_transfer_map_${se(this,Ri)._++}`,h=y(this,Vs,Vn).call(this,l);o(this,Pt,Ut).set(t,h),o(this,Pt,Ut).set(a,h);const d=y(this,Ws,Wn).call(this,l);return y(this,Ii,Aa).call(this,i,n,r,d),h}addHCMFilter(t,s){var m;const i=`${t}-${s}`,n="base";let r=o(this,zs,zn).get(n);if((r==null?void 0:r.key)===i||(r?((m=r.filter)==null||m.remove(),r.key=i,r.url="none",r.filter=null):(r={key:i,url:"none",filter:null},o(this,zs,zn).set(n,r)),!t||!s))return r.url;const a=y(this,Mi,Ea).call(this,t);t=N.makeHexColor(...a);const l=y(this,Mi,Ea).call(this,s);if(s=N.makeHexColor(...l),o(this,Gs,Gn).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return r.url;const h=new Array(256);for(let v=0;v<=255;v++){const E=v/255;h[v]=E<=.03928?E/12.92:((E+.055)/1.055)**2.4}const d=h.join(","),u=`g_${o(this,hs)}_hcm_filter`,f=r.filter=y(this,Ws,Wn).call(this,u);y(this,Ii,Aa).call(this,d,d,d,f),y(this,Ua,nu).call(this,f);const p=(v,E)=>{const A=a[v]/255,w=l[v]/255,S=new Array(E+1);for(let C=0;C<=E;C++)S[C]=A+C/E*(w-A);return S.join(",")};return y(this,Ii,Aa).call(this,p(0,5),p(1,5),p(2,5),f),r.url=y(this,Vs,Vn).call(this,u),r.url}addAlphaFilter(t){let s=o(this,Pt,Ut).get(t);if(s)return s;const[i]=y(this,tr,bh).call(this,[t]),n=`alpha_${i}`;if(s=o(this,Pt,Ut).get(n),s)return o(this,Pt,Ut).set(t,s),s;const r=`g_${o(this,hs)}_alpha_map_${se(this,Ri)._++}`,a=y(this,Vs,Vn).call(this,r);o(this,Pt,Ut).set(t,a),o(this,Pt,Ut).set(n,a);const l=y(this,Ws,Wn).call(this,r);return y(this,ja,ru).call(this,i,l),a}addLuminosityFilter(t){let s=o(this,Pt,Ut).get(t||"luminosity");if(s)return s;let i,n;if(t?([i]=y(this,tr,bh).call(this,[t]),n=`luminosity_${i}`):n="luminosity",s=o(this,Pt,Ut).get(n),s)return o(this,Pt,Ut).set(t,s),s;const r=`g_${o(this,hs)}_luminosity_map_${se(this,Ri)._++}`,a=y(this,Vs,Vn).call(this,r);o(this,Pt,Ut).set(t,a),o(this,Pt,Ut).set(n,a);const l=y(this,Ws,Wn).call(this,r);return y(this,Qh,tp).call(this,l),t&&y(this,ja,ru).call(this,i,l),a}addHighlightHCMFilter(t,s,i,n,r){var w;const a=`${s}-${i}-${n}-${r}`;let l=o(this,zs,zn).get(t);if((l==null?void 0:l.key)===a||(l?((w=l.filter)==null||w.remove(),l.key=a,l.url="none",l.filter=null):(l={key:a,url:"none",filter:null},o(this,zs,zn).set(t,l)),!s||!i))return l.url;const[h,d]=[s,i].map(y(this,Mi,Ea).bind(this));let u=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),f=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[p,m]=[n,r].map(y(this,Mi,Ea).bind(this));f<u&&([u,f,p,m]=[f,u,m,p]),o(this,Gs,Gn).style.color="";const v=(S,C,x)=>{const T=new Array(256),R=(f-u)/x,I=S/255,P=(C-S)/(255*x);let O=0;for(let L=0;L<=x;L++){const W=Math.round(u+L*R),H=I+L*P;for(let X=O;X<=W;X++)T[X]=H;O=W+1}for(let L=O;L<256;L++)T[L]=T[O-1];return T.join(",")},E=`g_${o(this,hs)}_hcm_${t}_filter`,A=l.filter=y(this,Ws,Wn).call(this,E);return y(this,Ua,nu).call(this,A),y(this,Ii,Aa).call(this,v(p[0],m[0],5),v(p[1],m[1],5),v(p[2],m[2],5),A),l.url=y(this,Vs,Vn).call(this,E),l.url}destroy(t=!1){t&&o(this,zs,zn).size!==0||(o(this,Ne)&&(o(this,Ne).parentNode.parentNode.remove(),b(this,Ne,null)),o(this,Ci)&&(o(this,Ci).clear(),b(this,Ci,null)),b(this,Ri,0))}}Ti=new WeakMap,Ci=new WeakMap,Ne=new WeakMap,hs=new WeakMap,jt=new WeakMap,Kh=new WeakMap,Ri=new WeakMap,Pt=new WeakSet,Ut=function(){return o(this,Ci)||b(this,Ci,new Map)},zs=new WeakSet,zn=function(){return o(this,Kh)||b(this,Kh,new Map)},Gs=new WeakSet,Gn=function(){if(!o(this,Ne)){const t=o(this,jt).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const i=o(this,jt).createElementNS(ns,"svg");i.setAttribute("width",0),i.setAttribute("height",0),b(this,Ne,o(this,jt).createElementNS(ns,"defs")),t.append(i),i.append(o(this,Ne)),o(this,jt).body.append(t)}return o(this,Ne)},tr=new WeakSet,bh=function(t){if(t.length===1){const h=t[0],d=new Array(256);for(let f=0;f<256;f++)d[f]=h[f]/255;const u=d.join(",");return[u,u,u]}const[s,i,n]=t,r=new Array(256),a=new Array(256),l=new Array(256);for(let h=0;h<256;h++)r[h]=s[h]/255,a[h]=i[h]/255,l[h]=n[h]/255;return[r.join(","),a.join(","),l.join(",")]},Vs=new WeakSet,Vn=function(t){if(o(this,Ti)===void 0){b(this,Ti,"");const s=o(this,jt).URL;s!==o(this,jt).baseURI&&(zd(s)?V('#createUrl: ignore "data:"-URL for performance reasons.'):b(this,Ti,s.split("#",1)[0]))}return`url(${o(this,Ti)}#${t})`},Qh=new WeakSet,tp=function(t){const s=o(this,jt).createElementNS(ns,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},Ua=new WeakSet,nu=function(t){const s=o(this,jt).createElementNS(ns,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},Ws=new WeakSet,Wn=function(t){const s=o(this,jt).createElementNS(ns,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),o(this,Gs,Gn).append(s),s},Pi=new WeakSet,ya=function(t,s,i){const n=o(this,jt).createElementNS(ns,s);n.setAttribute("type","discrete"),n.setAttribute("tableValues",i),t.append(n)},Ii=new WeakSet,Aa=function(t,s,i,n){const r=o(this,jt).createElementNS(ns,"feComponentTransfer");n.append(r),y(this,Pi,ya).call(this,r,"feFuncR",t),y(this,Pi,ya).call(this,r,"feFuncG",s),y(this,Pi,ya).call(this,r,"feFuncB",i)},ja=new WeakSet,ru=function(t,s){const i=o(this,jt).createElementNS(ns,"feComponentTransfer");s.append(i),y(this,Pi,ya).call(this,i,"feFuncA",t)},Mi=new WeakSet,Ea=function(t){return o(this,Gs,Gn).style.color=t,Ef(getComputedStyle(o(this,Gs,Gn)).getPropertyValue("color"))};class dm extends $h{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}={}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}async function $d(c,e="text"){if(wa(c,document.baseURI)){const t=await fetch(c);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",c,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class ep extends Ud{_fetchData(e,t){return $d(e,this.isCompressed?"arraybuffer":"text").then(s=>({cMapData:s instanceof ArrayBuffer?new Uint8Array(s):Bd(s),compressionType:t}))}}class sp extends jd{_fetchData(e){return $d(e,"arraybuffer").then(t=>new Uint8Array(t))}}class bf extends vf{_createSVG(e){return document.createElementNS(ns,e)}}class ah{constructor({viewBox:e,scale:t,rotation:s,offsetX:i=0,offsetY:n=0,dontFlip:r=!1}){this.viewBox=e,this.scale=t,this.rotation=s,this.offsetX=i,this.offsetY=n;const a=(e[2]+e[0])/2,l=(e[3]+e[1])/2;let h,d,u,f;switch(s%=360,s<0&&(s+=360),s){case 180:h=-1,d=0,u=0,f=1;break;case 90:h=0,d=1,u=1,f=0;break;case 270:h=0,d=-1,u=-1,f=0;break;case 0:h=1,d=0,u=0,f=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}r&&(u=-u,f=-f);let p,m,v,E;h===0?(p=Math.abs(l-e[1])*t+i,m=Math.abs(a-e[0])*t+n,v=(e[3]-e[1])*t,E=(e[2]-e[0])*t):(p=Math.abs(a-e[0])*t+i,m=Math.abs(l-e[1])*t+n,v=(e[2]-e[0])*t,E=(e[3]-e[1])*t),this.transform=[h*t,d*t,u*t,f*t,p-h*t*a-u*t*l,m-d*t*a-f*t*l],this.width=v,this.height=E}get rawDims(){const{viewBox:e}=this;return Z(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:n=!1}={}){return new ah({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:n})}convertToViewportPoint(e,t){return N.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=N.applyTransform([e[0],e[1]],this.transform),s=N.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){return N.applyInverseTransform([e,t],this.transform)}}class yf extends bi{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function zd(c){const e=c.length;let t=0;for(;t<e&&c[t].trim()==="";)t++;return c.substring(t,t+5).toLowerCase()==="data:"}function Af(c){return typeof c=="string"&&/\.pdf$/i.test(c)}function um(c){return[c]=c.split(/[#?]/,1),c.substring(c.lastIndexOf("/")+1)}function fm(c,e="document.pdf"){if(typeof c!="string")return e;if(zd(c))return V('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=t.exec(c);let n=s.exec(i[1])||s.exec(i[2])||s.exec(i[3]);if(n&&(n=n[0],n.includes("%")))try{n=s.exec(decodeURIComponent(n))[0]}catch{}return n||e}class Lf{constructor(){z(this,"started",Object.create(null));z(this,"times",[])}time(e){e in this.started&&V(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||V(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:n}of this.times)e.push(`${s.padEnd(t)} ${n-i}ms
`);return e.join("")}}function wa(c,e){try{const{protocol:t}=e?new URL(c,e):new URL(c);return t==="http:"||t==="https:"}catch{return!1}}function ee(c){c.preventDefault()}let _f;class ip{static toDateObject(e){if(!e||typeof e!="string")return null;_f||(_f=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=_f.exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let n=parseInt(t[3],10);n=n>=1&&n<=31?n:1;let r=parseInt(t[4],10);r=r>=0&&r<=23?r:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const h=t[7]||"Z";let d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;let u=parseInt(t[9],10)||0;return u=u>=0&&u<=59?u:0,h==="-"?(r+=d,a+=u):h==="+"&&(r-=d,a-=u),new Date(Date.UTC(s,i,n,r,a,l))}}function pm(c,{scale:e=1,rotation:t=0}){const{width:s,height:i}=c.attributes.style,n=[0,0,parseInt(s),parseInt(i)];return new ah({viewBox:n,scale:e,rotation:t})}function Ef(c){if(c.startsWith("#")){const e=parseInt(c.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return c.startsWith("rgb(")?c.slice(4,-1).split(",").map(e=>parseInt(e)):c.startsWith("rgba(")?c.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(V(`Not a valid color format: "${c}"`),[0,0,0])}function gm(c){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of c.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;c.set(t,Ef(s))}e.remove()}function ut(c){const{a:e,b:t,c:s,d:i,e:n,f:r}=c.getTransform();return[e,t,s,i,n,r]}function is(c){const{a:e,b:t,c:s,d:i,e:n,f:r}=c.getTransform().invertSelf();return[e,t,s,i,n,r]}function kn(c,e,t=!1,s=!0){if(e instanceof ah){const{pageWidth:i,pageHeight:n}=e.rawDims,{style:r}=c,a=te.isCSSRoundSupported,l=`var(--scale-factor) * ${i}px`,h=`var(--scale-factor) * ${n}px`,d=a?`round(${l}, 1px)`:`calc(${l})`,u=a?`round(${h}, 1px)`:`calc(${h})`;!t||e.rotation%180===0?(r.width=d,r.height=u):(r.width=u,r.height=d)}s&&c.setAttribute("data-main-rotation",e.rotation)}var Li,_i,re,Oi,Jh,np,Zh,rp,qh,ap,er,yh,tc,op,$a,ou;const ec=class ec{constructor(e){g(this,Zh);g(this,qh);g(this,er);g(this,tc);g(this,$a);g(this,Li,null);g(this,_i,null);g(this,re,void 0);g(this,Oi,null);b(this,re,e)}render(){const e=b(this,Li,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=o(this,re)._uiManager._signal;e.addEventListener("contextmenu",ee,{signal:t}),e.addEventListener("pointerdown",y(ec,Jh,np),{signal:t});const s=b(this,Oi,document.createElement("div"));s.className="buttons",e.append(s);const i=o(this,re).toolbarPosition;if(i){const{style:n}=e,r=o(this,re)._uiManager.direction==="ltr"?1-i[0]:i[0];n.insetInlineEnd=`${100*r}%`,n.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return y(this,tc,op).call(this),e}hide(){var e;o(this,Li).classList.add("hidden"),(e=o(this,_i))==null||e.hideDropdown()}show(){o(this,Li).classList.remove("hidden")}addAltTextButton(e){y(this,er,yh).call(this,e),o(this,Oi).prepend(e,o(this,$a,ou))}addColorPicker(e){b(this,_i,e);const t=e.renderButton();y(this,er,yh).call(this,t),o(this,Oi).prepend(t,o(this,$a,ou))}remove(){var e;o(this,Li).remove(),(e=o(this,_i))==null||e.destroy(),b(this,_i,null)}};Li=new WeakMap,_i=new WeakMap,re=new WeakMap,Oi=new WeakMap,Jh=new WeakSet,np=function(e){e.stopPropagation()},Zh=new WeakSet,rp=function(e){o(this,re)._focusEventsAllowed=!1,e.preventDefault(),e.stopPropagation()},qh=new WeakSet,ap=function(e){o(this,re)._focusEventsAllowed=!0,e.preventDefault(),e.stopPropagation()},er=new WeakSet,yh=function(e){const t=o(this,re)._uiManager._signal;e.addEventListener("focusin",y(this,Zh,rp).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",y(this,qh,ap).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",ee,{signal:t})},tc=new WeakSet,op=function(){const e=document.createElement("button");e.className="delete",e.tabIndex=0,e.setAttribute("data-l10n-id",`pdfjs-editor-remove-${o(this,re).editorType}-button`),y(this,er,yh).call(this,e),e.addEventListener("click",t=>{o(this,re)._uiManager.delete()},{signal:o(this,re)._uiManager._signal}),o(this,Oi).append(e)},$a=new WeakSet,ou=function(){const e=document.createElement("div");return e.className="divider",e},g(ec,Jh);let au=ec;var za,Di,Fi,sc,lp,ic,hp,nc,cp;class mm{constructor(e){g(this,sc);g(this,ic);g(this,nc);g(this,za,null);g(this,Di,null);g(this,Fi,void 0);b(this,Fi,e)}show(e,t,s){const[i,n]=y(this,ic,hp).call(this,t,s),{style:r}=o(this,Di)||b(this,Di,y(this,sc,lp).call(this));e.append(o(this,Di)),r.insetInlineEnd=`${100*i}%`,r.top=`calc(${100*n}% + var(--editor-toolbar-vert-offset))`}hide(){o(this,Di).remove()}}za=new WeakMap,Di=new WeakMap,Fi=new WeakMap,sc=new WeakSet,lp=function(){const e=b(this,Di,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",ee,{signal:o(this,Fi)._signal});const t=b(this,za,document.createElement("div"));return t.className="buttons",e.append(t),y(this,nc,cp).call(this),e},ic=new WeakSet,hp=function(e,t){let s=0,i=0;for(const n of e){const r=n.y+n.height;if(r<s)continue;const a=n.x+(t?n.width:0);if(r>s){i=a,s=r;continue}t?a>i&&(i=a):a<i&&(i=a)}return[t?1-i:i,s]},nc=new WeakSet,cp=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=o(this,Fi)._signal;e.addEventListener("contextmenu",ee,{signal:s}),e.addEventListener("click",()=>{o(this,Fi).highlightSelection("floating_button")},{signal:s}),o(this,za).append(e)};function zh(c,e,t){for(const s of t)e.addEventListener(s,c[s].bind(c))}function vm(c){return Math.round(Math.min(255,Math.max(1,255*c))).toString(16).padStart(2,"0")}var rc;class bm{constructor(){g(this,rc,0)}get id(){return`${Qg}${se(this,rc)._++}`}}rc=new WeakMap;var Ga,ac,me,Va,hu;const Cf=class Cf{constructor(){g(this,Va);g(this,Ga,hm());g(this,ac,0);g(this,me,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const n=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return Z(this,"_isSVGFittingCanvas",n)}async getFromFile(e){const{lastModified:t,name:s,size:i,type:n}=e;return y(this,Va,hu).call(this,`${t}_${s}_${i}_${n}`,e)}async getFromUrl(e){return y(this,Va,hu).call(this,e,e)}async getFromId(e){o(this,me)||b(this,me,new Map);const t=o(this,me).get(e);return t?t.bitmap?(t.refCounter+=1,t):t.file?this.getFromFile(t.file):this.getFromUrl(t.url):null}getSvgUrl(e){const t=o(this,me).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){o(this,me)||b(this,me,new Map);const t=o(this,me).get(e);t&&(t.refCounter-=1,t.refCounter===0&&(t.bitmap=null))}isValidId(e){return e.startsWith(`image_${o(this,Ga)}_`)}};Ga=new WeakMap,ac=new WeakMap,me=new WeakMap,Va=new WeakSet,hu=async function(e,t){o(this,me)||b(this,me,new Map);let s=o(this,me).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${o(this,Ga)}_${se(this,ac)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(s.url=t,i=await $d(t,"blob")):i=s.file=t,i.type==="image/svg+xml"){const n=Cf._isSVGFittingCanvas,r=new FileReader,a=new Image,l=new Promise((h,d)=>{a.onload=()=>{s.bitmap=a,s.isSvg=!0,h()},r.onload=async()=>{const u=s.svgUrl=r.result;a.src=await n?`${u}#svgView(preserveAspectRatio(none))`:u},a.onerror=r.onerror=d});r.readAsDataURL(i),await l}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){console.error(i),s=null}return o(this,me).set(e,s),s&&o(this,me).set(s.id,s),s};let lu=Cf;var It,Xs,Wa,Mt;class ym{constructor(e=128){g(this,It,[]);g(this,Xs,!1);g(this,Wa,void 0);g(this,Mt,-1);b(this,Wa,e)}add({cmd:e,undo:t,post:s,mustExec:i,type:n=NaN,overwriteIfSameType:r=!1,keepUndo:a=!1}){if(i&&e(),o(this,Xs))return;const l={cmd:e,undo:t,post:s,type:n};if(o(this,Mt)===-1){o(this,It).length>0&&(o(this,It).length=0),b(this,Mt,0),o(this,It).push(l);return}if(r&&o(this,It)[o(this,Mt)].type===n){a&&(l.undo=o(this,It)[o(this,Mt)].undo),o(this,It)[o(this,Mt)]=l;return}const h=o(this,Mt)+1;h===o(this,Wa)?o(this,It).splice(0,1):(b(this,Mt,h),h<o(this,It).length&&o(this,It).splice(h)),o(this,It).push(l)}undo(){if(o(this,Mt)===-1)return;b(this,Xs,!0);const{undo:e,post:t}=o(this,It)[o(this,Mt)];e(),t==null||t(),b(this,Xs,!1),b(this,Mt,o(this,Mt)-1)}redo(){if(o(this,Mt)<o(this,It).length-1){b(this,Mt,o(this,Mt)+1),b(this,Xs,!0);const{cmd:e,post:t}=o(this,It)[o(this,Mt)];e(),t==null||t(),b(this,Xs,!1)}}hasSomethingToUndo(){return o(this,Mt)!==-1}hasSomethingToRedo(){return o(this,Mt)<o(this,It).length-1}destroy(){b(this,It,null)}}It=new WeakMap,Xs=new WeakMap,Wa=new WeakMap,Mt=new WeakMap;var oc,dp;class oh{constructor(e){g(this,oc);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=te.platform;for(const[s,i,n={}]of e)for(const r of s){const a=r.startsWith("mac+");t&&a?(this.callbacks.set(r.slice(4),{callback:i,options:n}),this.allKeys.add(r.split("+").at(-1))):!t&&!a&&(this.callbacks.set(r,{callback:i,options:n}),this.allKeys.add(r.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(y(this,oc,dp).call(this,t));if(!s)return;const{callback:i,options:{bubbles:n=!1,args:r=[],checker:a=null}}=s;a&&!a(e,t)||(i.bind(e,...r,t)(),n||(t.stopPropagation(),t.preventDefault()))}}oc=new WeakSet,dp=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const lc=class lc{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return gm(e),Z(this,"_colors",e)}convert(e){const t=Ef(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((n,r)=>n===t[r]))return lc._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?N.makeHexColor(...t):e}};z(lc,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let cu=lc;var sr,ae,Et,Dt,ir,cs,nr,we,rr,ki,Be,Se,Ni,Xa,Ya,Ka,He,ar,Ys,Ue,hc,Ks,Qa,Bi,Ja,or,Lt,st,ds,Hi,Za,qa,to,eo,so,io,no,ro,ao,oo,lo,ho,co,Qs,je,us,uo,lr,Ah,fo,du,cc,up,dc,fp,hr,Eh,uc,pp,fc,gp,pc,mp,po,uu,gc,vp,go,fu,mo,pu,mc,bp,Ft,Xt,$e,Hs,vc,yp,bc,Ap,vo,gu,yc,Ep,Ui,Sa,bo,mu;const Qn=class Qn{constructor(e,t,s,i,n,r,a,l,h,d){g(this,lr);g(this,fo);g(this,cc);g(this,dc);g(this,hr);g(this,uc);g(this,fc);g(this,pc);g(this,po);g(this,gc);g(this,go);g(this,mo);g(this,mc);g(this,Ft);g(this,$e);g(this,vc);g(this,bc);g(this,vo);g(this,yc);g(this,Ui);g(this,bo);g(this,sr,new AbortController);g(this,ae,null);g(this,Et,new Map);g(this,Dt,new Map);g(this,ir,null);g(this,cs,null);g(this,nr,null);g(this,we,new ym);g(this,rr,0);g(this,ki,new Set);g(this,Be,null);g(this,Se,null);g(this,Ni,new Set);g(this,Xa,!1);g(this,Ya,!1);g(this,Ka,null);g(this,He,null);g(this,ar,null);g(this,Ys,!1);g(this,Ue,null);g(this,hc,new bm);g(this,Ks,!1);g(this,Qa,!1);g(this,Bi,null);g(this,Ja,null);g(this,or,null);g(this,Lt,J.NONE);g(this,st,new Set);g(this,ds,null);g(this,Hi,null);g(this,Za,null);g(this,qa,this.blur.bind(this));g(this,to,this.focus.bind(this));g(this,eo,this.copy.bind(this));g(this,so,this.cut.bind(this));g(this,io,this.paste.bind(this));g(this,no,this.keydown.bind(this));g(this,ro,this.keyup.bind(this));g(this,ao,this.onEditingAction.bind(this));g(this,oo,this.onPageChanging.bind(this));g(this,lo,this.onScaleChanging.bind(this));g(this,ho,this.onRotationChanging.bind(this));g(this,co,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});g(this,Qs,[0,0]);g(this,je,null);g(this,us,null);g(this,uo,null);this._signal=o(this,sr).signal,b(this,us,e),b(this,uo,t),b(this,ir,s),this._eventBus=i,this._eventBus._on("editingaction",o(this,ao)),this._eventBus._on("pagechanging",o(this,oo)),this._eventBus._on("scalechanging",o(this,lo)),this._eventBus._on("rotationchanging",o(this,ho)),y(this,uc,pp).call(this),y(this,mc,bp).call(this),y(this,po,uu).call(this),b(this,cs,n.annotationStorage),b(this,Ka,n.filterFactory),b(this,Hi,r),b(this,ar,a||null),b(this,Xa,l),b(this,Ya,h),b(this,or,d||null),this.viewParameters={realScale:vi.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const e=Qn.prototype,t=r=>o(r,us).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&r.hasSomethingToControl(),s=(r,{target:a})=>{if(a instanceof HTMLInputElement){const{type:l}=a;return l!=="text"&&l!=="number"}return!0},i=this.TRANSLATE_SMALL,n=this.TRANSLATE_BIG;return Z(this,"_keyboardManager",new oh([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(r,{target:a})=>!(a instanceof HTMLButtonElement)&&o(r,us).contains(a)&&!r.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(r,{target:a})=>!(a instanceof HTMLButtonElement)&&o(r,us).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-n,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[n,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-n],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,n],checker:t}]]))}destroy(){var e,t,s;(e=o(this,sr))==null||e.abort(),b(this,sr,null),this._signal=null,this._eventBus._off("editingaction",o(this,ao)),this._eventBus._off("pagechanging",o(this,oo)),this._eventBus._off("scalechanging",o(this,lo)),this._eventBus._off("rotationchanging",o(this,ho));for(const i of o(this,Dt).values())i.destroy();o(this,Dt).clear(),o(this,Et).clear(),o(this,Ni).clear(),b(this,ae,null),o(this,st).clear(),o(this,we).destroy(),(t=o(this,ir))==null||t.destroy(),(s=o(this,Ue))==null||s.hide(),b(this,Ue,null),o(this,He)&&(clearTimeout(o(this,He)),b(this,He,null)),o(this,je)&&(clearTimeout(o(this,je)),b(this,je,null))}async mlGuess(e){var t;return((t=o(this,or))==null?void 0:t.guess(e))||null}async isMLEnabledFor(e){var t;return!!await((t=o(this,or))==null?void 0:t.isEnabledFor(e))}get useNewAltTextFlow(){return o(this,Ya)}get hcmFilter(){return Z(this,"hcmFilter",o(this,Hi)?o(this,Ka).addHCMFilter(o(this,Hi).foreground,o(this,Hi).background):"none")}get direction(){return Z(this,"direction",getComputedStyle(o(this,us)).direction)}get highlightColors(){return Z(this,"highlightColors",o(this,ar)?new Map(o(this,ar).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return Z(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setMainHighlightColorPicker(e){b(this,Ja,e)}editAltText(e){var t;(t=o(this,ir))==null||t.editAltText(this,e)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onPageChanging({pageNumber:e}){b(this,rr,e-1)}focusMainContainer(){o(this,us).focus()}findParent(e,t){for(const s of o(this,Dt).values()){const{x:i,y:n,width:r,height:a}=s.div.getBoundingClientRect();if(e>=i&&e<=i+r&&t>=n&&t<=n+a)return s}return null}disableUserSelect(e=!1){o(this,uo).classList.toggle("noUserSelect",e)}addShouldRescale(e){o(this,Ni).add(e)}removeShouldRescale(e){o(this,Ni).delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*vi.PDF_TO_CSS_UNITS;for(const t of o(this,Ni))t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:n,focusOffset:r}=t,a=t.toString(),h=y(this,lr,Ah).call(this,t).closest(".textLayer"),d=this.getSelectionBoxes(h);if(!d)return;t.empty();const u=y(this,fo,du).call(this,h),f=o(this,Lt)===J.NONE,p=()=>{u==null||u.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:d,anchorNode:s,anchorOffset:i,focusNode:n,focusOffset:r,text:a}),f&&this.showAllEditors("highlight",!0,!0)};if(f){this.switchToMode(J.HIGHLIGHT,p);return}p()}addToAnnotationStorage(e){!e.isEmpty()&&o(this,cs)&&!o(this,cs).has(e.id)&&o(this,cs).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,o(this,Ys)&&(b(this,Ys,!1),y(this,hr,Eh).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of o(this,st))if(t.div.contains(e)){b(this,Bi,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!o(this,Bi))return;const[e,t]=o(this,Bi);b(this,Bi,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){y(this,po,uu).call(this),y(this,go,fu).call(this)}removeEditListeners(){y(this,gc,vp).call(this),y(this,mo,pu).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of o(this,Se))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of o(this,Se))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=o(this,ae))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of o(this,st)){const n=i.serialize(!0);n&&t.push(n)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}paste(e){e.preventDefault();const{clipboardData:t}=e;for(const n of t.items)for(const r of o(this,Se))if(r.isHandlingMimeForPasting(n.type)){r.paste(n,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(n){V(`paste: "${n.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const n=[];for(const l of s){const h=i.deserialize(l);if(!h)return;n.push(h)}const r=()=>{for(const l of n)y(this,vo,gu).call(this,l);y(this,bo,mu).call(this,n)},a=()=>{for(const l of n)l.remove()};this.addCommands({cmd:r,undo:a,mustExec:!0})}catch(n){V(`paste: "${n.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),o(this,Lt)!==J.NONE&&!this.isEditorHandlingKeyboard&&Qn._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,o(this,Ys)&&(b(this,Ys,!1),y(this,hr,Eh).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(y(this,fc,gp).call(this),y(this,go,fu).call(this),y(this,Ft,Xt).call(this,{isEditing:o(this,Lt)!==J.NONE,isEmpty:y(this,Ui,Sa).call(this),hasSomethingToUndo:o(this,we).hasSomethingToUndo(),hasSomethingToRedo:o(this,we).hasSomethingToRedo(),hasSelectedEditor:!1})):(y(this,pc,mp).call(this),y(this,mo,pu).call(this),y(this,Ft,Xt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!o(this,Se)){b(this,Se,e);for(const t of o(this,Se))y(this,$e,Hs).call(this,t.defaultPropertiesToUpdate)}}getId(){return o(this,hc).id}get currentLayer(){return o(this,Dt).get(o(this,rr))}getLayer(e){return o(this,Dt).get(e)}get currentPageIndex(){return o(this,rr)}addLayer(e){o(this,Dt).set(e.pageIndex,e),o(this,Ks)?e.enable():e.disable()}removeLayer(e){o(this,Dt).delete(e.pageIndex)}updateMode(e,t=null,s=!1){if(o(this,Lt)!==e){if(b(this,Lt,e),e===J.NONE){this.setEditingState(!1),y(this,bc,Ap).call(this);return}this.setEditingState(!0),y(this,vc,yp).call(this),this.unselectAll();for(const i of o(this,Dt).values())i.updateMode(e);if(!t&&s){this.addNewEditorFromKeyboard();return}if(t){for(const i of o(this,Et).values())if(i.annotationElementId===t){this.setSelected(i),i.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==o(this,Lt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var s;if(o(this,Se)){switch(e){case j.CREATE:this.currentLayer.addNewEditor();return;case j.HIGHLIGHT_DEFAULT_COLOR:(s=o(this,Ja))==null||s.updateColor(t);break;case j.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(o(this,Za)||b(this,Za,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const i of o(this,st))i.updateParams(e,t);for(const i of o(this,Se))i.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var n;for(const r of o(this,Et).values())r.editorType===e&&r.show(t);(((n=o(this,Za))==null?void 0:n.get(j.HIGHLIGHT_SHOW_ALL))??!0)!==t&&y(this,$e,Hs).call(this,[[j.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(o(this,Qa)!==e){b(this,Qa,e);for(const t of o(this,Dt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const s of o(this,Et).values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return o(this,Et).get(e)}addEditor(e){o(this,Et).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(o(this,He)&&clearTimeout(o(this,He)),b(this,He,setTimeout(()=>{this.focusMainContainer(),b(this,He,null)},0))),o(this,Et).delete(e.id),this.unselect(e),(!e.annotationElementId||!o(this,ki).has(e.annotationElementId))&&((t=o(this,cs))==null||t.remove(e.id))}addDeletedAnnotationElement(e){o(this,ki).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return o(this,ki).has(e)}removeDeletedAnnotationElement(e){o(this,ki).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){o(this,ae)!==e&&(b(this,ae,e),e&&y(this,$e,Hs).call(this,e.propertiesToUpdate))}updateUI(e){o(this,yc,Ep)===e&&y(this,$e,Hs).call(this,e.propertiesToUpdate)}toggleSelected(e){if(o(this,st).has(e)){o(this,st).delete(e),e.unselect(),y(this,Ft,Xt).call(this,{hasSelectedEditor:this.hasSelection});return}o(this,st).add(e),e.select(),y(this,$e,Hs).call(this,e.propertiesToUpdate),y(this,Ft,Xt).call(this,{hasSelectedEditor:!0})}setSelected(e){for(const t of o(this,st))t!==e&&t.unselect();o(this,st).clear(),o(this,st).add(e),e.select(),y(this,$e,Hs).call(this,e.propertiesToUpdate),y(this,Ft,Xt).call(this,{hasSelectedEditor:!0})}isSelected(e){return o(this,st).has(e)}get firstSelectedEditor(){return o(this,st).values().next().value}unselect(e){e.unselect(),o(this,st).delete(e),y(this,Ft,Xt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return o(this,st).size!==0}get isEnterHandled(){return o(this,st).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){o(this,we).undo(),y(this,Ft,Xt).call(this,{hasSomethingToUndo:o(this,we).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:y(this,Ui,Sa).call(this)})}redo(){o(this,we).redo(),y(this,Ft,Xt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:o(this,we).hasSomethingToRedo(),isEmpty:y(this,Ui,Sa).call(this)})}addCommands(e){o(this,we).add(e),y(this,Ft,Xt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:y(this,Ui,Sa).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const e=[...o(this,st)],t=()=>{for(const i of e)i.remove()},s=()=>{for(const i of e)y(this,vo,gu).call(this,i)};this.addCommands({cmd:t,undo:s,mustExec:!0})}commitOrRemove(){var e;(e=o(this,ae))==null||e.commitOrRemove()}hasSomethingToControl(){return o(this,ae)||this.hasSelection}selectAll(){for(const e of o(this,st))e.commit();y(this,bo,mu).call(this,o(this,Et).values())}unselectAll(){if(!(o(this,ae)&&(o(this,ae).commitOrRemove(),o(this,Lt)!==J.NONE))&&this.hasSelection){for(const e of o(this,st))e.unselect();o(this,st).clear(),y(this,Ft,Xt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;o(this,Qs)[0]+=e,o(this,Qs)[1]+=t;const[i,n]=o(this,Qs),r=[...o(this,st)],a=1e3;o(this,je)&&clearTimeout(o(this,je)),b(this,je,setTimeout(()=>{b(this,je,null),o(this,Qs)[0]=o(this,Qs)[1]=0,this.addCommands({cmd:()=>{for(const l of r)o(this,Et).has(l.id)&&l.translateInPage(i,n)},undo:()=>{for(const l of r)o(this,Et).has(l.id)&&l.translateInPage(-i,-n)},mustExec:!1})},a));for(const l of r)l.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),b(this,Be,new Map);for(const e of o(this,st))o(this,Be).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!o(this,Be))return!1;this.disableUserSelect(!1);const e=o(this,Be);b(this,Be,null);let t=!1;for(const[{x:i,y:n,pageIndex:r},a]of e)a.newX=i,a.newY=n,a.newPageIndex=r,t||(t=i!==a.savedX||n!==a.savedY||r!==a.savedPageIndex);if(!t)return!1;const s=(i,n,r,a)=>{if(o(this,Et).has(i.id)){const l=o(this,Dt).get(a);l?i._setParentAndPosition(l,n,r):(i.pageIndex=a,i.x=n,i.y=r)}};return this.addCommands({cmd:()=>{for(const[i,{newX:n,newY:r,newPageIndex:a}]of e)s(i,n,r,a)},undo:()=>{for(const[i,{savedX:n,savedY:r,savedPageIndex:a}]of e)s(i,n,r,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(o(this,Be))for(const s of o(this,Be).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||o(this,st).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return o(this,ae)===e}getActive(){return o(this,ae)}getMode(){return o(this,Lt)}get imageManager(){return Z(this,"imageManager",new lu)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let h=0,d=t.rangeCount;h<d;h++)if(!e.contains(t.getRangeAt(h).commonAncestorContainer))return null;const{x:s,y:i,width:n,height:r}=e.getBoundingClientRect();let a;switch(e.getAttribute("data-main-rotation")){case"90":a=(h,d,u,f)=>({x:(d-i)/r,y:1-(h+u-s)/n,width:f/r,height:u/n});break;case"180":a=(h,d,u,f)=>({x:1-(h+u-s)/n,y:1-(d+f-i)/r,width:u/n,height:f/r});break;case"270":a=(h,d,u,f)=>({x:1-(d+f-i)/r,y:(h-s)/n,width:f/r,height:u/n});break;default:a=(h,d,u,f)=>({x:(h-s)/n,y:(d-i)/r,width:u/n,height:f/r});break}const l=[];for(let h=0,d=t.rangeCount;h<d;h++){const u=t.getRangeAt(h);if(!u.collapsed)for(const{x:f,y:p,width:m,height:v}of u.getClientRects())m===0||v===0||l.push(a(f,p,m,v))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(o(this,nr)||b(this,nr,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=o(this,nr))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=o(this,nr))==null?void 0:i.get(e.data.id);if(!t)return;const s=o(this,cs).getRawValue(t);s&&(o(this,Lt)===J.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}};sr=new WeakMap,ae=new WeakMap,Et=new WeakMap,Dt=new WeakMap,ir=new WeakMap,cs=new WeakMap,nr=new WeakMap,we=new WeakMap,rr=new WeakMap,ki=new WeakMap,Be=new WeakMap,Se=new WeakMap,Ni=new WeakMap,Xa=new WeakMap,Ya=new WeakMap,Ka=new WeakMap,He=new WeakMap,ar=new WeakMap,Ys=new WeakMap,Ue=new WeakMap,hc=new WeakMap,Ks=new WeakMap,Qa=new WeakMap,Bi=new WeakMap,Ja=new WeakMap,or=new WeakMap,Lt=new WeakMap,st=new WeakMap,ds=new WeakMap,Hi=new WeakMap,Za=new WeakMap,qa=new WeakMap,to=new WeakMap,eo=new WeakMap,so=new WeakMap,io=new WeakMap,no=new WeakMap,ro=new WeakMap,ao=new WeakMap,oo=new WeakMap,lo=new WeakMap,ho=new WeakMap,co=new WeakMap,Qs=new WeakMap,je=new WeakMap,us=new WeakMap,uo=new WeakMap,lr=new WeakSet,Ah=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},fo=new WeakSet,du=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of o(this,Dt).values())if(s.hasTextLayer(e))return s;return null},cc=new WeakSet,up=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=y(this,lr,Ah).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(o(this,Ue)||b(this,Ue,new mm(this)),o(this,Ue).show(s,i,this.direction==="ltr"))},dc=new WeakSet,fp=function(){var n,r,a;const e=document.getSelection();if(!e||e.isCollapsed){o(this,ds)&&((n=o(this,Ue))==null||n.hide(),b(this,ds,null),y(this,Ft,Xt).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===o(this,ds))return;const i=y(this,lr,Ah).call(this,e).closest(".textLayer");if(!i){o(this,ds)&&((r=o(this,Ue))==null||r.hide(),b(this,ds,null),y(this,Ft,Xt).call(this,{hasSelectedText:!1}));return}if((a=o(this,Ue))==null||a.hide(),b(this,ds,t),y(this,Ft,Xt).call(this,{hasSelectedText:!0}),!(o(this,Lt)!==J.HIGHLIGHT&&o(this,Lt)!==J.NONE)&&(o(this,Lt)===J.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),b(this,Ys,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=o(this,Lt)===J.HIGHLIGHT?y(this,fo,du).call(this,i):null;l==null||l.toggleDrawing();const h=this._signal,d=u=>{u.type==="pointerup"&&u.button!==0||(l==null||l.toggleDrawing(!0),window.removeEventListener("pointerup",d),window.removeEventListener("blur",d),u.type==="pointerup"&&y(this,hr,Eh).call(this,"main_toolbar"))};window.addEventListener("pointerup",d,{signal:h}),window.addEventListener("blur",d,{signal:h})}},hr=new WeakSet,Eh=function(e=""){o(this,Lt)===J.HIGHLIGHT?this.highlightSelection(e):o(this,Xa)&&y(this,cc,up).call(this)},uc=new WeakSet,pp=function(){document.addEventListener("selectionchange",y(this,dc,fp).bind(this),{signal:this._signal})},fc=new WeakSet,gp=function(){const e=this._signal;window.addEventListener("focus",o(this,to),{signal:e}),window.addEventListener("blur",o(this,qa),{signal:e})},pc=new WeakSet,mp=function(){window.removeEventListener("focus",o(this,to)),window.removeEventListener("blur",o(this,qa))},po=new WeakSet,uu=function(){const e=this._signal;window.addEventListener("keydown",o(this,no),{signal:e}),window.addEventListener("keyup",o(this,ro),{signal:e})},gc=new WeakSet,vp=function(){window.removeEventListener("keydown",o(this,no)),window.removeEventListener("keyup",o(this,ro))},go=new WeakSet,fu=function(){const e=this._signal;document.addEventListener("copy",o(this,eo),{signal:e}),document.addEventListener("cut",o(this,so),{signal:e}),document.addEventListener("paste",o(this,io),{signal:e})},mo=new WeakSet,pu=function(){document.removeEventListener("copy",o(this,eo)),document.removeEventListener("cut",o(this,so)),document.removeEventListener("paste",o(this,io))},mc=new WeakSet,bp=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Ft=new WeakSet,Xt=function(e){Object.entries(e).some(([s,i])=>o(this,co)[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(o(this,co),e)}),o(this,Lt)===J.HIGHLIGHT&&e.hasSelectedEditor===!1&&y(this,$e,Hs).call(this,[[j.HIGHLIGHT_FREE,!0]]))},$e=new WeakSet,Hs=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},vc=new WeakSet,yp=function(){if(!o(this,Ks)){b(this,Ks,!0);for(const e of o(this,Dt).values())e.enable();for(const e of o(this,Et).values())e.enable()}},bc=new WeakSet,Ap=function(){if(this.unselectAll(),o(this,Ks)){b(this,Ks,!1);for(const e of o(this,Dt).values())e.disable();for(const e of o(this,Et).values())e.disable()}},vo=new WeakSet,gu=function(e){const t=o(this,Dt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},yc=new WeakSet,Ep=function(){let e=null;for(e of o(this,st));return e},Ui=new WeakSet,Sa=function(){if(o(this,Et).size===0)return!0;if(o(this,Et).size===1)for(const e of o(this,Et).values())return e.isEmpty();return!1},bo=new WeakSet,mu=function(e){for(const t of o(this,st))t.unselect();o(this,st).clear();for(const t of e)t.isEmpty()||(o(this,st).add(t),t.select());y(this,Ft,Xt).call(this,{hasSelectedEditor:this.hasSelection})},z(Qn,"TRANSLATE_SMALL",1),z(Qn,"TRANSLATE_BIG",10);let Nn=Qn;var fs,ps,xe,gs,oe,cr,Te,yo,vu;const rs=class rs{constructor(e){g(this,yo);g(this,fs,"");g(this,ps,!1);g(this,xe,null);g(this,gs,null);g(this,oe,null);g(this,cr,!1);g(this,Te,null);b(this,Te,e)}static initialize(e){rs._l10nPromise||(rs._l10nPromise=e)}async render(){const e=b(this,xe,document.createElement("button"));e.className="altText";const t=await rs._l10nPromise.get("pdfjs-editor-alt-text-button-label");e.textContent=t,e.setAttribute("aria-label",t),e.tabIndex="0";const s=o(this,Te)._uiManager._signal;e.addEventListener("contextmenu",ee,{signal:s}),e.addEventListener("pointerdown",n=>n.stopPropagation(),{signal:s});const i=n=>{n.preventDefault(),o(this,Te)._uiManager.editAltText(o(this,Te))};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",n=>{n.target===e&&n.key==="Enter"&&(b(this,cr,!0),i(n))},{signal:s}),await y(this,yo,vu).call(this),e}finish(){o(this,xe)&&(o(this,xe).focus({focusVisible:o(this,cr)}),b(this,cr,!1))}isEmpty(){return!o(this,fs)&&!o(this,ps)}get data(){return{altText:o(this,fs),decorative:o(this,ps)}}set data({altText:e,decorative:t}){o(this,fs)===e&&o(this,ps)===t||(b(this,fs,e),b(this,ps,t),y(this,yo,vu).call(this))}toggle(e=!1){o(this,xe)&&(!e&&o(this,oe)&&(clearTimeout(o(this,oe)),b(this,oe,null)),o(this,xe).disabled=!e)}destroy(){var e;(e=o(this,xe))==null||e.remove(),b(this,xe,null),b(this,gs,null)}};fs=new WeakMap,ps=new WeakMap,xe=new WeakMap,gs=new WeakMap,oe=new WeakMap,cr=new WeakMap,Te=new WeakMap,yo=new WeakSet,vu=async function(){var i;const e=o(this,xe);if(!e)return;if(!o(this,fs)&&!o(this,ps)){e.classList.remove("done"),(i=o(this,gs))==null||i.remove();return}e.classList.add("done"),rs._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(n=>{e.setAttribute("aria-label",n)});let t=o(this,gs);if(!t){b(this,gs,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip");const n=t.id=`alt-text-tooltip-${o(this,Te).id}`;e.setAttribute("aria-describedby",n);const r=100,a=o(this,Te)._uiManager._signal;a.addEventListener("abort",()=>{clearTimeout(o(this,oe)),b(this,oe,null)},{once:!0}),e.addEventListener("mouseenter",()=>{b(this,oe,setTimeout(()=>{b(this,oe,null),o(this,gs).classList.add("show"),o(this,Te)._reportTelemetry({action:"alt_text_tooltip"})},r))},{signal:a}),e.addEventListener("mouseleave",()=>{var l;o(this,oe)&&(clearTimeout(o(this,oe)),b(this,oe,null)),(l=o(this,gs))==null||l.classList.remove("show")},{signal:a})}t.innerText=o(this,ps)?await rs._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):o(this,fs),t.parentNode||e.append(t);const s=o(this,Te).getImageForAltText();s==null||s.setAttribute("aria-describedby",t.id)},z(rs,"_l10nPromise",null);let Gh=rs;var ji,Ce,$t,dr,$i,kt,zi,ur,fr,zt,Ao,Gi,Js,Eo,Vi,ms,ze,pr,gr,ve,wo,Ac,So,bu,xo,yu,To,Au,Ec,wp,wc,Sp,Co,Eu,Ro,wu,Po,Su,Sc,xp,xc,Tp,Tc,Cp,Cc,Rp,Io,xu,Wi,xa;const at=class at{constructor(e){g(this,So);g(this,To);g(this,Ec);g(this,wc);g(this,Co);g(this,Ro);g(this,Po);g(this,Sc);g(this,xc);g(this,Tc);g(this,Cc);g(this,Io);g(this,Wi);g(this,ji,null);g(this,Ce,null);g(this,$t,null);g(this,dr,!1);g(this,$i,!1);g(this,kt,null);g(this,zi,null);g(this,ur,this.focusin.bind(this));g(this,fr,this.focusout.bind(this));g(this,zt,null);g(this,Ao,"");g(this,Gi,!1);g(this,Js,null);g(this,Eo,!1);g(this,Vi,!1);g(this,ms,!1);g(this,ze,null);g(this,pr,0);g(this,gr,0);g(this,ve,null);z(this,"_initialOptions",Object.create(null));z(this,"_isVisible",!0);z(this,"_uiManager",null);z(this,"_focusEventsAllowed",!0);z(this,"_l10nPromise",null);g(this,wo,!1);g(this,Ac,at._zIndex++);this.constructor===at&&nt("Cannot initialize AnnotationEditor."),this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:n,pageY:r}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[n,r];const[a,l]=this.parentDimensions;this.x=e.x/a,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=at.prototype._resizeWithKeyboard,t=Nn.TRANSLATE_SMALL,s=Nn.TRANSLATE_BIG;return Z(this,"_resizerKeyboardManager",new oh([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],at.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return Z(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new Am({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t,s){if(at._l10nPromise||(at._l10nPromise=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(n=>[n,e.get(n.replaceAll(/([A-Z])/g,r=>`-${r.toLowerCase()}`))]))),s!=null&&s.strings)for(const n of s.strings)at._l10nPromise.set(n,e.get(n));if(at._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);at._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){nt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return o(this,wo)}set _isDraggable(e){var t;b(this,wo,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=o(this,Ac)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):y(this,Wi,xa).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(o(this,Gi)?b(this,Gi,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[n,r]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/n,this.y=(t+i)/r,this.fixAndSetPosition()}translate(e,t){y(this,So,bu).call(this,this.parentDimensions,e,t)}translateInPage(e,t){o(this,Js)||b(this,Js,[this.x,this.y]),y(this,So,bu).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){o(this,Js)||b(this,Js,[this.x,this.y]);const[s,i]=this.parentDimensions;if(this.x+=e/s,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:h,y:d}=this.div.getBoundingClientRect();this.parent.findNewParent(this,h,d)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:n,y:r}=this;const[a,l]=this.getBaseTranslation();n+=a,r+=l,this.div.style.left=`${(100*n).toFixed(2)}%`,this.div.style.top=`${(100*r).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!o(this,Js)&&(o(this,Js)[0]!==this.x||o(this,Js)[1]!==this.y)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=at,i=s/e,n=s/t;switch(this.rotation){case 90:return[-i,n];case 180:return[i,n];case 270:return[i,-n];default:return[-i,-n]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const[t,s]=this.pageDimensions;let{x:i,y:n,width:r,height:a}=this;if(r*=t,a*=s,i*=t,n*=s,this._mustFixPosition)switch(e){case 0:i=Math.max(0,Math.min(t-r,i)),n=Math.max(0,Math.min(s-a,n));break;case 90:i=Math.max(0,Math.min(t-a,i)),n=Math.min(s,Math.max(r,n));break;case 180:i=Math.min(t,Math.max(r,i)),n=Math.min(s,Math.max(a,n));break;case 270:i=Math.min(t,Math.max(a,i)),n=Math.max(0,Math.min(s-r,n));break}this.x=i/=t,this.y=n/=s;const[l,h]=this.getBaseTranslation();i+=l,n+=h;const{style:d}=this.div;d.left=`${(100*i).toFixed(2)}%`,d.top=`${(100*n).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return y(s=at,xo,yu).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return y(s=at,xo,yu).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this,i=t*e,n=s*e;return te.isCSSRoundSupported?[Math.round(i),Math.round(n)]:[i,n]}setDims(e,t){const[s,i]=this.parentDimensions;this.div.style.width=`${(100*e/s).toFixed(2)}%`,o(this,$i)||(this.div.style.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,i=s.endsWith("%"),n=!o(this,$i)&&t.endsWith("%");if(i&&n)return;const[r,a]=this.parentDimensions;i||(e.width=`${(100*parseFloat(s)/r).toFixed(2)}%`),!o(this,$i)&&!n&&(e.height=`${(100*parseFloat(t)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var e;(e=o(this,$t))==null||e.finish()}async addEditToolbar(){return o(this,zt)||o(this,Vi)?o(this,zt):(b(this,zt,new au(this)),this.div.append(o(this,zt).render()),o(this,$t)&&o(this,zt).addAltTextButton(await o(this,$t).render()),o(this,zt))}removeEditToolbar(){var e;o(this,zt)&&(o(this,zt).remove(),b(this,zt,null),(e=o(this,$t))==null||e.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){o(this,$t)||(Gh.initialize(at._l10nPromise),b(this,$t,new Gh(this)),o(this,ji)&&(o(this,$t).data=o(this,ji),b(this,ji,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=o(this,$t))==null?void 0:e.data}set altTextData(e){o(this,$t)&&(o(this,$t).data=e)}hasAltText(){var e;return!((e=o(this,$t))!=null&&e.isEmpty())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=o(this,dr)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground();const e=this._uiManager._signal;this.div.addEventListener("focusin",o(this,ur),{signal:e}),this.div.addEventListener("focusout",o(this,fr),{signal:e});const[t,s]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*s/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/s).toFixed(2)}%`);const[i,n]=this.getInitialTranslation();return this.translate(i,n),zh(this,this.div,["pointerdown"]),this.div}pointerdown(e){const{isMac:t}=te.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(b(this,Gi,!0),this._isDraggable){y(this,Sc,xp).call(this,e);return}y(this,Po,Su).call(this,e)}moveInDOM(){o(this,ze)&&clearTimeout(o(this,ze)),b(this,ze,setTimeout(()=>{var e;b(this,ze,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition()}getRect(e,t,s=this.rotation){const i=this.parentScale,[n,r]=this.pageDimensions,[a,l]=this.pageTranslation,h=e/i,d=t/i,u=this.x*n,f=this.y*r,p=this.width*n,m=this.height*r;switch(s){case 0:return[u+h+a,r-f-d-m+l,u+h+p+a,r-f-d+l];case 90:return[u+d+a,r-f+h+l,u+d+m+a,r-f+h+p+l];case 180:return[u-h-p+a,r-f+d+l,u-h+a,r-f+d+m+l];case 270:return[u-d-m+a,r-f-h-p+l,u-d+a,r-f-h+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,n,r]=e,a=n-s,l=r-i;switch(this.rotation){case 0:return[s,t-r,a,l];case 90:return[s,t-i,l,a];case 180:return[n,t-i,a,l];case 270:return[n,t-r,l,a];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){b(this,Vi,!0)}disableEditMode(){b(this,Vi,!1)}isInEditMode(){return o(this,Vi)}shouldGetKeyboardEvents(){return o(this,ms)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var t,s;const e=this._uiManager._signal;(t=this.div)==null||t.addEventListener("focusin",o(this,ur),{signal:e}),(s=this.div)==null||s.addEventListener("focusout",o(this,fr),{signal:e})}rotate(e){}serialize(e=!1,t=null){nt("An editor must be serializable")}static deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s});i.rotation=e.rotation,b(i,ji,e.accessibilityData);const[n,r]=i.pageDimensions,[a,l,h,d]=i.getRectInCurrentCoords(e.rect,r);return i.x=a/n,i.y=l/r,i.width=h/n,i.height=d/r,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.div.removeEventListener("focusin",o(this,ur)),this.div.removeEventListener("focusout",o(this,fr)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),o(this,ze)&&(clearTimeout(o(this,ze)),b(this,ze,null)),y(this,Wi,xa).call(this),this.removeEditToolbar(),o(this,ve)){for(const e of o(this,ve).values())clearTimeout(e);b(this,ve,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(y(this,Ec,wp).call(this),o(this,kt).classList.remove("hidden"),zh(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),b(this,zi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=o(this,kt).children;if(!o(this,Ce)){b(this,Ce,Array.from(t));const r=y(this,xc,Tp).bind(this),a=y(this,Tc,Cp).bind(this),l=this._uiManager._signal;for(const h of o(this,Ce)){const d=h.getAttribute("data-resizer-name");h.setAttribute("role","spinbutton"),h.addEventListener("keydown",r,{signal:l}),h.addEventListener("blur",a,{signal:l}),h.addEventListener("focus",y(this,Cc,Rp).bind(this,d),{signal:l}),at._l10nPromise.get(`pdfjs-editor-resizer-label-${d}`).then(u=>h.setAttribute("aria-label",u))}}const s=o(this,Ce)[0];let i=0;for(const r of t){if(r===s)break;i++}const n=(360-this.rotation+this.parentRotation)%360/90*(o(this,Ce).length/4);if(n!==i){if(n<i)for(let a=0;a<i-n;a++)o(this,kt).append(o(this,kt).firstChild);else if(n>i)for(let a=0;a<n-i;a++)o(this,kt).firstChild.before(o(this,kt).lastChild);let r=0;for(const a of t){const h=o(this,Ce)[r++].getAttribute("data-resizer-name");at._l10nPromise.get(`pdfjs-editor-resizer-label-${h}`).then(d=>a.setAttribute("aria-label",d))}}y(this,Io,xu).call(this,0),b(this,ms,!0),o(this,kt).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){o(this,ms)&&y(this,Ro,wu).call(this,o(this,Ao),{movementX:e,movementY:t})}_stopResizingWithKeyboard(){y(this,Wi,xa).call(this),this.div.focus()}select(){var e,t;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!o(this,zt)){this.addEditToolbar().then(()=>{var s,i;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((i=o(this,zt))==null||i.show())});return}(t=o(this,zt))==null||t.show()}unselect(){var e,t,s,i;(e=o(this,kt))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=o(this,zt))==null||i.hide()}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return o(this,Eo)}set isEditing(e){b(this,Eo,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){b(this,$i,!0);const s=e/t,{style:i}=this.div;i.aspectRatio=s,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){o(this,ve)||b(this,ve,new Map);const{action:s}=e;let i=o(this,ve).get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),o(this,ve).delete(s),o(this,ve).size===0&&b(this,ve,null)},at._telemetryTimeout),o(this,ve).set(s,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),b(this,dr,!1)}disable(){this.div&&(this.div.tabIndex=-1),b(this,dr,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};ji=new WeakMap,Ce=new WeakMap,$t=new WeakMap,dr=new WeakMap,$i=new WeakMap,kt=new WeakMap,zi=new WeakMap,ur=new WeakMap,fr=new WeakMap,zt=new WeakMap,Ao=new WeakMap,Gi=new WeakMap,Js=new WeakMap,Eo=new WeakMap,Vi=new WeakMap,ms=new WeakMap,ze=new WeakMap,pr=new WeakMap,gr=new WeakMap,ve=new WeakMap,wo=new WeakMap,Ac=new WeakMap,So=new WeakSet,bu=function([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this.fixAndSetPosition()},xo=new WeakSet,yu=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},To=new WeakSet,Au=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},Ec=new WeakSet,wp=function(){if(o(this,kt))return;b(this,kt,document.createElement("div")),o(this,kt).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");o(this,kt).append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",y(this,wc,Sp).bind(this,s),{signal:t}),i.addEventListener("contextmenu",ee,{signal:t}),i.tabIndex=-1}this.div.prepend(o(this,kt))},wc=new WeakSet,Sp=function(e,t){var v;t.preventDefault();const{isMac:s}=te.platform;if(t.button!==0||t.ctrlKey&&s)return;(v=o(this,$t))==null||v.toggle(!1);const i=y(this,Ro,wu).bind(this,e),n=this._isDraggable;this._isDraggable=!1;const r=this._uiManager._signal,a={passive:!0,capture:!0,signal:r};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",i,a),window.addEventListener("contextmenu",ee,{signal:r});const l=this.x,h=this.y,d=this.width,u=this.height,f=this.parent.div.style.cursor,p=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const m=()=>{var E;this.parent.togglePointerEvents(!0),(E=o(this,$t))==null||E.toggle(!0),this._isDraggable=n,window.removeEventListener("pointerup",m),window.removeEventListener("blur",m),window.removeEventListener("pointermove",i,a),window.removeEventListener("contextmenu",ee),this.parent.div.style.cursor=f,this.div.style.cursor=p,y(this,Co,Eu).call(this,l,h,d,u)};window.addEventListener("pointerup",m,{signal:r}),window.addEventListener("blur",m,{signal:r})},Co=new WeakSet,Eu=function(e,t,s,i){const n=this.x,r=this.y,a=this.width,l=this.height;n===e&&r===t&&a===s&&l===i||this.addCommands({cmd:()=>{this.width=a,this.height=l,this.x=n,this.y=r;const[h,d]=this.parentDimensions;this.setDims(h*a,d*l),this.fixAndSetPosition()},undo:()=>{this.width=s,this.height=i,this.x=e,this.y=t;const[h,d]=this.parentDimensions;this.setDims(h*s,d*i),this.fixAndSetPosition()},mustExec:!0})},Ro=new WeakSet,wu=function(e,t){const[s,i]=this.parentDimensions,n=this.x,r=this.y,a=this.width,l=this.height,h=at.MIN_SIZE/s,d=at.MIN_SIZE/i,u=F=>Math.round(F*1e4)/1e4,f=y(this,To,Au).call(this,this.rotation),p=(F,k)=>[f[0]*F+f[2]*k,f[1]*F+f[3]*k],m=y(this,To,Au).call(this,360-this.rotation),v=(F,k)=>[m[0]*F+m[2]*k,m[1]*F+m[3]*k];let E,A,w=!1,S=!1;switch(e){case"topLeft":w=!0,E=(F,k)=>[0,0],A=(F,k)=>[F,k];break;case"topMiddle":E=(F,k)=>[F/2,0],A=(F,k)=>[F/2,k];break;case"topRight":w=!0,E=(F,k)=>[F,0],A=(F,k)=>[0,k];break;case"middleRight":S=!0,E=(F,k)=>[F,k/2],A=(F,k)=>[0,k/2];break;case"bottomRight":w=!0,E=(F,k)=>[F,k],A=(F,k)=>[0,0];break;case"bottomMiddle":E=(F,k)=>[F/2,k],A=(F,k)=>[F/2,0];break;case"bottomLeft":w=!0,E=(F,k)=>[0,k],A=(F,k)=>[F,0];break;case"middleLeft":S=!0,E=(F,k)=>[0,k/2],A=(F,k)=>[F,k/2];break}const C=E(a,l),x=A(a,l);let T=p(...x);const R=u(n+T[0]),I=u(r+T[1]);let P=1,O=1,[L,W]=this.screenToPageTranslation(t.movementX,t.movementY);if([L,W]=v(L/s,W/i),w){const F=Math.hypot(a,l);P=O=Math.max(Math.min(Math.hypot(x[0]-C[0]-L,x[1]-C[1]-W)/F,1/a,1/l),h/a,d/l)}else S?P=Math.max(h,Math.min(1,Math.abs(x[0]-C[0]-L)))/a:O=Math.max(d,Math.min(1,Math.abs(x[1]-C[1]-W)))/l;const H=u(a*P),X=u(l*O);T=p(...A(H,X));const Y=R-T[0],K=I-T[1];this.width=H,this.height=X,this.x=Y,this.y=K,this.setDims(s*H,i*X),this.fixAndSetPosition()},Po=new WeakSet,Su=function(e){const{isMac:t}=te.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},Sc=new WeakSet,xp=function(e){const t=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let s,i;const n=this._uiManager._signal;t&&(this.div.classList.add("moving"),s={passive:!0,capture:!0,signal:n},b(this,pr,e.clientX),b(this,gr,e.clientY),i=a=>{const{clientX:l,clientY:h}=a,[d,u]=this.screenToPageTranslation(l-o(this,pr),h-o(this,gr));b(this,pr,l),b(this,gr,h),this._uiManager.dragSelectedEditors(d,u)},window.addEventListener("pointermove",i,s));const r=()=>{window.removeEventListener("pointerup",r),window.removeEventListener("blur",r),t&&(this.div.classList.remove("moving"),window.removeEventListener("pointermove",i,s)),b(this,Gi,!1),this._uiManager.endDragSession()||y(this,Po,Su).call(this,e)};window.addEventListener("pointerup",r,{signal:n}),window.addEventListener("blur",r,{signal:n})},xc=new WeakSet,Tp=function(e){at._resizerKeyboardManager.exec(this,e)},Tc=new WeakSet,Cp=function(e){var t;o(this,ms)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==o(this,kt)&&y(this,Wi,xa).call(this)},Cc=new WeakSet,Rp=function(e){b(this,Ao,o(this,ms)?e:"")},Io=new WeakSet,xu=function(e){if(o(this,Ce))for(const t of o(this,Ce))t.tabIndex=e},Wi=new WeakSet,xa=function(){if(b(this,ms,!1),y(this,Io,xu).call(this,-1),o(this,zi)){const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=o(this,zi);y(this,Co,Eu).call(this,e,t,s,i),b(this,zi,null)}},g(at,xo),z(at,"_borderLineWidth",-1),z(at,"_colorManager",new cu),z(at,"_zIndex",1),z(at,"_telemetryTimeout",1e3);let et=at;class Am extends et{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}const Of=3285377520,ge=4294901760,ke=65535;class Pp{constructor(e){this.h1=e?e&4294967295:Of,this.h2=e?e&4294967295:Of}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let v=0,E=e.length;v<E;v++){const A=e.charCodeAt(v);A<=255?t[s++]=A:(t[s++]=A>>>8,t[s++]=A&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,n=s-i*4,r=new Uint32Array(t.buffer,0,i);let a=0,l=0,h=this.h1,d=this.h2;const u=3432918353,f=461845907,p=u&ke,m=f&ke;for(let v=0;v<i;v++)v&1?(a=r[v],a=a*u&ge|a*p&ke,a=a<<15|a>>>17,a=a*f&ge|a*m&ke,h^=a,h=h<<13|h>>>19,h=h*5+3864292196):(l=r[v],l=l*u&ge|l*p&ke,l=l<<15|l>>>17,l=l*f&ge|l*m&ke,d^=l,d=d<<13|d>>>19,d=d*5+3864292196);switch(a=0,n){case 3:a^=t[i*4+2]<<16;case 2:a^=t[i*4+1]<<8;case 1:a^=t[i*4],a=a*u&ge|a*p&ke,a=a<<15|a>>>17,a=a*f&ge|a*m&ke,i&1?h^=a:d^=a}this.h1=h,this.h2=d}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&ge|e*36045&ke,t=t*4283543511&ge|((t<<16|e>>>16)*2950163797&ge)>>>16,e^=t>>>1,e=e*444984403&ge|e*60499&ke,t=t*3301882366&ge|((t<<16|e>>>16)*3120437893&ge)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Tu=Object.freeze({map:null,hash:"",transfer:void 0});var Xi,Yi,_t,Rc,Ip;class wf{constructor(){g(this,Rc);g(this,Xi,!1);g(this,Yi,null);g(this,_t,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=o(this,_t).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return o(this,_t).get(e)}remove(e){if(o(this,_t).delete(e),o(this,_t).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of o(this,_t).values())if(t instanceof et)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=o(this,_t).get(e);let i=!1;if(s!==void 0)for(const[n,r]of Object.entries(t))s[n]!==r&&(i=!0,s[n]=r);else i=!0,o(this,_t).set(e,t);i&&y(this,Rc,Ip).call(this),t instanceof et&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return o(this,_t).has(e)}getAll(){return o(this,_t).size>0?mf(o(this,_t)):null}setAll(e){for(const[t,s]of Object.entries(e))this.setValue(t,s)}get size(){return o(this,_t).size}resetModified(){o(this,Xi)&&(b(this,Xi,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Mp(this)}get serializable(){if(o(this,_t).size===0)return Tu;const e=new Map,t=new Pp,s=[],i=Object.create(null);let n=!1;for(const[r,a]of o(this,_t)){const l=a instanceof et?a.serialize(!1,i):a;l&&(e.set(r,l),t.update(`${r}:${JSON.stringify(l)}`),n||(n=!!l.bitmap))}if(n)for(const r of e.values())r.bitmap&&s.push(r.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:Tu}get editorStats(){let e=null;const t=new Map;for(const s of o(this,_t).values()){if(!(s instanceof et))continue;const i=s.telemetryFinalData;if(!i)continue;const{type:n}=i;t.has(n)||t.set(n,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const r=e[n]||(e[n]=new Map);for(const[a,l]of Object.entries(i)){if(a==="type")continue;let h=r.get(a);h||(h=new Map,r.set(a,h));const d=h.get(l)??0;h.set(l,d+1)}}for(const[s,i]of t)e[s]=i.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){b(this,Yi,null)}get modifiedIds(){if(o(this,Yi))return o(this,Yi);const e=[];for(const t of o(this,_t).values())!(t instanceof et)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return b(this,Yi,{ids:new Set(e),hash:e.join(",")})}}Xi=new WeakMap,Yi=new WeakMap,_t=new WeakMap,Rc=new WeakSet,Ip=function(){o(this,Xi)||(b(this,Xi,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Mo;class Mp extends wf{constructor(t){super();g(this,Mo,void 0);const{map:s,hash:i,transfer:n}=t.serializable,r=structuredClone(s,n?{transfer:n}:null);b(this,Mo,{map:r,hash:i,transfer:n})}get print(){nt("Should not call PrintAnnotationStorage.print")}get serializable(){return o(this,Mo)}get modifiedIds(){return Z(this,"modifiedIds",{ids:new Set,hash:""})}}Mo=new WeakMap;var mr;class Em{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){g(this,mr,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),o(this,mr).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||o(this,mr).has(e.loadedName))){if(Tt(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:i,style:n}=e,r=new FontFace(s,i,n);this.addNativeFontFace(r);try{await r.load(),o(this,mr).add(s),t==null||t(e)}catch{V(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(r)}return}nt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw V(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return Z(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Vt||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),Z(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(Tt(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const n=s.shift();setTimeout(n.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:t,callback:e};return s.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Z(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(C,x){return C.charCodeAt(x)<<24|C.charCodeAt(x+1)<<16|C.charCodeAt(x+2)<<8|C.charCodeAt(x+3)&255}function i(C,x,T,R){const I=C.substring(0,x),P=C.substring(x+T);return I+R+P}let n,r;const a=this._document.createElement("canvas");a.width=1,a.height=1;const l=a.getContext("2d");let h=0;function d(C,x){if(++h>30){V("Load test font never loaded."),x();return}if(l.font="30px "+C,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){x();return}setTimeout(d.bind(null,C,x))}const u=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=i(f,976,u.length,u);const m=16,v=1482184792;let E=s(f,m);for(n=0,r=u.length-3;n<r;n+=4)E=E-v+s(u,n)|0;n<u.length&&(E=E-v+s(u+"XXX",n)|0),f=i(f,m,4,nm(E));const A=`url(data:font/opentype;base64,${btoa(f)});`,w=`@font-face {font-family:"${u}";src:${A}}`;this.insertRule(w);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const C of[e.loadedName,u]){const x=this._document.createElement("span");x.textContent="Hi",x.style.fontFamily=C,S.append(x)}this._document.body.append(S),d(u,()=>{S.remove(),t.complete()})}}mr=new WeakMap;class wm{constructor(e,{disableFontFace:t=!1,inspectFont:s=null}){this.compiledGlyphs=Object.create(null);for(const i in e)this[i]=e[i];this.disableFontFace=t===!0,this._inspectFont=s}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var i;if(!this.data||this.disableFontFace)return null;const e=Zf(this.data),t=`url(data:${this.mimetype};base64,${btoa(e)});`;let s;if(!this.cssFontInfo)s=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),s=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${t}}`}return(i=this._inspectFont)==null||i.call(this,this,t),s}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];let s;try{s=e.get(this.loadedName+"_path_"+t)}catch(n){V(`getPathGenerator - ignoring character: "${n}".`)}if(!Array.isArray(s)||s.length===0)return this.compiledGlyphs[t]=function(n,r){};const i=[];for(let n=0,r=s.length;n<r;)switch(s[n++]){case ss.BEZIER_CURVE_TO:{const[a,l,h,d,u,f]=s.slice(n,n+6);i.push(p=>p.bezierCurveTo(a,l,h,d,u,f)),n+=6}break;case ss.MOVE_TO:{const[a,l]=s.slice(n,n+2);i.push(h=>h.moveTo(a,l)),n+=2}break;case ss.LINE_TO:{const[a,l]=s.slice(n,n+2);i.push(h=>h.lineTo(a,l)),n+=2}break;case ss.QUADRATIC_CURVE_TO:{const[a,l,h,d]=s.slice(n,n+4);i.push(u=>u.quadraticCurveTo(a,l,h,d)),n+=4}break;case ss.RESTORE:i.push(a=>a.restore());break;case ss.SAVE:i.push(a=>a.save());break;case ss.SCALE:Tt(i.length===2,"Scale command is only valid at the third position.");break;case ss.TRANSFORM:{const[a,l,h,d,u,f]=s.slice(n,n+6);i.push(p=>p.transform(a,l,h,d,u,f)),n+=6}break;case ss.TRANSLATE:{const[a,l]=s.slice(n,n+2);i.push(h=>h.translate(a,l)),n+=2}break}return this.compiledGlyphs[t]=function(r,a){i[0](r),i[1](r),r.scale(a,-a);for(let l=2,h=i.length;l<h;l++)i[l](r)}}}if(Vt){var Cu=Promise.withResolvers(),Da=null;(async()=>{const e=await yi(()=>import("./__vite-browser-external.b25bb000.js"),[],import.meta.url),t=await yi(()=>import("./__vite-browser-external.b25bb000.js"),[],import.meta.url),s=await yi(()=>import("./__vite-browser-external.b25bb000.js"),[],import.meta.url),i=await yi(()=>import("./__vite-browser-external.b25bb000.js"),[],import.meta.url);let n,r;try{n=await yi(()=>import("./__vite-browser-external.b25bb000.js"),[],import.meta.url)}catch{}try{r=await yi(()=>import("./index.60f13653.js"),[],import.meta.url)}catch{}return new Map(Object.entries({fs:e,http:t,https:s,url:i,canvas:n,path2d:r}))})().then(e=>{var t,s,i,n;if(Da=e,Cu.resolve(),!globalThis.DOMMatrix){const r=(t=e.get("canvas"))==null?void 0:t.DOMMatrix;r?globalThis.DOMMatrix=r:V("Cannot polyfill `DOMMatrix`, rendering may be broken.")}if(!globalThis.Path2D){const r=(s=e.get("canvas"))==null?void 0:s.CanvasRenderingContext2D,a=(i=e.get("path2d"))==null?void 0:i.applyPath2DToCanvasRenderingContext,l=(n=e.get("path2d"))==null?void 0:n.Path2D;r&&a&&l?(a(r),globalThis.Path2D=l):V("Cannot polyfill `Path2D`, rendering may be broken.")}},e=>{V(`loadPackages: ${e}`),Da=new Map,Cu.resolve()})}class es{static get promise(){return Cu.promise}static get(e){return Da==null?void 0:Da.get(e)}}const Lp=function(c){return es.get("fs").promises.readFile(c).then(t=>new Uint8Array(t))};class Sm extends Hd{}class xm extends $h{_createCanvas(e,t){return es.get("canvas").createCanvas(e,t)}}class Tm extends Ud{_fetchData(e,t){return Lp(e).then(s=>({cMapData:s,compressionType:t}))}}class Cm extends jd{_fetchData(e){return Lp(e)}}const Kt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Ru(c,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),c.clip(i)}class lh{constructor(){this.constructor===lh&&nt("Cannot initialize BaseShadingPattern.")}getPattern(){nt("Abstract method `getPattern` called.")}}class Rm extends lh{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,i){let n;if(i===Kt.STROKE||i===Kt.FILL){const r=t.current.getClippedPathBoundingBox(i,ut(e))||[0,0,0,0],a=Math.ceil(r[2]-r[0])||1,l=Math.ceil(r[3]-r[1])||1,h=t.cachedCanvases.getCanvas("pattern",a,l,!0),d=h.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-r[0],-r[1]),s=N.transform(s,[1,0,0,1,r[0],r[1]]),d.transform(...t.baseTransform),this.matrix&&d.transform(...this.matrix),Ru(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),n=e.createPattern(h.canvas,"no-repeat");const u=new DOMMatrix(s);n.setTransform(u)}else Ru(e,this._bbox),n=this._createGradient(e);return n}}function Qd(c,e,t,s,i,n,r,a){const l=e.coords,h=e.colors,d=c.data,u=c.width*4;let f;l[t+1]>l[s+1]&&(f=t,t=s,s=f,f=n,n=r,r=f),l[s+1]>l[i+1]&&(f=s,s=i,i=f,f=r,r=a,a=f),l[t+1]>l[s+1]&&(f=t,t=s,s=f,f=n,n=r,r=f);const p=(l[t]+e.offsetX)*e.scaleX,m=(l[t+1]+e.offsetY)*e.scaleY,v=(l[s]+e.offsetX)*e.scaleX,E=(l[s+1]+e.offsetY)*e.scaleY,A=(l[i]+e.offsetX)*e.scaleX,w=(l[i+1]+e.offsetY)*e.scaleY;if(m>=w)return;const S=h[n],C=h[n+1],x=h[n+2],T=h[r],R=h[r+1],I=h[r+2],P=h[a],O=h[a+1],L=h[a+2],W=Math.round(m),H=Math.round(w);let X,Y,K,F,k,lt,bt,Qt;for(let rt=W;rt<=H;rt++){if(rt<E){const M=rt<m?0:(m-rt)/(m-E);X=p-(p-v)*M,Y=S-(S-T)*M,K=C-(C-R)*M,F=x-(x-I)*M}else{let M;rt>w?M=1:E===w?M=0:M=(E-rt)/(E-w),X=v-(v-A)*M,Y=T-(T-P)*M,K=R-(R-O)*M,F=I-(I-L)*M}let ht;rt<m?ht=0:rt>w?ht=1:ht=(m-rt)/(m-w),k=p-(p-A)*ht,lt=S-(S-P)*ht,bt=C-(C-O)*ht,Qt=x-(x-L)*ht;const Bs=Math.round(Math.min(X,k)),pe=Math.round(Math.max(X,k));let D=u*rt+Bs*4;for(let M=Bs;M<=pe;M++)ht=(X-M)/(X-k),ht<0?ht=0:ht>1&&(ht=1),d[D++]=Y-(Y-lt)*ht|0,d[D++]=K-(K-bt)*ht|0,d[D++]=F-(F-Qt)*ht|0,d[D++]=255}}function Pm(c,e,t){const s=e.coords,i=e.colors;let n,r;switch(e.type){case"lattice":const a=e.verticesPerRow,l=Math.floor(s.length/a)-1,h=a-1;for(n=0;n<l;n++){let d=n*a;for(let u=0;u<h;u++,d++)Qd(c,t,s[d],s[d+1],s[d+a],i[d],i[d+1],i[d+a]),Qd(c,t,s[d+a+1],s[d+1],s[d+a],i[d+a+1],i[d+1],i[d+a])}break;case"triangles":for(n=0,r=s.length;n<r;n+=3)Qd(c,t,s[n],s[n+1],s[n+2],i[n],i[n+1],i[n+2]);break;default:throw new Error("illegal figure")}}class Im extends lh{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,s){const a=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),h=Math.ceil(this._bounds[2])-a,d=Math.ceil(this._bounds[3])-l,u=Math.min(Math.ceil(Math.abs(h*e[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(d*e[1]*1.1)),3e3),p=h/u,m=d/f,v={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-l,scaleX:1/p,scaleY:1/m},E=u+2*2,A=f+2*2,w=s.getCanvas("mesh",E,A,!1),S=w.context,C=S.createImageData(u,f);if(t){const T=C.data;for(let R=0,I=T.length;R<I;R+=4)T[R]=t[0],T[R+1]=t[1],T[R+2]=t[2],T[R+3]=255}for(const T of this._figures)Pm(C,T,v);return S.putImageData(C,2,2),{canvas:w.canvas,offsetX:a-2*p,offsetY:l-2*m,scaleX:p,scaleY:m}}getPattern(e,t,s,i){Ru(e,this._bbox);let n;if(i===Kt.SHADING)n=N.singularValueDecompose2dScale(ut(e));else if(n=N.singularValueDecompose2dScale(t.baseTransform),this.matrix){const a=N.singularValueDecompose2dScale(this.matrix);n=[n[0]*a[0],n[1]*a[1]]}const r=this._createMeshCanvas(n,i===Kt.SHADING?null:this._background,t.cachedCanvases);return i!==Kt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(r.offsetX,r.offsetY),e.scale(r.scaleX,r.scaleY),e.createPattern(r.canvas,"no-repeat")}}class Mm extends lh{getPattern(){return"hotpink"}}function Lm(c){switch(c[0]){case"RadialAxial":return new Rm(c);case"Mesh":return new Im(c);case"Dummy":return new Mm}throw new Error(`Unknown IR type: ${c[0]}`)}const Df={COLORED:1,UNCOLORED:2},Pc=class Pc{constructor(e,t,s,i,n){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=s,this.canvasGraphicsFactory=i,this.baseTransform=n}createPatternCanvas(e){const t=this.operatorList,s=this.bbox,i=this.xstep,n=this.ystep,r=this.paintType,a=this.tilingType,l=this.color,h=this.canvasGraphicsFactory;kd("TilingType: "+a);const d=s[0],u=s[1],f=s[2],p=s[3],m=N.singularValueDecompose2dScale(this.matrix),v=N.singularValueDecompose2dScale(this.baseTransform),E=[m[0]*v[0],m[1]*v[1]],A=this.getSizeAndScale(i,this.ctx.canvas.width,E[0]),w=this.getSizeAndScale(n,this.ctx.canvas.height,E[1]),S=e.cachedCanvases.getCanvas("pattern",A.size,w.size,!0),C=S.context,x=h.createCanvasGraphics(C);x.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(x,r,l);let T=d,R=u,I=f,P=p;return d<0&&(T=0,I+=Math.abs(d)),u<0&&(R=0,P+=Math.abs(u)),C.translate(-(A.scale*T),-(w.scale*R)),x.transform(A.scale,0,0,w.scale,0,0),C.save(),this.clipBbox(x,T,R,I,P),x.baseTransform=ut(x.ctx),x.executeOperatorList(t),x.endDrawing(),{canvas:S.canvas,scaleX:A.scale,scaleY:w.scale,offsetX:T,offsetY:R}}getSizeAndScale(e,t,s){e=Math.abs(e);const i=Math.max(Pc.MAX_PATTERN_SIZE,t);let n=Math.ceil(e*s);return n>=i?n=i:s=n/e,{scale:s,size:n}}clipBbox(e,t,s,i,n){const r=i-t,a=n-s;e.ctx.rect(t,s,r,a),e.current.updateRectMinMax(ut(e.ctx),[t,s,i,n]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,n=e.current;switch(t){case Df.COLORED:const r=this.ctx;i.fillStyle=r.fillStyle,i.strokeStyle=r.strokeStyle,n.fillColor=r.fillStyle,n.strokeColor=r.strokeStyle;break;case Df.UNCOLORED:const a=N.makeHexColor(s[0],s[1],s[2]);i.fillStyle=a,i.strokeStyle=a,n.fillColor=a,n.strokeColor=a;break;default:throw new im(`Unsupported paint type: ${t}`)}}getPattern(e,t,s,i){let n=s;i!==Kt.SHADING&&(n=N.transform(n,t.baseTransform),this.matrix&&(n=N.transform(n,this.matrix)));const r=this.createPatternCanvas(t);let a=new DOMMatrix(n);a=a.translate(r.offsetX,r.offsetY),a=a.scale(1/r.scaleX,1/r.scaleY);const l=e.createPattern(r.canvas,"repeat");return l.setTransform(a),l}};z(Pc,"MAX_PATTERN_SIZE",3e3);let Pu=Pc;function _m({src:c,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:n=4294967295,inverseDecode:r=!1}){const a=te.isLittleEndian?4278190080:255,[l,h]=r?[n,a]:[a,n],d=s>>3,u=s&7,f=c.length;t=new Uint32Array(t.buffer);let p=0;for(let m=0;m<i;m++){for(const E=e+d;e<E;e++){const A=e<f?c[e]:255;t[p++]=A&128?h:l,t[p++]=A&64?h:l,t[p++]=A&32?h:l,t[p++]=A&16?h:l,t[p++]=A&8?h:l,t[p++]=A&4?h:l,t[p++]=A&2?h:l,t[p++]=A&1?h:l}if(u===0)continue;const v=e<f?c[e++]:255;for(let E=0;E<u;E++)t[p++]=v&1<<7-E?h:l}return{srcPos:e,destPos:p}}const Ff=16,kf=100,Om=15,Nf=10,Bf=1e3,qt=16;function Dm(c,e){if(c._removeMirroring)throw new Error("Context is already forwarding operations.");c.__originalSave=c.save,c.__originalRestore=c.restore,c.__originalRotate=c.rotate,c.__originalScale=c.scale,c.__originalTranslate=c.translate,c.__originalTransform=c.transform,c.__originalSetTransform=c.setTransform,c.__originalResetTransform=c.resetTransform,c.__originalClip=c.clip,c.__originalMoveTo=c.moveTo,c.__originalLineTo=c.lineTo,c.__originalBezierCurveTo=c.bezierCurveTo,c.__originalRect=c.rect,c.__originalClosePath=c.closePath,c.__originalBeginPath=c.beginPath,c._removeMirroring=()=>{c.save=c.__originalSave,c.restore=c.__originalRestore,c.rotate=c.__originalRotate,c.scale=c.__originalScale,c.translate=c.__originalTranslate,c.transform=c.__originalTransform,c.setTransform=c.__originalSetTransform,c.resetTransform=c.__originalResetTransform,c.clip=c.__originalClip,c.moveTo=c.__originalMoveTo,c.lineTo=c.__originalLineTo,c.bezierCurveTo=c.__originalBezierCurveTo,c.rect=c.__originalRect,c.closePath=c.__originalClosePath,c.beginPath=c.__originalBeginPath,delete c._removeMirroring},c.save=function(){e.save(),this.__originalSave()},c.restore=function(){e.restore(),this.__originalRestore()},c.translate=function(s,i){e.translate(s,i),this.__originalTranslate(s,i)},c.scale=function(s,i){e.scale(s,i),this.__originalScale(s,i)},c.transform=function(s,i,n,r,a,l){e.transform(s,i,n,r,a,l),this.__originalTransform(s,i,n,r,a,l)},c.setTransform=function(s,i,n,r,a,l){e.setTransform(s,i,n,r,a,l),this.__originalSetTransform(s,i,n,r,a,l)},c.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},c.rotate=function(s){e.rotate(s),this.__originalRotate(s)},c.clip=function(s){e.clip(s),this.__originalClip(s)},c.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},c.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},c.bezierCurveTo=function(t,s,i,n,r,a){e.bezierCurveTo(t,s,i,n,r,a),this.__originalBezierCurveTo(t,s,i,n,r,a)},c.rect=function(t,s,i,n){e.rect(t,s,i,n),this.__originalRect(t,s,i,n)},c.closePath=function(){e.closePath(),this.__originalClosePath()},c.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class Fm{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function dh(c,e,t,s,i,n,r,a,l,h){const[d,u,f,p,m,v]=ut(c);if(u===0&&f===0){const w=r*d+m,S=Math.round(w),C=a*p+v,x=Math.round(C),T=(r+l)*d+m,R=Math.abs(Math.round(T)-S)||1,I=(a+h)*p+v,P=Math.abs(Math.round(I)-x)||1;return c.setTransform(Math.sign(d),0,0,Math.sign(p),S,x),c.drawImage(e,t,s,i,n,0,0,R,P),c.setTransform(d,u,f,p,m,v),[R,P]}if(d===0&&p===0){const w=a*f+m,S=Math.round(w),C=r*u+v,x=Math.round(C),T=(a+h)*f+m,R=Math.abs(Math.round(T)-S)||1,I=(r+l)*u+v,P=Math.abs(Math.round(I)-x)||1;return c.setTransform(0,Math.sign(u),Math.sign(f),0,S,x),c.drawImage(e,t,s,i,n,0,0,P,R),c.setTransform(d,u,f,p,m,v),[P,R]}c.drawImage(e,t,s,i,n,r,a,l,h);const E=Math.hypot(d,u),A=Math.hypot(f,p);return[E*l,A*h]}function km(c){const{width:e,height:t}=c;if(e>Bf||t>Bf)return null;const s=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),n=e+1;let r=new Uint8Array(n*(t+1)),a,l,h;const d=e+7&-8;let u=new Uint8Array(d*t),f=0;for(const A of c.data){let w=128;for(;w>0;)u[f++]=A&w?0:255,w>>=1}let p=0;for(f=0,u[f]!==0&&(r[0]=1,++p),l=1;l<e;l++)u[f]!==u[f+1]&&(r[l]=u[f]?2:1,++p),f++;for(u[f]!==0&&(r[l]=2,++p),a=1;a<t;a++){f=a*d,h=a*n,u[f-d]!==u[f]&&(r[h]=u[f]?1:8,++p);let A=(u[f]?4:0)+(u[f-d]?8:0);for(l=1;l<e;l++)A=(A>>2)+(u[f+1]?4:0)+(u[f-d+1]?8:0),i[A]&&(r[h+l]=i[A],++p),f++;if(u[f-d]!==u[f]&&(r[h+l]=u[f]?2:4,++p),p>s)return null}for(f=d*(t-1),h=a*n,u[f]!==0&&(r[h]=8,++p),l=1;l<e;l++)u[f]!==u[f+1]&&(r[h+l]=u[f]?4:8,++p),f++;if(u[f]!==0&&(r[h+l]=4,++p),p>s)return null;const m=new Int32Array([0,n,-1,0,-n,0,0,0,1]),v=new Path2D;for(a=0;p&&a<=t;a++){let A=a*n;const w=A+e;for(;A<w&&!r[A];)A++;if(A===w)continue;v.moveTo(A%n,a);const S=A;let C=r[A];do{const x=m[C];do A+=x;while(!r[A]);const T=r[A];T!==5&&T!==10?(C=T,r[A]=0):(C=T&51*C>>4,r[A]&=C>>2|C<<2),v.lineTo(A%n,A/n|0),r[A]||--p}while(S!==A);--a}return u=null,r=null,function(A){A.save(),A.scale(1/e,-1/t),A.translate(0,-t),A.fill(v),A.beginPath(),A.restore()}}class Hf{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=Qf,this.textMatrixScale=1,this.fontMatrix=qd,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Ht.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,s){[t,s]=N.applyTransform([t,s],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(e,t){const s=N.applyTransform(t,e),i=N.applyTransform(t.slice(2),e),n=N.applyTransform([t[0],t[3]],e),r=N.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,s[0],i[0],n[0],r[0]),this.minY=Math.min(this.minY,s[1],i[1],n[1],r[1]),this.maxX=Math.max(this.maxX,s[0],i[0],n[0],r[0]),this.maxY=Math.max(this.maxY,s[1],i[1],n[1],r[1])}updateScalingPathMinMax(e,t){N.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,s,i,n,r,a,l,h,d){const u=N.bezierBoundingBox(t,s,i,n,r,a,l,h,d);d||this.updateRectMinMax(e,u)}getPathBoundingBox(e=Kt.FILL,t=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(e===Kt.STROKE){t||nt("Stroke bounding box must include transform.");const i=N.singularValueDecompose2dScale(t),n=i[0]*this.lineWidth/2,r=i[1]*this.lineWidth/2;s[0]-=n,s[1]-=r,s[2]+=n,s[3]+=r}return s}updateClipFromPath(){const e=N.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Kt.FILL,t=null){return N.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Uf(c,e){if(typeof ImageData<"u"&&e instanceof ImageData){c.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%qt,n=(t-i)/qt,r=i===0?n:n+1,a=c.createImageData(s,qt);let l=0,h;const d=e.data,u=a.data;let f,p,m,v;if(e.kind===mh.GRAYSCALE_1BPP){const E=d.byteLength,A=new Uint32Array(u.buffer,0,u.byteLength>>2),w=A.length,S=s+7>>3,C=4294967295,x=te.isLittleEndian?4278190080:255;for(f=0;f<r;f++){for(m=f<n?qt:i,h=0,p=0;p<m;p++){const T=E-l;let R=0;const I=T>S?s:T*8-7,P=I&-8;let O=0,L=0;for(;R<P;R+=8)L=d[l++],A[h++]=L&128?C:x,A[h++]=L&64?C:x,A[h++]=L&32?C:x,A[h++]=L&16?C:x,A[h++]=L&8?C:x,A[h++]=L&4?C:x,A[h++]=L&2?C:x,A[h++]=L&1?C:x;for(;R<I;R++)O===0&&(L=d[l++],O=128),A[h++]=L&O?C:x,O>>=1}for(;h<w;)A[h++]=0;c.putImageData(a,0,f*qt)}}else if(e.kind===mh.RGBA_32BPP){for(p=0,v=s*qt*4,f=0;f<n;f++)u.set(d.subarray(l,l+v)),l+=v,c.putImageData(a,0,p),p+=qt;f<r&&(v=s*i*4,u.set(d.subarray(l,l+v)),c.putImageData(a,0,p))}else if(e.kind===mh.RGB_24BPP)for(m=qt,v=s*m,f=0;f<r;f++){for(f>=n&&(m=i,v=s*m),h=0,p=v;p--;)u[h++]=d[l++],u[h++]=d[l++],u[h++]=d[l++],u[h++]=255;c.putImageData(a,0,f*qt)}else throw new Error(`bad image kind: ${e.kind}`)}function jf(c,e){if(e.bitmap){c.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%qt,n=(t-i)/qt,r=i===0?n:n+1,a=c.createImageData(s,qt);let l=0;const h=e.data,d=a.data;for(let u=0;u<r;u++){const f=u<n?qt:i;({srcPos:l}=_m({src:h,srcPos:l,dest:d,width:s,height:f,nonBlackColor:0})),c.putImageData(a,0,u*qt)}}function va(c,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)c[s]!==void 0&&(e[s]=c[s]);c.setLineDash!==void 0&&(e.setLineDash(c.getLineDash()),e.lineDashOffset=c.lineDashOffset)}function uh(c){if(c.strokeStyle=c.fillStyle="#000000",c.fillRule="nonzero",c.globalAlpha=1,c.lineWidth=1,c.lineCap="butt",c.lineJoin="miter",c.miterLimit=10,c.globalCompositeOperation="source-over",c.font="10px sans-serif",c.setLineDash!==void 0&&(c.setLineDash([]),c.lineDashOffset=0),!Vt){const{filter:e}=c;e!=="none"&&e!==""&&(c.filter="none")}}function $f(c,e){if(e)return!0;const t=N.singularValueDecompose2dScale(c);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*vi.PDF_TO_CSS_UNITS);return t[0]<=s&&t[1]<=s}const Nm=["butt","round","square"],Bm=["miter","round","bevel"],Hm={},zf={};var Lo,Iu,_o,Mu;const Rf=class Rf{constructor(e,t,s,i,n,{optionalContentConfig:r,markedContentStack:a=null},l,h){g(this,Lo);g(this,_o);this.ctx=e,this.current=new Hf(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=n,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=r,this.cachedCanvases=new Fm(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=h,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const n=this.ctx.canvas.width,r=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,n,r),this.ctx.fillStyle=a,s){const l=this.cachedCanvases.getCanvas("transparent",n,r);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...ut(this.compositeCtx))}this.ctx.save(),uh(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=ut(this.ctx)}executeOperatorList(e,t,s,i){const n=e.argsArray,r=e.fnArray;let a=t||0;const l=n.length;if(l===a)return a;const h=l-a>Nf&&typeof s=="function",d=h?Date.now()+Om:0;let u=0;const f=this.commonObjs,p=this.objs;let m;for(;;){if(i!==void 0&&a===i.nextBreakPoint)return i.breakIt(a,s),a;if(m=r[a],m!==Ee.dependency)this[m].apply(this,n[a]);else for(const v of n[a]){const E=v.startsWith("g_")?f:p;if(!E.has(v))return E.get(v,s),a}if(a++,a===l)return a;if(h&&++u>Nf){if(Date.now()>d)return s(),a;u=0}}}endDrawing(){y(this,Lo,Iu).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),y(this,_o,Mu).call(this)}_scaleImage(e,t){const s=e.width,i=e.height;let n=Math.max(Math.hypot(t[0],t[1]),1),r=Math.max(Math.hypot(t[2],t[3]),1),a=s,l=i,h="prescale1",d,u;for(;n>2&&a>1||r>2&&l>1;){let f=a,p=l;n>2&&a>1&&(f=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),n/=a/f),r>2&&l>1&&(p=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,r/=l/p),d=this.cachedCanvases.getCanvas(h,f,p),u=d.context,u.clearRect(0,0,f,p),u.drawImage(e,0,0,a,l,0,0,f,p),e=d.canvas,a=f,l=p,h=h==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:i}=e,n=this.current.fillColor,r=this.current.patternFill,a=ut(t);let l,h,d,u;if((e.bitmap||e.data)&&e.count>1){const I=e.bitmap||e.data.buffer;h=JSON.stringify(r?a:[a.slice(0,4),n]),l=this._cachedBitmapsMap.get(I),l||(l=new Map,this._cachedBitmapsMap.set(I,l));const P=l.get(h);if(P&&!r){const O=Math.round(Math.min(a[0],a[2])+a[4]),L=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:P,offsetX:O,offsetY:L}}d=P}d||(u=this.cachedCanvases.getCanvas("maskCanvas",s,i),jf(u.context,e));let f=N.transform(a,[1/s,0,0,-1/i,0,0]);f=N.transform(f,[1,0,0,1,0,-i]);const[p,m,v,E]=N.getAxialAlignedBoundingBox([0,0,s,i],f),A=Math.round(v-p)||1,w=Math.round(E-m)||1,S=this.cachedCanvases.getCanvas("fillCanvas",A,w),C=S.context,x=p,T=m;C.translate(-x,-T),C.transform(...f),d||(d=this._scaleImage(u.canvas,is(C)),d=d.img,l&&r&&l.set(h,d)),C.imageSmoothingEnabled=$f(ut(C),e.interpolate),dh(C,d,0,0,d.width,d.height,0,0,s,i),C.globalCompositeOperation="source-in";const R=N.transform(is(C),[1,0,0,1,-x,-T]);return C.fillStyle=r?n.getPattern(t,this,R,Kt.FILL):n,C.fillRect(0,0,s,i),l&&!r&&(this.cachedCanvases.delete("fillCanvas"),l.set(h,S.canvas)),{canvas:S.canvas,offsetX:Math.round(x),offsetY:Math.round(T)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=Nm[e]}setLineJoin(e){this.ctx.lineJoin=Bm[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx,this.ctx=i.context;const n=this.ctx;n.setTransform(...ut(this.suspendedCtx)),va(this.suspendedCtx,n),Dm(n,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),va(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const n=i[0],r=i[1],a=i[2]-n,l=i[3]-r;a===0||l===0||(this.genericComposeSMask(t.context,s,a,l,t.subtype,t.backdrop,t.transferMap,n,r,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,n,r,a,l,h,d,u){let f=e.canvas,p=l-d,m=h-u;if(r){if(p<0||m<0||p+s>f.width||m+i>f.height){const E=this.cachedCanvases.getCanvas("maskExtension",s,i),A=E.context;A.drawImage(f,-p,-m),r.some(w=>w!==0)&&(A.globalCompositeOperation="destination-atop",A.fillStyle=N.makeHexColor(...r),A.fillRect(0,0,s,i),A.globalCompositeOperation="source-over"),f=E.canvas,p=m=0}else if(r.some(E=>E!==0)){e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const E=new Path2D;E.rect(p,m,s,i),e.clip(E),e.globalCompositeOperation="destination-atop",e.fillStyle=N.makeHexColor(...r),e.fillRect(p,m,s,i),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),n==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):n==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));const v=new Path2D;v.rect(l,h,s,i),t.clip(v),t.globalCompositeOperation="destination-in",t.drawImage(f,p,m,s,i,l,h,s,i),t.restore()}save(){this.inSMaskMode?(va(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),va(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,s,i,n,r){this.ctx.transform(e,t,s,i,n,r),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){const i=this.ctx,n=this.current;let r=n.x,a=n.y,l,h;const d=ut(i),u=d[0]===0&&d[3]===0||d[1]===0&&d[2]===0,f=u?s.slice(0):null;for(let p=0,m=0,v=e.length;p<v;p++)switch(e[p]|0){case Ee.rectangle:r=t[m++],a=t[m++];const E=t[m++],A=t[m++],w=r+E,S=a+A;i.moveTo(r,a),E===0||A===0?i.lineTo(w,S):(i.lineTo(w,a),i.lineTo(w,S),i.lineTo(r,S)),u||n.updateRectMinMax(d,[r,a,w,S]),i.closePath();break;case Ee.moveTo:r=t[m++],a=t[m++],i.moveTo(r,a),u||n.updatePathMinMax(d,r,a);break;case Ee.lineTo:r=t[m++],a=t[m++],i.lineTo(r,a),u||n.updatePathMinMax(d,r,a);break;case Ee.curveTo:l=r,h=a,r=t[m+4],a=t[m+5],i.bezierCurveTo(t[m],t[m+1],t[m+2],t[m+3],r,a),n.updateCurvePathMinMax(d,l,h,t[m],t[m+1],t[m+2],t[m+3],r,a,f),m+=6;break;case Ee.curveTo2:l=r,h=a,i.bezierCurveTo(r,a,t[m],t[m+1],t[m+2],t[m+3]),n.updateCurvePathMinMax(d,l,h,r,a,t[m],t[m+1],t[m+2],t[m+3],f),r=t[m+2],a=t[m+3],m+=4;break;case Ee.curveTo3:l=r,h=a,r=t[m+2],a=t[m+3],i.bezierCurveTo(t[m],t[m+1],r,a,r,a),n.updateCurvePathMinMax(d,l,h,t[m],t[m+1],r,a,r,a,f),m+=4;break;case Ee.closePath:i.closePath();break}u&&n.updateScalingPathMinMax(d,f),n.setCurrentPoint(r,a)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,s=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&(s!=null&&s.getPattern)?(t.save(),t.strokeStyle=s.getPattern(t,this,is(t),Kt.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;let n=!1;i&&(t.save(),t.fillStyle=s.getPattern(t,this,is(t),Kt.FILL),n=!0);const r=this.current.getClippedPathBoundingBox();this.contentVisible&&r!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),n&&t.restore(),e&&this.consumePath(r)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Hm}eoClip(){this.pendingClip=zf}beginText(){this.current.textMatrix=Qf,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}t.save(),t.beginPath();for(const s of e)t.setTransform(...s.transform),t.translate(s.x,s.y),s.addToPath(t,s.fontSize);t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var d;const s=this.commonObjs.get(e),i=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=s.fontMatrix||qd,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&V("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const n=s.loadedName||"sans-serif",r=((d=s.systemFontInfo)==null?void 0:d.css)||`"${n}", ${s.fallbackName}`;let a="normal";s.black?a="900":s.bold&&(a="bold");const l=s.italic?"italic":"normal";let h=t;t<Ff?h=Ff:t>kf&&(h=kf),this.current.fontSizeScale=t/h,this.ctx.font=`${l} ${a} ${h}px ${r}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,s,i,n,r){this.current.textMatrix=[e,t,s,i,n,r],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,s,i){const n=this.ctx,r=this.current,a=r.font,l=r.textRenderingMode,h=r.fontSize/r.fontSizeScale,d=l&Ht.FILL_STROKE_MASK,u=!!(l&Ht.ADD_TO_PATH_FLAG),f=r.patternFill&&!a.missingFile;let p;(a.disableFontFace||u||f)&&(p=a.getPathGenerator(this.commonObjs,e)),a.disableFontFace||f?(n.save(),n.translate(t,s),n.beginPath(),p(n,h),i&&n.setTransform(...i),(d===Ht.FILL||d===Ht.FILL_STROKE)&&n.fill(),(d===Ht.STROKE||d===Ht.FILL_STROKE)&&n.stroke(),n.restore()):((d===Ht.FILL||d===Ht.FILL_STROKE)&&n.fillText(e,t,s),(d===Ht.STROKE||d===Ht.FILL_STROKE)&&n.strokeText(e,t,s)),u&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:ut(n),x:t,y:s,fontSize:h,addToPath:p})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return Z(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(i===0)return;const n=this.ctx,r=t.fontSizeScale,a=t.charSpacing,l=t.wordSpacing,h=t.fontDirection,d=t.textHScale*h,u=e.length,f=s.vertical,p=f?1:-1,m=s.defaultVMetrics,v=i*t.fontMatrix[0],E=t.textRenderingMode===Ht.FILL&&!s.disableFontFace&&!t.patternFill;n.save(),n.transform(...t.textMatrix),n.translate(t.x,t.y+t.textRise),h>0?n.scale(d,-1):n.scale(d,1);let A;if(t.patternFill){n.save();const T=t.fillColor.getPattern(n,this,is(n),Kt.FILL);A=ut(n),n.restore(),n.fillStyle=T}let w=t.lineWidth;const S=t.textMatrixScale;if(S===0||w===0){const T=t.textRenderingMode&Ht.FILL_STROKE_MASK;(T===Ht.STROKE||T===Ht.FILL_STROKE)&&(w=this.getSinglePixelWidth())}else w/=S;if(r!==1&&(n.scale(r,r),w/=r),n.lineWidth=w,s.isInvalidPDFjsFont){const T=[];let R=0;for(const I of e)T.push(I.unicode),R+=I.width;n.fillText(T.join(""),0,0),t.x+=R*v*d,n.restore(),this.compose();return}let C=0,x;for(x=0;x<u;++x){const T=e[x];if(typeof T=="number"){C+=p*T*i/1e3;continue}let R=!1;const I=(T.isSpace?l:0)+a,P=T.fontChar,O=T.accent;let L,W,H=T.width;if(f){const Y=T.vmetric||m,K=-(T.vmetric?Y[1]:H*.5)*v,F=Y[2]*v;H=Y?-Y[0]:H,L=K/r,W=(C+F)/r}else L=C/r,W=0;if(s.remeasure&&H>0){const Y=n.measureText(P).width*1e3/i*r;if(H<Y&&this.isFontSubpixelAAEnabled){const K=H/Y;R=!0,n.save(),n.scale(K,1),L/=K}else H!==Y&&(L+=(H-Y)/2e3*i/r)}if(this.contentVisible&&(T.isInFont||s.missingFile)){if(E&&!O)n.fillText(P,L,W);else if(this.paintChar(P,L,W,A),O){const Y=L+i*O.offset.x/r,K=W-i*O.offset.y/r;this.paintChar(O.fontChar,Y,K,A)}}const X=f?H*v-I*h:H*v+I*h;C+=X,R&&n.restore()}f?t.y-=C:t.x+=C*d,n.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,i=s.font,n=s.fontSize,r=s.fontDirection,a=i.vertical?1:-1,l=s.charSpacing,h=s.wordSpacing,d=s.textHScale*r,u=s.fontMatrix||qd,f=e.length,p=s.textRenderingMode===Ht.INVISIBLE;let m,v,E,A;if(!(p||n===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...s.textMatrix),t.translate(s.x,s.y),t.scale(d,r),m=0;m<f;++m){if(v=e[m],typeof v=="number"){A=a*v*n/1e3,this.ctx.translate(A,0),s.x+=A*d;continue}const w=(v.isSpace?h:0)+l,S=i.charProcOperatorList[v.operatorListId];if(!S){V(`Type3 character "${v.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=v,this.save(),t.scale(n,n),t.transform(...u),this.executeOperatorList(S),this.restore()),E=N.applyTransform([v.width,0],u)[0]*n+w,t.translate(E,0),s.x+=E*d}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,i,n,r){this.ctx.rect(s,i,n-s,r-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const s=e[1],i=this.baseTransform||ut(this.ctx),n={createCanvasGraphics:r=>new Rf(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new Pu(e,s,this.ctx,n,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,s){this.ctx.strokeStyle=this.current.strokeColor=N.makeHexColor(e,t,s)}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent"}setFillRGBColor(e,t,s){this.ctx.fillStyle=this.current.fillColor=N.makeHexColor(e,t,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=Lm(this.getObject(e)),this.cachedPatterns.set(e,s)),t&&(s.matrix=t),s}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,is(t),Kt.SHADING);const i=is(t);if(i){const{width:n,height:r}=t.canvas,[a,l,h,d]=N.getAxialAlignedBoundingBox([0,0,n,r],i);this.ctx.fillRect(a,l,h-a,d-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){nt("Should not call beginInlineImage")}beginImageData(){nt("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=ut(this.ctx),t)){const s=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],s,i),this.current.updateRectMinMax(ut(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||kd("TODO: Support non-isolated groups."),e.knockout&&V("Knockout groups not supported.");const s=ut(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=N.getAxialAlignedBoundingBox(e.bbox,ut(t));const n=[0,0,t.canvas.width,t.canvas.height];i=N.intersect(i,n)||[0,0,0,0];const r=Math.floor(i[0]),a=Math.floor(i[1]),l=Math.max(Math.ceil(i[2])-r,1),h=Math.max(Math.ceil(i[3])-a,1);this.current.startNewPathAndClipBox([0,0,l,h]);let d="groupAt"+this.groupLevel;e.smask&&(d+="_smask_"+this.smaskCounter++%2);const u=this.cachedCanvases.getCanvas(d,l,h),f=u.context;f.translate(-r,-a),f.transform(...s),e.smask?this.smaskStack.push({canvas:u.canvas,context:f,offsetX:r,offsetY:a,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(r,a),t.save()),va(t,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=ut(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const n=N.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(e,t,s,i,n){if(y(this,Lo,Iu).call(this),uh(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const r=t[2]-t[0],a=t[3]-t[1];if(n&&this.annotationCanvasMap){s=s.slice(),s[4]-=t[0],s[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=r,t[3]=a;const[l,h]=N.singularValueDecompose2dScale(ut(this.ctx)),{viewportScale:d}=this,u=Math.ceil(r*this.outputScaleX*d),f=Math.ceil(a*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(u,f);const{canvas:p,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(e,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(l,0,0,-h,0,a*h),uh(this.ctx)}else uh(this.ctx),this.ctx.rect(t[0],t[1],r,a),this.ctx.clip(),this.endPath()}this.current=new Hf(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),y(this,_o,Mu).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const s=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=km(e)),i.compiled)){i.compiled(s);return}const n=this._createMaskCanvas(e),r=n.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(r,n.offsetX,n.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s=0,i=0,n,r){if(!this.contentVisible)return;e=this.getObject(e.data,e);const a=this.ctx;a.save();const l=ut(a);a.transform(t,s,i,n,0,0);const h=this._createMaskCanvas(e);a.setTransform(1,0,0,1,h.offsetX-l[4],h.offsetY-l[5]);for(let d=0,u=r.length;d<u;d+=2){const f=N.transform(l,[t,s,i,n,r[d],r[d+1]]),[p,m]=N.applyTransform([0,0],f);a.drawImage(h.canvas,p,m)}a.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;for(const n of e){const{data:r,width:a,height:l,transform:h}=n,d=this.cachedCanvases.getCanvas("maskCanvas",a,l),u=d.context;u.save();const f=this.getObject(r,n);jf(u,f),u.globalCompositeOperation="source-in",u.fillStyle=i?s.getPattern(u,this,is(t),Kt.FILL):s,u.fillRect(0,0,a,l),u.restore(),t.save(),t.transform(...h),t.scale(1,-1),dh(t,d.canvas,0,0,a,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){V("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,s,i){if(!this.contentVisible)return;const n=this.getObject(e);if(!n){V("Dependent image isn't ready yet");return}const r=n.width,a=n.height,l=[];for(let h=0,d=i.length;h<d;h+=2)l.push({transform:[t,0,0,s,i[h],i[h+1]],x:0,y:0,w:r,h:a});this.paintInlineImageXObjectGroup(n,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,n=this.cachedCanvases.getCanvas("inlineImage",s,i),r=n.context;return r.filter=this.current.transferMaps,r.drawImage(t,0,0),r.filter="none",n.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,i=this.ctx;if(this.save(),!Vt){const{filter:a}=i;a!=="none"&&a!==""&&(i.filter="none")}i.scale(1/t,-1/s);let n;if(e.bitmap)n=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)n=e;else{const l=this.cachedCanvases.getCanvas("inlineImage",t,s).context;Uf(l,e),n=this.applyTransferMapsToCanvas(l)}const r=this._scaleImage(n,is(i));i.imageSmoothingEnabled=$f(ut(i),e.interpolate),dh(i,r.img,0,0,r.paintWidth,r.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const n=e.width,r=e.height,l=this.cachedCanvases.getCanvas("inlineImage",n,r).context;Uf(l,e),i=this.applyTransferMapsToCanvas(l)}for(const n of t)s.save(),s.transform(...n.transform),s.scale(1,-1),dh(s,i,n.x,n.y,n.w,n.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const s=this.ctx;this.pendingClip&&(t||(this.pendingClip===zf?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=ut(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:n}=this.ctx.getTransform();let r,a;if(s===0&&i===0){const l=Math.abs(t),h=Math.abs(n);if(l===h)if(e===0)r=a=1/l;else{const d=l*e;r=a=d<1?1/d:1}else if(e===0)r=1/l,a=1/h;else{const d=l*e,u=h*e;r=d<1?1/d:1,a=u<1?1/u:1}}else{const l=Math.abs(t*n-s*i),h=Math.hypot(t,s),d=Math.hypot(i,n);if(e===0)r=d/l,a=h/l;else{const u=e*l;r=d>u?d/u:1,a=h>u?h/u:1}}this._cachedScaleForStroking[0]=r,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:s}=this.current,[i,n]=this.getScaleForStroking();if(t.lineWidth=s||1,i===1&&n===1){t.stroke();return}const r=t.getLineDash();if(e&&t.save(),t.scale(i,n),r.length>0){const a=Math.max(i,n);t.setLineDash(r.map(l=>l/a)),t.lineDashOffset/=a}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Lo=new WeakSet,Iu=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},_o=new WeakSet,Mu=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}};let Jn=Rf;for(const c in Ee)Jn.prototype[c]!==void 0&&(Jn.prototype[Ee[c]]=Jn.prototype[c]);var Oo,Do;class ks{static get workerPort(){return o(this,Oo)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");b(this,Oo,e)}static get workerSrc(){return o(this,Do)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");b(this,Do,e)}}Oo=new WeakMap,Do=new WeakMap,g(ks,Oo,null),g(ks,Do,"");const fh={UNKNOWN:0,DATA:1,ERROR:2},yt={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function ie(c){switch(c instanceof Error||typeof c=="object"&&c!==null||nt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),c.name){case"AbortException":return new Un(c.message);case"MissingPDFException":return new Hn(c.message);case"PasswordException":return new eu(c.message,c.code);case"UnexpectedResponseException":return new Nd(c.message,c.status);case"UnknownErrorException":return new su(c.message,c.details);default:return new su(c.message,c.toString())}}var Ic,_p,Mc,Op,vr,wh;class Ta{constructor(e,t,s){g(this,Ic);g(this,Mc);g(this,vr);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=i=>{const n=i.data;if(n.targetName!==this.sourceName)return;if(n.stream){y(this,Mc,Op).call(this,n);return}if(n.callback){const a=n.callbackId,l=this.callbackCapabilities[a];if(!l)throw new Error(`Cannot resolve callback ${a}`);if(delete this.callbackCapabilities[a],n.callback===fh.DATA)l.resolve(n.data);else if(n.callback===fh.ERROR)l.reject(ie(n.reason));else throw new Error("Unexpected callback case");return}const r=this.actionHandler[n.action];if(!r)throw new Error(`Unknown action from worker: ${n.action}`);if(n.callbackId){const a=this.sourceName,l=n.sourceName;new Promise(function(h){h(r(n.data))}).then(function(h){s.postMessage({sourceName:a,targetName:l,callback:fh.DATA,callbackId:n.callbackId,data:h})},function(h){s.postMessage({sourceName:a,targetName:l,callback:fh.ERROR,callbackId:n.callbackId,reason:ie(h)})});return}if(n.streamId){y(this,Ic,_p).call(this,n);return}r(n.data)},s.addEventListener("message",this._onComObjOnMessage)}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,n=Promise.withResolvers();this.callbackCapabilities[i]=n;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(r){n.reject(r)}return n.promise}sendWithStream(e,t,s,i){const n=this.streamId++,r=this.sourceName,a=this.targetName,l=this.comObj;return new ReadableStream({start:h=>{const d=Promise.withResolvers();return this.streamControllers[n]={controller:h,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:r,targetName:a,action:e,streamId:n,data:t,desiredSize:h.desiredSize},i),d.promise},pull:h=>{const d=Promise.withResolvers();return this.streamControllers[n].pullCall=d,l.postMessage({sourceName:r,targetName:a,stream:yt.PULL,streamId:n,desiredSize:h.desiredSize}),d.promise},cancel:h=>{Tt(h instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[n].cancelCall=d,this.streamControllers[n].isClosed=!0,l.postMessage({sourceName:r,targetName:a,stream:yt.CANCEL,streamId:n,reason:ie(h)}),d.promise}},s)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}Ic=new WeakSet,_p=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,n=this.comObj,r=this,a=this.actionHandler[e.action],l={enqueue(h,d=1,u){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=d,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),n.postMessage({sourceName:s,targetName:i,stream:yt.ENQUEUE,streamId:t,chunk:h},u)},close(){this.isCancelled||(this.isCancelled=!0,n.postMessage({sourceName:s,targetName:i,stream:yt.CLOSE,streamId:t}),delete r.streamSinks[t])},error(h){Tt(h instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,n.postMessage({sourceName:s,targetName:i,stream:yt.ERROR,streamId:t,reason:ie(h)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,new Promise(function(h){h(a(e.data,l))}).then(function(){n.postMessage({sourceName:s,targetName:i,stream:yt.START_COMPLETE,streamId:t,success:!0})},function(h){n.postMessage({sourceName:s,targetName:i,stream:yt.START_COMPLETE,streamId:t,reason:ie(h)})})},Mc=new WeakSet,Op=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,n=this.comObj,r=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case yt.START_COMPLETE:e.success?r.startCall.resolve():r.startCall.reject(ie(e.reason));break;case yt.PULL_COMPLETE:e.success?r.pullCall.resolve():r.pullCall.reject(ie(e.reason));break;case yt.PULL:if(!a){n.postMessage({sourceName:s,targetName:i,stream:yt.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,new Promise(function(l){var h;l((h=a.onPull)==null?void 0:h.call(a))}).then(function(){n.postMessage({sourceName:s,targetName:i,stream:yt.PULL_COMPLETE,streamId:t,success:!0})},function(l){n.postMessage({sourceName:s,targetName:i,stream:yt.PULL_COMPLETE,streamId:t,reason:ie(l)})});break;case yt.ENQUEUE:if(Tt(r,"enqueue should have stream controller"),r.isClosed)break;r.controller.enqueue(e.chunk);break;case yt.CLOSE:if(Tt(r,"close should have stream controller"),r.isClosed)break;r.isClosed=!0,r.controller.close(),y(this,vr,wh).call(this,r,t);break;case yt.ERROR:Tt(r,"error should have stream controller"),r.controller.error(ie(e.reason)),y(this,vr,wh).call(this,r,t);break;case yt.CANCEL_COMPLETE:e.success?r.cancelCall.resolve():r.cancelCall.reject(ie(e.reason)),y(this,vr,wh).call(this,r,t);break;case yt.CANCEL:if(!a)break;new Promise(function(l){var h;l((h=a.onCancel)==null?void 0:h.call(a,ie(e.reason)))}).then(function(){n.postMessage({sourceName:s,targetName:i,stream:yt.CANCEL_COMPLETE,streamId:t,success:!0})},function(l){n.postMessage({sourceName:s,targetName:i,stream:yt.CANCEL_COMPLETE,streamId:t,reason:ie(l)})}),a.sinkCapability.reject(ie(e.reason)),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},vr=new WeakSet,wh=async function(e,t){var s,i,n;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(i=e.pullCall)==null?void 0:i.promise,(n=e.cancelCall)==null?void 0:n.promise]),delete this.streamControllers[t]};var Ki,Fo;class Um{constructor({parsedData:e,rawData:t}){g(this,Ki,void 0);g(this,Fo,void 0);b(this,Ki,e),b(this,Fo,t)}getRaw(){return o(this,Fo)}get(e){return o(this,Ki).get(e)??null}getAll(){return mf(o(this,Ki))}has(e){return o(this,Ki).has(e)}}Ki=new WeakMap,Fo=new WeakMap;const Us=Symbol("INTERNAL");var ko,No,Bo,br;class jm{constructor(e,{name:t,intent:s,usage:i}){g(this,ko,!1);g(this,No,!1);g(this,Bo,!1);g(this,br,!0);b(this,ko,!!(e&fe.DISPLAY)),b(this,No,!!(e&fe.PRINT)),this.name=t,this.intent=s,this.usage=i}get visible(){if(o(this,Bo))return o(this,br);if(!o(this,br))return!1;const{print:e,view:t}=this.usage;return o(this,ko)?(t==null?void 0:t.viewState)!=="OFF":o(this,No)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==Us&&nt("Internal method `_setVisible` called."),b(this,Bo,s),b(this,br,t)}}ko=new WeakMap,No=new WeakMap,Bo=new WeakMap,br=new WeakMap;var Zs,it,yr,Ar,Ho,Lu;class $m{constructor(e,t=fe.DISPLAY){g(this,Ho);g(this,Zs,null);g(this,it,new Map);g(this,yr,null);g(this,Ar,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,b(this,Ar,e.order);for(const s of e.groups)o(this,it).set(s.id,new jm(t,s));if(e.baseState==="OFF")for(const s of o(this,it).values())s._setVisible(Us,!1);for(const s of e.on)o(this,it).get(s)._setVisible(Us,!0);for(const s of e.off)o(this,it).get(s)._setVisible(Us,!1);b(this,yr,this.getHash())}}isVisible(e){if(o(this,it).size===0)return!0;if(!e)return kd("Optional content group not defined."),!0;if(e.type==="OCG")return o(this,it).has(e.id)?o(this,it).get(e.id).visible:(V(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return y(this,Ho,Lu).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!o(this,it).has(t))return V(`Optional content group not found: ${t}`),!0;if(o(this,it).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!o(this,it).has(t))return V(`Optional content group not found: ${t}`),!0;if(!o(this,it).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!o(this,it).has(t))return V(`Optional content group not found: ${t}`),!0;if(!o(this,it).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!o(this,it).has(t))return V(`Optional content group not found: ${t}`),!0;if(o(this,it).get(t).visible)return!1}return!0}return V(`Unknown optional content policy ${e.policy}.`),!0}return V(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0){const s=o(this,it).get(e);if(!s){V(`Optional content group not found: ${e}`);return}s._setVisible(Us,!!t,!0),b(this,Zs,null)}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const n=o(this,it).get(i);if(n)switch(s){case"ON":n._setVisible(Us,!0);break;case"OFF":n._setVisible(Us,!1);break;case"Toggle":n._setVisible(Us,!n.visible);break}}b(this,Zs,null)}get hasInitialVisibility(){return o(this,yr)===null||this.getHash()===o(this,yr)}getOrder(){return o(this,it).size?o(this,Ar)?o(this,Ar).slice():[...o(this,it).keys()]:null}getGroups(){return o(this,it).size>0?mf(o(this,it)):null}getGroup(e){return o(this,it).get(e)||null}getHash(){if(o(this,Zs)!==null)return o(this,Zs);const e=new Pp;for(const[t,s]of o(this,it))e.update(`${t}:${s.visible}`);return b(this,Zs,e.hexdigest())}}Zs=new WeakMap,it=new WeakMap,yr=new WeakMap,Ar=new WeakMap,Ho=new WeakSet,Lu=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const n=e[i];let r;if(Array.isArray(n))r=y(this,Ho,Lu).call(this,n);else if(o(this,it).has(n))r=o(this,it).get(n).visible;else return V(`Optional content group not found: ${n}`),!0;switch(s){case"And":if(!r)return!1;break;case"Or":if(r)return!0;break;case"Not":return!r;default:return!0}}return s==="And"};class zm{constructor(e,{disableRange:t=!1,disableStream:s=!1}){Tt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:n,progressiveDone:r,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=r,this._contentDispositionFilename=a,(n==null?void 0:n.length)>0){const l=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,h)=>{this._onReceiveData({begin:l,chunk:h})}),e.addProgressListener((l,h)=>{this._onProgress({loaded:l,total:h})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const i=this._rangeReaders.some(function(n){return n._begin!==e?!1:(n._enqueue(s),!0)});Tt(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,i,n;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(n=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||n.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Tt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new Gm(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new Vm(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class Gm{constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=Af(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const n of this._queuedChunks)this._loaded+=n.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Vm{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Wm(c){let e=!0,t=s("filename\\*","i").exec(c);if(t){t=t[1];let d=a(t);return d=unescape(d),d=l(d),d=h(d),n(d)}if(t=r(c),t){const d=h(t);return n(d)}if(t=s("filename","i").exec(c),t){t=t[1];let d=a(t);return d=h(d),n(d)}function s(d,u){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',u)}function i(d,u){if(d){if(!/^[\x00-\xFF]+$/.test(u))return u;try{const f=new TextDecoder(d,{fatal:!0}),p=Bd(u);u=f.decode(p),e=!1}catch{}}return u}function n(d){return e&&/[\x80-\xff]/.test(d)&&(d=i("utf-8",d),e&&(d=i("iso-8859-1",d))),d}function r(d){const u=[];let f;const p=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=p.exec(d))!==null;){let[,v,E,A]=f;if(v=parseInt(v,10),v in u){if(v===0)break;continue}u[v]=[E,A]}const m=[];for(let v=0;v<u.length&&v in u;++v){let[E,A]=u[v];A=a(A),E&&(A=unescape(A),v===0&&(A=l(A))),m.push(A)}return m.join("")}function a(d){if(d.startsWith('"')){const u=d.slice(1).split('\\"');for(let f=0;f<u.length;++f){const p=u[f].indexOf('"');p!==-1&&(u[f]=u[f].slice(0,p),u.length=f+1),u[f]=u[f].replaceAll(/\\(.)/g,"$1")}d=u.join('"')}return d}function l(d){const u=d.indexOf("'");if(u===-1)return d;const f=d.slice(0,u),m=d.slice(u+1).replace(/^[^']*'/,"");return i(f,m)}function h(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(u,f,p,m){if(p==="q"||p==="Q")return m=m.replaceAll("_"," "),m=m.replaceAll(/=([0-9a-fA-F]{2})/g,function(v,E){return String.fromCharCode(parseInt(E,16))}),i(f,m);try{m=atob(m)}catch{}return i(f,m)})}return""}function Sf({getResponseHeader:c,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},n=parseInt(c("Content-Length"),10);return!Number.isInteger(n)||(i.suggestedLength=n,n<=2*t)||s||!e||c("Accept-Ranges")!=="bytes"||(c("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function xf(c){const e=c("Content-Disposition");if(e){let t=Wm(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Af(t))return t}return null}function Gd(c,e){return c===404||c===0&&e.startsWith("file:")?new Hn('Missing PDF "'+e+'".'):new Nd(`Unexpected server response (${c}) while retrieving PDF "${e}".`,c)}function Dp(c){return c===200||c===206}function Fp(c,e,t){return{method:"GET",headers:c,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function kp(c){const e=new Headers;for(const t in c){const s=c[t];s!==void 0&&e.append(t,s)}return e}function Np(c){return c instanceof Uint8Array?c.buffer:c instanceof ArrayBuffer?c:(V(`getArrayBuffer - unexpected data format: ${c}`),new Uint8Array(c).buffer)}class Gf{constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Tt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Xm(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new Ym(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class Xm{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._headers=kp(this._stream.httpHeaders);const s=t.url;fetch(s,Fp(this._headers,this._withCredentials,this._abortController)).then(i=>{if(!Dp(i.status))throw Gd(i.status,s);this._reader=i.body.getReader(),this._headersCapability.resolve();const n=l=>i.headers.get(l),{allowRangeRequests:r,suggestedLength:a}=Sf({getResponseHeader:n,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=r,this._contentLength=a||this._contentLength,this._filename=xf(n),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Un("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Np(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class Ym{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController,this._headers=kp(this._stream.httpHeaders),this._headers.append("Range",`bytes=${t}-${s-1}`);const n=i.url;fetch(n,Fp(this._headers,this._withCredentials,this._abortController)).then(r=>{if(!Dp(r.status))throw Gd(r.status,n);this._readCapability.resolve(),this._reader=r.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:Np(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const Jd=200,Zd=206;function Km(c){const e=c.response;return typeof e!="string"?e:Bd(e).buffer}class Qm{constructor(e,t={}){this.url=e,this.isHttp=/^https?:/i.test(e),this.httpHeaders=this.isHttp&&t.httpHeaders||Object.create(null),this.withCredentials=t.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,s){const i={begin:e,end:t};for(const n in s)i[n]=s[n];return this.request(i)}requestFull(e){return this.request(e)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const n in this.httpHeaders){const r=this.httpHeaders[n];r!==void 0&&t.setRequestHeader(n,r)}return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=Zd):i.expectedStatus=Jd,t.responseType="arraybuffer",e.onError&&(t.onerror=function(n){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var i;const s=this.pendingRequests[e];s&&((i=s.onProgress)==null||i.call(s,t))}onStateChange(e,t){var l,h,d;const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){(l=s.onError)==null||l.call(s,i.status);return}const n=i.status||Jd;if(!(n===Jd&&s.expectedStatus===Zd)&&n!==s.expectedStatus){(h=s.onError)==null||h.call(s,i.status);return}const a=Km(i);if(n===Zd){const u=i.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(u);s.onDone({begin:parseInt(f[1],10),chunk:a})}else a?s.onDone({begin:0,chunk:a}):(d=s.onError)==null||d.call(s,i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class Jm{constructor(e){this._source=e,this._manager=new Qm(e.url,{httpHeaders:e.httpHeaders,withCredentials:e.withCredentials}),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Tt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Zm(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new qm(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class Zm{constructor(e,t){this._manager=e;const s={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(s),this._headersReceivedCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e),s=r=>t.getResponseHeader(r),{allowRangeRequests:i,suggestedLength:n}=Sf({getResponseHeader:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=n||this._contentLength,this._filename=xf(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersReceivedCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Gd(e,this._url),this._headersReceivedCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersReceivedCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class qm{constructor(e,t,s){this._manager=e;const i={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._requestId=e.requestRange(t,s,i),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError=Gd(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Bp=/^file:\/\/\/[a-zA-Z]:\//;function tv(c){const e=es.get("url"),t=e.parse(c);return t.protocol==="file:"||t.host?t:/^[a-z]:[/\\]/i.test(c)?e.parse(`file:///${c}`):(t.host||(t.protocol="file:"),t)}class ev{constructor(e){this.source=e,this.url=tv(e.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Tt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new nv(this):new sv(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=this.isFsUrl?new rv(this,e,t):new iv(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class Hp{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Un("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Up{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const t=e.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function Vh(c,e){return{protocol:c.protocol,auth:c.auth,host:c.hostname,port:c.port,path:c.path,method:"GET",headers:e}}class sv extends Hp{constructor(e){super(e);const t=s=>{if(s.statusCode===404){const a=new Hn(`Missing PDF "${this._url}".`);this._storedError=a,this._headersCapability.reject(a);return}this._headersCapability.resolve(),this._setReadableStream(s);const i=a=>this._readableStream.headers[a.toLowerCase()],{allowRangeRequests:n,suggestedLength:r}=Sf({getResponseHeader:i,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=n,this._contentLength=r||this._contentLength,this._filename=xf(i)};if(this._request=null,this._url.protocol==="http:"){const s=es.get("http");this._request=s.request(Vh(this._url,e.httpHeaders),t)}else{const s=es.get("https");this._request=s.request(Vh(this._url,e.httpHeaders),t)}this._request.on("error",s=>{this._storedError=s,this._headersCapability.reject(s)}),this._request.end()}}class iv extends Up{constructor(e,t,s){super(e),this._httpHeaders={};for(const n in e.httpHeaders){const r=e.httpHeaders[n];r!==void 0&&(this._httpHeaders[n]=r)}this._httpHeaders.Range=`bytes=${t}-${s-1}`;const i=n=>{if(n.statusCode===404){const r=new Hn(`Missing PDF "${this._url}".`);this._storedError=r;return}this._setReadableStream(n)};if(this._request=null,this._url.protocol==="http:"){const n=es.get("http");this._request=n.request(Vh(this._url,this._httpHeaders),i)}else{const n=es.get("https");this._request=n.request(Vh(this._url,this._httpHeaders),i)}this._request.on("error",n=>{this._storedError=n}),this._request.end()}}class nv extends Hp{constructor(e){super(e);let t=decodeURIComponent(this._url.path);Bp.test(this._url.href)&&(t=t.replace(/^\//,""));const s=es.get("fs");s.promises.lstat(t).then(i=>{this._contentLength=i.size,this._setReadableStream(s.createReadStream(t)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=new Hn(`Missing PDF "${t}".`)),this._storedError=i,this._headersCapability.reject(i)})}}class rv extends Up{constructor(e,t,s){super(e);let i=decodeURIComponent(this._url.path);Bp.test(this._url.href)&&(i=i.replace(/^\//,""));const n=es.get("fs");this._setReadableStream(n.createReadStream(i,{start:t,end:s-1}))}}const av=1e5,Jt=30,ov=.8;var Kf,qs,Zt,Uo,jo,Qi,vs,$o,zo,Ji,Er,wr,ti,Sr,Go,xr,Zi,Vo,Wo,qi,tn,ei,Tr,Lc,jp,_c,$p,Xo,_u,Cr,Sh,Oc,zp,Dc,Gp;const Rt=class Rt{constructor({textContentSource:e,container:t,viewport:s}){g(this,Lc);g(this,_c);g(this,Xo);g(this,qs,Promise.withResolvers());g(this,Zt,null);g(this,Uo,!1);g(this,jo,!!((Kf=globalThis.FontInspector)!=null&&Kf.enabled));g(this,Qi,null);g(this,vs,null);g(this,$o,0);g(this,zo,0);g(this,Ji,null);g(this,Er,null);g(this,wr,0);g(this,ti,0);g(this,Sr,Object.create(null));g(this,Go,[]);g(this,xr,null);g(this,Zi,[]);g(this,Vo,new WeakMap);g(this,Wo,null);var l;if(e instanceof ReadableStream)b(this,xr,e);else if(typeof e=="object")b(this,xr,new ReadableStream({start(h){h.enqueue(e),h.close()}}));else throw new Error('No "textContentSource" parameter specified.');b(this,Zt,b(this,Er,t)),b(this,ti,s.scale*(globalThis.devicePixelRatio||1)),b(this,wr,s.rotation),b(this,vs,{prevFontSize:null,prevFontFamily:null,div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:n,pageX:r,pageY:a}=s.rawDims;b(this,Wo,[1,0,0,-1,-r,a+n]),b(this,zo,i),b(this,$o,n),y(l=Rt,Oc,zp).call(l),kn(t,s),o(this,qs).promise.catch(()=>{}).then(()=>{o(Rt,Tr).delete(this),b(this,vs,null),b(this,Sr,null)})}render(){const e=()=>{o(this,Ji).read().then(({value:t,done:s})=>{if(s){o(this,qs).resolve();return}o(this,Qi)??b(this,Qi,t.lang),Object.assign(o(this,Sr),t.styles),y(this,Lc,jp).call(this,t.items),e()},o(this,qs).reject)};return b(this,Ji,o(this,xr).getReader()),o(Rt,Tr).add(this),e(),o(this,qs).promise}update({viewport:e,onBefore:t=null}){var n;const s=e.scale*(globalThis.devicePixelRatio||1),i=e.rotation;if(i!==o(this,wr)&&(t==null||t(),b(this,wr,i),kn(o(this,Er),{rotation:i})),s!==o(this,ti)){t==null||t(),b(this,ti,s);const r={prevFontSize:null,prevFontFamily:null,div:null,properties:null,ctx:y(n=Rt,Cr,Sh).call(n,o(this,Qi))};for(const a of o(this,Zi))r.properties=o(this,Vo).get(a),r.div=a,y(this,Xo,_u).call(this,r)}}cancel(){var t;const e=new Un("TextLayer task cancelled.");(t=o(this,Ji))==null||t.cancel(e).catch(()=>{}),b(this,Ji,null),o(this,qs).reject(e)}get textDivs(){return o(this,Zi)}get textContentItemsStr(){return o(this,Go)}static cleanup(){if(!(o(this,Tr).size>0)){o(this,qi).clear();for(const{canvas:e}of o(this,tn).values())e.remove();o(this,tn).clear()}}};qs=new WeakMap,Zt=new WeakMap,Uo=new WeakMap,jo=new WeakMap,Qi=new WeakMap,vs=new WeakMap,$o=new WeakMap,zo=new WeakMap,Ji=new WeakMap,Er=new WeakMap,wr=new WeakMap,ti=new WeakMap,Sr=new WeakMap,Go=new WeakMap,xr=new WeakMap,Zi=new WeakMap,Vo=new WeakMap,Wo=new WeakMap,qi=new WeakMap,tn=new WeakMap,ei=new WeakMap,Tr=new WeakMap,Lc=new WeakSet,jp=function(e){var i,n;if(o(this,Uo))return;(n=o(this,vs)).ctx??(n.ctx=y(i=Rt,Cr,Sh).call(i,o(this,Qi)));const t=o(this,Zi),s=o(this,Go);for(const r of e){if(t.length>av){V("Ignoring additional textDivs for performance reasons."),b(this,Uo,!0);return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const a=o(this,Zt);b(this,Zt,document.createElement("span")),o(this,Zt).classList.add("markedContent"),r.id!==null&&o(this,Zt).setAttribute("id",`${r.id}`),a.append(o(this,Zt))}else r.type==="endMarkedContent"&&b(this,Zt,o(this,Zt).parentNode);continue}s.push(r.str),y(this,_c,$p).call(this,r)}},_c=new WeakSet,$p=function(e){var v;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};o(this,Zi).push(t);const i=N.transform(o(this,Wo),e.transform);let n=Math.atan2(i[1],i[0]);const r=o(this,Sr)[e.fontName];r.vertical&&(n+=Math.PI/2);const a=o(this,jo)&&r.fontSubstitution||r.fontFamily,l=Math.hypot(i[2],i[3]),h=l*y(v=Rt,Dc,Gp).call(v,a,o(this,Qi));let d,u;n===0?(d=i[4],u=i[5]-h):(d=i[4]+h*Math.sin(n),u=i[5]-h*Math.cos(n));const f="calc(var(--scale-factor)*",p=t.style;o(this,Zt)===o(this,Er)?(p.left=`${(100*d/o(this,zo)).toFixed(2)}%`,p.top=`${(100*u/o(this,$o)).toFixed(2)}%`):(p.left=`${f}${d.toFixed(2)}px)`,p.top=`${f}${u.toFixed(2)}px)`),p.fontSize=`${f}${(o(Rt,ei)*l).toFixed(2)}px)`,p.fontFamily=a,s.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,o(this,jo)&&(t.dataset.fontName=r.fontSubstitutionLoadedName||e.fontName),n!==0&&(s.angle=n*(180/Math.PI));let m=!1;if(e.str.length>1)m=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const E=Math.abs(e.transform[0]),A=Math.abs(e.transform[3]);E!==A&&Math.max(E,A)/Math.min(E,A)>1.5&&(m=!0)}if(m&&(s.canvasWidth=r.vertical?e.height:e.width),o(this,Vo).set(t,s),o(this,vs).div=t,o(this,vs).properties=s,y(this,Xo,_u).call(this,o(this,vs)),s.hasText&&o(this,Zt).append(t),s.hasEOL){const E=document.createElement("br");E.setAttribute("role","presentation"),o(this,Zt).append(E)}},Xo=new WeakSet,_u=function(e){const{div:t,properties:s,ctx:i,prevFontSize:n,prevFontFamily:r}=e,{style:a}=t;let l="";if(o(Rt,ei)>1&&(l=`scale(${1/o(Rt,ei)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:h}=a,{canvasWidth:d,fontSize:u}=s;(n!==u||r!==h)&&(i.font=`${u*o(this,ti)}px ${h}`,e.prevFontSize=u,e.prevFontFamily=h);const{width:f}=i.measureText(t.textContent);f>0&&(l=`scaleX(${d*o(this,ti)/f}) ${l}`)}s.angle!==0&&(l=`rotate(${s.angle}deg) ${l}`),l.length>0&&(a.transform=l)},Cr=new WeakSet,Sh=function(e=null){let t=o(this,tn).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),o(this,tn).set(e,t)}return t},Oc=new WeakSet,zp=function(){if(o(this,ei)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),b(this,ei,e.getBoundingClientRect().height),e.remove()},Dc=new WeakSet,Gp=function(e,t){const s=o(this,qi).get(e);if(s)return s;const i=y(this,Cr,Sh).call(this,t),n=i.font;i.canvas.width=i.canvas.height=Jt,i.font=`${Jt}px ${e}`;const r=i.measureText("");let a=r.fontBoundingBoxAscent,l=Math.abs(r.fontBoundingBoxDescent);if(a){const u=a/(a+l);return o(this,qi).set(e,u),i.canvas.width=i.canvas.height=0,i.font=n,u}i.strokeStyle="red",i.clearRect(0,0,Jt,Jt),i.strokeText("g",0,0);let h=i.getImageData(0,0,Jt,Jt).data;l=0;for(let u=h.length-1-3;u>=0;u-=4)if(h[u]>0){l=Math.ceil(u/4/Jt);break}i.clearRect(0,0,Jt,Jt),i.strokeText("A",0,Jt),h=i.getImageData(0,0,Jt,Jt).data,a=0;for(let u=0,f=h.length;u<f;u+=4)if(h[u]>0){a=Jt-Math.floor(u/4/Jt);break}i.canvas.width=i.canvas.height=0,i.font=n;const d=a?a/(a+l):ov;return o(this,qi).set(e,d),d},g(Rt,Cr),g(Rt,Oc),g(Rt,Dc),g(Rt,qi,new Map),g(Rt,tn,new Map),g(Rt,ei,null),g(Rt,Tr,new Set);let ka=Rt;class Na{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function i(n){var l;if(!n)return;let r=null;const a=n.name;if(a==="#text")r=n.value;else if(Na.shouldBuildText(a))(l=n==null?void 0:n.attributes)!=null&&l.textContent?r=n.attributes.textContent:n.value&&(r=n.value);else return;if(r!==null&&t.push({str:r}),!!n.children)for(const h of n.children)i(h)}return i(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const lv=65536,hv=100,cv=5e3,dv=Vt?xm:dm,uv=Vt?Tm:ep,fv=Vt?Sm:cm,pv=Vt?Cm:sp;function gv(c={}){typeof c=="string"||c instanceof URL?c={url:c}:(c instanceof ArrayBuffer||ArrayBuffer.isView(c))&&(c={data:c});const e=new Ou,{docId:t}=e,s=c.url?mv(c.url):null,i=c.data?vv(c.data):null,n=c.httpHeaders||null,r=c.withCredentials===!0,a=c.password??null,l=c.range instanceof Vp?c.range:null,h=Number.isInteger(c.rangeChunkSize)&&c.rangeChunkSize>0?c.rangeChunkSize:lv;let d=c.worker instanceof Zn?c.worker:null;const u=c.verbosity,f=typeof c.docBaseUrl=="string"&&!zd(c.docBaseUrl)?c.docBaseUrl:null,p=typeof c.cMapUrl=="string"?c.cMapUrl:null,m=c.cMapPacked!==!1,v=c.CMapReaderFactory||uv,E=typeof c.standardFontDataUrl=="string"?c.standardFontDataUrl:null,A=c.StandardFontDataFactory||pv,w=c.stopAtErrors!==!0,S=Number.isInteger(c.maxImageSize)&&c.maxImageSize>-1?c.maxImageSize:-1,C=c.isEvalSupported!==!1,x=typeof c.isOffscreenCanvasSupported=="boolean"?c.isOffscreenCanvasSupported:!Vt,T=Number.isInteger(c.canvasMaxAreaInBytes)?c.canvasMaxAreaInBytes:-1,R=typeof c.disableFontFace=="boolean"?c.disableFontFace:Vt,I=c.fontExtraProperties===!0,P=c.enableXfa===!0,O=c.ownerDocument||globalThis.document,L=c.disableRange===!0,W=c.disableStream===!0,H=c.disableAutoFetch===!0,X=c.pdfBug===!0,Y=c.enableHWA===!0,K=l?l.length:c.length??NaN,F=typeof c.useSystemFonts=="boolean"?c.useSystemFonts:!Vt&&!R,k=typeof c.useWorkerFetch=="boolean"?c.useWorkerFetch:v===ep&&A===sp&&p&&E&&wa(p,document.baseURI)&&wa(E,document.baseURI),lt=c.canvasFactory||new dv({ownerDocument:O,enableHWA:Y}),bt=c.filterFactory||new fv({docId:t,ownerDocument:O}),Qt=null;qg(u);const rt={canvasFactory:lt,filterFactory:bt};if(k||(rt.cMapReaderFactory=new v({baseUrl:p,isCompressed:m}),rt.standardFontDataFactory=new A({baseUrl:E})),!d){const pe={verbosity:u,port:ks.workerPort};d=pe.port?Zn.fromPort(pe):new Zn(pe),e._worker=d}const ht={docId:t,apiVersion:"4.5.136",data:i,password:a,disableAutoFetch:H,rangeChunkSize:h,length:K,docBaseUrl:f,enableXfa:P,evaluatorOptions:{maxImageSize:S,disableFontFace:R,ignoreErrors:w,isEvalSupported:C,isOffscreenCanvasSupported:x,canvasMaxAreaInBytes:T,fontExtraProperties:I,useSystemFonts:F,cMapUrl:k?p:null,standardFontDataUrl:k?E:null}},Bs={disableFontFace:R,fontExtraProperties:I,ownerDocument:O,pdfBug:X,styleElement:Qt,loadingParams:{disableAutoFetch:H,enableXfa:P}};return d.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const pe=d.messageHandler.sendWithPromise("GetDocRequest",ht,i?[i.buffer]:null);let D;if(l)D=new zm(l,{disableRange:L,disableStream:W});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");D=(_=>Vt?function(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype}()&&wa(_.url)?new Gf(_):new ev(_):wa(_.url)?new Gf(_):new Jm(_))({url:s,length:K,httpHeaders:n,withCredentials:r,rangeChunkSize:h,disableRange:L,disableStream:W})}return pe.then(M=>{if(e.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const _=new Ta(t,M,d.port),G=new Ev(_,e,D,Bs,rt);e._transport=G,_.send("Ready",null)})}).catch(e._capability.reject),e}function mv(c){if(c instanceof URL)return c.href;try{return new URL(c,window.location).href}catch{if(Vt&&typeof c=="string")return c}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function vv(c){if(Vt&&typeof Buffer<"u"&&c instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(c instanceof Uint8Array&&c.byteLength===c.buffer.byteLength)return c;if(typeof c=="string")return Bd(c);if(c instanceof ArrayBuffer||ArrayBuffer.isView(c)||typeof c=="object"&&!isNaN(c==null?void 0:c.length))return new Uint8Array(c);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Vf(c){return typeof c=="object"&&Number.isInteger(c==null?void 0:c.num)&&c.num>=0&&Number.isInteger(c==null?void 0:c.gen)&&c.gen>=0}var Fc;const kc=class kc{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${se(kc,Fc)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,s;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(i){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,i}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};Fc=new WeakMap,g(kc,Fc,0);let Ou=kc;class Vp{constructor(e,t,s=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const s of this._rangeListeners)s(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){nt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class bv{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Z(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var si,bs,ii,Xn,Rr,xh;class yv{constructor(e,t,s,i=!1){g(this,ii);g(this,Rr);g(this,si,null);g(this,bs,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new Lf:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new Wp,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:n=!1}={}){return new ah({viewBox:this.view,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:n})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Z(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:s="display",annotationMode:i=$s.ENABLE,transform:n=null,background:r=null,optionalContentConfigPromise:a=null,annotationCanvasMap:l=null,pageColors:h=null,printAnnotationStorage:d=null,isEditing:u=!1}){var C,x;(C=this._stats)==null||C.time("Overall");const f=this._transport.getRenderingIntent(s,i,d,u),{renderingIntent:p,cacheKey:m}=f;b(this,bs,!1),y(this,Rr,xh).call(this),a||(a=this._transport.getOptionalContentConfig(p));let v=this._intentStates.get(m);v||(v=Object.create(null),this._intentStates.set(m,v)),v.streamReaderCancelTimeout&&(clearTimeout(v.streamReaderCancelTimeout),v.streamReaderCancelTimeout=null);const E=!!(p&fe.PRINT);v.displayReadyCapability||(v.displayReadyCapability=Promise.withResolvers(),v.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(x=this._stats)==null||x.time("Page Request"),this._pumpOperatorList(f));const A=T=>{var R;v.renderTasks.delete(w),(this._maybeCleanupAfterRender||E)&&b(this,bs,!0),y(this,ii,Xn).call(this,!E),T?(w.capability.reject(T),this._abortOperatorList({intentState:v,reason:T instanceof Error?T:new Error(T)})):w.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(R=globalThis.Stats)!=null&&R.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},w=new Fu({callback:A,params:{canvasContext:e,viewport:t,transform:n,background:r},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:v.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!E,pdfBug:this._pdfBug,pageColors:h});(v.renderTasks||(v.renderTasks=new Set)).add(w);const S=w.task;return Promise.all([v.displayReadyCapability.promise,a]).then(([T,R])=>{var I;if(this.destroyed){A();return}if((I=this._stats)==null||I.time("Rendering"),!(R.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");w.initializeGraphics({transparency:T,optionalContentConfig:R}),w.operatorListChanged()}).catch(A),S}getOperatorList({intent:e="display",annotationMode:t=$s.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){var h;function n(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(l))}const r=this._transport.getRenderingIntent(e,t,s,i,!0);let a=this._intentStates.get(r.cacheKey);a||(a=Object.create(null),this._intentStates.set(r.cacheKey,a));let l;return a.opListReadCapability||(l=Object.create(null),l.operatorListChanged=n,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(l),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(h=this._stats)==null||h.time("Page Request"),this._pumpOperatorList(r)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Na.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){function n(){r.read().then(function({value:l,done:h}){if(h){s(a);return}a.lang??(a.lang=l.lang),Object.assign(a.styles,l.styles),a.items.push(...l.items),n()},i)}const r=t.getReader(),a={items:[],styles:Object.create(null),lang:null};n()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),b(this,bs,!1),y(this,Rr,xh).call(this),Promise.all(e)}cleanup(e=!1){b(this,bs,!0);const t=y(this,ii,Xn).call(this,!1);return e&&t&&this._stats&&(this._stats=new Lf),t}_startRenderPage(e,t){var i,n;const s=this._intentStates.get(t);s&&((i=this._stats)==null||i.timeEnd("Page Request"),(n=s.displayReadyCapability)==null||n.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&y(this,ii,Xn).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:n,transfer:r}=s,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:n,modifiedIds:i},r).getReader(),h=this._intentStates.get(t);h.streamReader=l;const d=()=>{l.read().then(({value:u,done:f})=>{if(f){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(u,h),d())},u=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const f of h.renderTasks)f.operatorListChanged();y(this,ii,Xn).call(this,!0)}if(h.displayReadyCapability)h.displayReadyCapability.reject(u);else if(h.opListReadCapability)h.opListReadCapability.reject(u);else throw u}})};d()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof yf){let i=hv;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Un(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,n]of this._intentStates)if(n===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}si=new WeakMap,bs=new WeakMap,ii=new WeakSet,Xn=function(e=!1){if(y(this,Rr,xh).call(this),!o(this,bs)||this.destroyed)return!1;if(e)return b(this,si,setTimeout(()=>{b(this,si,null),y(this,ii,Xn).call(this,!1)},cv)),!1;for(const{renderTasks:t,operatorList:s}of this._intentStates.values())if(t.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),b(this,bs,!1),!0},Rr=new WeakSet,xh=function(){o(this,si)&&(clearTimeout(o(this,si)),b(this,si,null))};var en,Nc;class Av{constructor(){g(this,en,new Set);g(this,Nc,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};o(this,Nc).then(()=>{for(const i of o(this,en))i.call(this,s)})}addEventListener(e,t){o(this,en).add(t)}removeEventListener(e,t){o(this,en).delete(t)}terminate(){o(this,en).clear()}}en=new WeakMap,Nc=new WeakMap;const ls={isWorkerDisabled:!1,fakeWorkerId:0};Vt&&(ls.isWorkerDisabled=!0,ks.workerSrc||(ks.workerSrc="./pdf.worker.mjs")),ls.isSameOrigin=function(c,e){let t;try{if(t=new URL(c),!t.origin||t.origin==="null")return!1}catch{return!1}const s=new URL(e,t);return t.origin===s.origin},ls.createCDNWrapper=function(c){const e=`await import("${c}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))};var sn,Pr,Th,Ir,Ch;const ne=class ne{constructor({name:e=null,port:t=null,verbosity:s=tm()}={}){g(this,Pr);var i;if(this.name=e,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((i=o(ne,sn))!=null&&i.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(o(ne,sn)||b(ne,sn,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return Vt?Promise.all([es.promise,this._readyCapability.promise]):this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new Ta("main","worker",e),this._messageHandler.on("ready",function(){}),y(this,Pr,Th).call(this)}_initialize(){if(ls.isWorkerDisabled||o(ne,Ir,Ch)){this._setupFakeWorker();return}let{workerSrc:e}=ne;try{ls.isSameOrigin(window.location.href,e)||(e=ls.createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new Ta("main","worker",t),i=()=>{n.abort(),s.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},n=new AbortController;t.addEventListener("error",()=>{this._webWorker||i()},{signal:n.signal}),s.on("test",a=>{if(n.abort(),this.destroyed||!a){i();return}this._messageHandler=s,this._port=t,this._webWorker=t,y(this,Pr,Th).call(this)}),s.on("ready",a=>{if(n.abort(),this.destroyed){i();return}try{r()}catch{this._setupFakeWorker()}});const r=()=>{const a=new Uint8Array;s.send("test",a,[a.buffer])};r();return}catch{kd("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){ls.isWorkerDisabled||(V("Setting up fake worker."),ls.isWorkerDisabled=!0),ne._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new Av;this._port=t;const s=`fake${ls.fakeWorkerId++}`,i=new Ta(s+"_worker",s,t);e.setup(i,t),this._messageHandler=new Ta(s,s+"_worker",t),y(this,Pr,Th).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(e=o(ne,sn))==null||e.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(e){var s;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(s=o(this,sn))==null?void 0:s.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new ne(e)}static get workerSrc(){if(ks.workerSrc)return ks.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Z(this,"_setupFakeWorkerGlobal",(async()=>o(this,Ir,Ch)?o(this,Ir,Ch):(await yi(()=>import(this.workerSrc),[],import.meta.url)).WorkerMessageHandler)())}};sn=new WeakMap,Pr=new WeakSet,Th=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Ir=new WeakSet,Ch=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},g(ne,Ir),g(ne,sn,void 0);let Zn=ne;var ys,Ge,Mr,Lr,Ve,nn,Ca;class Ev{constructor(e,t,s,i,n){g(this,nn);g(this,ys,new Map);g(this,Ge,new Map);g(this,Mr,new Map);g(this,Lr,new Map);g(this,Ve,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new Wp,this.fontLoader=new Em({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=n.canvasFactory,this.filterFactory=n.filterFactory,this.cMapReaderFactory=n.cMapReaderFactory,this.standardFontDataFactory=n.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Z(this,"annotationStorage",new wf)}getRenderingIntent(e,t=$s.ENABLE,s=null,i=!1,n=!1){let r=fe.DISPLAY,a=Tu;switch(e){case"any":r=fe.ANY;break;case"display":break;case"print":r=fe.PRINT;break;default:V(`getRenderingIntent - invalid intent: ${e}`)}const l=r&fe.PRINT&&s instanceof Mp?s:this.annotationStorage;switch(t){case $s.DISABLE:r+=fe.ANNOTATIONS_DISABLE;break;case $s.ENABLE:break;case $s.ENABLE_FORMS:r+=fe.ANNOTATIONS_FORMS;break;case $s.ENABLE_STORAGE:r+=fe.ANNOTATIONS_STORAGE,a=l.serializable;break;default:V(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(r+=fe.IS_EDITING),n&&(r+=fe.OPLIST);const{ids:h,hash:d}=l.modifiedIds,u=[r,a.hash,d];return{renderingIntent:r,cacheKey:u.join("_"),annotationStorageSerializable:a,modifiedIds:h}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=o(this,Ve))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of o(this,Ge).values())e.push(i._destroy());o(this,Ge).clear(),o(this,Mr).clear(),o(this,Lr).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i;this.commonObjs.clear(),this.fontLoader.clear(),o(this,ys).clear(),this.filterFactory.destroy(),ka.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Un("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{Tt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=n=>{this._lastProgress={loaded:n.loaded,total:n.total}},i.onPull=()=>{this._fullReader.read().then(function({value:n,done:r}){if(r){i.close();return}Tt(n instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(n),1,[n])}).catch(n=>{i.error(n)})},i.onCancel=n=>{this._fullReader.cancel(n),i.ready.catch(r=>{if(!this.destroyed)throw r})}}),e.on("ReaderHeadersReady",s=>{const i=Promise.withResolvers(),n=this._fullReader;return n.headersReady.then(()=>{var r;(!n.isStreamingSupported||!n.isRangeSupported)&&(this._lastProgress&&((r=t.onProgress)==null||r.call(t,this._lastProgress)),n.onProgress=a=>{var l;(l=t.onProgress)==null||l.call(t,{loaded:a.loaded,total:a.total})}),i.resolve({isStreamingSupported:n.isStreamingSupported,isRangeSupported:n.isRangeSupported,contentLength:n.contentLength})},i.reject),i.promise}),e.on("GetRangeReader",(s,i)=>{Tt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(s.begin,s.end);if(!n){i.close();return}i.onPull=()=>{n.read().then(function({value:r,done:a}){if(a){i.close();return}Tt(r instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{i.error(r)})},i.onCancel=r=>{n.cancel(r),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new bv(s,this))}),e.on("DocException",function(s){let i;switch(s.name){case"PasswordException":i=new eu(s.message,s.code);break;case"InvalidPDFException":i=new Jf(s.message);break;case"MissingPDFException":i=new Hn(s.message);break;case"UnexpectedResponseException":i=new Nd(s.message,s.status);break;case"UnknownErrorException":i=new su(s.message,s.details);break;default:nt("DocException - expected a valid Error.")}t._capability.reject(i)}),e.on("PasswordRequest",s=>{if(b(this,Ve,Promise.withResolvers()),t.onPassword){const i=n=>{n instanceof Error?o(this,Ve).reject(n):o(this,Ve).resolve({password:n})};try{t.onPassword(i,s.code)}catch(n){o(this,Ve).reject(n)}}else o(this,Ve).reject(new eu(s.message,s.code));return o(this,Ve).promise}),e.on("DataLoaded",s=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;o(this,Ge).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,n])=>{var r;if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":const{disableFontFace:a,fontExtraProperties:l,pdfBug:h}=this._params;if("error"in n){const p=n.error;V(`Error during font loading: ${p}`),this.commonObjs.resolve(s,p);break}const d=h&&((r=globalThis.FontInspector)!=null&&r.enabled)?(p,m)=>globalThis.FontInspector.fontAdded(p,m):null,u=new wm(n,{disableFontFace:a,inspectFont:d});this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!l&&u.data&&(u.data=null),this.commonObjs.resolve(s,u)});break;case"CopyLocalImage":const{imageRef:f}=n;Tt(f,"The imageRef must be defined.");for(const p of o(this,Ge).values())for(const[,m]of p.objs)if((m==null?void 0:m.ref)===f)return m.dataLen?(this.commonObjs.resolve(s,structuredClone(m)),m.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,n);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,n,r])=>{var l;if(this.destroyed)return;const a=o(this,Ge).get(i);if(!a.objs.has(s)){if(a._intentStates.size===0){(l=r==null?void 0:r.bitmap)==null||l.close();return}switch(n){case"Image":a.objs.resolve(s,r),(r==null?void 0:r.dataLen)>Kg&&(a._maybeCleanupAfterRender=!0);break;case"Pattern":a.objs.resolve(s,r);break;default:throw new Error(`Got unknown object type ${n}`)}}}),e.on("DocProgress",s=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBuiltInCMap",s=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(s):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",s=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(s):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&V("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=o(this,Mr).get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(n=>{if(this.destroyed)throw new Error("Transport destroyed");n.refStr&&o(this,Lr).set(n.refStr,e);const r=new yv(t,n,this,this._params.pdfBug);return o(this,Ge).set(t,r),r});return o(this,Mr).set(t,i),i}getPageIndex(e){return Vf(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return y(this,nn,Ca).call(this,"GetFieldObjects")}hasJSActions(){return y(this,nn,Ca).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return y(this,nn,Ca).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return y(this,nn,Ca).call(this,"GetOptionalContentConfig").then(t=>new $m(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=o(this,ys).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>{var n,r;return{info:i[0],metadata:i[1]?new Um(i[1]):null,contentDispositionFilename:((n=this._fullReader)==null?void 0:n.filename)??null,contentLength:((r=this._fullReader)==null?void 0:r.contentLength)??null}});return o(this,ys).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of o(this,Ge).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),o(this,ys).clear(),this.filterFactory.destroy(!0),ka.cleanup()}}cachedPageNumber(e){if(!Vf(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return o(this,Lr).get(t)??null}}ys=new WeakMap,Ge=new WeakMap,Mr=new WeakMap,Lr=new WeakMap,Ve=new WeakMap,nn=new WeakSet,Ca=function(e,t=null){const s=o(this,ys).get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return o(this,ys).set(e,i),i};const ph=Symbol("INITIAL_DATA");var Re,Yo,Du;class Wp{constructor(){g(this,Yo);g(this,Re,Object.create(null))}get(e,t=null){if(t){const i=y(this,Yo,Du).call(this,e);return i.promise.then(()=>t(i.data)),null}const s=o(this,Re)[e];if(!s||s.data===ph)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=o(this,Re)[e];return!!t&&t.data!==ph}resolve(e,t=null){const s=y(this,Yo,Du).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in o(this,Re)){const{data:s}=o(this,Re)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}b(this,Re,Object.create(null))}*[Symbol.iterator](){for(const e in o(this,Re)){const{data:t}=o(this,Re)[e];t!==ph&&(yield[e,t])}}}Re=new WeakMap,Yo=new WeakSet,Du=function(e){var t;return(t=o(this,Re))[e]||(t[e]={...Promise.withResolvers(),data:ph})};var ni;class wv{constructor(e){g(this,ni,null);b(this,ni,e),this.onContinue=null}get promise(){return o(this,ni).capability.promise}cancel(e=0){o(this,ni).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=o(this,ni).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=o(this,ni);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}ni=new WeakMap;var ri,rn;const xi=class xi{constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:n,operatorList:r,pageIndex:a,canvasFactory:l,filterFactory:h,useRequestAnimationFrame:d=!1,pdfBug:u=!1,pageColors:f=null}){g(this,ri,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=n,this.operatorListIdx=null,this.operatorList=r,this._pageIndex=a,this.canvasFactory=l,this.filterFactory=h,this._pdfBug=u,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new wv(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var a,l;if(this.cancelled)return;if(this._canvas){if(o(xi,rn).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");o(xi,rn).add(this._canvas)}this._pdfBug&&((a=globalThis.StepperManager)!=null&&a.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:i,transform:n,background:r}=this.params;this.gfx=new Jn(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:n,viewport:i,transparency:e,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(e=null,t=0){var s;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),o(this,ri)&&(window.cancelAnimationFrame(o(this,ri)),b(this,ri,null)),o(xi,rn).delete(this._canvas),this.callback(e||new yf(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?b(this,ri,window.requestAnimationFrame(()=>{b(this,ri,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),o(xi,rn).delete(this._canvas),this.callback())))}};ri=new WeakMap,rn=new WeakMap,g(xi,rn,new WeakSet);let Fu=xi;const Sv="4.5.136",xv="3a21f03b0";tt(670);function Wf(c){return Math.floor(Math.max(0,Math.min(1,c))*255).toString(16).padStart(2,"0")}function ba(c){return Math.max(0,Math.min(255,255*c))}class Xf{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=ba(e),[e,e,e]}static G_HTML([e]){const t=Wf(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(ba)}static RGB_HTML(e){return`#${e.map(Wf).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[ba(1-Math.min(1,e+i)),ba(1-Math.min(1,s+i)),ba(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,n=1-t,r=1-s,a=Math.min(i,n,r);return["CMYK",i,n,r,a]}}class Xp{static setupStorage(e,t,s,i,n){const r=i.getValue(t,{value:null});switch(s.name){case"textarea":if(r.value!==null&&(e.textContent=r.value),n==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(r.value===s.attributes.xfaOn?e.setAttribute("checked",!0):r.value===s.attributes.xfaOff&&e.removeAttribute("checked"),n==="print")break;e.addEventListener("change",a=>{i.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(r.value!==null&&e.setAttribute("value",r.value),n==="print")break;e.addEventListener("input",a=>{i.setValue(t,{value:a.target.value})})}break;case"select":if(r.value!==null){e.setAttribute("value",r.value);for(const a of s.children)a.attributes.value===r.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{const l=a.target.options,h=l.selectedIndex===-1?"":l[l.selectedIndex].value;i.setValue(t,{value:h})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:n}){const{attributes:r}=t,a=e instanceof HTMLAnchorElement;r.type==="radio"&&(r.name=`${r.name}-${i}`);for(const[l,h]of Object.entries(r))if(h!=null)switch(l){case"class":h.length&&e.setAttribute(l,h.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",h);break;case"style":Object.assign(e.style,h);break;case"textContent":e.textContent=h;break;default:(!a||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,h)}a&&n.addLinkAttributes(e,r.href,r.newWindow),s&&r.dataId&&this.setupStorage(e,r.dataId,t,s)}static render(e){var u,f;const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,n=e.intent||"display",r=document.createElement(i.name);i.attributes&&this.setAttributes({html:r,element:i,intent:n,linkService:s});const a=n!=="richText",l=e.div;if(l.append(r),e.viewport){const p=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=p}a&&l.setAttribute("class","xfaLayer xfaFont");const h=[];if(i.children.length===0){if(i.value){const p=document.createTextNode(i.value);r.append(p),a&&Na.shouldBuildText(i.name)&&h.push(p)}return{textDivs:h}}const d=[[i,-1,r]];for(;d.length>0;){const[p,m,v]=d.at(-1);if(m+1===p.children.length){d.pop();continue}const E=p.children[++d.at(-1)[1]];if(E===null)continue;const{name:A}=E;if(A==="#text"){const S=document.createTextNode(E.value);h.push(S),v.append(S);continue}const w=(u=E==null?void 0:E.attributes)!=null&&u.xmlns?document.createElementNS(E.attributes.xmlns,A):document.createElement(A);if(v.append(w),E.attributes&&this.setAttributes({html:w,element:E,storage:t,intent:n,linkService:s}),((f=E.children)==null?void 0:f.length)>0)d.push([E,-1,w]);else if(E.value){const S=document.createTextNode(E.value);a&&Na.shouldBuildText(A)&&h.push(S),w.append(S)}}for(const p of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:h}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const hh=1e3,Tv=9,Bn=new WeakSet;function Ns(c){return{width:c[2]-c[0],height:c[3]-c[1]}}class Cv{static create(e){switch(e.data.annotationType){case At.LINK:return new Yp(e);case At.TEXT:return new Rv(e);case At.WIDGET:switch(e.data.fieldType){case"Tx":return new Pv(e);case"Btn":return e.data.radioButton?new Jp(e):e.data.checkBox?new Mv(e):new Lv(e);case"Ch":return new _v(e);case"Sig":return new Iv(e)}return new jn(e);case At.POPUP:return new Nu(e);case At.FREETEXT:return new sg(e);case At.LINE:return new Dv(e);case At.SQUARE:return new Fv(e);case At.CIRCLE:return new kv(e);case At.POLYLINE:return new ig(e);case At.CARET:return new Bv(e);case At.INK:return new ng(e);case At.POLYGON:return new Nv(e);case At.HIGHLIGHT:return new Hv(e);case At.UNDERLINE:return new Uv(e);case At.SQUIGGLY:return new jv(e);case At.STRIKEOUT:return new $v(e);case At.STAMP:return new rg(e);case At.FILEATTACHMENT:return new zv(e);default:return new vt(e)}}}var an,_r,Or,Ko,ku;const Pf=class Pf{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){g(this,Ko);g(this,an,null);g(this,_r,!1);g(this,Or,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:s}){return!!(e!=null&&e.str||t!=null&&t.str||s!=null&&s.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Pf._hasPopupData(this.data)}updateEdited(e){var s;if(!this.container)return;o(this,an)||b(this,an,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&y(this,Ko,ku).call(this,t),(s=o(this,Or))==null||s.popup.updateEdited(e)}resetEdited(){var e;o(this,an)&&(y(this,Ko,ku).call(this,o(this,an).rect),(e=o(this,Or))==null||e.popup.resetEdited(),b(this,an,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,n=document.createElement("section");n.setAttribute("data-annotation-id",t.id),this instanceof jn||(n.tabIndex=hh);const{style:r}=n;if(r.zIndex=this.parent.zIndex++,t.popupRef&&n.setAttribute("aria-haspopup","dialog"),t.alternativeText&&(n.title=t.alternativeText),t.noRotate&&n.classList.add("norotate"),!t.rect||this instanceof Nu){const{rotation:v}=t;return!t.hasOwnCanvas&&v!==0&&this.setRotation(v,n),n}const{width:a,height:l}=Ns(t.rect);if(!e&&t.borderStyle.width>0){r.borderWidth=`${t.borderStyle.width}px`;const v=t.borderStyle.horizontalCornerRadius,E=t.borderStyle.verticalCornerRadius;if(v>0||E>0){const w=`calc(${v}px * var(--scale-factor)) / calc(${E}px * var(--scale-factor))`;r.borderRadius=w}else if(this instanceof Jp){const w=`calc(${a}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;r.borderRadius=w}switch(t.borderStyle.style){case ma.SOLID:r.borderStyle="solid";break;case ma.DASHED:r.borderStyle="dashed";break;case ma.BEVELED:V("Unimplemented border style: beveled");break;case ma.INSET:V("Unimplemented border style: inset");break;case ma.UNDERLINE:r.borderBottomStyle="solid";break}const A=t.borderColor||null;A?(b(this,_r,!0),r.borderColor=N.makeHexColor(A[0]|0,A[1]|0,A[2]|0)):r.borderWidth=0}const h=N.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:d,pageHeight:u,pageX:f,pageY:p}=i.rawDims;r.left=`${100*(h[0]-f)/d}%`,r.top=`${100*(h[1]-p)/u}%`;const{rotation:m}=t;return t.hasOwnCanvas||m===0?(r.width=`${100*a/d}%`,r.height=`${100*l/u}%`):this.setRotation(m,n),n}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims,{width:n,height:r}=Ns(this.data.rect);let a,l;e%180===0?(a=100*n/s,l=100*r/i):(a=100*r/s,l=100*n/i),t.style.width=`${a}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const n=i.detail[t],r=n[0],a=n.slice(1);i.target.style[s]=Xf[`${r}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[s]:Xf[`${r}_rgb`](a)})};return Z(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail)){const n=e[i]||s[i];n==null||n(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,n]of Object.entries(t)){const r=s[i];if(r){const a={detail:{[i]:n},target:e};r(a),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,n]=this.data.rect.map(v=>Math.fround(v));if(e.length===8){const[v,E,A,w]=e.subarray(2,6);if(i===v&&n===E&&t===A&&s===w)return}const{style:r}=this.container;let a;if(o(this,_r)){const{borderColor:v,borderWidth:E}=r;r.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${v}" stroke-width="${E}">`],this.container.classList.add("hasBorder")}const l=i-t,h=n-s,{svgFactory:d}=this,u=d.createElement("svg");u.classList.add("quadrilateralsContainer"),u.setAttribute("width",0),u.setAttribute("height",0);const f=d.createElement("defs");u.append(f);const p=d.createElement("clipPath"),m=`clippath_${this.data.id}`;p.setAttribute("id",m),p.setAttribute("clipPathUnits","objectBoundingBox"),f.append(p);for(let v=2,E=e.length;v<E;v+=8){const A=e[v],w=e[v+1],S=e[v+2],C=e[v+3],x=d.createElement("rect"),T=(S-t)/l,R=(n-w)/h,I=(A-S)/l,P=(w-C)/h;x.setAttribute("x",T),x.setAttribute("y",R),x.setAttribute("width",I),x.setAttribute("height",P),p.append(x),a==null||a.push(`<rect vector-effect="non-scaling-stroke" x="${T}" y="${R}" width="${I}" height="${P}"/>`)}o(this,_r)&&(a.push("</g></svg>')"),r.backgroundImage=a.join("")),this.container.append(u),this.container.style.clipPath=`url(#${m})`}_createPopup(){const{container:e,data:t}=this;e.setAttribute("aria-haspopup","dialog");const s=b(this,Or,new Nu({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(s.render())}render(){nt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:n,id:r,exportValues:a}of i){if(n===-1||r===t)continue;const l=typeof a=="string"?a:null,h=document.querySelector(`[data-element-id="${r}"]`);if(h&&!Bn.has(h)){V(`_getElementsByName - element not allowed: ${r}`);continue}s.push({id:r,exportValue:l,domElement:h})}return s}for(const i of document.getElementsByName(e)){const{exportValue:n}=i,r=i.getAttribute("data-element-id");r!==t&&Bn.has(i)&&s.push({id:r,exportValue:n,domElement:i})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};an=new WeakMap,_r=new WeakMap,Or=new WeakMap,Ko=new WeakSet,ku=function(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:n,pageHeight:r,pageX:a,pageY:l}}}}=this;s==null||s.splice(0,4,...e);const{width:h,height:d}=Ns(e);t.left=`${100*(e[0]-a)/n}%`,t.top=`${100*(r-e[3]+l)/r}%`,i===0?(t.width=`${100*h/n}%`,t.height=`${100*d/r}%`):this.setRotation(i)};let vt=Pf;var As,Ai,Bc,Kp,Hc,Qp;class Yp extends vt{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});g(this,As);g(this,Bc);g(this,Hc);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let n=!1;return t.url?(s.addLinkAttributes(i,t.url,t.newWindow),n=!0):t.action?(this._bindNamedAction(i,t.action),n=!0):t.attachment?(y(this,Bc,Kp).call(this,i,t.attachment,t.attachmentDest),n=!0):t.setOCGState?(y(this,Hc,Qp).call(this,i,t.setOCGState),n=!0):t.dest?(this._bindLink(i,t.dest),n=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),n=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),n=!0):this.isTooltipOnly&&!n&&(this._bindLink(i,""),n=!0)),this.container.classList.add("linkAnnotation"),n&&this.container.append(i),this.container}_bindLink(t,s){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&y(this,As,Ai).call(this)}_bindNamedAction(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),y(this,As,Ai).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const n of Object.keys(s.actions)){const r=i.get(n);r&&(t[r]=()=>{var a;return(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:n}}),!1})}t.onclick||(t.onclick=()=>!1),y(this,As,Ai).call(this)}_bindResetFormAction(t,s){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),y(this,As,Ai).call(this),!this._fieldObjects){V('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var u;i==null||i();const{fields:n,refs:r,include:a}=s,l=[];if(n.length!==0||r.length!==0){const f=new Set(r);for(const p of n){const m=this._fieldObjects[p]||[];for(const{id:v}of m)f.add(v)}for(const p of Object.values(this._fieldObjects))for(const m of p)f.has(m.id)===a&&l.push(m)}else for(const f of Object.values(this._fieldObjects))l.push(...f);const h=this.annotationStorage,d=[];for(const f of l){const{id:p}=f;switch(d.push(p),f.type){case"text":{const v=f.defaultValue||"";h.setValue(p,{value:v});break}case"checkbox":case"radiobutton":{const v=f.defaultValue===f.exportValues;h.setValue(p,{value:v});break}case"combobox":case"listbox":{const v=f.defaultValue||"";h.setValue(p,{value:v});break}default:continue}const m=document.querySelector(`[data-element-id="${p}"]`);if(m){if(!Bn.has(m)){V(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((u=this.linkService.eventBus)==null||u.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}})),!1}}}As=new WeakSet,Ai=function(){this.container.setAttribute("data-internal-link","")},Bc=new WeakSet,Kp=function(t,s,i=null){t.href=this.linkService.getAnchorUrl(""),s.description&&(t.title=s.description),t.onclick=()=>{var n;return(n=this.downloadManager)==null||n.openOrDownloadData(s.content,s.filename,i),!1},y(this,As,Ai).call(this)},Hc=new WeakSet,Qp=function(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),y(this,As,Ai).call(this)};class Rv extends vt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class jn extends vt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return te.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,n){s.includes("mouse")?e.addEventListener(s,r=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:n(r),shift:r.shiftKey,modifier:this._getKeyModifier(r)}})}):e.addEventListener(s,r=>{var a;if(s==="blur"){if(!t.focused||!r.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}n&&((a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:n(r)}}))})}_setEventListeners(e,t,s,i){var n,r,a;for(const[l,h]of s)(h==="Action"||(n=this.data.actions)!=null&&n[h])&&((h==="Focus"||h==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,h,i),h==="Focus"&&!((r=this.data.actions)!=null&&r.Blur)?this._setEventListener(e,t,"blur","Blur",null):h==="Blur"&&!((a=this.data.actions)!=null&&a.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":N.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||Tv,n=e.style;let r;const a=2,l=h=>Math.round(10*h)/10;if(this.data.multiLine){const h=Math.abs(this.data.rect[3]-this.data.rect[1]-a),d=Math.round(h/(Xd*i))||1,u=h/d;r=Math.min(i,l(u/Xd))}else{const h=Math.abs(this.data.rect[3]-this.data.rect[1]-a);r=Math.min(i,l(h/Xd))}n.fontSize=`calc(${r}px * var(--scale-factor))`,n.color=N.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(n.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class Pv extends jn{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,i){const n=this.annotationStorage;for(const r of this._getElementsByName(e.name,e.id))r.domElement&&(r.domElement[t]=s),n.setValue(r.id,{[i]:s})}render(){var i,n;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const r=e.getValue(t,{value:this.data.fieldValue});let a=r.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&a.length>l&&(a=a.slice(0,l));let h=r.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;h&&this.data.comb&&(h=h.replaceAll(/\s+/g,""));const d={userValue:a,formattedValue:h,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=h??a,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",h??a),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),Bn.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=hh,this._setRequired(s,this.data.required),l&&(s.maxLength=l),s.addEventListener("input",f=>{e.setValue(t,{value:f.target.value}),this.setPropertyOnSiblings(s,"value",f.target.value,"value"),d.formattedValue=null}),s.addEventListener("resetform",f=>{const p=this.data.defaultFieldValue??"";s.value=d.userValue=p,d.formattedValue=null});let u=f=>{const{formattedValue:p}=d;p!=null&&(f.target.value=p),f.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",p=>{var v;if(d.focused)return;const{target:m}=p;d.userValue&&(m.value=d.userValue),d.lastCommittedValue=m.value,d.commitKey=1,(v=this.data.actions)!=null&&v.Focus||(d.focused=!0)}),s.addEventListener("updatefromsandbox",p=>{this.showElementAndHideCanvas(p.target);const m={value(v){d.userValue=v.detail.value??"",e.setValue(t,{value:d.userValue.toString()}),v.target.value=d.userValue},formattedValue(v){const{formattedValue:E}=v.detail;d.formattedValue=E,E!=null&&v.target!==document.activeElement&&(v.target.value=E),e.setValue(t,{formattedValue:E})},selRange(v){v.target.setSelectionRange(...v.detail.selRange)},charLimit:v=>{var S;const{charLimit:E}=v.detail,{target:A}=v;if(E===0){A.removeAttribute("maxLength");return}A.setAttribute("maxLength",E);let w=d.userValue;!w||w.length<=E||(w=w.slice(0,E),A.value=d.userValue=w,e.setValue(t,{value:w}),(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:1,selStart:A.selectionStart,selEnd:A.selectionEnd}}))}};this._dispatchEventFromSandbox(m,p)}),s.addEventListener("keydown",p=>{var E;d.commitKey=1;let m=-1;if(p.key==="Escape"?m=0:p.key==="Enter"&&!this.data.multiLine?m=2:p.key==="Tab"&&(d.commitKey=3),m===-1)return;const{value:v}=p.target;d.lastCommittedValue!==v&&(d.lastCommittedValue=v,d.userValue=v,(E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:v,willCommit:!0,commitKey:m,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}}))});const f=u;u=null,s.addEventListener("blur",p=>{var v,E;if(!d.focused||!p.relatedTarget)return;(v=this.data.actions)!=null&&v.Blur||(d.focused=!1);const{value:m}=p.target;d.userValue=m,d.lastCommittedValue!==m&&((E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:m,willCommit:!0,commitKey:d.commitKey,selStart:p.target.selectionStart,selEnd:p.target.selectionEnd}})),f(p)}),(n=this.data.actions)!=null&&n.Keystroke&&s.addEventListener("beforeinput",p=>{var x;d.lastCommittedValue=null;const{data:m,target:v}=p,{value:E,selectionStart:A,selectionEnd:w}=v;let S=A,C=w;switch(p.inputType){case"deleteWordBackward":{const T=E.substring(0,A).match(/\w*[^\w]*$/);T&&(S-=T[0].length);break}case"deleteWordForward":{const T=E.substring(A).match(/^[^\w]*\w*/);T&&(C+=T[0].length);break}case"deleteContentBackward":A===w&&(S-=1);break;case"deleteContentForward":A===w&&(C+=1);break}p.preventDefault(),(x=this.linkService.eventBus)==null||x.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,change:m||"",willCommit:!1,selStart:S,selEnd:C}})}),this._setEventListeners(s,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],p=>p.target.value)}if(u&&s.addEventListener("blur",u),this.data.comb){const p=(this.data.rect[2]-this.data.rect[0])/l;s.classList.add("comb"),s.style.letterSpacing=`calc(${p}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Iv extends jn{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class Mv extends jn{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const n=document.createElement("input");return Bn.add(n),n.setAttribute("data-element-id",s),n.disabled=t.readOnly,this._setRequired(n,this.data.required),n.type="checkbox",n.name=t.fieldName,i&&n.setAttribute("checked",!0),n.setAttribute("exportValue",t.exportValue),n.tabIndex=hh,n.addEventListener("change",r=>{const{name:a,checked:l}=r.target;for(const h of this._getElementsByName(a,s)){const d=l&&h.exportValue===t.exportValue;h.domElement&&(h.domElement.checked=d),e.setValue(h.id,{value:d})}e.setValue(s,{value:l})}),n.addEventListener("resetform",r=>{const a=t.defaultFieldValue||"Off";r.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(n.addEventListener("updatefromsandbox",r=>{const a={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(s,{value:l.target.checked})}};this._dispatchEventFromSandbox(a,r)}),this._setEventListeners(n,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],r=>r.target.checked)),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Jp extends jn{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const r of this._getElementsByName(t.fieldName,s))e.setValue(r.id,{value:!1});const n=document.createElement("input");if(Bn.add(n),n.setAttribute("data-element-id",s),n.disabled=t.readOnly,this._setRequired(n,this.data.required),n.type="radio",n.name=t.fieldName,i&&n.setAttribute("checked",!0),n.tabIndex=hh,n.addEventListener("change",r=>{const{name:a,checked:l}=r.target;for(const h of this._getElementsByName(a,s))e.setValue(h.id,{value:!1});e.setValue(s,{value:l})}),n.addEventListener("resetform",r=>{const a=t.defaultFieldValue;r.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){const r=t.buttonValue;n.addEventListener("updatefromsandbox",a=>{const l={value:h=>{const d=r===h.detail.value;for(const u of this._getElementsByName(h.target.name)){const f=d&&u.id===s;u.domElement&&(u.domElement.checked=f),e.setValue(u.id,{value:f})}}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(n,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Lv extends Yp{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class _v extends jn{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");Bn.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=hh;let n=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",d=>{const u=this.data.defaultFieldValue;for(const f of i.options)f.selected=f.value===u});for(const d of this.data.options){const u=document.createElement("option");u.textContent=d.displayValue,u.value=d.exportValue,s.value.includes(d.exportValue)&&(u.setAttribute("selected",!0),n=!1),i.append(u)}let r=null;if(n){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),i.prepend(d),r=()=>{d.remove(),i.removeEventListener("input",r),r=null},i.addEventListener("input",r)}const a=d=>{const u=d?"value":"textContent",{options:f,multiple:p}=i;return p?Array.prototype.filter.call(f,m=>m.selected).map(m=>m[u]):f.selectedIndex===-1?null:f[f.selectedIndex][u]};let l=a(!1);const h=d=>{const u=d.target.options;return Array.prototype.map.call(u,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",d=>{const u={value(f){r==null||r();const p=f.detail.value,m=new Set(Array.isArray(p)?p:[p]);for(const v of i.options)v.selected=m.has(v.value);e.setValue(t,{value:a(!0)}),l=a(!1)},multipleSelection(f){i.multiple=!0},remove(f){const p=i.options,m=f.detail.remove;p[m].selected=!1,i.remove(m),p.length>0&&Array.prototype.findIndex.call(p,E=>E.selected)===-1&&(p[0].selected=!0),e.setValue(t,{value:a(!0),items:h(f)}),l=a(!1)},clear(f){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),l=a(!1)},insert(f){const{index:p,displayValue:m,exportValue:v}=f.detail.insert,E=i.children[p],A=document.createElement("option");A.textContent=m,A.value=v,E?E.before(A):i.append(A),e.setValue(t,{value:a(!0),items:h(f)}),l=a(!1)},items(f){const{items:p}=f.detail;for(;i.length!==0;)i.remove(0);for(const m of p){const{displayValue:v,exportValue:E}=m,A=document.createElement("option");A.textContent=v,A.value=E,i.append(A)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:a(!0),items:h(f)}),l=a(!1)},indices(f){const p=new Set(f.detail.indices);for(const m of f.target.options)m.selected=p.has(m.index);e.setValue(t,{value:a(!0)}),l=a(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(u,d)}),i.addEventListener("input",d=>{var p;const u=a(!0),f=a(!1);e.setValue(t,{value:u}),d.preventDefault(),(p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:f,changeEx:u,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):i.addEventListener("input",function(d){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Nu extends vt{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:vt._hasPopupData(t)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new Ov({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const s of this.elements)s.popup=e,t.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(s=>`${qf}${s}`).join(",")),this.container}}var Dr,Uc,jc,Fr,on,gt,Es,ln,Qo,Jo,kr,ws,Pe,Ss,Zo,xs,qo,hn,cn,Nr,Rh,tl,Bu,$c,Zp,zc,qp,Gc,tg,Vc,eg,Br,Ph,Hr,Ih,el,Hu;class Ov{constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:n,contentsObj:r,richText:a,parent:l,rect:h,parentRect:d,open:u}){g(this,Nr);g(this,tl);g(this,$c);g(this,zc);g(this,Gc);g(this,Vc);g(this,Br);g(this,Hr);g(this,el);g(this,Dr,y(this,Gc,tg).bind(this));g(this,Uc,y(this,el,Hu).bind(this));g(this,jc,y(this,Hr,Ih).bind(this));g(this,Fr,y(this,Br,Ph).bind(this));g(this,on,null);g(this,gt,null);g(this,Es,null);g(this,ln,null);g(this,Qo,null);g(this,Jo,null);g(this,kr,null);g(this,ws,!1);g(this,Pe,null);g(this,Ss,null);g(this,Zo,null);g(this,xs,null);g(this,qo,null);g(this,hn,null);g(this,cn,!1);var f;b(this,gt,e),b(this,qo,i),b(this,Es,r),b(this,xs,a),b(this,Jo,l),b(this,on,t),b(this,Zo,h),b(this,kr,d),b(this,Qo,s),b(this,ln,ip.toDateObject(n)),this.trigger=s.flatMap(p=>p.getElementsToTriggerPopup());for(const p of this.trigger)p.addEventListener("click",o(this,Fr)),p.addEventListener("mouseenter",o(this,jc)),p.addEventListener("mouseleave",o(this,Uc)),p.classList.add("popupTriggerArea");for(const p of s)(f=p.container)==null||f.addEventListener("keydown",o(this,Dr));o(this,gt).hidden=!0,u&&y(this,Br,Ph).call(this)}render(){if(o(this,Pe))return;const e=b(this,Pe,document.createElement("div"));if(e.className="popup",o(this,on)){const n=e.style.outlineColor=N.makeHexColor(...o(this,on));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`:e.style.backgroundColor=N.makeHexColor(...o(this,on).map(a=>Math.floor(.7*(255-a)+a)))}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),{dir:s.dir,str:s.textContent}=o(this,qo),e.append(t),o(this,ln)){const n=document.createElement("span");n.classList.add("popupDate"),n.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),n.setAttribute("data-l10n-args",JSON.stringify({date:o(this,ln).toLocaleDateString(),time:o(this,ln).toLocaleTimeString()})),t.append(n)}const i=o(this,Nr,Rh);if(i)Xp.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const n=this._formatContents(o(this,Es));e.append(n)}o(this,gt).append(e)}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let n=0,r=i.length;n<r;++n){const a=i[n];s.append(document.createTextNode(a)),n<r-1&&s.append(document.createElement("br"))}return s}updateEdited({rect:e,popupContent:t}){var s;o(this,hn)||b(this,hn,{contentsObj:o(this,Es),richText:o(this,xs)}),e&&b(this,Ss,null),t&&(b(this,xs,y(this,zc,qp).call(this,t)),b(this,Es,null)),(s=o(this,Pe))==null||s.remove(),b(this,Pe,null)}resetEdited(){var e;o(this,hn)&&({contentsObj:se(this,Es)._,richText:se(this,xs)._}=o(this,hn),b(this,hn,null),(e=o(this,Pe))==null||e.remove(),b(this,Pe,null),b(this,Ss,null))}forceHide(){b(this,cn,this.isVisible),o(this,cn)&&(o(this,gt).hidden=!0)}maybeShow(){o(this,cn)&&(o(this,Pe)||y(this,Hr,Ih).call(this),b(this,cn,!1),o(this,gt).hidden=!1)}get isVisible(){return o(this,gt).hidden===!1}}Dr=new WeakMap,Uc=new WeakMap,jc=new WeakMap,Fr=new WeakMap,on=new WeakMap,gt=new WeakMap,Es=new WeakMap,ln=new WeakMap,Qo=new WeakMap,Jo=new WeakMap,kr=new WeakMap,ws=new WeakMap,Pe=new WeakMap,Ss=new WeakMap,Zo=new WeakMap,xs=new WeakMap,qo=new WeakMap,hn=new WeakMap,cn=new WeakMap,Nr=new WeakSet,Rh=function(){const e=o(this,xs),t=o(this,Es);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&o(this,xs).html||null},tl=new WeakSet,Bu=function(){var e,t,s;return((s=(t=(e=o(this,Nr,Rh))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},$c=new WeakSet,Zp=function(){var e,t,s;return((s=(t=(e=o(this,Nr,Rh))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},zc=new WeakSet,qp=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:o(this,$c,Zp),fontSize:o(this,tl,Bu)?`calc(${o(this,tl,Bu)}px * var(--scale-factor))`:""}};for(const n of e.split(`
`))t.push({name:"span",value:n,attributes:i});return s},Gc=new WeakSet,tg=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&o(this,ws))&&y(this,Br,Ph).call(this)},Vc=new WeakSet,eg=function(){if(o(this,Ss)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:n}}}=o(this,Jo);let r=!!o(this,kr),a=r?o(this,kr):o(this,Zo);for(const m of o(this,Qo))if(!a||N.intersect(m.data.rect,a)!==null){a=m.data.rect,r=!0;break}const l=N.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),h=5,d=r?a[2]-a[0]+h:0,u=l[0]+d,f=l[1];b(this,Ss,[100*(u-i)/t,100*(f-n)/s]);const{style:p}=o(this,gt);p.left=`${o(this,Ss)[0]}%`,p.top=`${o(this,Ss)[1]}%`},Br=new WeakSet,Ph=function(){b(this,ws,!o(this,ws)),o(this,ws)?(y(this,Hr,Ih).call(this),o(this,gt).addEventListener("click",o(this,Fr)),o(this,gt).addEventListener("keydown",o(this,Dr))):(y(this,el,Hu).call(this),o(this,gt).removeEventListener("click",o(this,Fr)),o(this,gt).removeEventListener("keydown",o(this,Dr)))},Hr=new WeakSet,Ih=function(){o(this,Pe)||this.render(),this.isVisible?o(this,ws)&&o(this,gt).classList.add("focused"):(y(this,Vc,eg).call(this),o(this,gt).hidden=!1,o(this,gt).style.zIndex=parseInt(o(this,gt).style.zIndex)+1e3)},el=new WeakSet,Hu=function(){o(this,gt).classList.remove("focused"),!(o(this,ws)||!this.isVisible)&&(o(this,gt).hidden=!0,o(this,gt).style.zIndex=parseInt(o(this,gt).style.zIndex)-1e3)};class sg extends vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=J.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var sl;class Dv extends vt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});g(this,sl,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:s,height:i}=Ns(t.rect),n=this.svgFactory.create(s,i,!0),r=b(this,sl,this.svgFactory.createElement("svg:line"));return r.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),r.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),r.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),r.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),r.setAttribute("stroke-width",t.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),n.append(r),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return o(this,sl)}addHighlightArea(){this.container.classList.add("highlightArea")}}sl=new WeakMap;var il;class Fv extends vt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});g(this,il,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:s,height:i}=Ns(t.rect),n=this.svgFactory.create(s,i,!0),r=t.borderStyle.width,a=b(this,il,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",r/2),a.setAttribute("y",r/2),a.setAttribute("width",s-r),a.setAttribute("height",i-r),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return o(this,il)}addHighlightArea(){this.container.classList.add("highlightArea")}}il=new WeakMap;var nl;class kv extends vt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});g(this,nl,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:s,height:i}=Ns(t.rect),n=this.svgFactory.create(s,i,!0),r=t.borderStyle.width,a=b(this,nl,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",s/2),a.setAttribute("cy",i/2),a.setAttribute("rx",s/2-r/2),a.setAttribute("ry",i/2-r/2),a.setAttribute("stroke-width",r||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return o(this,nl)}addHighlightArea(){this.container.classList.add("highlightArea")}}nl=new WeakMap;var rl;class ig extends vt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});g(this,rl,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:i,popupRef:n}}=this;if(!s)return this.container;const{width:r,height:a}=Ns(t),l=this.svgFactory.create(r,a,!0);let h=[];for(let u=0,f=s.length;u<f;u+=2){const p=s[u]-t[0],m=t[3]-s[u+1];h.push(`${p},${m}`)}h=h.join(" ");const d=b(this,rl,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",h),d.setAttribute("stroke-width",i.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),l.append(d),this.container.append(l),!n&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return o(this,rl)}addHighlightArea(){this.container.classList.add("highlightArea")}}rl=new WeakMap;class Nv extends ig{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Bv extends vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var al;class ng extends vt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});g(this,al,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=J.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,inkLists:s,borderStyle:i,popupRef:n}}=this,{width:r,height:a}=Ns(t),l=this.svgFactory.create(r,a,!0);for(const h of s){let d=[];for(let f=0,p=h.length;f<p;f+=2){const m=h[f]-t[0],v=t[3]-h[f+1];d.push(`${m},${v}`)}d=d.join(" ");const u=this.svgFactory.createElement(this.svgElementName);o(this,al).push(u),u.setAttribute("points",d),u.setAttribute("stroke-width",i.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),!n&&this.hasPopupData&&this._createPopup(),l.append(u)}return this.container.append(l),this.container}getElementsToTriggerPopup(){return o(this,al)}addHighlightArea(){this.container.classList.add("highlightArea")}}al=new WeakMap;class Hv extends vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class Uv extends vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class jv extends vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class $v extends vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class rg extends vt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var ol,ll,Uu;class zv extends vt{constructor(t){var i;super(t,{isRenderable:!0});g(this,ll);g(this,ol,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let i;s.hasAppearance||s.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),i.addEventListener("dblclick",y(this,ll,Uu).bind(this)),b(this,ol,i);const{isMac:n}=te.platform;return t.addEventListener("keydown",r=>{r.key==="Enter"&&(n?r.metaKey:r.ctrlKey)&&y(this,ll,Uu).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return o(this,ol)}addHighlightArea(){this.container.classList.add("highlightArea")}}ol=new WeakMap,ll=new WeakSet,Uu=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var hl,dn,un,Wc,ag,cl,ju;class Gv{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:n,viewport:r}){g(this,Wc);g(this,cl);g(this,hl,null);g(this,dn,null);g(this,un,new Map);this.div=e,b(this,hl,t),b(this,dn,s),this.page=n,this.viewport=r,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return o(this,un).size>0}async render(e){var r;const{annotations:t}=e,s=this.div;kn(s,this.viewport);const i=new Map,n={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new bf,annotationStorage:e.annotationStorage||new wf,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const l=a.annotationType===At.POPUP;if(l){const u=i.get(a.id);if(!u)continue;n.elements=u}else{const{width:u,height:f}=Ns(a.rect);if(u<=0||f<=0)continue}n.data=a;const h=Cv.create(n);if(!h.isRenderable)continue;if(!l&&a.popupRef){const u=i.get(a.popupRef);u?u.push(h):i.set(a.popupRef,[h])}const d=h.render();a.hidden&&(d.style.visibility="hidden"),y(this,Wc,ag).call(this,d,a.id),h._isEditable&&(o(this,un).set(h.data.id,h),(r=this._annotationEditorUIManager)==null||r.renderAnnotationElement(h))}y(this,cl,ju).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,kn(t,{rotation:e.rotation}),y(this,cl,ju).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(o(this,un).values())}getEditableAnnotation(e){return o(this,un).get(e)}}hl=new WeakMap,dn=new WeakMap,un=new WeakMap,Wc=new WeakSet,ag=function(e,t){var i;const s=e.firstChild||e;s.id=`${qf}${t}`,this.div.append(e),(i=o(this,hl))==null||i.moveElementInDOM(this.div,e,s,!1)},cl=new WeakSet,ju=function(){if(!o(this,dn))return;const e=this.div;for(const[t,s]of o(this,dn)){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;s.className="annotationContent";const{firstChild:n}=i;n?n.nodeName==="CANVAS"?n.replaceWith(s):n.classList.contains("annotationContent")?n.after(s):n.before(s):i.append(s)}o(this,dn).clear()};const gh=/\r\n?|\n/g;var dl,ul,fl,pl,gl,Ie,le,ml,he,Ur,Xc,og,Yc,lg,Kc,hg,jr,Mh,$r,Lh,zr,_h,Qc,cg,vl,zu,Jc,dg;const ot=class ot extends et{constructor(t){super({...t,name:"freeTextEditor"});g(this,Xc);g(this,Yc);g(this,Kc);g(this,jr);g(this,zr);g(this,Qc);g(this,Jc);g(this,dl,this.editorDivBlur.bind(this));g(this,ul,this.editorDivFocus.bind(this));g(this,fl,this.editorDivInput.bind(this));g(this,pl,this.editorDivKeydown.bind(this));g(this,gl,this.editorDivPaste.bind(this));g(this,Ie,void 0);g(this,le,"");g(this,ml,`${this.id}-editor`);g(this,he,void 0);g(this,Ur,null);b(this,Ie,t.color||ot._defaultColor||et._defaultLineColor),b(this,he,t.fontSize||ot._defaultFontSize)}static get _keyboardManager(){const t=ot.prototype,s=r=>r.isEmpty(),i=Nn.TRANSLATE_SMALL,n=Nn.TRANSLATE_BIG;return Z(this,"_keyboardManager",new oh([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[n,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,n],checker:s}]]))}static initialize(t,s){et.initialize(t,s,{strings:["pdfjs-free-text-default-content"]});const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case j.FREETEXT_SIZE:ot._defaultFontSize=s;break;case j.FREETEXT_COLOR:ot._defaultColor=s;break}}updateParams(t,s){switch(t){case j.FREETEXT_SIZE:y(this,Xc,og).call(this,s);break;case j.FREETEXT_COLOR:y(this,Yc,lg).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[j.FREETEXT_SIZE,ot._defaultFontSize],[j.FREETEXT_COLOR,ot._defaultColor||et._defaultLineColor]]}get propertiesToUpdate(){return[[j.FREETEXT_SIZE,o(this,he)],[j.FREETEXT_COLOR,o(this,Ie)]]}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-ot._internalPadding*t,-(ot._internalPadding+o(this,he))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(J.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant");const t=this._uiManager._signal;this.editorDiv.addEventListener("keydown",o(this,pl),{signal:t}),this.editorDiv.addEventListener("focus",o(this,ul),{signal:t}),this.editorDiv.addEventListener("blur",o(this,dl),{signal:t}),this.editorDiv.addEventListener("input",o(this,fl),{signal:t}),this.editorDiv.addEventListener("paste",o(this,gl),{signal:t})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",o(this,ml)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",o(this,pl)),this.editorDiv.removeEventListener("focus",o(this,ul)),this.editorDiv.removeEventListener("blur",o(this,dl)),this.editorDiv.removeEventListener("input",o(this,fl)),this.editorDiv.removeEventListener("paste",o(this,gl)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var t;this.width||(this.enableEditMode(),this.editorDiv.focus(),(t=this._initialOptions)!=null&&t.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=o(this,le),s=b(this,le,y(this,Kc,hg).call(this).trimEnd());if(t===s)return;const i=n=>{if(b(this,le,n),!n){this.remove();return}y(this,zr,_h).call(this),this._uiManager.rebuild(this),y(this,jr,Mh).call(this)};this.addCommands({cmd:()=>{i(s)},undo:()=>{i(t)},mustExec:!1}),y(this,jr,Mh).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){ot._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,s;this.width&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",o(this,ml)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),et._l10nPromise.get("pdfjs-free-text-default-content").then(n=>{var r;return(r=this.editorDiv)==null?void 0:r.setAttribute("default-content",n)}),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${o(this,he)}px * var(--scale-factor))`,i.color=o(this,Ie),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),zh(this,this.div,["dblclick","keydown"]),this.width){const[n,r]=this.parentDimensions;if(this.annotationElementId){const{position:a}=o(this,Ur);let[l,h]=this.getInitialTranslation();[l,h]=this.pageTranslationToScreen(l,h);const[d,u]=this.pageDimensions,[f,p]=this.pageTranslation;let m,v;switch(this.rotation){case 0:m=t+(a[0]-f)/d,v=s+this.height-(a[1]-p)/u;break;case 90:m=t+(a[0]-f)/d,v=s-(a[1]-p)/u,[l,h]=[h,-l];break;case 180:m=t-this.width+(a[0]-f)/d,v=s-(a[1]-p)/u,[l,h]=[-l,-h];break;case 270:m=t+(a[0]-f-this.height*u)/d,v=s+(a[1]-p-this.width*d)/u,[l,h]=[-h,l];break}this.setAt(m*n,v*r,l,h)}else this.setAt(t*n,s*r,this.width*n,this.height*r);y(this,zr,_h).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var m,v,E;const s=t.clipboardData||window.clipboardData,{types:i}=s;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const n=y(m=ot,vl,zu).call(m,s.getData("text")||"").replaceAll(gh,`
`);if(!n)return;const r=window.getSelection();if(!r.rangeCount)return;this.editorDiv.normalize(),r.deleteFromDocument();const a=r.getRangeAt(0);if(!n.includes(`
`)){a.insertNode(document.createTextNode(n)),this.editorDiv.normalize(),r.collapseToStart();return}const{startContainer:l,startOffset:h}=a,d=[],u=[];if(l.nodeType===Node.TEXT_NODE){const A=l.parentElement;if(u.push(l.nodeValue.slice(h).replaceAll(gh,"")),A!==this.editorDiv){let w=d;for(const S of this.editorDiv.childNodes){if(S===A){w=u;continue}w.push(y(v=ot,$r,Lh).call(v,S))}}d.push(l.nodeValue.slice(0,h).replaceAll(gh,""))}else if(l===this.editorDiv){let A=d,w=0;for(const S of this.editorDiv.childNodes)w++===h&&(A=u),A.push(y(E=ot,$r,Lh).call(E,S))}b(this,le,`${d.join(`
`)}${n}${u.join(`
`)}`),y(this,zr,_h).call(this);const f=new Range;let p=d.reduce((A,w)=>A+w.length,0);for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const w=A.nodeValue.length;if(p<=w){f.setStart(A,p),f.setEnd(A,p);break}p-=w}r.removeAllRanges(),r.addRange(f)}get contentDiv(){return this.editorDiv}static deserialize(t,s,i){var a;let n=null;if(t instanceof sg){const{data:{defaultAppearanceData:{fontSize:l,fontColor:h},rect:d,rotation:u,id:f},textContent:p,textPosition:m,parent:{page:{pageNumber:v}}}=t;if(!p||p.length===0)return null;n=t={annotationType:J.FREETEXT,color:Array.from(h),fontSize:l,value:p.join(`
`),position:m,pageIndex:v-1,rect:d.slice(0),rotation:u,id:f,deleted:!1}}const r=super.deserialize(t,s,i);return b(r,he,t.fontSize),b(r,Ie,N.makeHexColor(...t.color)),b(r,le,y(a=ot,vl,zu).call(a,t.value)),r.annotationElementId=t.id||null,b(r,Ur,n),r}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const s=ot._internalPadding*this.parentScale,i=this.getRect(s,s),n=et._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:o(this,Ie)),r={annotationType:J.FREETEXT,color:n,fontSize:o(this,he),value:y(this,Qc,cg).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?r:this.annotationElementId&&!y(this,Jc,dg).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(this.deleted)return s;const{style:i}=s;i.fontSize=`calc(${o(this,he)}px * var(--scale-factor))`,i.color=o(this,Ie),s.replaceChildren();for(const r of o(this,le).split(`
`)){const a=document.createElement("div");a.append(r?document.createTextNode(r):document.createElement("br")),s.append(a)}const n=ot._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(n,n),popupContent:o(this,le)}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};dl=new WeakMap,ul=new WeakMap,fl=new WeakMap,pl=new WeakMap,gl=new WeakMap,Ie=new WeakMap,le=new WeakMap,ml=new WeakMap,he=new WeakMap,Ur=new WeakMap,Xc=new WeakSet,og=function(t){const s=n=>{this.editorDiv.style.fontSize=`calc(${n}px * var(--scale-factor))`,this.translate(0,-(n-o(this,he))*this.parentScale),b(this,he,n),y(this,jr,Mh).call(this)},i=o(this,he);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:j.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Yc=new WeakSet,lg=function(t){const s=n=>{b(this,Ie,this.editorDiv.style.color=n)},i=o(this,Ie);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:j.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Kc=new WeakSet,hg=function(){var s;const t=[];this.editorDiv.normalize();for(const i of this.editorDiv.childNodes)t.push(y(s=ot,$r,Lh).call(s,i));return t.join(`
`)},jr=new WeakSet,Mh=function(){const[t,s]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:n,div:r}=this,a=r.style.display,l=r.classList.contains("hidden");r.classList.remove("hidden"),r.style.display="hidden",n.div.append(this.div),i=r.getBoundingClientRect(),r.remove(),r.style.display=a,r.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/s):(this.width=i.height/t,this.height=i.width/s),this.fixAndSetPosition()},$r=new WeakSet,Lh=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(gh,"")},zr=new WeakSet,_h=function(){if(this.editorDiv.replaceChildren(),!!o(this,le))for(const t of o(this,le).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},Qc=new WeakSet,cg=function(){return o(this,le).replaceAll("Â "," ")},vl=new WeakSet,zu=function(t){return t.replaceAll(" ","Â ")},Jc=new WeakSet,dg=function(t){const{value:s,fontSize:i,color:n,pageIndex:r}=o(this,Ur);return this._hasBeenMoved||t.value!==s||t.fontSize!==i||t.color.some((a,l)=>a!==n[l])||t.pageIndex!==r},g(ot,$r),g(ot,vl),z(ot,"_freeTextDefaultContent",""),z(ot,"_internalPadding",0),z(ot,"_defaultColor",null),z(ot,"_defaultFontSize",10),z(ot,"_type","freetext"),z(ot,"_editorType",J.FREETEXT);let $u=ot;var bl,ai,Me,Zc,ug,Gr,Oh,qc,fg,td,pg,yl,Gu;class Yf{constructor(e,t=0,s=0,i=!0){g(this,Zc);g(this,Gr);g(this,qc);g(this,td);g(this,yl);g(this,bl,void 0);g(this,ai,[]);g(this,Me,[]);let n=1/0,r=-1/0,a=1/0,l=-1/0;const d=10**-4;for(const{x:A,y:w,width:S,height:C}of e){const x=Math.floor((A-t)/d)*d,T=Math.ceil((A+S+t)/d)*d,R=Math.floor((w-t)/d)*d,I=Math.ceil((w+C+t)/d)*d,P=[x,R,I,!0],O=[T,R,I,!1];o(this,ai).push(P,O),n=Math.min(n,x),r=Math.max(r,T),a=Math.min(a,R),l=Math.max(l,I)}const u=r-n+2*s,f=l-a+2*s,p=n-s,m=a-s,v=o(this,ai).at(i?-1:-2),E=[v[0],v[2]];for(const A of o(this,ai)){const[w,S,C]=A;A[0]=(w-p)/u,A[1]=(S-m)/f,A[2]=(C-m)/f}b(this,bl,{x:p,y:m,width:u,height:f,lastPoint:E})}getOutlines(){o(this,ai).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of o(this,ai))t[3]?(e.push(...y(this,yl,Gu).call(this,t)),y(this,qc,fg).call(this,t)):(y(this,td,pg).call(this,t),e.push(...y(this,yl,Gu).call(this,t)));return y(this,Zc,ug).call(this,e)}}bl=new WeakMap,ai=new WeakMap,Me=new WeakMap,Zc=new WeakSet,ug=function(e){const t=[],s=new Set;for(const r of e){const[a,l,h]=r;t.push([a,l,r],[a,h,r])}t.sort((r,a)=>r[1]-a[1]||r[0]-a[0]);for(let r=0,a=t.length;r<a;r+=2){const l=t[r][2],h=t[r+1][2];l.push(h),h.push(l),s.add(l),s.add(h)}const i=[];let n;for(;s.size>0;){const r=s.values().next().value;let[a,l,h,d,u]=r;s.delete(r);let f=a,p=l;for(n=[a,h],i.push(n);;){let m;if(s.has(d))m=d;else if(s.has(u))m=u;else break;s.delete(m),[a,l,h,d,u]=m,f!==a&&(n.push(f,p,a,p===l?l:h),f=a),p=p===l?h:l}n.push(f,p)}return new Vv(i,o(this,bl))},Gr=new WeakSet,Oh=function(e){const t=o(this,Me);let s=0,i=t.length-1;for(;s<=i;){const n=s+i>>1,r=t[n][0];if(r===e)return n;r<e?s=n+1:i=n-1}return i+1},qc=new WeakSet,fg=function([,e,t]){const s=y(this,Gr,Oh).call(this,e);o(this,Me).splice(s,0,[e,t])},td=new WeakSet,pg=function([,e,t]){const s=y(this,Gr,Oh).call(this,e);for(let i=s;i<o(this,Me).length;i++){const[n,r]=o(this,Me)[i];if(n!==e)break;if(n===e&&r===t){o(this,Me).splice(i,1);return}}for(let i=s-1;i>=0;i--){const[n,r]=o(this,Me)[i];if(n!==e)break;if(n===e&&r===t){o(this,Me).splice(i,1);return}}},yl=new WeakSet,Gu=function(e){const[t,s,i]=e,n=[[t,s,i]],r=y(this,Gr,Oh).call(this,i);for(let a=0;a<r;a++){const[l,h]=o(this,Me)[a];for(let d=0,u=n.length;d<u;d++){const[,f,p]=n[d];if(!(h<=f||p<=l)){if(f>=l){if(p>h)n[d][1]=h;else{if(u===1)return[];n.splice(d,1),d--,u--}continue}n[d][2]=l,p>h&&n.push([t,h,p])}}}return n};class gg{toSVGPath(){throw new Error("Abstract method `toSVGPath` must be implemented.")}get box(){throw new Error("Abstract getter `box` must be implemented.")}serialize(e,t){throw new Error("Abstract method `serialize` must be implemented.")}get free(){return this instanceof Wu}}var Al,Vr;class Vv extends gg{constructor(t,s){super();g(this,Al,void 0);g(this,Vr,void 0);b(this,Vr,t),b(this,Al,s)}toSVGPath(){const t=[];for(const s of o(this,Vr)){let[i,n]=s;t.push(`M${i} ${n}`);for(let r=2;r<s.length;r+=2){const a=s[r],l=s[r+1];a===i?(t.push(`V${l}`),n=l):l===n&&(t.push(`H${a}`),i=a)}t.push("Z")}return t.join(" ")}serialize([t,s,i,n],r){const a=[],l=i-t,h=n-s;for(const d of o(this,Vr)){const u=new Array(d.length);for(let f=0;f<d.length;f+=2)u[f]=t+d[f]*l,u[f+1]=n-d[f+1]*h;a.push(u)}return a}get box(){return o(this,Al)}}Al=new WeakMap,Vr=new WeakMap;var We,Ts,Wr,Xr,Xe,Q,fn,pn,El,wl,Yr,Kr,oi,Sl,ed,sd,xl,Vu;const as=class as{constructor({x:e,y:t},s,i,n,r,a=0){g(this,xl);g(this,We,void 0);g(this,Ts,[]);g(this,Wr,void 0);g(this,Xr,void 0);g(this,Xe,[]);g(this,Q,new Float64Array(18));g(this,fn,void 0);g(this,pn,void 0);g(this,El,void 0);g(this,wl,void 0);g(this,Yr,void 0);g(this,Kr,void 0);g(this,oi,[]);b(this,We,s),b(this,Kr,n*i),b(this,Xr,r),o(this,Q).set([NaN,NaN,NaN,NaN,e,t],6),b(this,Wr,a),b(this,wl,o(as,Sl)*i),b(this,El,o(as,sd)*i),b(this,Yr,i),o(this,oi).push(e,t)}get free(){return!0}isEmpty(){return isNaN(o(this,Q)[8])}add({x:e,y:t}){var P;b(this,fn,e),b(this,pn,t);const[s,i,n,r]=o(this,We);let[a,l,h,d]=o(this,Q).subarray(8,12);const u=e-h,f=t-d,p=Math.hypot(u,f);if(p<o(this,El))return!1;const m=p-o(this,wl),v=m/p,E=v*u,A=v*f;let w=a,S=l;a=h,l=d,h+=E,d+=A,(P=o(this,oi))==null||P.push(e,t);const C=-A/m,x=E/m,T=C*o(this,Kr),R=x*o(this,Kr);return o(this,Q).set(o(this,Q).subarray(2,8),0),o(this,Q).set([h+T,d+R],4),o(this,Q).set(o(this,Q).subarray(14,18),12),o(this,Q).set([h-T,d-R],16),isNaN(o(this,Q)[6])?(o(this,Xe).length===0&&(o(this,Q).set([a+T,l+R],2),o(this,Xe).push(NaN,NaN,NaN,NaN,(a+T-s)/n,(l+R-i)/r),o(this,Q).set([a-T,l-R],14),o(this,Ts).push(NaN,NaN,NaN,NaN,(a-T-s)/n,(l-R-i)/r)),o(this,Q).set([w,S,a,l,h,d],6),!this.isEmpty()):(o(this,Q).set([w,S,a,l,h,d],6),Math.abs(Math.atan2(S-l,w-a)-Math.atan2(A,E))<Math.PI/2?([a,l,h,d]=o(this,Q).subarray(2,6),o(this,Xe).push(NaN,NaN,NaN,NaN,((a+h)/2-s)/n,((l+d)/2-i)/r),[a,l,w,S]=o(this,Q).subarray(14,18),o(this,Ts).push(NaN,NaN,NaN,NaN,((w+a)/2-s)/n,((S+l)/2-i)/r),!0):([w,S,a,l,h,d]=o(this,Q).subarray(0,6),o(this,Xe).push(((w+5*a)/6-s)/n,((S+5*l)/6-i)/r,((5*a+h)/6-s)/n,((5*l+d)/6-i)/r,((a+h)/2-s)/n,((l+d)/2-i)/r),[h,d,a,l,w,S]=o(this,Q).subarray(12,18),o(this,Ts).push(((w+5*a)/6-s)/n,((S+5*l)/6-i)/r,((5*a+h)/6-s)/n,((5*l+d)/6-i)/r,((a+h)/2-s)/n,((l+d)/2-i)/r),!0))}toSVGPath(){if(this.isEmpty())return"";const e=o(this,Xe),t=o(this,Ts),s=o(this,Q).subarray(4,6),i=o(this,Q).subarray(16,18),[n,r,a,l]=o(this,We),[h,d,u,f]=y(this,xl,Vu).call(this);if(isNaN(o(this,Q)[6])&&!this.isEmpty())return`M${(o(this,Q)[2]-n)/a} ${(o(this,Q)[3]-r)/l} L${(o(this,Q)[4]-n)/a} ${(o(this,Q)[5]-r)/l} L${h} ${d} L${u} ${f} L${(o(this,Q)[16]-n)/a} ${(o(this,Q)[17]-r)/l} L${(o(this,Q)[14]-n)/a} ${(o(this,Q)[15]-r)/l} Z`;const p=[];p.push(`M${e[4]} ${e[5]}`);for(let m=6;m<e.length;m+=6)isNaN(e[m])?p.push(`L${e[m+4]} ${e[m+5]}`):p.push(`C${e[m]} ${e[m+1]} ${e[m+2]} ${e[m+3]} ${e[m+4]} ${e[m+5]}`);p.push(`L${(s[0]-n)/a} ${(s[1]-r)/l} L${h} ${d} L${u} ${f} L${(i[0]-n)/a} ${(i[1]-r)/l}`);for(let m=t.length-6;m>=6;m-=6)isNaN(t[m])?p.push(`L${t[m+4]} ${t[m+5]}`):p.push(`C${t[m]} ${t[m+1]} ${t[m+2]} ${t[m+3]} ${t[m+4]} ${t[m+5]}`);return p.push(`L${t[4]} ${t[5]} Z`),p.join(" ")}getOutlines(){var A;const e=o(this,Xe),t=o(this,Ts),s=o(this,Q),i=s.subarray(4,6),n=s.subarray(16,18),[r,a,l,h]=o(this,We),d=new Float64Array((((A=o(this,oi))==null?void 0:A.length)??0)+2);for(let w=0,S=d.length-2;w<S;w+=2)d[w]=(o(this,oi)[w]-r)/l,d[w+1]=(o(this,oi)[w+1]-a)/h;d[d.length-2]=(o(this,fn)-r)/l,d[d.length-1]=(o(this,pn)-a)/h;const[u,f,p,m]=y(this,xl,Vu).call(this);if(isNaN(s[6])&&!this.isEmpty()){const w=new Float64Array(36);return w.set([NaN,NaN,NaN,NaN,(s[2]-r)/l,(s[3]-a)/h,NaN,NaN,NaN,NaN,(s[4]-r)/l,(s[5]-a)/h,NaN,NaN,NaN,NaN,u,f,NaN,NaN,NaN,NaN,p,m,NaN,NaN,NaN,NaN,(s[16]-r)/l,(s[17]-a)/h,NaN,NaN,NaN,NaN,(s[14]-r)/l,(s[15]-a)/h],0),new Wu(w,d,o(this,We),o(this,Yr),o(this,Wr),o(this,Xr))}const v=new Float64Array(o(this,Xe).length+24+o(this,Ts).length);let E=e.length;for(let w=0;w<E;w+=2){if(isNaN(e[w])){v[w]=v[w+1]=NaN;continue}v[w]=e[w],v[w+1]=e[w+1]}v.set([NaN,NaN,NaN,NaN,(i[0]-r)/l,(i[1]-a)/h,NaN,NaN,NaN,NaN,u,f,NaN,NaN,NaN,NaN,p,m,NaN,NaN,NaN,NaN,(n[0]-r)/l,(n[1]-a)/h],E),E+=24;for(let w=t.length-6;w>=6;w-=6)for(let S=0;S<6;S+=2){if(isNaN(t[w+S])){v[E]=v[E+1]=NaN,E+=2;continue}v[E]=t[w+S],v[E+1]=t[w+S+1],E+=2}return v.set([NaN,NaN,NaN,NaN,t[4],t[5]],E),new Wu(v,d,o(this,We),o(this,Yr),o(this,Wr),o(this,Xr))}};We=new WeakMap,Ts=new WeakMap,Wr=new WeakMap,Xr=new WeakMap,Xe=new WeakMap,Q=new WeakMap,fn=new WeakMap,pn=new WeakMap,El=new WeakMap,wl=new WeakMap,Yr=new WeakMap,Kr=new WeakMap,oi=new WeakMap,Sl=new WeakMap,ed=new WeakMap,sd=new WeakMap,xl=new WeakSet,Vu=function(){const e=o(this,Q).subarray(4,6),t=o(this,Q).subarray(16,18),[s,i,n,r]=o(this,We);return[(o(this,fn)+(e[0]-t[0])/2-s)/n,(o(this,pn)+(e[1]-t[1])/2-i)/r,(o(this,fn)+(t[0]-e[0])/2-s)/n,(o(this,pn)+(t[1]-e[1])/2-i)/r]},g(as,Sl,8),g(as,ed,2),g(as,sd,o(as,Sl)+o(as,ed));let Wh=as;var Qr,gn,Cs,Tl,ce,Cl,mt,mn,Ra,vn,Pa,id,mg;class Wu extends gg{constructor(t,s,i,n,r,a){super();g(this,mn);g(this,vn);g(this,id);g(this,Qr,void 0);g(this,gn,null);g(this,Cs,void 0);g(this,Tl,void 0);g(this,ce,void 0);g(this,Cl,void 0);g(this,mt,void 0);b(this,mt,t),b(this,ce,s),b(this,Qr,i),b(this,Cl,n),b(this,Cs,r),b(this,Tl,a),y(this,id,mg).call(this,a);const{x:l,y:h,width:d,height:u}=o(this,gn);for(let f=0,p=t.length;f<p;f+=2)t[f]=(t[f]-l)/d,t[f+1]=(t[f+1]-h)/u;for(let f=0,p=s.length;f<p;f+=2)s[f]=(s[f]-l)/d,s[f+1]=(s[f+1]-h)/u}toSVGPath(){const t=[`M${o(this,mt)[4]} ${o(this,mt)[5]}`];for(let s=6,i=o(this,mt).length;s<i;s+=6){if(isNaN(o(this,mt)[s])){t.push(`L${o(this,mt)[s+4]} ${o(this,mt)[s+5]}`);continue}t.push(`C${o(this,mt)[s]} ${o(this,mt)[s+1]} ${o(this,mt)[s+2]} ${o(this,mt)[s+3]} ${o(this,mt)[s+4]} ${o(this,mt)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,i,n],r){const a=i-t,l=n-s;let h,d;switch(r){case 0:h=y(this,mn,Ra).call(this,o(this,mt),t,n,a,-l),d=y(this,mn,Ra).call(this,o(this,ce),t,n,a,-l);break;case 90:h=y(this,vn,Pa).call(this,o(this,mt),t,s,a,l),d=y(this,vn,Pa).call(this,o(this,ce),t,s,a,l);break;case 180:h=y(this,mn,Ra).call(this,o(this,mt),i,s,-a,l),d=y(this,mn,Ra).call(this,o(this,ce),i,s,-a,l);break;case 270:h=y(this,vn,Pa).call(this,o(this,mt),i,n,-a,-l),d=y(this,vn,Pa).call(this,o(this,ce),i,n,-a,-l);break}return{outline:Array.from(h),points:[Array.from(d)]}}get box(){return o(this,gn)}getNewOutline(t,s){const{x:i,y:n,width:r,height:a}=o(this,gn),[l,h,d,u]=o(this,Qr),f=r*d,p=a*u,m=i*d+l,v=n*u+h,E=new Wh({x:o(this,ce)[0]*f+m,y:o(this,ce)[1]*p+v},o(this,Qr),o(this,Cl),t,o(this,Tl),s??o(this,Cs));for(let A=2;A<o(this,ce).length;A+=2)E.add({x:o(this,ce)[A]*f+m,y:o(this,ce)[A+1]*p+v});return E.getOutlines()}}Qr=new WeakMap,gn=new WeakMap,Cs=new WeakMap,Tl=new WeakMap,ce=new WeakMap,Cl=new WeakMap,mt=new WeakMap,mn=new WeakSet,Ra=function(t,s,i,n,r){const a=new Float64Array(t.length);for(let l=0,h=t.length;l<h;l+=2)a[l]=s+t[l]*n,a[l+1]=i+t[l+1]*r;return a},vn=new WeakSet,Pa=function(t,s,i,n,r){const a=new Float64Array(t.length);for(let l=0,h=t.length;l<h;l+=2)a[l]=s+t[l+1]*n,a[l+1]=i+t[l]*r;return a},id=new WeakSet,mg=function(t){const s=o(this,mt);let i=s[4],n=s[5],r=i,a=n,l=i,h=n,d=i,u=n;const f=t?Math.max:Math.min;for(let A=6,w=s.length;A<w;A+=6){if(isNaN(s[A]))r=Math.min(r,s[A+4]),a=Math.min(a,s[A+5]),l=Math.max(l,s[A+4]),h=Math.max(h,s[A+5]),u<s[A+5]?(d=s[A+4],u=s[A+5]):u===s[A+5]&&(d=f(d,s[A+4]));else{const S=N.bezierBoundingBox(i,n,...s.slice(A,A+6));r=Math.min(r,S[0]),a=Math.min(a,S[1]),l=Math.max(l,S[2]),h=Math.max(h,S[3]),u<S[3]?(d=S[2],u=S[3]):u===S[3]&&(d=f(d,S[2]))}i=s[A+4],n=s[A+5]}const p=r-o(this,Cs),m=a-o(this,Cs),v=l-r+2*o(this,Cs),E=h-a+2*o(this,Cs);b(this,gn,{x:p,y:m,width:v,height:E,lastPoint:[d,u]})};var Rl,Pl,Le,bn,Jr,wt,Il,Zr,Ml,Ll,_e,qr,_l,Xu,Ol,Yu,nd,vg,Rs,Ei,rd,bg,Ye,js;const os=class os{constructor({editor:e=null,uiManager:t=null}){g(this,_l);g(this,Ol);g(this,nd);g(this,Rs);g(this,rd);g(this,Ye);g(this,Rl,y(this,nd,vg).bind(this));g(this,Pl,y(this,rd,bg).bind(this));g(this,Le,null);g(this,bn,null);g(this,Jr,void 0);g(this,wt,null);g(this,Il,!1);g(this,Zr,!1);g(this,Ml,null);g(this,Ll,void 0);g(this,_e,null);g(this,qr,void 0);var s;e?(b(this,Zr,!1),b(this,qr,j.HIGHLIGHT_COLOR),b(this,Ml,e)):(b(this,Zr,!0),b(this,qr,j.HIGHLIGHT_DEFAULT_COLOR)),b(this,_e,(e==null?void 0:e._uiManager)||t),b(this,Ll,o(this,_e)._eventBus),b(this,Jr,(e==null?void 0:e.color)||((s=o(this,_e))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98")}static get _keyboardManager(){return Z(this,"_keyboardManager",new oh([[["Escape","mac+Escape"],os.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],os.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],os.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],os.prototype._moveToPrevious],[["Home","mac+Home"],os.prototype._moveToBeginning],[["End","mac+End"],os.prototype._moveToEnd]]))}renderButton(){const e=b(this,Le,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=o(this,_e)._signal;e.addEventListener("click",y(this,Rs,Ei).bind(this),{signal:t}),e.addEventListener("keydown",o(this,Rl),{signal:t});const s=b(this,bn,document.createElement("span"));return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=o(this,Jr),e.append(s),e}renderMainDropdown(){const e=b(this,wt,y(this,_l,Xu).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===o(this,Le)){y(this,Rs,Ei).call(this,e);return}const t=e.target.getAttribute("data-color");t&&y(this,Ol,Yu).call(this,t,e)}_moveToNext(e){var t,s;if(!o(this,Ye,js)){y(this,Rs,Ei).call(this,e);return}if(e.target===o(this,Le)){(t=o(this,wt).firstChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=o(this,wt))==null?void 0:t.firstChild)||e.target===o(this,Le)){o(this,Ye,js)&&this._hideDropdownFromKeyboard();return}o(this,Ye,js)||y(this,Rs,Ei).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!o(this,Ye,js)){y(this,Rs,Ei).call(this,e);return}(t=o(this,wt).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!o(this,Ye,js)){y(this,Rs,Ei).call(this,e);return}(t=o(this,wt).lastChild)==null||t.focus()}hideDropdown(){var e;(e=o(this,wt))==null||e.classList.add("hidden"),window.removeEventListener("pointerdown",o(this,Pl))}_hideDropdownFromKeyboard(){var e;if(!o(this,Zr)){if(!o(this,Ye,js)){(e=o(this,Ml))==null||e.unselect();return}this.hideDropdown(),o(this,Le).focus({preventScroll:!0,focusVisible:o(this,Il)})}}updateColor(e){if(o(this,bn)&&(o(this,bn).style.backgroundColor=e),!o(this,wt))return;const t=o(this,_e).highlightColors.values();for(const s of o(this,wt).children)s.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=o(this,Le))==null||e.remove(),b(this,Le,null),b(this,bn,null),(t=o(this,wt))==null||t.remove(),b(this,wt,null)}};Rl=new WeakMap,Pl=new WeakMap,Le=new WeakMap,bn=new WeakMap,Jr=new WeakMap,wt=new WeakMap,Il=new WeakMap,Zr=new WeakMap,Ml=new WeakMap,Ll=new WeakMap,_e=new WeakMap,qr=new WeakMap,_l=new WeakSet,Xu=function(){const e=document.createElement("div"),t=o(this,_e)._signal;e.addEventListener("contextmenu",ee,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,i]of o(this,_e).highlightColors){const n=document.createElement("button");n.tabIndex="0",n.role="option",n.setAttribute("data-color",i),n.title=s,n.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${s}`);const r=document.createElement("span");n.append(r),r.className="swatch",r.style.backgroundColor=i,n.setAttribute("aria-selected",i===o(this,Jr)),n.addEventListener("click",y(this,Ol,Yu).bind(this,i),{signal:t}),e.append(n)}return e.addEventListener("keydown",o(this,Rl),{signal:t}),e},Ol=new WeakSet,Yu=function(e,t){t.stopPropagation(),o(this,Ll).dispatch("switchannotationeditorparams",{source:this,type:o(this,qr),value:e})},nd=new WeakSet,vg=function(e){os._keyboardManager.exec(this,e)},Rs=new WeakSet,Ei=function(e){if(o(this,Ye,js)){this.hideDropdown();return}if(b(this,Il,e.detail===0),window.addEventListener("pointerdown",o(this,Pl),{signal:o(this,_e)._signal}),o(this,wt)){o(this,wt).classList.remove("hidden");return}const t=b(this,wt,y(this,_l,Xu).call(this));o(this,Le).append(t)},rd=new WeakSet,bg=function(e){var t;(t=o(this,wt))!=null&&t.contains(e.target)||this.hideDropdown()},Ye=new WeakSet,js=function(){return o(this,wt)&&!o(this,wt).classList.contains("hidden")};let Xh=os;var ta,Dl,li,yn,ea,be,Fl,kl,An,Oe,Yt,de,ad,sa,En,St,ia,Ke,Nl,Bl,Ku,Hl,Qu,od,yg,ld,Ag,hd,Eg,Ul,Ju,wn,Ia,hi,Yn,cd,wg,na,Dh,Sn,Ma,dd,Sg,ud,xg,fd,Tg,pd,Cg;const q=class q extends et{constructor(t){super({...t,name:"highlightEditor"});g(this,Bl);g(this,Hl);g(this,od);g(this,ld);g(this,hd);g(this,Ul);g(this,wn);g(this,cd);g(this,na);g(this,Sn);g(this,dd);g(this,ud);g(this,ta,null);g(this,Dl,0);g(this,li,void 0);g(this,yn,null);g(this,ea,null);g(this,be,null);g(this,Fl,null);g(this,kl,0);g(this,An,null);g(this,Oe,null);g(this,Yt,null);g(this,de,!1);g(this,ad,y(this,cd,wg).bind(this));g(this,sa,null);g(this,En,void 0);g(this,St,null);g(this,ia,"");g(this,Ke,void 0);g(this,Nl,"");this.color=t.color||q._defaultColor,b(this,Ke,t.thickness||q._defaultThickness),b(this,En,t.opacity||q._defaultOpacity),b(this,li,t.boxes||null),b(this,Nl,t.methodOfCreation||""),b(this,ia,t.text||""),this._isDraggable=!1,t.highlightId>-1?(b(this,de,!0),y(this,Hl,Qu).call(this,t),y(this,wn,Ia).call(this)):(b(this,ta,t.anchorNode),b(this,Dl,t.anchorOffset),b(this,Fl,t.focusNode),b(this,kl,t.focusOffset),y(this,Bl,Ku).call(this),y(this,wn,Ia).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=q.prototype;return Z(this,"_keyboardManager",new oh([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:o(this,de)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:o(this,Ke),methodOfCreation:o(this,Nl)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var i;et.initialize(t,s),q._defaultColor||(q._defaultColor=((i=s.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case j.HIGHLIGHT_DEFAULT_COLOR:q._defaultColor=s;break;case j.HIGHLIGHT_THICKNESS:q._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return o(this,sa)}updateParams(t,s){switch(t){case j.HIGHLIGHT_COLOR:y(this,od,yg).call(this,s);break;case j.HIGHLIGHT_THICKNESS:y(this,ld,Ag).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[j.HIGHLIGHT_DEFAULT_COLOR,q._defaultColor],[j.HIGHLIGHT_THICKNESS,q._defaultThickness]]}get propertiesToUpdate(){return[[j.HIGHLIGHT_COLOR,this.color||q._defaultColor],[j.HIGHLIGHT_THICKNESS,o(this,Ke)||q._defaultThickness],[j.HIGHLIGHT_FREE,o(this,de)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(b(this,ea,new Xh({editor:this})),t.addColorPicker(o(this,ea))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(y(this,Sn,Ma).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,y(this,Sn,Ma).call(this))}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){y(this,Ul,Ju).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(y(this,wn,Ia).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?y(this,Ul,Ju).call(this):t&&(y(this,wn,Ia).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var n,r,a;const{drawLayer:s}=this.parent;let i;o(this,de)?(t=(t-this.rotation+360)%360,i=y(n=q,hi,Yn).call(n,o(this,Oe).box,t)):i=y(r=q,hi,Yn).call(r,this,t),s.rotate(o(this,Yt),t),s.rotate(o(this,St),t),s.updateBox(o(this,Yt),i),s.updateBox(o(this,St),y(a=q,hi,Yn).call(a,o(this,be).box,t))}render(){if(this.div)return this.div;const t=super.render();o(this,ia)&&(t.setAttribute("aria-label",o(this,ia)),t.setAttribute("role","mark")),o(this,de)?t.classList.add("free"):this.div.addEventListener("keydown",o(this,ad),{signal:this._uiManager._signal});const s=b(this,An,document.createElement("div"));t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=o(this,yn);const[i,n]=this.parentDimensions;return this.setDims(this.width*i,this.height*n),zh(this,o(this,An),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.parent.drawLayer.addClass(o(this,St),"hovered")}pointerleave(){this.parent.drawLayer.removeClass(o(this,St),"hovered")}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:y(this,na,Dh).call(this,!0);break;case 1:case 3:y(this,na,Dh).call(this,!1);break}}select(){var t,s;super.select(),o(this,St)&&((t=this.parent)==null||t.drawLayer.removeClass(o(this,St),"hovered"),(s=this.parent)==null||s.drawLayer.addClass(o(this,St),"selected"))}unselect(){var t;super.unselect(),o(this,St)&&((t=this.parent)==null||t.drawLayer.removeClass(o(this,St),"selected"),o(this,de)||y(this,na,Dh).call(this,!1))}get _mustFixPosition(){return!o(this,de)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.show(o(this,Yt),t),this.parent.drawLayer.show(o(this,St),t))}static startHighlighting(t,s,{target:i,x:n,y:r}){const{x:a,y:l,width:h,height:d}=i.getBoundingClientRect(),u=E=>{y(this,fd,Tg).call(this,t,E)},f=t._signal,p={capture:!0,passive:!1,signal:f},m=E=>{E.preventDefault(),E.stopPropagation()},v=E=>{i.removeEventListener("pointermove",u),window.removeEventListener("blur",v),window.removeEventListener("pointerup",v),window.removeEventListener("pointerdown",m,p),window.removeEventListener("contextmenu",ee),y(this,pd,Cg).call(this,t,E)};window.addEventListener("blur",v,{signal:f}),window.addEventListener("pointerup",v,{signal:f}),window.addEventListener("pointerdown",m,p),window.addEventListener("contextmenu",ee,{signal:f}),i.addEventListener("pointermove",u,{signal:f}),this._freeHighlight=new Wh({x:n,y:r},[a,l,h,d],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.highlight(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static deserialize(t,s,i){var v;const n=super.deserialize(t,s,i),{rect:[r,a,l,h],color:d,quadPoints:u}=t;n.color=N.makeHexColor(...d),b(n,En,t.opacity);const[f,p]=n.pageDimensions;n.width=(l-r)/f,n.height=(h-a)/p;const m=b(n,li,[]);for(let E=0;E<u.length;E+=8)m.push({x:(u[4]-l)/f,y:(h-(1-u[E+5]))/p,width:(u[E+2]-u[E])/f,height:(u[E+5]-u[E+1])/p});return y(v=n,Bl,Ku).call(v),n}serialize(t=!1){if(this.isEmpty()||t)return null;const s=this.getRect(0,0),i=et._colorManager.convert(this.color);return{annotationType:J.HIGHLIGHT,color:i,opacity:o(this,En),thickness:o(this,Ke),quadPoints:y(this,dd,Sg).call(this),outlines:y(this,ud,xg).call(this,s),pageIndex:this.pageIndex,rect:s,rotation:y(this,Sn,Ma).call(this),structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}};ta=new WeakMap,Dl=new WeakMap,li=new WeakMap,yn=new WeakMap,ea=new WeakMap,be=new WeakMap,Fl=new WeakMap,kl=new WeakMap,An=new WeakMap,Oe=new WeakMap,Yt=new WeakMap,de=new WeakMap,ad=new WeakMap,sa=new WeakMap,En=new WeakMap,St=new WeakMap,ia=new WeakMap,Ke=new WeakMap,Nl=new WeakMap,Bl=new WeakSet,Ku=function(){const t=new Yf(o(this,li),.001);b(this,Oe,t.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=o(this,Oe).box;const s=new Yf(o(this,li),.0025,.001,this._uiManager.direction==="ltr");b(this,be,s.getOutlines());const{lastPoint:i}=o(this,be).box;b(this,sa,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},Hl=new WeakSet,Qu=function({highlightOutlines:t,highlightId:s,clipPathId:i}){var u,f;b(this,Oe,t);const n=1.5;if(b(this,be,t.getNewOutline(o(this,Ke)/2+n,.0025)),s>=0)b(this,Yt,s),b(this,yn,i),this.parent.drawLayer.finalizeLine(s,t),b(this,St,this.parent.drawLayer.highlightOutline(o(this,be)));else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(o(this,Yt),t),this.parent.drawLayer.updateBox(o(this,Yt),y(u=q,hi,Yn).call(u,o(this,Oe).box,(p-this.rotation+360)%360)),this.parent.drawLayer.updateLine(o(this,St),o(this,be)),this.parent.drawLayer.updateBox(o(this,St),y(f=q,hi,Yn).call(f,o(this,be).box,p))}const{x:r,y:a,width:l,height:h}=t.box;switch(this.rotation){case 0:this.x=r,this.y=a,this.width=l,this.height=h;break;case 90:{const[p,m]=this.parentDimensions;this.x=a,this.y=1-r,this.width=l*m/p,this.height=h*p/m;break}case 180:this.x=1-r,this.y=1-a,this.width=l,this.height=h;break;case 270:{const[p,m]=this.parentDimensions;this.x=1-a,this.y=r,this.width=l*m/p,this.height=h*p/m;break}}const{lastPoint:d}=o(this,be).box;b(this,sa,[(d[0]-r)/l,(d[1]-a)/h])},od=new WeakSet,yg=function(t){const s=n=>{var r,a;this.color=n,(r=this.parent)==null||r.drawLayer.changeColor(o(this,Yt),n),(a=o(this,ea))==null||a.updateColor(n)},i=this.color;this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:j.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},ld=new WeakSet,Ag=function(t){const s=o(this,Ke),i=n=>{b(this,Ke,n),y(this,hd,Eg).call(this,n)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:j.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},hd=new WeakSet,Eg=function(t){if(!o(this,de))return;y(this,Hl,Qu).call(this,{highlightOutlines:o(this,Oe).getNewOutline(t/2)}),this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)},Ul=new WeakSet,Ju=function(){o(this,Yt)===null||!this.parent||(this.parent.drawLayer.remove(o(this,Yt)),b(this,Yt,null),this.parent.drawLayer.remove(o(this,St)),b(this,St,null))},wn=new WeakSet,Ia=function(t=this.parent){o(this,Yt)===null&&({id:se(this,Yt)._,clipPathId:se(this,yn)._}=t.drawLayer.highlight(o(this,Oe),this.color,o(this,En)),b(this,St,t.drawLayer.highlightOutline(o(this,be))),o(this,An)&&(o(this,An).style.clipPath=o(this,yn)))},hi=new WeakSet,Yn=function({x:t,y:s,width:i,height:n},r){switch(r){case 90:return{x:1-s-n,y:t,width:n,height:i};case 180:return{x:1-t-i,y:1-s-n,width:i,height:n};case 270:return{x:s,y:1-t-i,width:n,height:i}}return{x:t,y:s,width:i,height:n}},cd=new WeakSet,wg=function(t){q._keyboardManager.exec(this,t)},na=new WeakSet,Dh=function(t){if(!o(this,ta))return;const s=window.getSelection();t?s.setPosition(o(this,ta),o(this,Dl)):s.setPosition(o(this,Fl),o(this,kl))},Sn=new WeakSet,Ma=function(){return o(this,de)?this.rotation:0},dd=new WeakSet,Sg=function(){if(o(this,de))return null;const[t,s]=this.pageDimensions,[i,n]=this.pageTranslation,r=o(this,li),a=new Float32Array(r.length*8);let l=0;for(const{x:h,y:d,width:u,height:f}of r){const p=h*t+i,m=(1-d-f)*s+n;a[l]=a[l+4]=p,a[l+1]=a[l+3]=m,a[l+2]=a[l+6]=p+u*t,a[l+5]=a[l+7]=m+f*s,l+=8}return a},ud=new WeakSet,xg=function(t){return o(this,Oe).serialize(t,y(this,Sn,Ma).call(this))},fd=new WeakSet,Tg=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},pd=new WeakSet,Cg=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.removeFreeHighlight(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},g(q,hi),g(q,fd),g(q,pd),z(q,"_defaultColor",null),z(q,"_defaultOpacity",1),z(q,"_defaultThickness",12),z(q,"_l10nPromise"),z(q,"_type","highlight"),z(q,"_editorType",J.HIGHLIGHT),z(q,"_freeHighlightId",-1),z(q,"_freeHighlight",null),z(q,"_freeHighlightClipId","");let Yh=q;var xn,Tn,jl,$l,zl,Cn,Qe,Ps,ye,Rn,Pn,Is,In,Mn,ci,gd,Rg,md,Pg,vd,Ig,bd,Mg,Gl,qu,yd,Lg,Vl,tf,Ad,_g,Ed,Og,wd,Dg,Sd,Fg,xd,kg,Ms,wi,Wl,ef,ra,Fh,aa,kh,di,Kn,Xl,sf,oa,Nh,Td,Ng,Yl,nf,Cd,Bg,Rd,Hg,Kl,rf,la,Bh,Ln,La;const dt=class dt extends et{constructor(t){super({...t,name:"inkEditor"});g(this,gd);g(this,md);g(this,vd);g(this,bd);g(this,Gl);g(this,yd);g(this,Vl);g(this,Ad);g(this,Ed);g(this,wd);g(this,Sd);g(this,xd);g(this,Ms);g(this,Wl);g(this,ra);g(this,aa);g(this,di);g(this,Xl);g(this,oa);g(this,Rd);g(this,Kl);g(this,la);g(this,Ln);g(this,xn,0);g(this,Tn,0);g(this,jl,this.canvasPointermove.bind(this));g(this,$l,this.canvasPointerleave.bind(this));g(this,zl,this.canvasPointerup.bind(this));g(this,Cn,this.canvasPointerdown.bind(this));g(this,Qe,null);g(this,Ps,new Path2D);g(this,ye,!1);g(this,Rn,!1);g(this,Pn,!1);g(this,Is,null);g(this,In,0);g(this,Mn,0);g(this,ci,null);this.color=t.color||null,this.thickness=t.thickness||null,this.opacity=t.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(t,s){et.initialize(t,s)}static updateDefaultParams(t,s){switch(t){case j.INK_THICKNESS:dt._defaultThickness=s;break;case j.INK_COLOR:dt._defaultColor=s;break;case j.INK_OPACITY:dt._defaultOpacity=s/100;break}}updateParams(t,s){switch(t){case j.INK_THICKNESS:y(this,gd,Rg).call(this,s);break;case j.INK_COLOR:y(this,md,Pg).call(this,s);break;case j.INK_OPACITY:y(this,vd,Ig).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[j.INK_THICKNESS,dt._defaultThickness],[j.INK_COLOR,dt._defaultColor||et._defaultLineColor],[j.INK_OPACITY,Math.round(dt._defaultOpacity*100)]]}get propertiesToUpdate(){return[[j.INK_THICKNESS,this.thickness||dt._defaultThickness],[j.INK_COLOR,this.color||dt._defaultColor||et._defaultLineColor],[j.INK_OPACITY,Math.round(100*(this.opacity??dt._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(y(this,ra,Fh).call(this),y(this,aa,kh).call(this)),this.isAttachedToDOM||(this.parent.add(this),y(this,di,Kn).call(this)),y(this,Ln,La).call(this)))}remove(){var t;this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,o(this,Qe)&&(clearTimeout(o(this,Qe)),b(this,Qe,null)),(t=o(this,Is))==null||t.disconnect(),b(this,Is,null),super.remove())}setParent(t){!this.parent&&t?this._uiManager.removeShouldRescale(this):this.parent&&t===null&&this._uiManager.addShouldRescale(this),super.setParent(t)}onScaleChanging(){const[t,s]=this.parentDimensions,i=this.width*t,n=this.height*s;this.setDimensions(i,n)}enableEditMode(){o(this,ye)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",o(this,Cn),{signal:this._uiManager._signal}))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",o(this,Cn)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){o(this,ye)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),b(this,ye,!0),this.div.classList.add("disabled"),y(this,Ln,La).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),this.enableEditMode())}canvasPointerdown(t){t.button!==0||!this.isInEditMode()||o(this,ye)||(this.setInForeground(),t.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),y(this,yd,Lg).call(this,t.offsetX,t.offsetY))}canvasPointermove(t){t.preventDefault(),y(this,Vl,tf).call(this,t.offsetX,t.offsetY)}canvasPointerup(t){t.preventDefault(),y(this,Wl,ef).call(this,t)}canvasPointerleave(t){y(this,Wl,ef).call(this,t)}get isResizable(){return!this.isEmpty()&&o(this,ye)}render(){if(this.div)return this.div;let t,s;this.width&&(t=this.x,s=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[i,n,r,a]=y(this,bd,Mg).call(this);if(this.setAt(i,n,0,0),this.setDims(r,a),y(this,ra,Fh).call(this),this.width){const[l,h]=this.parentDimensions;this.setAspectRatio(this.width*l,this.height*h),this.setAt(t*l,s*h,this.width*l,this.height*h),b(this,Pn,!0),y(this,di,Kn).call(this),this.setDims(this.width*l,this.height*h),y(this,Ms,wi).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return y(this,aa,kh).call(this),this.div}setDimensions(t,s){const i=Math.round(t),n=Math.round(s);if(o(this,In)===i&&o(this,Mn)===n)return;b(this,In,i),b(this,Mn,n),this.canvas.style.visibility="hidden";const[r,a]=this.parentDimensions;this.width=t/r,this.height=s/a,this.fixAndSetPosition(),o(this,ye)&&y(this,Xl,sf).call(this,t,s),y(this,di,Kn).call(this),y(this,Ms,wi).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(t,s,i){var E,A,w;if(t instanceof ng)return null;const n=super.deserialize(t,s,i);n.thickness=t.thickness,n.color=N.makeHexColor(...t.color),n.opacity=t.opacity;const[r,a]=n.pageDimensions,l=n.width*r,h=n.height*a,d=n.parentScale,u=t.thickness/2;b(n,ye,!0),b(n,In,Math.round(l)),b(n,Mn,Math.round(h));const{paths:f,rect:p,rotation:m}=t;for(let{bezier:S}of f){S=y(E=dt,Cd,Bg).call(E,S,p,m);const C=[];n.paths.push(C);let x=d*(S[0]-u),T=d*(S[1]-u);for(let I=2,P=S.length;I<P;I+=6){const O=d*(S[I]-u),L=d*(S[I+1]-u),W=d*(S[I+2]-u),H=d*(S[I+3]-u),X=d*(S[I+4]-u),Y=d*(S[I+5]-u);C.push([[x,T],[O,L],[W,H],[X,Y]]),x=X,T=Y}const R=y(this,Td,Ng).call(this,C);n.bezierPath2D.push(R)}const v=y(A=n,Kl,rf).call(A);return b(n,Tn,Math.max(et.MIN_SIZE,v[2]-v[0])),b(n,xn,Math.max(et.MIN_SIZE,v[3]-v[1])),y(w=n,Xl,sf).call(w,l,h),n}serialize(){if(this.isEmpty())return null;const t=this.getRect(0,0),s=et._colorManager.convert(this.ctx.strokeStyle);return{annotationType:J.INK,color:s,thickness:this.thickness,opacity:this.opacity,paths:y(this,Rd,Hg).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,t),pageIndex:this.pageIndex,rect:t,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};xn=new WeakMap,Tn=new WeakMap,jl=new WeakMap,$l=new WeakMap,zl=new WeakMap,Cn=new WeakMap,Qe=new WeakMap,Ps=new WeakMap,ye=new WeakMap,Rn=new WeakMap,Pn=new WeakMap,Is=new WeakMap,In=new WeakMap,Mn=new WeakMap,ci=new WeakMap,gd=new WeakSet,Rg=function(t){const s=n=>{this.thickness=n,y(this,Ln,La).call(this)},i=this.thickness;this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:j.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},md=new WeakSet,Pg=function(t){const s=n=>{this.color=n,y(this,Ms,wi).call(this)},i=this.color;this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:j.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},vd=new WeakSet,Ig=function(t){const s=n=>{this.opacity=n,y(this,Ms,wi).call(this)};t/=100;const i=this.opacity;this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:j.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},bd=new WeakSet,Mg=function(){const{parentRotation:t,parentDimensions:[s,i]}=this;switch(t){case 90:return[0,i,i,s];case 180:return[s,i,s,i];case 270:return[s,0,i,s];default:return[0,0,s,i]}},Gl=new WeakSet,qu=function(){const{ctx:t,color:s,opacity:i,thickness:n,parentScale:r,scaleFactor:a}=this;t.lineWidth=n*r/a,t.lineCap="round",t.lineJoin="round",t.miterLimit=10,t.strokeStyle=`${s}${vm(i)}`},yd=new WeakSet,Lg=function(t,s){const i=this._uiManager._signal;this.canvas.addEventListener("contextmenu",ee,{signal:i}),this.canvas.addEventListener("pointerleave",o(this,$l),{signal:i}),this.canvas.addEventListener("pointermove",o(this,jl),{signal:i}),this.canvas.addEventListener("pointerup",o(this,zl),{signal:i}),this.canvas.removeEventListener("pointerdown",o(this,Cn)),this.isEditing=!0,o(this,Pn)||(b(this,Pn,!0),y(this,di,Kn).call(this),this.thickness||(this.thickness=dt._defaultThickness),this.color||(this.color=dt._defaultColor||et._defaultLineColor),this.opacity??(this.opacity=dt._defaultOpacity)),this.currentPath.push([t,s]),b(this,Rn,!1),y(this,Gl,qu).call(this),b(this,ci,()=>{y(this,wd,Dg).call(this),o(this,ci)&&window.requestAnimationFrame(o(this,ci))}),window.requestAnimationFrame(o(this,ci))},Vl=new WeakSet,tf=function(t,s){const[i,n]=this.currentPath.at(-1);if(this.currentPath.length>1&&t===i&&s===n)return;const r=this.currentPath;let a=o(this,Ps);if(r.push([t,s]),b(this,Rn,!0),r.length<=2){a.moveTo(...r[0]),a.lineTo(t,s);return}r.length===3&&(b(this,Ps,a=new Path2D),a.moveTo(...r[0])),y(this,Sd,Fg).call(this,a,...r.at(-3),...r.at(-2),t,s)},Ad=new WeakSet,_g=function(){if(this.currentPath.length===0)return;const t=this.currentPath.at(-1);o(this,Ps).lineTo(...t)},Ed=new WeakSet,Og=function(t,s){b(this,ci,null),t=Math.min(Math.max(t,0),this.canvas.width),s=Math.min(Math.max(s,0),this.canvas.height),y(this,Vl,tf).call(this,t,s),y(this,Ad,_g).call(this);let i;if(this.currentPath.length!==1)i=y(this,xd,kg).call(this);else{const h=[t,s];i=[[h,h.slice(),h.slice(),h]]}const n=o(this,Ps),r=this.currentPath;this.currentPath=[],b(this,Ps,new Path2D);const a=()=>{this.allRawPaths.push(r),this.paths.push(i),this.bezierPath2D.push(n),this._uiManager.rebuild(this)},l=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(y(this,ra,Fh).call(this),y(this,aa,kh).call(this)),y(this,Ln,La).call(this))};this.addCommands({cmd:a,undo:l,mustExec:!0})},wd=new WeakSet,Dg=function(){if(!o(this,Rn))return;b(this,Rn,!1);const t=Math.ceil(this.thickness*this.parentScale),s=this.currentPath.slice(-3),i=s.map(a=>a[0]),n=s.map(a=>a[1]);Math.min(...i)-t,Math.max(...i)+t,Math.min(...n)-t,Math.max(...n)+t;const{ctx:r}=this;r.save(),r.clearRect(0,0,this.canvas.width,this.canvas.height);for(const a of this.bezierPath2D)r.stroke(a);r.stroke(o(this,Ps)),r.restore()},Sd=new WeakSet,Fg=function(t,s,i,n,r,a,l){const h=(s+n)/2,d=(i+r)/2,u=(n+a)/2,f=(r+l)/2;t.bezierCurveTo(h+2*(n-h)/3,d+2*(r-d)/3,u+2*(n-u)/3,f+2*(r-f)/3,u,f)},xd=new WeakSet,kg=function(){const t=this.currentPath;if(t.length<=2)return[[t[0],t[0],t.at(-1),t.at(-1)]];const s=[];let i,[n,r]=t[0];for(i=1;i<t.length-2;i++){const[p,m]=t[i],[v,E]=t[i+1],A=(p+v)/2,w=(m+E)/2,S=[n+2*(p-n)/3,r+2*(m-r)/3],C=[A+2*(p-A)/3,w+2*(m-w)/3];s.push([[n,r],S,C,[A,w]]),[n,r]=[A,w]}const[a,l]=t[i],[h,d]=t[i+1],u=[n+2*(a-n)/3,r+2*(l-r)/3],f=[h+2*(a-h)/3,d+2*(l-d)/3];return s.push([[n,r],u,f,[h,d]]),s},Ms=new WeakSet,wi=function(){if(this.isEmpty()){y(this,oa,Nh).call(this);return}y(this,Gl,qu).call(this);const{canvas:t,ctx:s}=this;s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,t.width,t.height),y(this,oa,Nh).call(this);for(const i of this.bezierPath2D)s.stroke(i)},Wl=new WeakSet,ef=function(t){this.canvas.removeEventListener("pointerleave",o(this,$l)),this.canvas.removeEventListener("pointermove",o(this,jl)),this.canvas.removeEventListener("pointerup",o(this,zl)),this.canvas.addEventListener("pointerdown",o(this,Cn),{signal:this._uiManager._signal}),o(this,Qe)&&clearTimeout(o(this,Qe)),b(this,Qe,setTimeout(()=>{b(this,Qe,null),this.canvas.removeEventListener("contextmenu",ee)},10)),y(this,Ed,Og).call(this,t.offsetX,t.offsetY),this.addToAnnotationStorage(),this.setInBackground()},ra=new WeakSet,Fh=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},aa=new WeakSet,kh=function(){b(this,Is,new ResizeObserver(t=>{const s=t[0].contentRect;s.width&&s.height&&this.setDimensions(s.width,s.height)})),o(this,Is).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{var t;(t=o(this,Is))==null||t.disconnect(),b(this,Is,null)},{once:!0})},di=new WeakSet,Kn=function(){if(!o(this,Pn))return;const[t,s]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*t),this.canvas.height=Math.ceil(this.height*s),y(this,oa,Nh).call(this)},Xl=new WeakSet,sf=function(t,s){const i=y(this,la,Bh).call(this),n=(t-i)/o(this,Tn),r=(s-i)/o(this,xn);this.scaleFactor=Math.min(n,r)},oa=new WeakSet,Nh=function(){const t=y(this,la,Bh).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+t,this.translationY*this.scaleFactor+t)},Td=new WeakSet,Ng=function(t){const s=new Path2D;for(let i=0,n=t.length;i<n;i++){const[r,a,l,h]=t[i];i===0&&s.moveTo(...r),s.bezierCurveTo(a[0],a[1],l[0],l[1],h[0],h[1])}return s},Yl=new WeakSet,nf=function(t,s,i){const[n,r,a,l]=s;switch(i){case 0:for(let h=0,d=t.length;h<d;h+=2)t[h]+=n,t[h+1]=l-t[h+1];break;case 90:for(let h=0,d=t.length;h<d;h+=2){const u=t[h];t[h]=t[h+1]+n,t[h+1]=u+r}break;case 180:for(let h=0,d=t.length;h<d;h+=2)t[h]=a-t[h],t[h+1]+=r;break;case 270:for(let h=0,d=t.length;h<d;h+=2){const u=t[h];t[h]=a-t[h+1],t[h+1]=l-u}break;default:throw new Error("Invalid rotation")}return t},Cd=new WeakSet,Bg=function(t,s,i){const[n,r,a,l]=s;switch(i){case 0:for(let h=0,d=t.length;h<d;h+=2)t[h]-=n,t[h+1]=l-t[h+1];break;case 90:for(let h=0,d=t.length;h<d;h+=2){const u=t[h];t[h]=t[h+1]-r,t[h+1]=u-n}break;case 180:for(let h=0,d=t.length;h<d;h+=2)t[h]=a-t[h],t[h+1]-=r;break;case 270:for(let h=0,d=t.length;h<d;h+=2){const u=t[h];t[h]=l-t[h+1],t[h+1]=a-u}break;default:throw new Error("Invalid rotation")}return t},Rd=new WeakSet,Hg=function(t,s,i,n){var d,u;const r=[],a=this.thickness/2,l=t*s+a,h=t*i+a;for(const f of this.paths){const p=[],m=[];for(let v=0,E=f.length;v<E;v++){const[A,w,S,C]=f[v];if(A[0]===C[0]&&A[1]===C[1]&&E===1){const H=t*A[0]+l,X=t*A[1]+h;p.push(H,X),m.push(H,X);break}const x=t*A[0]+l,T=t*A[1]+h,R=t*w[0]+l,I=t*w[1]+h,P=t*S[0]+l,O=t*S[1]+h,L=t*C[0]+l,W=t*C[1]+h;v===0&&(p.push(x,T),m.push(x,T)),p.push(R,I,P,O,L,W),m.push(R,I),v===E-1&&m.push(L,W)}r.push({bezier:y(d=dt,Yl,nf).call(d,p,n,this.rotation),points:y(u=dt,Yl,nf).call(u,m,n,this.rotation)})}return r},Kl=new WeakSet,rf=function(){let t=1/0,s=-1/0,i=1/0,n=-1/0;for(const r of this.paths)for(const[a,l,h,d]of r){const u=N.bezierBoundingBox(...a,...l,...h,...d);t=Math.min(t,u[0]),i=Math.min(i,u[1]),s=Math.max(s,u[2]),n=Math.max(n,u[3])}return[t,i,s,n]},la=new WeakSet,Bh=function(){return o(this,ye)?Math.ceil(this.thickness*this.parentScale):0},Ln=new WeakSet,La=function(t=!1){if(this.isEmpty())return;if(!o(this,ye)){y(this,Ms,wi).call(this);return}const s=y(this,Kl,rf).call(this),i=y(this,la,Bh).call(this);b(this,Tn,Math.max(et.MIN_SIZE,s[2]-s[0])),b(this,xn,Math.max(et.MIN_SIZE,s[3]-s[1]));const n=Math.ceil(i+o(this,Tn)*this.scaleFactor),r=Math.ceil(i+o(this,xn)*this.scaleFactor),[a,l]=this.parentDimensions;this.width=n/a,this.height=r/l,this.setAspectRatio(n,r);const h=this.translationX,d=this.translationY;this.translationX=-s[0],this.translationY=-s[1],y(this,di,Kn).call(this),y(this,Ms,wi).call(this),b(this,In,n),b(this,Mn,r),this.setDims(n,r);const u=t?i/this.scaleFactor/2:0;this.translate(h-this.translationX-u,d-this.translationY-u)},g(dt,Td),g(dt,Yl),g(dt,Cd),z(dt,"_defaultColor",null),z(dt,"_defaultOpacity",1),z(dt,"_defaultThickness",1),z(dt,"_type","ink"),z(dt,"_editorType",J.INK);let Zu=dt;var Nt,Bt,ui,Ls,fi,ha,Je,Ql,_s,Ze,De,Jl,_n,_a,On,Oa,ca,Hh,Zl,of,Pd,Ug,Id,jg,Md,$g,ql,lf,da,Uh,Ld,zg;const Fa=class Fa extends et{constructor(t){super({...t,name:"stampEditor"});g(this,_n);g(this,On);g(this,ca);g(this,Zl);g(this,Pd);g(this,Id);g(this,Md);g(this,ql);g(this,da);g(this,Ld);g(this,Nt,null);g(this,Bt,null);g(this,ui,null);g(this,Ls,null);g(this,fi,null);g(this,ha,"");g(this,Je,null);g(this,Ql,!1);g(this,_s,null);g(this,Ze,null);g(this,De,!1);g(this,Jl,!1);b(this,Ls,t.bitmapUrl),b(this,fi,t.bitmapFile)}static initialize(t,s){et.initialize(t,s)}static get supportedTypes(){return Z(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(s=>`image/${s}`))}static get supportedTypesStr(){return Z(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,s){s.pasteEditor(J.STAMP,{bitmapFile:t.getAsFile()})}remove(){var t,s;o(this,Bt)&&(b(this,Nt,null),this._uiManager.imageManager.deleteId(o(this,Bt)),(t=o(this,Je))==null||t.remove(),b(this,Je,null),(s=o(this,_s))==null||s.disconnect(),b(this,_s,null),o(this,Ze)&&(clearTimeout(o(this,Ze)),b(this,Ze,null))),super.remove()}rebuild(){if(!this.parent){o(this,Bt)&&y(this,ca,Hh).call(this);return}super.rebuild(),this.div!==null&&(o(this,Bt)&&o(this,Je)===null&&y(this,ca,Hh).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(o(this,ui)||o(this,Nt)||o(this,Ls)||o(this,fi)||o(this,Bt))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;if(this.width&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),o(this,Nt)?y(this,Zl,of).call(this):y(this,ca,Hh).call(this),this.width){const[i,n]=this.parentDimensions;this.setAt(t*i,s*n,this.width*i,this.height*n)}return this.div}getImageForAltText(){return o(this,Je)}static deserialize(t,s,i){if(t instanceof rg)return null;const n=super.deserialize(t,s,i),{rect:r,bitmapUrl:a,bitmapId:l,isSvg:h,accessibilityData:d}=t;l&&i.imageManager.isValidId(l)?b(n,Bt,l):b(n,Ls,a),b(n,De,h);const[u,f]=n.pageDimensions;return n.width=(r[2]-r[0])/u,n.height=(r[3]-r[1])/f,d&&(n.altTextData=d),n}serialize(t=!1,s=null){if(this.isEmpty())return null;const i={annotationType:J.STAMP,bitmapId:o(this,Bt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:o(this,De),structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=y(this,da,Uh).call(this,!0),i.accessibilityData=this.altTextData,i;const{decorative:n,altText:r}=this.altTextData;if(!n&&r&&(i.accessibilityData={type:"Figure",alt:r}),s===null)return i;s.stamps||(s.stamps=new Map);const a=o(this,De)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!s.stamps.has(o(this,Bt)))s.stamps.set(o(this,Bt),{area:a,serialized:i}),i.bitmap=y(this,da,Uh).call(this,!1);else if(o(this,De)){const l=s.stamps.get(o(this,Bt));a>l.area&&(l.area=a,l.serialized.bitmap.close(),l.serialized.bitmap=y(this,da,Uh).call(this,!1))}return i}};Nt=new WeakMap,Bt=new WeakMap,ui=new WeakMap,Ls=new WeakMap,fi=new WeakMap,ha=new WeakMap,Je=new WeakMap,Ql=new WeakMap,_s=new WeakMap,Ze=new WeakMap,De=new WeakMap,Jl=new WeakMap,_n=new WeakSet,_a=function(t,s=!1){if(!t){this.remove();return}b(this,Nt,t.bitmap),s||(b(this,Bt,t.id),b(this,De,t.isSvg)),t.file&&b(this,ha,t.file.name),y(this,Zl,of).call(this)},On=new WeakSet,Oa=function(){b(this,ui,null),this._uiManager.enableWaiting(!1),o(this,Je)&&this.div.focus()},ca=new WeakSet,Hh=function(){if(o(this,Bt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(o(this,Bt)).then(i=>y(this,_n,_a).call(this,i,!0)).finally(()=>y(this,On,Oa).call(this));return}if(o(this,Ls)){const i=o(this,Ls);b(this,Ls,null),this._uiManager.enableWaiting(!0),b(this,ui,this._uiManager.imageManager.getFromUrl(i).then(n=>y(this,_n,_a).call(this,n)).finally(()=>y(this,On,Oa).call(this)));return}if(o(this,fi)){const i=o(this,fi);b(this,fi,null),this._uiManager.enableWaiting(!0),b(this,ui,this._uiManager.imageManager.getFromFile(i).then(n=>y(this,_n,_a).call(this,n)).finally(()=>y(this,On,Oa).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=Fa.supportedTypesStr;const s=this._uiManager._signal;b(this,ui,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const n=await this._uiManager.imageManager.getFromFile(t.files[0]);y(this,_n,_a).call(this,n)}i()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:s})}).finally(()=>y(this,On,Oa).call(this))),t.click()},Zl=new WeakSet,of=function(){const{div:t}=this;let{width:s,height:i}=o(this,Nt);const[n,r]=this.pageDimensions,a=.75;if(this.width)s=this.width*n,i=this.height*r;else if(s>a*n||i>a*r){const u=Math.min(a*n/s,a*r/i);s*=u,i*=u}const[l,h]=this.parentDimensions;this.setDims(s*l/n,i*h/r),this._uiManager.enableWaiting(!1);const d=b(this,Je,document.createElement("canvas"));t.append(d),t.hidden=!1,y(this,ql,lf).call(this,s,i),y(this,Ld,zg).call(this),o(this,Jl)||(this.parent.addUndoableEditor(this),b(this,Jl,!0)),this._reportTelemetry({action:"inserted_image"}),o(this,ha)&&d.setAttribute("aria-label",o(this,ha))},Pd=new WeakSet,Ug=function(t,s){var a;const[i,n]=this.parentDimensions;this.width=t/i,this.height=s/n,this.setDims(t,s),(a=this._initialOptions)!=null&&a.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,o(this,Ze)!==null&&clearTimeout(o(this,Ze)),b(this,Ze,setTimeout(()=>{b(this,Ze,null),y(this,ql,lf).call(this,t,s)},200))},Id=new WeakSet,jg=function(t,s){const{width:i,height:n}=o(this,Nt);let r=i,a=n,l=o(this,Nt);for(;r>2*t||a>2*s;){const h=r,d=a;r>2*t&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2)),a>2*s&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const u=new OffscreenCanvas(r,a);u.getContext("2d").drawImage(l,0,0,h,d,0,0,r,a),l=u.transferToImageBitmap()}return l},Md=new WeakSet,$g=async function(t,s,i){if(o(this,Ql)||(b(this,Ql,!0),!await this._uiManager.isMLEnabledFor("altText")||this.hasAltText()))return;const a=new OffscreenCanvas(s,i).getContext("2d",{willReadFrequently:!0});a.drawImage(t,0,0,t.width,t.height,0,0,s,i);const l=await this._uiManager.mlGuess({service:"moz-image-to-text",request:{data:a.getImageData(0,0,s,i).data,width:s,height:i,channels:4}}),h=(l==null?void 0:l.output)||"";this.parent&&h&&!this.hasAltText()&&(this.altTextData={altText:h,decorative:!1})},ql=new WeakSet,lf=function(t,s){t=Math.ceil(t),s=Math.ceil(s);const i=o(this,Je);if(!i||i.width===t&&i.height===s)return;i.width=t,i.height=s;const n=o(this,De)?o(this,Nt):y(this,Id,jg).call(this,t,s);y(this,Md,$g).call(this,n,t,s);const r=i.getContext("2d");r.filter=this._uiManager.hcmFilter,r.drawImage(n,0,0,n.width,n.height,0,0,t,s)},da=new WeakSet,Uh=function(t){if(t){if(o(this,De)){const n=this._uiManager.imageManager.getSvgUrl(o(this,Bt));if(n)return n}const s=document.createElement("canvas");return{width:s.width,height:s.height}=o(this,Nt),s.getContext("2d").drawImage(o(this,Nt),0,0),s.toDataURL()}if(o(this,De)){const[s,i]=this.pageDimensions,n=Math.round(this.width*s*vi.PDF_TO_CSS_UNITS),r=Math.round(this.height*i*vi.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(n,r);return a.getContext("2d").drawImage(o(this,Nt),0,0,o(this,Nt).width,o(this,Nt).height,0,0,n,r),a.transferToImageBitmap()}return structuredClone(o(this,Nt))},Ld=new WeakSet,zg=function(){this._uiManager._signal&&(b(this,_s,new ResizeObserver(t=>{const s=t[0].contentRect;s.width&&s.height&&y(this,Pd,Ug).call(this,s.width,s.height)})),o(this,_s).observe(this.div),this._uiManager._signal.addEventListener("abort",()=>{var t;(t=o(this,_s))==null||t.disconnect(),b(this,_s,null)},{once:!0}))},z(Fa,"_type","stamp"),z(Fa,"_editorType",J.STAMP);let af=Fa;var Dn,ua,qe,Fn,Os,Ds,Fs,ue,pi,fa,pa,Gt,B,gi,_d,Gg,th,cf,eh,df,sh,uf,ga,jh;const Ae=class Ae{constructor({uiManager:e,pageIndex:t,div:s,accessibilityManager:i,annotationLayer:n,drawLayer:r,textLayer:a,viewport:l,l10n:h}){g(this,_d);g(this,th);g(this,eh);g(this,sh);g(this,ga);g(this,Dn,void 0);g(this,ua,!1);g(this,qe,null);g(this,Fn,null);g(this,Os,null);g(this,Ds,null);g(this,Fs,null);g(this,ue,new Map);g(this,pi,!1);g(this,fa,!1);g(this,pa,!1);g(this,Gt,null);g(this,B,void 0);const d=[...o(Ae,gi).values()];if(!Ae._initialized){Ae._initialized=!0;for(const u of d)u.initialize(h,e)}e.registerEditorTypes(d),b(this,B,e),this.pageIndex=t,this.div=s,b(this,Dn,i),b(this,qe,n),this.viewport=l,b(this,Gt,a),this.drawLayer=r,o(this,B).addLayer(this)}get isEmpty(){return o(this,ue).size===0}get isInvisible(){return this.isEmpty&&o(this,B).getMode()===J.NONE}updateToolbar(e){o(this,B).updateToolbar(e)}updateMode(e=o(this,B).getMode()){switch(y(this,ga,jh).call(this),e){case J.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case J.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case J.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of o(Ae,gi).values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=o(this,Gt))==null?void 0:t.div)}addInkEditorIfNeeded(e){if(o(this,B).getMode()!==J.INK)return;if(!e){for(const s of o(this,ue).values())if(s.isEmpty()){s.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(e){o(this,B).setEditingState(e)}addCommands(e){o(this,B).addCommands(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=o(this,qe))==null||t.div.classList.toggle("disabled",!e)}enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const s of o(this,ue).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(o(this,B).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!o(this,qe))return;const t=o(this,qe).getEditableAnnotations();for(const s of t){if(s.hide(),o(this,B).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const i=this.deserialize(s);i&&(this.addOrRebuild(i),i.enableEditing())}}disable(){var i;b(this,pa,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const n of o(this,ue).values())if(n.disableEditing(),!!n.annotationElementId){if(n.serialize()!==null){e.set(n.annotationElementId,n);continue}else t.set(n.annotationElementId,n);(i=this.getEditableAnnotation(n.annotationElementId))==null||i.show(),n.remove()}if(o(this,qe)){const n=o(this,qe).getEditableAnnotations();for(const r of n){const{id:a}=r.data;if(o(this,B).isDeletedAnnotationElement(a))continue;let l=t.get(a);if(l){l.resetAnnotationElement(r),l.show(!1),r.show();continue}l=e.get(a),l&&(o(this,B).addChangedExistingAnnotation(l),l.renderAnnotationElement(r),l.show(!1)),r.show()}}y(this,ga,jh).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const n of o(Ae,gi).values())s.remove(`${n._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),b(this,pa,!1)}getEditableAnnotation(e){var t;return((t=o(this,qe))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){o(this,B).getActive()!==e&&o(this,B).setActiveEditor(e)}enableTextSelection(){var e;this.div.tabIndex=-1,(e=o(this,Gt))!=null&&e.div&&!o(this,Ds)&&(b(this,Ds,y(this,_d,Gg).bind(this)),o(this,Gt).div.addEventListener("pointerdown",o(this,Ds),{signal:o(this,B)._signal}),o(this,Gt).div.classList.add("highlighting"))}disableTextSelection(){var e;this.div.tabIndex=0,(e=o(this,Gt))!=null&&e.div&&o(this,Ds)&&(o(this,Gt).div.removeEventListener("pointerdown",o(this,Ds)),b(this,Ds,null),o(this,Gt).div.classList.remove("highlighting"))}enableClick(){if(o(this,Os))return;const e=o(this,B)._signal;b(this,Os,this.pointerdown.bind(this)),b(this,Fn,this.pointerup.bind(this)),this.div.addEventListener("pointerdown",o(this,Os),{signal:e}),this.div.addEventListener("pointerup",o(this,Fn),{signal:e})}disableClick(){o(this,Os)&&(this.div.removeEventListener("pointerdown",o(this,Os)),this.div.removeEventListener("pointerup",o(this,Fn)),b(this,Os,null),b(this,Fn,null))}attach(e){o(this,ue).set(e.id,e);const{annotationElementId:t}=e;t&&o(this,B).isDeletedAnnotationElement(t)&&o(this,B).removeDeletedAnnotationElement(e)}detach(e){var t;o(this,ue).delete(e.id),(t=o(this,Dn))==null||t.removePointerInTextLayer(e.contentDiv),!o(this,pa)&&e.annotationElementId&&o(this,B).addDeletedAnnotationElement(e)}remove(e){this.detach(e),o(this,B).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1,o(this,fa)||this.addInkEditorIfNeeded(!1)}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(o(this,B).addDeletedAnnotationElement(e.annotationElementId),et.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),o(this,B).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(),o(this,B).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!o(this,Fs)&&(e._focusEventsAllowed=!1,b(this,Fs,setTimeout(()=>{b(this,Fs,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:o(this,B)._signal}),t.focus())},0))),e._structTreeParentId=(s=o(this,Dn))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getNextId(){return o(this,B).getId()}get _signal(){return o(this,B)._signal}canCreateNewEmptyEditor(){var e;return(e=o(this,th,cf))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){o(this,B).updateToolbar(e),o(this,B).updateMode(e);const{offsetX:s,offsetY:i}=y(this,sh,uf).call(this),n=this.getNextId(),r=y(this,eh,df).call(this,{parent:this,id:n,x:s,y:i,uiManager:o(this,B),isCentered:!0,...t});r&&this.add(r)}deserialize(e){var t;return((t=o(Ae,gi).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,o(this,B)))||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),n=y(this,eh,df).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:o(this,B),isCentered:t,...s});return n&&this.add(n),n}addNewEditor(){this.createAndAddNewEditor(y(this,sh,uf).call(this),!0)}setSelected(e){o(this,B).setSelected(e)}toggleSelected(e){o(this,B).toggleSelected(e)}isSelected(e){return o(this,B).isSelected(e)}unselect(e){o(this,B).unselect(e)}pointerup(e){const{isMac:t}=te.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&o(this,pi)){if(b(this,pi,!1),!o(this,ua)){b(this,ua,!0);return}if(o(this,B).getMode()===J.STAMP){o(this,B).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){if(o(this,B).getMode()===J.HIGHLIGHT&&this.enableTextSelection(),o(this,pi)){b(this,pi,!1);return}const{isMac:t}=te.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;b(this,pi,!0);const s=o(this,B).getActive();b(this,ua,!s||s.isEmpty())}findNewParent(e,t,s){const i=o(this,B).findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}destroy(){var e,t;((e=o(this,B).getActive())==null?void 0:e.parent)===this&&(o(this,B).commitOrRemove(),o(this,B).setActiveEditor(null)),o(this,Fs)&&(clearTimeout(o(this,Fs)),b(this,Fs,null));for(const s of o(this,ue).values())(t=o(this,Dn))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,o(this,ue).clear(),o(this,B).removeLayer(this)}render({viewport:e}){this.viewport=e,kn(this.div,e);for(const t of o(this,B).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){o(this,B).commitOrRemove(),y(this,ga,jh).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,kn(this.div,{rotation:s}),t!==s)for(const i of o(this,ue).values())i.rotate(s);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return o(this,B).viewParameters.realScale}};Dn=new WeakMap,ua=new WeakMap,qe=new WeakMap,Fn=new WeakMap,Os=new WeakMap,Ds=new WeakMap,Fs=new WeakMap,ue=new WeakMap,pi=new WeakMap,fa=new WeakMap,pa=new WeakMap,Gt=new WeakMap,B=new WeakMap,gi=new WeakMap,_d=new WeakSet,Gg=function(e){o(this,B).unselectAll();const{target:t}=e;if(t===o(this,Gt).div||t.classList.contains("endOfContent")&&o(this,Gt).div.contains(t)){const{isMac:s}=te.platform;if(e.button!==0||e.ctrlKey&&s)return;o(this,B).showAllEditors("highlight",!0,!0),o(this,Gt).div.classList.add("free"),this.toggleDrawing(),Yh.startHighlighting(this,o(this,B).direction==="ltr",e),o(this,Gt).div.addEventListener("pointerup",()=>{o(this,Gt).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:o(this,B)._signal}),e.preventDefault()}},th=new WeakSet,cf=function(){return o(Ae,gi).get(o(this,B).getMode())},eh=new WeakSet,df=function(e){const t=o(this,th,cf);return t?new t.prototype.constructor(e):null},sh=new WeakSet,uf=function(){const{x:e,y:t,width:s,height:i}=this.div.getBoundingClientRect(),n=Math.max(0,e),r=Math.max(0,t),a=Math.min(window.innerWidth,e+s),l=Math.min(window.innerHeight,t+i),h=(n+a)/2-e,d=(r+l)/2-t,[u,f]=this.viewport.rotation%180===0?[h,d]:[d,h];return{offsetX:u,offsetY:f}},ga=new WeakSet,jh=function(){b(this,fa,!0);for(const e of o(this,ue).values())e.isEmpty()&&e.remove();b(this,fa,!1)},z(Ae,"_initialized",!1),g(Ae,gi,new Map([$u,Zu,af,Yh].map(e=>[e._editorType,e])));let hf=Ae;var ts,ih,xt,mi,nh,pf,rh,gf,Od,Vg;const Ot=class Ot{constructor({pageIndex:e}){g(this,rh);g(this,Od);g(this,ts,null);g(this,ih,0);g(this,xt,new Map);g(this,mi,new Map);this.pageIndex=e}setParent(e){if(!o(this,ts)){b(this,ts,e);return}if(o(this,ts)!==e){if(o(this,xt).size>0)for(const t of o(this,xt).values())t.remove(),e.append(t);b(this,ts,e)}}static get _svgFactory(){return Z(this,"_svgFactory",new bf)}highlight(e,t,s,i=!1){const n=se(this,ih)._++,r=y(this,rh,gf).call(this,e.box);r.classList.add("highlight"),e.free&&r.classList.add("free");const a=Ot._svgFactory.createElement("defs");r.append(a);const l=Ot._svgFactory.createElement("path");a.append(l);const h=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",h),l.setAttribute("d",e.toSVGPath()),i&&o(this,mi).set(n,l);const d=y(this,Od,Vg).call(this,a,h),u=Ot._svgFactory.createElement("use");return r.append(u),r.setAttribute("fill",t),r.setAttribute("fill-opacity",s),u.setAttribute("href",`#${h}`),o(this,xt).set(n,r),{id:n,clipPathId:`url(#${d})`}}highlightOutline(e){const t=se(this,ih)._++,s=y(this,rh,gf).call(this,e.box);s.classList.add("highlightOutline");const i=Ot._svgFactory.createElement("defs");s.append(i);const n=Ot._svgFactory.createElement("path");i.append(n);const r=`path_p${this.pageIndex}_${t}`;n.setAttribute("id",r),n.setAttribute("d",e.toSVGPath()),n.setAttribute("vector-effect","non-scaling-stroke");let a;if(e.free){s.classList.add("free");const d=Ot._svgFactory.createElement("mask");i.append(d),a=`mask_p${this.pageIndex}_${t}`,d.setAttribute("id",a),d.setAttribute("maskUnits","objectBoundingBox");const u=Ot._svgFactory.createElement("rect");d.append(u),u.setAttribute("width","1"),u.setAttribute("height","1"),u.setAttribute("fill","white");const f=Ot._svgFactory.createElement("use");d.append(f),f.setAttribute("href",`#${r}`),f.setAttribute("stroke","none"),f.setAttribute("fill","black"),f.setAttribute("fill-rule","nonzero"),f.classList.add("mask")}const l=Ot._svgFactory.createElement("use");s.append(l),l.setAttribute("href",`#${r}`),a&&l.setAttribute("mask",`url(#${a})`);const h=l.cloneNode();return s.append(h),l.classList.add("mainOutline"),h.classList.add("secondaryOutline"),o(this,xt).set(t,s),t}finalizeLine(e,t){const s=o(this,mi).get(e);o(this,mi).delete(e),this.updateBox(e,t.box),s.setAttribute("d",t.toSVGPath())}updateLine(e,t){o(this,xt).get(e).firstChild.firstChild.setAttribute("d",t.toSVGPath())}removeFreeHighlight(e){this.remove(e),o(this,mi).delete(e)}updatePath(e,t){o(this,mi).get(e).setAttribute("d",t.toSVGPath())}updateBox(e,t){var s;y(s=Ot,nh,pf).call(s,o(this,xt).get(e),t)}show(e,t){o(this,xt).get(e).classList.toggle("hidden",!t)}rotate(e,t){o(this,xt).get(e).setAttribute("data-main-rotation",t)}changeColor(e,t){o(this,xt).get(e).setAttribute("fill",t)}changeOpacity(e,t){o(this,xt).get(e).setAttribute("fill-opacity",t)}addClass(e,t){o(this,xt).get(e).classList.add(t)}removeClass(e,t){o(this,xt).get(e).classList.remove(t)}remove(e){o(this,ts)!==null&&(o(this,xt).get(e).remove(),o(this,xt).delete(e))}destroy(){b(this,ts,null);for(const e of o(this,xt).values())e.remove();o(this,xt).clear()}};ts=new WeakMap,ih=new WeakMap,xt=new WeakMap,mi=new WeakMap,nh=new WeakSet,pf=function(e,{x:t=0,y:s=0,width:i=1,height:n=1}={}){const{style:r}=e;r.top=`${100*s}%`,r.left=`${100*t}%`,r.width=`${100*i}%`,r.height=`${100*n}%`},rh=new WeakSet,gf=function(e){var s;const t=Ot._svgFactory.create(1,1,!0);return o(this,ts).append(t),t.setAttribute("aria-hidden",!0),y(s=Ot,nh,pf).call(s,t,e),t},Od=new WeakSet,Vg=function(e,t){const s=Ot._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const n=Ot._svgFactory.createElement("use");return s.append(n),n.setAttribute("href",`#${t}`),n.classList.add("clip"),i},g(Ot,nh);let ff=Ot;var Yv=$.AbortException,Kv=$.AnnotationEditorLayer,Qv=$.AnnotationEditorParamsType,Jv=$.AnnotationEditorType,Zv=$.AnnotationEditorUIManager,qv=$.AnnotationLayer,tb=$.AnnotationMode,eb=$.CMapCompressionType,sb=$.ColorPicker,ib=$.DOMSVGFactory,nb=$.DrawLayer,rb=$.FeatureTest,ab=$.GlobalWorkerOptions,ob=$.ImageKind,lb=$.InvalidPDFException,hb=$.MissingPDFException,cb=$.OPS,db=$.PDFDataRangeTransport,ub=$.PDFDateString,fb=$.PDFWorker,pb=$.PasswordResponses,gb=$.PermissionFlag,mb=$.PixelsPerInch,vb=$.RenderingCancelledException,bb=$.TextLayer,yb=$.UnexpectedResponseException,Ab=$.Util,Eb=$.VerbosityLevel,wb=$.XfaLayer,Sb=$.build,xb=$.createValidAbsoluteUrl,Tb=$.fetchData,Cb=$.getDocument,Rb=$.getFilenameFromUrl,Pb=$.getPdfFilenameFromUrl,Ib=$.getXfaPageViewport,Mb=$.isDataScheme,Lb=$.isPdfFile,_b=$.noContextMenu,Ob=$.normalizeUnicode,Db=$.setLayerDimensions,Fb=$.shadow,kb=$.version;export{Yv as AbortException,Kv as AnnotationEditorLayer,Qv as AnnotationEditorParamsType,Jv as AnnotationEditorType,Zv as AnnotationEditorUIManager,qv as AnnotationLayer,tb as AnnotationMode,eb as CMapCompressionType,sb as ColorPicker,ib as DOMSVGFactory,nb as DrawLayer,rb as FeatureTest,ab as GlobalWorkerOptions,ob as ImageKind,lb as InvalidPDFException,hb as MissingPDFException,cb as OPS,db as PDFDataRangeTransport,ub as PDFDateString,fb as PDFWorker,pb as PasswordResponses,gb as PermissionFlag,mb as PixelsPerInch,vb as RenderingCancelledException,bb as TextLayer,yb as UnexpectedResponseException,Ab as Util,Eb as VerbosityLevel,wb as XfaLayer,Sb as build,xb as createValidAbsoluteUrl,Tb as fetchData,Cb as getDocument,Rb as getFilenameFromUrl,Pb as getPdfFilenameFromUrl,Ib as getXfaPageViewport,Mb as isDataScheme,Lb as isPdfFile,_b as noContextMenu,Ob as normalizeUnicode,Db as setLayerDimensions,Fb as shadow,kb as version};
