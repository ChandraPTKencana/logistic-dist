import{g as fe,h as pe,r as l,f as j,C as me,j as H,s as ve,c as f,b as p,a as o,l as t,n as g,F as ye,E as he,w as ge,q as ke,x as m,y as k,o as i,G as we,z as N,t as z,d as xe,k as be,A as Ce,m as De,B as E,H as Ae,_ as L}from"./entry.dc2b24f1.js";import ze from"./Header.8e41c724.js";import Ee from"./Plus.ea73e236.js";import Le from"./Edit.2f9e50ef.js";import Te from"./Signature.3aaeac38.js";import Pe from"./Table2Column.07c7d378.js";import $e from"./TableUp.c170f5d4.js";import Re from"./Line.3a06ceef.js";import Se from"./Check.131be657.js";import{u as F}from"./useUtils.bd40102d.js";import{u as w}from"./useMyFetch.766e9601.js";import{u as Ie}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";const Me=E(()=>L(()=>import("./PopupMini.3b197d38.js"),["./PopupMini.3b197d38.js","./PopupMini.vue.ba3a7ccd.js","./Times.42ecdbb9.js","./_plugin-vue_export-helper.c27b6911.js","./entry.dc2b24f1.js","./entry.d3e41f65.css","./Exclamation.5191042a.js"],import.meta.url).then(u=>u.default||u)),Fe=E(()=>L(()=>import("./rpt_salary.f534b780.js"),["./rpt_salary.f534b780.js","./HeaderPopup.vue.7b062c59.js","./Times.42ecdbb9.js","./_plugin-vue_export-helper.c27b6911.js","./entry.dc2b24f1.js","./entry.d3e41f65.css","./client-only.54569d5f.js","./useUtils.bd40102d.js","./useMyFetch.766e9601.js"],import.meta.url).then(u=>u.default||u)),Be=E(()=>L(()=>import("./rpt_salary_validasi.9b550aa4.js"),["./rpt_salary_validasi.9b550aa4.js","./HeaderPopup.vue.7b062c59.js","./Times.42ecdbb9.js","./_plugin-vue_export-helper.c27b6911.js","./entry.dc2b24f1.js","./entry.d3e41f65.css","./useUtils.bd40102d.js","./useMyFetch.766e9601.js"],import.meta.url).then(u=>u.default||u)),Oe=E(()=>L(()=>import("./rpt_salary_check.9600581f.js"),["./rpt_salary_check.9600581f.js","./HeaderPopup.vue.7b062c59.js","./Times.42ecdbb9.js","./_plugin-vue_export-helper.c27b6911.js","./entry.dc2b24f1.js","./entry.d3e41f65.css","./Refresh.b03cd930.js","./useUtils.bd40102d.js","./useMyFetch.766e9601.js"],import.meta.url).then(u=>u.default||u)),Ue={class:"w-full h-full flex flex-col"},Ve={class:"w-full flex grow flex-col overflow-auto h-0"},je={class:"w-full flex"},He={class:"w-full flex justify-center items-center grow h-0 p-1"},Ne={key:0,class:""},Ye={class:"tacky"},Je=o("thead",null,[o("tr",{class:"sticky top-0 !z-[2]"},[o("th",null,"Logistik"),o("th",null,"ID"),o("th",null,"Period End"),o("th",null,"Created At"),o("th",null,"Updated At")])],-1),qe=["onClick"],Ge={class:"flex items-center justify-center"},We={class:"bold"},Xe={class:"grow mb-5"},dt={__name:"rpt",async setup(u){let x,B;const{$moment:T}=Ae(),d={};d._TimeZoneOffset=new Date().getTimezoneOffset(),d.sort="created_at:desc";const v=fe("token"),{data:Y}=([x,B]=pe(async()=>ke(async()=>{let e=[];m().loading_full=!0;const{data:a,error:c,status:h}=await w("/rpt_salarys",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:d,retry:0});return m().loading_full=!1,h.value==="error"?(k().trigger(c),{rpt_salarys:e}):(e=a.value.data,{rpt_salarys:e})},{lazy:!0,server:!1,default:()=>({rpt_salarys:[]})},"$fWJlXxIgiP")),x=await x,B(),x),s=l([]);j(()=>{var e;return(e=Y.value)==null?void 0:e.rpt_salarys},e=>{e&&(s.value=[...e])},{immediate:!0}),l(""),l({field:"created_at",by:"desc"});const n=l(-1),_=l({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),b=l(null),J=async()=>{m().loading_full=!0,_.value.may_get_data=!1,d.page=_.value.page,d.page==1&&(s.value=[]),d.first_row&&delete d.first_row,d.page>1&&(d.first_row=JSON.stringify(s.value[0]));const{data:e,error:a,status:c}=await w("/rpt_salarys",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:d,retry:0});if(m().loading_full=!1,_.value.may_get_data=!0,c.value==="error"){k().trigger(a);return}_.value.page==1?(s.value=e.value.data,b.value&&(b.value.scrollTop=0)):_.value.page>1&&(s.value=[...s.value,...e.value.data]),e.value.data.length==0&&(_.value.is_last_record=!0)},q=async()=>{if(!_.value.may_get_data)return;let e=b.value;if(e.scrollLeft!=_.value.scrollLeft){_.value.scrollLeft=e.scrollLeft;return}_.value.is_last_record||!(Math.round(e.scrollTop)+e.clientHeight>=e.scrollHeight-1)||(_.value.page++,await J())};me();const C=l(!1),P=l(0),D=l(0),G=()=>{P.value=0,C.value=!0,D.value=!1},{display:$}=H();ve(H());const W=()=>{n.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=s.value[n.value].id,C.value=!0,D.value=!1)},R=l(!1),O=l(0),X=()=>{n.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(O.value=s.value[n.value].id,D.value=!0,R.value=!0)},S=l(!1),Z=l({}),A=l(!1),y=l(""),K=async()=>{A.value&&(A.value=!1)};j(()=>y.value,e=>{e.trim().length>0?S.value=!0:S.value=!1},{immediate:!1});const Q=async()=>{m().loading_full=!0;const e=new FormData;e.append("id",s.value[n.value].id),e.append("deleted_reason",y.value),e.append("_method","DELETE");const{data:a,error:c,status:h}=await w("/rpt_salary",{method:"post",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},body:e,retry:0});if(m().loading_full=!1,h.value==="error"){k().trigger(c);return}s.value.splice(n.value,1),n.value=-1,A.value=!1},{downloadFile:U,viewFile:Ze}=Ie();l(!1),l({});const ee=async()=>{m().loading_full=!0;const{data:e,error:a,status:c}=await w("/rpt_salary/excel_download",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:{id:s.value[n.value].id},retry:0});if(m().loading_full=!1,c.value==="error"){k().trigger(a);return}U(e.value)},te=async()=>{m().loading_full=!0;const{data:e,error:a,status:c}=await w("/rpt_salary/excel_download2",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:{id:s.value[n.value].id},retry:0});if(m().loading_full=!1,c.value==="error"){k().trigger(a);return}U(e.value)},V=l(0),I=l(!1),ae=()=>{n.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(V.value=s.value[n.value].id,I.value=!0)};return(e,a)=>{const c=ze,h=Ee,oe=Le,le=Te,se=Pe,ne=$e,re=Re,ue=Se,ie=Me,_e=Fe,ce=Be,de=Oe;return i(),f("div",Ue,[p(c,{title:"List Salary Report"}),o("div",Ve,[o("div",je,[("useUtils"in e?e.useUtils:t(F))().checkPermission("rpt_salary.create")?(i(),f("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[0]||(a[0]=r=>G())},[p(h)])):g("",!0),("useUtils"in e?e.useUtils:t(F))().checkPermissions(["rpt_salary.modify"])?(i(),f("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[1]||(a[1]=r=>W())},[p(oe)])):g("",!0),("useUtils"in e?e.useUtils:t(F))().checkPermissions(["rpt_salary.val1","rpt_salary.val2","rpt_salary.val3"])?(i(),f("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[2]||(a[2]=r=>X())},[p(le)])):g("",!0),t(n)>-1?(i(),f("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[3]||(a[3]=r=>ee())},[p(se)])):g("",!0),o("button",{type:"button",name:"button",class:"m-1 text-xs whitespace-nowrap",onClick:a[4]||(a[4]=r=>ae())}," Check Nilai "),t(n)>-1&&t(s)[t(n)].val1==1?(i(),f("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[5]||(a[5]=r=>te())},[p(ne)])):g("",!0)]),o("div",He,[t(s).length==0?(i(),f("div",Ne," Maaf Tidak Ada Record ")):(i(),f("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:q},[o("table",Ye,[Je,o("tbody",null,[(i(!0),f(ye,null,he(t(s),(r,M)=>(i(),f("tr",{key:M,onClick:Ke=>n.value=M,class:we(t(n)==M?"active":"")},[o("td",null,[o("div",Ge,[r.val1?(i(),N(ue,{key:1})):(i(),N(re,{key:0}))])]),o("td",We,z(r.id),1),o("td",null,z(r.period_end?t(T)(r.period_end).format("MM-Y"):""),1),o("td",null,z(r.created_at?t(T)(r.created_at).format("DD-MM-Y HH:mm:ss"):""),1),o("td",null,z(r.updated_at?t(T)(r.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,qe))),128))])])],544))])]),p(ie,{type:"delete",show:t(A),data:t(Z),fnClose:K,fnConfirm:Q,enabledOk:t(S)},{footer:ge(()=>[xe(" Masukkan Alasan Penghapusan: "),o("div",Xe,[be(o("textarea",{"onUpdate:modelValue":a[6]||(a[6]=r=>De(y)?y.value=r:null)},null,512),[[Ce,t(y)]])])]),_:1},8,["show","data","enabledOk"]),p(_e,{show:t(C),fnClose:()=>{C.value=!1},id:t(P),p_data:t(s),is_copy:t(D)},null,8,["show","fnClose","id","p_data","is_copy"]),p(ce,{show:t(R),fnClose:()=>{R.value=!1},id:t(O),p_data:t(s)},null,8,["show","fnClose","id","p_data"]),p(de,{show:t(I),fnClose:()=>{I.value=!1},id:t(V)},null,8,["show","fnClose","id"])])}}};export{dt as default};
