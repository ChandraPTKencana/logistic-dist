import{_ as pt}from"./HeaderPopup.vue.f1671a9c.js";import{_ as dt}from"./client-only.03f78882.js";import{r as k,g as mt,i as r,f as ht,I as vt,k as st,K as ft,o as i,c as p,a as t,b as F,l as s,t as a,w as yt,m as bt,A as wt,n as x,d as _,F as at,D as kt,C as xt,G as jt,x as j,y as ot}from"./entry.533afaeb.js";import{u as E}from"./useUtils.7d9a91ea.js";import{u as nt}from"./useMyFetch.32387a63.js";import"./Times.ce023c31.js";import"./_plugin-vue_export-helper.c27b6911.js";const gt={class:"box-fixed"},Ft={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},Et={class:"w-full flex flex-col items-center grow overflow-auto"},Mt={class:"w-full flex flex-row flex-wrap"},Pt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ct=t("label",{for:""},"Period End",-1),Dt={key:0,class:"card-border"},Nt={key:1},St={class:"text-red-500"},Tt={key:0,class:"w-full sm:w-6/12 md:w-4/12 lg:w-4/12 p-1"},Bt=t("div",{class:"font-bold"}," Filter Nama ",-1),At={key:0,class:"w-full flex p-1 justify-between flex-wrap"},Vt={class:"w-full",role:"sticky"},qt={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},$t=t("tr",{class:"sticky -top-1 !z-[2]"},[t("td",{colspan:"33",class:"!bg-slate-800 text-white font-bold"}," Detail ")],-1),Gt={class:"sticky top-7 !z-[2]"},zt=t("th",{rowspan:"2"},"No",-1),Kt=t("th",{rowspan:"2"},"ID",-1),Lt=t("th",{rowspan:"2"},"Nama Pekerja",-1),Ut=t("th",{rowspan:"2"},"Jabatan",-1),Jt=t("th",{rowspan:"2"},"Tmpt Lahir",-1),Rt=t("th",{rowspan:"2"},"Tgl Lahir",-1),Yt=t("th",{rowspan:"2"},"TMK",-1),It=t("th",{rowspan:"2"},"No KTP",-1),Ot=t("th",{rowspan:"2"},"Alamat",-1),Ht=t("th",{rowspan:"2"},"Status",-1),Qt=t("th",{rowspan:"2"},"No Rek",-1),Wt=t("th",{rowspan:"2"},"Nama Rek",-1),Xt=t("th",{rowspan:"2"},"Nama Bank",-1),Zt={colspan:"3"},te={class:"text-sm"},ee={rowspan:"2"},se={class:"text-sm"},ae={rowspan:"2"},oe={class:"text-sm"},ne={colspan:"3"},le={class:"text-sm"},re={rowspan:"2"},_e={class:"text-sm"},ue={rowspan:"2"},ce={class:"text-sm"},ie={rowspan:"2"},pe={class:"text-sm"},de={rowspan:"2"},me={class:"text-sm"},he={colspan:"3"},ve={class:"text-sm"},fe={rowspan:"2"},ye={class:"text-sm"},be={rowspan:"2"},we={class:"text-sm"},ke={rowspan:"2"},xe={class:"text-sm"},je={rowspan:"2"},ge={class:"text-sm"},Fe={rowspan:"2"},Ee={class:"text-sm"},Me={class:"sticky top-[60px] !z-[2]"},Pe={class:"text-sm"},Ce={class:"text-sm"},De={class:"text-sm"},Ne={class:"text-sm"},Se={class:"text-sm"},Te={class:"text-sm"},Be={class:"text-sm"},Ae={class:"text-sm"},Ve={class:"text-sm"},qe={ref:"to_move"},$e=["data-index"],Ge={class:"w-full flex items-center justify-end"},Ie={__name:"rpt_salary",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(y){const m=y,{$moment:b}=jt(),{pointFormat:n}=E(),M={id:"",period_end:new Date},u=k({...M}),P=mt("token"),w=k({}),c=k([]),lt=async()=>{j().loading_full=!0,w.value={};const e=new FormData;e.append("period_end",u.value.period_end?b(u.value.period_end).format("Y-MM"):"");let o="post",d=u.value.id;d==""||(e.append("id",d),e.append("_method","PUT"));const{data:h,error:g,status:l}=await nt("/rpt_salary",{method:o,headers:{Authorization:`Bearer ${P.value}`,Accept:"application/json"},body:e,retry:0});if(j().loading_full=!1,l.value==="error"){ot().trigger(g,w);return}if(c.value=h.value.details,d<=0)u.value.id=h.value.id,u.value.created_at=h.value.created_at,u.value.updated_at=h.value.updated_at,m.p_data.unshift(u.value);else{u.value.updated_at=h.value.updated_at;let v=m.p_data.map(it=>it.id).indexOf(d);v>=-1&&m.p_data.splice(v,1,{...u.value})}};r(()=>{let e=0;return c.value.forEach(o=>{e+=parseFloat(o.standby_nominal)}),e});const C=r(()=>{let e=0;return c.value.forEach(o=>{e+=parseFloat(o.sb_gaji)}),e}),D=r(()=>{let e=0;return c.value.forEach(o=>{e+=parseFloat(o.sb_makan)}),e}),N=r(()=>{let e=0;return c.value.forEach(o=>{e+=parseFloat(o.sb_dinas)}),e}),S=r(()=>{let e=0;return c.value.forEach(o=>{e+=parseFloat(o.sb_gaji_2)}),e}),T=r(()=>{let e=0;return c.value.forEach(o=>{e+=parseFloat(o.sb_makan_2)}),e}),B=r(()=>{let e=0;return c.value.forEach(o=>{e+=parseFloat(o.sb_dinas_2)}),e}),A=r(()=>{let e=0;return c.value.forEach(o=>{e+=parseFloat(o.uj_gaji)}),e}),V=r(()=>{let e=0;return c.value.forEach(o=>{e+=parseFloat(o.uj_makan)}),e}),q=r(()=>{let e=0;return c.value.forEach(o=>{e+=parseFloat(o.uj_dinas)}),e}),$=r(()=>{let e=0;return c.value.forEach(o=>{e+=parseFloat(o.employee_bpjs_kesehatan)}),e}),G=r(()=>{let e=0;return c.value.forEach(o=>{e+=parseFloat(o.employee_bpjs_jamsos)}),e}),z=r(()=>{let e=0;return c.value.forEach(o=>{e+=parseFloat(o.nominal_cut)}),e}),K=r(()=>{let e=0;return c.value.forEach(o=>{e+=parseFloat(o.salary_bonus_nominal)}),e}),L=r(()=>{let e=0;return c.value.forEach(o=>{e+=parseFloat(o.salary_bonus_nominal_2)}),e}),U=r(()=>{let e=0;return c.value.forEach(o=>{e+=parseFloat(o.kerajinan)}),e}),J=r(()=>C.value+D.value+N.value||0),R=r(()=>J.value+K.value||0),Y=r(()=>S.value+T.value+B.value||0),I=r(()=>Y.value+L.value+U.value||0),O=r(()=>R.value+I.value||0),H=r(()=>A.value+V.value+q.value||0),Q=r(()=>O.value+H.value-z.value||0),rt=r(()=>Q.value+$.value+G.value||0),W=e=>parseFloat(e.sb_gaji)+parseFloat(e.sb_makan)+parseFloat(e.sb_dinas)+parseFloat(e.salary_bonus_nominal),X=e=>parseFloat(e.sb_gaji_2)+parseFloat(e.sb_makan_2)+parseFloat(e.sb_dinas_2)+parseFloat(e.salary_bonus_nominal_2)+parseFloat(e.kerajinan),Z=e=>W(e)+X(e),tt=e=>Z(e)+parseFloat(e.uj_gaji)+parseFloat(e.uj_gaji)+parseFloat(e.uj_dinas)-parseFloat(e.nominal_cut),_t=e=>tt(e)+parseFloat(e.employee_bpjs_kesehatan)+parseFloat(e.employee_bpjs_jamsos),ut=r(()=>u.value.val&&u.value.val1||E().checkPermission("rpt_salary.val")&&u.value.val||E().checkPermission("rpt_salary.val1")&&u.value.val1),ct=async()=>{j().loading_full=!0;const{data:e,error:o,status:d}=await nt("/rpt_salary",{method:"get",headers:{Authorization:`Bearer ${P.value}`,Accept:"application/json"},params:{id:m.id},retry:0});if(j().loading_full=!1,d.value==="error"){ot().trigger(o);return}u.value=e.value.data,m.is_copy&&(u.value.val=0,u.value.val1=0),c.value=e.value.data.details},f=k(""),et=r(()=>f.value!=""?c.value.filter(e=>e.employee.name.toLowerCase().includes(f.value.toLowerCase())):c.value);return ht(()=>m.show,(e,o)=>{e==!0&&(u.value={...M},c.value=[],w.value={},m.id!=0&&ct())},{immediate:!0}),(e,o)=>{const d=pt,h=vt("vue-date-picker"),g=dt;return st((i(),p("section",gt,[t("div",null,[F(d,{title:"Form Salary Paid",fn:y.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",Ft,[t("div",Et,[t("div",Mt,[t("div",Pt,[Ct,s(u).id?(i(),p("div",Dt,a(s(b)(s(u).period_end).format("MM-Y")),1)):(i(),p("div",Nt,[F(g,null,{default:yt(()=>[F(h,{modelValue:s(u).period_end,"onUpdate:modelValue":o[0]||(o[0]=l=>s(u).period_end=l),format:"MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"","month-picker":""},null,8,["modelValue"])]),_:1})])),t("p",St,a(s(w).period_end),1)]),s(c).length?(i(),p("div",Tt,[Bt,st(t("input",{class:"",type:"text","onUpdate:modelValue":o[1]||(o[1]=l=>bt(f)?f.value=l:null),name:"search",placeholder:"Nama"},null,512),[[wt,s(f)]])])):x("",!0)]),s(et).length?(i(),p("div",At,[t("div",Vt,[t("table",qt,[t("thead",null,[$t,t("tr",Gt,[zt,Kt,Lt,Ut,Jt,Rt,Yt,It,Ot,Ht,Qt,Wt,Xt,t("th",Zt,[_("Standby 1 "),t("span",te,"("+a(s(n)(s(J)))+")",1)]),t("th",ee,[_("Potongan 1 "),t("span",se,"("+a(s(n)(s(K)||0))+")",1)]),t("th",ae,[_("Periode 1 "),t("span",oe,"("+a(s(n)(s(R)))+")",1)]),t("th",ne,[_("Standby 2 "),t("span",le,"("+a(s(n)(s(Y)))+")",1)]),t("th",re,[_("Potongan 2 "),t("span",_e,"("+a(s(n)(s(L)||0))+")",1)]),t("th",ue,[_("U.Kerajinan "),t("span",ce,"("+a(s(n)(s(U)||0))+")",1)]),t("th",ie,[_("Periode 2 "),t("span",pe,"("+a(s(n)(s(I)))+")",1)]),t("th",de,[_("Periode 1+2 "),t("span",me,"("+a(s(n)(s(O)))+")",1)]),t("th",he,[_("Trip "),t("span",ve,"("+a(s(n)(s(H)))+")",1)]),t("th",fe,[_("Potongan Trip "),t("span",ye,"("+a(s(n)(s(z)||0))+")",1)]),t("th",be,[_("Total "),t("span",we,"("+a(s(n)(s(Q)))+")",1)]),t("th",ke,[_("BPJS Kesehatan "),t("span",xe,"("+a(s(n)(s($)||0))+")",1)]),t("th",je,[_("BPJS Jamsos "),t("span",ge,"("+a(s(n)(s(G)||0))+")",1)]),t("th",Fe,[_("Grand Total "),t("span",Ee,"("+a(s(n)(s(rt)))+")",1)])]),t("tr",Me,[t("th",null,[_("Gaji "),t("span",Pe,"("+a(s(n)(s(C)||0))+")",1)]),t("th",null,[_("Makan "),t("span",Ce,"("+a(s(n)(s(D)||0))+")",1)]),t("th",null,[_("Dinas "),t("span",De,"("+a(s(n)(s(N)||0))+")",1)]),t("th",null,[_("Gaji "),t("span",Ne,"("+a(s(n)(s(S)||0))+")",1)]),t("th",null,[_("Makan "),t("span",Se,"("+a(s(n)(s(T)||0))+")",1)]),t("th",null,[_("Dinas "),t("span",Te,"("+a(s(n)(s(B)||0))+")",1)]),t("th",null,[_("Gaji "),t("span",Be,"("+a(s(n)(s(A)||0))+")",1)]),t("th",null,[_("Makan "),t("span",Ae,"("+a(s(n)(s(V)||0))+")",1)]),t("th",null,[_("Dinas "),t("span",Ve,"("+a(s(n)(s(q)||0))+")",1)])])]),t("tbody",qe,[(i(!0),p(at,null,kt(s(et),(l,v)=>(i(),p(at,{key:v},[l.p_status!="Remove"?(i(),p("tr",{key:0,"data-index":v},[t("td",null,a(v+1)+".",1),t("td",null,a(l.employee_id),1),t("td",null,a(l.employee_name),1),t("td",null,a(l.employee_role),1),t("td",null,a(l.employee_birth_place),1),t("td",null,a(l.employee_birth_date?s(b)(l.employee_birth_date).format("DD-MM-Y"):""),1),t("td",null,a(l.employee_tmk?s(b)(l.employee_tmk).format("DD-MM-Y"):""),1),t("td",null,a(l.employee_ktp_no),1),t("td",null,a(l.employee_address),1),t("td",null,a(l.employee_status),1),t("td",null,a(l.employee_rek_no),1),t("td",null,a(l.employee_rek_name),1),t("td",null,a(l.employee_bank_name),1),t("td",null,a(s(n)(l.sb_gaji)),1),t("td",null,a(s(n)(l.sb_makan)),1),t("td",null,a(s(n)(l.sb_dinas)),1),t("td",null,a(s(n)(l.salary_bonus_nominal)),1),t("td",null,a(s(n)(W(l))),1),t("td",null,a(s(n)(l.sb_gaji_2)),1),t("td",null,a(s(n)(l.sb_makan_2)),1),t("td",null,a(s(n)(l.sb_dinas_2)),1),t("td",null,a(s(n)(l.salary_bonus_nominal_2)),1),t("td",null,a(s(n)(l.kerajinan)),1),t("td",null,a(s(n)(X(l))),1),t("td",null,a(s(n)(Z(l))),1),t("td",null,a(s(n)(l.uj_gaji)),1),t("td",null,a(s(n)(l.uj_makan)),1),t("td",null,a(s(n)(l.uj_dinas)),1),t("td",null,a(s(n)(l.nominal_cut)),1),t("td",null,a(s(n)(tt(l))),1),t("td",null,a(s(n)(l.employee_bpjs_kesehatan)),1),t("td",null,a(s(n)(l.employee_bpjs_jamsos)),1),t("td",null,a(s(n)(_t(l))),1)],8,$e)):x("",!0)],64))),128))],512)])])])):x("",!0)]),t("div",Ge,[t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:o[2]||(o[2]=l=>y.fnClose())}," Cancel "),s(ut)?x("",!0):(i(),p("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:o[3]||(o[3]=xt(l=>lt(),["prevent"]))}," Generate "+a(s(u).id==""?"& Save":""),1))])])])],512)),[[ft,y.show]])}}};export{Ie as default};
