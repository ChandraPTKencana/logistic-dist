import{_ as N}from"./HeaderPopup.vue.4d128728.js";import{r as h,g as V,i as b,f as B,k as $,J as I,o as u,c,a as e,b as z,F as g,D as P,t as i,l as o,n as f,C as M,G as R,x as p,y as k,p as Y,e as E}from"./entry.5eaee47b.js";import{u as H}from"./useUtils.478d066b.js";import{u as q}from"./useMyFetch.c1c4d34c.js";import{_ as T}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.83c50a35.js";const C=n=>(Y("data-v-67a6751f"),n=n(),E(),n),L={class:"box-fixed"},U={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},G={class:"w-full flex flex-col items-center grow overflow-auto"},J={class:"w-full flex p-1 2xl:overflow-hidden justify-between flex-wrap"},O={class:"w-full",role:"sticky"},K={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},Q=C(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:7,class:"!bg-slate-800 text-white font-bold"}," List Transaksi ")]),e("tr",{class:"sticky top-7 !z-[2]"},[e("th",{rowspan:"2",class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No"),e("th",{colspan:"2"},"Transaction"),e("th",{colspan:"2"},"PVR"),e("th",{colspan:"2"},"PV")]),e("tr",{class:"sticky top-[60px] !z-[2]"},[e("th",null,"ID"),e("th",null,"Amount"),e("th",null,"No"),e("th",null,"Amount"),e("th",null,"No"),e("th",null,"Amount")])],-1)),W={ref:"to_move"},X=["data-index"],Z={class:"cell min-w-[50px] !w-[50px] max-w-[50px]"},ee={class:"w-full h-full flex items-center justify-center"},te={class:"cell"},se={class:"w-full h-full flex items-center justify-center"},ae={class:"cell min-w-[150px] !w-[150px] max-w-[150px]"},le={class:"w-full h-full flex items-center justify-center"},oe={class:"cell"},ne={class:"w-full h-full flex items-center justify-center"},ie={class:"cell"},re={class:"w-full h-full flex items-center justify-center"},ue={class:"cell"},ce={class:"w-full h-full flex items-center justify-center unselectable"},de={class:"w-full flex items-center justify-end"},_e={class:"w-full flex flex-wrap p-3 items-center"},fe=C(()=>e("div",null," Di Validasi oleh : ",-1)),pe={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},ve={key:0},me={__name:"fin_payment_req_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(n){const r=n,{$moment:j}=R(),{pointFormat:v}=H(),s=h({...{details:[],val:0,val_by:{username:""},val_at:""}}),w=V("token"),y=h({}),m=h([]),A=async()=>{p().loading_full=!0,y.value={};const a=new FormData;let l="post",d=r.id;d==0||(a.append("id",d),a.append("_method","PUT"));const{data:t,error:_,status:S}=await q("/fin_payment_req_validasi",{method:l,headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},body:a,retry:0});if(p().loading_full=!1,S.value==="error"){k().trigger(_,y);return}s.value.val=t.value.val,s.value.val_user=t.value.val_user,s.value.val_by=t.value.val_by,s.value.val_at=t.value.val_at,s.value.val1=t.value.val1,s.value.val1_user=t.value.val1_user,s.value.val1_by=t.value.val1_by,s.value.val1_at=t.value.val1_at;let x=r.p_data.map(F=>F.id).indexOf(r.id);x>=-1&&r.p_data.splice(x,1,{...s.value}),r.fnClose()},D=async()=>{p().loading_full=!0;const{data:a,error:l,status:d}=await q("/fin_payment_req",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:{id:r.id},retry:0});if(p().loading_full=!1,d.value==="error"){k().trigger(l);return}s.value=a.value.data,m.value=a.value.data.details};return b(()=>{let a=0;return m.value.forEach(l=>{l.p_status!="Remove"&&(a+=parseInt(l.amount))}),a}),b(()=>!1),B(()=>r.show,(a,l)=>{a==!0&&D()},{immediate:!0}),(a,l)=>{const d=N;return $((u(),c("section",L,[e("div",null,[z(d,{title:"Finance Payment Request",fn:n.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",U,[e("div",G,[e("div",J,[e("div",O,[e("table",K,[Q,e("tbody",W,[(u(!0),c(g,null,P(o(m),(t,_)=>(u(),c(g,{key:_},[t.p_status!="Remove"?(u(),c("tr",{key:0,"data-index":_},[e("td",null,i(_+1)+".",1),e("td",Z,[e("div",ee,i(t.id),1)]),e("td",te,[e("div",se,i(o(v)(t.amount||0)),1)]),e("td",ae,[e("div",le,i(t.pvr_no),1)]),e("td",oe,[e("div",ne,i(o(v)(t.pvr_total||0)),1)]),e("td",ie,[e("div",re,i(t.pv_no),1)]),e("td",ue,[e("div",ce,i(o(v)(t.pv_total||0)),1)])],8,X)):f("",!0)],64))),128))],512)])])])]),e("div",de,[e("div",_e,[fe,o(s).val?(u(),c("div",pe,[o(s).val?(u(),c("div",ve," App 1 : "+i(o(s).val_by.username)+" ( "+i(o(s).val_at?o(j)(o(s).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):f("",!0)])):f("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:l[0]||(l[0]=t=>n.fnClose())}," Cancel "),n.is_view==0?(u(),c("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:l[1]||(l[1]=M(t=>A(),["prevent"]))}," Validasi ")):f("",!0)])])])],512)),[[I,n.show]])}}},qe=T(me,[["__scopeId","data-v-67a6751f"]]);export{qe as default};
