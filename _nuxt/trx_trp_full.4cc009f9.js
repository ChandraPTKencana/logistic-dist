import{_ as $}from"./HeaderPopup.vue.dd0c05c6.js";import B from"./uj.a711c042.js";import J from"./emt.b5090d60.js";import E from"./CaretTop.c1a8ef6a.js";import A from"./CaretDown.6c57a541.js";import{r as n,R as L,g as P,f as q,k as U,L as R,o as V,c as M,a as l,b as p,l as v,x as D,y as z}from"./entry.a8b4d3e0.js";import{u as y}from"./useUtils.4f48d908.js";import{u as H}from"./useMyFetch.5cec154a.js";import"./Times.4a6c134a.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./ClockAnalog.b2315f45.js";import"./Calendar.f293a3e0.js";import"./Truck.152ecd7a.js";import"./LocationOn.0f75c03b.js";import"./TruckDriver.683334dd.js";import"./Person.29813ee3.js";import"./AttachmentSingleV1.0a612353.js";import"./PDFJsView.1afbfdde.js";const G={class:"box-fixed"},K={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white p-1"},Q={class:"w-full flex items-center justify-end"},de={__name:"trx_trp_full",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},it_state:{type:Number,required:!1,default:-1}},emits:["setID","setIndex"],setup(_,{emit:c}){const o=_,{pointFormat:w}=y(),b=n(null),g=n([""]),h=n([""]);let d=e=>{e.key=="ArrowUp"&&j(),e.key=="ArrowDown"&&T()};L(()=>{document.removeEventListener("keydown",d)});const f=n({...{id:-1,tanggal:new Date,payment_method:{name:""},id_uj:-1,xto:"",tipe:"",jenis:"",amount:0,pv_id:-1,pv_no:"",pv_total:0,supir:"",kernet:"",no_pol:"",val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:"",val3:0,val3_by:{username:""},val3_at:"",val4:0,val4_by:{username:""},val4_at:"",val5:0,val5_by:{username:""},val5_at:"",val6:0,val6_by:{username:""},val6_at:"",ritase_val:0,ritase_val_by:{username:""},ritase_val_at:"",ritase_val1:0,ritase_val1_by:{username:""},ritase_val1_at:"",ritase_val2:0,ritase_val2_by:{username:""},ritase_val2_at:"",cost_center_code:"",cost_center_desc:"",pvr_id:"",pvr_no:"",pvr_total:"",pvr_had_detail:"",uj_combine:{supir:[],kernet:[]}}}),F=P("token");n(null),n(null),n("");const I={_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:-1,name:"",title:"",note:""},r=n(JSON.parse(JSON.stringify(I))),s=n(JSON.parse(JSON.stringify(I))),N={_raw:{},_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},xto:{tcon:"IconsLocationOn",text:"Tujuan",val:""},asst_opt:{tcon:"IconsPerson",text:"Info",val:""},tipe:{tcon:"",text:"Tipe",val:""},harga:{tcon:"IconsMoney",text:"Amount",val:""}},id:"",name:"",title:"",note:""},O=n(JSON.parse(JSON.stringify(N))),S=e=>{let t=JSON.parse(JSON.stringify(N));return t._.id.val=e.id,t._.xto.val=e.xto,t._.asst_opt.val=e.asst_opt,t._.tipe.val=e.tipe,t._.harga.val=w(e.harga),t.id=e.id,t.name=e.xto,t.title=(e.asst_opt||"")+" "+(e.tipe||"")+" "+(w(e.harga)||""),t._raw=e,t},k=async()=>{g.value=[""],h.value=[""],setTimeout(()=>{b.value.scrollTop=0},1),D().loading_full=!0;const{data:e,error:t,status:x}=await H("/trx_trp/full_view",{method:"get",headers:{Authorization:`Bearer ${F.value}`,Accept:"application/json"},params:{id:o.id},retry:0});if(D().loading_full=!1,x.value==="error"){z().trigger(t);return}let a=e.value.data;f.value=a,r.value._.id.val=a.supir_id,r.value._.name.val=a.supir,r.value._.rek_no.val=a.supir_rek_no,r.value._.rek_name.val=a.supir_rek_name,r.value.id=a.supir_id,r.value.name=a.supir,r.value.rek_no=(a.supir_rek_no||"")+" "+(a.supir_rek_name||""),s.value._.id.val=a.kernet_id,s.value._.name.val=a.kernet,s.value._.rek_no.val=a.kernet_rek_no,s.value._.rek_name.val=a.kernet_rek_name,s.value.id=a.kernet_id,s.value.name=a.kernet,s.value.rek_no=(a.kernet_rek_no||"")+" "+(a.kernet_rek_name||""),O.value=S(a.uj);let u=0,m=0;a.potongan.forEach(i=>{i.potongan_mst.employee_id==a.supir_id&&(u+=parseInt(i.nominal_cut)),i.potongan_mst.employee_id==a.kernet_id&&(m+=parseInt(i.nominal_cut))}),r.value.note="",s.value.note="",u>0&&(r.value.note="Telah di potong sebesar :"+y().pointFormat(u)),m>0&&(s.value.note="Telah di potong sebesar :"+y().pointFormat(m))};q(()=>o.show,(e,t)=>{e==!0?(document.addEventListener("keydown",d),k()):document.removeEventListener("keydown",d)},{immediate:!0});const T=()=>{let e=o.p_data.map(t=>t.id).indexOf(o.id);e!=o.p_data.length-1&&(e++,c("setID",o.p_data[e].id),c("setIndex",e),setTimeout(()=>{k()},100))},j=()=>{let e=o.p_data.map(t=>t.id).indexOf(o.id);e!=0&&(e--,c("setID",o.p_data[e].id),c("setIndex",e),setTimeout(()=>{k()},100))};return(e,t)=>{const x=$,a=B,u=J,m=E,i=A;return U((V(),M("section",G,[l("div",null,[p(x,{title:"Form Full Transaction",fn:_.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),l("form",K,[l("div",{ref_key:"main_part",ref:b,class:"w-full flex flex-col items-center grow overflow-auto"},[p(a,{trx_trp:v(f),p_data:_.p_data,save_do:v(h),save_state:v(g)},null,8,["trx_trp","p_data","save_do","save_state"]),p(u,{extra_money_trxs:v(f).extra_money_trxs},null,8,["extra_money_trxs"])],512),l("div",Q,[l("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:t[0]||(t[0]=C=>j())},[p(m,{class:"black"})]),l("button",{type:"button",name:"button",class:"w-36 m-1",onClick:t[1]||(t[1]=C=>_.fnClose())}," Cancel "),l("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:t[2]||(t[2]=C=>T())},[p(i,{class:"black"})])])])])],512)),[[R,_.show]])}}};export{de as default};
