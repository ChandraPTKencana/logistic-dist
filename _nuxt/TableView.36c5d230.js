import{_ as B}from"./_plugin-vue_export-helper.c27b6911.js";import{o as r,c,a as d,r as g,g as O,b as H,k as S,F as u,n as m,q as x,t as C,G as $,h as L,v as A,N as K,w as W,P as X,d as q,Q as Y,p as Z,e as ee}from"./entry.4c35601f.js";import{_ as te}from"./Times.c7b6c435.js";import{u as le}from"./useUtils.cbe06c40.js";const se={name:"MdiTableHeadersEye"},ie={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},oe=d("path",{fill:"currentColor",d:"M1 6v13a2 2 0 0 0 2 2h6V11h12V6a2 2 0 0 0-2-2H3a2 2 0 0 0-2 2m2 0h4v3H3m4 10H3v-3h4m0-2H3v-3h4m2-2V6h4v3m6 0h-4V6h4m-2 10a1 1 0 1 1-1 1a1 1 0 0 1 1-1m0-3a6.45 6.45 0 0 1 6 4a6.5 6.5 0 0 1-12 0a6.45 6.45 0 0 1 6-4m0 1.5a2.5 2.5 0 1 0 2.5 2.5a2.5 2.5 0 0 0-2.5-2.5"},null,-1),ne=[oe];function re(h,T,f,p,b,y){return r(),c("svg",ie,ne)}const ce=B(se,[["render",re]]);const de=h=>(Z("data-v-507af495"),h=h(),ee(),h),ae={class:"w-full flex justify-center items-center grow h-0 pb-1 px-1 flex-col"},he={class:"w-full flex justify-end"},fe={key:0,class:"w-full h-full flex items-center justify-center fixed top-0 left-0 z-20 p-3",style:{"background-color":"rgba(255,255,255,0.9)"}},ue={class:"relative",style:{width:"95%",height:"90%"}},pe={class:"absolute -top-7 right-0 bg-white",style:{position:"absolute",padding:"5px 10px",border:"solid 1px #ccc","border-bottom":"none","border-top-right-radius":"5px","border-top-left-radius":"5px"}},_e={class:"w-full h-full flex flex-col items-center justify-content-center bg-white"},ge=de(()=>d("div",{class:"w-full text-blue-600 font-bold grid-"}," Set Show Column Field ",-1)),me={class:"w-full flex flex-wrap overflow-auto"},be=["onClick"],ye={class:"w-full flex justify-end"},we={class:"w-full flex justify-center items-center grow h-0 text-sm"},ve={key:0,class:""},ke={class:"tacky"},Se={class:"sticky top-0 !z-[2]"},xe=["rowspan","colspan"],Ce=["onClick"],Ne={__name:"TableView",props:{title:{type:String,required:!1,default:"Header Info"},thead:{type:Array,required:!0,default:[]},tbody:{type:Array,required:!1,default:[]},selected:{type:Number,required:!1,default:-1},scrolling:{type:Object,required:!1,default:{page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}},fnCallData:{type:Function,required:!0}},emits:["setSelected","setScrollingPage"],setup(h,{emit:T}){const f=h,p=g([]),b=g([]);let y=[],_=1;const E=(l,t="",e=[])=>{l.forEach((i,s)=>{if(i.tbl_show==1&&(t&&(i.dChild=t,i.parentIdx=e),y.push(i),i.childs!=null&&i.childs.length>0)){let o=i.key;e=[s],t&&(o=t+","+o,e.push(s)),_=_>=o.split(",").length+1?_:o.split(",").length+1,E(i.childs,o,e)}})},J=(l,t=[])=>{l.forEach((e,i)=>{t.length>0&&(e.parentIdx=[...t]),e.childs==null||e.childs.length==0?p.value.push(e):(t.length>0?t.push(i):t=[i],J(e.childs,t))}),t.pop()},V=l=>{let t=JSON.parse(JSON.stringify(l)),e=JSON.parse(JSON.stringify(l));b.value.push(e.map(s=>(s.tbl_show==null&&(s.tbl_show=1),s.permit==null&&(s.permit=1),s.freeze==null&&(s.freeze=0),delete s.childs,s)));let i=[];if(t.filter(s=>s.childs!=null&&s.childs.length>0).forEach(s=>{let o=JSON.parse(JSON.stringify(s.childs));i=i.concat(o)}),i.length>0)return V(i)};let w=0;const M=l=>{let t=l.map(e=>e.key);return y.every(e=>{if(e.tbl_show==1){let i=e.childs==null?[]:e.childs.filter(s=>s.tbl_show==1);if(w=i.length>0&&e.tbl_show==1?i.length:1,D(e.childs),e.dChild==null){let s=t.indexOf(e.key);s>-1&&((e.childs==null||e.childs.length==0)&&(l[s].rowspan=_),e.childs!=null&&e.childs.length>0&&(l[s].rowspan=1),l[s].colspan=w)}else{let s=e.dChild.split(","),o=z(l,s,1,e);e.childs==null||e.childs.length==0?o.rowspan=_-e.dChild.split(",").length:o.rowspan=1,o.colspan=w}}return!0}),l},z=(l,t=[],e,i)=>{if(t.length==0){let s=l.childs.map(o=>o.key).indexOf(i.key);return l.childs[s]}if(t.length>0){let s=l;e==0&&(s=l.childs);let o=s.map(n=>n.key).indexOf(t[0]);if(o==-1){console.error("ID not found");return}return t.shift(),z(s[o],t,0,i)}},D=l=>{(l==null?[]:l.filter(e=>e.tbl_show==1)).length>0&&l.forEach(e=>{let i=e.childs==null?[]:e.childs.filter(s=>s.tbl_show==1);i.length>0&&e.tbl_show==1&&(w+=i.length-1,D(e.childs))})},a=g([]),j=(l,t=[])=>{l.forEach((e,i)=>{e.permit!=null&&e.permit==0?l.splice(i,1):(e.permit==null&&(e.permit=1),e.tbl_show==null&&(e.tbl_show=1),e.freeze==null&&(e.freeze=0),l.splice(i,1,e),e.childs!=null&&e.childs.length>0&&(t.push(e),j(e.childs,t)))}),t.reverse(),t.forEach((e,i)=>{e.childs.filter(o=>o.tbl_show==1).length==0?e.tbl_show=0:e.tbl_show=1}),t.reverse(),t.shift()},I=(l,t=[])=>{l.forEach((e,i)=>{e.childs!=null&&e.childs.length>0&&(t.push(e),I(e.childs,t))}),t.reverse(),t.forEach((e,i)=>{e.childs.filter(o=>o.tbl_show==1).length==0?e.tbl_show=0:e.tbl_show=1}),t.reverse(),t.shift()};O(()=>f.thead,(l,t)=>{a.value=JSON.parse(JSON.stringify(l)),j(a.value)},{deep:!0,immediate:!0}),O(()=>a.value,(l,t)=>{y=[],b.value=[],p.value=[],I(l),E(JSON.parse(JSON.stringify(l)));let e=M(JSON.parse(JSON.stringify(l)));J(e),V(e)},{deep:!0,immediate:!0});const{pointFormat:P}=le(),R=(l,t="")=>t=="default"?l:l==parseFloat(l)?P(l):l,v=g(null),U=async()=>{if(!f.scrolling.may_get_data)return;let l=v.value;if(l.scrollLeft!=f.scrolling.scrollLeft){f.scrolling.scrollLeft=l.scrollLeft;return}if(f.scrolling.is_last_record||!(Math.round(l.scrollTop)+l.clientHeight>=l.scrollHeight-1))return;let e=f.scrolling.page+1;T("setScrollingPage",e),await f.fnCallData()},k=g(!1),G=l=>{let t=l.label;if(l.parentIdx!=null&&l.parentIdx.length>0){let e="",i=[];l.parentIdx.forEach((s,o)=>{o==0?e=a.value[s]:e=e.childs[s],i.push(e.label)}),t=i.join(" ")+" "+t}return t},Q=l=>{if(l.parentIdx!=null&&l.parentIdx.length>0){let t="";l.parentIdx.forEach((i,s)=>{s==0?t=a.value[i]:t=t.childs[i]});let e=t.childs.map(i=>i.key).indexOf(l.key);e!=-1&&(t.childs[e].tbl_show=!t.childs[e].tbl_show)}else{let t=a.value.map(e=>e.key).indexOf(l.key);t!=-1&&(a.value[t].tbl_show=!a.value[t].tbl_show)}},F=l=>{let t=JSON.parse(JSON.stringify(a.value));l=="select"?N(t,1):N(t,0),a.value=t},N=(l,t)=>{l.forEach(e=>{e.tbl_show=t,e.childs!==void 0&&e.childs.length>0&&N(e.childs,t)})};return O(()=>f.scrolling.page,(l,t)=>{l==1&&v.value&&(v.value.scrollTop=0)},{deep:!0,immediate:!0}),(l,t)=>{const e=ce,i=te;return r(),c("div",ae,[d("div",he,[d("button",{type:"button",name:"button",class:"m-1 text-xs",onClick:t[0]||(t[0]=s=>k.value=!0)},[H(e)])]),S(k)?(r(),c("div",fe,[d("div",ue,[d("div",pe,[H(i,{style:{color:"black",cursor:"pointer"},onClick:t[1]||(t[1]=s=>k.value=!1)})]),d("div",_e,[ge,d("div",me,[(r(!0),c(u,null,m(S(p),(s,o)=>(r(),c("div",{class:x(["p-2 m-1 font-bold cursor-pointer",s.tbl_show==1?"bg-green-600 text-white":"bg-gray-400 text-black"]),onClick:n=>Q(s)},C(G(s)),11,be))),256))]),d("div",ye,[d("button",{class:"bg-white font-bold mr-2",onClick:t[2]||(t[2]=s=>F("select"))}," Select All "),d("button",{class:"bg-white font-bold",onClick:t[3]||(t[3]=s=>F("invert"))}," Invert All ")])]),d("div",{style:{position:"absolute",top:"12px",right:"98px","background-color":"rgba(255,255,255,0)",width:"37px",height:"36px","z-index":"1",cursor:"pointer"},onClick:t[4]||(t[4]=s=>k.value=!1)})])])):$("",!0),d("div",we,[h.tbody.length==0?(r(),c("div",ve," Maaf Tidak Ada Record ")):(r(),c("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:v,onScroll:U},[d("table",ke,[d("thead",Se,[(r(!0),c(u,null,m(S(b),(s,o)=>(r(),c("tr",null,[(r(!0),c(u,null,m(s,n=>(r(),c(u,null,[n.permit?L((r(),c("th",{key:0,rowspan:n.rowspan,colspan:n.colspan,class:x(n.freeze==1?"freeze":"")},C(n.label),11,xe)),[[A,n.tbl_show]]):$("",!0)],64))),256))]))),256))]),d("tbody",null,[(r(!0),c(u,null,m(h.tbody,(s,o)=>(r(),c("tr",{key:o,onClick:n=>l.$emit("setSelected",o),class:x(h.selected==o?"active":"")},[(r(!0),c(u,null,m(S(p),n=>(r(),c(u,null,[n.permit?L((r(),K(Y(n.freeze==0?"td":"th"),{key:0,class:"my-list"},{default:W(()=>[d("div",{class:x(["flex items-center",n.class?n.class:"justify-center"])},[X(l.$slots,n.key,{item:s},()=>[n.dateformat?(r(),c(u,{key:0},[q(C(s[n.key]?l.$moment(s[n.key]).format(n.dateformat):""),1)],64)):(r(),c(u,{key:1},[q(C(s[n.key]?R(s[n.key],n.type):""),1)],64))],!0)],2)]),_:2},1536)),[[A,n.tbl_show]]):$("",!0)],64))),256))],10,Ce))),128))])])],544))])])}}},Je=B(Ne,[["__scopeId","data-v-507af495"]]);export{Je as _};
