import{_ as F}from"./HeaderPopup.vue.526dbc35.js";import{_ as R}from"./WidthMiniPart.vue.86db0537.js";import q from"./CaretTop.423f4b95.js";import G from"./CaretDown.ad1803bd.js";import{Q as K,r as b,g as z,f as W,k as Q,K as X,o as i,c as r,a,b as y,t as o,l as t,n as d,C as B,d as L,G as Z,x as k,y as S}from"./entry.7dca494d.js";import{u as C}from"./useUtils.1646dabd.js";import{u as T}from"./useMyFetch.07e5797d.js";import"./Times.bb804a2f.js";import"./_plugin-vue_export-helper.c27b6911.js";const ee={class:"box-fixed"},ae={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},le={class:"w-full flex flex-col items-center grow overflow-auto"},te={class:"w-full flex flex-row flex-wrap"},se={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},oe=a("label",{for:""},"U.Jalan Per",-1),ve={class:"card-border"},_e={class:"w-6/12 sm:w-2/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},ne=a("label",{for:""},"Jenis",-1),ie={class:"card-border"},re={class:"w-6/12 sm:w-4/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},de=a("label",{for:""},"Payment Method",-1),ue={class:"card-border"},ce={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},fe=a("label",{for:""},"No Pol",-1),me={class:"card-border"},pe={key:0,class:"w-full flex flex-wrap"},xe={class:"w-full sm:w-6/12 flex flex-col flex-wrap p-1"},we=a("label",{for:""},"Uang Jalan",-1),be={class:"card-border"},he={class:"w-full sm:w-6/12 flex flex-col flex-wrap p-1"},ye=a("label",{for:""},"Note For Remarks",-1),ke={class:"card-border"},ge={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},De=a("label",{for:""},"Supir",-1),Ye={class:"card-border"},Ie={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Ne=a("label",{for:""},"Kernet",-1),Me={class:"card-border"},Se=a("div",{class:"w-full flex flex-col flex-wrap p-1 bg-yellow-300 font-bold mt-5 text-red-900"}," Informasi Pembayaran ( Harap di baca sebelum melakukan unvalidasi ) ",-1),Ce={class:"w-full md:w-4/12 flex flex-wrap"},Te={class:"w-full flex flex-col flex-wrap p-1"},Ae=a("label",{for:""},"Sudah dibayarkan ?",-1),He={class:"card-border"},$e={class:"w-full sm:w-6/12 md:w-4/12 flex flex-wrap flex-col p-1"},Pe=a("label",{for:""},"Duitku Supir",-1),Oe={class:"card-border !flex flex-row flex-wrap"},je={class:"w-4/12 flex-col"},Ve=a("div",{class:"font-bold"},"ID",-1),Be={class:"w-4/12 flex-col pl-1"},Le=a("div",{class:"font-bold"},"Inquery",-1),Je={class:"w-4/12 flex-col pl-1"},Ee=a("div",{class:"font-bold"},"Transfer",-1),Ue={class:"w-full sm:w-6/12 md:w-4/12 flex flex-wrap flex-col p-1"},Fe=a("label",{for:""},"Duitku Kernet",-1),Re={class:"card-border !flex flex-row flex-wrap"},qe={class:"w-4/12 flex-col"},Ge=a("div",{class:"font-bold"},"ID",-1),Ke={class:"w-4/12 flex-col pl-1"},ze=a("div",{class:"font-bold"},"Inquery",-1),We={class:"w-4/12 flex-col pl-1"},Qe=a("div",{class:"font-bold"},"Transfer",-1),Xe={class:"w-full sm:w-6/12 md:w-6/12 flex flex-wrap flex-col p-1"},Ze=a("label",{for:""},"Cost Center",-1),ea={class:"card-border !flex flex-row flex-wrap"},aa={class:"w-6/12 flex-col"},la=a("div",{class:"font-bold"},"Code",-1),ta={class:"w-6/12 flex-col pl-1"},sa=a("div",{class:"font-bold"},"Desc",-1),oa={class:"w-full sm:w-6/12 md:w-3/12 flex flex-wrap flex-col p-1"},va=a("label",{for:""},"PVR",-1),_a={class:"card-border !flex flex-row flex-wrap"},na={class:"w-6/12 flex-col"},ia=a("div",{class:"font-bold"},"No",-1),ra={class:"w-6/12 flex-col pl-1"},da=a("div",{class:"font-bold"},"Total",-1),ua={class:"w-full sm:w-6/12 md:w-3/12 flex flex-wrap flex-col p-1"},ca=a("label",{for:""},"PV",-1),fa={class:"card-border !flex flex-row flex-wrap"},ma={class:"w-6/12 flex-col"},pa=a("div",{class:"font-bold"},"No",-1),xa={class:"w-6/12 flex-col pl-1"},wa=a("div",{class:"font-bold"},"Amount",-1),ba={class:"w-full flex items-center justify-end"},ha={class:"w-full flex flex-wrap p-3 items-center"},ya=a("div",null," Di Validasi oleh : ",-1),ka={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},ga={key:0},Da={key:1},Ya={key:2},Ia={key:3},Na={key:4},Ma={key:5},Sa={key:6},Ca={key:0,class:"text-xs font-bold"},Ta={key:0,class:"text-xs font-bold"},Ea={__name:"trx_trp_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},it_state:{type:Number,required:!1,default:-1}},emits:["setID","setIndex"],setup(h,{emit:g}){const _=h,{$moment:w}=Z(),{pointFormat:D}=C();let Y=s=>{s.key=="ArrowUp"&&V(),s.key=="ArrowDown"&&j()};K(()=>{document.removeEventListener("keydown",Y)});const e=b({...{id:-1,tanggal:new Date,payment_method:{name:""},id_uj:-1,xto:"",tipe:"",jenis:"",amount:0,pv_id:-1,pv_no:"",pv_total:0,supir:"",kernet:"",no_pol:"",val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:"",val3:0,val3_by:{username:""},val3_at:"",val4:0,val4_by:{username:""},val4_at:"",val5:0,val5_by:{username:""},val5_at:"",val6:0,val6_by:{username:""},val6_at:"",cost_center_code:"",cost_center_desc:"",pvr_id:"",pvr_no:"",pvr_total:"",pvr_had_detail:""}}),I=z("token"),A=b(null),H=b(null),u=b(""),$={_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:-1,name:"",title:"",note:""},c=b(JSON.parse(JSON.stringify($))),f=b(JSON.parse(JSON.stringify($))),P={_raw:{},_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},xto:{tcon:"IconsLocationOn",text:"Tujuan",val:""},asst_opt:{tcon:"IconsPerson",text:"Info",val:""},tipe:{tcon:"",text:"Tipe",val:""},harga:{tcon:"IconsMoney",text:"Amount",val:""}},id:"",name:"",title:"",note:""},O=b(JSON.parse(JSON.stringify(P))),J=async()=>{u.value="PROSES...",k().loading_full=!0;const s=new FormData;let v="post",m=_.id;m==0||(s.append("id",m),s.append("_method","PUT"));const{data:l,error:p,status:x}=await T("/trx_trp_validasi",{method:v,headers:{Authorization:`Bearer ${I.value}`,Accept:"application/json"},body:s,retry:0});if(k().loading_full=!1,x.value==="error"){u.value="GAGAL",S().trigger(p);return}e.value.val=l.value.val,e.value.val_user=l.value.val_user,e.value.val_by=l.value.val_by,e.value.val_at=l.value.val_at,e.value.val1=l.value.val1,e.value.val1_user=l.value.val1_user,e.value.val1_by=l.value.val1_by,e.value.val1_at=l.value.val1_at,e.value.val2=l.value.val2,e.value.val2_user=l.value.val2_user,e.value.val2_by=l.value.val2_by,e.value.val2_at=l.value.val2_at,e.value.val3=l.value.val3,e.value.val3_user=l.value.val3_user,e.value.val3_by=l.value.val3_by,e.value.val3_at=l.value.val3_at,e.value.val4=l.value.val4,e.value.val4_user=l.value.val4_user,e.value.val4_by=l.value.val4_by,e.value.val4_at=l.value.val4_at,e.value.val5=l.value.val5,e.value.val5_user=l.value.val5_user,e.value.val5_by=l.value.val5_by,e.value.val5_at=l.value.val5_at,e.value.val6=l.value.val6,e.value.val6_user=l.value.val6_user,e.value.val6_by=l.value.val6_by,e.value.val6_at=l.value.val6_at;let n=_.p_data.map(M=>M.id).indexOf(_.id);n>=-1&&_.p_data.splice(n,1,{...e.value}),u.value="BERHASIL"},E=async()=>{u.value="PROSES...",k().loading_full=!0;const s=new FormData;let v="post",m=_.id;m==0||(s.append("id",m),s.append("_method","PUT"));const{data:l,error:p,status:x}=await T("/trx_trp_unvalidasi",{method:v,headers:{Authorization:`Bearer ${I.value}`,Accept:"application/json"},body:s,retry:0});if(k().loading_full=!1,x.value==="error"){u.value="GAGAL",S().trigger(p);return}e.value.val=l.value.val,e.value.val_user=l.value.val_user,e.value.val_by=l.value.val_by,e.value.val_at=l.value.val_at,e.value.val1=l.value.val1,e.value.val1_user=l.value.val1_user,e.value.val1_by=l.value.val1_by,e.value.val1_at=l.value.val1_at,e.value.val2=l.value.val2,e.value.val2_user=l.value.val2_user,e.value.val2_by=l.value.val2_by,e.value.val2_at=l.value.val2_at,e.value.val3=l.value.val3,e.value.val3_user=l.value.val3_user,e.value.val3_by=l.value.val3_by,e.value.val3_at=l.value.val3_at,e.value.val4=l.value.val4,e.value.val4_user=l.value.val4_user,e.value.val4_by=l.value.val4_by,e.value.val4_at=l.value.val4_at,e.value.val5=l.value.val5,e.value.val5_user=l.value.val5_user,e.value.val5_by=l.value.val5_by,e.value.val5_at=l.value.val5_at,e.value.val6=l.value.val6,e.value.val6_user=l.value.val6_user,e.value.val6_by=l.value.val6_by,e.value.val6_at=l.value.val6_at;let n=_.p_data.map(M=>M.id).indexOf(_.id);n>=-1&&_.p_data.splice(n,1,{...e.value}),u.value="BERHASIL"},U=s=>{let v=JSON.parse(JSON.stringify(P));return v._.id.val=s.id,v._.xto.val=s.xto,v._.asst_opt.val=s.asst_opt,v._.tipe.val=s.tipe,v._.harga.val=D(s.harga),v.id=s.id,v.name=s.xto,v.title=(s.asst_opt||"")+" "+(s.tipe||"")+" "+(D(s.harga)||""),v._raw=s,v},N=async()=>{u.value="",k().loading_full=!0;const{data:s,error:v,status:m}=await T("/trx_trp",{method:"get",headers:{Authorization:`Bearer ${I.value}`,Accept:"application/json"},params:{id:_.id},retry:0});if(k().loading_full=!1,m.value==="error"){S().trigger(v);return}let l=s.value.data;e.value=l,c.value._.id.val=l.supir_id,c.value._.name.val=l.supir,c.value._.rek_no.val=l.supir_rek_no,c.value._.rek_name.val=l.supir_rek_name,c.value.id=l.supir_id,c.value.name=l.supir,c.value.rek_no=(l.supir_rek_no||"")+" "+(l.supir_rek_name||""),f.value._.id.val=l.kernet_id,f.value._.name.val=l.kernet,f.value._.rek_no.val=l.kernet_rek_no,f.value._.rek_name.val=l.kernet_rek_name,f.value.id=l.kernet_id,f.value.name=l.kernet,f.value.rek_no=(l.kernet_rek_no||"")+" "+(l.kernet_rek_name||""),O.value=U(l.uj);let p=0,x=0;l.potongan.forEach(n=>{n.potongan_mst.employee_id==l.supir_id&&(p+=parseInt(n.nominal_cut)),n.potongan_mst.employee_id==l.kernet_id&&(x+=parseInt(n.nominal_cut))}),c.value.note="",f.value.note="",p>0&&(c.value.note="Telah di potong sebesar :"+C().pointFormat(p)),x>0&&(f.value.note="Telah di potong sebesar :"+C().pointFormat(x))};W(()=>_.show,(s,v)=>{s==!0?(document.addEventListener("keydown",Y),_.it_state==1&&setTimeout(()=>{A.value.focus()},1),_.it_state==0&&setTimeout(()=>{H.value.focus()},1),N()):document.removeEventListener("keydown",Y)},{immediate:!0});const j=()=>{let s=_.p_data.map(v=>v.id).indexOf(_.id);s!=_.p_data.length-1&&(s++,g("setID",_.p_data[s].id),g("setIndex",s),setTimeout(()=>{N()},100))},V=()=>{let s=_.p_data.map(v=>v.id).indexOf(_.id);s!=0&&(s--,g("setID",_.p_data[s].id),g("setIndex",s),setTimeout(()=>{N()},100))};return(s,v)=>{const m=F,l=R,p=q,x=G;return Q((i(),r("section",ee,[a("div",null,[y(m,{title:"Form Transaction Validation",fn:h.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),a("form",ae,[a("div",le,[a("div",te,[a("div",se,[oe,a("div",ve,o(t(e).tanggal?t(w)(t(e).tanggal).format("DD-MM-YYYY"):""),1)]),a("div",_e,[ne,a("div",ie,o(t(e).jenis),1)]),a("div",re,[de,a("div",ue,o(t(e).payment_method.name),1)]),a("div",ce,[fe,a("div",me,o(t(e).no_pol),1)]),t(e).jenis!=""?(i(),r("div",pe,[a("div",xe,[we,a("div",be,[y(l,{selected:t(O)},null,8,["selected"])])]),a("div",he,[ye,a("div",ke,o(t(e).note_for_remarks),1)])])):d("",!0),a("div",ge,[De,a("div",Ye,[y(l,{selected:t(c)},null,8,["selected"])])]),a("div",Ie,[Ne,a("div",Me,[y(l,{selected:t(f)},null,8,["selected"])])]),Se,a("div",Ce,[a("div",Te,[Ae,a("div",He,o(t(e).received_payment?"Ya":"Tidak"),1)])]),a("div",$e,[Pe,a("div",Oe,[a("div",je,[Ve,a("div",null,o(t(e).duitku_supir_disburseId),1)]),a("div",Be,[Le,a("div",null,o(t(e).duitku_supir_inv_res_desc),1)]),a("div",Je,[Ee,a("div",null,o(t(e).duitku_supir_trf_res_desc),1)])])]),a("div",Ue,[Fe,a("div",Re,[a("div",qe,[Ge,a("div",null,o(t(e).duitku_kernet_disburseId),1)]),a("div",Ke,[ze,a("div",null,o(t(e).duitku_kernet_inv_res_desc),1)]),a("div",We,[Qe,a("div",null,o(t(e).duitku_kernet_trf_res_desc),1)])])]),a("div",Xe,[Ze,a("div",ea,[a("div",aa,[la,a("div",null,o(t(e).cost_center_code),1)]),a("div",ta,[sa,a("div",null,o(t(e).cost_center_desc),1)])])]),a("div",oa,[va,a("div",_a,[a("div",na,[ia,a("div",null,o(t(e).pvr_no),1)]),a("div",ra,[da,a("div",null,o(t(D)(t(e).pvr_total||0)),1)])])]),a("div",ua,[ca,a("div",fa,[a("div",ma,[pa,a("div",null,o(t(e).pv_no),1)]),a("div",xa,[wa,a("div",null,o(t(D)(t(e).pv_total||0)),1)])])])])]),a("div",ba,[a("div",ha,[ya,t(e).val||t(e).val1||t(e).val2||t(e).val3||t(e).val4||t(e).val5||t(e).val6?(i(),r("div",ka,[t(e).val?(i(),r("div",ga," Kasir : "+o(t(e).val_by.username)+" ( "+o(t(e).val_at?t(w)(t(e).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):d("",!0),t(e).val1?(i(),r("div",Da," Mandor : "+o(t(e).val1_by.username)+" ( "+o(t(e).val1_at?t(w)(t(e).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):d("",!0),t(e).val2?(i(),r("div",Ya," KTU/W : "+o(t(e).val2_by.username)+" ( "+o(t(e).val2_at?t(w)(t(e).val2_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):d("",!0),t(e).val3?(i(),r("div",Ia," Marketing : "+o(t(e).val3_by.username)+" ( "+o(t(e).val3_at?t(w)(t(e).val3_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):d("",!0),t(e).val4?(i(),r("div",Na," Logistik : "+o(t(e).val4_by.username)+" ( "+o(t(e).val4_at?t(w)(t(e).val4_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):d("",!0),t(e).val5?(i(),r("div",Ma," SPV Logistik : "+o(t(e).val5_by.username)+" ( "+o(t(e).val5_at?t(w)(t(e).val5_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):d("",!0),t(e).val6?(i(),r("div",Sa," MGR Logistik : "+o(t(e).val6_by.username)+" ( "+o(t(e).val6_at?t(w)(t(e).val6_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):d("",!0)])):d("",!0)]),a("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:v[0]||(v[0]=n=>V())},[y(p,{class:"black"})]),a("button",{type:"button",name:"button",class:"w-36 m-1",onClick:v[1]||(v[1]=n=>h.fnClose())}," Cancel "),h.it_state==1?(i(),r("button",{key:0,ref_key:"it_val",ref:A,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:v[2]||(v[2]=B(n=>J(),["prevent"]))},[L(" Validasi "),t(u)!=""?(i(),r("div",Ca,o(t(u)),1)):d("",!0)],512)):d("",!0),h.it_state==0?(i(),r("button",{key:1,ref_key:"it_unval",ref:H,type:"submit",name:"button",class:"w-36 m-1 bg-yellow-600 text-white rounded-sm",onClick:v[3]||(v[3]=B(n=>E(),["prevent"]))},[L(" Unvalidasi "),t(u)!=""?(i(),r("div",Ta,o(t(u)),1)):d("",!0)],512)):d("",!0),a("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:v[4]||(v[4]=n=>j())},[y(x,{class:"black"})])])])])],512)),[[X,h.show]])}}};export{Ea as default};
