import{_ as R}from"./HeaderPopup.vue.4e2f3813.js";import P from"./Times.f67ad23e.js";import E from"./Check.83fb5fc6.js";import{r as x,g as K,i as $,f as J,k as O,K as Q,o as r,c as u,a as e,b as G,t as l,l as t,d as k,F as j,D as z,E as w,z as S,n as m,C as U,G as L,x as b,y as T,p as W,e as X}from"./entry.717b1444.js";import{u as Z}from"./useUtils.8a7aa554.js";import{u as q}from"./useMyFetch.666735e9.js";import{_ as ee}from"./_plugin-vue_export-helper.c27b6911.js";const a=p=>(W("data-v-efd7e8d8"),p=p(),X(),p),te={class:"box-fixed"},se={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},le={class:"w-full flex flex-col items-center grow overflow-auto"},ae={class:"w-full flex flex-row flex-wrap"},oe={class:"w-full sm:w-8/12 md:w-5/12 lg:w-5/12 flex flex-col flex-wrap p-1"},ce=a(()=>e("label",{for:""},"To",-1)),ne={class:"card-border"},ie={class:"w-1/2 sm:w-2/12 md:w-1/12 lg:w-1/12 flex flex-col flex-wrap p-1"},re=a(()=>e("label",{for:""},"Jenis",-1)),de={class:"card-border"},_e={class:"w-1/2 sm:w-2/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},ue=a(()=>e("label",{for:""},"Trip Bonus Supir",-1)),fe={class:"card-border"},pe={class:"w-1/2 sm:w-2/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},ve=a(()=>e("label",{for:""},"Trip Bonus Kernet",-1)),me={class:"card-border"},he={class:"w-1/2 sm:w-2/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},we=a(()=>e("label",{for:""},"KM Range",-1)),xe={class:"card-border"},be={class:"w-1/2 sm:w-2/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},ye=a(()=>e("label",{for:""},"Harga",-1)),ge={class:"card-border"},ke={class:"w-1/2 sm:w-3/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},je=a(()=>e("label",{for:""},"Asal Peralihan",-1)),De={class:"card-border"},Ce={class:"w-full sm:w-7/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Ae=a(()=>e("label",{for:""},"Tipe",-1)),Te={class:"card-border"},qe={class:"w-full sm:w-full md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Fe=a(()=>e("label",{for:""},"Ket. Untuk Remarks",-1)),Ve={class:"card-border"},Be={class:"w-full flex flex-col sm:flex-row grow p-1 justify-between flex-wrap 2xl:overflow-hidden"},Ne={class:"w-full max-w-full 2xl:w-1/2 2xl:overflow-auto 2xl:pr-1 2xl:max-h-full"},$e={class:"w-full",role:"sticky"},ze={class:"tacky w-full !table-auto whitespace-normal"},Se=a(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"6",class:"!bg-slate-800 text-white font-bold"}," Detail Uang Jalan ")],-1)),Ue={class:"sticky top-8 !z-[2]"},Ye=a(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),He=a(()=>e("th",{class:"min-w-[150px] !w-[150px] max-w-[150px]"},"Desc",-1)),Ie=a(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Harga @",-1)),Me=a(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"Qty",-1)),Re={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Pe=a(()=>e("br",null,null,-1)),Ee={class:"text-sm"},Ke=a(()=>e("th",{class:"min-w-[70px] !w-[70px] max-w-[70px] whitespace-break-spaces"},"For Remarks",-1)),Je={ref:"to_move"},Oe=["data-index"],Qe={class:"cell"},Ge={class:"w-full h-auto flex items-center justify-center"},Le={class:"cell bold"},We={class:"w-full h-auto flex items-center justify-center"},Xe={class:"cell"},Ze={class:"w-full h-auto flex items-center justify-center"},et={class:"cell"},tt={class:"w-full h-auto flex items-center justify-center"},st={class:"cell"},lt={class:"w-full h-auto flex items-center justify-center"},at={class:"w-full max-w-full 2xl:w-1/2 2xl:overflow-auto 2xl:pl-1 2xl:max-h-full pt-1 2xl:pt-0"},ot={class:"w-full",role:"sticky"},ct={class:"tacky w-full !table-auto whitespace-normal"},nt=a(()=>e("tr",{class:"sticky top-0 !z-[2]"},[e("td",{colspan:"9",class:"!bg-slate-800 text-white font-bold"}," Detail PVR ")],-1)),it={class:"sticky top-8 !z-[2]"},rt=a(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),dt=a(()=>e("th",{class:"min-w-[60px] !w-[60px] max-w-[60px]"},"Acc ID",-1)),_t=a(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),ut=a(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),ft=a(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),pt=a(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Amount",-1)),vt=a(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Qty",-1)),mt=a(()=>e("th",{class:"min-w-[80px] !w-[80px] max-w-[80px]"},"For",-1)),ht={class:"min-w-[100px] !w-[100px] max-w-[100px]"},wt=a(()=>e("br",null,null,-1)),xt={class:"text-sm"},bt={ref:"to_move"},yt=["data-index"],gt={class:"w-full h-auto flex items-center justify-center"},kt={class:"w-full h-auto flex items-center justify-center"},jt={class:"w-full h-auto flex items-center justify-center"},Dt={key:0,class:"cell"},Ct={class:"w-full h-auto flex items-center justify-center"},At={class:"w-full h-auto flex items-center justify-center"},Tt={class:"cell"},qt={class:"w-full h-auto flex items-center justify-center"},Ft={class:"w-full flex items-center justify-end"},Vt={class:"w-full flex flex-wrap p-3 items-center"},Bt=a(()=>e("div",null," Di Validasi oleh : ",-1)),Nt={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},$t={key:0},zt={key:1},St={__name:"ujalan_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},it_state:{type:Number,required:!1,default:-1}},setup(p){const d=p,{$moment:F}=L(),{pointFormat:f}=Z(),s=x({...{id:-1,xto:"",km_range:0,bonus_trip_supir:0,bonus_trip_kernet:0,tipe:"",jenis:"",harga:0,note_for_remarks:0,details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:""}}),D=K("token"),g=x({}),V=x(null),B=x(null),N=x([]),C=x([]),Y=async()=>{b().loading_full=!0,g.value={};const n=new FormData;let i="post",v=d.id;v==0||(n.append("id",v),n.append("_method","PUT"));const{data:c,error:y,status:o}=await q("/ujalan_validasi",{method:i,headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},body:n,retry:0});if(b().loading_full=!1,o.value==="error"){T().trigger(y,g);return}s.value.val=c.value.val,s.value.val_user=c.value.val_user,s.value.val_by=c.value.val_by,s.value.val_at=c.value.val_at,s.value.val1=c.value.val1,s.value.val1_user=c.value.val1_user,s.value.val1_by=c.value.val1_by,s.value.val1_at=c.value.val1_at;let _=d.p_data.map(A=>A.id).indexOf(d.id);_>-1&&d.p_data.splice(_,1,{...s.value}),d.fnClose()},H=async()=>{b().loading_full=!0,g.value={};const n=new FormData;let i="post",v=d.id;v==0||(n.append("id",v),n.append("_method","PUT"));const{data:c,error:y,status:o}=await q("/ujalan_unvalidasi",{method:i,headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},body:n,retry:0});if(b().loading_full=!1,o.value==="error"){T().trigger(y,g);return}s.value.val=c.value.val,s.value.val_user=c.value.val_user,s.value.val_by=c.value.val_by,s.value.val_at=c.value.val_at,s.value.val1=c.value.val1,s.value.val1_user=c.value.val1_user,s.value.val1_by=c.value.val1_by,s.value.val1_at=c.value.val1_at;let _=d.p_data.map(A=>A.id).indexOf(d.id);_>-1&&d.p_data.splice(_,1,{...s.value}),d.fnClose()},I=async()=>{b().loading_full=!0;const{data:n,error:i,status:v}=await q("/ujalan_",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},params:{id:d.id},retry:0});if(b().loading_full=!1,v.value==="error"){T().trigger(i);return}s.value=n.value.data,N.value=n.value.data.details,C.value=n.value.data.details2},M=$(()=>{let n=0;return C.value.forEach(i=>{i.p_status!="Remove"&&(n+=i.qty*i.amount)}),n}),h=$(()=>!1);return J(()=>d.show,(n,i)=>{n==!0&&(d.it_state==1&&setTimeout(()=>{V.value.focus()},1),d.it_state==0&&setTimeout(()=>{B.value.focus()},1),I())},{immediate:!0}),(n,i)=>{const v=R,c=P,y=E;return O((r(),u("section",te,[e("div",null,[G(v,{title:"Form Ujalan Validation",fn:p.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",se,[e("div",le,[e("div",ae,[e("div",oe,[ce,e("div",ne,l(t(s).xto),1)]),e("div",ie,[re,e("div",de,l(t(s).jenis),1)]),e("div",_e,[ue,e("div",fe,l(t(f)(t(s).bonus_trip_supir||0)),1)]),e("div",pe,[ve,e("div",me,l(t(f)(t(s).bonus_trip_kernet||0)),1)]),e("div",he,[we,e("div",xe,l(t(f)(t(s).km_range||0)),1)]),e("div",be,[ye,e("div",ge,l(t(f)(t(s).harga||0)),1)]),e("div",ke,[je,e("div",De,l(t(s).transition_from),1)]),e("div",Ce,[Ae,e("div",Te,l(t(s).tipe),1)]),e("div",qe,[Fe,e("div",Ve,l(t(s).note_for_remarks),1)])]),e("div",Be,[e("div",Ne,[e("div",$e,[e("table",ze,[e("thead",null,[Se,e("tr",Ue,[Ye,He,Ie,Me,e("th",Re,[k("Total "),Pe,k(),e("span",Ee,"("+l(t(f)(t(s).harga||0))+")",1)]),Ke])]),e("tbody",Je,[(r(!0),u(j,null,z(t(N),(o,_)=>(r(),u(j,{key:_},[o.p_status!="Remove"?(r(),u("tr",{key:0,"data-index":_},[e("td",null,l(_+1)+".",1),e("td",Qe,[e("div",Ge,l(o.xdesc),1)]),e("td",Le,[e("div",We,l(t(f)(o.harga||0)),1)]),e("td",Xe,[e("div",Ze,l(t(f)(o.qty||0)),1)]),e("td",et,[e("div",tt,l(t(f)(o.qty*o.harga||0)),1)]),e("td",st,[e("div",lt,[e("div",{class:w(["text-white rounded text-xl w-5 h-5",o.for_remarks?"bg-green-600":"bg-red-600"])},[o.for_remarks==0?(r(),S(c,{key:0})):(r(),S(y,{key:1}))],2)])])],8,Oe)):m("",!0)],64))),128))],512)])])]),e("div",at,[e("div",ot,[e("table",ct,[e("thead",null,[nt,e("tr",it,[rt,dt,_t,ut,ft,pt,vt,mt,e("th",ht,[k("Total "),wt,k(),e("span",xt,"("+l(t(f)(t(M)))+")",1)])])]),e("tbody",bt,[(r(!0),u(j,null,z(t(C),(o,_)=>(r(),u(j,{key:_},[o.p_status!="Remove"?(r(),u("tr",{key:0,"data-index":_},[e("td",null,l(_+1)+".",1),e("td",{class:w(["cell bold",t(h)?"unselectable":""])},[e("div",gt,l(o.ac_account_id),1)],2),e("td",{class:w(["cell bold",t(h)?"unselectable":""])},[e("div",kt,l(o.ac_account_code),1)],2),e("td",{class:w(["cell bold",t(h)?"unselectable":""])},[e("div",jt,l(o.ac_account_name),1)],2),t(h)?m("",!0):(r(),u("td",Dt,[e("div",Ct,l(o.description),1)])),e("td",{class:w(["cell bold",t(h)?"unselectable":""])},[e("div",At,l(t(f)(o.amount||0)),1)],2),e("td",{class:w(["cell",t(h)?"unselectable":""])},l(t(f)(o.qty||0)),3),e("td",{class:w(["cell",t(h)?"unselectable":""])},l(o.xfor),3),e("td",Tt,[e("div",qt,l(t(f)(o.qty*o.amount||0)),1)])],8,yt)):m("",!0)],64))),128))],512)])])])])]),e("div",Ft,[e("div",Vt,[Bt,t(s).val||t(s).val1?(r(),u("div",Nt,[t(s).val?(r(),u("div",$t," App 1 : "+l(t(s).val_by.username)+" ( "+l(t(s).val_at?t(F)(t(s).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0),t(s).val1?(r(),u("div",zt," App 2 : "+l(t(s).val1_by.username)+" ( "+l(t(s).val1_at?t(F)(t(s).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0)])):m("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:i[0]||(i[0]=o=>p.fnClose())}," Cancel "),p.it_state==1?(r(),u("button",{key:0,ref_key:"it_val",ref:V,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:i[1]||(i[1]=U(o=>Y(),["prevent"]))}," Validasi ",512)):m("",!0),p.it_state==0?(r(),u("button",{key:1,ref_key:"it_unval",ref:B,type:"submit",name:"button",class:"w-36 m-1 bg-yellow-600 text-white rounded-sm",onClick:i[2]||(i[2]=U(o=>H(),["prevent"]))}," Unvalidasi ",512)):m("",!0)])])])],512)),[[Q,p.show]])}}},Kt=ee(St,[["__scopeId","data-v-efd7e8d8"]]);export{Kt as default};
