import{_ as oe}from"./Header.f554cf83.js";import{_ as le}from"./Plus.8d5dcac8.js";import{_ as ne}from"./Edit.73104f33.js";import{_ as ie}from"./Delete.ada91d15.js";import{_ as re}from"./useUtils.7cd85c78.js";import{_ as ue}from"./PopupMini.vue.00e6cd56.js";import{_ as de}from"./HeaderPopup.vue.defde764.js";import{r as v,f as q,g as ce,h as y,v as _e,o as $,c as S,a as e,b as x,k as a,j,t as m,l as H,m as pe,x as h,y as M,p as O,e as Y,O as fe,D as ve,B as me,H as E,I as he,i as we,F as R,n as ge,E as xe,q as ye,s as ke}from"./entry.6be760ba.js";import{u as T}from"./useMyFetch.8f65d93e.js";import{_ as K}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.51b886a8.js";const A=c=>(O("data-v-d2484975"),c=c(),Y(),c),be={class:"box-fixed"},$e={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},Se={class:"w-full flex flex-col items-center grow overflow-auto"},Ae={class:"w-full flex flex-row flex-wrap"},De={class:"w-full flex flex-col flex-wrap p-1"},Ce=A(()=>e("label",{for:""},"Username",-1)),Me={class:"text-red-500"},Te={class:"w-full flex flex-col flex-wrap p-1"},Ue=A(()=>e("label",{for:""},"Password",-1)),Ie={class:"text-red-500"},Be={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Fe=A(()=>e("label",{for:""},"Hak Akses",-1)),He=fe('<option value="PabrikTransport" data-v-d2484975>Pabrik Transport</option><option value="Logistic" data-v-d2484975>Logisitic</option><option value="Finance" data-v-d2484975>Finance</option><option value="Marketing" data-v-d2484975>Marketing</option><option value="MIS" data-v-d2484975>MIS</option><option value="SuperAdmin" data-v-d2484975>SuperAdmin</option>',6),Le=[He],Ve={class:"text-red-500"},Pe={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},je=A(()=>e("label",{for:""},"Status",-1)),ze=A(()=>e("option",{value:"1"},"Aktif",-1)),Ne=A(()=>e("option",{value:"0"},"Nonaktif",-1)),Ee=[ze,Ne],Re={class:"text-red-500"},qe={class:"w-full flex items-center justify-end"},Oe={__name:"user",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},setup(c){const u=c,D={id:-1,username:"",password:"",hak_akses:"PabrikTransport",is_active:1},s=v({...D}),p=q("token"),f=v({}),_=async()=>{h().loading_full=!0,f.value={};const o=new FormData;o.append("username",s.value.username),s.value.password&&o.append("password",s.value.password),o.append("hak_akses",s.value.hak_akses),o.append("is_active",s.value.is_active);let t="post",l=u.id;l==0||(o.append("id",l),o.append("_method","PUT"));const{data:i,error:b,status:U}=await T("/user",{method:t,headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},body:o,retry:0});if(h().loading_full=!1,U.value==="error"){M().trigger(b,f);return}if(u.id<=0)s.value.id=i.value.id,s.value.created_at=i.value.created_at,s.value.updated_at=i.value.updated_at,u.p_data.unshift(s.value);else{s.value.updated_at=i.value.updated_at;let I=u.p_data.map(L=>L.id).indexOf(u.id);I>=-1&&u.p_data.splice(I,1,{...s.value})}u.fnClose()},g=async()=>{h().loading_full=!0;const{data:o,error:t,status:l}=await T("/user",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:{id:u.id},retry:0});if(h().loading_full=!1,l.value==="error"){M().trigger(t);return}s.value=o.value.data};return ce(()=>u.show,(o,t)=>{o==!0&&(s.value={...D},f.value={},u.id!=0&&g())},{immediate:!0}),(o,t)=>{const l=de;return y(($(),S("section",be,[e("div",null,[x(l,{title:"Form User",fn:c.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",$e,[e("div",Se,[e("div",Ae,[e("div",De,[Ce,y(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=i=>a(s).username=i)},null,512),[[j,a(s).username]]),e("p",Me,m(a(f).username),1)]),e("div",Te,[Ue,y(e("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=i=>a(s).password=i)},null,512),[[j,a(s).password]]),e("p",Ie,m(a(f).password),1)]),e("div",Be,[Fe,y(e("select",{"onUpdate:modelValue":t[2]||(t[2]=i=>a(s).hak_akses=i)},Le,512),[[H,a(s).hak_akses]]),e("p",Ve,m(a(f).hak_akses),1)]),e("div",Pe,[je,y(e("select",{"onUpdate:modelValue":t[3]||(t[3]=i=>a(s).is_active=i)},Ee,512),[[H,a(s).is_active]]),e("p",Re,m(a(f).is_active),1)])])]),e("div",qe,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:t[4]||(t[4]=i=>c.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:t[5]||(t[5]=pe(i=>_(),["prevent"]))}," Save ")])])])],512)),[[_e,c.show]])}}},Ye=K(Oe,[["__scopeId","data-v-d2484975"]]);const w=c=>(O("data-v-a6cba22e"),c=c(),Y(),c),Ke={class:"w-full h-full flex flex-col"},Je={class:"w-full flex grow flex-col overflow-auto h-0"},Ze={class:"w-full flex"},Ge={class:"w-full flex p-1"},Qe={class:"grow"},We=w(()=>e("div",{class:"font-bold"}," Keyword ",-1)),Xe={class:"pl-1"},et=w(()=>e("div",{class:"font-bold"}," Sort By ",-1)),tt=w(()=>e("option",{value:""},null,-1)),at=w(()=>e("option",{value:"username"},"Username",-1)),st=w(()=>e("option",{value:"hak_akses"},"Hak Akses",-1)),ot=w(()=>e("option",{value:"is_active"},"Status",-1)),lt=[tt,at,st,ot],nt={class:"pl-1"},it=w(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),rt=w(()=>e("option",{value:"asc"},"Asc",-1)),ut=w(()=>e("option",{value:"desc"},"Desc",-1)),dt=[rt,ut],ct={class:"flex items-end pl-1"},_t={class:"w-full flex justify-center items-center grow h-0 p-1"},pt={key:0,class:""},ft={class:"tacky"},vt=w(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"Username"),e("th",null,"Hak Akses"),e("th",null,"Status"),e("th",null,"Tanggal Dibuat"),e("th",null,"Tanggal Diubah")])],-1)),mt=["onClick"],ht={class:"bold"},wt={__name:"index",async setup(c){let u,D;const{$moment:s}=ke(),p={};p._TimeZoneOffset=new Date().getTimezoneOffset();const f=q("token"),{data:_}=([u,D]=ve(async()=>xe(async()=>{h().loading_full=!0;const{data:r,error:n,status:k}=await T("/users",{method:"get",headers:{Authorization:`Bearer ${f.value}`,Accept:"application/json"},params:p,retry:0});return h().loading_full=!1,k.value==="error"?(M().trigger(n),[]):r.value.data},"$4SJ9UL5Y8i")),u=await u,D(),u),g=v(""),o=v({field:"",by:"desc"}),t=v(-1),l=v({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),i=()=>{p.like="",g.value!=""&&(p.like=`id:%${g.value}%,username:%${g.value}%`),p.sort="",o.value.field&&(p.sort=o.value.field+":"+o.value.by)},b=v(null),U=async()=>{h().loading_full=!0,l.value.may_get_data=!1,p.page=l.value.page,p.page==1&&(_.value=[]);const{data:r,error:n,status:k}=await T("/users",{method:"get",headers:{Authorization:`Bearer ${f.value}`,Accept:"application/json"},params:p,retry:0});if(h().loading_full=!1,l.value.may_get_data=!0,k.value==="error"){M().trigger(n);return}l.value.page==1?(_.value=r.value.data,b.value&&(b.value.scrollTop=0)):l.value.page>1&&(_.value=[..._.value,...r.value.data]),r.value.data.length==0&&(l.value.is_last_record=!0)},I=async()=>{if(!l.value.may_get_data)return;let r=b.value;if(r.scrollLeft!=l.value.scrollLeft){l.value.scrollLeft=r.scrollLeft;return}l.value.is_last_record||!(Math.round(r.scrollTop)+r.clientHeight>=r.scrollHeight-1)||(l.value.page++,await U())},L=()=>{l.value.page=1,l.value.is_last_record=!1,i(),U()};me();const B=v(!1),V=v(0),J=()=>{V.value=0,B.value=!0},{display:z}=E();he(E());const Z=()=>{t.value==-1?z({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(V.value=_.value[t.value].id,B.value=!0)},N=v({}),C=v(!1),G=async()=>{C.value&&(C.value=!1)},Q=()=>{t.value==-1?z({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(N.value={id:_.value[t.value].id},C.value=!0)},W=async()=>{h().loading_full=!0;const r=new FormData;r.append("id",_.value[t.value].id),r.append("_method","DELETE");const{data:n,error:k,status:P}=await T("/user",{method:"post",headers:{Authorization:`Bearer ${f.value}`,Accept:"application/json"},body:r,retry:0});if(h().loading_full=!1,P.value==="error"){M().trigger(k);return}_.value.splice(t.value,1),t.value=-1,C.value=!1};return(r,n)=>{const k=oe,P=le,X=ne,ee=ie,te=re,ae=ue,se=Ye;return $(),S(R,null,[e("div",Ke,[x(k,{title:"List User"}),e("div",Je,[e("div",Ze,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:n[0]||(n[0]=d=>J())},[x(P)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:n[1]||(n[1]=d=>Z())},[x(X)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:n[2]||(n[2]=d=>Q())},[x(ee)])]),e("div",Ge,[e("div",Qe,[We,y(e("input",{class:"",type:"text","onUpdate:modelValue":n[3]||(n[3]=d=>we(g)?g.value=d:null),name:"search",placeholder:"Keyword"},null,512),[[j,a(g)]])]),e("div",Xe,[et,y(e("select",{class:"","onUpdate:modelValue":n[4]||(n[4]=d=>a(o).field=d)},lt,512),[[H,a(o).field]])]),e("div",nt,[it,y(e("select",{class:"","onUpdate:modelValue":n[5]||(n[5]=d=>a(o).by=d)},dt,512),[[H,a(o).by]])]),e("div",ct,[e("button",{class:"",type:"button",name:"button",onClick:n[6]||(n[6]=d=>L())},[x(te,{class:"text-2xl"})])])]),e("div",_t,[a(_).length==0?($(),S("div",pt," Maaf Tidak Ada Record ")):($(),S("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:I},[e("table",ft,[vt,e("tbody",null,[($(!0),S(R,null,ge(a(_),(d,F)=>($(),S("tr",{key:F,onClick:gt=>t.value=F,class:ye(a(t)==F?"active":"")},[e("td",null,m(F+1)+".",1),e("td",ht,m(d.username),1),e("td",null,m(d.hak_akses),1),e("td",null,m(d.is_active?"Aktif":"Nonaktif"),1),e("td",null,m(a(s)(d.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,m(a(s)(d.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,mt))),128))])])],544))])])]),x(ae,{type:"delete",show:a(C),data:a(N),fnClose:G,fnConfirm:W},null,8,["show","data"]),x(se,{show:a(B),fnClose:()=>{B.value=!1},id:a(V),p_data:a(_)},null,8,["show","fnClose","id","p_data"])],64)}}},Ut=K(wt,[["__scopeId","data-v-a6cba22e"]]);export{Ut as default};
