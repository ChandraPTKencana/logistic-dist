import _e from"./Header.94f2d0f4.js";import me from"./Plus.5d6dc691.js";import pe from"./Edit.22f6f43f.js";import fe from"./Delete.3626264b.js";import ve from"./Signature.3eb453d1.js";import he from"./Search.5ac9a89f.js";import ge from"./Line.aec16da5.js";import ye from"./Check.83f6568b.js";import be from"./TypeIcon.d2326cb5.js";import{_ as ke}from"./PopupMini.vue.2943c996.js";import xe from"./employee.430bacc1.js";import we from"./employee_validasi.57d599c5.js";import{f as De,g as $e,r as u,h as Ce,i as z,s as Se,j as Ae,c as b,a as e,b as d,m as C,v as H,k as a,n as O,q as U,x as Te,F as K,y as Me,w as Ie,z as Ne,A as g,B,o as v,C as Be,D as J,t as i,d as Ee,p as Fe,e as je,E as Le}from"./entry.7eb46a81.js";import{u as E}from"./useMyFetch.005f2c4d.js";import{_ as Pe}from"./_plugin-vue_export-helper.c27b6911.js";import"./DocJPEG.a2f71af3.js";import"./DocJPG.456780c9.js";import"./DocPNG.c864842f.js";import"./DocPDF.7de2ebce.js";import"./Times.d51f3e11.js";import"./Exclamation.fe7b2356.js";import"./HeaderPopup.vue.2d90330f.js";import"./AttachmentSingle.05c535a1.js";import"./PDFJsView.b7000817.js";import"./useUtils.712e863d.js";const m=k=>(Fe("data-v-0010bc11"),k=k(),je(),k),Re={class:"w-full h-full flex flex-col"},Ve={class:"w-full flex grow flex-col overflow-auto h-0"},ze={class:"w-full flex"},He={action:"#",class:"w-full flex p-1"},Oe={class:"grow"},Ue=m(()=>e("div",{class:"font-bold"}," Keyword ",-1)),Ke={class:"pl-1"},Je=m(()=>e("div",{class:"font-bold"}," Sort By ",-1)),Ye=m(()=>e("option",{value:""},null,-1)),qe=m(()=>e("option",{value:"name"},"Nama",-1)),Ze=m(()=>e("option",{value:"role"},"Jabatan",-1)),Ge=[Ye,qe,Ze],Qe={class:"pl-1"},We=m(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),Xe=m(()=>e("option",{value:"asc"},"Asc",-1)),et=m(()=>e("option",{value:"desc"},"Desc",-1)),tt=[Xe,et],ot={class:"flex items-end pl-1"},at={class:"w-full flex justify-center items-center grow h-0 p-1"},lt={key:0,class:""},st={class:"tacky"},nt=m(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App"),e("th",null,"No."),e("th",null,"Nama"),e("th",null,"Jabatan"),e("th",null,"No KTP"),e("th",null,"No SIM"),e("th",null,"Nama Bank"),e("th",null,"No Rek"),e("th",null,"Nama Rek"),e("th",null,"Phone Number"),e("th",null,"File"),e("th",null,"Tanggal Dibuat"),e("th",null,"Tanggal Diubah")])],-1)),ut=["onClick"],rt={class:"w-full h-full flex items-center justify-center"},it={class:"bold"},ct={class:"grow mb-5"},dt={__name:"index",async setup(k){let x,F;const{$moment:j}=Le(),_={};_._TimeZoneOffset=new Date().getTimezoneOffset();const S=De("token"),{data:s}=([x,F]=$e(async()=>Ne(async()=>{g().loading_full=!0;const{data:l,error:o,status:f}=await E("/employees",{method:"get",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},params:_,retry:0});return g().loading_full=!1,f.value==="error"?(B().trigger(o),[]):l.value.data},"$p5jj5crAgd")),x=await x,F(),x),c=u(""),p=u({field:"",by:"desc"}),r=u(-1),n=u({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),Y=()=>{_.like="",c.value!=""&&(_.like=`id:%${c.value}%,name:%${c.value}%,ktp_no:%${c.value}%,sim_no:%${c.value}%,phone_number:%${c.value}%,rek_no:%${c.value}%`),_.sort="",p.value.field&&(_.sort=p.value.field+":"+p.value.by)},w=u(null),L=async()=>{g().loading_full=!0,n.value.may_get_data=!1,_.page=n.value.page,_.page==1&&(s.value=[]);const{data:l,error:o,status:f}=await E("/employees",{method:"get",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},params:_,retry:0});if(g().loading_full=!1,n.value.may_get_data=!0,f.value==="error"){B().trigger(o);return}n.value.page==1?(s.value=l.value.data,w.value&&(w.value.scrollTop=0)):n.value.page>1&&(s.value=[...s.value,...l.value.data]),l.value.data.length==0&&(n.value.is_last_record=!0)},q=async()=>{if(!n.value.may_get_data)return;let l=w.value;if(l.scrollLeft!=n.value.scrollLeft){n.value.scrollLeft=l.scrollLeft;return}n.value.is_last_record||!(Math.round(l.scrollTop)+l.clientHeight>=l.scrollHeight-1)||(n.value.page++,await L())},Z=()=>{n.value.page=1,n.value.is_last_record=!1,Y(),L()};Ce();const D=u(!1),A=u(0),G=()=>{A.value=0,D.value=!0},{display:T}=z();Se(z());const Q=()=>{r.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(A.value=s.value[r.value].id,D.value=!0)},M=u(!1),P=u(0),W=()=>{r.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=s.value[r.value].id,M.value=!0)},I=u(!1),R=u({}),y=u(!1),h=u(""),X=async()=>{y.value&&(y.value=!1)},ee=()=>{r.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(h.value="",R.value={id:s.value[r.value].id},y.value=!0)};Ae(()=>h.value,l=>{l.trim().length>0?I.value=!0:I.value=!1},{immediate:!1});const te=async()=>{g().loading_full=!0;const l=new FormData;l.append("id",s.value[r.value].id),l.append("deleted_reason",h.value),l.append("_method","DELETE");const{data:o,error:f,status:N}=await E("/employee",{method:"post",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},body:l,retry:0});if(g().loading_full=!1,N.value==="error"){B().trigger(f);return}s.value.splice(r.value,1),r.value=-1,y.value=!1};return(l,o)=>{const f=_e,N=me,oe=pe,ae=fe,le=ve,se=he,ne=ge,ue=ye,re=be,ie=ke,ce=xe,de=we;return v(),b(K,null,[e("div",Re,[d(f,{title:"List Employee"}),e("div",Ve,[e("div",ze,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:o[0]||(o[0]=t=>G())},[d(N)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:o[1]||(o[1]=t=>Q())},[d(oe)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:o[2]||(o[2]=t=>ee())},[d(ae)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:o[3]||(o[3]=t=>W())},[d(le)])]),e("form",He,[e("div",Oe,[Ue,C(e("input",{class:"",type:"text","onUpdate:modelValue":o[4]||(o[4]=t=>O(c)?c.value=t:null),name:"search",placeholder:"Keyword"},null,512),[[H,a(c)]])]),e("div",Ke,[Je,C(e("select",{class:"","onUpdate:modelValue":o[5]||(o[5]=t=>a(p).field=t)},Ge,512),[[U,a(p).field]])]),e("div",Qe,[We,C(e("select",{class:"","onUpdate:modelValue":o[6]||(o[6]=t=>a(p).by=t)},tt,512),[[U,a(p).by]])]),e("div",ot,[e("button",{class:"",type:"submit",name:"button",onClick:o[7]||(o[7]=Te(t=>Z(),["prevent"]))},[d(se,{class:"text-2xl"})])])]),e("div",at,[a(s).length==0?(v(),b("div",lt," Maaf Tidak Ada Record ")):(v(),b("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:w,onScroll:q},[e("table",st,[nt,e("tbody",null,[(v(!0),b(K,null,Me(a(s),(t,$)=>{var V;return v(),b("tr",{key:$,onClick:_t=>r.value=$,class:Be(a(r)==$?"active":"")},[e("td",null,[e("div",rt,[t.val?(v(),J(ue,{key:1})):(v(),J(ne,{key:0}))])]),e("td",null,i($+1)+".",1),e("td",it,i(t.name),1),e("td",null,i(t.role),1),e("td",null,i(t.ktp_no),1),e("td",null,i(t.sim_no),1),e("td",null,i((V=t.bank)==null?void 0:V.code),1),e("td",null,i(t.rek_no),1),e("td",null,i(t.rek_name),1),e("td",null,i(t.phone_number),1),e("td",null,[d(re,{value:t.attachment_1_preview},null,8,["value"])]),e("td",null,i(a(j)(t.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,i(a(j)(t.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,ut)}),128))])])],544))])])]),d(ie,{type:"delete",show:a(y),data:a(R),fnClose:X,fnConfirm:te,enabledOk:a(I)},{footer:Ie(()=>[Ee(" Masukkan Alasan Penghapusan: "),e("div",ct,[C(e("textarea",{"onUpdate:modelValue":o[8]||(o[8]=t=>O(h)?h.value=t:null)},null,512),[[H,a(h)]])])]),_:1},8,["show","data","enabledOk"]),d(ce,{show:a(D),fnClose:()=>{D.value=!1},id:a(A),p_data:a(s)},null,8,["show","fnClose","id","p_data"]),d(de,{show:a(M),fnClose:()=>{M.value=!1},id:a(P),p_data:a(s)},null,8,["show","fnClose","id","p_data"])],64)}}},Pt=Pe(dt,[["__scopeId","data-v-0010bc11"]]);export{Pt as default};
