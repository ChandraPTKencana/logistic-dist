import z from"./Eyes.f9ff67b7.js";import G from"./Image.b563c082.js";import W from"./Line.54c86bb2.js";import Z from"./Check.a81cdf3d.js";import Q from"./TableView.4c23bf32.js";import X from"./trx_trp_nolog.ab159cd2.js";import{r as s,j as ee,g as te,G as Y,i as le,A as m,c as R,a as k,m as ae,q as oe,k as p,n as re,b as x,l as U,w as n,z as se,B as V,o,D as r,d as M,t as S,H as ne,E as ie}from"./entry.d8b45e34.js";import{u as B}from"./useMyFetch.0f4f6d96.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.956b2fed.js";import"./Adjust.921df012.js";import"./TableHeaderEye.5986baee.js";import"./Times.30378410.js";import"./ClearAll.08e2c44c.js";import"./client-only.71815d14.js";import"./ClearEach.500f8992.js";import"./CaretLeftDoubleBold.535179d4.js";import"./CaretLeftBold.09242f1b.js";import"./CaretRightBold.e0243905.js";import"./CaretRightDoubleBold.23889bb4.js";import"./useUtils.8ca2e142.js";import"./HeaderPopup.vue.1c6bff80.js";import"./WidthMiniPart.vue.060677a3.js";const _e={class:"w-full h-full flex flex-col"},pe={class:"w-full flex grow flex-col overflow-auto h-0"},de={class:"w-full flex justify-between flex-wrap"},me={class:"grow flex"},ue={class:"m-1"},ye=ne('<option value="pv_not_done">Undone</option><option value="pv_done">Done</option><option value="deleted">Trash</option><option value="all">All</option><option value="req_deleted">Req Delete</option>',5),ce=[ye],je={__name:"index",async setup(fe){let b,N;const{$moment:T}=ie(),H=e=>e.deleted==1?"!bg-red-400":e.pvr_id>0&&e.req_deleted==1?"!bg-yellow-300":e.pv_id>0?"!bg-blue-300":"",h=e=>(e.map(l=>{l.class_h=H(l)}),e),v=s("pv_not_done");ee(()=>v.value,e=>{P.value.map(l=>{let y=["deleted_by_username","deleted_at","deleted_reason","req_deleted_by_username","req_deleted_at","req_deleted_reason"].indexOf(l.key)>-1;return["all","deleted","req_deleted"].indexOf(e)>-1?y&&(l.tbl_show=1):y&&(l.tbl_show=0),l}),A()},{immediate:!1});const a={};a._TimeZoneOffset=new Date().getTimezoneOffset(),a.sort="tanggal:desc";const $=s({}),g=s({from:"",to:""}),{data:O}=([b,N]=te(async()=>se(async()=>{m().loading_full=!0;let e=[];const[l,y]=await Promise.all([B("/trx_trp_nologs",{method:"get",params:{filter_status:v},retry:0})]);return l.status.value!=="error"&&(e=h(l.data.value.data)),l.status.value==="error"?(V().trigger(l.error),{trx_trps:e}):(m().loading_full=!1,{trx_trps:e})},"$MmURKklrhv")),b=await b,N(),b),d=s(O.value.trx_trps||[]);s([]),s(!1);const w=s({field:"tanggal",by:"desc"}),u=s(-1);Y(()=>d.value[u.value]);const i=s({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),j=()=>{a.like="";let e=JSON.parse(JSON.stringify(m()._tv.global_keyword));e!=""&&(a.like=`id:%${e}%,xto:%${e}%,jenis:%${e}%,pv_no:%${e}%,ticket_a_no:%${e}%,ticket_b_no:%${e}%,no_pol:%${e}%,supir:%${e}%,kernet:%${e}%,cost_center_code:%${e}%,cost_center_desc:%${e}%,pvr_no:%${e}%,tanggal:%${e}%,transition_target:%${e}%`),a.sort="",w.value.field&&(a.sort=w.value.field+":"+w.value.by),a.date_from=g.value.from?T(g.value.from).format("YYYY-MM-DD"):"",a.date_to=g.value.to?T(g.value.to).format("YYYY-MM-DD"):"",a.filter_model=JSON.stringify(m()._tv.filter_model)},C=async()=>{m().loading_full=!0,$.value={},i.value.may_get_data=!1,a.page=i.value.page,a.page==1&&(d.value=[]),a.first_row&&delete a.first_row,a.page>1&&(a.first_row=JSON.stringify(d.value[0])),a.filter_status=v.value;const{data:e,error:l,status:y}=await B("/trx_trp_nologs",{method:"get",params:a,retry:0});if(m().loading_full=!1,i.value.may_get_data=!0,y.value==="error"){V().trigger(l,$);return}i.value.page==1?d.value=h(e.value.data):i.value.page>1&&(d.value=[...d.value,...h(e.value.data)]),e.value.data.length==0&&(i.value.is_last_record=!0),m()._tv.filter_box=!1},A=()=>{u.value=-1,i.value.page=1,i.value.is_last_record=!1,j(),C()},{display:K}=le(),D=s(!1),q=s(0),I=()=>{u.value==-1?K({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(q.value=d.value[u.value].id,D.value=!0)},P=s([{key:"no",label:"No",isai:!0},{key:"val",label:"APP",childs:[{key:"val",label:"Kasir",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val1",label:"Mandor",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val2",label:"KTU/W",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val3",label:"Marketing",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val4",label:"Logistik",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val5",label:"SPV Logistik",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]}]},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"tanggal",label:"U.Jalan Per",type:"date",dateformat:"DD-MM-Y",filter_on:1,sort:{priority:1,type:"desc"}},{key:"no_pol",label:"No Pol",freeze:1,filter_on:1,type:"string"},{key:"xto",label:"Tujuan",filter_on:1,type:"string"},{key:"tipe",label:"Tipe",filter_on:1,type:"string"},{key:"jenis",label:"Jenis",filter_on:1,type:"select",select_item:["TBS","TBSK","CPO","PK"]},{key:"amount",label:"Amount",class:" justify-end",filter_on:1,type:"number"},{key:"transition",label:"Peralihan",childs:[{key:"transition_type",label:"Type",type:"select",filter_on:1,select_item:["To","From"]},{key:"transition_target",label:"Target",type:"select",filter_on:1,select_item:m().list_pabrik}]},{key:"cost_center",label:"Cost Center",childs:[{key:"cost_center_code",label:"Code",type:"string",class:" justify-start",filter_on:1},{key:"cost_center_desc",label:"Desc",filter_on:1,type:"string"}]},{key:"pvr",label:"PVR",childs:[{key:"pvr_no",label:"No",filter_on:1,type:"string"},{key:"pvr_total",label:"Total",filter_on:1,type:"number"},{key:"pvr_had_detail",label:"Completed",filter_on:1,type:"select",select_item:[{k:"1",v:"Completed"},{k:"0",v:"Uncompleted"}]}]},{key:"pv",label:"PV",childs:[{key:"pv_datetime",label:"Date",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"pv_no",label:"No",filter_on:1,type:"string"},{key:"pv_total",label:"Total",filter_on:1,type:"number"}]},{key:"supir",label:"Supir",filter_on:1,type:"string"},{key:"supir_rek_no",label:"No Rek Supir",filter_on:1,type:"string"},{key:"supir_rek_name",label:"Nama Rek Supir",filter_on:1,type:"string"},{key:"kernet",label:"Kernet",filter_on:1,type:"string"},{key:"kernet_rek_no",label:"No Rek Kernet",filter_on:1,type:"string"},{key:"kernet_rek_name",label:"Nama Rek Kernet",filter_on:1,type:"string"},{key:"payment_method_name",label:"Payment Method Name",type:"string"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:0},{key:"deleted_at",label:"Deleted At",dateformat:"DD-MM-Y HH:mm:ss",tbl_show:0,type:"datetime",filter_on:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:0,type:"string",filter_on:1},{key:"req_deleted_by_username",label:"Req Deleted By",tbl_show:0},{key:"req_deleted_at",label:"Req Delete At",dateformat:"DD-MM-Y HH:mm:ss",tbl_show:0,type:"datetime",filter_on:1},{key:"req_deleted_reason",label:"Req Delete Reason",tbl_show:0,type:"string",filter_on:1}]),J=Y(()=>u.value>-1);return(e,l)=>{const y=z,F=G,c=W,f=Z,E=Q,L=X;return o(),R("div",_e,[k("div",pe,[k("div",de,[k("div",me,[k("div",ue,[ae(k("select",{class:"","onUpdate:modelValue":l[0]||(l[0]=t=>re(v)?v.value=t:null)},ce,512),[[oe,p(v)]])]),p(J)?(o(),R("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:l[1]||(l[1]=t=>I())},[x(y)])):U("",!0)])]),x(E,{thead:p(P),selected:p(u),onSetSelected:l[2]||(l[2]=t=>u.value=t),tbody:p(d),fnCallData:C,scrolling:p(i),onSetScrollingPage:l[3]||(l[3]=t=>p(i).page=t),onDoFilter:l[4]||(l[4]=t=>A())},{absen:n(({item:t,index:_})=>[t.trx_absens&&t.trx_absens.length>0?(o(),r(F,{key:0,class:"cursor-pointer",onClick:ve=>e.form_absen(_)},null,8,["onClick"])):U("",!0)]),val:n(({item:t})=>[t.val?(o(),r(f,{key:1})):(o(),r(c,{key:0}))]),val1:n(({item:t})=>[t.val1?(o(),r(f,{key:1})):(o(),r(c,{key:0}))]),val2:n(({item:t})=>[t.val2?(o(),r(f,{key:1})):(o(),r(c,{key:0}))]),val3:n(({item:t})=>[t.val3?(o(),r(f,{key:1})):(o(),r(c,{key:0}))]),val4:n(({item:t})=>[t.val4?(o(),r(f,{key:1})):(o(),r(c,{key:0}))]),val5:n(({item:t})=>[t.val5?(o(),r(f,{key:1})):(o(),r(c,{key:0}))]),payment_method_name:n(({item:t})=>{var _;return[M(S((_=t.payment_method)==null?void 0:_.name),1)]}),pvr_had_detail:n(({item:t})=>[t.pvr_had_detail?(o(),r(f,{key:1})):(o(),r(c,{key:0}))]),deleted_by_username:n(({item:t})=>{var _;return[M(S((_=t.deleted_by)==null?void 0:_.username),1)]}),req_deleted_by_username:n(({item:t})=>{var _;return[M(S((_=t.req_deleted_by)==null?void 0:_.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])]),x(L,{show:p(D),fnClose:()=>{D.value=!1},id:p(q)},null,8,["show","fnClose","id"])])}}};export{je as default};
