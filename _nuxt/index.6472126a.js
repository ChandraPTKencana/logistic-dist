import{_ as Se}from"./Header.a660aef3.js";import{_ as Me}from"./Plus.49151419.js";import{_ as Te}from"./Edit.231a8217.js";import{_ as Ae}from"./Eyes.ec798f7a.js";import{_ as Ie}from"./Delete.53afd7c8.js";import{_ as Ne}from"./Signature.707f1804.js";import{_ as G}from"./_plugin-vue_export-helper.c27b6911.js";import{o as u,c as _,a as e,f as X,r as m,g as ie,h as W,v as de,b as $,t as l,k as t,F as O,n as E,q as Z,d as ae,s as ce,x as q,y as U,p as _e,e as me,L as ne,J as Be,w as Re,m as fe,i as pe,j as he,D as ze,B as He,H as re,I as Le,N as ue,G as Oe,E as je}from"./entry.61ece3b9.js";import{_ as Ve}from"./Table2Column.fb6b424e.js";import{_ as ve}from"./Search.5322c3b8.js";import{_ as Fe}from"./PopupMini.vue.513a4cd1.js";import{_ as ye}from"./HeaderPopup.vue.c0e308db.js";import{_ as Ee}from"./client-only.936e72e9.js";import{u as Pe}from"./useUtils.100f5b4a.js";import{u as Y}from"./useMyFetch.7e1f099c.js";import"./Times.cdfac53e.js";const Ue={name:"MaterialSymbolsChecklist"},Ye={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Qe=e("path",{fill:"currentColor",d:"M5.55 19L2 15.45l1.4-1.4l2.125 2.125l4.25-4.25l1.4 1.425zm0-8L2 7.45l1.4-1.4l2.125 2.125l4.25-4.25l1.4 1.425zM13 17v-2h9v2zm0-8V7h9v2z"},null,-1),We=[Qe];function Ze(g,v,S,b,y,x){return u(),_("svg",Ye,We)}const Je=G(Ue,[["render",Ze]]);const Q=g=>(_e("data-v-e926be44"),g=g(),me(),g),Ke={class:"box-fixed"},Ge={class:"w-full flex p-1 flex-wrap flex-row"},Xe={class:"w-full sm:w-1/3 md:w-1/3 lg:w-1/4 p-1"},et=Q(()=>e("div",{class:"font-bold"}," Warehouse Name ",-1)),tt={class:"w-full p-1"},lt={class:"w-full sm:w-1/3 md:w-1/3 lg:w-1/4 p-1"},st=Q(()=>e("div",{class:"font-bold"}," Item Name ",-1)),ot={class:"w-full p-1"},at={class:"w-full sm:w-1/3 md:w-1/3 lg:w-1/4 p-1"},nt=Q(()=>e("div",{class:"font-bold"}," Last Stock ",-1)),rt={class:"w-full p-1"},ut={class:"w-full flex justify-center items-center grow h-0 p-1"},it={key:0,class:""},dt={class:"tacky"},ct=Q(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"Input At"),e("th",null,"Type"),e("th",null,"Qty In"),e("th",null,"Qty Out"),e("th",null,"Qty Reminder"),e("th",null,"Note"),e("th",null,"Confirm At"),e("th",null,"Updated At")])],-1)),_t=["onClick"],mt=Q(()=>e("br",null,null,-1)),ft={__name:"summary_detail",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},warehouse_id:{type:Number,required:!1},item_id:{type:Number,required:!1},data:{type:Object,required:!0}},setup(g){const v=g,{$moment:S}=ce(),{pointFormat:b}=Pe(),y=X("token");m({from:"",to:""});const x=m([]),M=m(-1),i={};i._TimeZoneOffset=new Date().getTimezoneOffset();const j=async()=>{q().loading_full=!0,i.page=1,i.item_id=v.data.item.id,i.warehouse_id=v.data.rest.id,x.value=[];const{data:f,error:k,status:r}=await Y("/summary_detail_transactions",{method:"get",headers:{Authorization:`Bearer ${y.value}`,Accept:"application/json"},params:i,retry:0});if(q().loading_full=!1,r.value==="error"){U().trigger(k);return}x.value=f.value.data};return ie(()=>v.show,(f,k)=>{f==!0&&j()},{immediate:!0}),(f,k)=>{var h,V,T,L,A,D,I,F;const r=ye;return W((u(),_("section",Ke,[e("div",null,[$(r,{title:"Summary Detail",fn:g.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("div",Ge,[e("div",Xe,[et,e("div",tt,l((V=(h=v.data)==null?void 0:h.rest)==null?void 0:V.lokasi),1)]),e("div",lt,[st,e("div",ot,l((L=(T=v.data)==null?void 0:T.item)==null?void 0:L.name),1)]),e("div",at,[nt,e("div",rt,l((D=(A=v.data)==null?void 0:A.item)==null?void 0:D.qty_reminder)+" "+l((F=(I=v.data)==null?void 0:I.item)==null?void 0:F.unit_name),1)])]),e("div",ut,[t(x).length==0?(u(),_("div",it," Maaf Tidak Ada Record ")):(u(),_("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref:"loadRef",onScroll:k[0]||(k[0]=(...d)=>f.loadMore&&f.loadMore(...d))},[e("table",dt,[ct,e("tbody",null,[(u(!0),_(O,null,E(t(x),(d,N)=>{var o,s,a,C,B,R;return u(),_("tr",{key:N,onClick:z=>M.value=N,class:Z(t(M)==N?"active":"")},[e("td",null,l(N+1)+".",1),e("td",null,l(t(S)(d.input_at).format("DD-MM-Y")),1),e("td",null,[ae(l(d.type)+" ",1),mt,ae(" "+l(d.type=="transfer"?"To : "+d.lokasi:""),1)]),e("td",null,l(d.qty_in?t(b)(d.qty_in)+` ${(s=(o=v.data)==null?void 0:o.item)==null?void 0:s.unit_name}`:""),1),e("td",null,l(d.qty_out?t(b)(d.qty_out)+` ${(C=(a=v.data)==null?void 0:a.item)==null?void 0:C.unit_name}`:""),1),e("td",null,l(d.qty_reminder?t(b)(d.qty_reminder)+` ${(R=(B=v.data)==null?void 0:B.item)==null?void 0:R.unit_name}`:""),1),e("td",null,l(d.note),1),e("td",null,l(d.confirmed_at?t(S)(d.confirmed_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,l(t(S)(d.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,_t)}),128))])])],544))])])],512)),[[de,g.show]])}}},pt=G(ft,[["__scopeId","data-v-e926be44"]]);const we=g=>(_e("data-v-2afb09db"),g=g(),me(),g),ht={class:"box-fixed"},vt={action:"#",class:"w-full flex p-1"},yt={class:"w-full flex flex-row flex-wrap p-1 items-center"},wt=we(()=>e("label",{for:"",class:"pr-1"},"To",-1)),gt={class:"grow"},xt={class:"text-red-500"},$t={class:"flex items-end p-1"},bt={class:"w-full flex"},kt={class:"p-1"},Ct={class:"grow flex flex-row flex-wrap"},Dt={class:"p-1"},qt=["onClick"],St={class:"w-full flex justify-center items-center grow h-0 p-1"},Mt={key:0,class:""},Tt={key:1,class:"w-full h-full overflow-auto",role:"sticky",ref:"loadRef"},At={class:"tacky"},It={class:"sticky top-0 !z-[2]"},Nt=we(()=>e("th",null,null,-1)),Bt=["onClick"],Rt={class:"font-bold !text-left"},zt=["onClick"],Ht={__name:"summary",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1}},setup(g){const v=g,S=X("token"),b=m({from:"",to:new Date}),y=m({}),x=m([]),M=m([]),i=m([]),j=m(-1),f=m(!1),k=m({}),r={};r._TimeZoneOffset=new Date().getTimezoneOffset();const h=async()=>{q().loading_full=!0,r.page=1,r.to=b.value.to,x.value=[];const{data:o,error:s,status:a}=await Y("/summary_transactions",{method:"get",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},params:r,retry:0});if(q().loading_full=!1,a.value==="error"){U().trigger(s);return}x.value=o.value.all,M.value=o.value.column_header,i.value=o.value.row_header};ie(()=>v.show,(o,s)=>{o==!0&&h()},{immediate:!0});const V=(o,s)=>{let a=x.value.filter(z=>z.id==o)[0];const{items:C,...B}=a;let R=a.items.filter(z=>z.id==s)[0];return{rest:B,item:R}},T=(o,s)=>x.value.filter(a=>a.id==o)[0].items.filter(a=>a.id==s)[0].qty_reminder,L=(o,s,a)=>{k.value=o,f.value=!0},A=m(""),D=m([]),I=o=>{let s=D.value.map(a=>a.id).indexOf(o.id);s==-1?D.value.push(o):D.value.splice(s,1)},F=o=>D.value.some(s=>s.id===o.id),d=ne(()=>{let o=[],s=D.value.map(a=>a.id);return M.value.forEach(a=>{s.indexOf(a.id)==-1&&o.push(a)}),o}),N=ne(()=>{let o=A.value;const s=new RegExp("("+o+")","i");return i.value.filter(a=>a.name.match(s))});return(o,s)=>{const a=ye,C=Be("vue-date-picker"),B=Ee,R=ve,z=pt;return u(),_(O,null,[W(e("section",ht,[e("div",null,[$(a,{title:"Summary",fn:g.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",vt,[e("div",yt,[wt,e("div",gt,[$(B,null,{default:Re(()=>[$(C,{modelValue:t(b).to,"onUpdate:modelValue":s[0]||(s[0]=w=>t(b).to=w),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1})]),e("p",xt,l(t(y).to),1)]),e("div",$t,[e("button",{style:{width:"38px",height:"38px"},type:"submit",name:"button",onClick:s[1]||(s[1]=fe(w=>h(),["prevent"]))},[$(R,{class:"text-2xl"})])])]),e("div",bt,[e("div",kt,[W(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=w=>pe(A)?A.value=w:null),placeholder:"Item Name"},null,512),[[he,t(A)]])]),e("div",Ct,[(u(!0),_(O,null,E(t(M),w=>(u(),_("div",Dt,[e("div",{class:Z(["p-1 rounded ring-1 ring-slate-500 cursor-pointer",F(w)?"bg-white text-black":"bg-slate-600 text-white"]),onClick:p=>I(w)},l(w.lokasi),11,qt)]))),256))])]),e("div",St,[t(x).length==0?(u(),_("div",Mt," Maaf Tidak Ada Record ")):(u(),_("div",Tt,[e("table",At,[e("thead",null,[e("tr",It,[Nt,(u(!0),_(O,null,E(t(d),w=>(u(),_("th",null,l(w.lokasi),1))),256))])]),e("tbody",null,[(u(!0),_(O,null,E(t(N),(w,p)=>(u(),_("tr",{key:p,onClick:n=>j.value=p,class:Z(t(j)==p?"active":"")},[e("th",Rt,l(w.name),1),(u(!0),_(O,null,E(t(d),n=>(u(),_("td",null,[e("a",{class:"text-blue-500 font-bold underline cursor-pointer",onClick:H=>L(V(n.id,w.id))},l(T(n.id,w.id)),9,zt)]))),256))],10,Bt))),128))])])],512))])])],512),[[de,g.show]]),$(z,{show:t(f),data:t(k),fnClose:()=>{f.value=!1}},null,8,["show","data","fnClose"])],64)}}},Lt=G(Ht,[["__scopeId","data-v-2afb09db"]]),Ot={class:"w-full h-full flex flex-col"},jt={class:"w-full flex grow flex-col overflow-auto h-0"},Vt={class:"w-full flex"},Ft=["disabled"],Et={class:"text-sm absolute top-0 right-0 flex justify-end"},Pt={key:0,class:"w-2 h-2 rounded-full bg-red-700 border-2 border-solid border-red-950"},Ut={action:"#",class:"w-full flex p-1"},Yt={class:"grow"},Qt=e("div",{class:"font-bold"}," Keyword ",-1),Wt={class:"flex items-end pl-1"},Zt={class:"w-full flex justify-center items-center grow h-0 p-1"},Jt={key:0,class:""},Kt={class:"tacky"},Gt=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"ID"),e("th",null,"Input At"),e("th",null,"Warehouse Name"),e("th",null,"Note"),e("th",null,"Status"),e("th",null,"Type"),e("th",null,"Warehouse Source Name"),e("th",null,"Warehouse Target Name"),e("th",null,"Confirmed At"),e("th",null,"Confirmed By"),e("th",null,"Requested At"),e("th",null,"Requested By")])],-1),Xt=["onClick"],el={class:"bold"},yl={__name:"index",async setup(g){let v,S;const{$moment:b}=ce(),y={};y._TimeZoneOffset=new Date().getTimezoneOffset();const x=X("token"),{data:M}=([v,S]=ze(async()=>je(async()=>{q().loading_full=!0;const{data:p,error:n,status:H}=await Y("/transactions",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:y,retry:0});if(q().loading_full=!1,H.value==="error")return U().trigger(n),[];let P=p.value.data,J=p.value.request_notif;return{transactions:P,request_notif:J}},"$45iBZgNANe")),v=await v,S(),v),i=m(M.value.transactions),j=m(M.value.request_notif),f=m(""),k=m({field:"updated_at",by:"desc"}),r=m(-1),h=m({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),V=()=>{y.like="",f.value!=""&&(y.like=`id:%${f.value}%,warehouse_name:%${f.value}%,warehouse_source_name:%${f.value}%,warehouse_target_name:%${f.value}%,item_name:%${f.value}%,status:%${f.value}%,type:%${f.value}%`),y.sort="",k.value.field&&(y.sort=k.value.field+":"+k.value.by)},T=m(null),L=async()=>{q().loading_full=!0,h.value.may_get_data=!1,y.page=h.value.page,y.page==1&&(i.value=[]),y.first_row&&delete y.first_row,y.page>1&&(y.first_row=JSON.stringify(i.value[0]));const{data:p,error:n,status:H}=await Y("/transactions",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:y,retry:0});if(q().loading_full=!1,h.value.may_get_data=!0,H.value==="error"){U().trigger(n);return}h.value.page==1?(i.value=p.value.data,T.value&&(T.value.scrollTop=0)):h.value.page>1&&(i.value=[...i.value,...p.value.data]),p.value.data.length==0&&(h.value.is_last_record=!0)},A=async()=>{if(!h.value.may_get_data)return;let p=T.value;if(p.scrollLeft!=h.value.scrollLeft){h.value.scrollLeft=p.scrollLeft;return}h.value.is_last_record||!(Math.round(p.scrollTop)+p.clientHeight>=p.scrollHeight-1)||(h.value.page++,await L())},D=()=>{h.value.page=1,h.value.is_last_record=!1,V(),L()},I=He(),F=()=>{I.push({name:"data_transaksi-form",query:{id:""}})},{display:d}=re();Le(re());const N=()=>{r.value==-1?d({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):I.push({name:"data_transaksi-form",query:{id:i.value[r.value].id}})},o=()=>{r.value==-1?d({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):I.push({name:"data_transaksi-confirm",query:{id:i.value[r.value].id}})},s=()=>{I.push({name:"data_transaksi-request"})},a=m({}),C=m(!1),B=async()=>{C.value&&(C.value=!1)},R=()=>{r.value==-1?d({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(a.value={id:i.value[r.value].id},C.value=!0)},z=async()=>{q().loading_full=!0;const p=new FormData;p.append("id",i.value[r.value].id),p.append("_method","DELETE");const{data:n,error:H,status:P}=await Y("/transaction",{method:"post",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},body:p,retry:0});if(q().loading_full=!1,P.value==="error"){U().trigger(H);return}i.value.splice(r.value,1),r.value=-1,C.value=!1},w=m(!1);return(p,n)=>{const H=Se,P=Me,J=Te,ge=Ae,xe=Ie,$e=Ne,be=Je,ke=Ve,Ce=ve,De=Fe,qe=Lt;return u(),_("div",Ot,[$(H,{title:"List Transaction"}),e("div",jt,[e("div",Vt,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:n[0]||(n[0]=c=>F())},[$(P)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:n[1]||(n[1]=c=>N())},[t(r)==-1||t(i)[t(r)].ref_id==null&&t(i)[t(r)].confirmed_by==null?(u(),ue(J,{key:0})):(u(),ue(ge,{key:1}))]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:n[2]||(n[2]=c=>R())},[$(xe)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",disabled:t(r)==-1||t(i)[t(r)].confirmed_by,onClick:n[3]||(n[3]=c=>o())},[$($e)],8,Ft),e("button",{type:"button",name:"button",class:"m-1 text-2xl relative",onClick:n[4]||(n[4]=c=>s())},[$(be),e("div",Et,[t(j)>0?(u(),_("div",Pt)):Oe("",!0)])]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:n[5]||(n[5]=c=>w.value=!0)},[$(ke)])]),e("form",Ut,[e("div",Yt,[Qt,W(e("input",{class:"",type:"text","onUpdate:modelValue":n[6]||(n[6]=c=>pe(f)?f.value=c:null),name:"search",placeholder:"Keyword"},null,512),[[he,t(f)]])]),e("div",Wt,[e("button",{class:"",type:"submit",name:"button",onClick:n[7]||(n[7]=fe(c=>D(),["prevent"]))},[$(Ce,{class:"text-2xl"})])])]),e("div",Zt,[t(i).length==0?(u(),_("div",Jt," Maaf Tidak Ada Record ")):(u(),_("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:T,onScroll:A},[e("table",Kt,[Gt,e("tbody",null,[(u(!0),_(O,null,E(t(i),(c,K)=>{var ee,te,le,se,oe;return u(),_("tr",{key:K,onClick:tl=>r.value=K,class:Z(t(r)==K?"active":"")},[e("td",el,l(c.id),1),e("td",null,l(c.input_at?t(b)(c.input_at).format("DD-MM-Y"):""),1),e("td",null,l((ee=c.warehouse)==null?void 0:ee.name),1),e("td",null,l(c.note),1),e("td",null,l(c.status),1),e("td",null,l(c.type),1),e("td",null,l((te=c.warehouse_source)==null?void 0:te.name),1),e("td",null,l((le=c.warehouse_target)==null?void 0:le.name),1),e("td",null,l(c.confirmed_at?t(b)(c.confirmed_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,l((se=c.confirmer)==null?void 0:se.username),1),e("td",null,l(t(b)(c.requested_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,l((oe=c.requester)==null?void 0:oe.username),1)],10,Xt)}),128))])])],544))])]),$(De,{type:"delete",show:t(C),data:t(a),fnClose:B,fnConfirm:z},null,8,["show","data"]),$(qe,{show:t(w),fnClose:()=>{w.value=!1}},null,8,["show","fnClose"])])}}};export{yl as default};
