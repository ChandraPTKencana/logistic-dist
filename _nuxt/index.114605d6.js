import{r,f as me,g as fe,h as ve,i as g,j as R,s as ye,c as h,a as c,b as p,k as ge,v as he,l as o,m as be,n as C,w as q,F as ke,q as xe,x as d,y as S,o as b,d as H,t as J,B as O,_ as B,p as we,e as De}from"./entry.2e8b78c1.js";import Ae from"./Header.47406e40.js";import Ce from"./Copy.52f5d7a9.js";import Se from"./Plus.ea1f847d.js";import Pe from"./Edit.4bc04498.js";import Te from"./Delete.6748c348.js";import Ee from"./TableView.75f53174.js";import{u as P}from"./useMyFetch.e6d47c09.js";import{u as T}from"./useUtils.49acee3f.js";import{_ as $e}from"./_plugin-vue_export-helper.c27b6911.js";import"./Search.480cfef4.js";import"./Adjust.65fd07b0.js";import"./TableHeaderEye.037a99c6.js";import"./Times.1251e55b.js";import"./ClearAll.2c34416b.js";import"./client-only.6c91716f.js";import"./ClearEach.e9fd5f89.js";import"./CaretLeftDoubleBold.e77d64fb.js";import"./CaretLeftBold.03bc9e2e.js";import"./CaretRightBold.2fbc70a0.js";import"./CaretRightDoubleBold.cfc13dcf.js";const ze=O(()=>B(()=>import("./PopupMini.57a94d9a.js"),["./PopupMini.57a94d9a.js","./PopupMini.vue.a4277ca4.js","./Times.1251e55b.js","./_plugin-vue_export-helper.c27b6911.js","./entry.2e8b78c1.js","./entry.493f9183.css","./Exclamation.fa922f3d.js"],import.meta.url).then(n=>n.default||n)),Fe=O(()=>B(()=>import("./user.9a72f8dc.js"),["./user.9a72f8dc.js","./HeaderPopup.vue.f669f300.js","./Times.1251e55b.js","./_plugin-vue_export-helper.c27b6911.js","./entry.2e8b78c1.js","./entry.493f9183.css","./useMyFetch.e6d47c09.js"],import.meta.url).then(n=>n.default||n)),Ie=O(()=>B(()=>import("./GAQR.abb9ad23.js"),["./GAQR.abb9ad23.js","./Times.1251e55b.js","./_plugin-vue_export-helper.c27b6911.js","./entry.2e8b78c1.js","./entry.493f9183.css"],import.meta.url).then(n=>n.default||n)),L=n=>(we("data-v-fdd1cb98"),n=n(),De(),n),Oe={class:"w-full h-full flex flex-col"},Be={class:"w-full flex grow flex-col overflow-auto h-0"},Le={class:"w-full flex justify-between flex-wrap"},Ne={class:"grow flex"},Ue={class:"m-1"},Ve=L(()=>c("option",{value:"active"},"Active",-1)),je=L(()=>c("option",{value:"nonactive"},"Nonactive",-1)),Me=L(()=>c("option",{value:"all"},"All",-1)),Re=[Ve,je,Me],qe={__name:"index",async setup(n){let k,N;const Y=t=>t.is_active==0?"!bg-red-400":"",m=r("active");me(()=>m.value,t=>{V()},{immediate:!1});const i={};i._TimeZoneOffset=new Date().getTimezoneOffset();const x=fe("token"),{data:l}=([k,N]=ve(async()=>xe(async()=>{d().loading_full=!0;const{data:t,error:e,status:u}=await P("/users",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:{filter_status:m},retry:0});return d().loading_full=!1,u.value==="error"?(S().trigger(e),[]):t.value.data},"$4SJ9UL5Y8i")),k=await k,N(),k);r("");const E=r({field:"",by:"desc"}),a=r(-1),_=r({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),$=g(()=>l.value[a.value]),G=()=>{i.like="";let t=JSON.parse(JSON.stringify(d()._tv.global_keyword));t!=""&&(i.like=`id:%${t}%,username:%${t}%`),i.sort="",E.value.field&&(i.sort=E.value.field+":"+E.value.by),i.filter_model=JSON.stringify(d()._tv.filter_model)},Q=t=>{let e=[];return t.permission_group_users&&t.permission_group_users.length>0&&t.permission_group_users.forEach(u=>{e.push(u.permission_group.name)}),e.join(",")};r(null);const U=async()=>{d().loading_full=!0,_.value.may_get_data=!1,i.page=_.value.page,i.page==1&&(l.value=[]),i.filter_status=m.value;const{data:t,error:e,status:u}=await P("/users",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:i,retry:0});if(d().loading_full=!1,_.value.may_get_data=!0,u.value==="error"){S().trigger(e);return}_.value.page==1?l.value=t.value.data:_.value.page>1&&(l.value=[...l.value,...t.value.data]),t.value.data.length==0&&(_.value.is_last_record=!0),d()._tv.filter_box=!1},V=()=>{a.value=-1,_.value.page=1,_.value.is_last_record=!1,G(),U()},v=r(!1),w=r(0),D=r(0),z=r(!1),Z=()=>{w.value=0,z.value=!1,D.value=!1,v.value=!0},{display:A}=R();ye(R());const K=()=>{a.value==-1?A({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(w.value=l.value[a.value].id,z.value=!1,D.value=!1,v.value=!0)},W=()=>{a.value==-1?A({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(w.value=l.value[a.value].id,z.value=!1,D.value=!0,v.value=!0)},j=r({}),y=r(!1),X=async()=>{y.value&&(y.value=!1)},ee=()=>{a.value==-1?A({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(j.value={id:l.value[a.value].id},y.value=!0)},te=async()=>{d().loading_full=!0;const t=new FormData;t.append("id",l.value[a.value].id),t.append("_method","DELETE");const{data:e,error:u,status:I}=await P("/user",{method:"post",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},body:t,retry:0});if(d().loading_full=!1,I.value==="error"){S().trigger(u);return}let f={...l.value[a.value]};f.deleted=e.value.deleted,f.deleted_user=e.value.deleted_user,f.deleted_at=e.value.deleted_at,f.deleted_by=e.value.deleted_by,f.deleted_reason=e.value.deleted_reason,m.value!="all"?l.value.splice(a.value,1):l.value.splice(a.value,1,{...f}),a.value=-1,y.value=!1},M=r(""),F=r(!1),ae=async()=>{if(a.value==-1){A({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"});return}i.id=l.value[a.value].id,d().loading_full=!0;const{data:t,error:e,status:u}=await P("/ga_qr",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:i,retry:0});if(d().loading_full=!1,u.value==="error"){S().trigger(e);return}M.value=t.value,F.value=!0},oe=r([{key:"no",label:"No",isai:!0},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"username",label:"Username",freeze:1,filter_on:1,type:"string",sort:{priority:1,type:"asc"}},{key:"hak_akses",label:"Hak Akses",filter_on:1,type:"string"},{key:"group",label:"Group",filter_on:1,type:"string"},{key:"is_active",label:"Status",filter_on:1,type:"select",select_item:[{k:"1",v:"Ya"},{k:"0",v:"Tidak"}]},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1}]),le=g(()=>a.value>-1&&[void 0,0].indexOf($.value.deleted)>-1&&T().checkPermission("user.create")),se=g(()=>["active","nonactive","all"].indexOf(m.value)>-1&&T().checkPermission("user.create")),re=g(()=>a.value>-1&&[void 0,0].indexOf($.value.deleted)>-1&&T().checkPermissions(["user.modify"])),ne=g(()=>a.value>-1&&T().checkPermission("user.remove")&&[void 0,0].indexOf($.value.deleted)>-1);return(t,e)=>{const u=Ae,I=Ce,f=Se,ie=Pe,ue=Te,de=Ee,_e=ze,ce=Fe,pe=Ie;return b(),h(ke,null,[c("div",Oe,[p(u,{title:"List User"}),c("div",Be,[c("div",Le,[c("div",Ne,[c("div",Ue,[ge(c("select",{class:"","onUpdate:modelValue":e[0]||(e[0]=s=>be(m)?m.value=s:null)},Re,512),[[he,o(m)]])]),o(le)?(b(),h("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[1]||(e[1]=s=>W())},[p(I)])):C("",!0),o(se)?(b(),h("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[2]||(e[2]=s=>Z())},[p(f)])):C("",!0),o(re)?(b(),h("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[3]||(e[3]=s=>K())},[p(ie)])):C("",!0),o(ne)?(b(),h("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[4]||(e[4]=s=>ee())},[p(ue)])):C("",!0),c("button",{type:"button",name:"button",class:"m-1 text-xs",onClick:e[5]||(e[5]=s=>ae())}," SET 2FA ")])]),p(de,{thead:o(oe),selected:o(a),onSetSelected:e[6]||(e[6]=s=>a.value=s),tbody:o(l),fnCallData:U,scrolling:o(_),onSetScrollingPage:e[7]||(e[7]=s=>o(_).page=s),onDoFilter:e[8]||(e[8]=s=>V()),rowBgColor:Y},{group:q(({item:s})=>[H(J(Q(s)),1)]),is_active:q(({item:s})=>[H(J(s.is_active==1?"Aktif":"Tidak Aktif"),1)]),_:2},1032,["thead","selected","tbody","scrolling"])])]),p(_e,{type:"delete",show:o(y),data:o(j),fnClose:X,fnConfirm:te},null,8,["show","data"]),p(ce,{show:o(v),fnClose:()=>{v.value=!1},id:o(w),p_data:o(l),is_copy:o(D)},null,8,["show","fnClose","id","p_data","is_copy"]),p(pe,{show:o(F),fnClose:()=>{F.value=!1},qrCodeUrl:o(M)},null,8,["show","fnClose","qrCodeUrl"])],64)}}},ct=$e(qe,[["__scopeId","data-v-fdd1cb98"]]);export{ct as default};
