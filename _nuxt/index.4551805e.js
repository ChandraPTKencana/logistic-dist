import{g as W,h as X,r as o,f as R,C as Y,j as z,s as ee,c as u,b as p,a as e,l as a,n as D,k as A,A as te,m as se,v as B,D as oe,F as ae,E as le,q as ne,o as c,G as re,t as I,B as ie,x as w,y as M,_ as ue}from"./entry.47db1662.js";import ce from"./Header.715f1594.js";import _e from"./Copy.a9977dec.js";import de from"./Plus.b75d4ede.js";import fe from"./Edit.0b8fc6ed.js";import pe from"./Search.28668274.js";import{u as S}from"./useUtils.84d80c5b.js";import{u as O}from"./useMyFetch.882ccfdd.js";import"./_plugin-vue_export-helper.c27b6911.js";const me=ie(()=>ue(()=>import("./permission_group.78ed6bbe.js"),["./permission_group.78ed6bbe.js","./HeaderPopup.vue.df0dc09d.js","./Times.b9ab5ce7.js","./_plugin-vue_export-helper.c27b6911.js","./entry.47db1662.js","./entry.ac1ecdba.css","./useMyFetch.882ccfdd.js"],import.meta.url).then(b=>b.default||b)),ve={class:"w-full h-full flex flex-col"},he={class:"w-full flex grow flex-col overflow-auto h-0"},ye={class:"w-full flex"},ge={action:"#",class:"w-full flex p-1"},ke={class:"grow"},we=e("div",{class:"font-bold"}," Keyword ",-1),be={class:"pl-1"},xe=e("div",{class:"font-bold"}," Sort By ",-1),Ce=e("option",{value:""},null,-1),De=e("option",{value:"id"},"ID",-1),Ae=e("option",{value:"name"},"Name",-1),Se=e("option",{value:"tipe"},"Tipe",-1),$e=[Ce,De,Ae,Se],Pe={class:"pl-1"},Te=e("div",{class:"font-bold"}," Sort Order ",-1),Le=e("option",{value:"asc"},"Asc",-1),Ue=e("option",{value:"desc"},"Desc",-1),Re=[Le,Ue],ze={class:"flex items-end pl-1"},Be={class:"w-full flex justify-center items-center grow h-0 p-1"},Ie={key:0,class:""},Me={class:"tacky"},Oe=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"ID"),e("th",null,"Name")])],-1),Ve=["onClick"],Ee={class:"bold"},We={__name:"index",async setup(b){let h,$;const l={};l._TimeZoneOffset=new Date().getTimezoneOffset(),l.sort="created_at:desc";const P=W("token"),{data:V}=([h,$]=X(async()=>ne(async()=>{let t=[];w().loading_full=!0;const{data:s,error:v,status:x}=await O("/permission_groups",{method:"get",headers:{Authorization:`Bearer ${P.value}`,Accept:"application/json"},params:l,retry:0});return w().loading_full=!1,x.value==="error"?(M().trigger(v),{permission_groups:t}):(t=s.value.data,{permission_groups:t})},{lazy:!0,server:!1,default:()=>({permission_groups:[]})},"$RBOosuv6RL")),h=await h,$(),h),i=o([]);R(()=>{var t;return(t=V.value)==null?void 0:t.permission_groups},t=>{t&&(i.value=[...t])},{immediate:!0});const _=o(""),d=o({field:"created_at",by:"desc"}),f=o(-1),n=o({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),E=()=>{l.like="",_.value!=""&&(l.like=`id:%${_.value}%,name:%${_.value}%,amount:%${_.value}%`),l.sort="",d.value.field&&(l.sort=d.value.field+":"+d.value.by)},y=o(null),T=async()=>{w().loading_full=!0,n.value.may_get_data=!1,l.page=n.value.page,l.page==1&&(i.value=[]),l.first_row&&delete l.first_row,l.page>1&&(l.first_row=JSON.stringify(i.value[0]));const{data:t,error:s,status:v}=await O("/permission_groups",{method:"get",headers:{Authorization:`Bearer ${P.value}`,Accept:"application/json"},params:l,retry:0});if(w().loading_full=!1,n.value.may_get_data=!0,v.value==="error"){M().trigger(s);return}n.value.page==1?(i.value=t.value.data,y.value&&(y.value.scrollTop=0)):n.value.page>1&&(i.value=[...i.value,...t.value.data]),t.value.data.length==0&&(n.value.is_last_record=!0)},F=async()=>{if(!n.value.may_get_data)return;let t=y.value;if(t.scrollLeft!=n.value.scrollLeft){n.value.scrollLeft=t.scrollLeft;return}n.value.is_last_record||!(Math.round(t.scrollTop)+t.clientHeight>=t.scrollHeight-1)||(n.value.page++,await T())},N=()=>{n.value.page=1,n.value.is_last_record=!1,E(),T()};Y();const m=o(!1),g=o(0),k=o(0),j=()=>{g.value=0,m.value=!0,k.value=!1},{display:L}=z();ee(z());const G=()=>{f.value==-1?L({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(g.value=i.value[f.value].id,m.value=!0,k.value=!1)},H=()=>{f.value==-1?L({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(g.value=i.value[f.value].id,m.value=!0,k.value=!0)};o(!1),o(0),o(!1);const U=o(!1);o({}),o(!1);const K=o("");return R(()=>K.value,t=>{t.trim().length>0?U.value=!0:U.value=!1},{immediate:!1}),(t,s)=>{const v=ce,x=_e,q=de,J=fe,Z=pe,Q=me;return c(),u("div",ve,[p(v,{title:"List Permission Group"}),e("div",he,[e("div",ye,[("useUtils"in t?t.useUtils:a(S))().checkPermission("permission_group.create")?(c(),u("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[0]||(s[0]=r=>H())},[p(x)])):D("",!0),("useUtils"in t?t.useUtils:a(S))().checkPermission("permission_group.create")?(c(),u("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[1]||(s[1]=r=>j())},[p(q)])):D("",!0),("useUtils"in t?t.useUtils:a(S))().checkPermission("permission_group.modify")?(c(),u("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[2]||(s[2]=r=>G())},[p(J)])):D("",!0)]),e("form",ge,[e("div",ke,[we,A(e("input",{class:"",type:"text","onUpdate:modelValue":s[3]||(s[3]=r=>se(_)?_.value=r:null),name:"search",placeholder:"Keyword"},null,512),[[te,a(_)]])]),e("div",be,[xe,A(e("select",{class:"","onUpdate:modelValue":s[4]||(s[4]=r=>a(d).field=r)},$e,512),[[B,a(d).field]])]),e("div",Pe,[Te,A(e("select",{class:"","onUpdate:modelValue":s[5]||(s[5]=r=>a(d).by=r)},Re,512),[[B,a(d).by]])]),e("div",ze,[e("button",{class:"",type:"submit",name:"button",onClick:s[6]||(s[6]=oe(r=>N(),["prevent"]))},[p(Z,{class:"text-2xl"})])])]),e("div",Be,[a(i).length==0?(c(),u("div",Ie," Maaf Tidak Ada Record ")):(c(),u("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:y,onScroll:F},[e("table",Me,[Oe,e("tbody",null,[(c(!0),u(ae,null,le(a(i),(r,C)=>(c(),u("tr",{key:C,onClick:Fe=>f.value=C,class:re(a(f)==C?"active":"")},[e("td",Ee,I(r.id),1),e("td",null,I(r.name),1)],10,Ve))),128))])])],544))])]),p(Q,{show:a(m),fnClose:()=>{m.value=!1},id:a(g),p_data:a(i),is_copy:a(k)},null,8,["show","fnClose","id","p_data","is_copy"])])}}};export{We as default};
