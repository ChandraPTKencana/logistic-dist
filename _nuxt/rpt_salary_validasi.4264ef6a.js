import{_ as U}from"./HeaderPopup.vue.0558765f.js";import{r as b,f as z,G as i,j as J,m as G,J as H,o as m,c as v,a as t,b as K,t as l,k as e,d as c,F as T,y as L,l as y,x as R,E as O,A as x,B as V,p as Q,e as W}from"./entry.b51a0cce.js";import{u as X}from"./useUtils.a5322f3a.js";import{u as Y}from"./useMyFetch.2ae20eaa.js";import{_ as Z}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.f995c822.js";const _=d=>(Q("data-v-a536299c"),d=d(),W(),d),tt={class:"box-fixed"},et={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},at={class:"w-full flex flex-col items-center grow overflow-auto"},st={class:"w-full flex flex-row flex-wrap"},lt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ot=_(()=>t("label",{for:""},"Period End",-1)),nt={class:"card-border"},rt={key:0,class:"w-full flex p-1 justify-between flex-wrap"},_t={class:"w-full",role:"sticky"},ut={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},it=_(()=>t("tr",{class:"sticky -top-1 !z-[2]"},[t("td",{colspan:"21",class:"!bg-slate-800 text-white font-bold"}," Detail ")],-1)),ct={class:"sticky top-7 !z-[2]"},dt=_(()=>t("th",{rowspan:"2"},"No",-1)),pt=_(()=>t("th",{rowspan:"2"},"ID",-1)),mt=_(()=>t("th",{rowspan:"2"},"Nama Pekerja",-1)),vt=_(()=>t("th",{rowspan:"2"},"Jabatan",-1)),ht=_(()=>t("th",{rowspan:"2"},"Tmpt Lahir",-1)),ft=_(()=>t("th",{rowspan:"2"},"Tgl Lahir",-1)),yt=_(()=>t("th",{rowspan:"2"},"TMK",-1)),wt=_(()=>t("th",{rowspan:"2"},"No KTP",-1)),bt=_(()=>t("th",{rowspan:"2"},"Alamat",-1)),xt=_(()=>t("th",{rowspan:"2"},"Status",-1)),kt=_(()=>t("th",{rowspan:"2"},"No Rek",-1)),gt=_(()=>t("th",{rowspan:"2"},"Nama Bank",-1)),jt={colspan:"3"},Ft={class:"text-sm"},Dt={colspan:"3"},St={class:"text-sm"},Et={rowspan:"2"},Mt={class:"text-sm"},Bt={rowspan:"2"},Nt={class:"text-sm"},Ct={rowspan:"2"},At={class:"text-sm"},Tt={class:"sticky top-[60px] !z-[2]"},Vt={class:"text-sm"},Yt={class:"text-sm"},$t={class:"text-sm"},qt={class:"text-sm"},It={class:"text-sm"},Pt={class:"text-sm"},Ut={ref:"to_move"},zt=["data-index"],Jt={class:"w-full flex items-center justify-end"},Gt={class:"w-full flex flex-wrap p-3 items-center"},Ht=_(()=>t("div",null," Di Validasi oleh : ",-1)),Kt={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},Lt={key:0},Rt={__name:"rpt_salary_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(d){const p=d,{$moment:w}=O(),{pointFormat:r}=X(),n=b({...{id:-1,name:"",tipe:"",is_transition:!1,amount:0,details:[],val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:"",val3:0,val3_by:{username:""},val3_at:""}}),E=z("token"),M=b({}),B=b(null),u=b([]),$=async()=>{x().loading_full=!0,M.value={};const s=new FormData;let o="post",h=p.id;h==0||(s.append("id",h),s.append("_method","PUT"));const{data:a,error:f,status:I}=await Y("/rpt_salary_validasi",{method:o,headers:{Authorization:`Bearer ${E.value}`,Accept:"application/json"},body:s,retry:0});if(x().loading_full=!1,I.value==="error"){V().trigger(f,M);return}n.value.val1=a.value.val1,n.value.val1_user=a.value.val1_user,n.value.val1_by=a.value.val1_by,n.value.val1_at=a.value.val1_at,n.value.val2=a.value.val2,n.value.val2_user=a.value.val2_user,n.value.val2_by=a.value.val2_by,n.value.val2_at=a.value.val2_at,n.value.val3=a.value.val3,n.value.val3_user=a.value.val3_user,n.value.val3_by=a.value.val3_by,n.value.val3_at=a.value.val3_at;let A=p.p_data.map(P=>P.id).indexOf(p.id);A>=-1&&p.p_data.splice(A,1,{...n.value}),p.fnClose()};i(()=>{let s=0;return u.value.forEach(o=>{s+=parseFloat(o.standby_nominal)}),s});const k=i(()=>{let s=0;return u.value.forEach(o=>{s+=parseFloat(o.sb_gaji)}),s}),g=i(()=>{let s=0;return u.value.forEach(o=>{s+=parseFloat(o.sb_makan)}),s}),j=i(()=>{let s=0;return u.value.forEach(o=>{s+=parseFloat(o.sb_dinas)}),s}),F=i(()=>{let s=0;return u.value.forEach(o=>{s+=parseFloat(o.uj_gaji)}),s}),D=i(()=>{let s=0;return u.value.forEach(o=>{s+=parseFloat(o.uj_makan)}),s}),S=i(()=>{let s=0;return u.value.forEach(o=>{s+=parseFloat(o.uj_dinas)}),s}),N=i(()=>{let s=0;return u.value.forEach(o=>{s+=parseFloat(o.nominal_cut)}),s}),C=i(()=>{let s=0;return u.value.forEach(o=>{s+=parseFloat(o.salary_bonus_nominal)}),s}),q=async()=>{x().loading_full=!0;const{data:s,error:o,status:h}=await Y("/rpt_salary",{method:"get",headers:{Authorization:`Bearer ${E.value}`,Accept:"application/json"},params:{id:p.id},retry:0});if(x().loading_full=!1,h.value==="error"){V().trigger(o);return}n.value=s.value.data,u.value=s.value.data.details};return i(()=>{let s=0;return u.value.forEach(o=>{o.p_status!="Remove"&&(s+=parseInt(o.amount))}),s}),i(()=>!1),J(()=>p.show,(s,o)=>{s==!0&&(p.is_view==!1&&setTimeout(()=>{B.value.focus()},1),q())},{immediate:!0}),(s,o)=>{const h=U;return G((m(),v("section",tt,[t("div",null,[K(h,{title:"Form Master Standby Validation",fn:d.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",et,[t("div",at,[t("div",st,[t("div",lt,[ot,t("div",nt,l(e(w)(e(n).period_end).format("MM-Y")),1)])]),e(u).length?(m(),v("div",rt,[t("div",_t,[t("table",ut,[t("thead",null,[it,t("tr",ct,[dt,pt,mt,vt,ht,ft,yt,wt,bt,xt,kt,gt,t("th",jt,[c("Standby "),t("span",Ft,"("+l(e(r)(e(k)+e(g)+e(j)||0))+")",1)]),t("th",Dt,[c("Trip "),t("span",St,"("+l(e(r)(e(F)+e(D)+e(S)||0))+")",1)]),t("th",Et,[c("Potongan "),t("span",Mt,"("+l(e(r)(e(N)||0))+")",1)]),t("th",Bt,[c("U.Kerajinan "),t("span",Nt,"("+l(e(r)(e(C)||0))+")",1)]),t("th",Ct,[c("Grand Total "),t("span",At,"("+l(e(r)(e(k)+e(g)+e(j)+e(F)+e(D)+e(S)-e(N)+e(C)||0))+")",1)])]),t("tr",Tt,[t("th",null,[c("SB.Gaji "),t("span",Vt,"("+l(e(r)(e(k)||0))+")",1)]),t("th",null,[c("SB.Makan "),t("span",Yt,"("+l(e(r)(e(g)||0))+")",1)]),t("th",null,[c("SB.Dinas "),t("span",$t,"("+l(e(r)(e(j)||0))+")",1)]),t("th",null,[c("UJ.Gaji "),t("span",qt,"("+l(e(r)(e(F)||0))+")",1)]),t("th",null,[c("UJ.Makan "),t("span",It,"("+l(e(r)(e(D)||0))+")",1)]),t("th",null,[c("UJ.Dinas "),t("span",Pt,"("+l(e(r)(e(S)||0))+")",1)])])]),t("tbody",Ut,[(m(!0),v(T,null,L(e(u),(a,f)=>(m(),v(T,{key:f},[a.p_status!="Remove"?(m(),v("tr",{key:0,"data-index":f},[t("td",null,l(f+1)+".",1),t("td",null,l(a.employee_id),1),t("td",null,l(a.employee_name),1),t("td",null,l(a.employee_role),1),t("td",null,l(a.employee_birth_place),1),t("td",null,l(a.employee_birth_date?e(w)(a.employee_birth_date).format("DD-MM-Y"):""),1),t("td",null,l(a.employee_tmk?e(w)(a.employee_tmk).format("DD-MM-Y"):""),1),t("td",null,l(a.employee_ktp_no),1),t("td",null,l(a.employee_address),1),t("td",null,l(a.employee_status),1),t("td",null,l(a.employee_rek_no),1),t("td",null,l(a.employee_bank_name),1),t("td",null,l(e(r)(a.sb_gaji)),1),t("td",null,l(e(r)(a.sb_makan)),1),t("td",null,l(e(r)(a.sb_dinas)),1),t("td",null,l(e(r)(a.uj_gaji)),1),t("td",null,l(e(r)(a.uj_makan)),1),t("td",null,l(e(r)(a.uj_dinas)),1),t("td",null,l(e(r)(a.nominal_cut)),1),t("td",null,l(e(r)(a.salary_bonus_nominal)),1),t("td",null,l(e(r)(parseFloat(a.sb_gaji)+parseFloat(a.sb_makan)+parseFloat(a.sb_dinas)+parseFloat(a.uj_gaji)+parseFloat(a.uj_makan)+parseFloat(a.uj_dinas)-parseFloat(a.nominal_cut)+parseFloat(a.salary_bonus_nominal))),1)],8,zt)):y("",!0)],64))),128))],512)])])])):y("",!0)]),t("div",Jt,[t("div",Gt,[Ht,e(n).val1||e(n).val2||e(n).val3?(m(),v("div",Kt,[e(n).val1?(m(),v("div",Lt," App 1 : "+l(e(n).val1_by.username)+" ( "+l(e(n).val1_at?e(w)(e(n).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):y("",!0)])):y("",!0)]),t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:o[0]||(o[0]=a=>d.fnClose())}," Cancel "),d.is_view==0?(m(),v("button",{key:0,ref_key:"it_val",ref:B,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:o[1]||(o[1]=R(a=>$(),["prevent"]))}," Validasi ",512)):y("",!0)])])])],512)),[[H,d.show]])}}},ae=Z(Rt,[["__scopeId","data-v-a536299c"]]);export{ae as default};
