import{_ as ee}from"./HeaderPopup.vue.03806b35.js";import{_ as te}from"./WidthMiniPart.vue.7a678e73.js";import se from"./AttachmentSingle.14865835.js";import ae from"./Times.4af9fea0.js";import le from"./Check.0374f44e.js";import oe from"./CaretTop.ac5d68bc.js";import ie from"./CaretDown.6d34db94.js";import{r as h,g as ne,P as de,i as W,f as re,k as _e,J as ce,o as r,c as u,a as e,b as y,t as o,l as t,F as K,D as ue,E as Q,z as A,n as m,C as E,d as ve,G as pe,x as Y,y as X,p as fe,e as me}from"./entry.0095ed96.js";import{u as k}from"./useUtils.d3103213.js";import{u as Z}from"./useMyFetch.35432c46.js";import{_ as we}from"./_plugin-vue_export-helper.c27b6911.js";import"./PDFJsView.5c808b19.js";const i=v=>(fe("data-v-023318ce"),v=v(),me(),v),xe={class:"box-fixed"},he={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},be={class:"w-full flex flex-col items-center grow overflow-auto"},ye={class:"w-full flex flex-row flex-wrap"},ke={class:"w-full sm:w-9/12 flex px-2 py-3"},ge={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},De=i(()=>e("div",{class:"absolute bg-white -top-3"}," Standby ",-1)),Ce={class:"w-6/12 sm:w-2/12 flex flex-col flex-wrap p-1"},Se=i(()=>e("label",{for:""},"ID",-1)),Ne={class:"card-border"},Ie={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Pe=i(()=>e("label",{for:""},"Name",-1)),Te={class:"card-border"},Ae={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Ye=i(()=>e("label",{for:""},"Type",-1)),$e={class:"card-border"},Fe={class:"w-6/12 sm:w-2/12 flex flex-col flex-wrap p-1"},Ue=i(()=>e("label",{for:""},"Amount",-1)),Be={class:"card-border"},Me={class:"w-full sm:w-3/12 flex px-2 py-3"},je={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative items-end"},Ve=i(()=>e("div",{class:"absolute bg-white -top-3"}," Peralihan ",-1)),Ee={class:"w-6/12 flex flex-col flex-wrap p-1"},Oe={class:"card-border"},He={class:"w-6/12 flex flex-col flex-wrap p-1"},Re={class:"card-border"},Le={class:"w-full flex flex-wrap"},qe={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},ze=i(()=>e("label",{for:""},"Supir",-1)),Je={class:"card-border"},Ge={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},We=i(()=>e("label",{for:""},"Kernet",-1)),Ke={class:"card-border"},Qe={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Xe=i(()=>e("label",{for:""},"No Pol",-1)),Ze={class:"card-border"},et={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},tt=i(()=>e("label",{for:""},"Tujuan",-1)),st={class:"card-border"},at={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},lt=i(()=>e("label",{for:""},"Note For Remarks",-1)),ot={class:"card-border"},it={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},nt=i(()=>e("label",{for:""},"Trx Trp ID#",-1)),dt={class:"card-border"},rt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},_t={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},ct=i(()=>e("div",{class:"absolute bg-white -top-3"}," Cost Center ",-1)),ut={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},vt=i(()=>e("label",{for:""}," Code",-1)),pt={class:"card-border"},ft={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},mt=i(()=>e("label",{for:""},"Desc",-1)),wt={class:"card-border disabled"},xt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},ht={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},bt=i(()=>e("div",{class:"absolute bg-white -top-3"}," PVR ",-1)),yt={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},kt=i(()=>e("label",{for:""},"No",-1)),gt={class:"card-border disabled"},Dt={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Ct=i(()=>e("label",{for:""},"Total",-1)),St={class:"card-border disabled"},Nt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},It={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},Pt=i(()=>e("div",{class:"absolute bg-white -top-3"}," PV ",-1)),Tt={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},At=i(()=>e("label",{for:""},"No",-1)),Yt={class:"card-border disabled"},$t={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Ft=i(()=>e("label",{for:""},"Total",-1)),Ut={class:"card-border disabled"},Bt={class:"w-full flex grow p-1 overflow-auto 2xl:overflow-hidden justify-between flex-wrap"},Mt={class:"w-full",role:"sticky"},jt={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},Vt={class:"sticky -top-1 !z-[2]"},Et=["colspan"],Ot=i(()=>e("tr",{class:"sticky top-7 !z-[2]"},[e("th",{class:"!min-w-[50px] !w-[50px] !max-w-[50px]"},"No"),e("th",{class:"!min-w-[90px] !w-[90px] !max-w-[90px]"},"Tanggal"),e("th",{class:"!min-w-[55px] !w-[55px] !max-w-[55px]"},"Waktu"),e("th",{class:"!min-w-[200px] !w-[200px] !max-w-[200px]"},"Foto"),e("th",{class:"!min-w-[200px] !w-[200px] !max-w-[200px]"},"Note"),e("th",{class:"!min-w-[70px] !w-[70px] !max-w-[70px]"},"Dibayar")],-1)),Ht={ref:"to_move"},Rt=["data-index"],Lt={class:"cell"},qt={class:"w-full h-auto flex items-center justify-center relative"},zt={class:"cell"},Jt={class:"w-full h-auto flex items-center justify-center relative"},Gt={class:"cell"},Wt={style:{width:"60vw"},class:"h-auto flex items-center justify-center"},Kt={class:"cell"},Qt={class:"h-auto flex items-center justify-center"},Xt={class:"w-full h-auto flex items-center justify-center"},Zt={key:0,class:"text-3xl"},es=["onClick"],ts={class:"w-full flex items-center justify-end"},ss={class:"w-full flex flex-wrap p-3 items-center"},as=i(()=>e("div",null," Di Validasi oleh : ",-1)),ls={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},os={key:0},is={key:1},ns={key:2},ds={key:0,class:"text-xs font-bold"},rs={__name:"standby_trx_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},emits:["setID","setIndex"],setup(v,{emit:g}){const c=v,{$moment:D}=pe(),{pointFormat:$}=k(),O={id:-1,transition_target:"",transition_type:"",standby_mst_id:"",standby_mst_:{name:"",tipe:"",amount:0},supir:"",kernet:"",no_pol:"",xto:"",note_for_remarks:"",trx_trp_id:"",cost_center_code:"",cost_center_desc:"",pvr_id:"",pvr_no:"",pvr_total:0,pvr_had_detail:0,pv_id:"",pv_no:"",pv_total:0,pv_datetime:"",rv_id:"",rv_no:"",rv_total:0,rv_had_detail:"",details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:""},s=h({...O}),H=ne("token"),R=h({}),L=h(null),C=h([]),q={_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:-1,name:"",title:""};let F=a=>{a.key=="ArrowUp"&&J(),a.key=="ArrowDown"&&z()};de(()=>{document.removeEventListener("keydown",F)});const w=h(JSON.parse(JSON.stringify(q))),x=h(JSON.parse(JSON.stringify(q))),b=h(""),U=async a=>{b.value="PROSES...",Y().loading_full=!0,R.value={};const l=new FormData;let f=[...C.value];a=="paid"?f=f.map((p,P)=>(p.be_paid=1,p)):a=="nopaid"&&(f=f.map((p,P)=>(p.be_paid=0,p))),l.append("details",JSON.stringify(f));let n="post",S=c.id;S==0||(l.append("id",S),l.append("_method","PUT"));const{data:_,error:N,status:j}=await Z("/standby_trx_validasi",{method:n,headers:{Authorization:`Bearer ${H.value}`,Accept:"application/json"},body:l,retry:0});if(Y().loading_full=!1,j.value==="error"){b.value="GAGAL",X().trigger(N,R);return}s.value.val=_.value.val,s.value.val_user=_.value.val_user,s.value.val_by=_.value.val_by,s.value.val_at=_.value.val_at,s.value.val1=_.value.val1,s.value.val1_user=_.value.val1_user,s.value.val1_by=_.value.val1_by,s.value.val1_at=_.value.val1_at,s.value.val2=_.value.val2,s.value.val2_user=_.value.val2_user,s.value.val2_by=_.value.val2_by,s.value.val2_at=_.value.val2_at;let I=c.p_data.map(p=>p.id).indexOf(c.id);I>=-1&&c.p_data.splice(I,1,{...s.value}),b.value="BERHASIL"},B=async()=>{b.value="",Y().loading_full=!0;const{data:a,error:l,status:f}=await Z("/standby_trx",{method:"get",headers:{Authorization:`Bearer ${H.value}`,Accept:"application/json"},params:{id:c.id},retry:0});if(Y().loading_full=!1,f.value==="error"){X().trigger(l);return}let n=a.value.data;s.value=n,w.value._.id.val=n.supir_id,w.value._.name.val=n.supir,w.value._.rek_no.val=n.supir_rek_no,w.value._.rek_name.val=n.supir_rek_name,w.value.id=n.supir_id,w.value.name=n.supir,w.value.rek_no=(n.supir_rek_no||"")+" "+(n.supir_rek_name||""),x.value._.id.val=n.kernet_id,x.value._.name.val=n.kernet,x.value._.rek_no.val=n.kernet_rek_no,x.value._.rek_name.val=n.kernet_rek_name,x.value.id=n.kernet_id,x.value.name=n.kernet,x.value.rek_no=(n.kernet_rek_no||"")+" "+(n.kernet_rek_name||""),C.value=a.value.data.details};W(()=>{let a=0;return C.value.forEach(l=>{l.p_status!="Remove"&&(a+=l.amount)}),a});const M=W(()=>s.value.val2==1);re(()=>c.show,(a,l)=>{a==!0?(document.addEventListener("keydown",F),s.value={...O},c.is_view==!1&&setTimeout(()=>{L.value.focus()},1),B()):document.removeEventListener("keydown",F)},{immediate:!0});const z=()=>{let a=c.p_data.map(l=>l.id).indexOf(c.id);a!=c.p_data.length-1&&(a++,g("setID",c.p_data[a].id),g("setIndex",a),setTimeout(()=>{B()},100))},J=()=>{let a=c.p_data.map(l=>l.id).indexOf(c.id);a!=0&&(a--,g("setID",c.p_data[a].id),g("setIndex",a),setTimeout(()=>{B()},100))};return(a,l)=>{var p,P,G;const f=ee,n=te,S=se,_=ae,N=le,j=oe,I=ie;return _e((r(),u("section",xe,[e("div",null,[y(f,{title:"Form Transaction Standby Validation",fn:v.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",he,[e("div",be,[e("div",ye,[e("div",ke,[e("div",ge,[De,e("div",Ce,[Se,e("div",Ne,o(t(s).standby_mst_id),1)]),e("div",Ie,[Pe,e("div",Te,o((p=t(s).standby_mst_)==null?void 0:p.name),1)]),e("div",Ae,[Ye,e("div",$e,o((P=t(s).standby_mst_)==null?void 0:P.tipe),1)]),e("div",Fe,[Ue,e("div",Be,o(t($)((G=t(s).standby_mst_)==null?void 0:G.amount)),1)])])]),e("div",Me,[e("div",je,[Ve,e("div",Ee,[e("div",Oe,o(t(s).transition_type),1)]),e("div",He,[e("div",Re,o(t(s).transition_target),1)])])]),e("div",Le,[e("div",qe,[ze,e("div",Je,[y(n,{selected:t(w)},null,8,["selected"])])]),e("div",Ge,[We,e("div",Ke,[y(n,{selected:t(x)},null,8,["selected"])])]),e("div",Qe,[Xe,e("div",Ze,o(t(s).no_pol),1)]),e("div",et,[tt,e("div",st,o(t(s).xto),1)]),e("div",at,[lt,e("div",ot,o(t(s).note_for_remarks),1)]),e("div",it,[nt,e("div",dt,o(t(s).trx_trp_id),1)])]),e("div",rt,[e("div",_t,[ct,e("div",ut,[vt,e("div",pt,o(t(s).cost_center_code),1)]),e("div",ft,[mt,e("div",wt,o(t(s).cost_center_desc),1)])])]),e("div",xt,[e("div",ht,[bt,e("div",yt,[kt,e("div",gt,o(t(s).pvr_no),1)]),e("div",Dt,[Ct,e("div",St,o(t($)(t(s).pvr_total||0)),1)])])]),e("div",Nt,[e("div",It,[Pt,e("div",Tt,[At,e("div",Yt,o(t(s).pv_no),1)]),e("div",$t,[Ft,e("div",Ut,o(t($)(t(s).pv_total)),1)])])]),e("div",Bt,[e("div",Mt,[e("table",jt,[e("thead",null,[e("tr",Vt,[e("td",{colspan:t(M)?6:7,class:"!bg-slate-800 text-white font-bold"}," Detail Transaction ",8,Et)]),Ot]),e("tbody",Ht,[(r(!0),u(K,null,ue(t(C),(d,V)=>(r(),u(K,{key:V},[d.p_status!="Remove"?(r(),u("tr",{key:0,"data-index":V},[e("td",null,o(V+1)+".",1),e("td",Lt,[e("div",qt,o(t(D)(d.tanggal).format("DD-MM-YYYY")),1)]),e("td",zt,[e("div",Jt,o(d.waktu.substring(0,5)),1)]),e("td",Gt,[e("div",Wt,[y(S,{value:d.attachment_1_preview,onSetFile:T=>d.attachment_1=T,onSetPreview:T=>d.attachment_1_preview=T},null,8,["value","onSetFile","onSetPreview"])])]),e("td",Kt,[e("div",Qt,o(d.note),1)]),e("td",{class:Q(["cell",!("useUtils"in a?a.useUtils:t(k))().checkPermissions(["standby_trx.detail.decide_paid"])||t(M)||v.is_view?"unselectable":""])},[e("div",Xt,[!("useUtils"in a?a.useUtils:t(k))().checkPermissions(["standby_trx.detail.decide_paid"])||t(M)||v.is_view?(r(),u("div",Zt,[d.be_paid==0?(r(),A(_,{key:0,class:"text-red-800"})):(r(),A(N,{key:1,class:"text-green-800"}))])):(r(),u("button",{key:1,type:"button",onClick:T=>d.be_paid=d.be_paid?0:1,class:Q(["text-white w-auto rounded text-xl",d.be_paid?"bg-green-600":"bg-red-600"])},[d.be_paid==0?(r(),A(_,{key:0})):(r(),A(N,{key:1}))],10,es))])],2)],8,Rt)):m("",!0)],64))),128))],512)])])])])]),e("div",ts,[e("div",ss,[as,t(s).val||t(s).val1||t(s).val2?(r(),u("div",ls,[t(s).val?(r(),u("div",os," App 1 : "+o(t(s).val_by.username)+" ( "+o(t(s).val_at?t(D)(t(s).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0),t(s).val1?(r(),u("div",is," App 2 : "+o(t(s).val1_by.username)+" ( "+o(t(s).val1_at?t(D)(t(s).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0),t(s).val2?(r(),u("div",ns," App 3 : "+o(t(s).val2_by.username)+" ( "+o(t(s).val2_at?t(D)(t(s).val2_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0)])):m("",!0)]),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:l[0]||(l[0]=d=>J())},[y(j,{class:"black"})]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:l[1]||(l[1]=d=>v.fnClose())}," Cancel "),v.is_view==0&&("useUtils"in a?a.useUtils:t(k))().checkPermissions(["standby_trx.detail.decide_paid"])&&t(s).val2=="0"?(r(),u("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-green-600 text-white text-xs rounded-sm",onClick:l[2]||(l[2]=E(d=>U("paid"),["prevent"]))}," Paid ")):m("",!0),v.is_view==0&&("useUtils"in a?a.useUtils:t(k))().checkPermissions(["standby_trx.detail.decide_paid"])&&t(s).val2=="0"?(r(),u("button",{key:1,type:"submit",name:"button",class:"w-36 m-1 bg-red-600 text-white text-xs rounded-sm",onClick:l[3]||(l[3]=E(d=>U("nopaid"),["prevent"]))}," NoPaid ")):m("",!0),v.is_view==0?(r(),u("button",{key:2,ref_key:"it_val",ref:L,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:l[4]||(l[4]=E(d=>U(),["prevent"]))},[ve(" Validasi "),t(b)!=""?(r(),u("div",ds,o(t(b)),1)):m("",!0)],512)):m("",!0),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:l[5]||(l[5]=d=>z())},[y(I,{class:"black"})])])])])],512)),[[ce,v.show]])}}},ks=we(rs,[["__scopeId","data-v-023318ce"]]);export{ks as default};
