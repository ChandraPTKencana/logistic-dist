import{g as ce,h as fe,r as n,f as U,C as pe,j,s as me,c as f,b as p,a as o,l as t,n as g,F as ve,E as ye,w as he,q as ge,x as m,y as w,o as u,G as we,z as H,t as k,d as ke,k as xe,A as be,m as Ce,B as z,H as De,_ as E}from"./entry.450f3054.js";import Ae from"./Header.3dc61caf.js";import Pe from"./Plus.aceb4550.js";import ze from"./Edit.ddf9bcb4.js";import Ee from"./Signature.54a7be06.js";import Le from"./Table2Column.47e9d8b3.js";import Te from"./TableUp.bcb0cf21.js";import $e from"./Line.1b5b48df.js";import Me from"./Check.135d567f.js";import{u as V}from"./useUtils.f22d17c7.js";import{u as x}from"./useMyFetch.e6f412ed.js";import{u as Ie}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";const Se=z(()=>E(()=>import("./PopupMini.68525c9f.js"),["./PopupMini.68525c9f.js","./PopupMini.vue.3116d504.js","./Times.db8d9a46.js","./_plugin-vue_export-helper.c27b6911.js","./entry.450f3054.js","./entry.c5f8f180.css","./Exclamation.820a3739.js"],import.meta.url).then(i=>i.default||i)),Ve=z(()=>E(()=>import("./salary_paid.3dc90146.js"),["./salary_paid.3dc90146.js","./HeaderPopup.vue.a23d4aa3.js","./Times.db8d9a46.js","./_plugin-vue_export-helper.c27b6911.js","./entry.450f3054.js","./entry.c5f8f180.css","./client-only.9cf9a7f5.js","./useUtils.f22d17c7.js","./useMyFetch.e6f412ed.js"],import.meta.url).then(i=>i.default||i)),Be=z(()=>E(()=>import("./salary_paid_validasi.c2db69b4.js"),["./salary_paid_validasi.c2db69b4.js","./HeaderPopup.vue.a23d4aa3.js","./Times.db8d9a46.js","./_plugin-vue_export-helper.c27b6911.js","./entry.450f3054.js","./entry.c5f8f180.css","./useUtils.f22d17c7.js","./useMyFetch.e6f412ed.js"],import.meta.url).then(i=>i.default||i)),Fe=z(()=>E(()=>import("./PDFView.5b47b6a9.js"),["./PDFView.5b47b6a9.js","./Times.db8d9a46.js","./_plugin-vue_export-helper.c27b6911.js","./entry.450f3054.js","./entry.c5f8f180.css","./useDownload.174f4da2.js"],import.meta.url).then(i=>i.default||i)),Oe={class:"w-full h-full flex flex-col"},Re={class:"w-full flex grow flex-col overflow-auto h-0"},Ue={class:"w-full flex"},je={class:"w-full flex justify-center items-center grow h-0 p-1"},He={key:0,class:""},Ne={class:"tacky"},Ye=o("thead",null,[o("tr",{class:"sticky top-0 !z-[2]"},[o("th",null,"Logistik"),o("th",null,"ID"),o("th",null,"Period End"),o("th",null,"Period Part"),o("th",null,"Created At"),o("th",null,"Updated At")])],-1),qe=["onClick"],Ge={class:"flex items-center justify-center"},Je={class:"bold"},Ze={class:"grow mb-5"},_t={__name:"index",async setup(i){let b,B;const{$moment:L}=De(),c={};c._TimeZoneOffset=new Date().getTimezoneOffset(),c.sort="created_at:desc";const v=ce("token"),{data:N}=([b,B]=fe(async()=>ge(async()=>{let e=[];m().loading_full=!0;const{data:a,error:_,status:h}=await x("/salary_paids",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:c,retry:0});return m().loading_full=!1,h.value==="error"?(w().trigger(_),{salary_paids:e}):(e=a.value.data,{salary_paids:e})},{lazy:!0,server:!1,default:()=>({salary_paids:[]})},"$5DNPjgzs1s")),b=await b,B(),b),l=n([]);U(()=>{var e;return(e=N.value)==null?void 0:e.salary_paids},e=>{e&&(l.value=[...e])},{immediate:!0}),n(""),n({field:"created_at",by:"desc"});const r=n(-1),d=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),C=n(null),Y=async()=>{m().loading_full=!0,d.value.may_get_data=!1,c.page=d.value.page,c.page==1&&(l.value=[]),c.first_row&&delete c.first_row,c.page>1&&(c.first_row=JSON.stringify(l.value[0]));const{data:e,error:a,status:_}=await x("/salary_paids",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:c,retry:0});if(m().loading_full=!1,d.value.may_get_data=!0,_.value==="error"){w().trigger(a);return}d.value.page==1?(l.value=e.value.data,C.value&&(C.value.scrollTop=0)):d.value.page>1&&(l.value=[...l.value,...e.value.data]),e.value.data.length==0&&(d.value.is_last_record=!0)},q=async()=>{if(!d.value.may_get_data)return;let e=C.value;if(e.scrollLeft!=d.value.scrollLeft){d.value.scrollLeft=e.scrollLeft;return}d.value.is_last_record||!(Math.round(e.scrollTop)+e.clientHeight>=e.scrollHeight-1)||(d.value.page++,await Y())};pe();const D=n(!1),T=n(0),A=n(0),G=()=>{T.value=0,D.value=!0,A.value=!1},{display:F}=j();me(j());const J=()=>{r.value==-1?F({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(T.value=l.value[r.value].id,D.value=!0,A.value=!1)},$=n(!1),O=n(0),Z=()=>{r.value==-1?F({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(O.value=l.value[r.value].id,A.value=!1,$.value=!0)},M=n(!1),K=n({}),P=n(!1),y=n(""),Q=async()=>{P.value&&(P.value=!1)};U(()=>y.value,e=>{e.trim().length>0?M.value=!0:M.value=!1},{immediate:!1});const W=async()=>{m().loading_full=!0;const e=new FormData;e.append("id",l.value[r.value].id),e.append("deleted_reason",y.value),e.append("_method","DELETE");const{data:a,error:_,status:h}=await x("/salary_paid",{method:"post",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},body:e,retry:0});if(m().loading_full=!1,h.value==="error"){w().trigger(_);return}l.value.splice(r.value,1),r.value=-1,P.value=!1},{downloadFile:R,viewFile:Ke}=Ie(),I=n(!1),X=n({}),ee=async()=>{m().loading_full=!0;const{data:e,error:a,status:_}=await x("/salary_paid/excel_download",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:{id:l.value[r.value].id},retry:0});if(m().loading_full=!1,_.value==="error"){w().trigger(a);return}R(e.value)},te=async()=>{m().loading_full=!0;const{data:e,error:a,status:_}=await x("/salary_paid/excel_download2",{method:"get",headers:{Authorization:`Bearer ${v.value}`,Accept:"application/json"},params:{id:l.value[r.value].id},retry:0});if(m().loading_full=!1,_.value==="error"){w().trigger(a);return}R(e.value)};return(e,a)=>{const _=Ae,h=Pe,ae=ze,oe=Ee,le=Le,se=Te,ne=$e,re=Me,ie=Se,ue=Ve,de=Be,_e=Fe;return u(),f("div",Oe,[p(_,{title:"List Salary Paid"}),o("div",Re,[o("div",Ue,[("useUtils"in e?e.useUtils:t(V))().checkPermission("salary_paid.create")?(u(),f("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[0]||(a[0]=s=>G())},[p(h)])):g("",!0),("useUtils"in e?e.useUtils:t(V))().checkPermissions(["salary_paid.modify"])?(u(),f("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[1]||(a[1]=s=>J())},[p(ae)])):g("",!0),("useUtils"in e?e.useUtils:t(V))().checkPermissions(["salary_paid.val1","salary_paid.val2","salary_paid.val3"])?(u(),f("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[2]||(a[2]=s=>Z())},[p(oe)])):g("",!0),t(r)>-1&&t(l)[t(r)].val1==1?(u(),f("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[3]||(a[3]=s=>ee())},[p(le)])):g("",!0),t(r)>-1&&t(l)[t(r)].val1==1?(u(),f("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[4]||(a[4]=s=>te())},[p(se)])):g("",!0)]),o("div",je,[t(l).length==0?(u(),f("div",He," Maaf Tidak Ada Record ")):(u(),f("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:C,onScroll:q},[o("table",Ne,[Ye,o("tbody",null,[(u(!0),f(ve,null,ye(t(l),(s,S)=>(u(),f("tr",{key:S,onClick:Qe=>r.value=S,class:we(t(r)==S?"active":"")},[o("td",null,[o("div",Ge,[s.val1?(u(),H(re,{key:1})):(u(),H(ne,{key:0}))])]),o("td",Je,k(s.id),1),o("td",null,k(s.period_end?t(L)(s.period_end).format("MM-Y"):""),1),o("td",null,k(s.period_part),1),o("td",null,k(s.created_at?t(L)(s.created_at).format("DD-MM-Y HH:mm:ss"):""),1),o("td",null,k(s.updated_at?t(L)(s.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,qe))),128))])])],544))])]),p(ie,{type:"delete",show:t(P),data:t(K),fnClose:Q,fnConfirm:W,enabledOk:t(M)},{footer:he(()=>[ke(" Masukkan Alasan Penghapusan: "),o("div",Ze,[xe(o("textarea",{"onUpdate:modelValue":a[5]||(a[5]=s=>Ce(y)?y.value=s:null)},null,512),[[be,t(y)]])])]),_:1},8,["show","data","enabledOk"]),p(ue,{show:t(D),fnClose:()=>{D.value=!1},id:t(T),p_data:t(l),is_copy:t(A)},null,8,["show","fnClose","id","p_data","is_copy"]),p(de,{show:t($),fnClose:()=>{$.value=!1},id:t(O),p_data:t(l)},null,8,["show","fnClose","id","p_data"]),p(_e,{show:t(I),pdfContent:t(X),onClose:a[6]||(a[6]=s=>I.value=!t(I))},null,8,["show","pdfContent"])])}}};export{_t as default};
