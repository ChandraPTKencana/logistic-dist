import ae from"./Header.f4bd81f9.js";import oe from"./Plus.96388b84.js";import le from"./Edit.7a14f9d1.js";import ne from"./Delete.d729cd52.js";import re from"./Search.839158cd.js";import{_ as ue}from"./PopupMini.vue.1f68efd6.js";import ie from"./user.80aff2ec.js";import{_ as ce}from"./GAQR.vue.c4c9dd15.js";import{g as de,h as _e,r as c,B as pe,j,s as fe,c as g,a as e,b as _,k as B,A as me,l as o,m as ve,v as R,C as he,F as z,D as ge,q as ye,x as p,y as C,o as y,E as ke,t as f,p as we,e as xe,G as be}from"./entry.5eaee47b.js";import{u as S}from"./useMyFetch.c1c4d34c.js";import{_ as De}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.83c50a35.js";import"./Exclamation.ae96152b.js";import"./HeaderPopup.vue.4d128728.js";import"./useUtils.478d066b.js";const d=k=>(we("data-v-7cf67e2c"),k=k(),xe(),k),Ae={class:"w-full h-full flex flex-col"},Ce={class:"w-full flex grow flex-col overflow-auto h-0"},Se={class:"w-full flex"},$e={action:"#",class:"w-full flex p-1"},Te={class:"grow"},Me=d(()=>e("div",{class:"font-bold"}," Keyword ",-1)),Ue={class:"pl-1"},Be=d(()=>e("div",{class:"font-bold"}," Sort By ",-1)),Fe=d(()=>e("option",{value:""},null,-1)),Ee=d(()=>e("option",{value:"username"},"Username",-1)),He=d(()=>e("option",{value:"hak_akses"},"Hak Akses",-1)),Ie=d(()=>e("option",{value:"is_active"},"Status",-1)),Le=[Fe,Ee,He,Ie],je={class:"pl-1"},Re=d(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),ze=d(()=>e("option",{value:"asc"},"Asc",-1)),qe=d(()=>e("option",{value:"desc"},"Desc",-1)),Ne=[ze,qe],Pe={class:"flex items-end pl-1"},Ve={class:"w-full flex justify-center items-center grow h-0 p-1"},Ge={key:0,class:""},Oe={class:"tacky"},Ye=d(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"User ID"),e("th",null,"Username"),e("th",null,"Hak Akses"),e("th",null,"Group"),e("th",null,"Status"),e("th",null,"Tanggal Dibuat"),e("th",null,"Tanggal Diubah")])],-1)),Ke=["onClick"],Qe={class:"bold"},Je={__name:"index",async setup(k){let w,F;const{$moment:E}=be(),r={};r._TimeZoneOffset=new Date().getTimezoneOffset();const x=de("token"),{data:n}=([w,F]=_e(async()=>ye(async()=>{p().loading_full=!0;const{data:s,error:t,status:i}=await S("/users",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:r,retry:0});return p().loading_full=!1,i.value==="error"?(C().trigger(t),[]):s.value.data},"$4SJ9UL5Y8i")),w=await w,F(),w),v=c(""),m=c({field:"",by:"desc"}),u=c(-1),l=c({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),q=()=>{r.like="",v.value!=""&&(r.like=`id:%${v.value}%,username:%${v.value}%`),r.sort="",m.value.field&&(r.sort=m.value.field+":"+m.value.by)},N=s=>{let t=[];return s.permission_group_users&&s.permission_group_users.length>0&&s.permission_group_users.forEach(i=>{t.push(i.permission_group.name)}),t.join(",")},b=c(null),H=async()=>{p().loading_full=!0,l.value.may_get_data=!1,r.page=l.value.page,r.page==1&&(n.value=[]);const{data:s,error:t,status:i}=await S("/users",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:r,retry:0});if(p().loading_full=!1,l.value.may_get_data=!0,i.value==="error"){C().trigger(t);return}l.value.page==1?(n.value=s.value.data,b.value&&(b.value.scrollTop=0)):l.value.page>1&&(n.value=[...n.value,...s.value.data]),s.value.data.length==0&&(l.value.is_last_record=!0)},P=async()=>{if(!l.value.may_get_data)return;let s=b.value;if(s.scrollLeft!=l.value.scrollLeft){l.value.scrollLeft=s.scrollLeft;return}l.value.is_last_record||!(Math.round(s.scrollTop)+s.clientHeight>=s.scrollHeight-1)||(l.value.page++,await H())},V=()=>{l.value.page=1,l.value.is_last_record=!1,q(),H()};pe();const D=c(!1),$=c(0),G=()=>{$.value=0,D.value=!0},{display:T}=j();fe(j());const O=()=>{u.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):($.value=n.value[u.value].id,D.value=!0)},I=c({}),h=c(!1),Y=async()=>{h.value&&(h.value=!1)},K=()=>{u.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(I.value={id:n.value[u.value].id},h.value=!0)},Q=async()=>{p().loading_full=!0;const s=new FormData;s.append("id",n.value[u.value].id),s.append("_method","DELETE");const{data:t,error:i,status:U}=await S("/user",{method:"post",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},body:s,retry:0});if(p().loading_full=!1,U.value==="error"){C().trigger(i);return}n.value.splice(u.value,1),u.value=-1,h.value=!1},L=c(""),M=c(!1),J=async()=>{if(u.value==-1){T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"});return}r.id=n.value[u.value].id,p().loading_full=!0;const{data:s,error:t,status:i}=await S("/ga_qr",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:r,retry:0});if(p().loading_full=!1,i.value==="error"){C().trigger(t);return}L.value=s.value,M.value=!0};return(s,t)=>{const i=ae,U=oe,Z=le,W=ne,X=re,ee=ue,te=ie,se=ce;return y(),g(z,null,[e("div",Ae,[_(i,{title:"List User"}),e("div",Ce,[e("div",Se,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[0]||(t[0]=a=>G())},[_(U)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=a=>O())},[_(Z)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=a=>K())},[_(W)]),e("button",{type:"button",name:"button",class:"m-1 text-xs",onClick:t[3]||(t[3]=a=>J())}," SET 2FA ")]),e("form",$e,[e("div",Te,[Me,B(e("input",{class:"",type:"text","onUpdate:modelValue":t[4]||(t[4]=a=>ve(v)?v.value=a:null),name:"search",placeholder:"Keyword"},null,512),[[me,o(v)]])]),e("div",Ue,[Be,B(e("select",{class:"","onUpdate:modelValue":t[5]||(t[5]=a=>o(m).field=a)},Le,512),[[R,o(m).field]])]),e("div",je,[Re,B(e("select",{class:"","onUpdate:modelValue":t[6]||(t[6]=a=>o(m).by=a)},Ne,512),[[R,o(m).by]])]),e("div",Pe,[e("button",{class:"",type:"submit",name:"button",onClick:t[7]||(t[7]=he(a=>V(),["prevent"]))},[_(X,{class:"text-2xl"})])])]),e("div",Ve,[o(n).length==0?(y(),g("div",Ge," Maaf Tidak Ada Record ")):(y(),g("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:P},[e("table",Oe,[Ye,e("tbody",null,[(y(!0),g(z,null,ge(o(n),(a,A)=>(y(),g("tr",{key:A,onClick:Ze=>u.value=A,class:ke(o(u)==A?"active":"")},[e("td",null,f(A+1)+".",1),e("td",null,f(a.id),1),e("td",Qe,f(a.username),1),e("td",null,f(a.hak_akses),1),e("td",null,f(N(a)),1),e("td",null,f(a.is_active?"Aktif":"Nonaktif"),1),e("td",null,f(o(E)(a.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,f(o(E)(a.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,Ke))),128))])])],544))])])]),_(ee,{type:"delete",show:o(h),data:o(I),fnClose:Y,fnConfirm:Q},null,8,["show","data"]),_(te,{show:o(D),fnClose:()=>{D.value=!1},id:o($),p_data:o(n)},null,8,["show","fnClose","id","p_data"]),_(se,{show:o(M),fnClose:()=>{M.value=!1},qrCodeUrl:o(L)},null,8,["show","fnClose","qrCodeUrl"])],64)}}},pt=De(Je,[["__scopeId","data-v-7cf67e2c"]]);export{pt as default};
