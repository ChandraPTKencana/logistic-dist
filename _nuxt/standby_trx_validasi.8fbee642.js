import{_ as ee}from"./HeaderPopup.vue.9016828c.js";import{_ as te}from"./WidthMiniPart.vue.fbc49bfc.js";import se from"./AttachmentSingle.ffdc8a9e.js";import ae from"./Times.dfbe592b.js";import le from"./Check.2743db0b.js";import oe from"./CaretTop.2f18ee6c.js";import ie from"./CaretDown.1da1b84d.js";import{r as h,f as ne,P as de,G as K,j as re,m as _e,J as ce,o as d,c as v,a as e,b as y,t as o,k as t,F as W,y as ve,C as Q,D as Y,l as m,x as E,d as ue,E as pe,A as $,B as X,p as fe,e as me}from"./entry.5c8858ab.js";import{u as k}from"./useUtils.146c08c5.js";import{u as Z}from"./useMyFetch.f6def584.js";import{_ as we}from"./_plugin-vue_export-helper.c27b6911.js";import"./PDFJsView.48c17618.js";const i=u=>(fe("data-v-b2cc913c"),u=u(),me(),u),xe={class:"box-fixed"},he={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},be={class:"w-full flex flex-col items-center grow overflow-auto"},ye={class:"w-full flex flex-row flex-wrap"},ke={class:"w-full sm:w-9/12 flex px-2 py-3"},ge={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},De=i(()=>e("div",{class:"absolute bg-white -top-3"}," Standby ",-1)),Ce={class:"w-6/12 sm:w-2/12 flex flex-col flex-wrap p-1"},Se=i(()=>e("label",{for:""},"ID",-1)),Ne={class:"card-border"},Ie={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Pe=i(()=>e("label",{for:""},"Name",-1)),Ae={class:"card-border"},Ye={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},$e=i(()=>e("label",{for:""},"Type",-1)),Te={class:"card-border"},Be={class:"w-6/12 sm:w-2/12 flex flex-col flex-wrap p-1"},Fe=i(()=>e("label",{for:""},"Amount",-1)),Ue={class:"card-border"},Me={class:"w-full sm:w-3/12 flex px-2 py-3"},je={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative items-end"},Ve=i(()=>e("div",{class:"absolute bg-white -top-3"}," Peralihan ",-1)),Ee={class:"w-6/12 flex flex-col flex-wrap p-1"},Oe={class:"card-border"},Re={class:"w-6/12 flex flex-col flex-wrap p-1"},He={class:"card-border"},Le={class:"w-full flex flex-wrap"},qe={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Je=i(()=>e("label",{for:""},"Supir",-1)),ze={class:"card-border"},Ge={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Ke=i(()=>e("label",{for:""},"Kernet",-1)),We={class:"card-border"},Qe={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Xe=i(()=>e("label",{for:""},"No Pol",-1)),Ze={class:"card-border"},et={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},tt=i(()=>e("label",{for:""},"Tujuan",-1)),st={class:"card-border"},at={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},lt=i(()=>e("label",{for:""},"Note For Remarks",-1)),ot={class:"card-border"},it={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},nt=i(()=>e("label",{for:""},"Referensi",-1)),dt={class:"card-border"},rt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},_t={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},ct=i(()=>e("div",{class:"absolute bg-white -top-3"}," Cost Center ",-1)),vt={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},ut=i(()=>e("label",{for:""}," Code",-1)),pt={class:"card-border"},ft={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},mt=i(()=>e("label",{for:""},"Desc",-1)),wt={class:"card-border disabled"},xt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},ht={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},bt=i(()=>e("div",{class:"absolute bg-white -top-3"}," PVR ",-1)),yt={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},kt=i(()=>e("label",{for:""},"No",-1)),gt={class:"card-border disabled"},Dt={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Ct=i(()=>e("label",{for:""},"Total",-1)),St={class:"card-border disabled"},Nt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},It={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},Pt=i(()=>e("div",{class:"absolute bg-white -top-3"}," PV ",-1)),At={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},Yt=i(()=>e("label",{for:""},"No",-1)),$t={class:"card-border disabled"},Tt={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Bt=i(()=>e("label",{for:""},"Total",-1)),Ft={class:"card-border disabled"},Ut={class:"w-full flex grow p-1 overflow-auto 2xl:overflow-hidden justify-between flex-wrap"},Mt={class:"w-full",role:"sticky"},jt={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},Vt={class:"sticky -top-1 !z-[2]"},Et=["colspan"],Ot=i(()=>e("tr",{class:"sticky top-7 !z-[2]"},[e("th",{class:"!min-w-[50px] !w-[50px] !max-w-[50px]"},"No"),e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Tanggal"),e("th",{class:"!min-w-[200px] !w-[200px] !max-w-[200px]"},"Foto"),e("th",{class:"!min-w-[200px] !w-[200px] !max-w-[200px]"},"Note"),e("th",{class:"!min-w-[70px] !w-[70px] !max-w-[70px]"},"Dibayar")],-1)),Rt={ref:"to_move"},Ht=["data-index"],Lt={class:"cell"},qt={class:"w-full h-full flex items-center justify-center relative"},Jt={class:"cell"},zt={style:{width:"60vw"},class:"h-full flex items-center justify-center"},Gt={class:"cell"},Kt={class:"h-full flex items-center justify-center"},Wt={class:"w-full h-full flex items-center justify-center"},Qt={key:0,class:"text-3xl"},Xt=["onClick"],Zt={class:"w-full flex items-center justify-end"},es={class:"w-full flex flex-wrap p-3 items-center"},ts=i(()=>e("div",null," Di Validasi oleh : ",-1)),ss={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},as={key:0},ls={key:1},os={key:2},is={key:0,class:"text-xs font-bold"},ns={__name:"standby_trx_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},emits:["setID","setIndex"],setup(u,{emit:g}){const c=u,{$moment:D}=pe(),{pointFormat:T}=k(),O={id:-1,transition_target:"",transition_type:"",standby_mst_id:"",standby_mst_:{name:"",tipe:"",amount:0},supir:"",kernet:"",no_pol:"",xto:"",note_for_remarks:"",ref:"",cost_center_code:"",cost_center_desc:"",pvr_id:"",pvr_no:"",pvr_total:0,pvr_had_detail:0,pv_id:"",pv_no:"",pv_total:0,pv_datetime:"",rv_id:"",rv_no:"",rv_total:0,rv_had_detail:"",details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:""},s=h({...O}),R=ne("token"),H=h({}),L=h(null),C=h([]),q={_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:-1,name:"",title:""};let B=a=>{a.key=="ArrowUp"&&z(),a.key=="ArrowDown"&&J()};de(()=>{document.removeEventListener("keydown",B)});const w=h(JSON.parse(JSON.stringify(q))),x=h(JSON.parse(JSON.stringify(q))),b=h(""),F=async a=>{b.value="PROSES...",$().loading_full=!0,H.value={};const l=new FormData;let f=[...C.value];a=="paid"?f=f.map((p,P)=>(p.be_paid=1,p)):a=="nopaid"&&(f=f.map((p,P)=>(p.be_paid=0,p))),l.append("details",JSON.stringify(f));let n="post",S=c.id;S==0||(l.append("id",S),l.append("_method","PUT"));const{data:_,error:N,status:j}=await Z("/standby_trx_validasi",{method:n,headers:{Authorization:`Bearer ${R.value}`,Accept:"application/json"},body:l,retry:0});if($().loading_full=!1,j.value==="error"){b.value="GAGAL",X().trigger(N,H);return}s.value.val=_.value.val,s.value.val_user=_.value.val_user,s.value.val_by=_.value.val_by,s.value.val_at=_.value.val_at,s.value.val1=_.value.val1,s.value.val1_user=_.value.val1_user,s.value.val1_by=_.value.val1_by,s.value.val1_at=_.value.val1_at,s.value.val2=_.value.val2,s.value.val2_user=_.value.val2_user,s.value.val2_by=_.value.val2_by,s.value.val2_at=_.value.val2_at;let I=c.p_data.map(p=>p.id).indexOf(c.id);I>=-1&&c.p_data.splice(I,1,{...s.value}),b.value="BERHASIL"},U=async()=>{b.value="",$().loading_full=!0;const{data:a,error:l,status:f}=await Z("/standby_trx",{method:"get",headers:{Authorization:`Bearer ${R.value}`,Accept:"application/json"},params:{id:c.id},retry:0});if($().loading_full=!1,f.value==="error"){X().trigger(l);return}let n=a.value.data;s.value=n,w.value._.id.val=n.supir_id,w.value._.name.val=n.supir,w.value._.rek_no.val=n.supir_rek_no,w.value._.rek_name.val=n.supir_rek_name,w.value.id=n.supir_id,w.value.name=n.supir,w.value.rek_no=(n.supir_rek_no||"")+" "+(n.supir_rek_name||""),x.value._.id.val=n.kernet_id,x.value._.name.val=n.kernet,x.value._.rek_no.val=n.kernet_rek_no,x.value._.rek_name.val=n.kernet_rek_name,x.value.id=n.kernet_id,x.value.name=n.kernet,x.value.rek_no=(n.kernet_rek_no||"")+" "+(n.kernet_rek_name||""),C.value=a.value.data.details};K(()=>{let a=0;return C.value.forEach(l=>{l.p_status!="Remove"&&(a+=l.amount)}),a});const M=K(()=>s.value.val2==1);re(()=>c.show,(a,l)=>{a==!0?(document.addEventListener("keydown",B),s.value={...O},c.is_view==!1&&setTimeout(()=>{L.value.focus()},1),U()):document.removeEventListener("keydown",B)},{immediate:!0});const J=()=>{let a=c.p_data.map(l=>l.id).indexOf(c.id);a!=c.p_data.length-1&&(a++,g("setID",c.p_data[a].id),g("setIndex",a),setTimeout(()=>{U()},100))},z=()=>{let a=c.p_data.map(l=>l.id).indexOf(c.id);a!=0&&(a--,g("setID",c.p_data[a].id),g("setIndex",a),setTimeout(()=>{U()},100))};return(a,l)=>{var p,P,G;const f=ee,n=te,S=se,_=ae,N=le,j=oe,I=ie;return _e((d(),v("section",xe,[e("div",null,[y(f,{title:"Form Transaction Standby Validation",fn:u.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",he,[e("div",be,[e("div",ye,[e("div",ke,[e("div",ge,[De,e("div",Ce,[Se,e("div",Ne,o(t(s).standby_mst_id),1)]),e("div",Ie,[Pe,e("div",Ae,o((p=t(s).standby_mst_)==null?void 0:p.name),1)]),e("div",Ye,[$e,e("div",Te,o((P=t(s).standby_mst_)==null?void 0:P.tipe),1)]),e("div",Be,[Fe,e("div",Ue,o(t(T)((G=t(s).standby_mst_)==null?void 0:G.amount)),1)])])]),e("div",Me,[e("div",je,[Ve,e("div",Ee,[e("div",Oe,o(t(s).transition_type),1)]),e("div",Re,[e("div",He,o(t(s).transition_target),1)])])]),e("div",Le,[e("div",qe,[Je,e("div",ze,[y(n,{selected:t(w)},null,8,["selected"])])]),e("div",Ge,[Ke,e("div",We,[y(n,{selected:t(x)},null,8,["selected"])])]),e("div",Qe,[Xe,e("div",Ze,o(t(s).no_pol),1)]),e("div",et,[tt,e("div",st,o(t(s).xto),1)]),e("div",at,[lt,e("div",ot,o(t(s).note_for_remarks),1)]),e("div",it,[nt,e("div",dt,o(t(s).ref),1)])]),e("div",rt,[e("div",_t,[ct,e("div",vt,[ut,e("div",pt,o(t(s).cost_center_code),1)]),e("div",ft,[mt,e("div",wt,o(t(s).cost_center_desc),1)])])]),e("div",xt,[e("div",ht,[bt,e("div",yt,[kt,e("div",gt,o(t(s).pvr_no),1)]),e("div",Dt,[Ct,e("div",St,o(t(T)(t(s).pvr_total||0)),1)])])]),e("div",Nt,[e("div",It,[Pt,e("div",At,[Yt,e("div",$t,o(t(s).pv_no),1)]),e("div",Tt,[Bt,e("div",Ft,o(t(T)(t(s).pv_total)),1)])])]),e("div",Ut,[e("div",Mt,[e("table",jt,[e("thead",null,[e("tr",Vt,[e("td",{colspan:t(M)?5:6,class:"!bg-slate-800 text-white font-bold"}," Detail Transaction ",8,Et)]),Ot]),e("tbody",Rt,[(d(!0),v(W,null,ve(t(C),(r,V)=>(d(),v(W,{key:V},[r.p_status!="Remove"?(d(),v("tr",{key:0,"data-index":V},[e("td",null,o(V+1)+".",1),e("td",Lt,[e("div",qt,o(t(D)(r.tanggal).format("DD-MM-YYYY")),1)]),e("td",Jt,[e("div",zt,[y(S,{value:r.attachment_1_preview,onSetFile:A=>r.attachment_1=A,onSetPreview:A=>r.attachment_1_preview=A},null,8,["value","onSetFile","onSetPreview"])])]),e("td",Gt,[e("div",Kt,o(r.note),1)]),e("td",{class:Q(["cell",!("useUtils"in a?a.useUtils:t(k))().checkPermissions(["standby_trx.detail.decide_paid"])||t(M)||u.is_view?"unselectable":""])},[e("div",Wt,[!("useUtils"in a?a.useUtils:t(k))().checkPermissions(["standby_trx.detail.decide_paid"])||t(M)||u.is_view?(d(),v("div",Qt,[r.be_paid==0?(d(),Y(_,{key:0,class:"text-red-800"})):(d(),Y(N,{key:1,class:"text-green-800"}))])):(d(),v("button",{key:1,type:"button",onClick:A=>r.be_paid=r.be_paid?0:1,class:Q(["text-white w-auto rounded text-xl",r.be_paid?"bg-green-600":"bg-red-600"])},[r.be_paid==0?(d(),Y(_,{key:0})):(d(),Y(N,{key:1}))],10,Xt))])],2)],8,Ht)):m("",!0)],64))),128))],512)])])])])]),e("div",Zt,[e("div",es,[ts,t(s).val||t(s).val1||t(s).val2?(d(),v("div",ss,[t(s).val?(d(),v("div",as," App 1 : "+o(t(s).val_by.username)+" ( "+o(t(s).val_at?t(D)(t(s).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0),t(s).val1?(d(),v("div",ls," App 2 : "+o(t(s).val1_by.username)+" ( "+o(t(s).val1_at?t(D)(t(s).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0),t(s).val2?(d(),v("div",os," App 3 : "+o(t(s).val2_by.username)+" ( "+o(t(s).val2_at?t(D)(t(s).val2_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0)])):m("",!0)]),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:l[0]||(l[0]=r=>z())},[y(j,{class:"black"})]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:l[1]||(l[1]=r=>u.fnClose())}," Cancel "),u.is_view==0&&("useUtils"in a?a.useUtils:t(k))().checkPermissions(["standby_trx.detail.decide_paid"])&&t(s).val2=="0"?(d(),v("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-green-600 text-white text-xs rounded-sm",onClick:l[2]||(l[2]=E(r=>F("paid"),["prevent"]))}," Paid ")):m("",!0),u.is_view==0&&("useUtils"in a?a.useUtils:t(k))().checkPermissions(["standby_trx.detail.decide_paid"])&&t(s).val2=="0"?(d(),v("button",{key:1,type:"submit",name:"button",class:"w-36 m-1 bg-red-600 text-white text-xs rounded-sm",onClick:l[3]||(l[3]=E(r=>F("nopaid"),["prevent"]))}," NoPaid ")):m("",!0),u.is_view==0?(d(),v("button",{key:2,ref_key:"it_val",ref:L,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:l[4]||(l[4]=E(r=>F(),["prevent"]))},[ue(" Validasi "),t(b)!=""?(d(),v("div",is,o(t(b)),1)):m("",!0)],512)):m("",!0),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:l[5]||(l[5]=r=>J())},[y(I,{class:"black"})])])])])],512)),[[ce,u.show]])}}},bs=we(ns,[["__scopeId","data-v-b2cc913c"]]);export{bs as default};
