import{_ as A}from"./HeaderPopup.vue.232e2279.js";import{_ as B}from"./InputPointFormat.vue.b8bcbc23.js";import{r as _,g as S,f as q,k as v,J as F,o as N,c as P,a as e,b as w,l as s,t as x,A as D,C as V,x as c,y as g}from"./entry.aa3fda92.js";import{u as h}from"./useMyFetch.9afcdb0b.js";import"./Times.29115eb5.js";import"./_plugin-vue_export-helper.c27b6911.js";const j={class:"box-fixed"},M={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},T={class:"w-full flex flex-col items-center grow overflow-auto"},z={class:"w-full flex flex-row flex-wrap"},E={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},I=e("label",{for:""},"Nominal Potong",-1),R={class:"w-full"},U={class:"text-red-500"},H={class:"w-full flex flex-col flex-wrap p-1"},J=e("label",{for:""},"Keterangan",-1),K={class:"text-red-500"},O={class:"w-full flex items-center justify-end"},Z={__name:"trx",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},potongan_mst_id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},emits:["updateRemainingCut"],setup(d,{emit:y}){const a=d,f={id:-1,note:"",nominal_cut:""},t=_({...f}),p=S("token"),u=_({}),b=async()=>{c().loading_full=!0,u.value={};const l=new FormData;l.append("potongan_mst_id",a.potongan_mst_id),l.append("note",t.value.note),l.append("nominal_cut",t.value.nominal_cut);let o="post",i=a.id;i==0||(l.append("id",i),l.append("_method","PUT"));const{data:r,error:n,status:k}=await h("/potongan_trx",{method:o,headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},body:l,retry:0});if(c().loading_full=!1,k.value==="error"){g().trigger(n,u);return}if(t.value.updated_at=r.value.updated_at,a.id<=0)t.value.id=r.value.id,t.value.created_at=r.value.created_at,a.p_data.unshift(t.value);else{let m=a.p_data.map($=>$.id).indexOf(a.id);m>=-1&&a.p_data.splice(m,1,{...t.value})}y("updateRemainingCut",r.value.remaining_cut),a.fnClose()},C=async()=>{c().loading_full=!0;const{data:l,error:o,status:i}=await h("/potongan_trx",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:{id:a.id},retry:0});if(c().loading_full=!1,i.value==="error"){g().trigger(o);return}t.value=l.value.data};return q(()=>a.show,(l,o)=>{l==!0&&(t.value={...f},u.value={},a.id!=0&&C())},{immediate:!0}),(l,o)=>{const i=A,r=B;return v((N(),P("section",j,[e("div",null,[w(i,{title:"Form Potongan Trx",fn:d.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",M,[e("div",T,[e("div",z,[e("div",E,[I,e("div",R,[w(r,{class:"w-full h-full",type:"text",value:s(t).nominal_cut||0,onInput:o[0]||(o[0]=n=>s(t).nominal_cut=n),show:d.show,disabled:s(t).trx_trp_id},null,8,["value","show","disabled"])]),e("p",U,x(s(u).ref),1)]),e("div",H,[J,v(e("textarea",{"onUpdate:modelValue":o[1]||(o[1]=n=>s(t).note=n),rows:"10"}," ",512),[[D,s(t).note]]),e("p",K,x(s(u).note),1)])])]),e("div",O,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:o[2]||(o[2]=n=>d.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:o[3]||(o[3]=V(n=>b(),["prevent"]))}," Save ")])])])],512)),[[F,d.show]])}}};export{Z as default};
