import{_ as $}from"./HeaderPopup.vue.48611918.js";import{r as x,h as j,K as B,I,n as f,v as L,o as b,c as g,a as e,b as N,m as l,q as C,t as _,C as V,E as z,F as q,D as T,_ as E,s as O,x as v,y as k,p as H,e as J,L as K}from"./entry.1cedbe8d.js";import"./useUtils.11657bdd.js";import{u as y}from"./useMyFetch.82b8d51f.js";import{_ as G}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.068b4b36.js";const u=r=>(H("data-v-870b7af8"),r=r(),J(),r),Q={class:"box-fixed"},R={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},W={class:"w-full flex flex-col items-center grow overflow-auto"},X={class:"w-full flex flex-row flex-wrap"},Y={class:"w-full flex flex-col flex-wrap p-1"},Z=u(()=>e("label",{for:""},"Username",-1)),ee={class:"text-red-500"},te={class:"w-full flex flex-col flex-wrap p-1"},ae=u(()=>e("label",{for:""},"Password",-1)),se={class:"text-red-500"},oe={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},le=u(()=>e("label",{for:""},"Hak Akses",-1)),ne=K('<option value="PabrikTransport" data-v-870b7af8>Pabrik Transport</option><option value="PabrikMandor" data-v-870b7af8>Pabrik Mandor</option><option value="Logistic" data-v-870b7af8>Logisitic</option><option value="Finance" data-v-870b7af8>Finance</option><option value="Marketing" data-v-870b7af8>Marketing</option><option value="Accounting" data-v-870b7af8>Accounting</option><option value="MIS" data-v-870b7af8>MIS</option><option value="ViewOnly" data-v-870b7af8>ViewOnly</option><option value="SuperAdmin" data-v-870b7af8>SuperAdmin</option>',9),ie=[ne],re={class:"text-red-500"},de={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ue=u(()=>e("label",{for:""},"Status",-1)),ce=u(()=>e("option",{value:"1"},"Aktif",-1)),pe=u(()=>e("option",{value:"0"},"Nonaktif",-1)),fe=[ce,pe],_e={class:"text-red-500"},ve={class:"w-full flex flex-col sm:flex-row grow p-1 justify-between flex-wrap 2xl:overflow-hidden"},me={class:"w-full max-w-full p-0 2xl:pr-1 2xl:max-h-full 2xl:overflow-auto"},he={class:"w-full",role:"sticky"},we={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},xe=u(()=>e("tr",{class:"sticky -top-1 !z-[2]"},[e("td",{colspan:"2",class:"!bg-slate-800 text-white font-bold"}," Detail Permission List ")],-1)),be={class:"sticky top-7 !z-[2]"},ge={class:"min-w-[20px] !w-[20px] max-w-[20px]"},ke=u(()=>e("th",null,"Name",-1)),ye={ref:"to_move"},Se={class:"!w-[10px]"},Ae={class:"w-full h-full flex items-center justify-center"},Ce=["onUpdate:modelValue"],Ve={class:"w-full h-full flex items-center justify-start"},Me={class:"w-full flex items-center justify-end"},Pe={__name:"user",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},setup(r){const i=r,S={id:-1,username:"",password:"",hak_akses:"PabrikTransport",is_active:1},s=x({...S}),w=j("token"),c=x({}),M=async()=>{v().loading_full=!0,c.value={};const o=new FormData;o.append("username",s.value.username),s.value.password&&o.append("password",s.value.password),o.append("hak_akses",s.value.hak_akses),o.append("is_active",s.value.is_active),o.append("permission_list",JSON.stringify(m.value));let t="post",d=i.id;d==0||(o.append("id",d),o.append("_method","PUT"));const{data:a,error:h,status:p}=await y("/user",{method:t,headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},body:o,retry:0});if(v().loading_full=!1,p.value==="error"){k().trigger(h,c);return}if(i.id<=0)s.value.id=a.value.id,s.value.created_at=a.value.created_at,s.value.updated_at=a.value.updated_at,i.p_data.unshift(s.value);else{s.value.updated_at=a.value.updated_at;let A=i.p_data.map(F=>F.id).indexOf(i.id);A>=-1&&i.p_data.splice(A,1,{...s.value})}i.fnClose()},P=async()=>{v().loading_full=!0;const{data:o,error:t,status:d}=await y("/user",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:{id:i.id},retry:0});if(v().loading_full=!1,d.value==="error"){k().trigger(t);return}s.value=o.value.data,o.value.data.details.forEach((a,h)=>{n.value=n.value.map(p=>(p.name==a.permission_list_name&&(p.checked=!0),p))})},n=x([]),U=async()=>{v().loading_full=!0;const{data:o,error:t,status:d}=await y("/permission_lists",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:{sort:"name:asc"},retry:0});if(v().loading_full=!1,d.value==="error"){k().trigger(t);return}n.value=o.value.data.map(a=>(a.checked=!1,a))},m=B(o=>n.value.filter(t=>t.checked)),D=o=>{m.value.length!=n.value.length?n.value=n.value.map(t=>(t.checked=!0,t)):n.value=n.value.map(t=>(t.checked=!1,t))};return I(()=>i.show,async(o,t)=>{o==!0&&(s.value={...S},n.value=[],await U(),c.value={},i.id!=0&&await P())},{immediate:!0}),(o,t)=>{const d=$;return f((b(),g("section",Q,[e("div",null,[N(d,{title:"Form User",fn:r.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",R,[e("div",W,[e("div",X,[e("div",Y,[Z,f(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>l(s).username=a)},null,512),[[C,l(s).username]]),e("p",ee,_(l(c).username),1)]),e("div",te,[ae,f(e("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=a=>l(s).password=a)},null,512),[[C,l(s).password]]),e("p",se,_(l(c).password),1)]),e("div",oe,[le,f(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>l(s).hak_akses=a)},ie,512),[[V,l(s).hak_akses]]),e("p",re,_(l(c).hak_akses),1)]),e("div",de,[ue,f(e("select",{"onUpdate:modelValue":t[3]||(t[3]=a=>l(s).is_active=a)},fe,512),[[V,l(s).is_active]]),e("p",_e,_(l(c).is_active),1)])]),e("div",ve,[e("div",me,[e("div",he,[e("table",we,[e("thead",null,[xe,e("tr",be,[e("th",ge,[e("button",{type:"button",name:"button",class:z(["text-xs",l(m).length!=l(n).length?"bg-green-500":"bg-red-500"]),onClick:t[4]||(t[4]=a=>D())},_(l(m).length!=l(n).length?"Allow":"Deny"),3)]),ke])]),e("tbody",ye,[(b(!0),g(q,null,T(l(n),(a,h)=>(b(),g("tr",{key:h},[e("td",Se,[e("div",Ae,[f(e("input",{type:"checkbox","onUpdate:modelValue":p=>a.checked=p,class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:bg-gray-700 dark:border-gray-600 cursor-pointer"},null,8,Ce),[[E,a.checked]])])]),e("td",null,[e("div",Ve,_(a.name),1)])]))),128))],512)])])])])]),e("div",Me,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:t[5]||(t[5]=a=>r.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:t[6]||(t[6]=O(a=>M(),["prevent"]))}," Save ")])])])],512)),[[L,r.show]])}}},Ie=G(Pe,[["__scopeId","data-v-870b7af8"]]);export{Ie as default};
