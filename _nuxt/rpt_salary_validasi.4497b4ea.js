import{_ as I}from"./HeaderPopup.vue.f106b55c.js";import{r as b,f as P,G as c,j as z,m as U,J as G,o as m,c as v,a as t,b as J,t as l,k as e,d,F as C,y as H,l as y,x as K,E as L,A as x,B as A,p as R,e as O}from"./entry.3e021263.js";import{u as Q}from"./useUtils.2a3dce74.js";import{u as T}from"./useMyFetch.1f7b438a.js";import{_ as W}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.c99f77ef.js";const _=i=>(R("data-v-a557b614"),i=i(),O(),i),X={class:"box-fixed"},Z={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},tt={class:"w-full flex flex-col items-center grow overflow-auto"},et={class:"w-full flex flex-row flex-wrap"},at={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},st=_(()=>t("label",{for:""},"Period End",-1)),lt={class:"card-border"},ot={key:0,class:"w-full flex p-1 justify-between flex-wrap"},nt={class:"w-full",role:"sticky"},rt={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},_t=_(()=>t("tr",{class:"sticky -top-1 !z-[2]"},[t("td",{colspan:"19",class:"!bg-slate-800 text-white font-bold"}," Detail ")],-1)),ut={class:"sticky top-7 !z-[2]"},it=_(()=>t("th",{rowspan:"2"},"No",-1)),ct=_(()=>t("th",{rowspan:"2"},"ID",-1)),dt=_(()=>t("th",{rowspan:"2"},"Nama Pekerja",-1)),pt=_(()=>t("th",{rowspan:"2"},"Jabatan",-1)),mt=_(()=>t("th",{rowspan:"2"},"Tmpt Lahir",-1)),vt=_(()=>t("th",{rowspan:"2"},"Tgl Lahir",-1)),ht=_(()=>t("th",{rowspan:"2"},"TMK",-1)),ft=_(()=>t("th",{rowspan:"2"},"No KTP",-1)),yt=_(()=>t("th",{rowspan:"2"},"Alamat",-1)),wt=_(()=>t("th",{rowspan:"2"},"Status",-1)),bt=_(()=>t("th",{rowspan:"2"},"No Rek",-1)),xt=_(()=>t("th",{rowspan:"2"},"Nama Bank",-1)),kt={colspan:"2"},gt={class:"text-sm"},jt={colspan:"2"},Ft={class:"text-sm"},Mt={rowspan:"2"},St={class:"text-sm"},Dt={rowspan:"2"},Et={class:"text-sm"},Bt={rowspan:"2"},Nt={class:"text-sm"},Ct={class:"sticky top-[60px] !z-[2]"},At={class:"text-sm"},Tt={class:"text-sm"},Vt={class:"text-sm"},Yt={class:"text-sm"},$t={ref:"to_move"},qt=["data-index"],It={class:"w-full flex items-center justify-end"},Pt={class:"w-full flex flex-wrap p-3 items-center"},zt=_(()=>t("div",null," Di Validasi oleh : ",-1)),Ut={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},Gt={key:0},Jt={__name:"rpt_salary_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(i){const p=i,{$moment:w}=L(),{pointFormat:r}=Q(),n=b({...{id:-1,name:"",tipe:"",is_transition:!1,amount:0,details:[],val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:"",val3:0,val3_by:{username:""},val3_at:""}}),M=P("token"),S=b({}),D=b(null),u=b([]),V=async()=>{x().loading_full=!0,S.value={};const s=new FormData;let o="post",h=p.id;h==0||(s.append("id",h),s.append("_method","PUT"));const{data:a,error:f,status:$}=await T("/rpt_salary_validasi",{method:o,headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},body:s,retry:0});if(x().loading_full=!1,$.value==="error"){A().trigger(f,S);return}n.value.val1=a.value.val1,n.value.val1_user=a.value.val1_user,n.value.val1_by=a.value.val1_by,n.value.val1_at=a.value.val1_at,n.value.val2=a.value.val2,n.value.val2_user=a.value.val2_user,n.value.val2_by=a.value.val2_by,n.value.val2_at=a.value.val2_at,n.value.val3=a.value.val3,n.value.val3_user=a.value.val3_user,n.value.val3_by=a.value.val3_by,n.value.val3_at=a.value.val3_at;let N=p.p_data.map(q=>q.id).indexOf(p.id);N>=-1&&p.p_data.splice(N,1,{...n.value}),p.fnClose()};c(()=>{let s=0;return u.value.forEach(o=>{s+=parseFloat(o.standby_nominal)}),s});const k=c(()=>{let s=0;return u.value.forEach(o=>{s+=parseFloat(o.sb_gaji)}),s}),g=c(()=>{let s=0;return u.value.forEach(o=>{s+=parseFloat(o.sb_makan)}),s}),j=c(()=>{let s=0;return u.value.forEach(o=>{s+=parseFloat(o.uj_gaji)}),s}),F=c(()=>{let s=0;return u.value.forEach(o=>{s+=parseFloat(o.uj_makan)}),s}),E=c(()=>{let s=0;return u.value.forEach(o=>{s+=parseFloat(o.nominal_cut)}),s}),B=c(()=>{let s=0;return u.value.forEach(o=>{s+=parseFloat(o.salary_bonus_nominal)}),s}),Y=async()=>{x().loading_full=!0;const{data:s,error:o,status:h}=await T("/rpt_salary",{method:"get",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},params:{id:p.id},retry:0});if(x().loading_full=!1,h.value==="error"){A().trigger(o);return}n.value=s.value.data,u.value=s.value.data.details};return c(()=>{let s=0;return u.value.forEach(o=>{o.p_status!="Remove"&&(s+=parseInt(o.amount))}),s}),c(()=>!1),z(()=>p.show,(s,o)=>{s==!0&&(p.is_view==!1&&setTimeout(()=>{D.value.focus()},1),Y())},{immediate:!0}),(s,o)=>{const h=I;return U((m(),v("section",X,[t("div",null,[J(h,{title:"Form Master Standby Validation",fn:i.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",Z,[t("div",tt,[t("div",et,[t("div",at,[st,t("div",lt,l(e(w)(e(n).period_end).format("MM-Y")),1)])]),e(u).length?(m(),v("div",ot,[t("div",nt,[t("table",rt,[t("thead",null,[_t,t("tr",ut,[it,ct,dt,pt,mt,vt,ht,ft,yt,wt,bt,xt,t("th",kt,[d("Standby "),t("span",gt,"("+l(e(r)(e(k)+e(g)||0))+")",1)]),t("th",jt,[d("Trip "),t("span",Ft,"("+l(e(r)(e(j)+e(F)||0))+")",1)]),t("th",Mt,[d("Potongan "),t("span",St,"("+l(e(r)(e(E)||0))+")",1)]),t("th",Dt,[d("U.Kerajinan "),t("span",Et,"("+l(e(r)(e(B)||0))+")",1)]),t("th",Bt,[d("Grand Total "),t("span",Nt,"("+l(e(r)(e(k)+e(g)+e(j)+e(F)-e(E)+e(B)||0))+")",1)])]),t("tr",Ct,[t("th",null,[d("SB.Gaji "),t("span",At,"("+l(e(r)(e(k)||0))+")",1)]),t("th",null,[d("SB.Makan "),t("span",Tt,"("+l(e(r)(e(g)||0))+")",1)]),t("th",null,[d("UJ.Gaji "),t("span",Vt,"("+l(e(r)(e(j)||0))+")",1)]),t("th",null,[d("UJ.Makan "),t("span",Yt,"("+l(e(r)(e(F)||0))+")",1)])])]),t("tbody",$t,[(m(!0),v(C,null,H(e(u),(a,f)=>(m(),v(C,{key:f},[a.p_status!="Remove"?(m(),v("tr",{key:0,"data-index":f},[t("td",null,l(f+1)+".",1),t("td",null,l(a.employee_id),1),t("td",null,l(a.employee_name),1),t("td",null,l(a.employee_role),1),t("td",null,l(a.employee_birth_place),1),t("td",null,l(a.employee_birth_date?e(w)(a.employee_birth_date).format("DD-MM-Y"):""),1),t("td",null,l(a.employee_tmk?e(w)(a.employee_tmk).format("DD-MM-Y"):""),1),t("td",null,l(a.employee_ktp_no),1),t("td",null,l(a.employee_address),1),t("td",null,l(a.employee_status),1),t("td",null,l(a.employee_rek_no),1),t("td",null,l(a.employee_bank_name),1),t("td",null,l(e(r)(a.sb_gaji)),1),t("td",null,l(e(r)(a.sb_makan)),1),t("td",null,l(e(r)(a.uj_gaji)),1),t("td",null,l(e(r)(a.uj_makan)),1),t("td",null,l(e(r)(a.nominal_cut)),1),t("td",null,l(e(r)(a.salary_bonus_nominal)),1),t("td",null,l(e(r)(parseFloat(a.sb_gaji)+parseFloat(a.sb_makan)+parseFloat(a.uj_gaji)+parseFloat(a.uj_makan)-parseFloat(a.nominal_cut)+parseFloat(a.salary_bonus_nominal))),1)],8,qt)):y("",!0)],64))),128))],512)])])])):y("",!0)]),t("div",It,[t("div",Pt,[zt,e(n).val1||e(n).val2||e(n).val3?(m(),v("div",Ut,[e(n).val1?(m(),v("div",Gt," App 1 : "+l(e(n).val1_by.username)+" ( "+l(e(n).val1_at?e(w)(e(n).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):y("",!0)])):y("",!0)]),t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:o[0]||(o[0]=a=>i.fnClose())}," Cancel "),i.is_view==0?(m(),v("button",{key:0,ref_key:"it_val",ref:D,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:o[1]||(o[1]=K(a=>V(),["prevent"]))}," Validasi ",512)):y("",!0)])])])],512)),[[G,i.show]])}}},Xt=W(Jt,[["__scopeId","data-v-a557b614"]]);export{Xt as default};
