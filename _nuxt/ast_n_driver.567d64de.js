import{r as d,g as L,h as R,f as C,J as Z,c as q,a as t,b as n,k as $,v as O,l,m as P,w as Y,t as z,D as B,F as G,q as K,o as Q,B as W,p as X,e as ee,x as p,y as S,_ as te,H as oe}from"./entry.30591992.js";import le from"./Header.a456576d.js";import{_ as se}from"./client-only.24bd1401.js";import{_ as ae}from"./SelectMulti.vue.605add34.js";import ne from"./PrinterEye.4b6f076c.js";import ie from"./Table2Column.955349d8.js";import{u as V}from"./useMyFetch.900eab1f.js";import{u as re}from"./useDownload.174f4da2.js";import{_ as de}from"./_plugin-vue_export-helper.c27b6911.js";import"./Check.734c53c0.js";import"./Times.e0d40810.js";const _e=W(()=>te(()=>import("./PDFView.e202ff94.js"),["./PDFView.e202ff94.js","./Times.e0d40810.js","./_plugin-vue_export-helper.c27b6911.js","./entry.30591992.js","./entry.c5f8f180.css","./useDownload.174f4da2.js"],import.meta.url).then(u=>u.default||u)),s=u=>(X("data-v-f98146d9"),u=u(),ee(),u),ce={class:"w-full h-full flex flex-col"},ue={class:"w-full flex grow flex-col overflow-auto h-0 bg-gray-200 justify-center items-center p-2"},fe={class:"bg-white p-2 max-w-[350px] max-h-full overflow-auto"},pe={action:"#",class:"w-full flex flex-col sm:flex-row flex-wrap text-xs"},me={class:"w-full p-1 flex flex-col"},ve=s(()=>t("div",{class:"font-bold"}," Tipe ",-1)),he=s(()=>t("option",{value:"header"},"Header",-1)),xe=s(()=>t("option",{value:"detail"},"Detail",-1)),ye=[he,xe],we={class:"w-full p-1 flex flex-col"},ge=s(()=>t("div",{class:"font-bold"}," Jenis ",-1)),be=s(()=>t("option",{value:""},null,-1)),ke=s(()=>t("option",{value:"UJ"},"Uang Jalan",-1)),De=s(()=>t("option",{value:"SB"},"Uang Standby",-1)),Ce=[be,ke,De],Se={class:"w-full sm:w-1/2 p-1 flex flex-col"},Ve=s(()=>t("div",{class:"font-bold"}," Tgl Dari ",-1)),Ae={class:"text-red-500"},Me={class:"w-full sm:w-1/2 p-1 flex flex-col"},je=s(()=>t("div",{class:"font-bold"}," Tgl Sampai ",-1)),Ee={class:"text-red-500"},Te={class:"w-full p-1 flex flex-col"},$e=s(()=>t("div",{class:"font-bold"}," Lokasi ",-1)),Oe={class:"w-full p-1 flex flex-col"},Pe=s(()=>t("div",{class:"font-bold"}," Nama ",-1)),Ye={class:"w-full p-1 flex flex-col"},ze=s(()=>t("div",{class:"font-bold"}," No Pol ",-1)),Be={class:"w-full p-1 flex items-end justify-end"},Ne=s(()=>t("div",{class:"text-left m-1"},"Download PDF",-1)),Fe=s(()=>t("div",{class:"text-left m-1"},"Download Excel",-1)),Ie={__name:"ast_n_driver",async setup(u){let m,A;const{$moment:M}=oe(),a={};a._TimeZoneOffset=new Date().getTimezoneOffset(),a.sort="tanggal:desc";const j=d({}),x=L("token"),_=d({from:"",to:""}),{data:y}=([m,A]=R(async()=>K(async()=>{p().loading_full=!0;let e=[],o=[],c=[];const[r,k]=await Promise.all([V("/report/ast_n_driver/load_data",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},retry:0})]);return r.status.value!=="error"&&(e=r.data.value.list_xto,c=r.data.value.list_employee,o=r.data.value.list_vehicle),r.status.value==="error"&&S().trigger(r.error),p().loading_full=!1,{list_xto:e,list_employee:c,list_vehicle:o}},{lazy:!0,server:!1,default:()=>({list_xto:[],list_employee:[],list_vehicle:[]})},"$Aw9scsfjYZ")),m=await m,A(),m),w=d([]),g=d([]),b=d([]);C(()=>{var e;return(e=y.value)==null?void 0:e.list_xto},e=>{e&&e.forEach(o=>{w.value.push({id:o,name:o,title:"",checked:!1})})},{immediate:!0}),C(()=>{var e;return(e=y.value)==null?void 0:e.list_employee},e=>{e&&e.forEach(o=>{g.value.push({id:o.id,name:o.name,title:o.role,checked:!1})})},{immediate:!0}),C(()=>{var e;return(e=y.value)==null?void 0:e.list_vehicle},e=>{e&&e.forEach(o=>{b.value.push({id:o.id,name:o.no_pol,title:"",checked:!1})})},{immediate:!0});const v=d("header"),h=d(""),E=()=>{a._TimeZoneOffset=new Date().getTimezoneOffset(),a.date_from=_.value.from?M(_.value.from).format("YYYY-MM-DD"):"",a.date_to=_.value.to?M(_.value.to).format("YYYY-MM-DD"):"",a.list_xto=JSON.stringify(w.value.filter(e=>e.checked).map(e=>e.id)),a.list_employee=JSON.stringify(g.value.filter(e=>e.checked).map(e=>e.id)),a.list_vehicle=JSON.stringify(b.value.filter(e=>e.checked).map(e=>e.id)),a.type=v.value,a.jenis=h.value},{downloadFile:N,viewFile:Je}=re(),f=d(!1),T=d({}),F=async()=>{if(f.value==!0){f.value=!1;return}E(),p().loading_full=!0;const{data:e,error:o,status:c}=await V("/report/ast_n_driver/pdf_preview",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:a,retry:0});if(p().loading_full=!1,c.value==="error"){S().trigger(o);return}T.value=e.value,f.value=!0},I=async()=>{E(),p().loading_full=!0;const{data:e,error:o,status:c}=await V("/report/ast_n_driver/excel_download",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:a,retry:0});if(p().loading_full=!1,c.value==="error"){S().trigger(o);return}N(e.value)};return(e,o)=>{const c=le,r=Z("vue-date-picker"),k=se,D=ae,J=ne,U=ie,H=_e;return Q(),q(G,null,[t("div",ce,[n(c,{title:"Report Transaction"}),t("div",ue,[t("div",fe,[t("form",pe,[t("div",me,[ve,$(t("select",{"onUpdate:modelValue":o[0]||(o[0]=i=>P(v)?v.value=i:null)},ye,512),[[O,l(v)]])]),t("div",we,[ge,$(t("select",{"onUpdate:modelValue":o[1]||(o[1]=i=>P(h)?h.value=i:null)},Ce,512),[[O,l(h)]])]),t("div",Se,[Ve,n(k,null,{default:Y(()=>[n(r,{modelValue:l(_).from,"onUpdate:modelValue":o[2]||(o[2]=i=>l(_).from=i),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1}),t("p",Ae,z(l(j).date_from),1)]),t("div",Me,[je,n(k,null,{default:Y(()=>[n(r,{modelValue:l(_).to,"onUpdate:modelValue":o[3]||(o[3]=i=>l(_).to=i),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1}),t("p",Ee,z(l(j).date_to),1)]),t("div",Te,[$e,n(D,{arr:l(w)},null,8,["arr"])]),t("div",Oe,[Pe,n(D,{arr:l(g)},null,8,["arr"])]),t("div",Ye,[ze,n(D,{arr:l(b)},null,8,["arr"])]),t("div",Be,[t("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:o[4]||(o[4]=B(i=>F(),["prevent"]))},[t("div",null,[n(J,{class:"text-2xl"})]),Ne]),t("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:o[5]||(o[5]=B(i=>I(),["prevent"]))},[t("div",null,[n(U,{class:"text-2xl"})]),Fe])])])])])]),n(H,{show:l(f),pdfContent:l(T),onClose:o[6]||(o[6]=i=>f.value=!l(f))},null,8,["show","pdfContent"])],64)}}},et=de(Ie,[["__scopeId","data-v-f98146d9"]]);export{et as default};
