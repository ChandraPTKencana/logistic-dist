import{r as c,g as S,h as I,f as L,J as N,c as v,a as t,b as r,w as T,t as w,l,k as R,A as U,m as H,F as $,E as Z,D as j,q,o as x,B as G,x as d,y,_ as J,H as Q}from"./entry.1c0851d0.js";import X from"./Header.ecfa140d.js";import{_ as K}from"./client-only.cc67c48b.js";import W from"./PrinterEye.ac25c55a.js";import ee from"./Table2Column.6028670f.js";import{u as g}from"./useMyFetch.a0f05346.js";import{u as te}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";const oe=G(()=>J(()=>import("./PDFView.85338453.js"),["./PDFView.85338453.js","./Times.7e4b2673.js","./_plugin-vue_export-helper.c27b6911.js","./entry.1c0851d0.js","./entry.64cfce5b.css","./useDownload.174f4da2.js"],import.meta.url).then(_=>_.default||_)),se={class:"w-full h-full flex flex-col"},le={class:"w-full flex grow flex-col overflow-auto h-0 bg-gray-200 justify-center items-center p-2"},ae={class:"bg-white p-2"},ne={action:"#",class:"w-full flex flex-col sm:flex-row flex-wrap text-xs"},re={class:"w-full p-1 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col"},ie=t("div",{class:"font-bold"}," Tgl Dari ",-1),ue={class:"text-red-500"},ce={class:"w-full p-1 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col"},de=t("div",{class:"font-bold"}," Tgl Sampai ",-1),me={class:"text-red-500"},fe={class:"w-full p-1 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col"},_e=t("div",{class:"font-bold"}," Lokasi ",-1),pe={id:"locations"},ve=["value"],we={class:"w-full p-1 sm:w-12/12 md:w-12/12 lg:w-3/12 flex items-end justify-end"},xe=t("div",{class:"text-left m-1"},"Download PDF",-1),ye=t("div",{class:"text-left m-1"},"Download Excel",-1),Te={__name:"ramp",async setup(_){let m,h;const{$moment:D}=Q(),a={};a._TimeZoneOffset=new Date().getTimezoneOffset(),a.sort="tanggal:desc";const b=c({}),p=S("token"),n=c({from:"",to:""}),{data:z}=([m,h]=I(async()=>q(async()=>{d().loading_full=!0;let o=[];const[e,u]=await Promise.all([g("/report/ramp/get_locations",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},retry:0})]);return e.status.value!=="error"&&(o=e.data.value.list_xto),e.status.value==="error"?(y().trigger(e.error),{locations:o}):(d().loading_full=!1,{locations:o})},{lazy:!0,server:!1,default:()=>({locations:[]})},"$SQhImG8ywX")),m=await m,h(),m),C=c([]);L(()=>{var o;return(o=z.value)==null?void 0:o.locations},o=>{o&&(C.value=[...o])},{immediate:!0});const f=c(""),k=()=>{a._TimeZoneOffset=new Date().getTimezoneOffset(),a.date_from=n.value.from?D(n.value.from).format("YYYY-MM-DD"):"",a.date_to=n.value.to?D(n.value.to).format("YYYY-MM-DD"):"",a.location=f.value},{downloadFile:E,viewFile:ge}=te(),i=c(!1),A=c({}),P=async()=>{if(i.value==!0){i.value=!1;return}k(),d().loading_full=!0;const{data:o,error:e,status:u}=await g("/report/ramp/pdf_preview",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:a,retry:0});if(d().loading_full=!1,u.value==="error"){y().trigger(e);return}A.value=o.value,i.value=!0},Y=async()=>{k(),d().loading_full=!0;const{data:o,error:e,status:u}=await g("/report/ramp/excel_download",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:a,retry:0});if(d().loading_full=!1,u.value==="error"){y().trigger(e);return}E(o.value)};return(o,e)=>{const u=X,V=N("vue-date-picker"),M=K,B=W,F=ee,O=oe;return x(),v($,null,[t("div",se,[r(u,{title:"Report Transaction"}),t("div",le,[t("div",ae,[t("form",ne,[t("div",re,[ie,r(M,null,{default:T(()=>[r(V,{modelValue:l(n).from,"onUpdate:modelValue":e[0]||(e[0]=s=>l(n).from=s),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"",class:"flex-grow"},null,8,["modelValue"])]),_:1}),t("p",ue,w(l(b).date_from),1)]),t("div",ce,[de,r(M,null,{default:T(()=>[r(V,{modelValue:l(n).to,"onUpdate:modelValue":e[1]||(e[1]=s=>l(n).to=s),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"",class:"flex-grow"},null,8,["modelValue"])]),_:1}),t("p",me,w(l(b).date_to),1)]),t("div",fe,[_e,R(t("input",{type:"text",list:"locations","onUpdate:modelValue":e[2]||(e[2]=s=>H(f)?f.value=s:null)},null,512),[[U,l(f)]]),t("datalist",pe,[(x(!0),v($,null,Z(l(C),s=>(x(),v("option",{value:s},w(s),9,ve))),256))])]),t("div",we,[t("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:e[3]||(e[3]=j(s=>P(),["prevent"]))},[t("div",null,[r(B,{class:"text-2xl"})]),xe]),t("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:e[4]||(e[4]=j(s=>Y(),["prevent"]))},[t("div",null,[r(F,{class:"text-2xl"})]),ye])])])])])]),r(O,{show:l(i),pdfContent:l(A),onClose:e[5]||(e[5]=s=>i.value=!l(i))},null,8,["show","pdfContent"])],64)}}};export{Te as default};
