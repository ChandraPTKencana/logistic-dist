import{_ as H}from"./HeaderPopup.vue.84d65bd6.js";import{r as w,g as O,i,f as Q,k as I,J as W,o as d,c as m,a as t,b as X,t as o,l as a,m as Z,A as tt,n as f,d as r,F as L,D as at,C as st,G as et,x as F,y as z,p as ot,e as lt}from"./entry.fa6a43a6.js";import{u as nt}from"./useUtils.e43caca5.js";import{u as G}from"./useMyFetch.e44aed2a.js";import{_ as _t}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.abdf3177.js";const c=p=>(ot("data-v-a0d0a814"),p=p(),lt(),p),rt={class:"box-fixed"},ut={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},it={class:"w-full flex flex-col items-center grow overflow-auto"},ct={class:"w-full flex flex-row flex-wrap"},pt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},dt=c(()=>t("label",{for:""},"Period End",-1)),mt={class:"card-border"},ht={key:0,class:"w-full sm:w-6/12 md:w-4/12 lg:w-4/12 p-1"},vt=c(()=>t("div",{class:"font-bold"}," Filter Nama ",-1)),ft={key:0,class:"w-full flex p-1 justify-between flex-wrap"},bt={class:"w-full",role:"sticky"},yt={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},wt=c(()=>t("tr",{class:"sticky -top-1 !z-[2]"},[t("td",{colspan:"28",class:"!bg-slate-800 text-white font-bold"}," Detail ")],-1)),xt={class:"sticky top-7 !z-[2]"},kt=c(()=>t("th",{rowspan:"2"},"No",-1)),jt=c(()=>t("th",{rowspan:"2"},"ID",-1)),gt=c(()=>t("th",{rowspan:"2"},"Nama Pekerja",-1)),Ft=c(()=>t("th",{rowspan:"2"},"Jabatan",-1)),Dt=c(()=>t("th",{rowspan:"2"},"Tmpt Lahir",-1)),Et=c(()=>t("th",{rowspan:"2"},"Tgl Lahir",-1)),Mt=c(()=>t("th",{rowspan:"2"},"TMK",-1)),St=c(()=>t("th",{rowspan:"2"},"No KTP",-1)),Ct=c(()=>t("th",{rowspan:"2"},"Alamat",-1)),Nt=c(()=>t("th",{rowspan:"2"},"Status",-1)),Tt=c(()=>t("th",{rowspan:"2"},"No Rek",-1)),Bt=c(()=>t("th",{rowspan:"2"},"Nama Bank",-1)),Pt={colspan:"3"},At={class:"text-sm"},Vt={colspan:"3"},Yt={class:"text-sm"},$t={colspan:"3"},qt={class:"text-sm"},It={rowspan:"2"},Lt={class:"text-sm"},zt={rowspan:"2"},Gt={class:"text-sm"},Jt={rowspan:"2"},Kt={class:"text-sm"},Rt={rowspan:"2"},Ut={class:"text-sm"},Ht={rowspan:"2"},Ot={class:"text-sm"},Qt={rowspan:"2"},Wt={class:"text-sm"},Xt={rowspan:"2"},Zt={class:"text-sm"},ta={class:"sticky top-[60px] !z-[2]"},aa={class:"text-sm"},sa={class:"text-sm"},ea={class:"text-sm"},oa={class:"text-sm"},la={class:"text-sm"},na={class:"text-sm"},_a={class:"text-sm"},ra={class:"text-sm"},ua={class:"text-sm"},ia={ref:"to_move"},ca=["data-index"],pa={class:"w-full flex items-center justify-end"},da={class:"w-full flex flex-wrap p-3 items-center"},ma=c(()=>t("div",null," Di Validasi oleh : ",-1)),ha={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},va={key:0},fa={__name:"rpt_salary_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(p){const h=p,{$moment:x}=et(),{pointFormat:n}=nt(),_=w({...{id:-1,name:"",tipe:"",is_transition:!1,amount:0,details:[],val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:"",val3:0,val3_by:{username:""},val3_at:""}}),P=O("token"),A=w({}),V=w(null),u=w([]),J=async()=>{F().loading_full=!0,A.value={};const e=new FormData;let l="post",v=h.id;v==0||(e.append("id",v),e.append("_method","PUT"));const{data:s,error:y,status:R}=await G("/rpt_salary_validasi",{method:l,headers:{Authorization:`Bearer ${P.value}`,Accept:"application/json"},body:e,retry:0});if(F().loading_full=!1,R.value==="error"){z().trigger(y,A);return}_.value.val1=s.value.val1,_.value.val1_user=s.value.val1_user,_.value.val1_by=s.value.val1_by,_.value.val1_at=s.value.val1_at,_.value.val2=s.value.val2,_.value.val2_user=s.value.val2_user,_.value.val2_by=s.value.val2_by,_.value.val2_at=s.value.val2_at,_.value.val3=s.value.val3,_.value.val3_user=s.value.val3_user,_.value.val3_by=s.value.val3_by,_.value.val3_at=s.value.val3_at;let q=h.p_data.map(U=>U.id).indexOf(h.id);q>=-1&&h.p_data.splice(q,1,{..._.value}),h.fnClose()};i(()=>{let e=0;return u.value.forEach(l=>{e+=parseFloat(l.standby_nominal)}),e});const D=i(()=>{let e=0;return u.value.forEach(l=>{e+=parseFloat(l.sb_gaji)}),e}),E=i(()=>{let e=0;return u.value.forEach(l=>{e+=parseFloat(l.sb_makan)}),e}),M=i(()=>{let e=0;return u.value.forEach(l=>{e+=parseFloat(l.sb_dinas)}),e}),k=i(()=>{let e=0;return u.value.forEach(l=>{e+=parseFloat(l.sb_gaji_2)}),e}),j=i(()=>{let e=0;return u.value.forEach(l=>{e+=parseFloat(l.sb_makan_2)}),e}),g=i(()=>{let e=0;return u.value.forEach(l=>{e+=parseFloat(l.sb_dinas_2)}),e}),S=i(()=>{let e=0;return u.value.forEach(l=>{e+=parseFloat(l.uj_gaji)}),e}),C=i(()=>{let e=0;return u.value.forEach(l=>{e+=parseFloat(l.uj_makan)}),e}),N=i(()=>{let e=0;return u.value.forEach(l=>{e+=parseFloat(l.uj_dinas)}),e}),Y=i(()=>{let e=0;return u.value.forEach(l=>{e+=parseFloat(l.nominal_cut)}),e}),T=i(()=>{let e=0;return u.value.forEach(l=>{e+=parseFloat(l.salary_bonus_nominal)}),e}),B=i(()=>{let e=0;return u.value.forEach(l=>{e+=parseFloat(l.kerajinan)}),e}),K=async()=>{F().loading_full=!0;const{data:e,error:l,status:v}=await G("/rpt_salary",{method:"get",headers:{Authorization:`Bearer ${P.value}`,Accept:"application/json"},params:{id:h.id},retry:0});if(F().loading_full=!1,v.value==="error"){z().trigger(l);return}_.value=e.value.data,u.value=e.value.data.details};i(()=>{let e=0;return u.value.forEach(l=>{l.p_status!="Remove"&&(e+=parseInt(l.amount))}),e}),i(()=>!1);const b=w(""),$=i(()=>b.value!=""?u.value.filter(e=>e.employee.name.toLowerCase().includes(b.value.toLowerCase())):u.value);return Q(()=>h.show,(e,l)=>{e==!0&&(h.is_view==!1&&setTimeout(()=>{V.value.focus()},1),K())},{immediate:!0}),(e,l)=>{const v=H;return I((d(),m("section",rt,[t("div",null,[X(v,{title:"Form Master Standby Validation",fn:p.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",ut,[t("div",it,[t("div",ct,[t("div",pt,[dt,t("div",mt,o(a(x)(a(_).period_end).format("MM-Y")),1)]),a(u).length?(d(),m("div",ht,[vt,I(t("input",{class:"",type:"text","onUpdate:modelValue":l[0]||(l[0]=s=>Z(b)?b.value=s:null),name:"search",placeholder:"Nama"},null,512),[[tt,a(b)]])])):f("",!0)]),a($).length?(d(),m("div",ft,[t("div",bt,[t("table",yt,[t("thead",null,[wt,t("tr",xt,[kt,jt,gt,Ft,Dt,Et,Mt,St,Ct,Nt,Tt,Bt,t("th",Pt,[r("Standby 1 "),t("span",At,"("+o(a(n)(a(D)+a(E)+a(M)||0))+")",1)]),t("th",Vt,[r("Standby 2 "),t("span",Yt,"("+o(a(n)(a(k)+a(j)+a(g)||0))+")",1)]),t("th",$t,[r("Trip "),t("span",qt,"("+o(a(n)(a(S)+a(C)+a(N)||0))+")",1)]),t("th",It,[r("Potongan Trip "),t("span",Lt,"("+o(a(n)(a(Y)||0))+")",1)]),t("th",zt,[r("Potongan Lainnya "),t("span",Gt,"("+o(a(n)(a(T)||0))+")",1)]),t("th",Jt,[r("BPJS Kesehatan "),t("span",Kt,"("+o(a(n)(e.ttl_bpjs_kesehatan||0))+")",1)]),t("th",Rt,[r("BPJS Jamsos "),t("span",Ut,"("+o(a(n)(e.ttl_bpjs_jamsos||0))+")",1)]),t("th",Ht,[r("U.Kerajinan "),t("span",Ot,"("+o(a(n)(a(B)||0))+")",1)]),t("th",Qt,[r("Grand Total "),t("span",Wt,"("+o(a(n)(a(D)+a(E)+a(M)+a(k)+a(j)+a(g)+a(S)+a(C)+a(N)-a(Y)+a(T)+a(B)||0))+")",1)]),t("th",Xt,[r("Total Periode 2 "),t("span",Zt,"("+o(a(n)(a(k)+a(j)+a(g)+a(T)+a(B)||0))+")",1)])]),t("tr",ta,[t("th",null,[r("Gaji "),t("span",aa,"("+o(a(n)(a(D)||0))+")",1)]),t("th",null,[r("Makan "),t("span",sa,"("+o(a(n)(a(E)||0))+")",1)]),t("th",null,[r("Dinas "),t("span",ea,"("+o(a(n)(a(M)||0))+")",1)]),t("th",null,[r("Gaji "),t("span",oa,"("+o(a(n)(a(k)||0))+")",1)]),t("th",null,[r("Makan "),t("span",la,"("+o(a(n)(a(j)||0))+")",1)]),t("th",null,[r("Dinas "),t("span",na,"("+o(a(n)(a(g)||0))+")",1)]),t("th",null,[r("Gaji "),t("span",_a,"("+o(a(n)(a(S)||0))+")",1)]),t("th",null,[r("Makan "),t("span",ra,"("+o(a(n)(a(C)||0))+")",1)]),t("th",null,[r("Dinas "),t("span",ua,"("+o(a(n)(a(N)||0))+")",1)])])]),t("tbody",ia,[(d(!0),m(L,null,at(a($),(s,y)=>(d(),m(L,{key:y},[s.p_status!="Remove"?(d(),m("tr",{key:0,"data-index":y},[t("td",null,o(y+1)+".",1),t("td",null,o(s.employee_id),1),t("td",null,o(s.employee_name),1),t("td",null,o(s.employee_role),1),t("td",null,o(s.employee_birth_place),1),t("td",null,o(s.employee_birth_date?a(x)(s.employee_birth_date).format("DD-MM-Y"):""),1),t("td",null,o(s.employee_tmk?a(x)(s.employee_tmk).format("DD-MM-Y"):""),1),t("td",null,o(s.employee_ktp_no),1),t("td",null,o(s.employee_address),1),t("td",null,o(s.employee_status),1),t("td",null,o(s.employee_rek_no),1),t("td",null,o(s.employee_bank_name),1),t("td",null,o(a(n)(s.sb_gaji)),1),t("td",null,o(a(n)(s.sb_makan)),1),t("td",null,o(a(n)(s.sb_dinas)),1),t("td",null,o(a(n)(s.sb_gaji_2)),1),t("td",null,o(a(n)(s.sb_makan_2)),1),t("td",null,o(a(n)(s.sb_dinas_2)),1),t("td",null,o(a(n)(s.uj_gaji)),1),t("td",null,o(a(n)(s.uj_makan)),1),t("td",null,o(a(n)(s.uj_dinas)),1),t("td",null,o(a(n)(s.nominal_cut)),1),t("td",null,o(a(n)(s.salary_bonus_nominal)),1),t("td",null,o(a(n)(s.employee_bpjs_kesehatan)),1),t("td",null,o(a(n)(s.employee_bpjs_jamsos)),1),t("td",null,o(a(n)(s.kerajinan)),1),t("td",null,o(a(n)(parseFloat(s.sb_gaji)+parseFloat(s.sb_makan)+parseFloat(s.sb_dinas)+parseFloat(s.sb_gaji_2)+parseFloat(s.sb_makan_2)+parseFloat(s.sb_dinas_2)+parseFloat(s.uj_gaji)+parseFloat(s.uj_makan)+parseFloat(s.uj_dinas)-parseFloat(s.nominal_cut)+parseFloat(s.salary_bonus_nominal)+parseFloat(s.kerajinan))),1),t("td",null,o(a(n)(parseFloat(s.sb_gaji_2)+parseFloat(s.sb_makan_2)+parseFloat(s.sb_dinas_2)+parseFloat(s.salary_bonus_nominal)+parseFloat(s.kerajinan))),1)],8,ca)):f("",!0)],64))),128))],512)])])])):f("",!0)]),t("div",pa,[t("div",da,[ma,a(_).val1||a(_).val2||a(_).val3?(d(),m("div",ha,[a(_).val1?(d(),m("div",va," App 1 : "+o(a(_).val1_by.username)+" ( "+o(a(_).val1_at?a(x)(a(_).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):f("",!0)])):f("",!0)]),t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:l[1]||(l[1]=s=>p.fnClose())}," Cancel "),p.is_view==0?(d(),m("button",{key:0,ref_key:"it_val",ref:V,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:l[2]||(l[2]=st(s=>J(),["prevent"]))}," Validasi ",512)):f("",!0)])])])],512)),[[W,p.show]])}}},Fa=_t(fa,[["__scopeId","data-v-a0d0a814"]]);export{Fa as default};
