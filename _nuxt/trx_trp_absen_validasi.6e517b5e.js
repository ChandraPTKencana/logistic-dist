import{_ as B}from"./HeaderPopup.vue.3ed81de8.js";import T from"./CaretTop.bdb39f13.js";import V from"./CaretDown.885193a1.js";import{P as E,r as D,f as P,j as U,m as N,J as L,o as c,c as u,a as e,b as M,t as l,k as s,l as f,x as q,E as F,A as b,B as A,p as O,e as z}from"./entry.bfc4a585.js";import{u as G}from"./useUtils.e5d08feb.js";import{u as H}from"./useMyFetch.f0cb27d3.js";import{_ as J}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.0568650d.js";const n=_=>(O("data-v-e4e3614d"),_=_(),z(),_),K={class:"box-fixed"},R={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},Q={class:"w-full flex flex-col items-center grow overflow-auto"},W={class:"w-full"},X={class:"w-full flex flex-wrap p-3 items-center text-xs"},Z=n(()=>e("label",{for:""},"ID",-1)),ee={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},te=n(()=>e("label",{for:""},"U.jalan Per",-1)),se={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},ae=n(()=>e("label",{for:""},"Jenis",-1)),ie={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},le=n(()=>e("label",{for:""},"Supir",-1)),oe={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},re={key:0},ne=n(()=>e("label",{for:""},"Kernet",-1)),_e={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},de=n(()=>e("label",{for:""},"No Pol",-1)),ce={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},ue=n(()=>e("label",{for:""},"Tujuan",-1)),ve={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},me=n(()=>e("label",{for:""},"Tipe",-1)),fe={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},pe={class:"w-full flex flex-wrap items-center grow overflow-auto"},be={class:"w-full sm:w-1/2 text-center p-1"},he={class:"border-[1px] p-1"},we={class:"font-bold"},xe={class:"w-full flex justify-center items-center"},ge=["src"],ye={class:"w-full sm:w-1/2 text-center p-1"},ke={class:"border-[1px] p-1"},Ye={class:"border-[1px] p-1"},De={class:"font-bold"},Me={class:"w-full flex justify-center items-center"},Ae=["src"],He={class:"w-full sm:w-1/2 text-center p-1"},je={class:"border-[1px] p-1"},Ce={class:"border-[1px] p-1"},Ie={class:"font-bold"},$e={class:"w-full flex justify-center items-center"},Se=["src"],Be={class:"w-full sm:w-1/2 text-center p-1"},Te={class:"border-[1px] p-1"},Ve={class:"border-[1px] p-1"},Ee={class:"font-bold"},Pe={class:"w-full flex justify-center items-center"},Ue=["src"],Ne={class:"w-full p-1"},Le=n(()=>e("label",{for:""}," Note ",-1)),qe={class:"card-border"},Fe={class:"w-full flex items-center justify-end"},Oe={class:"w-full flex flex-wrap p-3 items-center"},ze=n(()=>e("div",null," Di Validasi oleh : ",-1)),Ge={key:1,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},Je={key:0},Ke={key:1},Re={key:2},Qe=n(()=>e("div",null," Validasi ",-1)),We={key:0,class:"text-xs font-bold"},Xe={__name:"trx_trp_absen_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},emits:["setID","setIndex"],setup(_,{emit:x}){const o=_,{$moment:v}=F();let g=a=>{a.key=="ArrowUp"&&I(),a.key=="ArrowDown"&&C()};E(()=>{document.removeEventListener("keydown",g)});const t=D({...{id:-1,tanggal:new Date,id_uj:-1,xto:"",tipe:"",jenis:"",amount:0,img_leaves:[],img_leave:"",img_arrive:"",img_return:"",img_till:"",img_leave_file:"",img_arrive_file:"",img_return_file:"",img_till_file:"",img_leave_ts:"",img_arrive_ts:"",img_return_ts:"",img_till_ts:"",ritase_note:"",ritase_val:0,ritase_val_by:{username:""},ritase_val_at:"",ritase_val1:0,ritase_val1_by:{username:""},ritase_val1_at:"",ritase_val2:0,ritase_val2_by:{username:""},ritase_val2_at:""}}),y=P("token"),j=D(null),p=D(""),$=async()=>{p.value="PROSES...",b().loading_full=!0;const a=new FormData;let i="post",d=o.id;d==0||(a.append("id",d),a.append("_method","PUT"));const{data:r,error:h,status:m}=await H("/trx_trp/absen/validasi",{method:i,headers:{Authorization:`Bearer ${y.value}`,Accept:"application/json"},body:a,retry:0});if(b().loading_full=!1,m.value==="error"){p.value="GAGAL",A().trigger(h);return}t.value.ritase_val=r.value.ritase_val,t.value.ritase_val_by=r.value.ritase_val_by,t.value.ritase_val_at=r.value.ritase_val_at,t.value.ritase_val1=r.value.ritase_val1,t.value.ritase_val1_by=r.value.ritase_val1_by,t.value.ritase_val1_at=r.value.ritase_val1_at,t.value.ritase_val2=r.value.ritase_val2,t.value.ritase_val2_by=r.value.ritase_val2_by,t.value.ritase_val2_at=r.value.ritase_val2_at;let w=o.p_data.map(Y=>Y.id).indexOf(o.id);w>=-1&&o.p_data.splice(w,1,{...t.value}),p.value="BERHASIL"},S=async()=>{b().loading_full=!0;const a=new FormData;let i="post",d=o.id;d==0||(a.append("id",d),a.append("_method","PUT"));const{data:r,error:h,status:m}=await H("/trx_trp/absen/clear_valval1",{method:i,headers:{Authorization:`Bearer ${y.value}`,Accept:"application/json"},body:a,retry:0});if(b().loading_full=!1,m.value==="error"){A().trigger(h);return}t.value.ritase_val=0,t.value.ritase_val1=0;let w=o.p_data.map(Y=>Y.id).indexOf(o.id);w>=-1&&o.p_data.splice(w,1,{...t.value})},k=async()=>{p.value="",b().loading_full=!0;const{data:a,error:i,status:d}=await H("/trx_trp/absen",{method:"get",headers:{Authorization:`Bearer ${y.value}`,Accept:"application/json"},params:{id:o.id},retry:0});if(b().loading_full=!1,d.value==="error"){A().trigger(i);return}t.value=a.value.data};U(()=>o.show,(a,i)=>{a==!0?(document.addEventListener("keydown",g),o.is_view==!1&&setTimeout(()=>{j.value.focus()},1),k()):document.removeEventListener("keydown",g)},{immediate:!0});const C=()=>{let a=o.p_data.map(i=>i.id).indexOf(o.id);a!=o.p_data.length-1&&(a++,x("setID",o.p_data[a].id),x("setIndex",a),setTimeout(()=>{k()},100))},I=()=>{let a=o.p_data.map(i=>i.id).indexOf(o.id);a!=0&&(a--,x("setID",o.p_data[a].id),x("setIndex",a),setTimeout(()=>{k()},100))};return(a,i)=>{const d=B,r=T,h=V;return N((c(),u("section",K,[e("div",null,[M(d,{title:"Form Transaction Validation",fn:_.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",R,[e("div",Q,[e("div",W,[e("div",X,[e("div",null,[Z,e("div",ee,l(s(t).id),1)]),e("div",null,[te,e("div",se,l(s(t).tanggal?s(v)(s(t).tanggal).format("DD-MM-YYYY"):""),1)]),e("div",null,[ae,e("div",ie,l(s(t).jenis),1)]),e("div",null,[le,e("div",oe,l(s(t).supir),1)]),s(t).kernet?(c(),u("div",re,[ne,e("div",_e,l(s(t).kernet),1)])):f("",!0),e("div",null,[de,e("div",ce,l(s(t).no_pol),1)]),e("div",null,[ue,e("div",ve,l(s(t).xto),1)]),e("div",null,[me,e("div",fe,l(s(t).tipe),1)])])]),e("div",pe,[e("div",be,[e("div",he,[e("label",we,"Berangkat : "+l(s(t).img_leave_ts?s(v)(s(t).img_leave_ts).format("DD-MM-YYYY HH:mm"):""),1),e("div",xe,[e("img",{src:s(t).img_leave,alt:""},null,8,ge)])])]),e("div",ye,[e("div",ke,[e("div",Ye,[e("label",De,"Tiba : "+l(s(t).img_arrive_ts?s(v)(s(t).img_arrive_ts).format("DD-MM-YYYY HH:mm"):""),1),e("div",Me,[e("img",{src:s(t).img_arrive,alt:""},null,8,Ae)])])])]),e("div",He,[e("div",je,[e("div",Ce,[e("label",Ie,"Kembali : "+l(s(t).img_return_ts?s(v)(s(t).img_return_ts).format("DD-MM-YYYY HH:mm"):""),1),e("div",$e,[e("img",{src:s(t).img_return,alt:""},null,8,Se)])])])]),e("div",Be,[e("div",Te,[e("div",Ve,[e("label",Ee,"Sampai : "+l(s(t).img_till_ts?s(v)(s(t).img_till_ts).format("DD-MM-YYYY HH:mm"):""),1),e("div",Pe,[e("img",{src:s(t).img_till,alt:""},null,8,Ue)])])])]),e("div",Ne,[Le,e("div",qe,l(s(t).ritase_note),1)])])]),e("div",Fe,[e("div",Oe,[("useUtils"in a?a.useUtils:s(G))().checkPermissions(["trp_trx.absen.clear_valval1"])&&s(t).ritase_val2==0?(c(),u("button",{key:0,type:"button",name:"button",class:"w-36 m-1 bg-yellow-600",onClick:i[0]||(i[0]=m=>S())}," Clear Val ")):f("",!0),ze,s(t).ritase_val||s(t).ritase_val1||s(t).ritase_val2?(c(),u("div",Ge,[s(t).ritase_val?(c(),u("div",Je," App 1 : "+l(s(t).ritase_val_by.username)+" ( "+l(s(t).ritase_val_at?s(v)(s(t).ritase_val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):f("",!0),s(t).ritase_val1?(c(),u("div",Ke," App 2 : "+l(s(t).ritase_val1_by.username)+" ( "+l(s(t).ritase_val1_at?s(v)(s(t).ritase_val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):f("",!0),s(t).ritase_val2?(c(),u("div",Re," App 3 : "+l(s(t).ritase_val2_by.username)+" ( "+l(s(t).ritase_val2_at?s(v)(s(t).ritase_val2_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):f("",!0)])):f("",!0)]),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:i[1]||(i[1]=m=>I())},[M(r,{class:"black"})]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:i[2]||(i[2]=m=>_.fnClose())}," Cancel "),_.is_view==0?(c(),u("button",{key:0,ref_key:"it_val",ref:j,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm flex flex-col items-center justify-center",onClick:i[3]||(i[3]=q(m=>$(),["prevent"]))},[Qe,s(p)!=""?(c(),u("div",We,l(s(p)),1)):f("",!0)],512)):f("",!0),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:i[4]||(i[4]=m=>C())},[M(h,{class:"black"})])])])])],512)),[[L,_.show]])}}},nt=J(Xe,[["__scopeId","data-v-e4e3614d"]]);export{nt as default};
