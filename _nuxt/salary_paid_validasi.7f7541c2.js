import{_ as T}from"./HeaderPopup.vue.5d5e0ea9.js";import{r as b,f as Y,G as x,j as z,m as R,J as H,o as _,c as d,a as e,b as U,t as o,k as l,d as g,F as P,y as G,l as h,x as J,E as K,A as k,B as $,p as L,e as O}from"./entry.e2a348bc.js";import{u as Q}from"./useUtils.eac65038.js";import{u as j}from"./useMyFetch.e2cc1362.js";import{_ as W}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.14b13dbc.js";const r=i=>(L("data-v-47c02a1f"),i=i(),O(),i),X={class:"box-fixed"},Z={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},ee={class:"w-full flex flex-col items-center grow overflow-auto"},te={class:"w-full flex flex-row flex-wrap"},ae={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},le=r(()=>e("label",{for:""},"Period End",-1)),se={class:"card-border"},oe={class:"w-full flex flex-row flex-wrap"},ne={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},re=r(()=>e("label",{for:""},"Period Part",-1)),ie={class:"card-border"},ue={key:0,class:"w-full flex p-1 justify-between flex-wrap"},_e={class:"w-full",role:"sticky"},de={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},ce=r(()=>e("tr",{class:"sticky -top-1 !z-[2]"},[e("td",{colspan:"10",class:"!bg-slate-800 text-white font-bold"}," Detail ")],-1)),ve={class:"sticky top-7 !z-[2]"},fe=r(()=>e("th",null,"No",-1)),pe=r(()=>e("th",null,"Nama Pekerja",-1)),me=r(()=>e("th",null,"No KTP",-1)),he=r(()=>e("th",null,"No SIM",-1)),ye=r(()=>e("th",null,"Rek No",-1)),we=r(()=>e("th",null,"Rek Nama",-1)),be=r(()=>e("th",null,"Bank Name",-1)),xe={class:"text-sm"},ke={class:"text-sm"},ge={class:"text-sm"},Ne={ref:"to_move"},Fe=["data-index"],Se={class:"w-full flex items-center justify-end"},Be={class:"w-full flex flex-wrap p-3 items-center"},Ce=r(()=>e("div",null," Di Validasi oleh : ",-1)),Ae={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},De={key:0},Me={__name:"salary_paid_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(i){const u=i,{$moment:N}=K(),{pointFormat:c}=Q(),a=b({...{id:-1,name:"",tipe:"",is_transition:!1,amount:0,details:[],val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:"",val3:0,val3_by:{username:""},val3_at:""}}),F=Y("token"),S=b({}),B=b(null),v=b([]),q=async()=>{k().loading_full=!0,S.value={};const s=new FormData;let n="post",f=u.id;f==0||(s.append("id",f),s.append("_method","PUT"));const{data:t,error:p,status:y}=await j("/salary_paid_validasi",{method:n,headers:{Authorization:`Bearer ${F.value}`,Accept:"application/json"},body:s,retry:0});if(k().loading_full=!1,y.value==="error"){$().trigger(p,S);return}a.value.val1=t.value.val1,a.value.val1_user=t.value.val1_user,a.value.val1_by=t.value.val1_by,a.value.val1_at=t.value.val1_at,a.value.val2=t.value.val2,a.value.val2_user=t.value.val2_user,a.value.val2_by=t.value.val2_by,a.value.val2_at=t.value.val2_at,a.value.val3=t.value.val3,a.value.val3_user=t.value.val3_user,a.value.val3_by=t.value.val3_by,a.value.val3_at=t.value.val3_at;let m=u.p_data.map(w=>w.id).indexOf(u.id);m>=-1&&u.p_data.splice(m,1,{...a.value}),u.fnClose()},C=x(()=>{let s=0;return v.value.forEach(n=>{s+=parseFloat(n.standby_nominal)}),s}),A=x(()=>{let s=0;return v.value.forEach(n=>{s+=parseFloat(n.salary_bonus_nominal)}),s}),I=async()=>{k().loading_full=!0;const{data:s,error:n,status:f}=await j("/salary_paid",{method:"get",headers:{Authorization:`Bearer ${F.value}`,Accept:"application/json"},params:{id:u.id},retry:0});if(k().loading_full=!1,f.value==="error"){$().trigger(n);return}a.value=s.value.data,v.value=s.value.data.details};return x(()=>{let s=0;return v.value.forEach(n=>{n.p_status!="Remove"&&(s+=parseInt(n.amount))}),s}),x(()=>!1),z(()=>u.show,(s,n)=>{s==!0&&(u.is_view==!1&&setTimeout(()=>{B.value.focus()},1),I())},{immediate:!0}),(s,n)=>{const f=T;return R((_(),d("section",X,[e("div",null,[U(f,{title:"Form Master Standby Validation",fn:i.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",Z,[e("div",ee,[e("div",te,[e("div",ae,[le,e("div",se,o(l(N)(l(a).period_end).format("MM-Y")),1)])]),e("div",oe,[e("div",ne,[re,e("div",ie,o(l(a).period_part),1)])]),l(v).length?(_(),d("div",ue,[e("div",_e,[e("table",de,[e("thead",null,[ce,e("tr",ve,[fe,pe,me,he,ye,we,be,e("th",null,[g("Nominal Standby "),e("span",xe,"("+o(l(c)(l(C)||0))+")",1)]),e("th",null,[g("Nominal Bonus "),e("span",ke,"("+o(l(c)(l(A)||0))+")",1)]),e("th",null,[g("Total "),e("span",ge,"("+o(l(c)(l(C)+l(A)||0))+")",1)])])]),e("tbody",Ne,[(_(!0),d(P,null,G(l(v),(t,p)=>{var y,m,w,D,M,V,E;return _(),d(P,{key:p},[t.p_status!="Remove"?(_(),d("tr",{key:0,"data-index":p},[e("td",null,o(p+1)+".",1),e("td",null,o((y=t.employee)==null?void 0:y.name),1),e("td",null,o((m=t.employee)==null?void 0:m.ktp_no),1),e("td",null,o((w=t.employee)==null?void 0:w.sim_no),1),e("td",null,o((D=t.employee)==null?void 0:D.rek_no),1),e("td",null,o((M=t.employee)==null?void 0:M.rek_name),1),e("td",null,o((E=(V=t.employee)==null?void 0:V.bank)==null?void 0:E.code),1),e("td",null,o(l(c)(t.standby_nominal)),1),e("td",null,o(l(c)(t.salary_bonus_nominal)),1),e("td",null,o(l(c)(parseFloat(t.standby_nominal)+parseFloat(t.salary_bonus_nominal))),1)],8,Fe)):h("",!0)],64)}),128))],512)])])])):h("",!0)]),e("div",Se,[e("div",Be,[Ce,l(a).val1||l(a).val2||l(a).val3?(_(),d("div",Ae,[l(a).val1?(_(),d("div",De," App 1 : "+o(l(a).val1_by.username)+" ( "+o(l(a).val1_at?l(N)(l(a).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):h("",!0)])):h("",!0)]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:n[0]||(n[0]=t=>i.fnClose())}," Cancel "),i.is_view==0?(_(),d("button",{key:0,ref_key:"it_val",ref:B,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:n[1]||(n[1]=J(t=>q(),["prevent"]))}," Validasi ",512)):h("",!0)])])])],512)),[[H,i.show]])}}},Te=W(Me,[["__scopeId","data-v-47c02a1f"]]);export{Te as default};
