import nt from"./Header.a2dd1975.js";import at from"./Calendar.3ff848bb.js";import rt from"./CarTag.859e4c3f.js";import it from"./TruckDriver.c0e6e4ea.js";import ct from"./TruckDriverOutline.7848e9a2.js";import dt from"./LocationOn.a6707107.js";import{_ as _t}from"./HeaderPopup.vue.bb8c376c.js";import xt from"./Image.a5c56a06.js";import ft from"./GAPIN.f7672af8.js";import{g as ut,h as pt,r as u,j as ht,i as mt,f as gt,c as i,b as p,a as t,k as T,A as vt,l as s,m as bt,F as C,D as H,J as L,t as o,n as x,d as I,q as yt,x as b,y as N,o as c,G as wt}from"./entry.36de9367.js";import{u as kt}from"./useUtils.4e17f912.js";import{u as $}from"./useMyFetch.381897d2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.483dd678.js";const Tt={class:"w-full h-full flex flex-col relative"},Dt={class:"grow flex flex-col"},Yt={class:"w-full flex items-center p-1"},jt={class:"grow"},Mt={class:"grow overflow-auto h-0"},At={class:"p-1 grow"},Ct={class:"bg-white flex py-2 justify-between"},Ht={class:"flex flex-wrap"},Lt={class:"flex items-center justify-center m-2 text-xs"},It={class:"bg-blue-400 p-2 font-bold text-white"},Nt={class:"flex flex-col m-2"},$t=t("span",{class:"text-xs"}," Tgl Terima U.Jalan ",-1),St={class:"flex items-center justify-center"},Pt={class:"flex flex-col m-2"},Bt=t("span",{class:"text-xs"}," Nomor Kendaraan ",-1),Kt={class:"flex items-center justify-center"},Rt=["data-real"],Vt={class:"flex flex-col m-2"},Ft=t("span",{class:"text-xs"}," Nama Supir ",-1),Ut={class:"flex items-center justify-center"},qt=["data-real"],zt={key:0,class:"flex flex-col m-2"},Jt=t("span",{class:"text-xs"}," Nama Kernet ",-1),Et={class:"flex items-center justify-center"},Ot=["data-real"],Gt={class:"flex flex-col m-2"},Wt=t("span",{class:"text-xs"}," Tujuan ",-1),Qt={class:"flex items-center justify-center"},Xt=["onClick"],Zt={class:"w-full h-full fixed top-0 left-0 bg-gray-100 bg-opacity-80 flex items-center justify-center z-10"},ts={class:"w-full sm:w-10/12 md:w-10/12 lg:w-8/12 bg-white flex flex-col border-solid border-gray-200 max-w-full max-h-full overflow-auto",style:{"border-width":"1px"}},ss={class:"p-1 flex flex-wrap overflow-auto items-start"},es={class:"w-full flex flex-wrap"},os={class:"w-full flex flex-wrap"},ls={class:"flex flex-col m-2 border-solid border-l-4 border-blue-400 px-2 bg-gray-200"},ns=t("span",{class:"text-xs font-bold"}," ID ",-1),as={class:""},rs={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},is=t("span",{class:"text-xs font-bold"}," Tgl Terima U.Jalan ",-1),cs={class:""},ds={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},_s=t("span",{class:"text-xs font-bold"}," Nomor Kendaraan ",-1),xs={class:""},fs={class:"flex flex-row flex-wrap m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},us={class:"flex flex-col"},ps=t("span",{class:"text-xs font-bold"}," Nama Supir ",-1),hs={class:""},ms={class:"flex flex-col pl-2"},gs=t("span",{class:"text-xs font-bold"}," No rek ",-1),vs={class:""},bs={key:0,class:"flex flex-row flex-wrap m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},ys={class:"flex flex-col"},ws=t("span",{class:"text-xs font-bold"}," Nama Kernet ",-1),ks={class:""},Ts={class:"flex flex-col pl-2"},Ds=t("span",{class:"text-xs font-bold"}," No rek ",-1),Ys={class:""},js={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},Ms=t("span",{class:"text-xs font-bold"}," Tujuan ",-1),As={class:""},Cs={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},Hs=t("span",{class:"text-xs font-bold"}," Info ",-1),Ls={class:""},Is={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},Ns=t("span",{class:"text-xs font-bold"}," Tipe ",-1),$s={class:""},Ss={class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},Ps=t("span",{class:"text-xs font-bold"}," Jenis ",-1),Bs={class:""},Ks={key:1,class:"flex flex-col m-1 border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200"},Rs=t("span",{class:"text-xs font-bold"}," Pengalihan ",-1),Vs={class:""},Fs={class:"w-full flex flex-wrap justify-center"},Us={key:0,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},qs=t("span",{class:"text-xs font-bold"}," App Kasir ",-1),zs={class:"text-xs"},Js={key:1,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},Es=t("span",{class:"text-xs font-bold"}," App Mandor ",-1),Os={class:"text-xs"},Gs={key:2,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},Ws=t("span",{class:"text-xs font-bold"}," App KTU/W ",-1),Qs={class:"text-xs"},Xs={key:3,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},Zs=t("span",{class:"text-xs font-bold"}," App Marketing ",-1),te={class:"text-xs"},se={key:4,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},ee=t("span",{class:"text-xs font-bold"}," App Logistik ",-1),oe={class:"text-xs"},le={key:5,class:"flex flex-col m-2 ring-1 ring-gray-400 p-1 text-center justify-center items-center rounded text-xs"},ne=t("span",{class:"text-xs font-bold"}," App SPV Logistik ",-1),ae={class:"text-xs"},re={class:"w-full sm:w-1/2 text-sm flex justify-center"},ie={class:"border border-collapse border-black"},ce=t("tr",null,[t("th",{colspan:"4",class:"bg-blue-400"}," List Uang Jalan ")],-1),de={class:"p-1"},_e={class:"p-1"},xe=t("td",{class:"p-1"},"= Rp.",-1),fe={class:"text-right p-1"},ue={class:"border-t-black border-dashed",style:{"border-top-width":"1px"}},pe=t("th",{colspan:"2",class:"text-right"},"Total",-1),he=t("th",{class:"p-1 text-right"},"Rp.",-1),me={class:"p-1 text-right"},ge={key:0,class:"text-red-500 font-bold"},ve=t("td",{colspan:"2",class:"text-right"},"Potongan Supir",-1),be=t("td",{class:"p-1 text-right"},"Rp.",-1),ye={class:"p-1 text-right"},we={key:1,class:"text-red-500 font-bold"},ke=t("td",{colspan:"2",class:"text-right"},"Potongan Kernet",-1),Te=t("td",{class:"p-1 text-right"},"Rp.",-1),De={class:"p-1 text-right"},Ye={key:2,class:"text-red-500 font-bold"},je=t("td",{colspan:"2",class:"text-right"},"Total Potongan",-1),Me=t("td",{class:"p-1 text-right"},"Rp.",-1),Ae={class:"p-1 text-right"},Ce={key:3,class:"font-bold"},He=t("td",{colspan:"2",class:"text-right"},"Total Diterima",-1),Le=t("td",{class:"p-1 text-right"},"Rp.",-1),Ie={class:"p-1 text-right"},Ne={class:"w-full sm:w-1/2 h-full"},$e=["src"],Se={key:1,class:"flex flex-col justify-center items-center px-2 py-8 border border-gray-700 bg-gray-300"},Pe={class:"w-full border-solid border-l-4 border-blue-400 px-2 py-1 bg-gray-200 mt-2 flex flex-row flex-wrap"},Be={class:"flex flex-col mr-5"},Ke=t("span",{class:"text-xs font-bold"}," EM#ID ",-1),Re={class:""},Ve={class:"flex flex-col mr-5"},Fe=t("span",{class:"text-xs font-bold"}," Nama Penerima ",-1),Ue={class:""},qe={class:"flex flex-col mr-5"},ze=t("span",{class:"text-xs font-bold"}," No rek ",-1),Je={class:""},Ee={class:"flex flex-col mr-5"},Oe=t("span",{class:"text-xs font-bold"}," Tanggal ",-1),Ge={class:""},We={class:"flex flex-col mr-5"},Qe=t("span",{class:"text-xs font-bold"}," Tujuan ",-1),Xe={class:""},Ze={class:"flex flex-col mr-5"},to=t("span",{class:"text-xs font-bold"}," Desc ",-1),so={class:""},eo={class:"flex flex-col mr-5"},oo=t("span",{class:"text-xs font-bold"}," Total ",-1),lo={class:""},no={class:"flex p-1 justify-end flex-wrap"},ao={class:"flex p-1 justify-center flex-wrap bg-yellow-100"},ro=t("div",{class:"w-full text-center"}," Akan dilakukan Transfer dengan data diatas. Apakah Informasi Diatas Sudah Benar Dan Tepat? ",-1),To={__name:"transfer",async setup(io){let y,S;const{$moment:h}=wt(),{pointFormat:f}=kt(),D=ut("token");new Date().getTimezoneOffset();const{data:E}=([y,S]=pt(async()=>yt(async()=>{b().loading_full=!0;let n=[];const[l,d]=await Promise.all([$("/trx_trp/transfers",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},retry:0})]);return l.status.value==="error"?(N().trigger(l.error),{trx_trps:n}):(b().loading_full=!1,n=l.data.value.data,{trx_trps:n})},"$pIgiM26TjW")),y=await y,S(),y),Y=u(E.value.trx_trps||[]),j=u({}),e=u({id:-1,tanggal:new Date,xto:"",tipe:"",jenis:"",amount:0,supir:"",kernet:"",no_pol:"",details_uj:[]}),M=u(-1),m=u(""),O=async n=>{b().loading_full=!0;const{data:l,error:d,status:r}=await $("/trx_trp/transfer/detail",{method:"get",headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},params:{id:n.id},retry:0});if(b().loading_full=!1,r.value==="error"){N().trigger(d,j);return}e.value=l.value.data},G=async()=>{b().loading_full=!0,j.value={};const n=new FormData;n.append("id",e.value.id),n.append("_method","PUT");let l="post";const{data:d,error:r,status:_}=await $("/trx_trp/transfer",{method:l,headers:{Authorization:`Bearer ${D.value}`,Accept:"application/json"},body:n,retry:0});if(b().loading_full=!1,_.value==="error"){N().trigger(r,j);return}Y.value.splice(M.value,1),M.value=-1,v.value=!1,g.value=!1},g=u(!1),W=u(0),v=u(!1);ht();const Q=(n,l)=>{M.value=n,W.value=l,g.value=!0,O(l)},P=mt(()=>m.value!=""?Y.value.filter(n=>n.no_pol.toLowerCase().includes(m.value.toLowerCase())||n.supir.toLowerCase().includes(m.value.toLowerCase())||n.kernet.toLowerCase().includes(m.value.toLowerCase())):Y.value),w=n=>n.potongan&&n.potongan.length>0?n.potongan.map(l=>parseInt(l.nominal_cut)).reduce((l,d)=>(l+=d,l)):0,B=n=>{if(n.potongan&&n.potongan.length>0){let l=n.potongan.filter(r=>r.potongan_mst.employee_id==n.supir_id);if(l.length==0)return 0;let d=l.map(r=>parseInt(r.nominal_cut));return d.length==0?0:d.reduce((r,_)=>(r+=_,r))}return 0},K=n=>{if(n.potongan&&n.potongan.length>0){let l=n.potongan.filter(r=>r.potongan_mst.employee_id==n.kernet_id);if(l.length==0)return 0;let d=l.map(r=>parseInt(r.nominal_cut));return d.length==0?0:d.reduce((r,_)=>(r+=_,r))}return 0},X=()=>{let n=m.value;document.querySelectorAll(".to_hl").forEach(l=>{let d=l.dataset.real;var r=l.innerHTML,_=d.toLowerCase().indexOf(n.toLowerCase());_>-1&&n!=""?(r=d.substring(0,_)+"<span class='highlight'>"+d.substring(_,_+n.length)+"</span>"+d.substring(_+n.length),l.innerHTML=r):l.innerHTML=r=d})};gt(()=>P,(n,l)=>{setTimeout(()=>{X()},0)},{deep:!0,immediate:!0});const R=u(0);return(n,l)=>{var V,F;const d=nt,r=at,_=rt,Z=it,tt=ct,st=dt,et=_t,ot=xt,lt=ft;return c(),i("div",Tt,[p(d,{title:"List Transaction"}),t("section",Dt,[t("div",Yt,[t("div",jt,[T(t("input",{class:"flex-grow",type:"text","onUpdate:modelValue":l[0]||(l[0]=a=>bt(m)?m.value=a:null),name:"search",placeholder:"Keyword"},null,512),[[vt,s(m)]])])]),t("div",Mt,[(c(!0),i(C,null,H(s(P),(a,k)=>(c(),i("div",At,[t("div",Ct,[t("div",Ht,[t("div",Lt,[t("div",It,o(a.id),1)]),t("div",Nt,[$t,t("div",St,[p(r,{class:"mr-1"}),I(" "+o(s(h)(a.tanggal).format("DD-MM-YYYY")),1)])]),t("div",Pt,[Bt,t("div",Kt,[p(_,{class:"mr-1"}),t("span",{class:"to_hl","data-real":a.no_pol},o(a.no_pol),9,Rt)])]),t("div",Vt,[Ft,t("div",Ut,[p(Z,{class:"mr-1"}),t("span",{class:"to_hl","data-real":a.supir},o(a.supir),9,qt)])]),a.kernet?(c(),i("div",zt,[Jt,t("div",Et,[p(tt,{class:"mr-1"}),t("span",{class:"to_hl","data-real":a.kernet},o(a.kernet),9,Ot)])])):x("",!0),t("div",Gt,[Wt,t("div",Qt,[p(st,{class:"mr-1"}),I(" "+o(a.xto),1)])])]),t("button",{class:"bg-blue-500 text-white rounded",onClick:A=>Q(k,a)}," Detail ",8,Xt)])]))),256))])]),T(t("div",Zt,[t("div",ts,[p(et,{title:"Detail Information",fn:()=>{g.value=!1,v.value=!1},class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("div",ss,[t("div",es,[t("div",os,[t("div",ls,[ns,t("div",as,o(s(e).id),1)]),t("div",rs,[is,t("div",cs,o(s(h)(s(e).tanggal).format("DD-MM-YYYY")),1)]),t("div",ds,[_s,t("div",xs,o(s(e).no_pol),1)]),t("div",fs,[t("div",us,[ps,t("div",hs,o(s(e).supir),1)]),t("div",ms,[gs,t("div",vs,o(s(e).supir_rek_no),1)])]),s(e).kernet?(c(),i("div",bs,[t("div",ys,[ws,t("div",ks,o(s(e).kernet),1)]),t("div",Ts,[Ds,t("div",Ys,o(s(e).kernet_rek_no),1)])])):x("",!0),t("div",js,[Ms,t("div",As,o(s(e).xto),1)]),t("div",Cs,[Hs,t("div",Ls,o((V=s(e).uj)==null?void 0:V.asst_opt),1)]),t("div",Is,[Ns,t("div",$s,o(s(e).tipe),1)]),t("div",Ss,[Ps,t("div",Bs,o(s(e).jenis),1)]),s(e).transition_type=="From"?(c(),i("div",Ks,[Rs,t("div",Vs,o(s(e).transition_target),1)])):x("",!0)]),t("div",Fs,[s(e).val?(c(),i("div",Us,[qs,t("div",null," ( "+o(s(e).val_by.username)+" ) ",1),t("div",zs,o(s(h)(s(e).val_at).format("DD-MM-YYYY HH:mm:ss")),1)])):x("",!0),s(e).val1?(c(),i("div",Js,[Es,t("div",null," ( "+o(s(e).val1_by.username)+" ) ",1),t("div",Os,o(s(h)(s(e).val1_at).format("DD-MM-YYYY HH:mm:ss")),1)])):x("",!0),s(e).val2?(c(),i("div",Gs,[Ws,t("div",null," ( "+o(s(e).val2_by.username)+" ) ",1),t("div",Qs,o(s(h)(s(e).val2_at).format("DD-MM-YYYY HH:mm:ss")),1)])):x("",!0),s(e).val3?(c(),i("div",Xs,[Zs,t("div",null," ( "+o(s(e).val3_by.username)+" ) ",1),t("div",te,o(s(h)(s(e).val3_at).format("DD-MM-YYYY HH:mm:ss")),1)])):x("",!0),s(e).val4?(c(),i("div",se,[ee,t("div",null," ( "+o(s(e).val4_by.username)+" ) ",1),t("div",oe,o(s(h)(s(e).val4_at).format("DD-MM-YYYY HH:mm:ss")),1)])):x("",!0),s(e).val5?(c(),i("div",le,[ne,t("div",null," ( "+o(s(e).val5_by.username)+" ) ",1),t("div",ae,o(s(h)(s(e).val5_at).format("DD-MM-YYYY HH:mm:ss")),1)])):x("",!0)])]),t("div",re,[t("table",ie,[ce,(c(!0),i(C,null,H(s(e).details_uj,a=>(c(),i("tr",null,[t("td",de,o(a.ordinal)+". ",1),t("td",_e,o(a.xdesc)+" "+o(a.qty<=1?"":s(f)(a.qty||0)+" x Rp."+s(f)(a.harga||0)),1),xe,t("td",fe,o(s(f)(a.qty*a.harga)),1)]))),256)),t("tr",ue,[pe,he,t("th",me,o(s(f)(s(e).amount)),1)]),B(s(e))>0?(c(),i("tr",ge,[ve,be,t("td",ye,o(s(f)(B(s(e)))),1)])):x("",!0),K(s(e))>0?(c(),i("tr",we,[ke,Te,t("td",De,o(s(f)(K(s(e)))),1)])):x("",!0),w(s(e))>0?(c(),i("tr",Ye,[je,Me,t("td",Ae,o(s(f)(w(s(e)))),1)])):x("",!0),w(s(e))>0?(c(),i("tr",Ce,[He,Le,t("td",Ie,o(s(f)(s(e).amount-w(s(e)))),1)])):x("",!0)])]),t("div",Ne,[((F=s(e).trx_absens)==null?void 0:F.length)>0?(c(),i("img",{key:0,class:"w-full",src:s(e).trx_absens[0].gambar},null,8,$e)):(c(),i("div",Se,[p(ot),I(" Tidak Ada Foto Berangkat ")]))]),(c(!0),i(C,null,H(s(e).extra_money_trxs,a=>{var k,A,U,q,z,J;return c(),i("div",Pe,[t("div",Be,[Ke,t("div",Re,o(a.id),1)]),t("div",Ve,[Fe,t("div",Ue,o((k=a.employee)==null?void 0:k.name),1)]),t("div",qe,[ze,t("div",Je,o((A=a.employee)==null?void 0:A.rek_no),1)]),t("div",Ee,[Oe,t("div",Ge,o(a.tanggal),1)]),t("div",We,[Qe,t("div",Xe,o((U=a.extra_money)==null?void 0:U.xto),1)]),t("div",Ze,[to,t("div",so,o((q=a.extra_money)==null?void 0:q.description),1)]),t("div",eo,[oo,t("div",lo,o(s(f)(((z=a.extra_money)==null?void 0:z.nominal)*((J=a.extra_money)==null?void 0:J.qty))),1)])])}),256))]),T(t("div",no,[t("button",{class:"rounded m-1",onClick:l[1]||(l[1]=a=>g.value=!1)}," Cancel "),t("button",{class:"rounded m-1 text-white bg-blue-500",onClick:l[2]||(l[2]=a=>v.value=!0)}," Transfer ")],512),[[L,!s(v)]]),T(t("div",ao,[ro,t("button",{class:"rounded m-1 bg-white",onClick:l[3]||(l[3]=a=>(v.value=!1,g.value=!1))}," Tidak "),t("button",{class:"rounded m-1 text-white bg-blue-500",onClick:l[4]||(l[4]=a=>G())}," Ya ")],512),[[L,s(v)]])])],512),[[L,s(g)]]),p(lt,{show:s(R),onSetTimeout:l[5]||(l[5]=a=>R.value=a)},null,8,["show"])])}}};export{To as default};
