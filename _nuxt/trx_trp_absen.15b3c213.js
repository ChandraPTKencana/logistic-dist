import{_ as D}from"./HeaderPopup.vue.6f95255f.js";import{_ as F}from"./client-only.3743e9d4.js";import j from"./AttachmentSingle.2192c367.js";import{r as k,f as A,j as B,I as $,m as M,J as P,o as f,c as b,a as t,b as r,t as o,k as l,l as S,w,F as N,y as U,v as I,x as T,E as q,A as h,B as Y,p as W,e as E}from"./entry.ec864cca.js";import"./useUtils.19b1f0ba.js";import{u as H}from"./useMyFetch.5948619c.js";import{_ as K}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.42d1398d.js";import"./PDFJsView.36b27175.js";const _=m=>(W("data-v-2d6b0197"),m=m(),E(),m),O={class:"box-fixed"},z={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},J={class:"w-full"},L={class:"w-full flex flex-wrap p-3 items-center text-xs"},G=_(()=>t("label",{for:""},"ID",-1)),Q={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},R=_(()=>t("label",{for:""},"U.jalan Per",-1)),X={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},Z=_(()=>t("label",{for:""},"Jenis",-1)),ee={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},te=_(()=>t("label",{for:""},"Supir",-1)),le={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},ie={key:0},ae=_(()=>t("label",{for:""},"Kernet",-1)),se={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},oe=_(()=>t("label",{for:""},"No Pol",-1)),re={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},_e=_(()=>t("label",{for:""},"Tujuan",-1)),ne={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},de=_(()=>t("label",{for:""},"Tipe",-1)),me={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},ue={class:"w-full flex flex-wrap items-center grow overflow-auto"},pe={class:"w-full sm:w-1/2 text-center p-1"},ve={class:"border-[1px] p-1"},ce=_(()=>t("label",{class:"font-bold"},"Berangkat ",-1)),ge={class:"text-red-500"},fe={class:"text-red-500"},be={key:0,class:"flex flex-wrap"},xe={class:"w-1/2 sm:w-1/3 md:w-1/4 lg:w-1/5 xl:w-1/6 p-1"},we=["src","onClick"],he={class:"w-full sm:w-1/2 text-center p-1"},ye={class:"border-[1px] p-1"},ke=_(()=>t("label",{class:"font-bold"},"Tiba ",-1)),Me={class:"text-red-500"},Se={class:"text-red-500"},Ye={class:"w-full sm:w-1/2 text-center p-1"},He={class:"border-[1px] p-1"},Ve=_(()=>t("label",{class:"font-bold"},"Kembali ",-1)),Ce={class:"text-red-500"},De={class:"text-red-500"},Fe={class:"w-full sm:w-1/2 text-center p-1"},je={class:"border-[1px] p-1"},Ae=_(()=>t("label",{class:"font-bold"},"Sampai ",-1)),Be={class:"text-red-500"},$e={class:"text-red-500"},Pe={class:"w-full p-1"},Ne=_(()=>t("label",{for:""}," Note ",-1)),Ue={class:"w-full flex items-center justify-end"},Ie={__name:"trx_trp_absen",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},p_data:{type:Array,required:!0,default:[]},id:{type:Number,required:!1,default:0}},setup(m){const d=m,{$moment:g}=q(),e=k({...{id:-1,tanggal:new Date,id_uj:-1,xto:"",tipe:"",jenis:"",amount:0,img_leaves:[],img_leave:"",img_arrive:"",img_return:"",img_till:"",img_leave_file:"",img_arrive_file:"",img_return_file:"",img_till_file:"",img_leave_ts:"",img_arrive_ts:"",img_return_ts:"",img_till_ts:"",ritase_note:""}}),n=k({}),y=A("token"),V=async()=>{h().loading_full=!0;const{data:s,error:a,status:p}=await H("/trx_trp/absen",{method:"get",headers:{Authorization:`Bearer ${y.value}`,Accept:"application/json"},params:{id:d.id},retry:0});if(h().loading_full=!1,p.value==="error"){Y().trigger(a);return}e.value=s.value.data};B(()=>d.show,(s,a)=>{s==!0&&V()},{immediate:!0});const C=async()=>{h().loading_full=!0,n.value={};const s=new FormData;if(e.value.img_leave){let i=e.value.img_leaves.map(x=>x.gambar).indexOf(e.value.img_leave);i==-1?s.append("img_leave","ada"):s.append("img_leave",e.value.img_leaves[i].id)}else s.append("img_leave","");s.append("img_leave_file",e.value.img_leave_file),s.append("img_leave_ts",e.value.img_leave_ts?g(e.value.img_leave_ts).format("YYYY-MM-DD HH:mm"):""),s.append("img_arrive",e.value.img_arrive?"ada":""),s.append("img_arrive_file",e.value.img_arrive_file),s.append("img_arrive_ts",e.value.img_arrive_ts?g(e.value.img_arrive_ts).format("YYYY-MM-DD HH:mm"):""),s.append("img_return",e.value.img_return?"ada":""),s.append("img_return_file",e.value.img_return_file),s.append("img_return_ts",e.value.img_return_ts?g(e.value.img_return_ts).format("YYYY-MM-DD HH:mm"):""),s.append("img_till",e.value.img_till?"ada":""),s.append("img_till_file",e.value.img_till_file),s.append("img_till_ts",e.value.img_till_ts?g(e.value.img_till_ts).format("YYYY-MM-DD HH:mm"):""),s.append("ritase_note",e.value.ritase_note);let a="post",p=d.id;p==0||(s.append("id",p),s.append("_method","PUT"));const{data:u,error:v,status:c}=await H("/trx_trp/absen",{method:a,headers:{Authorization:`Bearer ${y.value}`,Accept:"application/json"},body:s,retry:0});if(h().loading_full=!1,c.value==="error"){Y().trigger(v,n);return}if(e.value.ritase_leave_at=e.value.img_leave_ts,e.value.ritase_arrive_at=e.value.img_arrive_ts,e.value.ritase_return_at=e.value.img_return_ts,e.value.ritase_till_at=e.value.img_till_ts,e.value.updated_at=u.value.updated_at,d.id<=0)e.value.id=u.value.id,e.value.created_at=u.value.created_at,d.p_data.unshift(e.value);else{let i=d.p_data.map(x=>x.id).indexOf(d.id);i>=-1&&d.p_data.splice(i,1,{...e.value})}d.fnClose()};return(s,a)=>{const p=D,u=$("vue-date-picker"),v=F,c=j;return M((f(),b("section",O,[t("div",null,[r(p,{title:"Form Check Absen",fn:m.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",z,[t("div",J,[t("div",L,[t("div",null,[G,t("div",Q,o(l(e).id),1)]),t("div",null,[R,t("div",X,o(l(e).tanggal?l(g)(l(e).tanggal).format("DD-MM-YYYY"):""),1)]),t("div",null,[Z,t("div",ee,o(l(e).jenis),1)]),t("div",null,[te,t("div",le,o(l(e).supir),1)]),l(e).kernet?(f(),b("div",ie,[ae,t("div",se,o(l(e).kernet),1)])):S("",!0),t("div",null,[oe,t("div",re,o(l(e).no_pol),1)]),t("div",null,[_e,t("div",ne,o(l(e).xto),1)]),t("div",null,[de,t("div",me,o(l(e).tipe),1)])])]),t("div",ue,[t("div",pe,[t("div",ve,[ce,r(v,null,{default:w(()=>[r(u,{modelValue:l(e).img_leave_ts,"onUpdate:modelValue":a[0]||(a[0]=i=>l(e).img_leave_ts=i),type:"datetime",format:"dd-MM-yyyy HH:mm","enable-time-picker":!0,"text-input":"","teleport-center":"",class:"flex-grow",placeholder:"Waktu Berangkat"},null,8,["modelValue"])]),_:1}),t("p",ge,o(l(n).img_leave_ts),1),r(c,{value:l(e).img_leave,onSetFile:a[1]||(a[1]=i=>l(e).img_leave_file=i),onSetPreview:a[2]||(a[2]=i=>l(e).img_leave=i),can_remove:!0},null,8,["value"]),t("p",fe,o(l(n).img_leave),1),l(e).img_leaves.length>1?(f(),b("div",be,[(f(!0),b(N,null,U(l(e).img_leaves,i=>(f(),b("div",xe,[t("img",{class:"w-full cursor-pointer",src:i.gambar,onClick:x=>(l(e).img_leave=i.gambar,l(e).img_leave_file="")},null,8,we)]))),256))])):S("",!0)])]),t("div",he,[t("div",ye,[ke,r(v,null,{default:w(()=>[r(u,{modelValue:l(e).img_arrive_ts,"onUpdate:modelValue":a[3]||(a[3]=i=>l(e).img_arrive_ts=i),type:"datetime",format:"dd-MM-yyyy HH:mm","enable-time-picker":!0,"text-input":"","teleport-center":"",class:"flex-grow",placeholder:"Waktu Tiba"},null,8,["modelValue"])]),_:1}),t("p",Me,o(l(n).img_arrive_ts),1),r(c,{value:l(e).img_arrive,onSetFile:a[4]||(a[4]=i=>l(e).img_arrive_file=i),onSetPreview:a[5]||(a[5]=i=>l(e).img_arrive=i),can_remove:!0},null,8,["value"]),t("p",Se,o(l(n).img_arrive),1)])]),t("div",Ye,[t("div",He,[Ve,r(v,null,{default:w(()=>[r(u,{modelValue:l(e).img_return_ts,"onUpdate:modelValue":a[6]||(a[6]=i=>l(e).img_return_ts=i),type:"datetime",format:"dd-MM-yyyy HH:mm","enable-time-picker":!0,"text-input":"","teleport-center":"",class:"flex-grow",placeholder:"Waktu Kembali"},null,8,["modelValue"])]),_:1}),t("p",Ce,o(l(n).img_return_ts),1),r(c,{value:l(e).img_return,onSetFile:a[7]||(a[7]=i=>l(e).img_return_file=i),onSetPreview:a[8]||(a[8]=i=>l(e).img_return=i),can_remove:!0},null,8,["value"]),t("p",De,o(l(n).img_return),1)])]),t("div",Fe,[t("div",je,[Ae,r(v,null,{default:w(()=>[r(u,{modelValue:l(e).img_till_ts,"onUpdate:modelValue":a[9]||(a[9]=i=>l(e).img_till_ts=i),type:"datetime",format:"dd-MM-yyyy HH:mm","enable-time-picker":!0,"text-input":"","teleport-center":"",class:"flex-grow",placeholder:"Waktu Sampai"},null,8,["modelValue"])]),_:1}),t("p",Be,o(l(n).img_till_ts),1),r(c,{value:l(e).img_till,onSetFile:a[10]||(a[10]=i=>l(e).img_till_file=i),onSetPreview:a[11]||(a[11]=i=>l(e).img_till=i),can_remove:!0},null,8,["value"]),t("p",$e,o(l(n).img_till),1)])]),t("div",Pe,[Ne,M(t("textarea",{"onUpdate:modelValue":a[12]||(a[12]=i=>l(e).ritase_note=i)},null,512),[[I,l(e).ritase_note]])])]),t("div",Ue,[t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:a[13]||(a[13]=i=>m.fnClose())}," Cancel "),t("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:a[14]||(a[14]=T(i=>C(),["prevent"]))}," Save ")])])])],512)),[[P,m.show]])}}},Qe=K(Ie,[["__scopeId","data-v-2d6b0197"]]);export{Qe as default};
