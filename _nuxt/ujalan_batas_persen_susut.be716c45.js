import{_ as P}from"./HeaderPopup.vue.6d5d622c.js";import{_ as U}from"./InputPointFormat.vue.09dd03a6.js";import{_ as F}from"./WidthMiniList.vue.25819a38.js";import{r as w,g as K,i as T,f as M,k as O,K as V,o as C,c as J,a as e,b as x,t as d,l as o,A as L,C as z,n as E,x as v,y as g,p as H,e as R}from"./entry.bb254157.js";import{u as k}from"./useUtils.aa8346c8.js";import{u as S}from"./useMyFetch.8d074570.js";import{_ as W}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.77ef99a0.js";import"./WidthMiniPart.vue.f24047d5.js";const p=c=>(H("data-v-15b2e941"),c=c(),R(),c),G={class:"box-fixed"},Q={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},X={class:"w-full flex flex-col items-center grow overflow-auto"},Y={class:"w-full flex flex-row flex-wrap"},Z={class:"w-full sm:w-8/12 md:w-6/12 lg:w-5/12 flex flex-col flex-wrap p-1"},ee=p(()=>e("label",{for:""},"To",-1)),te={class:"card-border disabled"},se={class:"w-1/2 sm:w-4/12 md:w-3/12 lg:w-1/12 flex flex-col flex-wrap p-1"},ae=p(()=>e("label",{for:""},"Jenis",-1)),oe={class:"card-border disabled"},ie={class:"w-1/2 sm:w-4/12 md:w-3/12 lg:w-2/12 flex flex-col flex-wrap p-1"},ne=p(()=>e("label",{for:""},"Trip Bonus Supir",-1)),le={class:"w-full"},re={class:"text-red-500"},_e={class:"w-1/2 sm:w-3/12 md:w-3/12 lg:w-2/12 flex flex-col flex-wrap p-1"},ue=p(()=>e("label",{for:""},"Trip Bonus Kernet",-1)),de={class:"w-full"},pe={class:"text-red-500"},ce={class:"w-1/2 sm:w-3/12 md:w-3/12 lg:w-2/12 flex flex-col flex-wrap p-1"},fe=p(()=>e("label",{for:""},"Asal Peralihan",-1)),ve={class:"card-border disabled"},me={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},be=p(()=>e("label",{for:""},"Tipe",-1)),we={class:"card-border disabled"},xe={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},he=p(()=>e("label",{for:""},"Ket. Untuk Remarks",-1)),ye={class:"card-border disabled"},ge={class:"w-1/2 sm:w-3/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},ke=p(()=>e("label",{for:""},"Batas % Susut",-1)),Se={class:"w-full"},Be={class:"text-red-500"},Ne={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},je=p(()=>e("label",{for:""},"Dest. Location",-1)),Te={class:"text-red-500"},Oe={class:"w-full flex items-center justify-end"},Ce={__name:"ujalan_batas_persen_susut",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(c){const u=c,{pointFormat:n}=k(),B={id:-1,xto:"",km_range:0,bonus_trip_supir:0,bonus_trip_kernet:0,batas_persen_susut:"",tipe:"",jenis:"",harga:0,note_for_remarks:"",transition_from:""},a=w({...B}),h=K("token"),f=w({}),A=async()=>{v().loading_full=!0,f.value={};const i=new FormData;i.append("batas_persen_susut",a.value.batas_persen_susut),i.append("bonus_trip_supir",a.value.bonus_trip_supir),i.append("bonus_trip_kernet",a.value.bonus_trip_kernet),i.append("destination_location_id",l.value.id);let t="post",r=u.is_copy?0:u.id;r==0||(i.append("id",r),i.append("_method","PUT"));const{data:s,error:y,status:_}=await S("/ujalan/batas_persen_susut",{method:t,headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},body:i,retry:0});if(v().loading_full=!1,_.value==="error"){g().trigger(y,f);return}if(a.value.destination_location=JSON.parse(JSON.stringify(l.value._raw)),r<=0)a.value.id=s.value.id,a.value.created_at=s.value.created_at,a.value.updated_at=s.value.updated_at,u.p_data.unshift(a.value);else{a.value.updated_at=s.value.updated_at;let j=u.p_data.map(D=>D.id).indexOf(r);j>-1&&u.p_data.splice(j,1,{...a.value})}u.fnClose()},m=T(()=>!1),I=async()=>{v().loading_full=!0;const{data:i,error:t,status:r}=await S("/ujalan_",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},params:{id:u.id},retry:0});if(v().loading_full=!1,r.value==="error"){g().trigger(t);return}a.value=i.value.data;let s=i.value.data;u.is_copy&&(a.value.val=0,a.value.val1=0),l.value._raw=s.destination_location,l.value._.id.val=s.destination_location.id,l.value._.xto.val=s.destination_location.xto,l.value._.min_trip.val=n(s.destination_location.min_trip),l.value._.bonus_trip_supir.val=n(s.destination_location.bonus_trip_supir),l.value._.bonus_next_trip_supir.val=n(s.destination_location.bonus_next_trip_supir),l.value._.bonus_trip_kernet.val=n(s.destination_location.bonus_trip_kernet),l.value._.bonus_next_trip_kernet.val=n(s.destination_location.bonus_next_trip_kernet),l.value.id=s.destination_location.id,l.value.name=s.destination_location.xto,l.value.title=n(s.destination_location.total)||""},b={_raw:{},_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},xto:{tcon:"IconsLocationOn",text:"Tujuan",val:""},min_trip:{tcon:"",text:"Min Trip",val:""},bonus_trip_supir:{tcon:"",text:"Bonus Trip Supir",val:""},bonus_next_trip_supir:{tcon:"",text:"Bonus Next Trip Supir",val:""},bonus_trip_kernet:{tcon:"",text:"Bonus Trip Kernet",val:""},bonus_next_trip_kernet:{tcon:"",text:"Bonus Next Trip Kernet",val:""}},id:"",name:"",title:"",note:""},l=w(JSON.parse(JSON.stringify(b))),N=w([]),$=async()=>{v().loading_full=!0;const{data:i,error:t,status:r}=await S("/ujalan/load_local",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},retry:0});if(v().loading_full=!1,r.value==="error"){g().trigger(t);return}N.value=i.value.list_destination_location},q=T(()=>{let i=[];return N.value.forEach((t,r)=>{let s=JSON.parse(JSON.stringify(b));s._.id.val=t.id,s._.xto.val=t.xto,s._.min_trip.val=n(t.minimal_trip),s._.bonus_trip_supir.val=n(t.bonus_trip_supir),s._.bonus_next_trip_supir.val=n(t.bonus_next_trip_supir),s._.bonus_trip_kernet.val=n(t.bonus_trip_kernet),s._.bonus_next_trip_kernet.val=n(t.bonus_next_trip_kernet),s.id=t.id,s.name=t.xto,s.title="Min Trip:"+(n(t.minimal_trip)||"")+" | Bonus Trip Supir:"+(n(t.bonus_trip_supir)||"")+" | Bonus Next Trip Supir:"+(n(t.bonus_next_trip_supir)||"")+" | Bonus Trip Kernet:"+(n(t.bonus_trip_kernet)||"")+" | Bonus Next Trip Kernet:"+(n(t.bonus_next_trip_kernet)||""),s._raw=t,i.push(JSON.parse(JSON.stringify(s)))}),i});return M(()=>u.show,async(i,t)=>{i==!0&&(await $(),a.value={...B},l.value=JSON.parse(JSON.stringify(b)),u.id!=0&&I())},{immediate:!0}),(i,t)=>{const r=P,s=U,y=F;return O((C(),J("section",G,[e("div",null,[x(r,{title:"Form Batas Persen Susut",fn:c.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",Q,[e("div",X,[e("div",Y,[e("div",Z,[ee,e("div",te,d(o(a).xto),1)]),e("div",se,[ae,e("div",oe,d(o(a).jenis),1)]),e("div",ie,[ne,e("div",le,[x(s,{class:"w-full h-full p-1",type:"text",value:o(a).bonus_trip_supir||0,onInput:t[0]||(t[0]=_=>o(a).bonus_trip_supir=_),disabled:!("useUtils"in i?i.useUtils:o(k))().checkPermissions(["ujalan.create","ujalan.modify"])||o(m)},null,8,["value","disabled"])]),e("p",re,d(o(f).bonus_trip_supir),1)]),e("div",_e,[ue,e("div",de,[x(s,{class:"w-full h-full p-1",type:"text",value:o(a).bonus_trip_kernet||0,onInput:t[1]||(t[1]=_=>o(a).bonus_trip_kernet=_),disabled:!("useUtils"in i?i.useUtils:o(k))().checkPermissions(["ujalan.create","ujalan.modify"])||o(m)},null,8,["value","disabled"])]),e("p",pe,d(o(f).bonus_trip_kernet),1)]),e("div",ce,[fe,e("div",ve,d(o(a).transition_from),1)]),e("div",me,[be,e("div",we,d(o(a).tipe),1)]),e("div",xe,[he,e("div",ye,d(o(a).note_for_remarks),1)]),e("div",ge,[ke,e("div",Se,[O(e("input",{"onUpdate:modelValue":t[2]||(t[2]=_=>o(a).batas_persen_susut=_)},null,512),[[L,o(a).batas_persen_susut]])]),e("p",Be,d(o(f).batas_persen_susut),1)]),e("div",Ne,[je,x(y,{arr:o(q),selected:o(l),pure:b,onSetSelected:t[3]||(t[3]=_=>l.value=_),disabled:o(m)},null,8,["arr","selected","disabled"]),e("p",Te,d(o(f).destination_location_id),1)])])]),e("div",Oe,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:t[4]||(t[4]=_=>c.fnClose())}," Cancel "),o(m)?E("",!0):(C(),J("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:t[5]||(t[5]=z(_=>A(),["prevent"]))}," Save "))])])])],512)),[[V,c.show]])}}},Ke=W(Ce,[["__scopeId","data-v-15b2e941"]]);export{Ke as default};
