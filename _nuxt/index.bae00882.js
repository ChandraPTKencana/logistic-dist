import{r,f as W,g as Ce,h as Se,i as T,j as X,s as Oe,c as w,b as _,a as u,k as ee,v as Te,l,m as te,n as $,d as h,w as m,q as $e,x as c,y as z,o as d,z as D,t as A,A as Be,B as J,_ as Y}from"./entry.80f9400f.js";import Me from"./Header.d832b074.js";import Ee from"./Plus.ff7cfb63.js";import Ie from"./Edit.8ba83185.js";import Ne from"./Eyes.35a34929.js";import ze from"./Delete.fbe43ce9.js";import Fe from"./Signature.b3ac5cb1.js";import Ve from"./Table2Column.1f2f6325.js";import Le from"./Line.0d89352b.js";import je from"./Check.2d47ab0b.js";import Ue from"./TypeIcon.4c0c86a7.js";import He from"./TableView.85942596.js";import{u as k}from"./useUtils.4905e334.js";import{u as F}from"./useMyFetch.a3705501.js";import{u as Re}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./DocJPEG.62f0606b.js";import"./DocJPG.f38d5a18.js";import"./DocPNG.f9fc022c.js";import"./DocPDF.54be9be6.js";import"./Search.e94f12c9.js";import"./Adjust.bbeeda20.js";import"./TableHeaderEye.75695600.js";import"./Times.533e4a65.js";import"./ClearAll.84555876.js";import"./client-only.b5fd6b3a.js";import"./ClearEach.3dd0da5e.js";import"./CaretLeftDoubleBold.8dc8d473.js";import"./CaretLeftBold.1ba5db7b.js";import"./CaretRightBold.b313526e.js";import"./CaretRightDoubleBold.22e21eb5.js";const Je=J(()=>Y(()=>import("./PopupMini.8abf2423.js"),["./PopupMini.8abf2423.js","./PopupMini.vue.9a484447.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./Exclamation.44603bae.js"],import.meta.url).then(v=>v.default||v)),Ye=J(()=>Y(()=>import("./salary_bonus.1126eada.js"),["./salary_bonus.1126eada.js","./HeaderPopup.vue.def29a01.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./client-only.b5fd6b3a.js","./WidthMiniList.vue.0c640245.js","./WidthMiniPart.vue.1a42f0c4.js","./InputPointFormat.vue.53b3b8a4.js","./AttachmentSingle.62897b4d.js","./PDFJsView.4b00c268.js","./PDFJsView.4e9fad9f.css","./useMyFetch.a3705501.js"],import.meta.url).then(v=>v.default||v)),qe=J(()=>Y(()=>import("./salary_bonus_validasi.fc2c4e23.js"),["./salary_bonus_validasi.fc2c4e23.js","./HeaderPopup.vue.def29a01.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./WidthMiniPart.vue.1a42f0c4.js","./AttachmentSingle.62897b4d.js","./PDFJsView.4b00c268.js","./PDFJsView.4e9fad9f.css","./useUtils.4905e334.js","./useMyFetch.a3705501.js"],import.meta.url).then(v=>v.default||v)),Ge={class:"w-full h-full flex flex-col"},Ke={class:"w-full flex grow flex-col overflow-auto h-0"},Ze={class:"w-full flex justify-between flex-wrap"},Qe={class:"grow flex"},We={class:"m-1"},Xe=u("option",{value:"undone"},"Undone",-1),et=u("option",{value:"done"},"Done",-1),tt=u("option",{value:"deleted"},"Trash",-1),at=u("option",{value:"all"},"All",-1),lt=[Xe,et,tt,at],ot=u("span",{class:"text-xs ml-1"}," Download ",-1),st={style:{"min-width":"350px","text-wrap":"wrap"}},nt={class:"grow mb-5"},Vt={__name:"index",async setup(v){let B,q;const ae=a=>a.deleted==1?"!bg-red-400":a.val1>0&&a.val2>0&&a.val3>0&&a.salary_paid_id>0?"!bg-blue-300":"",f=r("undone");W(()=>f.value,a=>{Z()},{immediate:!1});const s={};s._TimeZoneOffset=new Date().getTimezoneOffset(),s.sort="created_at:desc";const M=Ce("token"),{data:le}=([B,q]=Se(async()=>$e(async()=>{let a=[];c().loading_full=!0;const{data:e,error:y,status:O}=await F("/salary_bonuses",{method:"get",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},params:{filter_status:f},retry:0});return c().loading_full=!1,O.value==="error"?(z().trigger(y),{salary_bonuses:a}):(a=e.value.data,{salary_bonuses:a})},"$tya7A7egnO")),B=await B,q(),B),n=r(le.value.salary_bonuses);r("");const V=r({field:"created_at",by:"desc"}),o=r(-1),b=T(()=>n.value[o.value]),p=r({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),G=()=>{s.like="";let a=JSON.parse(JSON.stringify(c()._tv.global_keyword));a!=""&&(s.like=`id:%${a}%,employee_name:%${a}%`),s.sort="",V.value.field&&(s.sort=V.value.field+":"+V.value.by),s.filter_model=JSON.stringify(c()._tv.filter_model)},K=async()=>{c().loading_full=!0,p.value.may_get_data=!1,s.page=p.value.page,s.page==1&&(n.value=[]),s.first_row&&delete s.first_row,s.page>1&&(s.first_row=JSON.stringify(n.value[0])),s.filter_status=f.value;const{data:a,error:e,status:y}=await F("/salary_bonuses",{method:"get",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},params:s,retry:0});if(c().loading_full=!1,p.value.may_get_data=!0,y.value==="error"){z().trigger(e);return}p.value.page==1?n.value=a.value.data:p.value.page>1&&(n.value=[...n.value,...a.value.data]),a.value.data.length==0&&(p.value.is_last_record=!0),c()._tv.filter_box=!1},Z=()=>{o.value=-1,o.value=-1,p.value.page=1,p.value.is_last_record=!1,G(),K()},E=r(!1),L=r(0),P=r(0),C=r(!1),oe=()=>{L.value=0,C.value=!1,P.value=!1,E.value=!0},{display:I}=X();Oe(X());const se=()=>{o.value==-1?I({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(L.value=n.value[o.value].id,C.value=!1,P.value=!1,E.value=!0)},N=r(!1),j=r(0),ne=()=>{o.value==-1?I({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(j.value=n.value[o.value].id,C.value=!1,P.value=!1,N.value=!0)},re=()=>{o.value==-1?I({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(j.value=n.value[o.value].id,C.value=!0,P.value=!1,N.value=!0)},U=r(!1),Q=r({}),S=r(!1),x=r(""),ie=async()=>{S.value&&(S.value=!1)},ue=()=>{o.value==-1?I({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(x.value="",Q.value={id:n.value[o.value].id},S.value=!0)};W(()=>x.value,a=>{a.trim().length>0?U.value=!0:U.value=!1},{immediate:!1});const _e=async()=>{c().loading_full=!0;const a=new FormData;a.append("id",n.value[o.value].id),a.append("deleted_reason",x.value),a.append("_method","DELETE");const{data:e,error:y,status:O}=await F("/salary_bonus",{method:"post",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},body:a,retry:0});if(c().loading_full=!1,O.value==="error"){z().trigger(y);return}let g={...n.value[o.value]};g.deleted=e.value.deleted,g.deleted_user=e.value.deleted_user,g.deleted_at=e.value.deleted_at,g.deleted_by=e.value.deleted_by,g.deleted_reason=e.value.deleted_reason,f.value!="all"?n.value.splice(o.value,1):n.value.splice(o.value,1,{...g}),o.value=-1,S.value=!1},de=r([{key:"no",label:"No",isai:!0},{key:"val",label:"APP",childs:[{key:"val1",label:"Staff",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val2",label:"SPV",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val3",label:"MGR",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]}]},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"tanggal",label:"Tanggal",type:"date",dateformat:"DD-MM-Y",filter_on:1,sort:{priority:1,type:"desc"}},{key:"type",label:"Tipe",filter_on:1,type:"string"},{key:"employee_name",label:"Nama",freeze:1,filter_on:1,type:"string"},{key:"employee_ktp_no",label:"No KTP",filter_on:1,type:"string"},{key:"employee_sim_no",label:"No SIM",filter_on:1,type:"string"},{key:"nominal",label:"Nominal",class:" justify-end",type:"number"},{key:"note",label:"Note",filter_on:1,type:"string"},{key:"attachment_1_type",label:"File",filter_on:1,type:"string"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]),me=T(()=>["undone","all"].indexOf(f.value)>-1&&k().checkPermission("salary_bonus.create")),ce=T(()=>o.value>-1&&[void 0,0].indexOf(b.value.deleted)>-1&&(k().checkPermission("salary_bonus.val1")&&[void 0,0,1].indexOf(b.value.val1)>-1||k().checkPermission("salary_bonus.val2")&&[void 0,0].indexOf(b.value.val2)>-1)&&k().checkPermissions(["salary_bonus.modify"])),pe=T(()=>o.value>-1&&[void 0,0].indexOf(b.value.deleted)>-1&&(k().checkPermission("salary_bonus.val1")&&[void 0,0].indexOf(b.value.val1)>-1||k().checkPermission("salary_bonus.val2")&&[void 0,0].indexOf(b.value.val2)>-1||k().checkPermission("salary_bonus.val3")&&[void 0,0].indexOf(b.value.val3)>-1)),ve=T(()=>o.value>-1&&k().checkPermission("salary_bonus.remove")&&[void 0,0].indexOf(b.value.deleted)>-1),{downloadFile:fe,viewFile:rt}=Re(),ye=async()=>{G(),c().loading_full=!0,s.filter_status=f.value;const{data:a,error:e,status:y}=await F("/salary_bonus/download_excel",{method:"get",headers:{Authorization:`Bearer ${M.value}`,Accept:"application/json"},params:s,retry:0});if(c().loading_full=!1,y.value==="error"){z().trigger(e);return}fe(a.value)};return(a,e)=>{const y=Me,O=Ee,g=Ie,be=Ne,ge=ze,ke=Fe,he=Ve,H=Le,R=je,xe=Ue,we=He,De=Je,Ae=Ye,Pe=qe;return d(),w("div",Ge,[_(y,{title:"List Salary Additional"}),u("div",Ke,[u("div",Ze,[u("div",Qe,[u("div",We,[ee(u("select",{class:"","onUpdate:modelValue":e[0]||(e[0]=t=>te(f)?f.value=t:null)},lt,512),[[Te,l(f)]])]),l(me)?(d(),w("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[1]||(e[1]=t=>oe())},[_(O)])):$("",!0),l(ce)?(d(),w("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[2]||(e[2]=t=>se())},[_(g)])):$("",!0),l(o)>-1?(d(),w("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[3]||(e[3]=t=>re())},[_(be)])):$("",!0),l(ve)?(d(),w("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[4]||(e[4]=t=>ue())},[_(ge)])):$("",!0),l(pe)?(d(),w("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[5]||(e[5]=t=>ne())},[_(ke)])):$("",!0),u("button",{type:"button",name:"button",class:"m-1 text-2xl flex items-center",onClick:e[6]||(e[6]=t=>ye())},[_(he),h(),ot])])]),_(we,{thead:l(de),selected:l(o),onSetSelected:e[7]||(e[7]=t=>o.value=t),tbody:l(n),fnCallData:K,scrolling:l(p),onSetScrollingPage:e[8]||(e[8]=t=>l(p).page=t),onDoFilter:e[9]||(e[9]=t=>Z()),rowBgColor:ae},{val1:m(({item:t})=>[t.val1?(d(),D(R,{key:1})):(d(),D(H,{key:0}))]),val2:m(({item:t})=>[t.val2?(d(),D(R,{key:1})):(d(),D(H,{key:0}))]),val3:m(({item:t})=>[t.val3?(d(),D(R,{key:1})):(d(),D(H,{key:0}))]),employee_name:m(({item:t})=>{var i;return[h(A((i=t.employee)==null?void 0:i.name),1)]}),employee_ktp_no:m(({item:t})=>{var i;return[h(A((i=t.employee)==null?void 0:i.ktp_no),1)]}),employee_sim_no:m(({item:t})=>{var i;return[h(A((i=t.employee)==null?void 0:i.sim_no),1)]}),note:m(({item:t})=>[u("div",st,A(t.note),1)]),attachment_1_type:m(({item:t})=>[_(xe,{value:t.attachment_1_type},null,8,["value"])]),deleted_by_username:m(({item:t})=>{var i;return[h(A((i=t.deleted_by)==null?void 0:i.username),1)]}),req_deleted_by_username:m(({item:t})=>{var i;return[h(A((i=t.req_deleted_by)==null?void 0:i.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])]),_(De,{type:"delete",show:l(S),data:l(Q),fnClose:ie,fnConfirm:_e,enabledOk:l(U)},{footer:m(()=>[h(" Masukkan Alasan Penghapusan: "),u("div",nt,[ee(u("textarea",{"onUpdate:modelValue":e[10]||(e[10]=t=>te(x)?x.value=t:null)},null,512),[[Be,l(x)]])])]),_:1},8,["show","data","enabledOk"]),_(Ae,{show:l(E),fnClose:()=>{E.value=!1},id:l(L),p_data:l(n),is_copy:l(P)},null,8,["show","fnClose","id","p_data","is_copy"]),_(Pe,{show:l(N),fnClose:()=>{N.value=!1},id:l(j),p_data:l(n),is_view:l(C)},null,8,["show","fnClose","id","p_data","is_view"])])}}};export{Vt as default};
