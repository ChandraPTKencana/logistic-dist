import{_ as Z}from"./HeaderPopup.vue.b7f02079.js";import{_ as tt}from"./client-only.212d9ba9.js";import{r as F,g as et,i,f as st,I as at,k as U,J as ot,o as p,c,a as t,b as V,l as e,t as o,w as nt,m as lt,A as rt,n as g,d as u,F as K,D as _t,C as ut,G as it,x as E,y as R}from"./entry.48b3d933.js";import{u as q}from"./useUtils.14d22b9a.js";import{u as Y}from"./useMyFetch.2a06d70a.js";import"./Times.834f5337.js";import"./_plugin-vue_export-helper.c27b6911.js";const pt={class:"box-fixed"},ct={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},dt={class:"w-full flex flex-col items-center grow overflow-auto"},mt={class:"w-full flex flex-row flex-wrap"},ht={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ft=t("label",{for:""},"Period End",-1),vt={key:0,class:"card-border"},yt={key:1},bt={class:"text-red-500"},wt={key:0,class:"w-full sm:w-6/12 md:w-4/12 lg:w-4/12 p-1"},kt=t("div",{class:"font-bold"}," Filter Nama ",-1),xt={key:0,class:"w-full flex p-1 justify-between flex-wrap"},jt={class:"w-full",role:"sticky"},Ft={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},gt=t("tr",{class:"sticky -top-1 !z-[2]"},[t("td",{colspan:"30",class:"!bg-slate-800 text-white font-bold"}," Detail ")],-1),Et={class:"sticky top-7 !z-[2]"},Mt=t("th",{rowspan:"2"},"No",-1),Ct=t("th",{rowspan:"2"},"ID",-1),Dt=t("th",{rowspan:"2"},"Nama Pekerja",-1),Nt=t("th",{rowspan:"2"},"Jabatan",-1),Pt=t("th",{rowspan:"2"},"Tmpt Lahir",-1),St=t("th",{rowspan:"2"},"Tgl Lahir",-1),Tt=t("th",{rowspan:"2"},"TMK",-1),Bt=t("th",{rowspan:"2"},"No KTP",-1),At=t("th",{rowspan:"2"},"Alamat",-1),Vt=t("th",{rowspan:"2"},"Status",-1),qt=t("th",{rowspan:"2"},"No Rek",-1),Lt=t("th",{rowspan:"2"},"Nama Rek",-1),$t=t("th",{rowspan:"2"},"Nama Bank",-1),Gt={colspan:"3"},zt={class:"text-sm"},Jt={colspan:"3"},Ut={class:"text-sm"},Kt={colspan:"3"},Rt={class:"text-sm"},Yt={rowspan:"2"},It={class:"text-sm"},Ot={rowspan:"2"},Ht={class:"text-sm"},Qt={rowspan:"2"},Wt={class:"text-sm"},Xt={rowspan:"2"},Zt={class:"text-sm"},te={rowspan:"2"},ee={class:"text-sm"},se={rowspan:"2"},ae={class:"text-sm"},oe={rowspan:"2"},ne={class:"text-sm"},le={rowspan:"2"},re={class:"text-sm"},_e={class:"sticky top-[60px] !z-[2]"},ue={class:"text-sm"},ie={class:"text-sm"},pe={class:"text-sm"},ce={class:"text-sm"},de={class:"text-sm"},me={class:"text-sm"},he={class:"text-sm"},fe={class:"text-sm"},ve={class:"text-sm"},ye={ref:"to_move"},be=["data-index"],we={class:"w-full flex items-center justify-end"},Ce={__name:"rpt_salary",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(y){const m=y,{$moment:b}=it(),{pointFormat:l}=q(),L={id:"",period_end:new Date},r=F({...L}),$=et("token"),w=F({}),_=F([]),I=async()=>{E().loading_full=!0,w.value={};const s=new FormData;s.append("period_end",r.value.period_end?b(r.value.period_end).format("Y-MM"):"");let n="post",d=r.value.id;d==""||(s.append("id",d),s.append("_method","PUT"));const{data:h,error:A,status:a}=await Y("/rpt_salary",{method:n,headers:{Authorization:`Bearer ${$.value}`,Accept:"application/json"},body:s,retry:0});if(E().loading_full=!1,a.value==="error"){R().trigger(A,w);return}if(_.value=h.value.details,d<=0)r.value.id=h.value.id,r.value.created_at=h.value.created_at,r.value.updated_at=h.value.updated_at,m.p_data.unshift(r.value);else{r.value.updated_at=h.value.updated_at;let f=m.p_data.map(X=>X.id).indexOf(d);f>=-1&&m.p_data.splice(f,1,{...r.value})}};i(()=>{let s=0;return _.value.forEach(n=>{s+=parseFloat(n.standby_nominal)}),s});const M=i(()=>{let s=0;return _.value.forEach(n=>{s+=parseFloat(n.sb_gaji)}),s}),C=i(()=>{let s=0;return _.value.forEach(n=>{s+=parseFloat(n.sb_makan)}),s}),D=i(()=>{let s=0;return _.value.forEach(n=>{s+=parseFloat(n.sb_dinas)}),s}),k=i(()=>{let s=0;return _.value.forEach(n=>{s+=parseFloat(n.sb_gaji_2)}),s}),x=i(()=>{let s=0;return _.value.forEach(n=>{s+=parseFloat(n.sb_makan_2)}),s}),j=i(()=>{let s=0;return _.value.forEach(n=>{s+=parseFloat(n.sb_dinas_2)}),s}),N=i(()=>{let s=0;return _.value.forEach(n=>{s+=parseFloat(n.uj_gaji)}),s}),P=i(()=>{let s=0;return _.value.forEach(n=>{s+=parseFloat(n.uj_makan)}),s}),S=i(()=>{let s=0;return _.value.forEach(n=>{s+=parseFloat(n.uj_dinas)}),s}),O=i(()=>{let s=0;return _.value.forEach(n=>{s+=parseFloat(n.employee_bpjs_kesehatan)}),s}),H=i(()=>{let s=0;return _.value.forEach(n=>{s+=parseFloat(n.employee_bpjs_jamsos)}),s}),G=i(()=>{let s=0;return _.value.forEach(n=>{s+=parseFloat(n.nominal_cut)}),s}),z=i(()=>{let s=0;return _.value.forEach(n=>{s+=parseFloat(n.salary_bonus_nominal)}),s}),T=i(()=>{let s=0;return _.value.forEach(n=>{s+=parseFloat(n.salary_bonus_nominal_2)}),s}),B=i(()=>{let s=0;return _.value.forEach(n=>{s+=parseFloat(n.kerajinan)}),s}),Q=i(()=>r.value.val&&r.value.val1||q().checkPermission("rpt_salary.val")&&r.value.val||q().checkPermission("rpt_salary.val1")&&r.value.val1),W=async()=>{E().loading_full=!0;const{data:s,error:n,status:d}=await Y("/rpt_salary",{method:"get",headers:{Authorization:`Bearer ${$.value}`,Accept:"application/json"},params:{id:m.id},retry:0});if(E().loading_full=!1,d.value==="error"){R().trigger(n);return}r.value=s.value.data,m.is_copy&&(r.value.val=0,r.value.val1=0),_.value=s.value.data.details},v=F(""),J=i(()=>v.value!=""?_.value.filter(s=>s.employee.name.toLowerCase().includes(v.value.toLowerCase())):_.value);return st(()=>m.show,(s,n)=>{s==!0&&(r.value={...L},_.value=[],w.value={},m.id!=0&&W())},{immediate:!0}),(s,n)=>{const d=Z,h=at("vue-date-picker"),A=tt;return U((p(),c("section",pt,[t("div",null,[V(d,{title:"Form Salary Paid",fn:y.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",ct,[t("div",dt,[t("div",mt,[t("div",ht,[ft,e(r).id?(p(),c("div",vt,o(e(b)(e(r).period_end).format("MM-Y")),1)):(p(),c("div",yt,[V(A,null,{default:nt(()=>[V(h,{modelValue:e(r).period_end,"onUpdate:modelValue":n[0]||(n[0]=a=>e(r).period_end=a),format:"MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"","month-picker":""},null,8,["modelValue"])]),_:1})])),t("p",bt,o(e(w).period_end),1)]),e(_).length?(p(),c("div",wt,[kt,U(t("input",{class:"",type:"text","onUpdate:modelValue":n[1]||(n[1]=a=>lt(v)?v.value=a:null),name:"search",placeholder:"Nama"},null,512),[[rt,e(v)]])])):g("",!0)]),e(J).length?(p(),c("div",xt,[t("div",jt,[t("table",Ft,[t("thead",null,[gt,t("tr",Et,[Mt,Ct,Dt,Nt,Pt,St,Tt,Bt,At,Vt,qt,Lt,$t,t("th",Gt,[u("Standby 1 "),t("span",zt,"("+o(e(l)(e(M)+e(C)+e(D)||0))+")",1)]),t("th",Jt,[u("Standby 2 "),t("span",Ut,"("+o(e(l)(e(k)+e(x)+e(j)||0))+")",1)]),t("th",Kt,[u("Trip "),t("span",Rt,"("+o(e(l)(e(N)+e(P)+e(S)||0))+")",1)]),t("th",Yt,[u("Potongan Trip "),t("span",It,"("+o(e(l)(e(G)||0))+")",1)]),t("th",Ot,[u("Potongan Lainnya "),t("span",Ht,"("+o(e(l)(e(z)||0))+")",1)]),t("th",Qt,[u("Potongan Lainnya 2 "),t("span",Wt,"("+o(e(l)(e(T)||0))+")",1)]),t("th",Xt,[u("BPJS Kesehatan "),t("span",Zt,"("+o(e(l)(e(O)||0))+")",1)]),t("th",te,[u("BPJS Jamsos "),t("span",ee,"("+o(e(l)(e(H)||0))+")",1)]),t("th",se,[u("U.Kerajinan "),t("span",ae,"("+o(e(l)(e(B)||0))+")",1)]),t("th",oe,[u("Grand Total "),t("span",ne,"("+o(e(l)(e(M)+e(C)+e(D)+e(k)+e(x)+e(j)+e(N)+e(P)+e(S)-e(G)+e(z)+e(T)+e(B)||0))+")",1)]),t("th",le,[u("Total Periode 2 "),t("span",re,"("+o(e(l)(e(k)+e(x)+e(j)+e(T)+e(B)||0))+")",1)])]),t("tr",_e,[t("th",null,[u("Gaji "),t("span",ue,"("+o(e(l)(e(M)||0))+")",1)]),t("th",null,[u("Makan "),t("span",ie,"("+o(e(l)(e(C)||0))+")",1)]),t("th",null,[u("Dinas "),t("span",pe,"("+o(e(l)(e(D)||0))+")",1)]),t("th",null,[u("Gaji "),t("span",ce,"("+o(e(l)(e(k)||0))+")",1)]),t("th",null,[u("Makan "),t("span",de,"("+o(e(l)(e(x)||0))+")",1)]),t("th",null,[u("Dinas "),t("span",me,"("+o(e(l)(e(j)||0))+")",1)]),t("th",null,[u("Gaji "),t("span",he,"("+o(e(l)(e(N)||0))+")",1)]),t("th",null,[u("Makan "),t("span",fe,"("+o(e(l)(e(P)||0))+")",1)]),t("th",null,[u("Dinas "),t("span",ve,"("+o(e(l)(e(S)||0))+")",1)])])]),t("tbody",ye,[(p(!0),c(K,null,_t(e(J),(a,f)=>(p(),c(K,{key:f},[a.p_status!="Remove"?(p(),c("tr",{key:0,"data-index":f},[t("td",null,o(f+1)+".",1),t("td",null,o(a.employee_id),1),t("td",null,o(a.employee_name),1),t("td",null,o(a.employee_role),1),t("td",null,o(a.employee_birth_place),1),t("td",null,o(a.employee_birth_date?e(b)(a.employee_birth_date).format("DD-MM-Y"):""),1),t("td",null,o(a.employee_tmk?e(b)(a.employee_tmk).format("DD-MM-Y"):""),1),t("td",null,o(a.employee_ktp_no),1),t("td",null,o(a.employee_address),1),t("td",null,o(a.employee_status),1),t("td",null,o(a.employee_rek_no),1),t("td",null,o(a.employee_rek_name),1),t("td",null,o(a.employee_bank_name),1),t("td",null,o(e(l)(a.sb_gaji)),1),t("td",null,o(e(l)(a.sb_makan)),1),t("td",null,o(e(l)(a.sb_dinas)),1),t("td",null,o(e(l)(a.sb_gaji_2)),1),t("td",null,o(e(l)(a.sb_makan_2)),1),t("td",null,o(e(l)(a.sb_dinas_2)),1),t("td",null,o(e(l)(a.uj_gaji)),1),t("td",null,o(e(l)(a.uj_makan)),1),t("td",null,o(e(l)(a.uj_dinas)),1),t("td",null,o(e(l)(a.nominal_cut)),1),t("td",null,o(e(l)(a.salary_bonus_nominal)),1),t("td",null,o(e(l)(a.salary_bonus_nominal_2)),1),t("td",null,o(e(l)(a.employee_bpjs_kesehatan)),1),t("td",null,o(e(l)(a.employee_bpjs_jamsos)),1),t("td",null,o(e(l)(a.kerajinan)),1),t("td",null,o(e(l)(parseFloat(a.sb_gaji)+parseFloat(a.sb_makan)+parseFloat(a.sb_dinas)+parseFloat(a.sb_gaji_2)+parseFloat(a.sb_makan_2)+parseFloat(a.sb_dinas_2)+parseFloat(a.uj_gaji)+parseFloat(a.uj_makan)+parseFloat(a.uj_dinas)-parseFloat(a.nominal_cut)+parseFloat(a.salary_bonus_nominal)+parseFloat(a.kerajinan))),1),t("td",null,o(e(l)(parseFloat(a.sb_gaji_2)+parseFloat(a.sb_makan_2)+parseFloat(a.sb_dinas_2)+parseFloat(a.salary_bonus_nominal)+parseFloat(a.kerajinan))),1)],8,be)):g("",!0)],64))),128))],512)])])])):g("",!0)]),t("div",we,[t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:n[2]||(n[2]=a=>y.fnClose())}," Cancel "),e(Q)?g("",!0):(p(),c("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:n[3]||(n[3]=ut(a=>I(),["prevent"]))}," Generate "+o(e(r).id==""?"& Save":""),1))])])])],512)),[[ot,y.show]])}}};export{Ce as default};
