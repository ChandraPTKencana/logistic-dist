import{r,f as te,g as Fe,h as Me,i as k,C as ze,j as le,s as Ne,c as h,a as u,b as i,k as ae,v as Le,l as a,m as oe,n as g,w as D,F as Re,q as Ve,x as m,y as B,o as p,z as L,d as C,t as H,A as Ue,B as J,_ as K,p as He,e as Je}from"./entry.80f9400f.js";import Ke from"./Header.d832b074.js";import Ye from"./Plus.ff7cfb63.js";import qe from"./Edit.8ba83185.js";import Ge from"./Eyes.35a34929.js";import Ze from"./Delete.fbe43ce9.js";import Qe from"./DeleteOff.b084eda7.js";import We from"./Signature.b3ac5cb1.js";import Xe from"./SignatureOff.b6c9f856.js";import et from"./Line.0d89352b.js";import tt from"./Check.2d47ab0b.js";import lt from"./TypeIcon.4c0c86a7.js";import at from"./TableView.85942596.js";import{u as E}from"./useMyFetch.a3705501.js";import{u as y}from"./useUtils.4905e334.js";import{_ as ot}from"./_plugin-vue_export-helper.c27b6911.js";import"./DocJPEG.62f0606b.js";import"./DocJPG.f38d5a18.js";import"./DocPNG.f9fc022c.js";import"./DocPDF.54be9be6.js";import"./Search.e94f12c9.js";import"./Adjust.bbeeda20.js";import"./TableHeaderEye.75695600.js";import"./Times.533e4a65.js";import"./ClearAll.84555876.js";import"./client-only.b5fd6b3a.js";import"./ClearEach.3dd0da5e.js";import"./CaretLeftDoubleBold.8dc8d473.js";import"./CaretLeftBold.1ba5db7b.js";import"./CaretRightBold.b313526e.js";import"./CaretRightDoubleBold.22e21eb5.js";const nt=J(()=>K(()=>import("./PopupMini.8abf2423.js"),["./PopupMini.8abf2423.js","./PopupMini.vue.9a484447.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./Exclamation.44603bae.js"],import.meta.url).then(d=>d.default||d)),st=J(()=>K(()=>import("./employee.90173462.js"),["./employee.90173462.js","./HeaderPopup.vue.def29a01.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./client-only.b5fd6b3a.js","./InputPointFormat.vue.53b3b8a4.js","./Eyes.35a34929.js","./EyesOff.b235be0a.js","./AttachmentSingle.62897b4d.js","./PDFJsView.4b00c268.js","./PDFJsView.4e9fad9f.css","./useMyFetch.a3705501.js"],import.meta.url).then(d=>d.default||d)),rt=J(()=>K(()=>import("./employee_validasi.c7093ed5.js"),["./employee_validasi.c7093ed5.js","./HeaderPopup.vue.def29a01.js","./Times.533e4a65.js","./_plugin-vue_export-helper.c27b6911.js","./entry.80f9400f.js","./entry.493f9183.css","./AttachmentSingle.62897b4d.js","./PDFJsView.4b00c268.js","./PDFJsView.4e9fad9f.css","./useUtils.4905e334.js","./useMyFetch.a3705501.js"],import.meta.url).then(d=>d.default||d)),O=d=>(He("data-v-d56d459e"),d=d(),Je(),d),ut={class:"w-full h-full flex flex-col"},it={class:"w-full flex grow flex-col overflow-auto h-0"},dt={class:"w-full flex justify-between flex-wrap"},_t={class:"grow flex"},mt={class:"m-1"},pt=O(()=>u("option",{value:"available"},"Available",-1)),vt=O(()=>u("option",{value:"unapprove"},"Unapprove",-1)),ct=O(()=>u("option",{value:"deleted"},"Trash",-1)),ft=O(()=>u("option",{value:"all"},"All",-1)),yt=[pt,vt,ct,ft],bt={class:"grow mb-5"},kt={class:"text-red-500"},ht=O(()=>u("br",null,null,-1)),gt=O(()=>u("b",{class:"text-green-500"},"Kembali Bekerja ",-1)),xt={__name:"index",async setup(d){let F,Y;const ne=t=>t.deleted==1?"!bg-red-400":t.val==0||t.val1==0?"!bg-gray-300":"",b=r("available");te(()=>b.value,t=>{Z()},{immediate:!1});const c={};c._TimeZoneOffset=new Date().getTimezoneOffset();const T=Fe("token"),{data:n}=([F,Y]=Me(async()=>Ve(async()=>{m().loading_full=!0;const{data:t,error:e,status:v}=await E("/employees",{method:"get",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},params:{filter_status:b},retry:0});return m().loading_full=!1,v.value==="error"?(B().trigger(e),[]):t.value.data},"$p5jj5crAgd")),F=await F,Y(),F),R=r({field:"",by:"desc"}),l=r(-1),f=r({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),_=k(()=>n.value[l.value]),se=()=>{c.like="";let t=JSON.parse(JSON.stringify(m()._tv.global_keyword));t!=""&&(c.like=`id:%${t}%,name:%${t}%,ktp_no:%${t}%,sim_no:%${t}%,phone_number:%${t}%,rek_no:%${t}%`),c.sort="",R.value.field&&(c.sort=R.value.field+":"+R.value.by),c.filter_model=JSON.stringify(m()._tv.filter_model)},q=r(null),G=async()=>{m().loading_full=!0,f.value.may_get_data=!1,c.page=f.value.page,c.page==1&&(n.value=[]),c.filter_status=b.value;const{data:t,error:e,status:v}=await E("/employees",{method:"get",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},params:c,retry:0});if(m().loading_full=!1,f.value.may_get_data=!0,v.value==="error"){B().trigger(e);return}f.value.page==1?(n.value=t.value.data,q.value&&(q.value.scrollTop=0)):f.value.page>1&&(n.value=[...n.value,...t.value.data]),t.value.data.length==0&&(f.value.is_last_record=!0),m()._tv.filter_box=!1},Z=()=>{l.value=-1,f.value.page=1,f.value.is_last_record=!1,se(),G()};ze();const M=r(!1),V=r(0),P=r(0),A=r(1),re=()=>{V.value=0,A.value=-1,P.value=!1,M.value=!0},{display:x}=le();Ne(le());const ue=()=>{l.value==-1?x({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(V.value=n.value[l.value].id,A.value=-1,P.value=!1,M.value=!0)},$=r(!1),z=r(0),ie=()=>{l.value==-1?x({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(z.value=n.value[l.value].id,A.value=1,P.value=!1,$.value=!0)},de=()=>{l.value==-1?x({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(z.value=n.value[l.value].id,A.value=0,P.value=!1,$.value=!0)},_e=()=>{l.value==-1?x({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(z.value=n.value[l.value].id,P.value=!1,A.value=-1,$.value=!0)},U=r(!1),Q=r({}),I=r(!1),S=r(""),me=async()=>{I.value&&(I.value=!1)},pe=()=>{l.value==-1?x({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(S.value="",Q.value={id:n.value[l.value].id},I.value=!0)},N=r(!1),ve=()=>{l.value==-1?x({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):N.value=!0};te(()=>S.value,t=>{t.trim().length>0?U.value=!0:U.value=!1},{immediate:!1});const ce=async()=>{m().loading_full=!0;const t=new FormData;t.append("id",n.value[l.value].id),t.append("deleted_reason",S.value),t.append("_method","DELETE");const{data:e,error:v,status:w}=await E("/employee",{method:"post",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},body:t,retry:0});if(m().loading_full=!1,w.value==="error"){B().trigger(v);return}let s={...n.value[l.value]};s.deleted=e.value.deleted,s.deleted_user=e.value.deleted_user,s.deleted_at=e.value.deleted_at,s.deleted_by=e.value.deleted_by,s.deleted_reason=e.value.deleted_reason,b.value!="all"?n.value.splice(l.value,1):n.value.splice(l.value,1,{...s}),l.value=-1,I.value=!1},fe=async()=>{m().loading_full=!0;const t=new FormData;t.append("id",n.value[l.value].id),t.append("_method","PUT");const{data:e,error:v,status:w}=await E("/employee_unremove",{method:"post",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},body:t,retry:0});if(m().loading_full=!1,w.value==="error"){B().trigger(v);return}let s={...n.value[l.value]};s.deleted=e.value.deleted,s.deleted_user=e.value.deleted_user,s.deleted_at=e.value.deleted_at,s.deleted_by=e.value.deleted_by,s.deleted_reason=e.value.deleted_reason,b.value!="all"?n.value.splice(l.value,1):n.value.splice(l.value,1,{...s}),l.value=-1,N.value=!1},ye=()=>{l.value==-1?x({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):be()},be=async()=>{m().loading_full=!0;const t=new FormData;t.append("id",n.value[l.value].id),t.append("_method","PUT");const{data:e,error:v,status:w}=await E("/employee_generate_code",{method:"post",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},body:t,retry:0});if(m().loading_full=!1,w.value==="error"){B().trigger(v);return}let s={...n.value[l.value]};s.m_enkey=e.value.m_enkey,n.value.splice(l.value,1,{...s})},ke=r([{key:"no",label:"No",isai:!0},{key:"val",label:"App 1",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"m_enkey",label:"Kode Kunci",filter_on:1},{key:"username",label:"Username",filter_on:1},{key:"id",label:"ID",freeze:1,filter_on:1,type:"number"},{key:"name",label:"Nama",freeze:1,freeze_left:"44px",filter_on:1,type:"string",sort:{priority:1,type:"asc"}},{key:"role",label:"Jabatan",filter_on:1,type:"string"},{key:"ktp_no",label:"No KTP",filter_on:1,type:"string"},{key:"sim_no",label:"No SIM",filter_on:1,type:"string"},{key:"bank_code",label:"Nama Bank",filter_on:1,type:"string"},{key:"rek_no",label:"No Rek",filter_on:1,type:"string"},{key:"rek_name",label:"Nama Rek",filter_on:1,type:"string"},{key:"phone_number",label:"No Tlp",filter_on:1,type:"string"},{key:"birth_place",label:"Tempat Lahir",filter_on:1,type:"string"},{key:"birth_date",label:"Tanggal Lahir",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"tmk",label:"TMK",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"address",label:"Alamat",filter_on:1,type:"string"},{key:"status",label:"Status",filter_on:1,type:"string"},{key:"attachment_1_type",label:"File",type:"string"},{key:"bpjs_kesehatan",label:"BPJS Kesehatan",class:" justify-end",type:"number",filter_on:1},{key:"bpjs_jamsos",label:"BPJS Jamsos",class:" justify-end",type:"number",filter_on:1},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]);k(()=>l.value>-1&&[void 0,0].indexOf(_.value.deleted)>-1&&y().checkPermission("employee.create"));const he=k(()=>["available","all","unapprove"].indexOf(b.value)>-1&&y().checkPermission("employee.create")),ge=k(()=>l.value>-1&&[void 0,0].indexOf(_.value.deleted)>-1&&(y().checkPermission("employee.val")&&[void 0,0].indexOf(_.value.val)>-1||y().checkPermission("employee.val1")&&[void 0,0].indexOf(_.value.val1)>-1)&&y().checkPermissions(["employee.modify","employee.detail.modify","employee.detail2.modify"])),xe=k(()=>l.value>-1&&[void 0,0].indexOf(_.value.deleted)>-1&&(y().checkPermission("employee.val")&&[void 0,0].indexOf(_.value.val)>-1||y().checkPermission("employee.val1")&&[void 0,0].indexOf(_.value.val1)>-1)),we=k(()=>l.value>-1&&[void 0,0].indexOf(_.value.deleted)>-1&&y().checkPermission("employee.unval")&&[1].indexOf(_.value.val)>-1),De=k(()=>l.value>-1&&y().checkPermission("employee.remove")&&[void 0,0].indexOf(_.value.deleted)>-1),Ce=k(()=>l.value>-1&&y().checkPermission("employee.unremove")&&[1].indexOf(_.value.deleted)>-1),Pe=k(()=>l.value>-1&&[void 0,0].indexOf(_.value.deleted)>-1&&[1].indexOf(_.value.val)>-1);return(t,e)=>{const v=Ke,w=Ye,s=qe,Ae=Ge,Se=Ze,Oe=Qe,Te=We,$e=Xe,W=et,X=tt,Ie=lt,je=at,ee=nt,Be=st,Ee=rt;return p(),h(Re,null,[u("div",ut,[i(v,{title:"List Employee"}),u("div",it,[u("div",dt,[u("div",_t,[u("div",mt,[ae(u("select",{class:"","onUpdate:modelValue":e[0]||(e[0]=o=>oe(b)?b.value=o:null)},yt,512),[[Le,a(b)]])]),a(he)?(p(),h("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[1]||(e[1]=o=>re())},[i(w)])):g("",!0),a(ge)?(p(),h("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[2]||(e[2]=o=>ue())},[i(s)])):g("",!0),a(l)>-1?(p(),h("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[3]||(e[3]=o=>_e())},[i(Ae)])):g("",!0),a(De)?(p(),h("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[4]||(e[4]=o=>pe())},[i(Se)])):g("",!0),a(Ce)?(p(),h("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[5]||(e[5]=o=>ve())},[i(Oe)])):g("",!0),a(xe)?(p(),h("button",{key:5,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[6]||(e[6]=o=>ie())},[i(Te)])):g("",!0),a(we)?(p(),h("button",{key:6,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[7]||(e[7]=o=>de())},[i($e)])):g("",!0),a(Pe)?(p(),h("button",{key:7,type:"button",name:"button",class:"m-1 text-sm",onClick:e[8]||(e[8]=o=>ye())}," GEN CODE ")):g("",!0)])]),i(je,{thead:a(ke),selected:a(l),onSetSelected:e[9]||(e[9]=o=>l.value=o),tbody:a(n),fnCallData:G,scrolling:a(f),onSetScrollingPage:e[10]||(e[10]=o=>a(f).page=o),onDoFilter:e[11]||(e[11]=o=>Z()),rowBgColor:ne},{val:D(({item:o})=>[o.val?(p(),L(X,{key:1})):(p(),L(W,{key:0}))]),val1:D(({item:o})=>[o.val1?(p(),L(X,{key:1})):(p(),L(W,{key:0}))]),bank_code:D(({item:o})=>{var j;return[C(H((j=o.bank)==null?void 0:j.code),1)]}),attachment_1_type:D(({item:o})=>[i(Ie,{value:o.attachment_1_type},null,8,["value"])]),deleted_by_username:D(({item:o})=>{var j;return[C(H((j=o.deleted_by)==null?void 0:j.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])])]),i(ee,{type:"delete",show:a(I),data:a(Q),fnClose:me,fnConfirm:ce,enabledOk:a(U)},{footer:D(()=>[C(" Masukkan Alasan Penghapusan: "),u("div",bt,[ae(u("textarea",{"onUpdate:modelValue":e[12]||(e[12]=o=>oe(S)?S.value=o:null)},null,512),[[Ue,a(S)]])])]),_:1},8,["show","data","enabledOk"]),i(Be,{show:a(M),fnClose:()=>{M.value=!1},id:a(V),p_data:a(n),is_copy:a(P)},null,8,["show","fnClose","id","p_data","is_copy"]),i(Ee,{show:a($),fnClose:()=>{$.value=!1},id:a(z),p_data:a(n),it_state:a(A)},null,8,["show","fnClose","id","p_data","it_state"]),i(ee,{type:"custome",show:a(N),fnClose:()=>N.value=!1,fnConfirm:fe},{words:D(()=>[C(" Alasan Keluar Sebelumnya : "),u("b",kt,H(a(n)[a(l)].deleted_reason),1),C(". "),ht,C(" Pekerja telah "),gt,C(" , yakin untuk melanjutkan ? ")]),_:1},8,["show","fnClose"])],64)}}},el=ot(xt,[["__scopeId","data-v-d56d459e"]]);export{el as default};
