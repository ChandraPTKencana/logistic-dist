import ie from"./Header.9ac1ff43.js";import ue from"./Plus.4e6348a5.js";import de from"./Edit.c741b0be.js";import ce from"./Signature.eaeb3182.js";import _e from"./PrinterEye.8bd061f5.js";import fe from"./Table2Column.49c42e87.js";import pe from"./Line.54c86bb2.js";import me from"./Check.a81cdf3d.js";import{_ as ve}from"./PopupMini.vue.91564f59.js";import ye from"./salary_paid.7ae3b7b4.js";import he from"./salary_paid_validasi.d1f09f6a.js";import{_ as ge}from"./PDFView.vue.42a532b5.js";import{f as we,g as ke,r as l,h as xe,i as H,s as be,j as Ce,c as p,b as _,a as t,k as o,l as z,F as Ae,y as De,w as $e,z as Pe,A as f,B as w,o as r,C as Me,D as v,t as D,d as Se,m as Te,v as je,n as Be,E as Fe}from"./entry.d8b45e34.js";import{u as E}from"./useUtils.8ca2e142.js";import{u as k}from"./useMyFetch.0f4f6d96.js";import{u as ze}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.30378410.js";import"./Exclamation.201354fe.js";import"./HeaderPopup.vue.1c6bff80.js";import"./client-only.71815d14.js";const Ee={class:"w-full h-full flex flex-col"},Le={class:"w-full flex grow flex-col overflow-auto h-0"},Ue={class:"w-full flex"},Ie={class:"w-full flex justify-center items-center grow h-0 p-1"},Ve={key:0,class:""},He={class:"tacky"},Ne=t("thead",null,[t("tr",{class:"sticky top-0 !z-[2]"},[t("th",null,"App 1"),t("th",null,"App 2"),t("th",null,"App 3"),t("th",null,"ID"),t("th",null,"Period"),t("th",null,"Created At"),t("th",null,"Updated At")])],-1),Oe=["onClick"],Re={class:"flex items-center justify-center"},Ye={class:"flex items-center justify-center"},Je={class:"flex items-center justify-center"},Ze={class:"bold"},qe={class:"grow mb-5"},gt={__name:"index",async setup(Ge){let x,L;const{$moment:$}=Fe(),c={};c._TimeZoneOffset=new Date().getTimezoneOffset(),c.sort="created_at:desc";const y=we("token"),{data:N}=([x,L]=ke(async()=>Pe(async()=>{let e=[];f().loading_full=!0;const{data:a,error:d,status:g}=await k("/salary_paids",{method:"get",headers:{Authorization:`Bearer ${y.value}`,Accept:"application/json"},params:c,retry:0});return f().loading_full=!1,g.value==="error"?(w().trigger(d),{salary_paids:e}):(e=a.value.data,{salary_paids:e})},"$5DNPjgzs1s")),x=await x,L(),x),n=l(N.value.salary_paids);l(""),l({field:"created_at",by:"desc"});const i=l(-1),u=l({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),b=l(null),O=async()=>{f().loading_full=!0,u.value.may_get_data=!1,c.page=u.value.page,c.page==1&&(n.value=[]),c.first_row&&delete c.first_row,c.page>1&&(c.first_row=JSON.stringify(n.value[0]));const{data:e,error:a,status:d}=await k("/salary_paids",{method:"get",headers:{Authorization:`Bearer ${y.value}`,Accept:"application/json"},params:c,retry:0});if(f().loading_full=!1,u.value.may_get_data=!0,d.value==="error"){w().trigger(a);return}u.value.page==1?(n.value=e.value.data,b.value&&(b.value.scrollTop=0)):u.value.page>1&&(n.value=[...n.value,...e.value.data]),e.value.data.length==0&&(u.value.is_last_record=!0)},R=async()=>{if(!u.value.may_get_data)return;let e=b.value;if(e.scrollLeft!=u.value.scrollLeft){u.value.scrollLeft=e.scrollLeft;return}u.value.is_last_record||!(Math.round(e.scrollTop)+e.clientHeight>=e.scrollHeight-1)||(u.value.page++,await O())};xe();const C=l(!1),P=l(0),M=l(0),Y=()=>{P.value=0,C.value=!0,M.value=!1},{display:U}=H();be(H());const J=()=>{i.value==-1?U({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=n.value[i.value].id,C.value=!0,M.value=!1)},S=l(!1),I=l(0),Z=()=>{i.value==-1?U({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(I.value=n.value[i.value].id,S.value=!0)},T=l(!1),q=l({}),A=l(!1),h=l(""),G=async()=>{A.value&&(A.value=!1)};Ce(()=>h.value,e=>{e.trim().length>0?T.value=!0:T.value=!1},{immediate:!1});const K=async()=>{f().loading_full=!0;const e=new FormData;e.append("id",n.value[i.value].id),e.append("deleted_reason",h.value),e.append("_method","DELETE");const{data:a,error:d,status:g}=await k("/salary_paid",{method:"post",headers:{Authorization:`Bearer ${y.value}`,Accept:"application/json"},body:e,retry:0});if(f().loading_full=!1,g.value==="error"){w().trigger(d);return}n.value.splice(i.value,1),i.value=-1,A.value=!1},{downloadFile:Q,viewFile:Ke}=ze(),m=l(!1),V=l({}),W=async()=>{if(m.value==!0){m.value=!1;return}f().loading_full=!0;const{data:e,error:a,status:d}=await k("/salary_paid/pdf_preview",{method:"get",headers:{Authorization:`Bearer ${y.value}`,Accept:"application/json"},params:{id:n.value[i.value].id},retry:0});if(f().loading_full=!1,d.value==="error"){w().trigger(a);return}V.value=e.value,m.value=!0},X=async()=>{f().loading_full=!0;const{data:e,error:a,status:d}=await k("/salary_paid/excel_download",{method:"get",headers:{Authorization:`Bearer ${y.value}`,Accept:"application/json"},params:{id:n.value[i.value].id},retry:0});if(f().loading_full=!1,d.value==="error"){w().trigger(a);return}Q(e.value)};return(e,a)=>{const d=ie,g=ue,ee=de,te=ce,ae=_e,oe=fe,j=pe,B=me,se=ve,le=ye,ne=he,re=ge;return r(),p("div",Ee,[_(d,{title:"List Salary Paid"}),t("div",Le,[t("div",Ue,[("useUtils"in e?e.useUtils:o(E))().checkPermission("salary_paid.create")?(r(),p("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[0]||(a[0]=s=>Y())},[_(g)])):z("",!0),("useUtils"in e?e.useUtils:o(E))().checkPermissions(["salary_paid.modify"])?(r(),p("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[1]||(a[1]=s=>J())},[_(ee)])):z("",!0),("useUtils"in e?e.useUtils:o(E))().checkPermissions(["salary_paid.val1","salary_paid.val2","salary_paid.val3"])?(r(),p("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[2]||(a[2]=s=>Z())},[_(te)])):z("",!0),t("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:a[3]||(a[3]=s=>W())},[_(ae)]),t("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:a[4]||(a[4]=s=>X())},[_(oe)])]),t("div",Ie,[o(n).length==0?(r(),p("div",Ve," Maaf Tidak Ada Record ")):(r(),p("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:R},[t("table",He,[Ne,t("tbody",null,[(r(!0),p(Ae,null,De(o(n),(s,F)=>(r(),p("tr",{key:F,onClick:Qe=>i.value=F,class:Me(o(i)==F?"active":"")},[t("td",null,[t("div",Re,[s.val1?(r(),v(B,{key:1})):(r(),v(j,{key:0}))])]),t("td",null,[t("div",Ye,[s.val2?(r(),v(B,{key:1})):(r(),v(j,{key:0}))])]),t("td",null,[t("div",Je,[s.val3?(r(),v(B,{key:1})):(r(),v(j,{key:0}))])]),t("td",Ze,D(s.id),1),t("td",null,D(s.period_end?o($)(s.period_end).format("MM-Y"):""),1),t("td",null,D(s.created_at?o($)(s.created_at).format("DD-MM-Y HH:mm:ss"):""),1),t("td",null,D(s.updated_at?o($)(s.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,Oe))),128))])])],544))])]),_(se,{type:"delete",show:o(A),data:o(q),fnClose:G,fnConfirm:K,enabledOk:o(T)},{footer:$e(()=>[Se(" Masukkan Alasan Penghapusan: "),t("div",qe,[Te(t("textarea",{"onUpdate:modelValue":a[5]||(a[5]=s=>Be(h)?h.value=s:null)},null,512),[[je,o(h)]])])]),_:1},8,["show","data","enabledOk"]),_(le,{show:o(C),fnClose:()=>{C.value=!1},id:o(P),p_data:o(n),is_copy:o(M)},null,8,["show","fnClose","id","p_data","is_copy"]),_(ne,{show:o(S),fnClose:()=>{S.value=!1},id:o(I),p_data:o(n)},null,8,["show","fnClose","id","p_data"]),_(re,{show:o(m),pdfContent:o(V),onClose:a[6]||(a[6]=s=>m.value=!o(m))},null,8,["show","pdfContent"])])}}};export{gt as default};
