import{r as o,f as z,g as pe,h as fe,i as c,C as ve,j as L,s as ye,c as x,b as d,a as _,k as ge,v as be,l,m as ke,n as C,w as A,q as he,x as p,y as U,o as u,z as S,d as R,t as J,B as q,_ as K}from"./entry.18bd932e.js";import we from"./Header.64b90910.js";import xe from"./Plus.7f17425c.js";import De from"./Edit.b60a28ac.js";import Pe from"./Eyes.dda7512e.js";import Ce from"./Signature.88a0bb9b.js";import Ae from"./Line.93597c1d.js";import Se from"./Check.e6b07d8b.js";import Oe from"./TableView.d11abd23.js";import{u as f}from"./useUtils.b23a3e21.js";import{u as Y}from"./useMyFetch.ff261ccd.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.37c5ba6b.js";import"./Adjust.cf250dc8.js";import"./TableHeaderEye.7d9c66d1.js";import"./Times.0ecc27f9.js";import"./ClearAll.2ac52712.js";import"./client-only.310ac4b9.js";import"./ClearEach.7214dc93.js";import"./CaretLeftDoubleBold.0acf4ed0.js";import"./CaretLeftBold.ae8135ff.js";import"./CaretRightBold.3d7447d2.js";import"./CaretRightDoubleBold.7c9667d9.js";const $e=q(()=>K(()=>import("./mst.7fb940b2.js"),["./mst.7fb940b2.js","./HeaderPopup.vue.9a5844d9.js","./Times.0ecc27f9.js","./_plugin-vue_export-helper.c27b6911.js","./entry.18bd932e.js","./entry.f59c56d0.css","./WidthMiniList.vue.69764196.js","./WidthMiniPart.vue.5e0b5d1b.js","./InputPointFormat.vue.20cf8085.js","./AttachmentSingle.9723e37a.js","./PDFJsView.e1bd8604.js","./PDFJsView.4e9fad9f.css","./part.ddd79fdd.js","./Plus.7f17425c.js","./Edit.b60a28ac.js","./Delete.d5ba3780.js","./Signature.88a0bb9b.js","./Calculator.996252ac.js","./Search.37c5ba6b.js","./Line.93597c1d.js","./Check.e6b07d8b.js","./trx.095356e4.js","./useMyFetch.ff261ccd.js","./trx_validasi.29a0b388.js","./useUtils.b23a3e21.js"],import.meta.url).then(v=>v.default||v)),je=q(()=>K(()=>import("./validasi.cdff4f79.js"),["./validasi.cdff4f79.js","./HeaderPopup.vue.9a5844d9.js","./Times.0ecc27f9.js","./_plugin-vue_export-helper.c27b6911.js","./entry.18bd932e.js","./entry.f59c56d0.css","./WidthMiniPart.vue.5e0b5d1b.js","./AttachmentSingle.9723e37a.js","./PDFJsView.e1bd8604.js","./PDFJsView.4e9fad9f.css","./useUtils.b23a3e21.js","./useMyFetch.ff261ccd.js"],import.meta.url).then(v=>v.default||v)),Ne={class:"w-full h-full flex flex-col"},ze={class:"w-full flex grow flex-col overflow-auto h-0"},Te={class:"w-full flex justify-between flex-wrap"},Be={class:"grow flex"},Ie={class:"m-1"},Me=_("option",{value:"undone"},"Undone",-1),Ve=_("option",{value:"done"},"Done",-1),Ee=_("option",{value:"deleted"},"Trash",-1),He=_("option",{value:"all"},"All",-1),Fe=[Me,Ve,Ee,He],dt={__name:"index",async setup(v){let D,T;const Z=e=>e.deleted==1?"!bg-red-400":e.val>0&&e.val1>0&&e.remaining_cut==0?"!bg-blue-300":"",m=o("undone");z(()=>m.value,e=>{M()},{immediate:!1});const n={};n._TimeZoneOffset=new Date().getTimezoneOffset(),n.sort="created_at:desc";const B=pe("token"),{data:G}=([D,T]=fe(async()=>he(async()=>{let e=[];p().loading_full=!0;const{data:t,error:h,status:N}=await Y("/potongan_msts",{method:"get",headers:{Authorization:`Bearer ${B.value}`,Accept:"application/json"},params:{filter_status:m},retry:0});return p().loading_full=!1,N.value==="error"?(U().trigger(h),{potongan_msts:e}):(e=t.value.data,{potongan_msts:e})},{lazy:!0,server:!1,default:()=>({potongan_msts:[]})},"$4H5grU4zhJ")),D=await D,T(),D),r=o([]);z(()=>{var e;return(e=G.value)==null?void 0:e.potongan_msts},e=>{e&&(r.value=[...e])},{immediate:!0}),o("");const O=o({field:"created_at",by:"desc"}),s=o(-1),i=o({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),y=c(()=>r.value[s.value]),Q=()=>{n.like="";let e=JSON.parse(JSON.stringify(p()._tv.global_keyword));e!=""&&(n.like=`id:%${e}%,employee_name:%${e}%,no_pol:%${e}%,kejadian:%${e}%,status:%${e}%`),n.sort="",O.value.field&&(n.sort=O.value.field+":"+O.value.by),n.filter_model=JSON.stringify(p()._tv.filter_model)};o(null);const I=async()=>{p().loading_full=!0,i.value.may_get_data=!1,n.page=i.value.page,n.page==1&&(r.value=[]),n.first_row&&delete n.first_row,n.page>1&&(n.first_row=JSON.stringify(r.value[0])),n.filter_status=m.value;const{data:e,error:t,status:h}=await Y("/potongan_msts",{method:"get",headers:{Authorization:`Bearer ${B.value}`,Accept:"application/json"},params:n,retry:0});if(p().loading_full=!1,i.value.may_get_data=!0,h.value==="error"){U().trigger(t);return}i.value.page==1?r.value=e.value.data:i.value.page>1&&(r.value=[...r.value,...e.value.data]),e.value.data.length==0&&(i.value.is_last_record=!0),p()._tv.filter_box=!1},M=()=>{s.value=-1,i.value.page=1,i.value.is_last_record=!1,Q(),I()};ve();const g=o(!1),P=o(0),b=o(0),k=o(!1),W=()=>{P.value=0,k.value=!1,b.value=!1,g.value=!0},{display:$}=L();ye(L());const X=()=>{s.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=r.value[s.value].id,k.value=!1,b.value=!1,g.value=!0)},j=o(!1),V=o(0),ee=()=>{s.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(V.value=r.value[s.value].id,k.value=!0,b.value=!1,j.value=!0)},te=()=>{s.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=r.value[s.value].id,k.value=!0,b.value=!1,g.value=!0)},E=o(!1);o({}),o(!1);const ae=o("");z(()=>ae.value,e=>{e.trim().length>0?E.value=!0:E.value=!1},{immediate:!1});const oe=o([{key:"no",label:"No",isai:!0},{key:"valx",label:"APP",childs:[{key:"val",label:"App 1",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val1",label:"App 2",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]}]},{key:"id",label:"ID",filter_on:1,type:"number",sort:{priority:1,type:"desc"}},{key:"employee_name",label:"Nama Pekerja",freeze:1,filter_on:1,type:"string"},{key:"no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"kejadian",label:"Kejadian",filter_on:1,type:"string"},{key:"nominal",label:"Nominal",class:" justify-end",type:"number"},{key:"nominal_cut",label:"Nominal Potongan",class:" justify-end",type:"number"},{key:"remaining_cut",label:"Sisa Potongan",class:" justify-end",type:"number"},{key:"status",label:"Status",class:" justify-end",type:"number"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]);c(()=>s.value>-1&&[void 0,0].indexOf(y.value.deleted)>-1&&f().checkPermission("potongan_mst.create"));const le=c(()=>["undone","done","deleted","all"].indexOf(m.value)>-1&&f().checkPermission("potongan_mst.create")),ne=c(()=>s.value>-1&&f().checkPermission("potongan_mst.view")),se=c(()=>s.value>-1&&[void 0,0].indexOf(y.value.deleted)>-1&&f().checkPermissions(["potongan_mst.modify","potongan_trx.create","potongan_trx.modify","potongan_trx.remove"])),re=c(()=>s.value>-1&&[void 0,0].indexOf(y.value.deleted)>-1&&(f().checkPermission("potongan_mst.val")&&[void 0,0].indexOf(y.value.val)>-1||f().checkPermission("potongan_mst.val1")&&[void 0,0].indexOf(y.value.val1)>-1));return c(()=>s.value>-1&&f().checkPermission("potongan_mst.remove")&&[void 0,0].indexOf(y.value.deleted)>-1),(e,t)=>{const h=we,N=xe,ie=De,ue=Pe,_e=Ce,H=Ae,F=Se,de=Oe,me=$e,ce=je;return u(),x("div",Ne,[d(h,{title:"List Potongan"}),_("div",ze,[_("div",Te,[_("div",Be,[_("div",Ie,[ge(_("select",{class:"","onUpdate:modelValue":t[0]||(t[0]=a=>ke(m)?m.value=a:null)},Fe,512),[[be,l(m)]])]),l(le)?(u(),x("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=a=>W())},[d(N)])):C("",!0),l(se)?(u(),x("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=a=>X())},[d(ie)])):C("",!0),l(ne)?(u(),x("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[3]||(t[3]=a=>te())},[d(ue)])):C("",!0),l(re)?(u(),x("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[4]||(t[4]=a=>ee())},[d(_e)])):C("",!0)])]),d(de,{thead:l(oe),selected:l(s),onSetSelected:t[5]||(t[5]=a=>s.value=a),tbody:l(r),fnCallData:I,scrolling:l(i),onSetScrollingPage:t[6]||(t[6]=a=>l(i).page=a),onDoFilter:t[7]||(t[7]=a=>M()),rowBgColor:Z},{val:A(({item:a})=>[a.val?(u(),S(F,{key:1})):(u(),S(H,{key:0}))]),val1:A(({item:a})=>[a.val1?(u(),S(F,{key:1})):(u(),S(H,{key:0}))]),employee_name:A(({item:a})=>{var w;return[R(J((w=a.employee)==null?void 0:w.name),1)]}),deleted_by_username:A(({item:a})=>{var w;return[R(J((w=a.deleted_by)==null?void 0:w.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])]),d(me,{show:l(g),fnClose:()=>{g.value=!1},id:l(P),p_data:l(r),is_copy:l(b),is_view:l(k)},null,8,["show","fnClose","id","p_data","is_copy","is_view"]),d(ce,{show:l(j),fnClose:()=>{j.value=!1},id:l(V),p_data:l(r)},null,8,["show","fnClose","id","p_data"])])}}};export{dt as default};
