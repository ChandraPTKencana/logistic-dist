import{_ as D}from"./HeaderPopup.vue.40cda0b2.js";import{r as x,g as F,i as N,f as j,k as f,J as z,o as g,c as k,a as e,b as I,l,A as C,t as _,v as V,E as L,F as q,D as T,$ as E,C as O,x as v,y,p as H,e as J,H as G}from"./entry.b1607c16.js";import"./useUtils.a1e46544.js";import{u as b}from"./useMyFetch.d189f369.js";import{_ as K}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.7f9ccf9f.js";const u=d=>(H("data-v-825cfc94"),d=d(),J(),d),Q={class:"box-fixed"},R={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},W={class:"w-full flex flex-col items-center grow overflow-auto"},X={class:"w-full flex flex-row flex-wrap"},Y={class:"w-full flex flex-col flex-wrap p-1"},Z=u(()=>e("label",{for:""},"Username",-1)),ee={class:"text-red-500"},te={class:"w-full flex flex-col flex-wrap p-1"},ae=u(()=>e("label",{for:""},"Password",-1)),se={class:"text-red-500"},oe={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},le=u(()=>e("label",{for:""},"Hak Akses",-1)),ie=G('<option value="PabrikTransport" data-v-825cfc94>Pabrik Transport</option><option value="PabrikMandor" data-v-825cfc94>Pabrik Mandor</option><option value="Logistic" data-v-825cfc94>Logisitic</option><option value="Finance" data-v-825cfc94>Finance</option><option value="Marketing" data-v-825cfc94>Marketing</option><option value="Accounting" data-v-825cfc94>Accounting</option><option value="MIS" data-v-825cfc94>MIS</option><option value="ViewOnly" data-v-825cfc94>ViewOnly</option><option value="SuperAdmin" data-v-825cfc94>SuperAdmin</option>',9),ne=[ie],re={class:"text-red-500"},de={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ue=u(()=>e("label",{for:""},"Status",-1)),ce=u(()=>e("option",{value:"1"},"Aktif",-1)),pe=u(()=>e("option",{value:"0"},"Nonaktif",-1)),fe=[ce,pe],_e={class:"text-red-500"},ve={class:"w-full flex flex-col sm:flex-row grow p-1 justify-between flex-wrap 2xl:overflow-hidden"},me={class:"w-full max-w-full p-0 2xl:pr-1 2xl:max-h-full 2xl:overflow-auto"},he={class:"w-full",role:"sticky"},we={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},xe=u(()=>e("tr",{class:"sticky -top-1 !z-[2]"},[e("td",{colspan:"2",class:"!bg-slate-800 text-white font-bold"}," Detail Permission List ")],-1)),ge={class:"sticky top-7 !z-[2]"},ke={class:"min-w-[20px] !w-[20px] max-w-[20px]"},ye=u(()=>e("th",null,"Name",-1)),be={ref:"to_move"},Se={class:"!w-[10px]"},Ae={class:"w-full h-full flex items-center justify-center"},Ce=["onUpdate:modelValue"],Ve={class:"w-full h-full flex items-center justify-start"},Me={class:"w-full flex items-center justify-end"},Pe={__name:"user",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(d){const r=d,S={id:-1,username:"",password:"",hak_akses:"PabrikTransport",is_active:1},s=x({...S}),w=F("token"),c=x({}),M=async()=>{v().loading_full=!0,c.value={};const o=new FormData;o.append("username",s.value.username),s.value.password&&o.append("password",s.value.password),o.append("hak_akses",s.value.hak_akses),o.append("is_active",s.value.is_active),o.append("permission_list",JSON.stringify(m.value));let t="post",n=r.is_copy?0:r.id;n==0||(o.append("id",n),o.append("_method","PUT"));const{data:a,error:h,status:p}=await b("/user",{method:t,headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},body:o,retry:0});if(v().loading_full=!1,p.value==="error"){y().trigger(h,c);return}if(n<=0)s.value.id=a.value.id,s.value.created_at=a.value.created_at,s.value.updated_at=a.value.updated_at,r.p_data.unshift(s.value);else{s.value.updated_at=a.value.updated_at;let A=r.p_data.map(B=>B.id).indexOf(n);A>=-1&&r.p_data.splice(A,1,{...s.value})}r.fnClose()},P=async()=>{v().loading_full=!0;const{data:o,error:t,status:n}=await b("/user",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:{id:r.id},retry:0});if(v().loading_full=!1,n.value==="error"){y().trigger(t);return}s.value=o.value.data,o.value.data.details.forEach((a,h)=>{i.value=i.value.map(p=>(p.name==a.permission_list_name&&(p.checked=!0),p))})},i=x([]),U=async()=>{v().loading_full=!0;const{data:o,error:t,status:n}=await b("/permission_lists",{method:"get",headers:{Authorization:`Bearer ${w.value}`,Accept:"application/json"},params:{sort:"name:asc"},retry:0});if(v().loading_full=!1,n.value==="error"){y().trigger(t);return}i.value=o.value.data.map(a=>(a.checked=!1,a))},m=N(o=>i.value.filter(t=>t.checked)),$=o=>{m.value.length!=i.value.length?i.value=i.value.map(t=>(t.checked=!0,t)):i.value=i.value.map(t=>(t.checked=!1,t))};return j(()=>r.show,async(o,t)=>{o==!0&&(s.value={...S},i.value=[],await U(),c.value={},r.id!=0&&await P())},{immediate:!0}),(o,t)=>{const n=D;return f((g(),k("section",Q,[e("div",null,[I(n,{title:"Form User",fn:d.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",R,[e("div",W,[e("div",X,[e("div",Y,[Z,f(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>l(s).username=a)},null,512),[[C,l(s).username]]),e("p",ee,_(l(c).username),1)]),e("div",te,[ae,f(e("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=a=>l(s).password=a)},null,512),[[C,l(s).password]]),e("p",se,_(l(c).password),1)]),e("div",oe,[le,f(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>l(s).hak_akses=a)},ne,512),[[V,l(s).hak_akses]]),e("p",re,_(l(c).hak_akses),1)]),e("div",de,[ue,f(e("select",{"onUpdate:modelValue":t[3]||(t[3]=a=>l(s).is_active=a)},fe,512),[[V,l(s).is_active]]),e("p",_e,_(l(c).is_active),1)])]),e("div",ve,[e("div",me,[e("div",he,[e("table",we,[e("thead",null,[xe,e("tr",ge,[e("th",ke,[e("button",{type:"button",name:"button",class:L(["text-xs",l(m).length!=l(i).length?"bg-green-500":"bg-red-500"]),onClick:t[4]||(t[4]=a=>$())},_(l(m).length!=l(i).length?"Allow":"Deny"),3)]),ye])]),e("tbody",be,[(g(!0),k(q,null,T(l(i),(a,h)=>(g(),k("tr",{key:h},[e("td",Se,[e("div",Ae,[f(e("input",{type:"checkbox","onUpdate:modelValue":p=>a.checked=p,class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:bg-gray-700 dark:border-gray-600 cursor-pointer"},null,8,Ce),[[E,a.checked]])])]),e("td",null,[e("div",Ve,_(a.name),1)])]))),128))],512)])])])])]),e("div",Me,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:t[5]||(t[5]=a=>d.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:t[6]||(t[6]=O(a=>M(),["prevent"]))}," Save ")])])])],512)),[[z,d.show]])}}},je=K(Pe,[["__scopeId","data-v-825cfc94"]]);export{je as default};
