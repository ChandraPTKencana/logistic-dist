import{_ as O}from"./HeaderCustom.vue.12da00e5.js";import{_ as Q}from"./InputPointFormat.vue.a1a8bc6a.js";import{u as Y,_ as z}from"./useUtils.822c33d9.js";import{_ as J}from"./Delete.78caf709.js";import{_ as Z}from"./HeaderPopup.vue.2cda1a28.js";import{f as K,r as c,g as G,h as S,v as q,o as $,c as k,a as e,b as C,i as W,j as B,k as o,l as L,m as P,F as E,n as X,q as ee,t as u,s as te,p as se,e as oe,x as U,y as H,z as le,A as ae,B as ne,C as ie,D as re,E as ue}from"./entry.f54fa281.js";import{u as V}from"./useMyFetch.a4b6fe0f.js";import{_ as ce}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.d1d5fe03.js";const y=x=>(se("data-v-e611be0e"),x=x(),oe(),x),de={class:"box-fixed"},_e={action:"#",class:"w-full flex p-1"},fe={class:"grow"},pe=y(()=>e("div",{class:"font-bold"}," Keyword ",-1)),ve={class:"pl-1"},me=y(()=>e("div",{class:"font-bold"}," Sort By ",-1)),he=y(()=>e("option",{value:"created_at"},"Created At",-1)),we=y(()=>e("option",{value:"id"},"ID",-1)),ye=y(()=>e("option",{value:"name"},"Nama",-1)),xe=[he,we,ye],ge={class:"pl-1"},be=y(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),$e=y(()=>e("option",{value:"asc"},"Asc",-1)),ke=y(()=>e("option",{value:"desc"},"Desc",-1)),Se=[$e,ke],Ce={class:"flex items-end pl-1"},Ae={class:"w-full flex justify-center items-center grow h-0 p-1"},Ue={key:0,class:""},De={class:"tacky"},Ie=y(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"ID"),e("th",null,"Name"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1)),je=["onClick"],Te={class:"bold"},Fe={class:"flex",style:{"justify-content":"end",padding:"5px"}},Me={__name:"units",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1}},setup(x){const g=x,{$moment:D}=te(),{countClickListFn:T}=Y(),d=K("token"),_=c([]),w=c(""),f=c({field:"created_at",by:"desc"}),p=c(-1),s=c({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),i={};i._TimeZoneOffset=new Date().getTimezoneOffset();const N=()=>{i.like="",w.value!=""&&(i.like=`id:%${w.value}%,name:%${w.value}%`),i.sort="",f.value.field&&(i.sort=f.value.field+":"+f.value.by)},A=c(null),F=async()=>{U().loading_full=!0,s.value.may_get_data=!1,i.page=s.value.page,i.page==1&&(_.value=[]),i.first_row&&delete i.first_row,i.page>1&&(i.first_row=JSON.stringify(_.value[0]));const{data:t,error:l,status:v}=await V("/units",{method:"get",headers:{Authorization:`Bearer ${d.value}`,Accept:"application/json"},params:i,retry:0});if(U().loading_full=!1,s.value.may_get_data=!0,v.value==="error"){H().trigger(l);return}s.value.page==1?(_.value=t.value.data,A.value&&(A.value.scrollTop=0)):s.value.page>1&&(_.value=[..._.value,...t.value.data]),t.value.data.length==0&&(s.value.is_last_record=!0)},R=async()=>{if(!s.value.may_get_data)return;let t=A.value;if(t.scrollLeft!=s.value.scrollLeft){s.value.scrollLeft=t.scrollLeft;return}s.value.is_last_record||!(Math.round(t.scrollTop)+t.clientHeight>=t.scrollHeight-1)||(s.value.page++,await F())},I=()=>{s.value.page=1,s.value.is_last_record=!1,N(),F()},b=()=>{p.value>-1?g.fnSelect(_.value[p.value]):g.fnSelect({id:"",name:""})},M=c(null);let j=null;const a=t=>{j&&clearTimeout(j),j=setTimeout(()=>{I()},500)};return G(()=>g.show,(t,l)=>{t==!0&&I(),setTimeout(()=>{M.value.focus()},100)},{immediate:!0}),(t,l)=>{const v=Z,m=z;return S(($(),k("section",de,[e("div",null,[C(v,{title:"Search And Select Unit",fn:x.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",_e,[e("div",fe,[pe,S(e("input",{ref_key:"ref_keyword",ref:M,class:"",type:"text","onUpdate:modelValue":l[0]||(l[0]=n=>W(w)?w.value=n:null),name:"search",placeholder:"Keyword",onKeyup:l[1]||(l[1]=n=>a())},null,544),[[B,o(w)]])]),e("div",ve,[me,S(e("select",{class:"","onUpdate:modelValue":l[2]||(l[2]=n=>o(f).field=n)},xe,512),[[L,o(f).field]])]),e("div",ge,[be,S(e("select",{class:"","onUpdate:modelValue":l[3]||(l[3]=n=>o(f).by=n)},Se,512),[[L,o(f).by]])]),e("div",Ce,[e("button",{class:"",type:"submit",name:"button",onClick:l[4]||(l[4]=P(n=>I(),["prevent"]))},[C(m,{class:"text-2xl"})])])]),e("div",Ae,[o(_).length==0?($(),k("div",Ue," Maaf Tidak Ada Record ")):($(),k("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:A,onScroll:R},[e("table",De,[Ie,e("tbody",null,[($(!0),k(E,null,X(o(_),(n,h)=>($(),k("tr",{key:h,onClick:r=>o(T)(h,()=>{p.value=h},b),class:ee(o(p)==h?"active":"")},[e("td",null,u(h+1)+".",1),e("td",Te,u(n.id),1),e("td",null,u(n.name),1),e("td",null,u(o(D)(n.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,u(o(D)(n.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,je))),128))])])],544))]),e("div",Fe,[e("button",{onClick:l[5]||(l[5]=n=>b()),class:"w-36 m-1 bg-blue-600 text-white rounded-sm"}," Select ")])])],512)),[[q,x.show]])}}},Ne=ce(Me,[["__scopeId","data-v-e611be0e"]]),Re={class:"w-full h-full flex flex-col"},qe={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},Be={class:"w-full align-items-center justify-content-center grow overflow-auto"},He={class:"w-full flex flex-col flex-wrap p-1"},Ve=e("label",{for:""},"Foto",-1),Le={class:"flex justify-center items-center w-24 h-24"},ze=["src"],Ke=e("small",null,"Upload file image : jpg, jpeg",-1),Pe={class:"help-err"},Ee={class:"w-full flex flex-col flex-wrap p-1"},Oe=e("label",{for:""},"Name",-1),Qe={class:"text-red-500"},Ye={class:"w-full flex flex-col flex-wrap p-1"},Je=e("label",{for:""},"Value",-1),Ze={class:"text-red-500"},Ge={class:"w-full flex flex-col flex-wrap p-1"},We=e("label",{for:""},"Note",-1),Xe={class:"text-red-500"},et={class:"w-full flex flex-col flex-wrap p-1"},tt=e("label",{for:""},"Unit",-1),st={class:"card-border flex flex-row flex-wrap"},ot={key:0,class:"w-full flex"},lt=e("div",{class:"flex items-center grow p-1"}," Pilih Unit ",-1),at={key:1,class:"w-full flex",style:{}},nt={class:"flex flex-row flex-wrap grow"},it={class:"p-1"},rt=e("div",{class:"text-sm text-gray-600"},"ID",-1),ut={class:"bold"},ct={class:"p-1"},dt=e("div",{class:"text-sm text-gray-600"},"Email",-1),_t={class:"bold"},ft={class:"text-red-500"},pt={class:"w-full flex items-center justify-end"},kt=le({__name:"form",async setup(x){let g,D;ae();const T=K("token"),d=c({}),_=ne(),w=ie();let f={id:"",name:""};const p=c(!1),{data:s}=([g,D]=re(async()=>ue(async()=>{const a=w.query.id;if(a!==void 0&&a!==""){U().loading_full=!0;const{data:t,error:l,status:v}=await V("/item",{method:"get",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},params:{id:a},retry:0});if(U().loading_full=!1,v.value==="error")H().trigger(l,d);else{let m=t.value.data;return t.value.data.photo&&(p.value=!0),m}}return{id:-1,name:"",value:0,note:"",unit:{...f},photo:""}},"$eQTKQHw4Kq")),g=await g,D(),g);let i=c(!1);const N=()=>{s.value.unit={...f}},A=()=>{i.value=!0},F=()=>{i.value=!1},R=a=>{s.value.unit=a,i.value=!1},I=async()=>{var h;U().loading_full=!0,d.value={};const a=new FormData;a.append("name",s.value.name),a.append("value",s.value.value),a.append("note",s.value.note),a.append("unit_id",s.value.unit.id),(h=b.value)!=null&&h.files&&a.append("photo",b.value.files[0]||""),b.value&&a.append("photo_preview",s.value.photo);let t="post",l=w.query.id;l===""||(t="post",a.append("id",l),a.append("_method","PUT"));const{data:v,error:m,status:n}=await V("/item",{method:t,headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},body:a,retry:0});if(U().loading_full=!1,n.value==="error"){H().trigger(m,d);return}_.go(-1)},b=c(null),M=a=>{var t=a.target.files;if(t.length>0){let l=new FileReader;l.onload=function(v){var n;let m=(n=v.target)==null?void 0:n.result;m.match(/image/)&&(s.value.photo=m)},l.readAsDataURL(t[0]),p.value=!0}},j=()=>{p.value=!1,s.value.photo="";let a=b.value;a&&(a.value="")};return(a,t)=>{const l=O,v=Q,m=z,n=J,h=Ne;return $(),k(E,null,[e("div",Re,[C(l,{title:"Form Item",back:!0}),e("form",qe,[e("div",Be,[e("div",He,[Ve,e("div",Le,[e("img",{src:o(s).photo||"/logistik/user-default.png",alt:"",class:"max-w-full max-h-full"},null,8,ze)]),S(e("button",{type:"button",class:"bg-gray-600 w-24 text-white",onClick:t[0]||(t[0]=r=>j())},"Remove",512),[[q,o(p)]]),S(e("input",{onChange:t[1]||(t[1]=r=>M(r)),ref_key:"photo_input",ref:b,type:"file",name:"photo",value:""},null,544),[[q,!o(p)]]),Ke,e("p",Pe,u(o(d).photo),1)]),e("div",Ee,[Oe,S(e("input",{class:"",type:"text","onUpdate:modelValue":t[2]||(t[2]=r=>o(s).name=r)},null,512),[[B,o(s).name]]),e("p",Qe,u(o(d).name),1)]),e("div",Ye,[Je,C(v,{class:"",type:"text",value:o(s).value,onInput:t[3]||(t[3]=r=>o(s).value=r)},null,8,["value"]),e("p",Ze,u(o(d).value),1)]),e("div",Ge,[We,S(e("textarea",{class:"","onUpdate:modelValue":t[4]||(t[4]=r=>o(s).note=r)},null,512),[[B,o(s).note]]),e("p",Xe,u(o(d).note),1)]),e("div",et,[tt,e("div",st,[!o(s).unit||!o(s).unit.id?($(),k("div",ot,[e("button",{type:"button",onClick:t[5]||(t[5]=r=>A()),class:"flex items-center grow"},[C(m,{class:"text-2xl text-black"}),lt])])):($(),k("div",at,[e("div",nt,[e("div",it,[rt,e("div",ut,u(o(s).unit.id),1)]),e("div",ct,[dt,e("div",_t,u(o(s).unit.name),1)])]),e("button",{type:"button",class:"w-10 bg-red-600 flex items-center justify-center",onClick:t[6]||(t[6]=r=>N())},[C(n,{class:"text-2xl text-white"})])]))]),e("p",ft,u(o(d).unit_id),1)])]),e("div",pt,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:t[7]||(t[7]=r=>a.$router.go(-1))}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:t[8]||(t[8]=P(r=>I(),["prevent"]))}," Save ")])])]),C(h,{show:o(i),fnClose:F,fnSelect:R,excludes:"item_had_which_item_id"},null,8,["show"])],64)}}});export{kt as default};
