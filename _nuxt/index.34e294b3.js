import{r,f as K,g as ze,h as Fe,i as h,C as Ne,j as le,s as Le,c as g,a as i,b as u,k as ae,v as Re,l as a,m as oe,n as x,w as D,F as Ve,q as Ue,x as m,y as B,o as p,z as L,d as P,t as H,A as Ke,B as J,_ as Y,p as He,e as Je}from"./entry.d9b45284.js";import Ye from"./Header.5d6a7e6a.js";import qe from"./Plus.654db134.js";import Ge from"./Edit.41ec64a9.js";import Ze from"./Eyes.3aa9f1c8.js";import Qe from"./Delete.1ed7de6d.js";import We from"./DeleteOff.3f84e5f2.js";import Xe from"./Signature.37252826.js";import et from"./SignatureOff.304e85e0.js";import tt from"./Line.af06220c.js";import lt from"./Check.989aaee6.js";import at from"./TypeIcon.dec5416e.js";import ot from"./TableView.fc53970b.js";import{u as E}from"./useMyFetch.405cdccc.js";import{u as y}from"./useUtils.ab60562a.js";import{_ as nt}from"./_plugin-vue_export-helper.c27b6911.js";import"./DocJPEG.578db7c4.js";import"./DocJPG.624cc160.js";import"./DocPNG.a342a686.js";import"./DocPDF.fb7dc3da.js";import"./Search.9640e116.js";import"./Adjust.a5525412.js";import"./TableHeaderEye.29c5a173.js";import"./Times.6df50bd1.js";import"./ClearAll.97c2826a.js";import"./client-only.5e00cd21.js";import"./ClearEach.d7c9db46.js";import"./CaretLeftDoubleBold.6054d945.js";import"./CaretLeftBold.22725d66.js";import"./CaretRightBold.88fb98f8.js";import"./CaretRightDoubleBold.da5f141c.js";const st=J(()=>Y(()=>import("./PopupMini.67ffcb9d.js"),["./PopupMini.67ffcb9d.js","./PopupMini.vue.c7d51fd5.js","./Times.6df50bd1.js","./_plugin-vue_export-helper.c27b6911.js","./entry.d9b45284.js","./entry.683d558b.css","./Exclamation.e80b265e.js"],import.meta.url).then(d=>d.default||d)),rt=J(()=>Y(()=>import("./employee.8a727e23.js"),["./employee.8a727e23.js","./HeaderPopup.vue.d6400a7b.js","./Times.6df50bd1.js","./_plugin-vue_export-helper.c27b6911.js","./entry.d9b45284.js","./entry.683d558b.css","./client-only.5e00cd21.js","./InputPointFormat.vue.22dc4e53.js","./Eyes.3aa9f1c8.js","./EyesOff.86643108.js","./AttachmentSingleV1.2ef1472f.js","./AttachmentSingleV1.1c5a519c.css","./useMyFetch.405cdccc.js"],import.meta.url).then(d=>d.default||d)),it=J(()=>Y(()=>import("./employee_validasi.e3235f54.js"),["./employee_validasi.e3235f54.js","./HeaderPopup.vue.d6400a7b.js","./Times.6df50bd1.js","./_plugin-vue_export-helper.c27b6911.js","./entry.d9b45284.js","./entry.683d558b.css","./AttachmentSingleV1.2ef1472f.js","./AttachmentSingleV1.1c5a519c.css","./useUtils.ab60562a.js","./useMyFetch.405cdccc.js"],import.meta.url).then(d=>d.default||d)),O=d=>(He("data-v-bb03d8b4"),d=d(),Je(),d),ut={class:"w-full h-full flex flex-col"},dt={class:"w-full flex grow flex-col overflow-auto h-0"},_t={class:"w-full flex justify-between flex-wrap"},mt={class:"grow flex"},pt={class:"m-1"},vt=O(()=>i("option",{value:"available"},"Available",-1)),ct=O(()=>i("option",{value:"unapprove"},"Unapprove",-1)),ft=O(()=>i("option",{value:"deleted"},"Trash",-1)),yt=O(()=>i("option",{value:"all"},"All",-1)),bt=[vt,ct,ft,yt],kt={class:"grow mb-5"},ht={class:"text-red-500"},gt=O(()=>i("br",null,null,-1)),xt=O(()=>i("b",{class:"text-green-500"},"Kembali Bekerja ",-1)),wt={__name:"index",async setup(d){let M,q;const ne=e=>e.deleted==1?"!bg-red-400":e.val==0||e.val1==0?"!bg-gray-300":"",b=r("available");K(()=>b.value,e=>{Q()},{immediate:!1});const c={};c._TimeZoneOffset=new Date().getTimezoneOffset();const T=ze("token"),{data:se}=([M,q]=Fe(async()=>Ue(async()=>{let e=[];m().loading_full=!0;const{data:t,error:v,status:k}=await E("/employees",{method:"get",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},params:{filter_status:b},retry:0});return m().loading_full=!1,k.value==="error"?(B().trigger(v),[]):(e=t.value.data,{employees:e})},{lazy:!0,server:!1,default:()=>({employees:[]})},"$p5jj5crAgd")),M=await M,q(),M),o=r([]);K(()=>{var e;return(e=se.value)==null?void 0:e.employees},e=>{e&&(o.value=[...e])},{immediate:!0});const R=r({field:"",by:"desc"}),l=r(-1),f=r({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),_=h(()=>o.value[l.value]),re=()=>{c.like="";let e=JSON.parse(JSON.stringify(m()._tv.global_keyword));e!=""&&(c.like=`id:%${e}%,name:%${e}%,ktp_no:%${e}%,sim_no:%${e}%,phone_number:%${e}%,rek_no:%${e}%`),c.sort="",R.value.field&&(c.sort=R.value.field+":"+R.value.by),c.filter_model=JSON.stringify(m()._tv.filter_model)},G=r(null),Z=async()=>{m().loading_full=!0,f.value.may_get_data=!1,c.page=f.value.page,c.page==1&&(o.value=[]),c.filter_status=b.value;const{data:e,error:t,status:v}=await E("/employees",{method:"get",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},params:c,retry:0});if(m().loading_full=!1,f.value.may_get_data=!0,v.value==="error"){B().trigger(t);return}f.value.page==1?(o.value=e.value.data,G.value&&(G.value.scrollTop=0)):f.value.page>1&&(o.value=[...o.value,...e.value.data]),e.value.data.length==0&&(f.value.is_last_record=!0),m()._tv.filter_box=!1},Q=()=>{l.value=-1,f.value.page=1,f.value.is_last_record=!1,re(),Z()};Ne();const z=r(!1),V=r(0),C=r(0),A=r(1),ie=()=>{V.value=0,A.value=-1,C.value=!1,z.value=!0},{display:w}=le();Le(le());const ue=()=>{l.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(V.value=o.value[l.value].id,A.value=-1,C.value=!1,z.value=!0)},$=r(!1),F=r(0),de=()=>{l.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=o.value[l.value].id,A.value=1,C.value=!1,$.value=!0)},_e=()=>{l.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=o.value[l.value].id,A.value=0,C.value=!1,$.value=!0)},me=()=>{l.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(F.value=o.value[l.value].id,C.value=!1,A.value=-1,$.value=!0)},U=r(!1),W=r({}),I=r(!1),S=r(""),pe=async()=>{I.value&&(I.value=!1)},ve=()=>{l.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(S.value="",W.value={id:o.value[l.value].id},I.value=!0)},N=r(!1),ce=()=>{l.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):N.value=!0};K(()=>S.value,e=>{e.trim().length>0?U.value=!0:U.value=!1},{immediate:!1});const fe=async()=>{m().loading_full=!0;const e=new FormData;e.append("id",o.value[l.value].id),e.append("deleted_reason",S.value),e.append("_method","DELETE");const{data:t,error:v,status:k}=await E("/employee",{method:"post",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},body:e,retry:0});if(m().loading_full=!1,k.value==="error"){B().trigger(v);return}let s={...o.value[l.value]};s.deleted=t.value.deleted,s.deleted_user=t.value.deleted_user,s.deleted_at=t.value.deleted_at,s.deleted_by=t.value.deleted_by,s.deleted_reason=t.value.deleted_reason,b.value!="all"?o.value.splice(l.value,1):o.value.splice(l.value,1,{...s}),l.value=-1,I.value=!1},ye=async()=>{m().loading_full=!0;const e=new FormData;e.append("id",o.value[l.value].id),e.append("_method","PUT");const{data:t,error:v,status:k}=await E("/employee_unremove",{method:"post",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},body:e,retry:0});if(m().loading_full=!1,k.value==="error"){B().trigger(v);return}let s={...o.value[l.value]};s.deleted=t.value.deleted,s.deleted_user=t.value.deleted_user,s.deleted_at=t.value.deleted_at,s.deleted_by=t.value.deleted_by,s.deleted_reason=t.value.deleted_reason,b.value!="all"?o.value.splice(l.value,1):o.value.splice(l.value,1,{...s}),l.value=-1,N.value=!1},be=()=>{l.value==-1?w({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):ke()},ke=async()=>{m().loading_full=!0;const e=new FormData;e.append("id",o.value[l.value].id),e.append("_method","PUT");const{data:t,error:v,status:k}=await E("/employee_generate_code",{method:"post",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},body:e,retry:0});if(m().loading_full=!1,k.value==="error"){B().trigger(v);return}let s={...o.value[l.value]};s.m_enkey=t.value.m_enkey,o.value.splice(l.value,1,{...s})},he=r([{key:"no",label:"No",isai:!0},{key:"val",label:"APP",childs:[{key:"val",label:"Logistik",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val1",label:"Kasir",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]}]},{key:"m_enkey",label:"Kode Kunci",filter_on:1},{key:"username",label:"Username",filter_on:1},{key:"id",label:"ID",freeze:1,filter_on:1,type:"number"},{key:"name",label:"Nama",freeze:1,freeze_left:"44px",filter_on:1,type:"string",sort:{priority:1,type:"asc"}},{key:"role",label:"Jabatan",filter_on:1,type:"string"},{key:"ktp_no",label:"No KTP",filter_on:1,type:"string"},{key:"sim_no",label:"No SIM",filter_on:1,type:"string"},{key:"sim_name",label:"Nama SIM",filter_on:1,type:"string"},{key:"bank_code",label:"Nama Bank",filter_on:1,type:"string"},{key:"rek_no",label:"No Rek",filter_on:1,type:"string"},{key:"rek_name",label:"Nama Rek",filter_on:1,type:"string"},{key:"phone_number",label:"No Tlp",filter_on:1,type:"string"},{key:"birth_place",label:"Tempat Lahir",filter_on:1,type:"string"},{key:"birth_date",label:"Tanggal Lahir",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"tmk",label:"TMK",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"address",label:"Alamat",filter_on:1,type:"string"},{key:"status",label:"Status",filter_on:1,type:"string"},{key:"workers_from",label:"Pekerja dari",filter_on:1,type:"string"},{key:"attachment_1_type",label:"File",type:"string"},{key:"bpjs_kesehatan",label:"BPJS Kesehatan",class:" justify-end",type:"number",filter_on:1},{key:"bpjs_jamsos",label:"BPJS Jamsos",class:" justify-end",type:"number",filter_on:1},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]);h(()=>l.value>-1&&[void 0,0].indexOf(_.value.deleted)>-1&&y().checkPermission("employee.create"));const ge=h(()=>["available","all","unapprove"].indexOf(b.value)>-1&&y().checkPermission("employee.create")),xe=h(()=>l.value>-1&&[void 0,0].indexOf(_.value.deleted)>-1&&(y().checkPermission("employee.val")&&[void 0,0].indexOf(_.value.val)>-1||y().checkPermission("employee.val1")&&[void 0,0].indexOf(_.value.val1)>-1)&&y().checkPermissions(["employee.modify","employee.detail.modify","employee.detail2.modify"])),we=h(()=>l.value>-1&&[void 0,0].indexOf(_.value.deleted)>-1&&(y().checkPermission("employee.val")&&[void 0,0].indexOf(_.value.val)>-1||y().checkPermission("employee.val1")&&[void 0,0].indexOf(_.value.val1)>-1)),De=h(()=>l.value>-1&&[void 0,0].indexOf(_.value.deleted)>-1&&y().checkPermission("employee.unval")&&[1].indexOf(_.value.val)>-1),Pe=h(()=>l.value>-1&&y().checkPermission("employee.remove")&&[void 0,0].indexOf(_.value.deleted)>-1),Ce=h(()=>l.value>-1&&y().checkPermission("employee.unremove")&&[1].indexOf(_.value.deleted)>-1),Ae=h(()=>l.value>-1&&[void 0,0].indexOf(_.value.deleted)>-1&&[1].indexOf(_.value.val)>-1);return(e,t)=>{const v=Ye,k=qe,s=Ge,Se=Ze,Oe=Qe,Te=We,$e=Xe,Ie=et,X=tt,ee=lt,je=at,Be=ot,te=st,Ee=rt,Me=it;return p(),g(Ve,null,[i("div",ut,[u(v,{title:"List Employee"}),i("div",dt,[i("div",_t,[i("div",mt,[i("div",pt,[ae(i("select",{class:"","onUpdate:modelValue":t[0]||(t[0]=n=>oe(b)?b.value=n:null)},bt,512),[[Re,a(b)]])]),a(ge)?(p(),g("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=n=>ie())},[u(k)])):x("",!0),a(xe)?(p(),g("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=n=>ue())},[u(s)])):x("",!0),a(l)>-1?(p(),g("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[3]||(t[3]=n=>me())},[u(Se)])):x("",!0),a(Pe)?(p(),g("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[4]||(t[4]=n=>ve())},[u(Oe)])):x("",!0),a(Ce)?(p(),g("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[5]||(t[5]=n=>ce())},[u(Te)])):x("",!0),a(we)?(p(),g("button",{key:5,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[6]||(t[6]=n=>de())},[u($e)])):x("",!0),a(De)?(p(),g("button",{key:6,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[7]||(t[7]=n=>_e())},[u(Ie)])):x("",!0),a(Ae)?(p(),g("button",{key:7,type:"button",name:"button",class:"m-1 text-sm",onClick:t[8]||(t[8]=n=>be())}," GEN CODE ")):x("",!0)])]),u(Be,{thead:a(he),selected:a(l),onSetSelected:t[9]||(t[9]=n=>l.value=n),tbody:a(o),fnCallData:Z,scrolling:a(f),onSetScrollingPage:t[10]||(t[10]=n=>a(f).page=n),onDoFilter:t[11]||(t[11]=n=>Q()),rowBgColor:ne},{val:D(({item:n})=>[n.val?(p(),L(ee,{key:1})):(p(),L(X,{key:0}))]),val1:D(({item:n})=>[n.val1?(p(),L(ee,{key:1})):(p(),L(X,{key:0}))]),bank_code:D(({item:n})=>{var j;return[P(H((j=n.bank)==null?void 0:j.code),1)]}),attachment_1_type:D(({item:n})=>[u(je,{value:n.attachment_1_type},null,8,["value"])]),deleted_by_username:D(({item:n})=>{var j;return[P(H((j=n.deleted_by)==null?void 0:j.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])])]),u(te,{type:"delete",show:a(I),data:a(W),fnClose:pe,fnConfirm:fe,enabledOk:a(U)},{footer:D(()=>[P(" Masukkan Alasan Penghapusan: "),i("div",kt,[ae(i("textarea",{"onUpdate:modelValue":t[12]||(t[12]=n=>oe(S)?S.value=n:null)},null,512),[[Ke,a(S)]])])]),_:1},8,["show","data","enabledOk"]),u(Ee,{show:a(z),fnClose:()=>{z.value=!1},id:a(V),p_data:a(o),is_copy:a(C)},null,8,["show","fnClose","id","p_data","is_copy"]),u(Me,{show:a($),fnClose:()=>{$.value=!1},id:a(F),p_data:a(o),it_state:a(A)},null,8,["show","fnClose","id","p_data","it_state"]),u(te,{type:"custome",show:a(N),fnClose:()=>N.value=!1,fnConfirm:ye},{words:D(()=>[P(" Alasan Keluar Sebelumnya : "),i("b",ht,H(a(o)[a(l)].deleted_reason),1),P(". "),gt,P(" Pekerja telah "),xt,P(" , yakin untuk melanjutkan ? ")]),_:1},8,["show","fnClose"])],64)}}},tl=nt(wt,[["__scopeId","data-v-bb03d8b4"]]);export{tl as default};
