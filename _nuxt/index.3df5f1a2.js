import he from"./Header.246c6796.js";import ye from"./Copy.4bbd302f.js";import ge from"./Plus.8fcd4d66.js";import ke from"./Edit.390a3d12.js";import be from"./Eyes.97dd96f8.js";import we from"./Delete.51a5ff69.js";import xe from"./Signature.16ef71ae.js";import De from"./Search.3e578fc6.js";import Ce from"./Line.f306c4dc.js";import $e from"./Check.8fb8548e.js";import{_ as Ae}from"./PopupMini.vue.99ca6e34.js";import Se from"./standby_mst.aac3941d.js";import Te from"./standby_mst_validasi.b4b506f9.js";import{h as Me,k as Ue,r as n,i as Fe,z as Y,A as Ie,I as Le,c as _,b as d,a as e,m as o,G as T,n as M,q as J,B as K,C as q,s as Pe,F as Be,D as Re,w as Ve,l as ze,x as y,y as R,o as c,E as Ee,J as U,t as v,d as He,H as Ne}from"./entry.f3cbd76a.js";import{u as x}from"./useUtils.b8cd834f.js";import{u as V}from"./useMyFetch.508de42b.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.8933bed3.js";import"./Exclamation.583a6f40.js";import"./HeaderPopup.vue.ba459e4c.js";import"./Tools.713b8a83.js";import"./InputPointFormat.vue.41c9627c.js";import"./ToolsPopup.12dd028a.js";import"./ac_accs.d00093cf.js";const je={class:"w-full h-full flex flex-col"},Oe={class:"w-full flex grow flex-col overflow-auto h-0"},Ye={class:"w-full flex"},Je={action:"#",class:"w-full flex p-1"},Ke={class:"grow"},qe=e("div",{class:"font-bold"}," Keyword ",-1),Ge={class:"pl-1"},Ze=e("div",{class:"font-bold"}," Sort By ",-1),Qe=e("option",{value:""},null,-1),We=e("option",{value:"id"},"ID",-1),Xe=e("option",{value:"name"},"Name",-1),et=e("option",{value:"tipe"},"Tipe",-1),tt=[Qe,We,Xe,et],st={class:"pl-1"},ot=e("div",{class:"font-bold"}," Sort Order ",-1),at=e("option",{value:"asc"},"Asc",-1),lt=e("option",{value:"desc"},"Desc",-1),nt=[at,lt],it={class:"flex items-end pl-1"},ut={class:"w-full flex justify-center items-center grow h-0 p-1"},rt={key:0,class:""},ct={class:"tacky"},dt=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"App 2"),e("th",null,"ID"),e("th",null,"Name"),e("th",null,"Tipe"),e("th",null,"Amount"),e("th",null,"Peralihan"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),_t=["onClick"],mt={class:"flex items-center justify-center"},pt={class:"flex items-center justify-center"},ft={class:"bold"},vt={class:"grow mb-5"},jt={__name:"index",async setup(ht){let D,z;const{$moment:E}=Ne(),{pointFormat:G}=x(),u={};u._TimeZoneOffset=new Date().getTimezoneOffset(),u.sort="created_at:desc";const F=Me("token"),{data:Z}=([D,z]=Ue(async()=>ze(async()=>{let t=[];y().loading_full=!0;const{data:s,error:f,status:w}=await V("/standby_msts",{method:"get",headers:{Authorization:`Bearer ${F.value}`,Accept:"application/json"},params:u,retry:0});return y().loading_full=!1,w.value==="error"?(R().trigger(f),{standby_msts:t}):(t=s.value.data,{standby_msts:t})},"$rczbThuP8g")),D=await D,z(),D),l=n(Z.value.standby_msts),m=n(""),p=n({field:"created_at",by:"desc"}),i=n(-1),r=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),Q=()=>{u.like="",m.value!=""&&(u.like=`id:%${m.value}%,name:%${m.value}%,amount:%${m.value}%`),u.sort="",p.value.field&&(u.sort=p.value.field+":"+p.value.by)},C=n(null),H=async()=>{y().loading_full=!0,r.value.may_get_data=!1,u.page=r.value.page,u.page==1&&(l.value=[]),u.first_row&&delete u.first_row,u.page>1&&(u.first_row=JSON.stringify(l.value[0]));const{data:t,error:s,status:f}=await V("/standby_msts",{method:"get",headers:{Authorization:`Bearer ${F.value}`,Accept:"application/json"},params:u,retry:0});if(y().loading_full=!1,r.value.may_get_data=!0,f.value==="error"){R().trigger(s);return}r.value.page==1?(l.value=t.value.data,C.value&&(C.value.scrollTop=0)):r.value.page>1&&(l.value=[...l.value,...t.value.data]),t.value.data.length==0&&(r.value.is_last_record=!0)},W=async()=>{if(!r.value.may_get_data)return;let t=C.value;if(t.scrollLeft!=r.value.scrollLeft){r.value.scrollLeft=t.scrollLeft;return}r.value.is_last_record||!(Math.round(t.scrollTop)+t.clientHeight>=t.scrollHeight-1)||(r.value.page++,await H())},X=()=>{r.value.page=1,r.value.is_last_record=!1,Q(),H()};Fe();const g=n(!1),$=n(0),A=n(0),ee=()=>{$.value=0,g.value=!0,A.value=!1},{display:k}=Y();Ie(Y());const te=()=>{i.value==-1?k({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):($.value=l.value[i.value].id,g.value=!0,A.value=!1)},se=()=>{i.value==-1?k({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):($.value=l.value[i.value].id,g.value=!0,A.value=!0)},S=n(!1),I=n(0),L=n(!1),oe=()=>{i.value==-1?k({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(I.value=l.value[i.value].id,S.value=!0,L.value=!1)},ae=()=>{i.value==-1?k({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(I.value=l.value[i.value].id,S.value=!0,L.value=!0)},P=n(!1),N=n({}),b=n(!1),h=n(""),le=async()=>{b.value&&(b.value=!1)},ne=()=>{i.value==-1?k({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(h.value="",N.value={id:l.value[i.value].id},b.value=!0)};Le(()=>h.value,t=>{t.trim().length>0?P.value=!0:P.value=!1},{immediate:!1});const ie=async()=>{y().loading_full=!0;const t=new FormData;t.append("id",l.value[i.value].id),t.append("deleted_reason",h.value),t.append("_method","DELETE");const{data:s,error:f,status:w}=await V("/standby_mst",{method:"post",headers:{Authorization:`Bearer ${F.value}`,Accept:"application/json"},body:t,retry:0});if(y().loading_full=!1,w.value==="error"){R().trigger(f);return}l.value.splice(i.value,1),i.value=-1,b.value=!1};return(t,s)=>{const f=he,w=ye,ue=ge,re=ke,ce=be,de=we,_e=xe,me=De,j=Ce,O=$e,pe=Ae,fe=Se,ve=Te;return c(),_("div",je,[d(f,{title:"List Standby"}),e("div",Oe,[e("div",Ye,[("useUtils"in t?t.useUtils:o(x))().checkRole(["Logistic"])?T("",!0):(c(),_("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[0]||(s[0]=a=>se())},[d(w)])),("useUtils"in t?t.useUtils:o(x))().checkRole(["Logistic"])?T("",!0):(c(),_("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[1]||(s[1]=a=>ee())},[d(ue)])),("useUtils"in t?t.useUtils:o(x))().checkRole(["Logistic"])?T("",!0):(c(),_("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[2]||(s[2]=a=>te())},[d(re)])),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:s[3]||(s[3]=a=>ae())},[d(ce)]),("useUtils"in t?t.useUtils:o(x))().checkRole(["PabrikTransport"])?T("",!0):(c(),_("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[4]||(s[4]=a=>ne())},[d(de)])),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:s[5]||(s[5]=a=>oe())},[d(_e)])]),e("form",Je,[e("div",Ke,[qe,M(e("input",{class:"",type:"text","onUpdate:modelValue":s[6]||(s[6]=a=>K(m)?m.value=a:null),name:"search",placeholder:"Keyword"},null,512),[[J,o(m)]])]),e("div",Ge,[Ze,M(e("select",{class:"","onUpdate:modelValue":s[7]||(s[7]=a=>o(p).field=a)},tt,512),[[q,o(p).field]])]),e("div",st,[ot,M(e("select",{class:"","onUpdate:modelValue":s[8]||(s[8]=a=>o(p).by=a)},nt,512),[[q,o(p).by]])]),e("div",it,[e("button",{class:"",type:"submit",name:"button",onClick:s[9]||(s[9]=Pe(a=>X(),["prevent"]))},[d(me,{class:"text-2xl"})])])]),e("div",ut,[o(l).length==0?(c(),_("div",rt," Maaf Tidak Ada Record ")):(c(),_("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:C,onScroll:W},[e("table",ct,[dt,e("tbody",null,[(c(!0),_(Be,null,Re(o(l),(a,B)=>(c(),_("tr",{key:B,onClick:yt=>i.value=B,class:Ee(o(i)==B?"active":"")},[e("td",null,[e("div",mt,[a.val?(c(),U(O,{key:1})):(c(),U(j,{key:0}))])]),e("td",null,[e("div",pt,[a.val1?(c(),U(O,{key:1})):(c(),U(j,{key:0}))])]),e("td",ft,v(a.id),1),e("td",null,v(a.name),1),e("td",null,v(a.tipe),1),e("td",null,v(o(G)(a.amount)),1),e("td",null,v(a.is_transition?"Ya":"Tidak"),1),e("td",null,v(a.created_at?o(E)(a.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,v(a.updated_at?o(E)(a.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,_t))),128))])])],544))])]),d(pe,{type:"delete",show:o(b),data:o(N),fnClose:le,fnConfirm:ie,enabledOk:o(P)},{footer:Ve(()=>[He(" Masukkan Alasan Penghapusan: "),e("div",vt,[M(e("textarea",{"onUpdate:modelValue":s[10]||(s[10]=a=>K(h)?h.value=a:null)},null,512),[[J,o(h)]])])]),_:1},8,["show","data","enabledOk"]),d(fe,{show:o(g),fnClose:()=>{g.value=!1},id:o($),p_data:o(l),is_copy:o(A)},null,8,["show","fnClose","id","p_data","is_copy"]),d(ve,{show:o(S),fnClose:()=>{S.value=!1},id:o(I),p_data:o(l),is_view:o(L)},null,8,["show","fnClose","id","p_data","is_view"])])}}};export{jt as default};
