import de from"./Header.3747b0a6.js";import me from"./Plus.6191db42.js";import pe from"./Edit.530bc107.js";import ce from"./Eyes.6d87babb.js";import fe from"./Signature.4980b60a.js";import ve from"./Line.9d8a4c99.js";import ye from"./Check.1299b720.js";import ge from"./TableView.ddfe514a.js";import be from"./mst.5cc0113c.js";import ke from"./validasi.f4873910.js";import{r as a,f as V,g as he,h as we,i as p,B as xe,j as z,s as De,c as w,b as d,a as _,k as Pe,v as Se,l,m as Ce,n as P,w as S,q as Ae,x as c,y as J,o as u,z as C,d as E,t as R}from"./entry.bf605837.js";import{u as f}from"./useUtils.fcb0bcb4.js";import{u as L}from"./useMyFetch.9c1d1cb2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.5bebc889.js";import"./Adjust.1c236050.js";import"./TableHeaderEye.2f1ff207.js";import"./Times.2afba606.js";import"./ClearAll.30a0aefc.js";import"./client-only.6510e0be.js";import"./ClearEach.ef65f15e.js";import"./CaretLeftDoubleBold.e7ba5515.js";import"./CaretLeftBold.34ff96cd.js";import"./CaretRightBold.ee8d2d47.js";import"./CaretRightDoubleBold.422c9d47.js";import"./HeaderPopup.vue.5964ff22.js";import"./WidthMiniList.vue.ac332e3b.js";import"./WidthMiniPart.vue.797d7418.js";import"./InputPointFormat.vue.278d52b8.js";import"./AttachmentSingle.4444c3de.js";import"./PDFJsView.b0cee90a.js";import"./part.696b22f2.js";import"./Calculator.ad211650.js";import"./trx.a77594b0.js";import"./trx_validasi.de65e302.js";const Oe={class:"w-full h-full flex flex-col"},$e={class:"w-full flex grow flex-col overflow-auto h-0"},je={class:"w-full flex justify-between flex-wrap"},Ne={class:"grow flex"},Be={class:"m-1"},Me=_("option",{value:"undone"},"Undone",-1),Te=_("option",{value:"done"},"Done",-1),He=_("option",{value:"deleted"},"Trash",-1),Fe=_("option",{value:"all"},"All",-1),Ie=[Me,Te,He,Fe],ht={__name:"index",async setup(Ue){let x,N;const Y=e=>e.deleted==1?"!bg-red-400":e.val>0&&e.val1>0&&e.remaining_cut==0?"!bg-blue-300":"",m=a("undone");V(()=>m.value,e=>{T()},{immediate:!1});const n={};n._TimeZoneOffset=new Date().getTimezoneOffset(),n.sort="created_at:desc";const B=he("token"),{data:q}=([x,N]=we(async()=>Ae(async()=>{let e=[];c().loading_full=!0;const{data:t,error:k,status:j}=await L("/potongan_msts",{method:"get",headers:{Authorization:`Bearer ${B.value}`,Accept:"application/json"},params:{filter_status:m},retry:0});return c().loading_full=!1,j.value==="error"?(J().trigger(k),{potongan_msts:e}):(e=t.value.data,{potongan_msts:e})},"$4H5grU4zhJ")),x=await x,N(),x),r=a(q.value.potongan_msts);a("");const A=a({field:"created_at",by:"desc"}),s=a(-1),i=a({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),v=p(()=>r.value[s.value]),K=()=>{n.like="";let e=JSON.parse(JSON.stringify(c()._tv.global_keyword));e!=""&&(n.like=`id:%${e}%,employee_name:%${e}%,no_pol:%${e}%,kejadian:%${e}%,status:%${e}%`),n.sort="",A.value.field&&(n.sort=A.value.field+":"+A.value.by),n.filter_model=JSON.stringify(c()._tv.filter_model)};a(null);const M=async()=>{c().loading_full=!0,i.value.may_get_data=!1,n.page=i.value.page,n.page==1&&(r.value=[]),n.first_row&&delete n.first_row,n.page>1&&(n.first_row=JSON.stringify(r.value[0])),n.filter_status=m.value;const{data:e,error:t,status:k}=await L("/potongan_msts",{method:"get",headers:{Authorization:`Bearer ${B.value}`,Accept:"application/json"},params:n,retry:0});if(c().loading_full=!1,i.value.may_get_data=!0,k.value==="error"){J().trigger(t);return}i.value.page==1?r.value=e.value.data:i.value.page>1&&(r.value=[...r.value,...e.value.data]),e.value.data.length==0&&(i.value.is_last_record=!0),c()._tv.filter_box=!1},T=()=>{s.value=-1,i.value.page=1,i.value.is_last_record=!1,K(),M()};xe();const y=a(!1),D=a(0),g=a(0),b=a(!1),Z=()=>{D.value=0,b.value=!1,g.value=!1,y.value=!0},{display:O}=z();De(z());const G=()=>{s.value==-1?O({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(D.value=r.value[s.value].id,b.value=!1,g.value=!1,y.value=!0)},$=a(!1),H=a(0),Q=()=>{s.value==-1?O({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(H.value=r.value[s.value].id,b.value=!0,g.value=!1,$.value=!0)},W=()=>{s.value==-1?O({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(D.value=r.value[s.value].id,b.value=!0,g.value=!1,y.value=!0)},F=a(!1);a({}),a(!1);const X=a("");V(()=>X.value,e=>{e.trim().length>0?F.value=!0:F.value=!1},{immediate:!1});const ee=a([{key:"no",label:"No",isai:!0},{key:"valx",label:"APP",childs:[{key:"val",label:"App 1",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val1",label:"App 2",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]}]},{key:"id",label:"ID",filter_on:1,type:"number",sort:{priority:1,type:"desc"}},{key:"employee_name",label:"Nama Pekerja",freeze:1,filter_on:1,type:"string"},{key:"no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"kejadian",label:"Kejadian",filter_on:1,type:"string"},{key:"nominal",label:"Nominal",class:" justify-end",type:"number"},{key:"nominal_cut",label:"Nominal Potongan",class:" justify-end",type:"number"},{key:"remaining_cut",label:"Sisa Potongan",class:" justify-end",type:"number"},{key:"status",label:"Status",class:" justify-end",type:"number"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]);p(()=>s.value>-1&&[void 0,0].indexOf(v.value.deleted)>-1&&f().checkPermission("potongan_mst.create"));const te=p(()=>["undone","done","deleted","all"].indexOf(m.value)>-1&&f().checkPermission("potongan_mst.create")),oe=p(()=>s.value>-1&&f().checkPermission("potongan_mst.view")),ae=p(()=>s.value>-1&&[void 0,0].indexOf(v.value.deleted)>-1&&f().checkPermissions(["potongan_mst.modify","potongan_trx.create","potongan_trx.modify","potongan_trx.remove"])),le=p(()=>s.value>-1&&[void 0,0].indexOf(v.value.deleted)>-1&&(f().checkPermission("potongan_mst.val")&&[void 0,0].indexOf(v.value.val)>-1||f().checkPermission("potongan_mst.val1")&&[void 0,0].indexOf(v.value.val1)>-1));return p(()=>s.value>-1&&f().checkPermission("potongan_mst.remove")&&[void 0,0].indexOf(v.value.deleted)>-1),(e,t)=>{const k=de,j=me,ne=pe,se=ce,re=fe,I=ve,U=ye,ie=ge,ue=be,_e=ke;return u(),w("div",Oe,[d(k,{title:"List Potongan"}),_("div",$e,[_("div",je,[_("div",Ne,[_("div",Be,[Pe(_("select",{class:"","onUpdate:modelValue":t[0]||(t[0]=o=>Ce(m)?m.value=o:null)},Ie,512),[[Se,l(m)]])]),l(te)?(u(),w("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=o=>Z())},[d(j)])):P("",!0),l(ae)?(u(),w("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=o=>G())},[d(ne)])):P("",!0),l(oe)?(u(),w("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[3]||(t[3]=o=>W())},[d(se)])):P("",!0),l(le)?(u(),w("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[4]||(t[4]=o=>Q())},[d(re)])):P("",!0)])]),d(ie,{thead:l(ee),selected:l(s),onSetSelected:t[5]||(t[5]=o=>s.value=o),tbody:l(r),fnCallData:M,scrolling:l(i),onSetScrollingPage:t[6]||(t[6]=o=>l(i).page=o),onDoFilter:t[7]||(t[7]=o=>T()),rowBgColor:Y},{val:S(({item:o})=>[o.val?(u(),C(U,{key:1})):(u(),C(I,{key:0}))]),val1:S(({item:o})=>[o.val1?(u(),C(U,{key:1})):(u(),C(I,{key:0}))]),employee_name:S(({item:o})=>{var h;return[E(R((h=o.employee)==null?void 0:h.name),1)]}),deleted_by_username:S(({item:o})=>{var h;return[E(R((h=o.deleted_by)==null?void 0:h.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])]),d(ue,{show:l(y),fnClose:()=>{y.value=!1},id:l(D),p_data:l(r),is_copy:l(g),is_view:l(b)},null,8,["show","fnClose","id","p_data","is_copy","is_view"]),d(_e,{show:l($),fnClose:()=>{$.value=!1},id:l(H),p_data:l(r)},null,8,["show","fnClose","id","p_data"])])}}};export{ht as default};
