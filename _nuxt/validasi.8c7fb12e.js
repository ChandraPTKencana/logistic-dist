import{_ as M}from"./HeaderPopup.vue.46d7f32b.js";import{_ as V}from"./WidthMiniPart.vue.f0a4ac68.js";import q from"./AttachmentSingle.f1fe19ed.js";import{r as p,g as O,f as U,k as H,K as J,o as f,c as w,a,b as y,t as _,l as t,n as x,C as L,G as T,x as b,y as I,p as z,e as E}from"./entry.fa369e0d.js";import{u as $}from"./useUtils.9e7b4deb.js";import{u as j}from"./useMyFetch.c3981d40.js";import{_ as K}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.da78eaa7.js";import"./PDFJsView.c5aa5895.js";const m=i=>(z("data-v-db465220"),i=i(),E(),i),R={class:"box-fixed"},G={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},W={class:"w-full flex flex-col items-center grow overflow-auto"},Q={class:"w-full p-1"},X={class:"w-full flex flex-row flex-wrap bg-white"},Z={class:"w-full flex flex-col flex-wrap p-1"},ee=m(()=>a("label",{for:""},"Kejadian",-1)),te={class:"card-border"},ae={class:"w-full sm:w-9/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},le=m(()=>a("label",{for:""},"Pekerja",-1)),oe={class:"card-border"},se={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ne=m(()=>a("label",{for:""},"No Pol",-1)),ie={class:"card-border"},re={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},de=m(()=>a("label",{for:""},"Nominal",-1)),_e={class:"card-border"},ce={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ue=m(()=>a("label",{for:""},"Nominal Potong",-1)),me={class:"card-border"},ve={class:"w-full flex flex-col flex-wrap p-1"},pe={class:"w-full flex flex-col flex-wrap p-1"},fe={class:"w-full flex items-center justify-end"},we={class:"w-full flex flex-wrap p-3 items-center"},he=m(()=>a("div",null," Di Validasi oleh : ",-1)),ye={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},xe={key:0},be={key:1},ge={__name:"validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(i){const r=i,{$moment:g}=T(),k={id:-1,kejadian:"",employee:{id:-1,name:""},no_pol:"",nominal:0,nominal_cut:0,remaining_cut:0,status:"Open",attachment_1:"",attachment_1_preview:"",attachment_2:"",attachment_2_preview:"",val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:""},e=p({...k}),S=O("token"),N=p({}),C=p(null);p([]);const d=p(JSON.parse(JSON.stringify({_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:-1,name:"",title:""}))),B=async()=>{b().loading_full=!0,N.value={};const n=new FormData;let o="post",u=r.id;u==0||(n.append("id",u),n.append("_method","PUT"));const{data:l,error:c,status:s}=await j("/potongan_mst_validasi",{method:o,headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},body:n,retry:0});if(b().loading_full=!1,s.value==="error"){I().trigger(c,N);return}e.value.val=l.value.val,e.value.val_user=l.value.val_user,e.value.val_by=l.value.val_by,e.value.val_at=l.value.val_at,e.value.val1=l.value.val1,e.value.val1_user=l.value.val1_user,e.value.val1_by=l.value.val1_by,e.value.val1_at=l.value.val1_at;let v=r.p_data.map(h=>h.id).indexOf(r.id);v>-1&&r.p_data.splice(v,1,{...e.value}),r.fnClose()},Y=async()=>{var c,s,v,h,D,P,A,F;b().loading_full=!0;const{data:n,error:o,status:u}=await j("/potongan_mst",{method:"get",headers:{Authorization:`Bearer ${S.value}`,Accept:"application/json"},params:{id:r.id},retry:0});if(b().loading_full=!1,u.value==="error"){I().trigger(o);return}let l=n.value.data;e.value=l,d.value._.id.val=(c=l.employee)==null?void 0:c.id,d.value._.name.val=(s=l.employee)==null?void 0:s.name,d.value._.rek_no.val=(v=l.employee)==null?void 0:v.rek_no,d.value._.rek_name.val=(h=l.employee)==null?void 0:h.rek_name,d.value.id=(D=l.employee)==null?void 0:D.id,d.value.name=(P=l.employee)==null?void 0:P.name,d.value.rek_no=(((A=l.employee)==null?void 0:A.rek_no)||"")+" "+(((F=l.employee)==null?void 0:F.rek_name)||"")};return U(()=>r.show,(n,o)=>{n==!0&&(e.value=JSON.parse(JSON.stringify(k)),r.is_view==!1&&setTimeout(()=>{C.value.focus()},1),Y())},{immediate:!0}),(n,o)=>{const u=M,l=V,c=q;return H((f(),w("section",R,[a("div",null,[y(u,{title:"Form Transaction Standby Validation",fn:i.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),a("form",G,[a("div",W,[a("div",Q,[a("div",X,[a("div",Z,[ee,a("div",te,_(t(e).kejadian),1)]),a("div",ae,[le,a("div",oe,[y(l,{selected:t(d)},null,8,["selected"])])]),a("div",se,[ne,a("div",ie,_(t(e).no_pol),1)]),a("div",re,[de,a("div",_e,_(("useUtils"in n?n.useUtils:t($))().pointFormat(t(e).nominal)),1)]),a("div",ce,[ue,a("div",me,_(("useUtils"in n?n.useUtils:t($))().pointFormat(t(e).nominal_cut)),1)]),a("div",ve,[y(c,{label:"Lampiran Pertama",value:t(e).attachment_1_preview,onSetFile:o[0]||(o[0]=s=>t(e).attachment_1=s),onSetPreview:o[1]||(o[1]=s=>t(e).attachment_1_preview=s)},null,8,["value"])]),a("div",pe,[y(c,{label:"Lampiran Lanjutan",value:t(e).attachment_2_preview,onSetFile:o[2]||(o[2]=s=>t(e).attachment_2=s),onSetPreview:o[3]||(o[3]=s=>t(e).attachment_2_preview=s)},null,8,["value"])])])])]),a("div",fe,[a("div",we,[he,t(e).val||t(e).val1||t(e).val2?(f(),w("div",ye,[t(e).val?(f(),w("div",xe," App 1 : "+_(t(e).val_by.username)+" ( "+_(t(e).val_at?t(g)(t(e).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):x("",!0),t(e).val1?(f(),w("div",be," App 2 : "+_(t(e).val1_by.username)+" ( "+_(t(e).val1_at?t(g)(t(e).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):x("",!0)])):x("",!0)]),a("button",{type:"button",name:"button",class:"w-36 m-1",onClick:o[4]||(o[4]=s=>i.fnClose())}," Cancel "),i.is_view==0?(f(),w("button",{key:0,ref_key:"it_val",ref:C,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:o[5]||(o[5]=L(s=>B(),["prevent"]))}," Validasi ",512)):x("",!0)])])])],512)),[[J,i.show]])}}},je=K(ge,[["__scopeId","data-v-db465220"]]);export{je as default};
