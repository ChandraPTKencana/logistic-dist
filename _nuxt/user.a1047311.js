import{_ as $}from"./HeaderPopup.vue.92a07f81.js";import{r as x,g as j,i as P,f as z,k as p,K as I,o as g,c as k,a as e,b as q,l,A as y,t as _,v as M,E as T,m as E,F as O,D as H,J,C as K,x as v,y as S,p as R,e as G,H as Q}from"./entry.4ff6eaba.js";import{u as C}from"./useMyFetch.d6de1011.js";import{_ as W}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.221fc2d9.js";const f=d=>(R("data-v-2c9e23b9"),d=d(),G(),d),X={class:"box-fixed"},Y={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},Z={class:"w-full flex flex-col items-center grow overflow-auto"},ee={class:"w-full flex flex-row flex-wrap"},te={class:"w-full flex flex-col flex-wrap p-1"},ae=f(()=>e("label",{for:""},"Username",-1)),se={class:"text-red-500"},oe={class:"w-full flex flex-col flex-wrap p-1"},le=f(()=>e("label",{for:""},"Password",-1)),ne={class:"text-red-500"},ie={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},re=f(()=>e("label",{for:""},"Hak Akses",-1)),de=Q('<option value="PabrikTransport" data-v-2c9e23b9>Pabrik Transport</option><option value="PabrikMandor" data-v-2c9e23b9>Pabrik Mandor</option><option value="Logistic" data-v-2c9e23b9>Logisitic</option><option value="Finance" data-v-2c9e23b9>Finance</option><option value="Marketing" data-v-2c9e23b9>Marketing</option><option value="Accounting" data-v-2c9e23b9>Accounting</option><option value="MIS" data-v-2c9e23b9>MIS</option><option value="ViewOnly" data-v-2c9e23b9>ViewOnly</option><option value="SuperAdmin" data-v-2c9e23b9>SuperAdmin</option>',9),ue=[de],ce={class:"text-red-500"},pe={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},fe=f(()=>e("label",{for:""},"Status",-1)),_e=f(()=>e("option",{value:"1"},"Aktif",-1)),ve=f(()=>e("option",{value:"0"},"Nonaktif",-1)),me=[_e,ve],he={class:"text-red-500"},we={class:"w-full flex flex-col sm:flex-row grow p-1 justify-between flex-wrap 2xl:overflow-hidden"},xe={class:"w-full max-w-full p-0 2xl:pr-1 2xl:max-h-full 2xl:overflow-auto"},be={class:"w-full",role:"sticky"},ge={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},ke=f(()=>e("tr",{class:"sticky -top-1 !z-[2]"},[e("td",{colspan:"2",class:"!bg-slate-800 text-white font-bold"}," Detail Permission List ")],-1)),ye={class:"sticky top-7 !z-[2]"},Se={class:"min-w-[20px] !w-[20px] max-w-[20px]"},Ce={class:"w-full flex items-center"},Ae={ref:"to_move"},Ve={class:"!w-[10px]"},Pe={class:"w-full h-full flex items-center justify-center"},Me=["onUpdate:modelValue"],Ue={class:"w-full h-full flex items-center justify-start"},De={class:"w-full flex items-center justify-end"},Be={__name:"user",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(d){const r=d,A={id:-1,username:"",password:"",hak_akses:"PabrikTransport",is_active:1},s=x({...A}),b=j("token"),u=x({}),U=async()=>{v().loading_full=!0,u.value={};const o=new FormData;o.append("username",s.value.username),s.value.password&&o.append("password",s.value.password),o.append("hak_akses",s.value.hak_akses),o.append("is_active",s.value.is_active),o.append("permission_list",JSON.stringify(h.value));let t="post",i=r.is_copy?0:r.id;i==0||(o.append("id",i),o.append("_method","PUT"));const{data:a,error:w,status:c}=await C("/user",{method:t,headers:{Authorization:`Bearer ${b.value}`,Accept:"application/json"},body:o,retry:0});if(v().loading_full=!1,c.value==="error"){S().trigger(w,u);return}if(i<=0)s.value.id=a.value.id,s.value.created_at=a.value.created_at,s.value.updated_at=a.value.updated_at,r.p_data.unshift(s.value);else{s.value.updated_at=a.value.updated_at;let V=r.p_data.map(N=>N.id).indexOf(i);V>=-1&&r.p_data.splice(V,1,{...s.value})}r.fnClose()},D=async()=>{v().loading_full=!0;const{data:o,error:t,status:i}=await C("/user",{method:"get",headers:{Authorization:`Bearer ${b.value}`,Accept:"application/json"},params:{id:r.id},retry:0});if(v().loading_full=!1,i.value==="error"){S().trigger(t);return}s.value=o.value.data,o.value.data.details.forEach((a,w)=>{n.value=n.value.map(c=>(c.name==a.permission_list_name&&(c.checked=!0),c))})},n=x([]),B=async()=>{v().loading_full=!0;const{data:o,error:t,status:i}=await C("/permission_lists",{method:"get",headers:{Authorization:`Bearer ${b.value}`,Accept:"application/json"},params:{sort:"name:asc"},retry:0});if(v().loading_full=!1,i.value==="error"){S().trigger(t);return}n.value=o.value.data.map(a=>(a.checked=!1,a))},h=P(o=>n.value.filter(t=>t.checked)),F=o=>{h.value.length!=n.value.length?n.value=n.value.map(t=>(t.checked=!0,t)):n.value=n.value.map(t=>(t.checked=!1,t))},m=x(""),L=P(()=>m.value!=""?n.value.filter(o=>o.name.toLowerCase().includes(m.value.toLowerCase())):n.value);return z(()=>r.show,async(o,t)=>{o==!0&&(s.value={...A},n.value=[],await B(),u.value={},r.id!=0&&await D())},{immediate:!0}),(o,t)=>{const i=$;return p((g(),k("section",X,[e("div",null,[q(i,{title:"Form User",fn:d.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",Y,[e("div",Z,[e("div",ee,[e("div",te,[ae,p(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>l(s).username=a)},null,512),[[y,l(s).username]]),e("p",se,_(l(u).username),1)]),e("div",oe,[le,p(e("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=a=>l(s).password=a)},null,512),[[y,l(s).password]]),e("p",ne,_(l(u).password),1)]),e("div",ie,[re,p(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>l(s).hak_akses=a)},ue,512),[[M,l(s).hak_akses]]),e("p",ce,_(l(u).hak_akses),1)]),e("div",pe,[fe,p(e("select",{"onUpdate:modelValue":t[3]||(t[3]=a=>l(s).is_active=a)},me,512),[[M,l(s).is_active]]),e("p",he,_(l(u).is_active),1)])]),e("div",we,[e("div",xe,[e("div",be,[e("table",ge,[e("thead",null,[ke,e("tr",ye,[e("th",Se,[e("button",{type:"button",name:"button",class:T(["text-xs",l(h).length!=l(n).length?"bg-green-500":"bg-red-500"]),onClick:t[4]||(t[4]=a=>F())},_(l(h).length!=l(n).length?"Allow":"Deny"),3)]),e("th",null,[e("div",Ce,[p(e("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=a=>E(m)?m.value=a:null),name:"search",placeholder:"Name"},null,512),[[y,l(m)]])])])])]),e("tbody",Ae,[(g(!0),k(O,null,H(l(L),(a,w)=>(g(),k("tr",{key:w},[e("td",Ve,[e("div",Pe,[p(e("input",{type:"checkbox","onUpdate:modelValue":c=>a.checked=c,class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:bg-gray-700 dark:border-gray-600 cursor-pointer"},null,8,Me),[[J,a.checked]])])]),e("td",null,[e("div",Ue,_(a.name),1)])]))),128))],512)])])])])]),e("div",De,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:t[6]||(t[6]=a=>d.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:t[7]||(t[7]=K(a=>U(),["prevent"]))}," Save ")])])])],512)),[[I,d.show]])}}},ze=W(Be,[["__scopeId","data-v-2c9e23b9"]]);export{ze as default};
