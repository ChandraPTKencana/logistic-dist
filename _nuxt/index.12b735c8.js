import nt from"./Header.99d4c6f9.js";import it from"./PrinterEye.5fc7e249.js";import _t from"./Table2Column.d791053c.js";import ct from"./Line.b4e11f2e.js";import ut from"./Check.94583231.js";import dt from"./TableView.c23b557b.js";import pt from"./Times.ac9ba064.js";import{_ as ft}from"./HeaderPopup.vue.7637dd55.js";import{r as u,f as bt,g as mt,h as yt,x as d,i as kt,c as k,b as h,a as e,k as G,v as ht,l as a,m as vt,d as c,w as i,n as gt,K as xt,t as l,F as Z,D as Q,q as wt,y as N,o as f,E as Dt,z as $,H as Tt,G as Nt}from"./entry.11d2f466.js";import{u as W}from"./useUtils.c0fae8e9.js";import{u as A}from"./useMyFetch.d91d84b6.js";import{u as $t}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.61dff53c.js";import"./Adjust.defd87db.js";import"./TableHeaderEye.4fe86531.js";import"./ClearAll.7664ef97.js";import"./client-only.ca59d59e.js";import"./ClearEach.dd26dd89.js";import"./CaretLeftDoubleBold.94df4a27.js";import"./CaretLeftBold.e4f4fcce.js";import"./CaretRightBold.71422acc.js";import"./CaretRightDoubleBold.8ad9dd2b.js";const At={class:"w-full h-full flex flex-col"},St={class:"w-full flex grow flex-col overflow-auto h-0"},Ct={class:"w-full flex"},Mt={class:"m-1"},Pt=Tt('<option value="ticket_not_done">Undone</option><option value="ticket_done">Done</option><option value="deleted">Trash</option><option value="all">All</option><option value="req_deleted">Req Delete</option>',5),Bt=[Pt],Ft=e("span",{class:"text-xs ml-1"}," PDF ",-1),Ht=e("span",{class:"text-xs ml-1"}," Excel ",-1),Rt={key:0,class:"w-full h-full flex items-center justify-center fixed top-0 left-0 z-20 p-3",style:{"background-color":"rgba(255,255,255,0.9)"}},Yt={class:"relative",style:{width:"95%",height:"90%"}},Et={class:"absolute -top-7 right-0 bg-white",style:{position:"absolute",padding:"5px 10px",border:"solid 1px #ccc","border-bottom":"none","border-top-right-radius":"5px","border-top-left-radius":"5px"}},jt=["src"],qt={class:"w-full h-full fixed top-0 left-0 bg-gray-100 bg-opacity-80 flex items-center justify-center z-10"},zt={class:"w-full sm:w-10/12 md:w-8/12 lg:w-6/12 bg-white flex flex-col border-solid border-gray-200 max-w-full max-h-full",style:{"border-width":"1px"}},It={class:"p-1 flex flex-wrap overflow-auto items-start"},Kt={class:"w-full sm:w-1/2 flex flex-wrap"},Ot={class:"flex flex-col m-2"},Ut=e("span",{class:"text-xs"}," To ",-1),Vt={class:""},Jt={class:"flex flex-col m-2"},Lt=e("span",{class:"text-xs"}," Tipe ",-1),Gt={class:""},Zt={class:"flex flex-col m-2"},Qt=e("span",{class:"text-xs"}," Jenis ",-1),Wt={class:""},Xt={class:"flex flex-col m-2"},te=e("span",{class:"text-xs"}," Ket. Untuk Remarks ",-1),ee={class:""},se={class:"w-full sm:w-1/2 text-sm flex justify-center"},oe={class:"border border-collapse border-black"},ae=e("tr",null,[e("th",{colspan:"4",class:"bg-blue-400"}," List Uang Jalan ")],-1),le={class:"p-1"},re={class:"p-1"},ne=e("td",{class:"p-1"},"= Rp.",-1),ie={class:"text-right p-1"},_e={class:"border-t-black border-dashed",style:{"border-top-width":"1px"}},ce=e("th",{colspan:"2",class:"text-right"},"Total",-1),ue=e("th",{class:"p-1 text-right"},"Rp.",-1),de={class:"p-1 text-right"},pe={class:"w-full mt-2 text-sm flex justify-center"},fe={class:"border border-collapse border-black"},be=e("tr",null,[e("th",{colspan:"5",class:"bg-blue-400"}," List PVR ")],-1),me={class:"p-1"},ye={class:"p-1"},ke={class:"p-1"},he=e("td",{class:"p-1"},"= Rp.",-1),ve={class:"text-right p-1"},ge={class:"border-t-black border-dashed",style:{"border-top-width":"1px"}},xe=e("th",{colspan:"2",class:"text-right"},"Total",-1),we=e("th",{class:"p-1 text-right"},"Rp.",-1),De={class:"p-1 text-right"},Te={class:"flex p-1 justify-end flex-wrap"},We={__name:"index",async setup(Ne){let g,Y;const{$moment:E}=Nt(),{pointFormat:n}=W(),S=s=>s.deleted==1?"!bg-red-400":s.req_deleted==1?"!bg-yellow-300":s.val_ticket==1?"!bg-blue-300":"",C=s=>(s.map(o=>{o.class_h=S(o)}),s),m=u("ticket_not_done");bt(()=>m.value,s=>{K()},{immediate:!1});const r={};r._TimeZoneOffset=new Date().getTimezoneOffset(),r.sort="tanggal:desc";const j=u({}),x=mt("token"),w=u({from:"",to:""}),{data:X}=([g,Y]=yt(async()=>wt(async()=>{d().loading_full=!0;let s=[];const[o,_]=await Promise.all([A("/trx_trp_susuts/data",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:{filter_status:m},retry:0})]);return o.status.value!=="error"&&(s=C(o.data.value.data)),o.status.value==="error"?(N().trigger(o.error),{trx_trps:s}):(d().loading_full=!1,{trx_trps:s})},"$8KmJHfPiB5")),g=await g,Y(),g),y=u(X.value.trx_trps||[]),M=u({field:"tanggal",by:"desc"}),q=u(-1),p=u({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),P=()=>{r.like="";let s=JSON.parse(JSON.stringify(d()._tv.global_keyword));s!=""&&(r.like=`id:%${s}%,xto:%${s}%,jenis:%${s}%,pv_no:%${s}%,ticket_a_no:%${s}%,ticket_b_no:%${s}%,no_pol:%${s}%,supir:%${s}%,kernet:%${s}%,cost_center_code:%${s}%,cost_center_desc:%${s}%,pvr_no:%${s}%,tanggal:%${s}%,transition_target:%${s}%,uj_asst_opt:%${s}%`),r.sort="",M.value.field&&(r.sort=M.value.field+":"+M.value.by),r._TimeZoneOffset=new Date().getTimezoneOffset(),r.date_from=w.value.from?E(w.value.from).format("YYYY-MM-DD"):"",r.date_to=w.value.to?E(w.value.to).format("YYYY-MM-DD"):"",r.filter_model=JSON.stringify(d()._tv.filter_model),r.filter_status=m.value},z=u(null),I=async()=>{d().loading_full=!0,j.value={},p.value.may_get_data=!1,r.page=p.value.page,r.page==1&&(y.value=[]),r.first_row&&delete r.first_row,r.page>1&&(r.first_row=JSON.stringify(y.value[0])),r.filter_status=m.value;const{data:s,error:o,status:_}=await A("/trx_trp_susuts/data",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:r,retry:0});if(d().loading_full=!1,p.value.may_get_data=!0,_.value==="error"){N().trigger(o,j);return}p.value.page==1?(y.value=C(s.value.data),z.value&&(z.value.scrollTop=0)):p.value.page>1&&(y.value=[...y.value,...C(s.value.data)]),s.value.data.length==0&&(p.value.is_last_record=!0),d()._tv.filter_box=!1},K=()=>{p.value.page=1,p.value.is_last_record=!1,P(),I()},{downloadFile:O,viewFile:$e}=$t(),D=u(!1),B=u(""),U=async()=>{if(D.value==!0){D.value=!1;return}P(),d().loading_full=!0;const{data:s,error:o,status:_}=await A("/trx_trp_susuts/report_PDF",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:r,retry:0});if(d().loading_full=!1,_.value==="error"){N().trigger(o);return}B.value=s.value,D.value=!0},tt=async()=>{P(),d().loading_full=!0;const{data:s,error:o,status:_}=await A("/trx_trp_susuts/report_Excel",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:r,retry:0});if(d().loading_full=!1,_.value==="error"){N().trigger(o);return}O(s.value)},et=()=>{O(B.value)},st=u([{key:"no",label:"No",isai:!0},{key:"val_ticket",label:"App",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"tanggal",label:"U.Jalan Per",type:"date",dateformat:"DD-MM-Y",filter_on:1,sort:{priority:1,type:"desc"}},{key:"no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"xto",label:"Tujuan",filter_on:1,type:"string"},{key:"uj_asst_opt",label:"Info",filter_on:1,type:"select",select_item:["DENGAN KERNET","TANPA KERNET"]},{key:"tipe",label:"Tipe",filter_on:1,type:"string"},{key:"jenis",label:"Jenis",filter_on:1,type:"select",select_item:["TBS","TBSK","CPO","PK","LAIN","TUNGGU"]},{key:"amount",label:"Amount",class:" justify-end",filter_on:1,type:"number"},{key:"cost_center",label:"Cost Center",childs:[{key:"cost_center_code",label:"Code",class:" justify-start",filter_on:1,type:"string"},{key:"cost_center_desc",label:"Desc",filter_on:1,type:"string"}]},{key:"pvr",label:"PVR",childs:[{key:"pvr_no",label:"No",filter_on:1,type:"string"},{key:"pvr_total",label:"Total",filter_on:1,type:"number"},{key:"pvr_had_detail",label:"Completed",filter_on:1,type:"select",select_item:[{k:"1",v:"Completed"},{k:"0",v:"Uncompleted"}]}]},{key:"pv",label:"PV",childs:[{key:"pv_datetime",label:"Date",type:"date",dateformat:"DD-MM-Y",filter_on:1},{key:"pv_no",label:"No",filter_on:1,type:"string"},{key:"pv_total",label:"Total",filter_on:1,type:"number"}]},{key:"transition",label:"Peralihan",childs:[{key:"transition_type",label:"Type",type:"select",filter_on:1,select_item:["To","From"]},{key:"transition_target",label:"Target",type:"select",filter_on:1,select_item:d().list_pabrik}]},{key:"ticket_a",label:"Ticket A",childs:[{key:"ticket_a_no",label:"No",filter_on:1,type:"string"},{key:"ticket_a_bruto",label:"Bruto",filter_on:1,type:"number"},{key:"ticket_a_tara",label:"Tara",filter_on:1,type:"number"},{key:"ticket_a_netto",label:"Netto",filter_on:1,type:"number"},{key:"ticket_a_supir",label:"Supir",filter_on:1,type:"string"},{key:"ticket_a_no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"ticket_a_in_at",label:"In At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"ticket_a_out_at",label:"Out At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1}]},{key:"ticket_b",label:"Ticket B",childs:[{key:"ticket_b_no",label:"No",filter_on:1,type:"string"},{key:"ticket_b_bruto",label:"Bruto",filter_on:1,type:"number"},{key:"ticket_b_tara",label:"Tara",filter_on:1,type:"number"},{key:"ticket_b_netto",label:"Netto",filter_on:1,type:"number"},{key:"ticket_b_supir",label:"Supir",filter_on:1,type:"string"},{key:"ticket_b_no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"ticket_b_in_at",label:"In At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"ticket_b_out_at",label:"Out At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1}]},{key:"susut",label:"Susut",childs:[{key:"susut_bruto",label:"Bruto",childs:[{key:"susut_bruto_a",label:"Berangkat"},{key:"susut_bruto_b",label:"Kembali"},{key:"susut_bruto_b_a",label:"Selisih"},{key:"susut_bruto_b_a_persen",label:"%"}]},{key:"susut_tara",label:"Tara",childs:[{key:"susut_tara_a",label:"Berangkat"},{key:"susut_tara_b",label:"Kembali"},{key:"susut_tara_b_a",label:"Selisih"},{key:"susut_tara_b_a_persen",label:"%"}]},{key:"susut_netto",label:"Netto",childs:[{key:"susut_netto_a",label:"Berangkat"},{key:"susut_netto_b",label:"Kembali"},{key:"susut_netto_b_a",label:"Selisih"},{key:"susut_netto_b_a_persen",label:"%"}]}]},{key:"supir",label:"Supir",filter_on:1,type:"string"},{key:"kernet",label:"Kernet",filter_on:1,type:"string"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1}]),F=(s,o)=>{s=parseFloat(s)||0,o=parseFloat(o)||0;let _=parseFloat(o-s),T=_>0?o:s;if(T==0)return 0;let v=W().round(_/T*100,2);return v<0?"("+Math.abs(v*100)/100+")":v},H=(s,o)=>{s=parseFloat(s)||0,o=parseFloat(o)||0;let _=parseFloat(o-s);return _<0?"("+n(Math.abs(_))+")":n(_)},R=u(!1),b=u({...{id:-1,xto:"",tipe:"",jenis:"",harga:0,note_for_remarks:"",details:[],details2:[]}}),ot=kt(()=>{let s=0;return b.value.details2.forEach(o=>{o.p_status!="Remove"&&(s+=o.qty*o.amount)}),s});return(s,o)=>{const _=nt,T=it,v=_t,V=ct,J=ut,at=dt,lt=pt,rt=ft;return f(),k("div",At,[h(_,{title:"Report Transaction"}),e("div",St,[e("div",Ct,[e("div",Mt,[G(e("select",{class:"","onUpdate:modelValue":o[0]||(o[0]=t=>vt(m)?m.value=t:null)},Bt,512),[[ht,a(m)]])]),e("button",{type:"button",name:"button",class:"m-1 text-2xl flex items-center",onClick:o[1]||(o[1]=t=>U())},[h(T),c(),Ft]),e("button",{type:"button",name:"button",class:"m-1 text-2xl flex items-center",onClick:o[2]||(o[2]=t=>tt())},[h(v),c(),Ht])]),h(at,{thead:a(st),selected:a(q),onSetSelected:o[3]||(o[3]=t=>q.value=t),tbody:a(y),fnCallData:I,scrolling:a(p),onSetScrollingPage:o[4]||(o[4]=t=>a(p).page=t),onDoFilter:o[5]||(o[5]=t=>K())},{status:i(({item:t})=>[e("div",{class:Dt(["text-white text-xs px-2 py-1 rounded-lg",S(t)?"bg-green-600":"bg-red-600"])},l(S(t)?"Done":"Not Done"),3)]),val_ticket:i(({item:t})=>[t.val_ticket?(f(),$(J,{key:1})):(f(),$(V,{key:0}))]),uj_asst_opt:i(({item:t})=>{var L;return[c(l((L=t.uj)==null?void 0:L.asst_opt),1)]}),pvr_had_detail:i(({item:t})=>[t.pvr_had_detail?(f(),$(J,{key:1})):(f(),$(V,{key:0}))]),susut_bruto_a:i(({item:t})=>[c(l(a(n)(t.ticket_a_bruto)),1)]),susut_tara_a:i(({item:t})=>[c(l(a(n)(t.ticket_a_tara)),1)]),susut_netto_a:i(({item:t})=>[c(l(a(n)(t.ticket_a_netto)),1)]),susut_bruto_b:i(({item:t})=>[c(l(a(n)(t.ticket_b_bruto)),1)]),susut_tara_b:i(({item:t})=>[c(l(a(n)(t.ticket_b_tara)),1)]),susut_netto_b:i(({item:t})=>[c(l(a(n)(t.ticket_b_netto)),1)]),susut_bruto_b_a:i(({item:t})=>[c(l(H(t.ticket_a_bruto,t.ticket_b_bruto)),1)]),susut_tara_b_a:i(({item:t})=>[c(l(H(t.ticket_a_tara,t.ticket_b_tara)),1)]),susut_netto_b_a:i(({item:t})=>[c(l(H(t.ticket_a_netto,t.ticket_b_netto)),1)]),susut_bruto_b_a_persen:i(({item:t})=>[c(l(F(t.ticket_a_bruto,t.ticket_b_bruto)),1)]),susut_tara_b_a_persen:i(({item:t})=>[c(l(F(t.ticket_a_tara,t.ticket_b_tara)),1)]),susut_netto_b_a_persen:i(({item:t})=>[c(l(F(t.ticket_a_netto,t.ticket_b_netto)),1)]),_:2},1032,["thead","selected","tbody","scrolling"])]),a(D)?(f(),k("div",Rt,[e("div",Yt,[e("div",Et,[h(lt,{style:{color:"black",cursor:"pointer"},onClick:o[6]||(o[6]=t=>U())})]),e("iframe",{ref:"iframe",width:"100%",height:"100%",src:a(B).dataBase64},null,8,jt),e("div",{style:{position:"absolute",top:"12px",right:"88px","background-color":"rgba(255,255,255,0)",width:"37px",height:"36px","z-index":"1",cursor:"pointer"},onClick:o[7]||(o[7]=t=>et())})])])):gt("",!0),G(e("div",qt,[e("div",zt,[h(rt,{title:"Detail Information",fn:()=>{R.value=!1,s.show_confirm=!1},class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("div",It,[e("div",Kt,[e("div",Ot,[Ut,e("div",Vt,l(a(b).xto)+" ",1)]),e("div",Jt,[Lt,e("div",Gt,l(a(b).tipe),1)]),e("div",Zt,[Qt,e("div",Wt,l(a(b).jenis),1)]),e("div",Xt,[te,e("div",ee,l(a(b).note_for_remarks),1)])]),e("div",se,[e("table",oe,[ae,(f(!0),k(Z,null,Q(a(b).details,t=>(f(),k("tr",null,[e("td",le,l(t.ordinal)+". ",1),e("td",re,l(t.xdesc)+" "+l(t.qty<=1?"":a(n)(t.qty||0)+" x Rp."+a(n)(t.harga||0)),1),ne,e("td",ie,l(a(n)(t.qty*t.harga)),1)]))),256)),e("tr",_e,[ce,ue,e("th",de,l(a(n)(a(b).harga)),1)])])]),e("div",pe,[e("table",fe,[be,(f(!0),k(Z,null,Q(a(b).details2,t=>(f(),k("tr",null,[e("td",me,l(t.ordinal)+". ",1),e("td",ye,l(t.ac_account_code),1),e("td",ke,l(t.description)+" "+l(t.qty<=1?"":a(n)(t.qty||0)+" x Rp."+a(n)(t.amount||0)),1),he,e("td",ve,l(a(n)(t.qty*t.amount)),1)]))),256)),e("tr",ge,[xe,we,e("th",De,l(a(n)(a(ot))),1)])])])]),e("div",Te,[e("button",{class:"rounded m-1",onClick:o[8]||(o[8]=t=>R.value=!1)}," Cancel ")])])],512),[[xt,a(R)]])])}}};export{We as default};
