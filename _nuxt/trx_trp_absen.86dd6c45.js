import{_ as D}from"./HeaderPopup.vue.5f3ccc6a.js";import{_ as F}from"./client-only.32caf14b.js";import j from"./AttachmentSingle.fbcede31.js";import{r as k,f as A,j as B,I as $,m as M,J as P,o as g,c as x,a as t,b as r,t as o,k as l,l as S,w,F as N,y as U,v as T,x as I,E as q,A as h,B as Y,p as W,e as E}from"./entry.f9648287.js";import"./useUtils.ba7b5756.js";import{u as H}from"./useMyFetch.0b6abd49.js";import{_ as K}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.556c4653.js";import"./PDFJsView.9339ae24.js";const n=m=>(W("data-v-2efc35a5"),m=m(),E(),m),O={class:"box-fixed"},z={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},J={class:"w-full"},L={class:"w-full flex flex-wrap p-3 items-center text-xs"},G=n(()=>t("label",{for:""},"U.jalan Per",-1)),Q={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},R=n(()=>t("label",{for:""},"Jenis",-1)),X={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},Z=n(()=>t("label",{for:""},"Supir",-1)),ee={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},te={key:0},le=n(()=>t("label",{for:""},"Kernet",-1)),ie={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},ae=n(()=>t("label",{for:""},"No Pol",-1)),se={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},oe=n(()=>t("label",{for:""},"Tujuan",-1)),re={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},ne=n(()=>t("label",{for:""},"Tipe",-1)),_e={class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white"},de={class:"w-full flex flex-wrap items-center grow overflow-auto"},me={class:"w-full sm:w-1/2 text-center p-1"},ue={class:"border-[1px] p-1"},pe=n(()=>t("label",{class:"font-bold"},"Berangkat ",-1)),ve={class:"text-red-500"},ce={class:"text-red-500"},fe={key:0,class:"flex flex-wrap"},ge={class:"w-1/2 sm:w-1/3 md:w-1/4 lg:w-1/5 xl:w-1/6 p-1"},xe=["src","onClick"],be={class:"w-full sm:w-1/2 text-center p-1"},we={class:"border-[1px] p-1"},he=n(()=>t("label",{class:"font-bold"},"Tiba ",-1)),ye={class:"text-red-500"},ke={class:"text-red-500"},Me={class:"w-full sm:w-1/2 text-center p-1"},Se={class:"border-[1px] p-1"},Ye=n(()=>t("label",{class:"font-bold"},"Kembali ",-1)),He={class:"text-red-500"},Ve={class:"text-red-500"},Ce={class:"w-full sm:w-1/2 text-center p-1"},De={class:"border-[1px] p-1"},Fe=n(()=>t("label",{class:"font-bold"},"Sampai ",-1)),je={class:"text-red-500"},Ae={class:"text-red-500"},Be={class:"w-full p-1"},$e=n(()=>t("label",{for:""}," Note ",-1)),Pe={class:"w-full flex items-center justify-end"},Ne={__name:"trx_trp_absen",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},p_data:{type:Array,required:!0,default:[]},id:{type:Number,required:!1,default:0}},setup(m){const d=m,{$moment:f}=q(),e=k({...{id:-1,tanggal:new Date,id_uj:-1,xto:"",tipe:"",jenis:"",amount:0,img_leaves:[],img_leave:"",img_arrive:"",img_return:"",img_till:"",img_leave_file:"",img_arrive_file:"",img_return_file:"",img_till_file:"",img_leave_ts:"",img_arrive_ts:"",img_return_ts:"",img_till_ts:"",ritase_note:""}}),_=k({}),y=A("token"),V=async()=>{h().loading_full=!0;const{data:s,error:a,status:p}=await H("/trx_trp/absen",{method:"get",headers:{Authorization:`Bearer ${y.value}`,Accept:"application/json"},params:{id:d.id},retry:0});if(h().loading_full=!1,p.value==="error"){Y().trigger(a);return}e.value=s.value.data};B(()=>d.show,(s,a)=>{s==!0&&V()},{immediate:!0});const C=async()=>{h().loading_full=!0,_.value={};const s=new FormData;if(e.value.img_leave){let i=e.value.img_leaves.map(b=>b.gambar).indexOf(e.value.img_leave);i==-1?s.append("img_leave","ada"):s.append("img_leave",e.value.img_leaves[i].id)}else s.append("img_leave","");s.append("img_leave_file",e.value.img_leave_file),s.append("img_leave_ts",e.value.img_leave_ts?f(e.value.img_leave_ts).format("YYYY-MM-DD HH:mm"):""),s.append("img_arrive",e.value.img_arrive?"ada":""),s.append("img_arrive_file",e.value.img_arrive_file),s.append("img_arrive_ts",e.value.img_arrive_ts?f(e.value.img_arrive_ts).format("YYYY-MM-DD HH:mm"):""),s.append("img_return",e.value.img_return?"ada":""),s.append("img_return_file",e.value.img_return_file),s.append("img_return_ts",e.value.img_return_ts?f(e.value.img_return_ts).format("YYYY-MM-DD HH:mm"):""),s.append("img_till",e.value.img_till?"ada":""),s.append("img_till_file",e.value.img_till_file),s.append("img_till_ts",e.value.img_till_ts?f(e.value.img_till_ts).format("YYYY-MM-DD HH:mm"):""),s.append("ritase_note",e.value.ritase_note);let a="post",p=d.id;p==0||(s.append("id",p),s.append("_method","PUT"));const{data:u,error:v,status:c}=await H("/trx_trp/absen",{method:a,headers:{Authorization:`Bearer ${y.value}`,Accept:"application/json"},body:s,retry:0});if(h().loading_full=!1,c.value==="error"){Y().trigger(v,_);return}if(e.value.updated_at=u.value.updated_at,d.id<=0)e.value.id=u.value.id,e.value.created_at=u.value.created_at,d.p_data.unshift(e.value);else{let i=d.p_data.map(b=>b.id).indexOf(d.id);i>=-1&&d.p_data.splice(i,1,{...e.value})}d.fnClose()};return(s,a)=>{const p=D,u=$("vue-date-picker"),v=F,c=j;return M((g(),x("section",O,[t("div",null,[r(p,{title:"Form Check Absen",fn:m.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",z,[t("div",J,[t("div",L,[t("div",null,[G,t("div",Q,o(l(e).tanggal?l(f)(l(e).tanggal).format("DD-MM-YYYY"):""),1)]),t("div",null,[R,t("div",X,o(l(e).jenis),1)]),t("div",null,[Z,t("div",ee,o(l(e).supir),1)]),l(e).kernet?(g(),x("div",te,[le,t("div",ie,o(l(e).kernet),1)])):S("",!0),t("div",null,[ae,t("div",se,o(l(e).no_pol),1)]),t("div",null,[oe,t("div",re,o(l(e).xto),1)]),t("div",null,[ne,t("div",_e,o(l(e).tipe),1)])])]),t("div",de,[t("div",me,[t("div",ue,[pe,r(v,null,{default:w(()=>[r(u,{modelValue:l(e).img_leave_ts,"onUpdate:modelValue":a[0]||(a[0]=i=>l(e).img_leave_ts=i),type:"datetime",format:"dd-MM-yyyy HH:mm","enable-time-picker":!0,"text-input":"","teleport-center":"",class:"flex-grow",placeholder:"Waktu Berangkat"},null,8,["modelValue"])]),_:1}),t("p",ve,o(l(_).img_leave_ts),1),r(c,{value:l(e).img_leave,onSetFile:a[1]||(a[1]=i=>l(e).img_leave_file=i),onSetPreview:a[2]||(a[2]=i=>l(e).img_leave=i),can_remove:!0},null,8,["value"]),t("p",ce,o(l(_).img_leave),1),l(e).img_leaves.length>1?(g(),x("div",fe,[(g(!0),x(N,null,U(l(e).img_leaves,i=>(g(),x("div",ge,[t("img",{class:"w-full cursor-pointer",src:i.gambar,onClick:b=>(l(e).img_leave=i.gambar,l(e).img_leave_file="")},null,8,xe)]))),256))])):S("",!0)])]),t("div",be,[t("div",we,[he,r(v,null,{default:w(()=>[r(u,{modelValue:l(e).img_arrive_ts,"onUpdate:modelValue":a[3]||(a[3]=i=>l(e).img_arrive_ts=i),type:"datetime",format:"dd-MM-yyyy HH:mm","enable-time-picker":!0,"text-input":"","teleport-center":"",class:"flex-grow",placeholder:"Waktu Tiba"},null,8,["modelValue"])]),_:1}),t("p",ye,o(l(_).img_arrive_ts),1),r(c,{value:l(e).img_arrive,onSetFile:a[4]||(a[4]=i=>l(e).img_arrive_file=i),onSetPreview:a[5]||(a[5]=i=>l(e).img_arrive=i),can_remove:!0},null,8,["value"]),t("p",ke,o(l(_).img_arrive),1)])]),t("div",Me,[t("div",Se,[Ye,r(v,null,{default:w(()=>[r(u,{modelValue:l(e).img_return_ts,"onUpdate:modelValue":a[6]||(a[6]=i=>l(e).img_return_ts=i),type:"datetime",format:"dd-MM-yyyy HH:mm","enable-time-picker":!0,"text-input":"","teleport-center":"",class:"flex-grow",placeholder:"Waktu Kembali"},null,8,["modelValue"])]),_:1}),t("p",He,o(l(_).img_return_ts),1),r(c,{value:l(e).img_return,onSetFile:a[7]||(a[7]=i=>l(e).img_return_file=i),onSetPreview:a[8]||(a[8]=i=>l(e).img_return=i),can_remove:!0},null,8,["value"]),t("p",Ve,o(l(_).img_return),1)])]),t("div",Ce,[t("div",De,[Fe,r(v,null,{default:w(()=>[r(u,{modelValue:l(e).img_till_ts,"onUpdate:modelValue":a[9]||(a[9]=i=>l(e).img_till_ts=i),type:"datetime",format:"dd-MM-yyyy HH:mm","enable-time-picker":!0,"text-input":"","teleport-center":"",class:"flex-grow",placeholder:"Waktu Sampai"},null,8,["modelValue"])]),_:1}),t("p",je,o(l(_).img_till_ts),1),r(c,{value:l(e).img_till,onSetFile:a[10]||(a[10]=i=>l(e).img_till_file=i),onSetPreview:a[11]||(a[11]=i=>l(e).img_till=i),can_remove:!0},null,8,["value"]),t("p",Ae,o(l(_).img_till),1)])]),t("div",Be,[$e,M(t("textarea",{"onUpdate:modelValue":a[12]||(a[12]=i=>l(e).ritase_note=i)},null,512),[[T,l(e).ritase_note]])])]),t("div",Pe,[t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:a[13]||(a[13]=i=>m.fnClose())}," Cancel "),t("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:a[14]||(a[14]=I(i=>C(),["prevent"]))}," Save ")])])])],512)),[[P,m.show]])}}},Le=K(Ne,[["__scopeId","data-v-2efc35a5"]]);export{Le as default};
