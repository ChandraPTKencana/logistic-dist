import ne from"./Header.b8dab45d.js";import re from"./Plus.157484e0.js";import ie from"./Edit.ac714197.js";import ue from"./Signature.fbea1bef.js";import de from"./Table2Column.a7f234c3.js";import ce from"./Line.2fd73f96.js";import _e from"./Check.43d8adab.js";import{_ as fe}from"./PopupMini.vue.f0536131.js";import me from"./salary_paid.4d703718.js";import pe from"./salary_paid_validasi.13454c5a.js";import{_ as ve}from"./PDFView.vue.f008c8a4.js";import{f as ye,g as he,r as s,h as ge,i as U,s as we,j as ke,c as _,b as f,a,k as t,l as b,F as xe,y as be,w as Ce,z as De,A as m,B as C,o as u,C as Ae,D as j,t as y,d as Pe,m as $e,v as Me,n as Se,E as Te}from"./entry.122d8680.js";import{u as B}from"./useUtils.1d2b2111.js";import{u as D}from"./useMyFetch.12d4793f.js";import{u as Fe}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.c8828c5d.js";import"./Exclamation.7ba39b2a.js";import"./HeaderPopup.vue.d5cb959b.js";import"./client-only.44ea9acf.js";const Be={class:"w-full h-full flex flex-col"},Le={class:"w-full flex grow flex-col overflow-auto h-0"},ze={class:"w-full flex"},Ee={class:"w-full flex justify-center items-center grow h-0 p-1"},Ue={key:0,class:""},je={class:"tacky"},Ve=a("thead",null,[a("tr",{class:"sticky top-0 !z-[2]"},[a("th",null,"Logistik"),a("th",null,"ID"),a("th",null,"Period End"),a("th",null,"Period Part"),a("th",null,"Created At"),a("th",null,"Updated At")])],-1),He=["onClick"],Ie={class:"flex items-center justify-center"},Ne={class:"bold"},Oe={class:"grow mb-5"},ft={__name:"index",async setup(Re){let h,L;const{$moment:A}=Te(),d={};d._TimeZoneOffset=new Date().getTimezoneOffset(),d.sort="created_at:desc";const g=ye("token"),{data:V}=([h,L]=he(async()=>De(async()=>{let e=[];m().loading_full=!0;const{data:o,error:c,status:v}=await D("/salary_paids",{method:"get",headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},params:d,retry:0});return m().loading_full=!1,v.value==="error"?(C().trigger(c),{salary_paids:e}):(e=o.value.data,{salary_paids:e})},"$5DNPjgzs1s")),h=await h,L(),h),n=s(V.value.salary_paids);s(""),s({field:"created_at",by:"desc"});const r=s(-1),i=s({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),w=s(null),H=async()=>{m().loading_full=!0,i.value.may_get_data=!1,d.page=i.value.page,d.page==1&&(n.value=[]),d.first_row&&delete d.first_row,d.page>1&&(d.first_row=JSON.stringify(n.value[0]));const{data:e,error:o,status:c}=await D("/salary_paids",{method:"get",headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},params:d,retry:0});if(m().loading_full=!1,i.value.may_get_data=!0,c.value==="error"){C().trigger(o);return}i.value.page==1?(n.value=e.value.data,w.value&&(w.value.scrollTop=0)):i.value.page>1&&(n.value=[...n.value,...e.value.data]),e.value.data.length==0&&(i.value.is_last_record=!0)},I=async()=>{if(!i.value.may_get_data)return;let e=w.value;if(e.scrollLeft!=i.value.scrollLeft){i.value.scrollLeft=e.scrollLeft;return}i.value.is_last_record||!(Math.round(e.scrollTop)+e.clientHeight>=e.scrollHeight-1)||(i.value.page++,await H())};ge();const k=s(!1),P=s(0),$=s(0),N=()=>{P.value=0,k.value=!0,$.value=!1},{display:z}=U();we(U());const O=()=>{r.value==-1?z({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=n.value[r.value].id,k.value=!0,$.value=!1)},M=s(!1),E=s(0),R=()=>{r.value==-1?z({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(E.value=n.value[r.value].id,M.value=!0)},S=s(!1),Y=s({}),x=s(!1),p=s(""),J=async()=>{x.value&&(x.value=!1)};ke(()=>p.value,e=>{e.trim().length>0?S.value=!0:S.value=!1},{immediate:!1});const Z=async()=>{m().loading_full=!0;const e=new FormData;e.append("id",n.value[r.value].id),e.append("deleted_reason",p.value),e.append("_method","DELETE");const{data:o,error:c,status:v}=await D("/salary_paid",{method:"post",headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},body:e,retry:0});if(m().loading_full=!1,v.value==="error"){C().trigger(c);return}n.value.splice(r.value,1),r.value=-1,x.value=!1},{downloadFile:q,viewFile:Ye}=Fe(),T=s(!1),G=s({}),K=async()=>{m().loading_full=!0;const{data:e,error:o,status:c}=await D("/salary_paid/excel_download",{method:"get",headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},params:{id:n.value[r.value].id},retry:0});if(m().loading_full=!1,c.value==="error"){C().trigger(o);return}q(e.value)};return(e,o)=>{const c=ne,v=re,Q=ie,W=ue,X=de,ee=ce,te=_e,ae=fe,oe=me,se=pe,le=ve;return u(),_("div",Be,[f(c,{title:"List Salary Paid"}),a("div",Le,[a("div",ze,[("useUtils"in e?e.useUtils:t(B))().checkPermission("salary_paid.create")?(u(),_("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[0]||(o[0]=l=>N())},[f(v)])):b("",!0),("useUtils"in e?e.useUtils:t(B))().checkPermissions(["salary_paid.modify"])?(u(),_("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[1]||(o[1]=l=>O())},[f(Q)])):b("",!0),("useUtils"in e?e.useUtils:t(B))().checkPermissions(["salary_paid.val1","salary_paid.val2","salary_paid.val3"])?(u(),_("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[2]||(o[2]=l=>R())},[f(W)])):b("",!0),t(r)>-1&&t(n)[t(r)].val1==1?(u(),_("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:o[3]||(o[3]=l=>K())},[f(X)])):b("",!0)]),a("div",Ee,[t(n).length==0?(u(),_("div",Ue," Maaf Tidak Ada Record ")):(u(),_("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:w,onScroll:I},[a("table",je,[Ve,a("tbody",null,[(u(!0),_(xe,null,be(t(n),(l,F)=>(u(),_("tr",{key:F,onClick:Je=>r.value=F,class:Ae(t(r)==F?"active":"")},[a("td",null,[a("div",Ie,[l.val1?(u(),j(te,{key:1})):(u(),j(ee,{key:0}))])]),a("td",Ne,y(l.id),1),a("td",null,y(l.period_end?t(A)(l.period_end).format("MM-Y"):""),1),a("td",null,y(l.period_part),1),a("td",null,y(l.created_at?t(A)(l.created_at).format("DD-MM-Y HH:mm:ss"):""),1),a("td",null,y(l.updated_at?t(A)(l.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,He))),128))])])],544))])]),f(ae,{type:"delete",show:t(x),data:t(Y),fnClose:J,fnConfirm:Z,enabledOk:t(S)},{footer:Ce(()=>[Pe(" Masukkan Alasan Penghapusan: "),a("div",Oe,[$e(a("textarea",{"onUpdate:modelValue":o[4]||(o[4]=l=>Se(p)?p.value=l:null)},null,512),[[Me,t(p)]])])]),_:1},8,["show","data","enabledOk"]),f(oe,{show:t(k),fnClose:()=>{k.value=!1},id:t(P),p_data:t(n),is_copy:t($)},null,8,["show","fnClose","id","p_data","is_copy"]),f(se,{show:t(M),fnClose:()=>{M.value=!1},id:t(E),p_data:t(n)},null,8,["show","fnClose","id","p_data"]),f(le,{show:t(T),pdfContent:t(G),onClose:o[5]||(o[5]=l=>T.value=!t(T))},null,8,["show","pdfContent"])])}}};export{ft as default};
