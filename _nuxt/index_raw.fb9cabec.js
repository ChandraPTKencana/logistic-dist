import pe from"./Header.3747b0a6.js";import fe from"./Copy.22c435e2.js";import ve from"./Plus.6191db42.js";import he from"./Edit.530bc107.js";import ye from"./Delete.8b611110.js";import ge from"./Signature.4980b60a.js";import ke from"./Search.5bebc889.js";import we from"./Line.9d8a4c99.js";import be from"./Check.1299b720.js";import{_ as xe}from"./PopupMini.vue.19466ba8.js";import Ce from"./ujalan.56a1cc9b.js";import De from"./ujalan_validasi.63416d39.js";import{g as je,h as Ue,r as n,B as $e,j as R,s as Ae,f as Se,c as d,b as _,a as e,l as o,n as x,k as A,A as J,m as K,v as Y,C as Te,F as Me,D as Pe,w as Be,q as Fe,x as y,y as F,o as r,E as Ie,z as S,t as p,d as Ve,H as He,G as Le}from"./entry.bf605837.js";import{u as g}from"./useUtils.fcb0bcb4.js";import{u as I}from"./useMyFetch.9c1d1cb2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.2afba606.js";import"./Exclamation.3501db46.js";import"./HeaderPopup.vue.5964ff22.js";import"./Tools.d9876639.js";import"./InputPointFormat.vue.278d52b8.js";import"./ToolsPopup.75c1d2de.js";import"./ac_accs.a202b1ce.js";const ze={class:"w-full h-full flex flex-col"},Ee={class:"w-full flex grow flex-col overflow-auto h-0"},Ne={class:"w-full flex"},Oe={action:"#",class:"w-full flex p-1"},Re={class:"grow"},Je=e("div",{class:"font-bold"}," Keyword ",-1),Ke={class:"pl-1"},Ye=e("div",{class:"font-bold"}," Sort By ",-1),qe=He('<option value=""></option><option value="id">ID</option><option value="xto">To</option><option value="jenis">Jenis</option><option value="tipe">Tipe</option>',5),Ge=[qe],Xe={class:"pl-1"},Ze=e("div",{class:"font-bold"}," Sort Order ",-1),Qe=e("option",{value:"asc"},"Asc",-1),We=e("option",{value:"desc"},"Desc",-1),et=[Qe,We],tt={class:"flex items-end pl-1"},at={class:"w-full flex justify-center items-center grow h-0 p-1"},ot={key:0,class:""},st={class:"tacky"},lt=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"App 2"),e("th",null,"ID"),e("th",null,"To"),e("th",null,"Tipe"),e("th",null,"Jenis"),e("th",null,"Harga"),e("th",null,"Ket.U.Remarks"),e("th",null,"Asal Peralihan"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),nt=["onClick"],it={class:"flex items-center justify-center"},rt={class:"flex items-center justify-center"},ut={class:"bold"},ct={class:"grow mb-5"},It={__name:"index_raw",async setup(dt){let C,V;const{$moment:H}=Le(),{pointFormat:q}=g(),i={};i._TimeZoneOffset=new Date().getTimezoneOffset(),i.sort="created_at:desc";const T=je("token"),{data:G}=([C,V]=Ue(async()=>Fe(async()=>{let t=[];y().loading_full=!0;const{data:s,error:v,status:b}=await I("/ujalan",{method:"get",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},params:i,retry:0});return y().loading_full=!1,b.value==="error"?(F().trigger(v),{ujalans:t}):(t=s.value.data,{ujalans:t})},"$XlCU6SukAB")),C=await C,V(),C),l=n(G.value.ujalans),m=n(""),f=n({field:"created_at",by:"desc"}),u=n(-1),c=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),X=()=>{i.like="",m.value!=""&&(i.like=`id:%${m.value}%,xto:%${m.value}%,tipe:%${m.value}%,jenis:%${m.value}%,harga:%${m.value}%`),i.sort="",f.value.field&&(i.sort=f.value.field+":"+f.value.by)},D=n(null),L=async()=>{y().loading_full=!0,c.value.may_get_data=!1,i.page=c.value.page,i.page==1&&(l.value=[]),i.first_row&&delete i.first_row,i.page>1&&(i.first_row=JSON.stringify(l.value[0]));const{data:t,error:s,status:v}=await I("/ujalan",{method:"get",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},params:i,retry:0});if(y().loading_full=!1,c.value.may_get_data=!0,v.value==="error"){F().trigger(s);return}c.value.page==1?(l.value=t.value.data,D.value&&(D.value.scrollTop=0)):c.value.page>1&&(l.value=[...l.value,...t.value.data]),t.value.data.length==0&&(c.value.is_last_record=!0)},Z=async()=>{if(!c.value.may_get_data)return;let t=D.value;if(t.scrollLeft!=c.value.scrollLeft){c.value.scrollLeft=t.scrollLeft;return}c.value.is_last_record||!(Math.round(t.scrollTop)+t.clientHeight>=t.scrollHeight-1)||(c.value.page++,await L())},Q=()=>{c.value.page=1,c.value.is_last_record=!1,X(),L()};$e();const k=n(!1),j=n(0),U=n(0),W=()=>{j.value=0,k.value=!0,U.value=!1},{display:$}=R();Ae(R());const ee=()=>{u.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(j.value=l.value[u.value].id,k.value=!0,U.value=!1)},te=()=>{u.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(j.value=l.value[u.value].id,k.value=!0,U.value=!0)},M=n(!1),z=n(0),ae=()=>{u.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(z.value=l.value[u.value].id,M.value=!0)},P=n(!1),E=n({}),w=n(!1),h=n(""),oe=async()=>{w.value&&(w.value=!1)},se=()=>{u.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(h.value="",E.value={id:l.value[u.value].id},w.value=!0)};Se(()=>h.value,t=>{t.trim().length>0?P.value=!0:P.value=!1},{immediate:!1});const le=async()=>{y().loading_full=!0;const t=new FormData;t.append("id",l.value[u.value].id),t.append("deleted_reason",h.value),t.append("_method","DELETE");const{data:s,error:v,status:b}=await I("/ujalan",{method:"post",headers:{Authorization:`Bearer ${T.value}`,Accept:"application/json"},body:t,retry:0});if(y().loading_full=!1,b.value==="error"){F().trigger(v);return}l.value.splice(u.value,1),u.value=-1,w.value=!1};return(t,s)=>{const v=pe,b=fe,ne=ve,ie=he,re=ye,ue=ge,ce=ke,N=we,O=be,de=xe,_e=Ce,me=De;return r(),d("div",ze,[_(v,{title:"List Ujalan"}),e("div",Ee,[e("div",Ne,[("useUtils"in t?t.useUtils:o(g))().checkPermission("ujalan.create")?(r(),d("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[0]||(s[0]=a=>te())},[_(b)])):x("",!0),("useUtils"in t?t.useUtils:o(g))().checkPermission("ujalan.create")?(r(),d("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[1]||(s[1]=a=>W())},[_(ne)])):x("",!0),("useUtils"in t?t.useUtils:o(g))().checkPermissions(["ujalan.modify","ujalan.detail.modify","ujalan.detail2.modify"])?(r(),d("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[2]||(s[2]=a=>ee())},[_(ie)])):x("",!0),("useUtils"in t?t.useUtils:o(g))().checkPermission("ujalan.remove")?(r(),d("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[3]||(s[3]=a=>se())},[_(re)])):x("",!0),("useUtils"in t?t.useUtils:o(g))().checkPermissions(["ujalan.val","ujalan.val1"])?(r(),d("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:s[4]||(s[4]=a=>ae())},[_(ue)])):x("",!0)]),e("form",Oe,[e("div",Re,[Je,A(e("input",{class:"",type:"text","onUpdate:modelValue":s[5]||(s[5]=a=>K(m)?m.value=a:null),name:"search",placeholder:"Keyword"},null,512),[[J,o(m)]])]),e("div",Ke,[Ye,A(e("select",{class:"","onUpdate:modelValue":s[6]||(s[6]=a=>o(f).field=a)},Ge,512),[[Y,o(f).field]])]),e("div",Xe,[Ze,A(e("select",{class:"","onUpdate:modelValue":s[7]||(s[7]=a=>o(f).by=a)},et,512),[[Y,o(f).by]])]),e("div",tt,[e("button",{class:"",type:"submit",name:"button",onClick:s[8]||(s[8]=Te(a=>Q(),["prevent"]))},[_(ce,{class:"text-2xl"})])])]),e("div",at,[o(l).length==0?(r(),d("div",ot," Maaf Tidak Ada Record ")):(r(),d("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:D,onScroll:Z},[e("table",st,[lt,e("tbody",null,[(r(!0),d(Me,null,Pe(o(l),(a,B)=>(r(),d("tr",{key:B,onClick:_t=>u.value=B,class:Ie(o(u)==B?"active":"")},[e("td",null,[e("div",it,[a.val?(r(),S(O,{key:1})):(r(),S(N,{key:0}))])]),e("td",null,[e("div",rt,[a.val1?(r(),S(O,{key:1})):(r(),S(N,{key:0}))])]),e("td",ut,p(a.id),1),e("td",null,p(a.xto),1),e("td",null,p(a.tipe),1),e("td",null,p(a.jenis),1),e("td",null,p(o(q)(a.harga)),1),e("td",null,p(a.note_for_remarks),1),e("td",null,p(a.transition_from),1),e("td",null,p(a.created_at?o(H)(a.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,p(a.updated_at?o(H)(a.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,nt))),128))])])],544))])]),_(de,{type:"delete",show:o(w),data:o(E),fnClose:oe,fnConfirm:le,enabledOk:o(P)},{footer:Be(()=>[Ve(" Masukkan Alasan Penghapusan: "),e("div",ct,[A(e("textarea",{"onUpdate:modelValue":s[9]||(s[9]=a=>K(h)?h.value=a:null)},null,512),[[J,o(h)]])])]),_:1},8,["show","data","enabledOk"]),_(_e,{show:o(k),fnClose:()=>{k.value=!1},id:o(j),p_data:o(l),is_copy:o(U)},null,8,["show","fnClose","id","p_data","is_copy"]),_(me,{show:o(M),fnClose:()=>{M.value=!1},id:o(z),p_data:o(l)},null,8,["show","fnClose","id","p_data"])])}}};export{It as default};
