import{r as d,g as H,h as L,J as R,c as Z,a as e,b as n,k as T,v as $,l,m as O,w as P,t as Y,D as B,F as q,q as G,o as K,B as Q,p as W,e as X,x as p,y as C,_ as ee,H as te}from"./entry.12334995.js";import oe from"./Header.479496c0.js";import{_ as le}from"./client-only.e7de85ce.js";import{_ as se}from"./SelectMulti.vue.15c16735.js";import ae from"./PrinterEye.96902768.js";import ne from"./Table2Column.8797b9f6.js";import{u as S}from"./useMyFetch.b8c93418.js";import{u as ie}from"./useDownload.174f4da2.js";import{_ as re}from"./_plugin-vue_export-helper.c27b6911.js";import"./Check.e5d089d3.js";import"./Times.2c7e61c7.js";const de=Q(()=>ee(()=>import("./PDFView.70ea9b12.js"),["./PDFView.70ea9b12.js","./Times.2c7e61c7.js","./_plugin-vue_export-helper.c27b6911.js","./entry.12334995.js","./entry.7cb82c40.css","./useDownload.174f4da2.js"],import.meta.url).then(u=>u.default||u)),s=u=>(W("data-v-482a7a20"),u=u(),X(),u),_e={class:"w-full h-full flex flex-col"},ce={class:"w-full flex grow flex-col overflow-auto h-0 bg-gray-200 justify-center items-center p-2"},ue={class:"bg-white p-2 max-w-[350px] max-h-full overflow-auto"},fe={action:"#",class:"w-full flex flex-col sm:flex-row flex-wrap text-xs"},pe={class:"w-full p-1 flex flex-col"},me=s(()=>e("div",{class:"font-bold"}," Tipe ",-1)),ve=s(()=>e("option",{value:"header"},"Header",-1)),he=s(()=>e("option",{value:"detail"},"Detail",-1)),xe=[ve,he],ye={class:"w-full p-1 flex flex-col"},we=s(()=>e("div",{class:"font-bold"}," Jenis ",-1)),ge=s(()=>e("option",{value:""},null,-1)),be=s(()=>e("option",{value:"UJ"},"Uang Jalan",-1)),ke=s(()=>e("option",{value:"SB"},"Uang Standby",-1)),De=[ge,be,ke],Ce={class:"w-full sm:w-1/2 p-1 flex flex-col"},Se=s(()=>e("div",{class:"font-bold"}," Tgl Dari ",-1)),Ve={class:"text-red-500"},Ae={class:"w-full sm:w-1/2 p-1 flex flex-col"},Me=s(()=>e("div",{class:"font-bold"}," Tgl Sampai ",-1)),je={class:"text-red-500"},Ee={class:"w-full p-1 flex flex-col"},Te=s(()=>e("div",{class:"font-bold"}," Lokasi ",-1)),$e={class:"w-full p-1 flex flex-col"},Oe=s(()=>e("div",{class:"font-bold"}," Nama ",-1)),Pe={class:"w-full p-1 flex flex-col"},Ye=s(()=>e("div",{class:"font-bold"}," No Pol ",-1)),Be={class:"w-full p-1 flex items-end justify-end"},Ne=s(()=>e("div",{class:"text-left m-1"},"Download PDF",-1)),ze=s(()=>e("div",{class:"text-left m-1"},"Download Excel",-1)),Fe={__name:"ast_n_driver",async setup(u){let m,V;const{$moment:A}=te(),a={};a._TimeZoneOffset=new Date().getTimezoneOffset(),a.sort="tanggal:desc";const M=d({}),x=H("token"),_=d({from:"",to:""}),{data:y}=([m,V]=L(async()=>G(async()=>{p().loading_full=!0;let t=[],o=[],c=[];const[r,k]=await Promise.all([S("/report/ast_n_driver/load_data",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},retry:0})]);return r.status.value!=="error"&&(t=r.data.value.list_xto,c=r.data.value.list_employee,o=r.data.value.list_vehicle),r.status.value==="error"&&C().trigger(r.error),p().loading_full=!1,{list_xto:t,list_employee:c,list_vehicle:o}},"$Aw9scsfjYZ")),m=await m,V(),m),w=d([]),g=d([]),b=d([]);y.value.list_xto.forEach(t=>{w.value.push({id:t,name:t,title:"",checked:!1})}),y.value.list_employee.forEach(t=>{g.value.push({id:t.id,name:t.name,title:t.role,checked:!1})}),y.value.list_vehicle.forEach(t=>{b.value.push({id:t.id,name:t.no_pol,title:"",checked:!1})});const v=d("header"),h=d(""),j=()=>{a._TimeZoneOffset=new Date().getTimezoneOffset(),a.date_from=_.value.from?A(_.value.from).format("YYYY-MM-DD"):"",a.date_to=_.value.to?A(_.value.to).format("YYYY-MM-DD"):"",a.list_xto=JSON.stringify(w.value.filter(t=>t.checked).map(t=>t.id)),a.list_employee=JSON.stringify(g.value.filter(t=>t.checked).map(t=>t.id)),a.list_vehicle=JSON.stringify(b.value.filter(t=>t.checked).map(t=>t.id)),a.type=v.value,a.jenis=h.value},{downloadFile:N,viewFile:Ie}=ie(),f=d(!1),E=d({}),z=async()=>{if(f.value==!0){f.value=!1;return}j(),p().loading_full=!0;const{data:t,error:o,status:c}=await S("/report/ast_n_driver/pdf_preview",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:a,retry:0});if(p().loading_full=!1,c.value==="error"){C().trigger(o);return}E.value=t.value,f.value=!0},F=async()=>{j(),p().loading_full=!0;const{data:t,error:o,status:c}=await S("/report/ast_n_driver/excel_download",{method:"get",headers:{Authorization:`Bearer ${x.value}`,Accept:"application/json"},params:a,retry:0});if(p().loading_full=!1,c.value==="error"){C().trigger(o);return}N(t.value)};return(t,o)=>{const c=oe,r=R("vue-date-picker"),k=le,D=se,I=ae,J=ne,U=de;return K(),Z(q,null,[e("div",_e,[n(c,{title:"Report Transaction"}),e("div",ce,[e("div",ue,[e("form",fe,[e("div",pe,[me,T(e("select",{"onUpdate:modelValue":o[0]||(o[0]=i=>O(v)?v.value=i:null)},xe,512),[[$,l(v)]])]),e("div",ye,[we,T(e("select",{"onUpdate:modelValue":o[1]||(o[1]=i=>O(h)?h.value=i:null)},De,512),[[$,l(h)]])]),e("div",Ce,[Se,n(k,null,{default:P(()=>[n(r,{modelValue:l(_).from,"onUpdate:modelValue":o[2]||(o[2]=i=>l(_).from=i),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1}),e("p",Ve,Y(l(M).date_from),1)]),e("div",Ae,[Me,n(k,null,{default:P(()=>[n(r,{modelValue:l(_).to,"onUpdate:modelValue":o[3]||(o[3]=i=>l(_).to=i),type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue"])]),_:1}),e("p",je,Y(l(M).date_to),1)]),e("div",Ee,[Te,n(D,{arr:l(w)},null,8,["arr"])]),e("div",$e,[Oe,n(D,{arr:l(g)},null,8,["arr"])]),e("div",Pe,[Ye,n(D,{arr:l(b)},null,8,["arr"])]),e("div",Be,[e("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:o[4]||(o[4]=B(i=>z(),["prevent"]))},[e("div",null,[n(I,{class:"text-2xl"})]),Ne]),e("button",{class:"flex items-center justify-center m-1",type:"submit",name:"button",onClick:o[5]||(o[5]=B(i=>F(),["prevent"]))},[e("div",null,[n(J,{class:"text-2xl"})]),ze])])])])])]),n(U,{show:l(f),pdfContent:l(E),onClose:o[6]||(o[6]=i=>f.value=!l(f))},null,8,["show","pdfContent"])],64)}}},Xe=re(Fe,[["__scopeId","data-v-482a7a20"]]);export{Xe as default};
