import{_ as P}from"./HeaderPopup.vue.bea94c70.js";import{_ as V}from"./WidthMiniPart.vue.39e76276.js";import{r as y,f as j,j as S,m as $,J as B,o,c as r,a as l,b as k,t as s,k as a,l as i,x as J,E as T,A as x,B as M}from"./entry.5a747926.js";import{u as g}from"./useUtils.2d281fff.js";import{u as C}from"./useMyFetch.afd0e316.js";import"./Times.d17da5ed.js";import"./_plugin-vue_export-helper.c27b6911.js";const F={class:"box-fixed"},I={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},q={class:"w-full flex flex-col items-center grow overflow-auto"},O={class:"w-full flex flex-row flex-wrap"},E={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},R=l("label",{for:""},"U.Jalan Per",-1),U={class:"card-border"},z={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},K=l("label",{for:""},"Jenis",-1),W={class:"card-border"},G={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},L=l("label",{for:""},"Payment Method",-1),Q={class:"card-border"},X={class:"w-6/12 sm:w-3/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},Z=l("label",{for:""},"No Pol",-1),ee={class:"card-border"},ae={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},le=l("label",{for:""},"Supir",-1),te={class:"card-border"},se={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},oe=l("label",{for:""},"Kernet",-1),re={class:"card-border"},_e={key:0,class:"w-full flex flex-wrap"},ne={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-4/12 flex flex-col flex-wrap p-1"},ie=l("label",{for:""},"Tujuan",-1),ve={class:"card-border"},de={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-4/12 flex flex-col flex-wrap p-1"},ce=l("label",{for:""},"Tipe",-1),ue={class:"card-border"},fe={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-4/12 flex flex-col flex-wrap p-1"},me=l("label",{for:""},"Total Dari U.Jalan",-1),pe={class:"card-border"},we={key:1,class:"w-full flex flex-wrap"},he={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},xe=l("label",{for:""},"Cost Center Code",-1),be={class:"card-border"},ye={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},ke=l("label",{for:""},"Cost Center Desc",-1),ge={class:"card-border"},Ye={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},De=l("label",{for:""},"PVR No",-1),Me={class:"card-border"},Ce={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Ne=l("label",{for:""},"PVR Total",-1),Ae={class:"card-border"},He={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},Pe=l("label",{for:""},"PV",-1),Ve={class:"card-border"},je={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Se=l("label",{for:""},"PV Amount",-1),$e={class:"card-border"},Be={class:"w-full flex items-center justify-end"},Je={class:"w-full flex flex-wrap p-3 items-center"},Te=l("div",null," Di Validasi oleh : ",-1),Fe={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},Ie={key:0},qe={key:1},Oe={key:2},Ee={key:3},Re={key:4},Ue={key:5},ea={__name:"trx_trp_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},setup(w){const c=w,{$moment:u}=T(),{pointFormat:b}=g(),e=y({...{id:-1,tanggal:new Date,payment_method:{name:""},id_uj:-1,xto:"",tipe:"",jenis:"",amount:0,pv_id:-1,pv_no:"",pv_total:0,supir:"",kernet:"",no_pol:"",val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:"",val3:0,val3_by:{username:""},val3_at:"",val4:0,val4_by:{username:""},val4_at:"",val5:0,val5_by:{username:""},val5_at:"",cost_center_code:"",cost_center_desc:"",pvr_id:"",pvr_no:"",pvr_total:"",pvr_had_detail:""}}),Y=j("token"),D={_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:-1,name:"",title:"",note:""},_=y(JSON.parse(JSON.stringify(D))),n=y(JSON.parse(JSON.stringify(D))),N=async()=>{x().loading_full=!0;const d=new FormData;let v="post",p=c.id;p==0||(d.append("id",p),d.append("_method","PUT"));const{data:t,error:f,status:h}=await C("/trx_trp_validasi",{method:v,headers:{Authorization:`Bearer ${Y.value}`,Accept:"application/json"},body:d,retry:0});if(x().loading_full=!1,h.value==="error"){M().trigger(f);return}e.value.val=t.value.val,e.value.val_user=t.value.val_user,e.value.val_by=t.value.val_by,e.value.val_at=t.value.val_at,e.value.val1=t.value.val1,e.value.val1_user=t.value.val1_user,e.value.val1_by=t.value.val1_by,e.value.val1_at=t.value.val1_at,e.value.val2=t.value.val2,e.value.val2_user=t.value.val2_user,e.value.val2_by=t.value.val2_by,e.value.val2_at=t.value.val2_at,e.value.val3=t.value.val3,e.value.val3_user=t.value.val3_user,e.value.val3_by=t.value.val3_by,e.value.val3_at=t.value.val3_at,e.value.val4=t.value.val4,e.value.val4_user=t.value.val4_user,e.value.val4_by=t.value.val4_by,e.value.val4_at=t.value.val4_at,e.value.val5=t.value.val5,e.value.val5_user=t.value.val5_user,e.value.val5_by=t.value.val5_by,e.value.val5_at=t.value.val5_at;let m=c.p_data.map(H=>H.id).indexOf(c.id);m>=-1&&c.p_data.splice(m,1,{...e.value}),c.fnClose()},A=async()=>{x().loading_full=!0;const{data:d,error:v,status:p}=await C("/trx_trp",{method:"get",headers:{Authorization:`Bearer ${Y.value}`,Accept:"application/json"},params:{id:c.id},retry:0});if(x().loading_full=!1,p.value==="error"){M().trigger(v);return}let t=d.value.data;e.value=t,_.value._.id.val=t.supir_id,_.value._.name.val=t.supir,_.value._.rek_no.val=t.supir_rek_no,_.value._.rek_name.val=t.supir_rek_name,_.value.id=t.supir_id,_.value.name=t.supir,_.value.rek_no=(t.supir_rek_no||"")+" "+(t.supir_rek_name||""),n.value._.id.val=t.kernet_id,n.value._.name.val=t.kernet,n.value._.rek_no.val=t.kernet_rek_no,n.value._.rek_name.val=t.kernet_rek_name,n.value.id=t.kernet_id,n.value.name=t.kernet,n.value.rek_no=(t.kernet_rek_no||"")+" "+(t.kernet_rek_name||"");let f=0,h=0;t.potongan.forEach(m=>{m.potongan_mst.employee_id==t.supir_id&&(f+=parseInt(m.nominal_cut)),m.potongan_mst.employee_id==t.kernet_id&&(h+=parseInt(m.nominal_cut))}),_.value.note="",n.value.note="",f>0&&(_.value.note="Telah di potong sebesar :"+g().pointFormat(f)),h>0&&(n.value.note="Telah di potong sebesar :"+g().pointFormat(h))};return S(()=>c.show,(d,v)=>{d==!0&&A()},{immediate:!0}),(d,v)=>{const p=P,t=V;return $((o(),r("section",F,[l("div",null,[k(p,{title:"Form Transaction Validation",fn:w.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),l("form",I,[l("div",q,[l("div",O,[l("div",E,[R,l("div",U,s(a(e).tanggal?a(u)(a(e).tanggal).format("DD-MM-YYYY"):""),1)]),l("div",z,[K,l("div",W,s(a(e).jenis),1)]),l("div",G,[L,l("div",Q,s(a(e).payment_method.name),1)]),l("div",X,[Z,l("div",ee,s(a(e).no_pol),1)]),l("div",ae,[le,l("div",te,[k(t,{selected:a(_)},null,8,["selected"])])]),l("div",se,[oe,l("div",re,[k(t,{selected:a(n)},null,8,["selected"])])]),a(e).jenis!=""?(o(),r("div",_e,[l("div",ne,[ie,l("div",ve,s(a(e).xto),1)]),l("div",de,[ce,l("div",ue,s(a(e).tipe),1)]),l("div",fe,[me,l("div",pe,s(a(b)(a(e).amount||0)),1)])])):i("",!0),a(e).jenis!=""?(o(),r("div",we,[l("div",he,[xe,l("div",be,s(a(e).cost_center_code),1)]),l("div",ye,[ke,l("div",ge,s(a(e).cost_center_desc),1)]),l("div",Ye,[De,l("div",Me,s(a(e).pvr_no),1)]),l("div",Ce,[Ne,l("div",Ae,s(a(b)(a(e).pvr_total||0)),1)]),l("div",He,[Pe,l("div",Ve,s(a(e).pv_no),1)]),l("div",je,[Se,l("div",$e,s(a(b)(a(e).pv_total||0)),1)])])):i("",!0)])]),l("div",Be,[l("div",Je,[Te,a(e).val||a(e).val1||a(e).val2||a(e).val3||a(e).val4||a(e).val5?(o(),r("div",Fe,[a(e).val?(o(),r("div",Ie," App 1 : "+s(a(e).val_by.username)+" ( "+s(a(e).val_at?a(u)(a(e).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):i("",!0),a(e).val1?(o(),r("div",qe," App 2 : "+s(a(e).val1_by.username)+" ( "+s(a(e).val1_at?a(u)(a(e).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):i("",!0),a(e).val2?(o(),r("div",Oe," App 3 : "+s(a(e).val2_by.username)+" ( "+s(a(e).val2_at?a(u)(a(e).val2_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):i("",!0),a(e).val3?(o(),r("div",Ee," App 4 : "+s(a(e).val3_by.username)+" ( "+s(a(e).val3_at?a(u)(a(e).val3_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):i("",!0),a(e).val4?(o(),r("div",Re," App 5 : "+s(a(e).val4_by.username)+" ( "+s(a(e).val4_at?a(u)(a(e).val4_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):i("",!0),a(e).val5?(o(),r("div",Ue," App 6 : "+s(a(e).val5_by.username)+" ( "+s(a(e).val5_at?a(u)(a(e).val5_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):i("",!0)])):i("",!0)]),l("button",{type:"button",name:"button",class:"w-36 m-1",onClick:v[0]||(v[0]=f=>w.fnClose())}," Cancel "),w.is_view==0?(o(),r("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:v[1]||(v[1]=J(f=>N(),["prevent"]))}," Validasi ")):i("",!0)])])])],512)),[[B,w.show]])}}};export{ea as default};
