import ce from"./Header.b5ea8c88.js";import de from"./Plus.94d8c724.js";import _e from"./Edit.35757ef4.js";import me from"./Delete.c5f608c9.js";import fe from"./Signature.be0dea7c.js";import pe from"./Search.39322af2.js";import ve from"./Line.1926c6e2.js";import he from"./Check.a1d5e1a7.js";import{_ as ge}from"./PopupMini.vue.6a364d9f.js";import ye from"./employee.004ec7a8.js";import ke from"./employee_validasi.c6da0308.js";import{f as be,g as xe,r as u,h as we,i as V,s as De,j as Ce,c as k,a as e,b as d,m as S,v as z,k as o,n as H,q as O,x as Se,F as U,y as Ae,w as $e,z as Te,A as g,B,o as p,C as Me,D as K,t as i,d as Ne,p as Ie,e as Be,E as Ee}from"./entry.8d88fbfb.js";import{u as E}from"./useMyFetch.a2c9d4d6.js";import{_ as je}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.e9e21824.js";import"./Exclamation.5e608fcd.js";import"./HeaderPopup.vue.a1c6313a.js";import"./useUtils.3a4e475a.js";const _=b=>(Ie("data-v-e0ecf7c0"),b=b(),Be(),b),Fe={class:"w-full h-full flex flex-col"},Le={class:"w-full flex grow flex-col overflow-auto h-0"},Pe={class:"w-full flex"},Re={action:"#",class:"w-full flex p-1"},Ve={class:"grow"},ze=_(()=>e("div",{class:"font-bold"}," Keyword ",-1)),He={class:"pl-1"},Oe=_(()=>e("div",{class:"font-bold"}," Sort By ",-1)),Ue=_(()=>e("option",{value:""},null,-1)),Ke=_(()=>e("option",{value:"name"},"Nama",-1)),Je=_(()=>e("option",{value:"role"},"Jabatan",-1)),Ye=[Ue,Ke,Je],qe={class:"pl-1"},Ze=_(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),Ge=_(()=>e("option",{value:"asc"},"Asc",-1)),Qe=_(()=>e("option",{value:"desc"},"Desc",-1)),We=[Ge,Qe],Xe={class:"flex items-end pl-1"},et={class:"w-full flex justify-center items-center grow h-0 p-1"},tt={key:0,class:""},at={class:"tacky"},ot=_(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App"),e("th",null,"No."),e("th",null,"Nama"),e("th",null,"Jabatan"),e("th",null,"No KTP"),e("th",null,"No SIM"),e("th",null,"Nama Bank"),e("th",null,"No Rek"),e("th",null,"Nama Rek"),e("th",null,"Phone Number"),e("th",null,"Tanggal Dibuat"),e("th",null,"Tanggal Diubah")])],-1)),lt=["onClick"],st={class:"w-full h-full flex items-center justify-center"},nt={class:"bold"},ut={class:"grow mb-5"},rt={__name:"index",async setup(b){let x,j;const{$moment:F}=Ee(),c={};c._TimeZoneOffset=new Date().getTimezoneOffset();const A=be("token"),{data:s}=([x,j]=xe(async()=>Te(async()=>{g().loading_full=!0;const{data:l,error:t,status:f}=await E("/employees",{method:"get",headers:{Authorization:`Bearer ${A.value}`,Accept:"application/json"},params:c,retry:0});return g().loading_full=!1,f.value==="error"?(B().trigger(t),[]):l.value.data},"$p5jj5crAgd")),x=await x,j(),x),v=u(""),m=u({field:"",by:"desc"}),r=u(-1),n=u({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),J=()=>{c.like="",v.value!=""&&(c.like=`id:%${v.value}%,name:%${v.value}%`),c.sort="",m.value.field&&(c.sort=m.value.field+":"+m.value.by)},w=u(null),L=async()=>{g().loading_full=!0,n.value.may_get_data=!1,c.page=n.value.page,c.page==1&&(s.value=[]);const{data:l,error:t,status:f}=await E("/employees",{method:"get",headers:{Authorization:`Bearer ${A.value}`,Accept:"application/json"},params:c,retry:0});if(g().loading_full=!1,n.value.may_get_data=!0,f.value==="error"){B().trigger(t);return}n.value.page==1?(s.value=l.value.data,w.value&&(w.value.scrollTop=0)):n.value.page>1&&(s.value=[...s.value,...l.value.data]),l.value.data.length==0&&(n.value.is_last_record=!0)},Y=async()=>{if(!n.value.may_get_data)return;let l=w.value;if(l.scrollLeft!=n.value.scrollLeft){n.value.scrollLeft=l.scrollLeft;return}n.value.is_last_record||!(Math.round(l.scrollTop)+l.clientHeight>=l.scrollHeight-1)||(n.value.page++,await L())},q=()=>{n.value.page=1,n.value.is_last_record=!1,J(),L()};we();const D=u(!1),$=u(0),Z=()=>{$.value=0,D.value=!0},{display:T}=V();De(V());const G=()=>{r.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):($.value=s.value[r.value].id,D.value=!0)},M=u(!1),P=u(0),Q=()=>{r.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=s.value[r.value].id,M.value=!0)},N=u(!1),R=u({}),y=u(!1),h=u(""),W=async()=>{y.value&&(y.value=!1)},X=()=>{r.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(h.value="",R.value={id:s.value[r.value].id},y.value=!0)};Ce(()=>h.value,l=>{l.trim().length>0?N.value=!0:N.value=!1},{immediate:!1});const ee=async()=>{g().loading_full=!0;const l=new FormData;l.append("id",s.value[r.value].id),l.append("deleted_reason",h.value),l.append("_method","DELETE");const{data:t,error:f,status:I}=await E("/employee",{method:"post",headers:{Authorization:`Bearer ${A.value}`,Accept:"application/json"},body:l,retry:0});if(g().loading_full=!1,I.value==="error"){B().trigger(f);return}s.value.splice(r.value,1),r.value=-1,y.value=!1};return(l,t)=>{const f=ce,I=de,te=_e,ae=me,oe=fe,le=pe,se=ve,ne=he,ue=ge,re=ye,ie=ke;return p(),k(U,null,[e("div",Fe,[d(f,{title:"List Employee"}),e("div",Le,[e("div",Pe,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[0]||(t[0]=a=>Z())},[d(I)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=a=>G())},[d(te)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=a=>X())},[d(ae)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[3]||(t[3]=a=>Q())},[d(oe)])]),e("form",Re,[e("div",Ve,[ze,S(e("input",{class:"",type:"text","onUpdate:modelValue":t[4]||(t[4]=a=>H(v)?v.value=a:null),name:"search",placeholder:"Keyword"},null,512),[[z,o(v)]])]),e("div",He,[Oe,S(e("select",{class:"","onUpdate:modelValue":t[5]||(t[5]=a=>o(m).field=a)},Ye,512),[[O,o(m).field]])]),e("div",qe,[Ze,S(e("select",{class:"","onUpdate:modelValue":t[6]||(t[6]=a=>o(m).by=a)},We,512),[[O,o(m).by]])]),e("div",Xe,[e("button",{class:"",type:"submit",name:"button",onClick:t[7]||(t[7]=Se(a=>q(),["prevent"]))},[d(le,{class:"text-2xl"})])])]),e("div",et,[o(s).length==0?(p(),k("div",tt," Maaf Tidak Ada Record ")):(p(),k("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:w,onScroll:Y},[e("table",at,[ot,e("tbody",null,[(p(!0),k(U,null,Ae(o(s),(a,C)=>(p(),k("tr",{key:C,onClick:it=>r.value=C,class:Me(o(r)==C?"active":"")},[e("td",null,[e("div",st,[a.val?(p(),K(ne,{key:1})):(p(),K(se,{key:0}))])]),e("td",null,i(C+1)+".",1),e("td",nt,i(a.name),1),e("td",null,i(a.role),1),e("td",null,i(a.ktp_no),1),e("td",null,i(a.sim_no),1),e("td",null,i(a.bank_name),1),e("td",null,i(a.rek_no),1),e("td",null,i(a.rek_name),1),e("td",null,i(a.phone_number),1),e("td",null,i(o(F)(a.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,i(o(F)(a.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,lt))),128))])])],544))])])]),d(ue,{type:"delete",show:o(y),data:o(R),fnClose:W,fnConfirm:ee,enabledOk:o(N)},{footer:$e(()=>[Ne(" Masukkan Alasan Penghapusan: "),e("div",ut,[S(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=a=>H(h)?h.value=a:null)},null,512),[[z,o(h)]])])]),_:1},8,["show","data","enabledOk"]),d(re,{show:o(D),fnClose:()=>{D.value=!1},id:o($),p_data:o(s)},null,8,["show","fnClose","id","p_data"]),d(ie,{show:o(M),fnClose:()=>{M.value=!1},id:o(P),p_data:o(s)},null,8,["show","fnClose","id","p_data"])],64)}}},$t=je(rt,[["__scopeId","data-v-e0ecf7c0"]]);export{$t as default};
