import{_ as L}from"./HeaderPopup.vue.3a900691.js";import{_ as z}from"./client-only.85ccf7d4.js";import{r as j,g as K,i as T,f as R,I as U,k as S,K as E,o as d,c,a as t,b as D,l as a,t as s,w as Y,m as I,A as O,n as w,d as i,F as B,D as H,C as Q,G as W,x as F,y as A}from"./entry.e181b2a0.js";import{u as M}from"./useUtils.311d317f.js";import{u as G}from"./useMyFetch.dcf65f79.js";import"./Times.3821d6e4.js";import"./_plugin-vue_export-helper.c27b6911.js";const X={class:"box-fixed"},Z={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},x={class:"w-full flex flex-col items-center grow overflow-auto"},tt={class:"w-full flex flex-row flex-wrap"},at={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},st=t("label",{for:""},"Period End",-1),nt={key:0,class:"card-border"},_t={key:1},et={class:"text-red-500"},ot={key:0,class:"w-full sm:w-6/12 md:w-4/12 lg:w-4/12 p-1"},lt=t("div",{class:"font-bold"}," Filter Nama ",-1),it={key:0,class:"w-full flex p-1 justify-between flex-wrap"},rt={class:"w-full",role:"sticky"},pt={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},ut=t("tr",{class:"sticky -top-1 !z-[2]"},[t("td",{colspan:"44",class:"!bg-slate-800 text-white font-bold"}," Detail ")],-1),dt={class:"sticky top-7 !z-[2]"},ct=t("th",{rowspan:"2"},"No",-1),mt=t("th",{rowspan:"2"},"ID",-1),ht=t("th",{rowspan:"2"},"Nama Pekerja",-1),bt=t("th",{rowspan:"2"},"Jabatan",-1),gt=t("th",{rowspan:"2"},"Tmpt Lahir",-1),yt=t("th",{rowspan:"2"},"Tgl Lahir",-1),jt=t("th",{rowspan:"2"},"TMK",-1),ft=t("th",{rowspan:"2"},"No KTP",-1),kt=t("th",{rowspan:"2"},"Alamat",-1),vt=t("th",{rowspan:"2"},"Status",-1),wt=t("th",{rowspan:"2"},"No Rek",-1),Ft=t("th",{rowspan:"2"},"Nama Rek",-1),Dt=t("th",{rowspan:"2"},"Nama Bank",-1),Mt={colspan:"3"},Pt={class:"text-sm"},Ct={rowspan:"2"},Nt={class:"text-sm"},Tt={rowspan:"2"},St={class:"text-sm"},Bt={colspan:"3"},At={class:"text-sm"},Gt={rowspan:"2"},Vt={class:"text-sm"},qt={rowspan:"2"},Jt={class:"text-sm"},$t={colspan:"4"},Lt={class:"text-sm"},zt={rowspan:"2"},Kt={class:"text-sm"},Rt={rowspan:"2"},Ut={class:"text-sm"},Et={colspan:"3"},Yt={class:"text-sm"},It={colspan:"4"},Ot={class:"text-sm"},Ht={colspan:"3",class:"whitespace-nowrap"},Qt={class:"text-sm"},Wt={rowspan:"2"},Xt={class:"text-sm"},Zt={rowspan:"2"},xt={class:"text-sm"},ta={rowspan:"2"},aa={class:"text-sm"},sa={rowspan:"2"},na={class:"text-sm"},_a={rowspan:"2"},ea={class:"text-sm"},oa={class:"sticky top-[60px] !z-[2]"},la={class:"text-sm"},ia={class:"text-sm"},ra={class:"text-sm"},pa={class:"text-sm"},ua={class:"text-sm"},da={class:"text-sm"},ca={class:"text-sm"},ma={class:"text-sm"},ha={class:"text-sm"},ba={class:"text-sm"},ga={class:"text-sm"},ya={class:"text-sm"},ja={class:"text-sm"},fa={class:"text-sm"},ka={class:"text-sm"},va={class:"text-sm"},wa={class:"text-sm"},Fa={class:"text-sm"},Da={class:"text-sm"},Ma={class:"text-sm"},Pa={ref:"to_move"},Ca=["data-index"],Na={class:"w-full flex items-center justify-end"},Ja={__name:"rpt_salary",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(f){const h=f,{$moment:k}=W(),{pointFormat:e}=M(),P={id:"",period_end:new Date},r=j({...P}),C=K("token"),v=j({}),b=j([]),l=j([]),V=async()=>{F().loading_full=!0,v.value={};const p=new FormData;p.append("period_end",r.value.period_end?k(r.value.period_end).format("Y-MM"):"");let u="post",m=r.value.id;m==""||(p.append("id",m),p.append("_method","PUT"));const{data:n,error:_,status:o}=await G("/rpt_salary",{method:u,headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},body:p,retry:0});if(F().loading_full=!1,o.value==="error"){A().trigger(_,v);return}if(b.value=n.value.details,m<=0)r.value.id=n.value.id,r.value.created_at=n.value.created_at,r.value.updated_at=n.value.updated_at,h.p_data.unshift(r.value);else{r.value.updated_at=n.value.updated_at;let g=h.p_data.map($=>$.id).indexOf(m);g>=-1&&h.p_data.splice(g,1,{...r.value})}},q=T(()=>r.value.val&&r.value.val1||M().checkPermission("rpt_salary.val")&&r.value.val||M().checkPermission("rpt_salary.val1")&&r.value.val1),J=async()=>{F().loading_full=!0;const{data:p,error:u,status:m}=await G("/rpt_salary",{method:"get",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},params:{id:h.id},retry:0});if(F().loading_full=!1,m.value==="error"){A().trigger(u);return}r.value=p.value.data,h.is_copy&&(r.value.val=0,r.value.val1=0),b.value=p.value.data.details;let n={details:p.value.data.details,standby_1_ttl:0,standby_1_gaji:0,standby_1_makan:0,standby_1_dinas:0,perubahaan_lainnya_1_ttl:0,periode_1_ttl:0,standby_2_ttl:0,standby_2_gaji:0,standby_2_makan:0,standby_2_dinas:0,perubahaan_lainnya_2_ttl:0,perubahaan_kerajinan_ttl:0,periode_2_ttl:0,periode_ttl:0,trip_umum_ttl:0,trip_umum_gaji:0,trip_umum_makan:0,trip_umum_dinas:0,trip_lain_ttl:0,trip_lain_jlh:0,trip_lain_gaji:0,trip_lain_makan:0,trip_lain_dinas:0,trip_tunggu_ttl:0,trip_tunggu_jlh:0,trip_tunggu_gaji:0,trip_tunggu_dinas:0,bonus_trip_ttl:0,bonus_trip_jlh:0,bonus_trip_gaji:0,bonus_trip_dinas:0,bonus_trip_perubahaan:0,potongan_trip:0,total:0,bpjs_kesehatan_ttl:0,bpjs_jamsos_ttl:0,total_grand:0};n.details.forEach(_=>{_.periode_1_ttl=parseFloat(_.sb_gaji)+parseFloat(_.sb_makan)+parseFloat(_.sb_dinas)+parseFloat(_.salary_bonus_nominal),_.bonus_trip_jlh=_.trip_cpo+_.trip_pk+_.trip_tbs+_.trip_tbsk,_.bonus_trip_gaji=parseFloat(_.trip_cpo_bonus_gaji)+parseFloat(_.trip_pk_bonus_gaji)+parseFloat(_.trip_tbs_bonus_gaji)+parseFloat(_.trip_tbsk_bonus_gaji),_.bonus_trip_dinas=parseFloat(_.trip_cpo_bonus_dinas)+parseFloat(_.trip_pk_bonus_dinas)+parseFloat(_.trip_tbs_bonus_dinas)+parseFloat(_.trip_tbsk_bonus_dinas),_.periode_2_ttl=parseFloat(_.sb_gaji_2)+parseFloat(_.sb_makan_2)+parseFloat(_.sb_dinas_2)+parseFloat(_.salary_bonus_nominal_2)+parseFloat(_.kerajinan)+parseFloat(_.bonus_trip_gaji)+parseFloat(_.bonus_trip_dinas)+parseFloat(_.salary_bonus_bonus_trip),_.periode_ttl=_.periode_1_ttl+_.periode_2_ttl,_.total=parseFloat(_.uj_gaji)+parseFloat(_.uj_makan)+parseFloat(_.uj_dinas)+parseFloat(_.trip_lain_gaji)+parseFloat(_.trip_lain_makan)+parseFloat(_.trip_lain_dinas)+parseFloat(_.trip_tunggu_gaji)+parseFloat(_.trip_tunggu_dinas)-parseFloat(_.nominal_cut),_.total_grand=_.periode_ttl+_.total-parseFloat(_.employee_bpjs_kesehatan)-parseFloat(_.employee_bpjs_jamsos),n.standby_1_gaji+=parseFloat(_.sb_gaji),n.standby_1_makan+=parseFloat(_.sb_makan),n.standby_1_dinas+=parseFloat(_.sb_dinas),n.perubahaan_lainnya_1_ttl+=parseFloat(_.salary_bonus_nominal),n.standby_2_gaji+=parseFloat(_.sb_gaji_2),n.standby_2_makan+=parseFloat(_.sb_makan_2),n.standby_2_dinas+=parseFloat(_.sb_dinas_2),n.perubahaan_lainnya_2_ttl+=parseFloat(_.salary_bonus_nominal_2),n.perubahaan_kerajinan_ttl+=parseFloat(_.kerajinan),n.trip_umum_gaji+=parseFloat(_.uj_gaji),n.trip_umum_makan+=parseFloat(_.uj_makan),n.trip_umum_dinas+=parseFloat(_.uj_dinas),n.trip_lain_jlh+=_.trip_lain,n.trip_lain_gaji+=parseFloat(_.trip_lain_gaji),n.trip_lain_makan+=parseFloat(_.trip_lain_makan),n.trip_lain_dinas+=parseFloat(_.trip_lain_dinas),n.trip_tunggu_jlh+=_.trip_tunggu,n.trip_tunggu_gaji+=parseFloat(_.trip_tunggu_gaji),n.trip_tunggu_dinas+=parseFloat(_.trip_tunggu_dinas),n.bonus_trip_jlh+=_.bonus_trip_jlh,n.bonus_trip_gaji+=_.bonus_trip_gaji,n.bonus_trip_dinas+=_.bonus_trip_dinas,n.bonus_trip_perubahaan+=parseFloat(_.salary_bonus_bonus_trip),n.potongan_trip+=parseFloat(_.nominal_cut),n.bpjs_kesehatan_ttl+=parseFloat(_.employee_bpjs_kesehatan),n.bpjs_jamsos_ttl+=parseFloat(_.employee_bpjs_jamsos)}),n.standby_1_ttl=n.standby_1_gaji+n.standby_1_makan+n.standby_1_dinas,n.periode_1_ttl=n.standby_1_ttl+n.perubahaan_lainnya_1_ttl,n.standby_2_ttl=n.standby_2_gaji+n.standby_2_makan+n.standby_2_dinas,n.bonus_trip_ttl=n.bonus_trip_gaji+n.bonus_trip_dinas+n.bonus_trip_perubahaan,n.periode_2_ttl=n.standby_2_ttl+n.perubahaan_lainnya_2_ttl+n.perubahaan_kerajinan_ttl+n.bonus_trip_ttl,n.periode_ttl=n.periode_1_ttl+n.periode_2_ttl,n.trip_umum_ttl=n.trip_umum_gaji+n.trip_umum_makan+n.trip_umum_dinas,n.trip_lain_ttl=n.trip_lain_gaji+n.trip_lain_makan+n.trip_lain_dinas,n.trip_tunggu_ttl=n.trip_tunggu_gaji+n.trip_tunggu_dinas,n.total=n.trip_umum_ttl+n.trip_lain_ttl+n.trip_tunggu_ttl-n.potongan_trip,n.total_grand=n.periode_ttl+n.total-n.bpjs_kesehatan_ttl-n.bpjs_jamsos_ttl,l.value=n},y=j(""),N=T(()=>y.value!=""?b.value.filter(p=>p.employee.name.toLowerCase().includes(y.value.toLowerCase())):b.value);return R(()=>h.show,(p,u)=>{p==!0&&(r.value={...P},b.value=[],v.value={},h.id!=0&&J())},{immediate:!0}),(p,u)=>{const m=L,n=U("vue-date-picker"),_=z;return S((d(),c("section",X,[t("div",null,[D(m,{title:"Form Salary Report",fn:f.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",Z,[t("div",x,[t("div",tt,[t("div",at,[st,a(r).id?(d(),c("div",nt,s(a(k)(a(r).period_end).format("MM-Y")),1)):(d(),c("div",_t,[D(_,null,{default:Y(()=>[D(n,{modelValue:a(r).period_end,"onUpdate:modelValue":u[0]||(u[0]=o=>a(r).period_end=o),format:"MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"","month-picker":""},null,8,["modelValue"])]),_:1})])),t("p",et,s(a(v).period_end),1)]),a(b).length?(d(),c("div",ot,[lt,S(t("input",{class:"",type:"text","onUpdate:modelValue":u[1]||(u[1]=o=>I(y)?y.value=o:null),name:"search",placeholder:"Nama"},null,512),[[O,a(y)]])])):w("",!0)]),a(N).length?(d(),c("div",it,[t("div",rt,[t("table",pt,[t("thead",null,[ut,t("tr",dt,[ct,mt,ht,bt,gt,yt,jt,ft,kt,vt,wt,Ft,Dt,t("th",Mt,[i("Standby 1 "),t("span",Pt,"("+s(a(e)(a(l).standby_1_ttl))+")",1)]),t("th",Ct,[i("Potongan 1 "),t("span",Nt,"("+s(a(e)(a(l).perubahaan_lainnya_1_ttl))+")",1)]),t("th",Tt,[i("Periode 1 "),t("span",St,"("+s(a(e)(a(l).periode_1_ttl))+")",1)]),t("th",Bt,[i("Standby 2 "),t("span",At,"("+s(a(e)(a(l).standby_2_ttl))+")",1)]),t("th",Gt,[i("Potongan 2 "),t("span",Vt,"("+s(a(e)(a(l).perubahaan_lainnya_2_ttl))+")",1)]),t("th",qt,[i("U.Kerajinan "),t("span",Jt,"("+s(a(e)(a(l).perubahaan_kerajinan_ttl))+")",1)]),t("th",$t,[i("Bonus Trip "),t("span",Lt,"("+s(a(e)(a(l).bonus_trip_ttl))+")",1)]),t("th",zt,[i("Periode 2 "),t("span",Kt,"("+s(a(e)(a(l).periode_2_ttl))+")",1)]),t("th",Rt,[i("Periode 1+2 "),t("span",Ut,"("+s(a(e)(a(l).periode_ttl))+")",1)]),t("th",Et,[i("Trip "),t("span",Yt,"("+s(a(e)(a(l).trip_umum_ttl))+")",1)]),t("th",It,[i("Trip Lain "),t("span",Ot,"("+s(a(e)(a(l).trip_lain_ttl))+")",1)]),t("th",Ht,[i("Trip Tunggu "),t("span",Qt,"("+s(a(e)(a(l).trip_tunggu_ttl))+")",1)]),t("th",Wt,[i("Potongan Trip "),t("span",Xt,"("+s(a(e)(a(l).potongan_trip))+")",1)]),t("th",Zt,[i("Total "),t("span",xt,"("+s(a(e)(a(l).total))+")",1)]),t("th",ta,[i("BPJS Kesehatan "),t("span",aa,"("+s(a(e)(a(l).bpjs_kesehatan_ttl))+")",1)]),t("th",sa,[i("BPJS Jamsos "),t("span",na,"("+s(a(e)(a(l).bpjs_jamsos_ttl))+")",1)]),t("th",_a,[i("Grand Total "),t("span",ea,"("+s(a(e)(a(l).total_grand))+")",1)])]),t("tr",oa,[t("th",null,[i("Gaji "),t("span",la,"("+s(a(e)(a(l).standby_1_gaji))+")",1)]),t("th",null,[i("Makan "),t("span",ia,"("+s(a(e)(a(l).standby_1_makan))+")",1)]),t("th",null,[i("Dinas "),t("span",ra,"("+s(a(e)(a(l).standby_1_dinas))+")",1)]),t("th",null,[i("Gaji "),t("span",pa,"("+s(a(e)(a(l).standby_2_gaji))+")",1)]),t("th",null,[i("Makan "),t("span",ua,"("+s(a(e)(a(l).standby_2_makan))+")",1)]),t("th",null,[i("Dinas "),t("span",da,"("+s(a(e)(a(l).standby_2_dinas))+")",1)]),t("th",null,[i("Jmlh "),t("span",ca,"("+s(a(e)(a(l).bonus_trip_jlh))+")",1)]),t("th",null,[i("Gaji "),t("span",ma,"("+s(a(e)(a(l).bonus_trip_gaji))+")",1)]),t("th",null,[i("Dinas "),t("span",ha,"("+s(a(e)(a(l).bonus_trip_dinas))+")",1)]),t("th",null,[i("Potongan "),t("span",ba,"("+s(a(e)(p.bonus_trip_perubahaan||0))+" )",1)]),t("th",null,[i("Gaji "),t("span",ga,"("+s(a(e)(a(l).trip_umum_gaji))+")",1)]),t("th",null,[i("Makan "),t("span",ya,"("+s(a(e)(a(l).trip_umum_makan))+")",1)]),t("th",null,[i("Dinas "),t("span",ja,"("+s(a(e)(a(l).trip_umum_dinas))+")",1)]),t("th",null,[i("Jmlh "),t("span",fa,"("+s(a(e)(a(l).trip_lain_jlh))+")",1)]),t("th",null,[i("Gaji "),t("span",ka,"("+s(a(e)(a(l).trip_lain_gaji))+")",1)]),t("th",null,[i("Makan "),t("span",va,"("+s(a(e)(a(l).trip_lain_makan))+")",1)]),t("th",null,[i("Dinas "),t("span",wa,"("+s(a(e)(a(l).trip_lain_dinas))+")",1)]),t("th",null,[i("Jmlh "),t("span",Fa,"("+s(a(e)(a(l).trip_tunggu_jlh))+")",1)]),t("th",null,[i("Gaji "),t("span",Da,"("+s(a(e)(a(l).trip_tunggu_gaji))+")",1)]),t("th",null,[i("Dinas "),t("span",Ma,"("+s(a(e)(a(l).trip_tunggu_dinas))+")",1)])])]),t("tbody",Pa,[(d(!0),c(B,null,H(a(N),(o,g)=>(d(),c(B,{key:g},[o.p_status!="Remove"?(d(),c("tr",{key:0,"data-index":g},[t("td",null,s(g+1)+".",1),t("td",null,s(o.employee_id),1),t("td",null,s(o.employee_name),1),t("td",null,s(o.employee_role),1),t("td",null,s(o.employee_birth_place),1),t("td",null,s(o.employee_birth_date?a(k)(o.employee_birth_date).format("DD-MM-Y"):""),1),t("td",null,s(o.employee_tmk?a(k)(o.employee_tmk).format("DD-MM-Y"):""),1),t("td",null,s(o.employee_ktp_no),1),t("td",null,s(o.employee_address),1),t("td",null,s(o.employee_status),1),t("td",null,s(o.employee_rek_no),1),t("td",null,s(o.employee_rek_name),1),t("td",null,s(o.employee_bank_name),1),t("td",null,s(a(e)(o.sb_gaji)),1),t("td",null,s(a(e)(o.sb_makan)),1),t("td",null,s(a(e)(o.sb_dinas)),1),t("td",null,s(a(e)(o.salary_bonus_nominal)),1),t("td",null,s(a(e)(o.periode_1_ttl)),1),t("td",null,s(a(e)(o.sb_gaji_2)),1),t("td",null,s(a(e)(o.sb_makan_2)),1),t("td",null,s(a(e)(o.sb_dinas_2)),1),t("td",null,s(a(e)(o.salary_bonus_nominal_2)),1),t("td",null,s(a(e)(o.kerajinan)),1),t("td",null,s(a(e)(o.bonus_trip_jlh)),1),t("td",null,s(a(e)(o.bonus_trip_gaji)),1),t("td",null,s(a(e)(o.bonus_trip_dinas)),1),t("td",null,s(a(e)(o.salary_bonus_bonus_trip)),1),t("td",null,s(a(e)(o.periode_2_ttl)),1),t("td",null,s(a(e)(o.periode_ttl)),1),t("td",null,s(a(e)(o.uj_gaji)),1),t("td",null,s(a(e)(o.uj_makan)),1),t("td",null,s(a(e)(o.uj_dinas)),1),t("td",null,s(a(e)(o.trip_lain)),1),t("td",null,s(a(e)(o.trip_lain_gaji)),1),t("td",null,s(a(e)(o.trip_lain_makan)),1),t("td",null,s(a(e)(o.trip_lain_dinas)),1),t("td",null,s(a(e)(o.trip_tunggu)),1),t("td",null,s(a(e)(o.trip_tunggu_gaji)),1),t("td",null,s(a(e)(o.trip_tunggu_dinas)),1),t("td",null,s(a(e)(o.nominal_cut)),1),t("td",null,s(a(e)(o.total)),1),t("td",null,s(a(e)(o.employee_bpjs_kesehatan)),1),t("td",null,s(a(e)(o.employee_bpjs_jamsos)),1),t("td",null,s(a(e)(o.total_grand)),1)],8,Ca)):w("",!0)],64))),128))],512)])])])):w("",!0)]),t("div",Na,[t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:u[2]||(u[2]=o=>f.fnClose())}," Cancel "),a(q)?w("",!0):(d(),c("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:u[3]||(u[3]=Q(o=>V(),["prevent"]))}," Generate "+s(a(r).id==""?"& Save":""),1))])])])],512)),[[E,f.show]])}}};export{Ja as default};
