import{_ as ie}from"./Header.4c4e13a0.js";import{_ as re}from"./Plus.27bb8732.js";import{_ as ue}from"./Edit.18f13116.js";import{_ as de}from"./Delete.06731f63.js";import{_ as ce}from"./Search.e365ca20.js";import{_ as _e}from"./PopupMini.vue.c4f8b53f.js";import{_ as fe}from"./HeaderPopup.vue.e5ba255c.js";import{r as _,f as K,g as Y,h as D,v as pe,o as k,c as $,a as e,b as g,k as o,j as z,t as S,m as ve,x as p,y as T,p as G,e as Z,D as me,B as he,H as O,I as ge,i as R,l as U,F as q,n as we,w as ye,E as xe,q as be,d as ke,s as $e}from"./entry.acc468b4.js";import"./useUtils.a9534de6.js";import{u as M}from"./useMyFetch.c756e4b3.js";import{_ as J}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.fc483249.js";const De=u=>(G("data-v-11d3de20"),u=u(),Z(),u),Ce={class:"box-fixed"},Ae={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},Se={class:"w-full flex flex-col items-center grow overflow-auto"},Te={class:"w-full flex flex-row flex-wrap"},Me={class:"w-full flex flex-col flex-wrap p-1"},Be=De(()=>e("label",{for:""},"No Pol",-1)),Ve={class:"text-red-500"},Ie={class:"w-full flex items-center justify-end"},Fe={__name:"vehicle",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},setup(u){const i=u,C={id:-1,no_pol:""},d=_({...C}),f=K("token"),m=_({}),c=async()=>{p().loading_full=!0,m.value={};const n=new FormData;n.append("no_pol",d.value.no_pol);let a="post",l=i.id;l==0||(n.append("id",l),n.append("_method","PUT"));const{data:v,error:x,status:B}=await M("/vehicle",{method:a,headers:{Authorization:`Bearer ${f.value}`,Accept:"application/json"},body:n,retry:0});if(p().loading_full=!1,B.value==="error"){T().trigger(x,m);return}if(d.value.updated_at=v.value.updated_at,i.id<=0)d.value.id=v.value.id,d.value.created_at=v.value.created_at,i.p_data.unshift(d.value);else{let V=i.p_data.map(P=>P.id).indexOf(i.id);V>=-1&&i.p_data.splice(V,1,{...d.value})}i.fnClose()},h=async()=>{p().loading_full=!0;const{data:n,error:a,status:l}=await M("/vehicle",{method:"get",headers:{Authorization:`Bearer ${f.value}`,Accept:"application/json"},params:{id:i.id},retry:0});if(p().loading_full=!1,l.value==="error"){T().trigger(a);return}d.value=n.value.data};return Y(()=>i.show,(n,a)=>{n==!0&&(d.value={...C},m.value={},i.id!=0&&h())},{immediate:!0}),(n,a)=>{const l=fe;return D((k(),$("section",Ce,[e("div",null,[g(l,{title:"Form Vehicle",fn:u.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",Ae,[e("div",Se,[e("div",Te,[e("div",Me,[Be,D(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=v=>o(d).no_pol=v)},null,512),[[z,o(d).no_pol]]),e("p",Ve,S(o(m).no_pol),1)])])]),e("div",Ie,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:a[1]||(a[1]=v=>u.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:a[2]||(a[2]=ve(v=>c(),["prevent"]))}," Save ")])])])],512)),[[pe,u.show]])}}},Pe=J(Fe,[["__scopeId","data-v-11d3de20"]]);const w=u=>(G("data-v-a0ea3639"),u=u(),Z(),u),je={class:"w-full h-full flex flex-col"},He={class:"w-full flex grow flex-col overflow-auto h-0"},Ne={class:"w-full flex"},ze={class:"w-full flex p-1"},Ee={class:"grow"},Le=w(()=>e("div",{class:"font-bold"}," Keyword ",-1)),Oe={class:"pl-1"},Re=w(()=>e("div",{class:"font-bold"}," Sort By ",-1)),Ue=w(()=>e("option",{value:""},null,-1)),qe=w(()=>e("option",{value:"no_pol"},"No Pol",-1)),Ke=[Ue,qe],Ye={class:"pl-1"},Ge=w(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),Ze=w(()=>e("option",{value:"asc"},"Asc",-1)),Je=w(()=>e("option",{value:"desc"},"Desc",-1)),Qe=[Ze,Je],We={class:"flex items-end pl-1"},Xe={class:"w-full flex justify-center items-center grow h-0 p-1"},et={key:0,class:""},tt={class:"tacky"},at=w(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"No."),e("th",null,"No Pol"),e("th",null,"Tanggal Dibuat"),e("th",null,"Tanggal Diubah")])],-1)),lt=["onClick"],ot={class:"bold"},st={class:"grow mb-5"},nt={__name:"index",async setup(u){let i,C;const{$moment:d}=$e(),f={};f._TimeZoneOffset=new Date().getTimezoneOffset();const m=K("token"),{data:c}=([i,C]=me(async()=>xe(async()=>{p().loading_full=!0;const{data:s,error:t,status:y}=await M("/vehicles",{method:"get",headers:{Authorization:`Bearer ${m.value}`,Accept:"application/json"},params:f,retry:0});return p().loading_full=!1,y.value==="error"?(T().trigger(t),[]):s.value.data},"$OEvmawoGm4")),i=await i,C(),i),h=_(""),n=_({field:"",by:"desc"}),a=_(-1),l=_({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),v=()=>{f.like="",h.value!=""&&(f.like=`id:%${h.value}%,no_pol:%${h.value}%`),f.sort="",n.value.field&&(f.sort=n.value.field+":"+n.value.by)},x=_(null),B=async()=>{p().loading_full=!0,l.value.may_get_data=!1,f.page=l.value.page,f.page==1&&(c.value=[]);const{data:s,error:t,status:y}=await M("/vehicles",{method:"get",headers:{Authorization:`Bearer ${m.value}`,Accept:"application/json"},params:f,retry:0});if(p().loading_full=!1,l.value.may_get_data=!0,y.value==="error"){T().trigger(t);return}l.value.page==1?(c.value=s.value.data,x.value&&(x.value.scrollTop=0)):l.value.page>1&&(c.value=[...c.value,...s.value.data]),s.value.data.length==0&&(l.value.is_last_record=!0)},V=async()=>{if(!l.value.may_get_data)return;let s=x.value;if(s.scrollLeft!=l.value.scrollLeft){l.value.scrollLeft=s.scrollLeft;return}l.value.is_last_record||!(Math.round(s.scrollTop)+s.clientHeight>=s.scrollHeight-1)||(l.value.page++,await B())},P=()=>{l.value.page=1,l.value.is_last_record=!1,v(),B()};he();const I=_(!1),j=_(0),Q=()=>{j.value=0,I.value=!0},{display:E}=O();ge(O());const W=()=>{a.value==-1?E({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(j.value=c.value[a.value].id,I.value=!0)},H=_(!1),L=_({}),A=_(!1),b=_(""),X=async()=>{A.value&&(A.value=!1)},ee=()=>{a.value==-1?E({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(b.value="",L.value={id:c.value[a.value].id},A.value=!0)};Y(()=>b.value,s=>{s.trim().length>0?H.value=!0:H.value=!1},{immediate:!1});const te=async()=>{p().loading_full=!0;const s=new FormData;s.append("id",c.value[a.value].id),s.append("deleted_reason",b.value),s.append("_method","DELETE");const{data:t,error:y,status:N}=await M("/vehicle",{method:"post",headers:{Authorization:`Bearer ${m.value}`,Accept:"application/json"},body:s,retry:0});if(p().loading_full=!1,N.value==="error"){T().trigger(y);return}c.value.splice(a.value,1),a.value=-1,A.value=!1};return(s,t)=>{const y=ie,N=re,ae=ue,le=de,oe=ce,se=_e,ne=Pe;return k(),$(q,null,[e("div",je,[g(y,{title:"List Vehicle"}),e("div",He,[e("div",Ne,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[0]||(t[0]=r=>Q())},[g(N)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=r=>W())},[g(ae)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=r=>ee())},[g(le)])]),e("div",ze,[e("div",Ee,[Le,D(e("input",{class:"",type:"text","onUpdate:modelValue":t[3]||(t[3]=r=>R(h)?h.value=r:null),name:"search",placeholder:"Keyword"},null,512),[[z,o(h)]])]),e("div",Oe,[Re,D(e("select",{class:"","onUpdate:modelValue":t[4]||(t[4]=r=>o(n).field=r)},Ke,512),[[U,o(n).field]])]),e("div",Ye,[Ge,D(e("select",{class:"","onUpdate:modelValue":t[5]||(t[5]=r=>o(n).by=r)},Qe,512),[[U,o(n).by]])]),e("div",We,[e("button",{class:"",type:"button",name:"button",onClick:t[6]||(t[6]=r=>P())},[g(oe,{class:"text-2xl"})])])]),e("div",Xe,[o(c).length==0?(k(),$("div",et," Maaf Tidak Ada Record ")):(k(),$("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:x,onScroll:V},[e("table",tt,[at,e("tbody",null,[(k(!0),$(q,null,we(o(c),(r,F)=>(k(),$("tr",{key:F,onClick:it=>a.value=F,class:be(o(a)==F?"active":"")},[e("td",null,S(F+1)+".",1),e("td",ot,S(r.no_pol),1),e("td",null,S(o(d)(r.created_at).format("DD-MM-Y HH:mm:ss")),1),e("td",null,S(o(d)(r.updated_at).format("DD-MM-Y HH:mm:ss")),1)],10,lt))),128))])])],544))])])]),g(se,{type:"delete",show:o(A),data:o(L),fnClose:X,fnConfirm:te,enabledOk:o(H)},{footer:ye(()=>[ke(" Masukkan Alasan Penghapusan: "),e("div",st,[D(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=r=>R(b)?b.value=r:null)},null,512),[[z,o(b)]])])]),_:1},8,["show","data","enabledOk"]),g(ne,{show:o(I),fnClose:()=>{I.value=!1},id:o(j),p_data:o(c)},null,8,["show","fnClose","id","p_data"])],64)}}},yt=J(nt,[["__scopeId","data-v-a0ea3639"]]);export{yt as default};
