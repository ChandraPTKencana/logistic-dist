import{_ as G}from"./HeaderPopup.vue.08dca28b.js";import{_ as H}from"./InputPointFormat.vue.fd2c9e0b.js";import K from"./Tools.c5894873.js";import L from"./Plus.1810cc9e.js";import Q from"./ToolsPopup.38b321e4.js";import{r as m,h as X,K as Y,I as W,o as d,c as p,n as g,v as Z,a as e,b,m as a,q as P,t as k,C as ee,G as y,F as A,D as te,E as D,J as F,s as ae,x as C,y as $,p as se,e as le}from"./entry.0dd19dc7.js";import{u as N}from"./useMyFetch.1fc866cf.js";import{_ as oe}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.daf3647d.js";const c=_=>(se("data-v-fccccbb7"),_=_(),le(),_),ne={class:"box-fixed"},ue={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},ie={class:"w-full flex flex-col items-center justify-center grow overflow-auto"},de={class:"w-full flex flex-row flex-wrap"},re={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ce=c(()=>e("label",{for:""},"To",-1)),pe={class:"text-red-500"},_e={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},fe=c(()=>e("label",{for:""},"Tipe",-1)),me={class:"text-red-500"},ve={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},he=c(()=>e("label",{for:""},"Jenis",-1)),xe=c(()=>e("option",{value:"CPO"},"CPO",-1)),we=c(()=>e("option",{value:"TBS"},"TBS",-1)),ye=[xe,we],ge={class:"text-red-500"},be={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ke=c(()=>e("label",{for:""},"Harga",-1)),je={class:"text-red-500"},qe={class:"w-full flex grow p-1 overflow-auto"},Ce={role:"sticky",ref:"loadRef"},Se={class:"tacky w-full",style:{"white-space":"normal"}},Ie={class:"sticky top-0 !z-[2]"},Pe={key:0,class:"min-w-[50px] !w-[50px] max-w-[50px]"},Ae=c(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),Te=c(()=>e("th",null,"Desc",-1)),Be=c(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Harga @",-1)),Ue=c(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"Qty",-1)),Ve={ref:"to_move"},De=["data-index"],Fe={key:0,class:"tools cell"},$e={class:"w-full h-full flex items-center justify-center"},Ne=["onClick"],Ee={key:1,class:"cell"},Re={class:"w-full h-full flex items-center justify-center"},Me=["disabled","onUpdate:modelValue"],Oe={class:"w-full h-full flex items-center justify-center"},ze={class:"w-full h-full flex items-center justify-center"},Je={key:0},Ge={class:"tools cell"},He={class:"w-full flex items-center justify-end"},Ke={__name:"ujalantemp",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},setup(_){const r=_,T={id:-1,xto:"",tipe:"",jenis:"",harga:0,details:[]},o=m({...T}),B=X("token"),h=m({});m([{xdesc:"Timbangan",qty:1,harga:55e3},{xdesc:"Retribusi TPR",qty:1,harga:23e3},{xdesc:"Parkir & Nginap",qty:1,harga:1e4},{xdesc:"Penitipan Alat (Dongkrak)",qty:1,harga:5e3},{xdesc:"Ikas Danau",qty:1,harga:1e4},{xdesc:"U.Bongkar + Ambil surat",qty:1,harga:35e3},{xdesc:"Perbaikan Jalan Pujut",qty:1,harga:1e4},{xdesc:"Gaji Supir",qty:1,harga:2e5},{xdesc:"Gaji Kernet",qty:1,harga:0},{xdesc:"U.Extrafooding",qty:1,harga:2e4},{xdesc:"Tangki",qty:1,harga:2868e3},{xdesc:"Tamb Muat CPO",qty:1,harga:3e4}]);const n=m([]),U=m({ordinal:0,id:-1,xdesc:"",qty:1,harga:0,p_status:""}),E=async()=>{C().loading_full=!0,h.value={};const s=new FormData;s.append("xto",o.value.xto),s.append("tipe",o.value.tipe),s.append("jenis",o.value.jenis),s.append("harga",o.value.harga),s.append("details",JSON.stringify(n.value));let t="post",x=r.id;x==0||(s.append("id",x),s.append("_method","PUT"));const{data:u,error:S,status:I}=await N("/ujalan",{method:t,headers:{Authorization:`Bearer ${B.value}`,Accept:"application/json"},body:s,retry:0});if(C().loading_full=!1,I.value==="error"){$().trigger(S,h);return}if(r.id<=0)o.value.id=u.value.id,o.value.created_at=u.value.created_at,o.value.updated_at=u.value.updated_at,r.p_data.unshift(o.value);else{o.value.updated_at=u.value.updated_at;let q=r.p_data.map(l=>l.id).indexOf(r.id);q>=-1&&r.p_data.splice(q,1,{...o.value})}r.fnClose()},i=m(-1),j=m(!1),V=m({left:0,top:0}),R=(s,t)=>{i.value=t,j.value=!0,V.value={left:s.clientX,top:s.clientY}},M=()=>{n.value.push({...U.value,p_status:"Add"})},O=()=>{j.value=!1},z=(s="")=>{if(s=="insert")n.value.splice(i.value,0,{...U.value,p_status:"Add"});else if(s=="delete")n.value[i.value].p_status=="Edit"?n.value[i.value].p_status="Remove":n.value.splice(i.value,1);else if(s=="move_top"){let t=n.value[i.value];n.value.splice(i.value,1),n.value.splice(i.value-1,0,{...t})}else if(s=="move_bottom"){let t=n.value[i.value];n.value.splice(i.value,1),n.value.splice(i.value+1,0,{...t})}j.value=!1},f=Y(()=>!1),J=async()=>{C().loading_full=!0;const{data:s,error:t,status:x}=await N("/ujalan_",{method:"get",headers:{Authorization:`Bearer ${B.value}`,Accept:"application/json"},params:{id:r.id},retry:0});if(C().loading_full=!1,x.value==="error"){$().trigger(t);return}o.value=s.value.data,n.value=s.value.data.details.map(u=>(u.p_status="Edit",u.key=u.ordinal,u))};return W(()=>r.show,(s,t)=>{s==!0&&(o.value={...T},n.value=[],r.id!=0&&J())},{immediate:!0}),(s,t)=>{const x=G,u=H,S=K,I=L,q=Q;return d(),p(A,null,[g(e("section",ne,[e("div",null,[b(x,{title:"Form Ujalan",fn:_.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",ue,[e("div",ie,[e("div",de,[e("div",re,[ce,g(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>a(o).xto=l)},null,512),[[P,a(o).xto]]),e("p",pe,k(a(h).xto),1)]),e("div",_e,[fe,g(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=l=>a(o).tipe=l)},null,512),[[P,a(o).tipe]]),e("p",me,k(a(h).tipe),1)]),e("div",ve,[he,g(e("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>a(o).jenis=l)},ye,512),[[ee,a(o).jenis]]),e("p",ge,k(a(h).jenis),1)]),e("div",be,[ke,e("div",null,[b(u,{class:"w-full h-full p-1",type:"text",value:a(o).harga||0,onInput:t[3]||(t[3]=l=>a(o).harga=l)},null,8,["value"])]),e("p",je,k(a(h).harga),1)])]),e("div",qe,[e("div",Ce,[e("table",Se,[e("thead",null,[e("tr",Ie,[a(f)?y("",!0):(d(),p("th",Pe)),Ae,Te,Be,Ue])]),e("tbody",Ve,[(d(!0),p(A,null,te(a(n),(l,w)=>(d(),p(A,{key:w},[l.p_status!="Remove"?(d(),p("tr",{key:0,"data-index":w},[a(f)?y("",!0):(d(),p("td",Fe,[e("div",$e,[e("button",{type:"button",name:"button",onClick:v=>R(v,w)},[b(S)],8,Ne)])])),e("td",null,k(w+1)+".",1),a(f)?y("",!0):(d(),p("td",Ee,[e("div",Re,[g(e("textarea",{disabled:a(f),class:"p-1 w-full","onUpdate:modelValue":v=>l.xdesc=v,cols:"7",rows:"2"},null,8,Me),[[P,l.xdesc]])])])),e("td",{class:D(["cell bold",a(f)?"unselectable":""])},[e("div",Oe,[(d(),F(u,{key:w,class:"w-full h-full p-1",type:"text",value:l.harga||0,onInput:v=>l.harga=v},null,8,["value","onInput"]))])],2),e("td",{class:D(["cell",a(f)?"unselectable":""])},[e("div",ze,[(d(),F(u,{key:w,class:"w-full h-full p-1",type:"text",value:l.qty||0,onInput:v=>l.qty=v},null,8,["value","onInput"]))])],2)],8,De)):y("",!0)],64))),128)),a(f)?y("",!0):(d(),p("tr",Je,[e("td",Ge,[e("button",{type:"button",name:"button",onClick:t[4]||(t[4]=l=>M())},[b(I)])])]))],512)])],512)])]),e("div",He,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:t[5]||(t[5]=l=>_.fnClose())}," Cancel "),a(f)?y("",!0):(d(),p("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:t[6]||(t[6]=ae(l=>E(),["prevent"]))}," Save "))])])])],512),[[Z,_.show]]),b(q,{show:a(j),coor:a(V),fn:O,data:a(n),data_index:a(i),onReplyAct:t[7]||(t[7]=l=>z(l))},null,8,["show","coor","data","data_index"])],64)}}},st=oe(Ke,[["__scopeId","data-v-fccccbb7"]]);export{st as default};
