import{_ as qe}from"./Header.bb3bd2a3.js";import{_ as _e}from"./_plugin-vue_export-helper.c27b6911.js";import{o as u,c as _,a as e,f as pe,r as d,g as $e,h as P,v as ke,b as C,i as Te,j as ne,k as t,l as ce,m as fe,F as Q,n as ue,q as O,t as p,p as je,e as Ce,x as q,y as Z,L as be,G as B,d as re,N as X,D as Ne,B as Ve,H as Se,I as Pe,E as Fe,O as Ue,s as Be}from"./entry.d286bd90.js";import{_ as De}from"./Plus.3587b8bc.js";import{_ as Re}from"./Edit.7a8049f6.js";import{_ as ze}from"./Eyes.e34508ac.js";import{_ as Le}from"./Delete.b7107d5c.js";import{_ as He}from"./Signature.6763cf41.js";import{_ as Ie}from"./Search.9203783b.js";import{_ as Me,a as Ee}from"./Check.2e06b97a.js";import{_ as Oe}from"./PopupMini.vue.1867ad8f.js";import{_ as Ae}from"./HeaderPopup.vue.eeddda30.js";import{_ as Je,a as Ke}from"./ToolsPopup.f34f93c7.js";import{_ as Ye}from"./InputPointFormat.vue.e236d221.js";import{_ as Ge}from"./Times.74536f7d.js";import{u as ve}from"./useUtils.100f5b4a.js";import{u as W}from"./useMyFetch.30bb3c87.js";const Qe={name:"MaterialSymbolsContentCopy"},Xe={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Ze=e("path",{fill:"currentColor",d:"M9 18q-.825 0-1.412-.587T7 16V4q0-.825.588-1.412T9 2h9q.825 0 1.413.588T20 4v12q0 .825-.587 1.413T18 18zm-4 4q-.825 0-1.412-.587T3 20V6h2v14h11v2z"},null,-1),We=[Ze];function et(f,h,N,H,n,m){return u(),_("svg",Xe,We)}const tt=_e(Qe,[["render",et]]);const J=f=>(je("data-v-99d23942"),f=f(),Ce(),f),st={class:"box-fixed"},lt={action:"#",class:"w-full flex p-1"},ot={class:"grow"},at=J(()=>e("div",{class:"font-bold"}," Keyword ",-1)),nt={class:"pl-1"},ct=J(()=>e("div",{class:"font-bold"}," Sort By ",-1)),ut=J(()=>e("option",{value:"AccountID"},"ID",-1)),it=J(()=>e("option",{value:"AccountCode"},"Code",-1)),dt=J(()=>e("option",{value:"AccountName"},"Nama",-1)),rt=[ut,it,dt],_t={class:"pl-1"},pt=J(()=>e("div",{class:"font-bold"}," Sort Order ",-1)),ft=J(()=>e("option",{value:"asc"},"Asc",-1)),vt=J(()=>e("option",{value:"desc"},"Desc",-1)),mt=[ft,vt],ht={class:"flex items-end pl-1"},wt={class:"w-full flex justify-center items-center grow h-0 p-1"},xt={key:0,class:""},yt={class:"tacky w-full"},gt=J(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No."),e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"ID"),e("th",null,"Code"),e("th",null,"Name")])],-1)),bt=["onClick"],$t={class:"bold"},kt={class:"whitespace-normal break-words"},jt={class:"flex",style:{"justify-content":"end",padding:"5px"}},Ct={__name:"ac_accs",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1}},setup(f){const h=f,{countClickListFn:N}=ve(),H=pe("token"),n=d([]),m=d(""),j=d({field:"AccountID",by:"desc"}),R=d(-1),l=d({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),a={};a._TimeZoneOffset=new Date().getTimezoneOffset();const $=()=>{a.like="",m.value!=""&&(a.like=`AccountID:%${m.value}%,AccountCode:%${m.value}%,AccountName:%${m.value}%`),a.sort="",j.value.field&&(a.sort=j.value.field+":"+j.value.by)},r=d(null),y=async()=>{q().loading_full=!0,l.value.may_get_data=!1,a.page=l.value.page,a.page==1&&(n.value=[]),a.first_row&&delete a.first_row,a.page>1&&(a.first_row=JSON.stringify(n.value[0]));const{data:b,error:v,status:g}=await W("/ujalan/ac_accounts",{method:"get",headers:{Authorization:`Bearer ${H.value}`,Accept:"application/json"},params:a,retry:0});if(q().loading_full=!1,l.value.may_get_data=!0,g.value==="error"){Z().trigger(v);return}l.value.page==1?(n.value=b.value.data,r.value&&(r.value.scrollTop=0)):l.value.page>1&&(n.value=[...n.value,...b.value.data]),b.value.data.length==0&&(l.value.is_last_record=!0)},S=async()=>{if(!l.value.may_get_data)return;let b=r.value;if(b.scrollLeft!=l.value.scrollLeft){l.value.scrollLeft=b.scrollLeft;return}l.value.is_last_record||!(Math.round(b.scrollTop)+b.clientHeight>=b.scrollHeight-1)||(l.value.page++,await y())},V=()=>{l.value.page=1,l.value.is_last_record=!1,$(),y()},M=()=>{R.value>-1?h.fnSelect(n.value[R.value]):h.fnSelect({ac_account_id:"",ac_account_code:"",ac_account_name:""})},K=b=>{N(b,()=>{R.value=b},M)},Y=d(null);let z=null;const E=b=>{z&&clearTimeout(z),z=setTimeout(()=>{V()},500)};return $e(()=>h.show,(b,v)=>{b==!0&&(V(),setTimeout(()=>{Y.value.focus()},100))},{immediate:!0}),(b,v)=>{const g=Ae,G=Ie;return P((u(),_("section",st,[e("div",null,[C(g,{title:"Search And Select Ac Account",fn:f.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",lt,[e("div",ot,[at,P(e("input",{ref_key:"ref_keyword",ref:Y,class:"",type:"text","onUpdate:modelValue":v[0]||(v[0]=D=>Te(m)?m.value=D:null),name:"search",placeholder:"Keyword",onKeyup:v[1]||(v[1]=D=>E())},null,544),[[ne,t(m)]])]),e("div",nt,[ct,P(e("select",{class:"","onUpdate:modelValue":v[2]||(v[2]=D=>t(j).field=D)},rt,512),[[ce,t(j).field]])]),e("div",_t,[pt,P(e("select",{class:"","onUpdate:modelValue":v[3]||(v[3]=D=>t(j).by=D)},mt,512),[[ce,t(j).by]])]),e("div",ht,[e("button",{class:"",type:"submit",name:"button",onClick:v[4]||(v[4]=fe(D=>V(),["prevent"]))},[C(G,{class:"text-2xl"})])])]),e("div",wt,[t(n).length==0?(u(),_("div",xt," Maaf Tidak Ada Record ")):(u(),_("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:r,onScroll:S},[e("table",yt,[gt,e("tbody",null,[(u(!0),_(Q,null,ue(t(n),(D,F)=>(u(),_("tr",{key:F,onClick:se=>K(F),class:O(t(R)==F?"active":"")},[e("td",null,p(F+1)+".",1),e("td",$t,p(D.ac_account_id),1),e("td",null,p(D.ac_account_code),1),e("td",kt,p(D.ac_account_name),1)],10,bt))),128))])])],544))]),e("div",jt,[e("button",{onClick:v[5]||(v[5]=D=>M()),class:"w-36 m-1 bg-blue-600 text-white rounded-sm"}," Select ")])])],512)),[[ke,f.show]])}}},At=_e(Ct,[["__scopeId","data-v-99d23942"]]);const k=f=>(je("data-v-62b607a5"),f=f(),Ce(),f),St={class:"box-fixed"},Tt={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},Dt={class:"w-full flex flex-col items-center justify-center grow overflow-auto"},It={class:"w-full flex flex-row flex-wrap"},qt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Nt=k(()=>e("label",{for:""},"To",-1)),Vt={class:"text-red-500"},Pt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ft=k(()=>e("label",{for:""},"Tipe",-1)),Ut={class:"text-red-500"},Bt={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Rt=k(()=>e("label",{for:""},"Jenis",-1)),zt=k(()=>e("option",{value:"PK"},"PK",-1)),Lt=k(()=>e("option",{value:"CPO"},"CPO",-1)),Ht=k(()=>e("option",{value:"TBS"},"TBS",-1)),Mt=[zt,Lt,Ht],Et={class:"text-red-500"},Ot={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Jt=k(()=>e("label",{for:""},"Harga",-1)),Kt={class:"card-border disabled"},Yt={class:"text-red-500"},Gt={class:"w-full flex grow p-1 overflow-auto 2xl:overflow-hidden justify-between flex-wrap"},Qt={class:"p-0 2xl:pr-1 2xl:w-1/2 2xl:h-full 2xl:overflow-auto"},Xt={class:"w-full",role:"sticky"},Zt={class:"tacky w-full",style:{"white-space":"normal"}},Wt=k(()=>e("tr",{class:"sticky -top-1 !z-[2]"},[e("td",{colspan:"6",class:"!bg-slate-800 text-white font-bold"}," Detail Uang Jalan ")],-1)),es={class:"sticky top-7 !z-[2]"},ts={key:0,class:"min-w-[50px] !w-[50px] max-w-[50px]"},ss=k(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),ls=k(()=>e("th",null,"Desc",-1)),os=k(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Harga @",-1)),as=k(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"Qty",-1)),ns={class:"min-w-[100px] !w-[100px] max-w-[100px]"},cs=k(()=>e("br",null,null,-1)),us={class:"text-sm"},is={ref:"to_move"},ds=["data-index"],rs={key:0,class:"tools cell"},_s={class:"w-full h-full flex items-center justify-center"},ps=["onClick"],fs={key:1,class:"cell"},vs={class:"w-full h-full flex items-center justify-center"},ms=["disabled","onUpdate:modelValue"],hs={class:"w-full h-full flex items-center justify-center"},ws={class:"w-full h-full flex items-center justify-center"},xs={class:"cell"},ys={class:"w-full h-full flex items-center justify-center"},gs={key:0},bs={class:"tools cell"},$s={class:"px-0 py-2 2xl:pl-1 2xl:py-0 2xl:w-1/2 2xl:h-full 2xl:overflow-auto"},ks={class:"w-full",role:"sticky"},js={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},Cs=k(()=>e("tr",{class:"sticky -top-1 !z-[2]"},[e("td",{colspan:"10",class:"!bg-slate-800 text-white font-bold"}," Detail PVR ")],-1)),As={class:"sticky top-7 !z-[2]"},Ss={key:0,class:"min-w-[30px] !w-[30px] max-w-[30px]"},Ts=k(()=>e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No",-1)),Ds={key:1,class:"min-w-[30px] !w-[30px] max-w-[30px]"},Is=k(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Acc ID",-1)),qs=k(()=>e("th",{class:"!min-w-[100px] !w-[100px] !max-w-[100px]"},"Acc Code",-1)),Ns=k(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Acc Name",-1)),Vs=k(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Desc",-1)),Ps=k(()=>e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Amount",-1)),Fs=k(()=>e("th",{class:"min-w-[40px] !w-[40px] max-w-[40px]"},"Qty",-1)),Us={class:"min-w-[100px] !w-[100px] max-w-[100px]"},Bs=k(()=>e("br",null,null,-1)),Rs={class:"text-sm"},zs={ref:"to_move"},Ls=["data-index"],Hs={key:0,class:"tools cell"},Ms={class:"w-full h-full flex items-center justify-center"},Es=["onClick"],Os={key:1,class:"cell"},Js={class:"w-full h-full flex items-center justify-center"},Ks=["onClick"],Ys=["onClick","disabled"],Gs={class:"w-full h-full flex items-center justify-center"},Qs={class:"w-full h-full flex items-center justify-center"},Xs={class:"w-full h-full flex items-center justify-center"},Zs={key:2,class:"cell"},Ws={class:"w-full h-full flex items-center justify-center"},el=["disabled","onUpdate:modelValue"],tl={class:"w-full h-full flex items-center justify-center"},sl={class:"w-full h-full flex items-center justify-center"},ll={class:"cell"},ol={class:"w-full h-full flex items-center justify-center"},al={key:0},nl={class:"tools cell"},cl={class:"w-full flex items-center justify-end"},ul={__name:"ujalan",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(f){const h=f,{pointFormat:N}=ve(),H={id:-1,xto:"",tipe:"",jenis:"",harga:0,details:[],details2:[]},n=d({...H}),m=pe("token"),j=d({}),R=d([{xdesc:"Timbangan",qty:1,harga:55e3},{xdesc:"Retribusi TPR",qty:1,harga:23e3},{xdesc:"Parkir & Nginap",qty:1,harga:1e4},{xdesc:"Penitipan Alat (Dongkrak)",qty:1,harga:5e3},{xdesc:"Ikas Danau",qty:1,harga:1e4},{xdesc:"U.Bongkar + Ambil surat",qty:1,harga:35e3},{xdesc:"Perbaikan Jalan Pujut",qty:1,harga:1e4},{xdesc:"Gaji Supir",qty:1,harga:0},{xdesc:"Gaji Kernet",qty:1,harga:0},{xdesc:"U.Extrafooding",qty:1,harga:2e4}]);d([]);const l=d([]),a=d([]),$=d({ordinal:0,id:-1,xdesc:"",qty:1,harga:0,p_status:""}),r=d({ordinal:0,id:-1,ac_account_id:"",ac_account_name:"",ac_account_code:"",description:"",qty:1,amount:0,p_status:""}),y=()=>{R.value.forEach(o=>{l.value.filter(s=>s.xdesc==o.xdesc).length==0&&l.value.push({...o,ordinal:0,id:-1,p_status:"Add"})})},S=d(!1),V=()=>{S.value=!1},M=o=>{a.value[g.value].ac_account_id=o.ac_account_id,a.value[g.value].ac_account_code=o.ac_account_code,a.value[g.value].ac_account_name=o.ac_account_name,S.value=!1},K=(o,s)=>{g.value=s,S.value=!0},Y=(o,s)=>{a.value[s].ac_account_id="",a.value[s].ac_account_code="",a.value[s].ac_account_name=""},z=async()=>{q().loading_full=!0,j.value={};const o=new FormData;o.append("xto",n.value.xto),o.append("tipe",n.value.tipe),o.append("jenis",n.value.jenis),o.append("harga",n.value.harga),o.append("details",JSON.stringify(l.value)),o.append("details2",JSON.stringify(a.value));let s="post",L=h.is_copy?0:h.id;L==0||(o.append("id",L),o.append("_method","PUT"));const{data:U,error:T,status:le}=await W("/ujalan",{method:s,headers:{Authorization:`Bearer ${m.value}`,Accept:"application/json"},body:o,retry:0});if(q().loading_full=!1,le.value==="error"){Z().trigger(T,j);return}if(L<=0)n.value.id=U.value.id,n.value.created_at=U.value.created_at,n.value.updated_at=U.value.updated_at,h.p_data.unshift(n.value);else{n.value.updated_at=U.value.updated_at;let oe=h.p_data.map(ae=>ae.id).indexOf(L);oe>=-1&&h.p_data.splice(oe,1,{...n.value})}h.fnClose()},E=be(()=>{let o=0;return l.value.forEach(s=>{s.p_status!="Remove"&&(o+=s.qty*s.harga)}),n.value.harga=o,o}),b=be(()=>{let o=0;return a.value.forEach(s=>{s.p_status!="Remove"&&(o+=s.qty*s.amount)}),o}),v=d(-1),g=d(-1),G=d(!1),D=d({left:0,top:0}),F=d(!1),se=d({left:0,top:0}),me=(o,s)=>{v.value=s,G.value=!0,D.value={left:o.clientX,top:o.clientY}},de=(o,s)=>{g.value=s,F.value=!0,se.value={left:o.clientX,top:o.clientY}},ee=()=>{l.value.push({...$.value,p_status:"Add"})},he=()=>{a.value.push({...r.value,p_status:"Add"})},we=()=>{G.value=!1},xe=()=>{F.value=!1},A=(o="")=>{if(o=="insert")l.value.splice(v.value,0,{...$.value,p_status:"Add"});else if(o=="delete")l.value[v.value].p_status=="Edit"?l.value[v.value].p_status="Remove":l.value.splice(v.value,1);else if(o=="move_top"){let s=l.value[v.value];l.value.splice(v.value,1),l.value.splice(v.value-1,0,{...s})}else if(o=="move_bottom"){let s=l.value[v.value];l.value.splice(v.value,1),l.value.splice(v.value+1,0,{...s})}G.value=!1},x=(o="")=>{if(o=="insert")a.value.splice(g.value,0,{...r.value,p_status:"Add"});else if(o=="delete")a.value[g.value].p_status=="Edit"?a.value[g.value].p_status="Remove":a.value.splice(g.value,1);else if(o=="move_top"){let s=a.value[g.value];a.value.splice(g.value,1),a.value.splice(g.value-1,0,{...s})}else if(o=="move_bottom"){let s=a.value[g.value];a.value.splice(g.value,1),a.value.splice(g.value+1,0,{...s})}F.value=!1},w=be(()=>!1),te=async()=>{q().loading_full=!0;const{data:o,error:s,status:L}=await W("/ujalan_",{method:"get",headers:{Authorization:`Bearer ${m.value}`,Accept:"application/json"},params:{id:h.id},retry:0});if(q().loading_full=!1,L.value==="error"){Z().trigger(s);return}n.value=o.value.data;let U="Edit";h.is_copy&&(U="Add"),l.value=o.value.data.details.map(T=>(T.p_status=U,T.key=T.ordinal,T)),a.value=o.value.data.details2.map(T=>(T.p_status=U,T.key=T.ordinal,T))};return $e(()=>h.show,(o,s)=>{o==!0&&(n.value={...H},l.value=[],a.value=[],h.id!=0&&te())},{immediate:!0}),(o,s)=>{const L=Ae,U=Je,T=Ye,le=De,oe=Ge,ae=Ke,ye=At;return u(),_(Q,null,[P(e("section",St,[e("div",null,[C(L,{title:"Form Ujalan",fn:f.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",Tt,[e("div",Dt,[e("div",It,[e("div",qt,[Nt,P(e("input",{"onUpdate:modelValue":s[0]||(s[0]=i=>t(n).xto=i)},null,512),[[ne,t(n).xto]]),e("p",Vt,p(t(j).xto),1)]),e("div",Pt,[Ft,P(e("textarea",{"onUpdate:modelValue":s[1]||(s[1]=i=>t(n).tipe=i)},null,512),[[ne,t(n).tipe]]),e("p",Ut,p(t(j).tipe),1)]),e("div",Bt,[Rt,P(e("select",{"onUpdate:modelValue":s[2]||(s[2]=i=>t(n).jenis=i)},Mt,512),[[ce,t(n).jenis]]),e("p",Et,p(t(j).jenis),1)]),e("div",Ot,[Jt,e("div",Kt,p(t(N)(t(E))),1),e("p",Yt,p(t(j).harga),1)])]),e("div",Gt,[e("div",Qt,[e("div",Xt,[e("table",Zt,[e("thead",null,[Wt,e("tr",es,[t(w)?B("",!0):(u(),_("th",ts,[e("button",{type:"button",name:"button",class:"bg-yellow-600",onClick:s[3]||(s[3]=i=>y())}," Default In ")])),ss,ls,os,as,e("th",ns,[re("Total "),cs,re(),e("span",us,"("+p(t(N)(t(E)))+")",1)])])]),e("tbody",is,[(u(!0),_(Q,null,ue(t(l),(i,I)=>(u(),_(Q,{key:I},[i.p_status!="Remove"?(u(),_("tr",{key:0,"data-index":I},[t(w)?B("",!0):(u(),_("td",rs,[e("div",_s,[e("button",{type:"button",name:"button",onClick:c=>me(c,I)},[C(U)],8,ps)])])),e("td",null,p(I+1)+".",1),t(w)?B("",!0):(u(),_("td",fs,[e("div",vs,[P(e("textarea",{disabled:t(w),class:"p-1 w-full","onUpdate:modelValue":c=>i.xdesc=c,cols:"7",rows:"2"},null,8,ms),[[ne,i.xdesc]])])])),e("td",{class:O(["cell bold",t(w)?"unselectable":""])},[e("div",hs,[(u(),X(T,{key:I,class:"w-full h-full p-1",type:"text",value:i.harga||0,onInput:c=>i.harga=c,show:f.show},null,8,["value","onInput","show"]))])],2),e("td",{class:O(["cell",t(w)?"unselectable":""])},[e("div",ws,[(u(),X(T,{key:I,class:"w-full h-full p-1",type:"text",value:i.qty||0,onInput:c=>i.qty=c,show:f.show},null,8,["value","onInput","show"]))])],2),e("td",xs,[e("div",ys,p(t(N)(i.qty*i.harga||0)),1)])],8,ds)):B("",!0)],64))),128)),t(w)?B("",!0):(u(),_("tr",gs,[e("td",bs,[e("button",{type:"button",name:"button",onClick:s[4]||(s[4]=i=>ee())},[C(le)])])]))],512)])])]),e("div",$s,[e("div",ks,[e("table",js,[e("thead",null,[Cs,e("tr",As,[t(w)?B("",!0):(u(),_("th",Ss)),Ts,t(w)?B("",!0):(u(),_("th",Ds)),Is,qs,Ns,Vs,Ps,Fs,e("th",Us,[re("Total "),Bs,re(),e("span",Rs,"("+p(t(N)(t(b)))+")",1)])])]),e("tbody",zs,[(u(!0),_(Q,null,ue(t(a),(i,I)=>(u(),_(Q,{key:I},[i.p_status!="Remove"?(u(),_("tr",{key:0,"data-index":I},[t(w)?B("",!0):(u(),_("td",Hs,[e("div",Ms,[e("button",{type:"button",name:"button",onClick:c=>de(c,I)},[C(U)],8,Es)])])),e("td",null,p(I+1)+".",1),t(w)?B("",!0):(u(),_("td",Os,[e("div",Js,[i.ac_account_id?(u(),_("button",{key:1,type:"button",onClick:c=>Y(c,I),disabled:i.confirm_by},[C(oe,{class:"font-bold text-2xl"})],8,Ys)):(u(),_("button",{key:0,type:"button",name:"button",onClick:c=>K(c,I)}," ... ",8,Ks))])])),e("td",{class:O(["cell bold",t(w)?"unselectable":""])},[e("div",Gs,p(i.ac_account_id),1)],2),e("td",{class:O(["cell bold",t(w)?"unselectable":""])},[e("div",Qs,p(i.ac_account_code),1)],2),e("td",{class:O(["cell bold",t(w)?"unselectable":""])},[e("div",Xs,p(i.ac_account_name),1)],2),t(w)?B("",!0):(u(),_("td",Zs,[e("div",Ws,[P(e("textarea",{disabled:t(w),class:"p-1 w-full","onUpdate:modelValue":c=>i.description=c,cols:"7",rows:"2"},null,8,el),[[ne,i.description]])])])),e("td",{class:O(["cell bold",t(w)?"unselectable":""])},[e("div",tl,[(u(),X(T,{key:I,class:"w-full h-full p-1",type:"text",value:i.amount||0,onInput:c=>i.amount=c,show:f.show},null,8,["value","onInput","show"]))])],2),e("td",{class:O(["cell",t(w)?"unselectable":""])},[e("div",sl,[(u(),X(T,{key:I,class:"w-full h-full p-1",type:"text",value:i.qty||0,onInput:c=>i.qty=c,show:f.show},null,8,["value","onInput","show"]))])],2),e("td",ll,[e("div",ol,p(t(N)(i.qty*i.amount||0)),1)])],8,Ls)):B("",!0)],64))),128)),t(w)?B("",!0):(u(),_("tr",al,[e("td",nl,[e("button",{type:"button",name:"button",onClick:s[5]||(s[5]=i=>he())},[C(le)])])]))],512)])])])])]),e("div",cl,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:s[6]||(s[6]=i=>f.fnClose())}," Cancel "),t(w)?B("",!0):(u(),_("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:s[7]||(s[7]=fe(i=>z(),["prevent"]))}," Save "))])])])],512),[[ke,f.show]]),C(ae,{show:t(G),coor:t(D),fn:we,data:t(l),data_index:t(v),onReplyAct:s[8]||(s[8]=i=>A(i))},null,8,["show","coor","data","data_index"]),C(ae,{show:t(F),coor:t(se),fn:xe,data:t(a),data_index:t(g),onReplyAct:s[9]||(s[9]=i=>x(i))},null,8,["show","coor","data","data_index"]),C(ye,{show:t(S),fnClose:V,fnSelect:M},null,8,["show"])],64)}}},il=_e(ul,[["__scopeId","data-v-62b607a5"]]);const ie=f=>(je("data-v-52c5f602"),f=f(),Ce(),f),dl={class:"box-fixed"},rl={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},_l={class:"w-full flex flex-col items-center justify-center grow overflow-auto"},pl={class:"w-full flex flex-row flex-wrap"},fl={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},vl=ie(()=>e("label",{for:""},"To",-1)),ml={class:"card-border"},hl={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},wl=ie(()=>e("label",{for:""},"Tipe",-1)),xl={class:"card-border"},yl={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},gl=ie(()=>e("label",{for:""},"Jenis",-1)),bl={class:"card-border"},$l={class:"w-full sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},kl=ie(()=>e("label",{for:""},"Harga",-1)),jl={class:"card-border"},Cl={class:"w-full flex grow p-1 overflow-auto"},Al={role:"sticky",ref:"loadRef"},Sl={class:"tacky w-full",style:{"white-space":"normal"}},Tl=ie(()=>e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"No"),e("th",null,"Desc"),e("th",{class:"min-w-[100px] !w-[100px] max-w-[100px]"},"Harga @"),e("th",{class:"min-w-[50px] !w-[50px] max-w-[50px]"},"Qty")])],-1)),Dl={ref:"to_move"},Il={class:"cell"},ql={class:"w-full h-full flex items-center justify-center"},Nl={class:"cell bold"},Vl={class:"w-full h-full flex items-center justify-center"},Pl={class:"cell"},Fl={class:"w-full h-full flex items-center justify-center"},Ul={class:"w-full flex items-center justify-end"},Bl={__name:"ujalan_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]}},setup(f){const h=f,{pointFormat:N}=ve(),n=d({...{id:-1,xto:"",tipe:"",jenis:"",harga:0,details:[]}}),m=pe("token"),j=d({}),R=d([]);d({ordinal:0,id:-1,xdesc:"",qty:1,harga:0,p_status:""});const l=async()=>{q().loading_full=!0,j.value={};const $=new FormData;let r="post",y=h.id;y==0||($.append("id",y),$.append("_method","PUT"));const{data:S,error:V,status:M}=await W("/ujalan_validasi",{method:r,headers:{Authorization:`Bearer ${m.value}`,Accept:"application/json"},body:$,retry:0});if(q().loading_full=!1,M.value==="error"){Z().trigger(V,j);return}n.value.val=S.value.val,n.value.val_user=S.value.val_user,n.value.val_by=S.value.val_by,n.value.val_at=S.value.val_at;let K=h.p_data.map(Y=>Y.id).indexOf(h.id);K>=-1&&h.p_data.splice(K,1,{...n.value}),h.fnClose()},a=async()=>{q().loading_full=!0;const{data:$,error:r,status:y}=await W("/ujalan_",{method:"get",headers:{Authorization:`Bearer ${m.value}`,Accept:"application/json"},params:{id:h.id},retry:0});if(q().loading_full=!1,y.value==="error"){Z().trigger(r);return}n.value=$.value.data,R.value=$.value.data.details};return $e(()=>h.show,($,r)=>{$==!0&&a()},{immediate:!0}),($,r)=>{const y=Ae;return P((u(),_("section",dl,[e("div",null,[C(y,{title:"Form Ujalan Validation",fn:f.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",rl,[e("div",_l,[e("div",pl,[e("div",fl,[vl,e("div",ml,p(t(n).xto),1)]),e("div",hl,[wl,e("div",xl,p(t(n).tipe),1)]),e("div",yl,[gl,e("div",bl,p(t(n).jenis),1)]),e("div",$l,[kl,e("div",jl,p(t(N)(t(n).harga||0)),1)])]),e("div",Cl,[e("div",Al,[e("table",Sl,[Tl,e("tbody",Dl,[(u(!0),_(Q,null,ue(t(R),(S,V)=>(u(),_("tr",{key:V},[e("td",null,p(V+1)+".",1),e("td",Il,[e("div",ql,p(S.xdesc),1)]),e("td",Nl,[e("div",Vl,p(t(N)(S.harga||0)),1)]),e("td",Pl,[e("div",Fl,p(t(N)(S.qty||0)),1)])]))),128))],512)])],512)])]),e("div",Ul,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:r[0]||(r[0]=S=>f.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:r[1]||(r[1]=fe(S=>l(),["prevent"]))}," Validasi ")])])])],512)),[[ke,f.show]])}}},Rl=_e(Bl,[["__scopeId","data-v-52c5f602"]]),zl={class:"w-full h-full flex flex-col"},Ll={class:"w-full flex grow flex-col overflow-auto h-0"},Hl={class:"w-full flex"},Ml={action:"#",class:"w-full flex p-1"},El={class:"grow"},Ol=e("div",{class:"font-bold"}," Keyword ",-1),Jl={class:"pl-1"},Kl=e("div",{class:"font-bold"}," Sort By ",-1),Yl=Ue('<option value=""></option><option value="id">ID</option><option value="xto">To</option><option value="jenis">Jenis</option><option value="tipe">Tipe</option>',5),Gl=[Yl],Ql={class:"pl-1"},Xl=e("div",{class:"font-bold"}," Sort Order ",-1),Zl=e("option",{value:"asc"},"Asc",-1),Wl=e("option",{value:"desc"},"Desc",-1),eo=[Zl,Wl],to={class:"flex items-end pl-1"},so={class:"w-full flex justify-center items-center grow h-0 p-1"},lo={key:0,class:""},oo={class:"tacky"},ao=e("thead",null,[e("tr",{class:"sticky top-0 !z-[2]"},[e("th",null,"App 1"),e("th",null,"ID"),e("th",null,"To"),e("th",null,"Tipe"),e("th",null,"Jenis"),e("th",null,"Harga"),e("th",null,"Created At"),e("th",null,"Updated At")])],-1),no=["onClick"],co={class:"flex items-center justify-center"},uo={class:"bold"},So={__name:"index",async setup(f){let h,N;const{$moment:H}=Be(),{pointFormat:n}=ve(),m={};m._TimeZoneOffset=new Date().getTimezoneOffset(),m.sort="created_at:desc";const j=pe("token"),{data:R}=([h,N]=Ne(async()=>Fe(async()=>{let A=[];q().loading_full=!0;const{data:x,error:w,status:te}=await W("/ujalan",{method:"get",headers:{Authorization:`Bearer ${j.value}`,Accept:"application/json"},params:m,retry:0});return q().loading_full=!1,te.value==="error"?(Z().trigger(w),{ujalans:A}):(A=x.value.data,{ujalans:A})},"$SN3C927rLk")),h=await h,N(),h),l=d(R.value.ujalans),a=d(""),$=d({field:"created_at",by:"desc"}),r=d(-1),y=d({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),S=()=>{m.like="",a.value!=""&&(m.like=`id:%${a.value}%,xto:%${a.value}%,tipe:%${a.value}%,jenis:%${a.value}%,harga:%${a.value}%`),m.sort="",$.value.field&&(m.sort=$.value.field+":"+$.value.by)},V=d(null),M=async()=>{q().loading_full=!0,y.value.may_get_data=!1,m.page=y.value.page,m.page==1&&(l.value=[]),m.first_row&&delete m.first_row,m.page>1&&(m.first_row=JSON.stringify(l.value[0]));const{data:A,error:x,status:w}=await W("/ujalan",{method:"get",headers:{Authorization:`Bearer ${j.value}`,Accept:"application/json"},params:m,retry:0});if(q().loading_full=!1,y.value.may_get_data=!0,w.value==="error"){Z().trigger(x);return}y.value.page==1?(l.value=A.value.data,V.value&&(V.value.scrollTop=0)):y.value.page>1&&(l.value=[...l.value,...A.value.data]),A.value.data.length==0&&(y.value.is_last_record=!0)},K=async()=>{if(!y.value.may_get_data)return;let A=V.value;if(A.scrollLeft!=y.value.scrollLeft){y.value.scrollLeft=A.scrollLeft;return}y.value.is_last_record||!(Math.round(A.scrollTop)+A.clientHeight>=A.scrollHeight-1)||(y.value.page++,await M())},Y=()=>{y.value.page=1,y.value.is_last_record=!1,S(),M()};Ve();const z=d(!1),E=d(0),b=d(0),v=()=>{E.value=0,z.value=!0,b.value=!1},{display:g}=Se();Pe(Se());const G=()=>{r.value==-1?g({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(E.value=l.value[r.value].id,z.value=!0,b.value=!1)},D=()=>{r.value==-1?g({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(E.value=l.value[r.value].id,z.value=!0,b.value=!0)},F=d(!1),se=d(0),me=()=>{r.value==-1?g({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(se.value=l.value[r.value].id,F.value=!0)},de=d({}),ee=d(!1),he=async()=>{ee.value&&(ee.value=!1)},we=()=>{r.value==-1?g({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(de.value={id:l.value[r.value].id},ee.value=!0)},xe=async()=>{q().loading_full=!0;const A=new FormData;A.append("id",l.value[r.value].id),A.append("_method","DELETE");const{data:x,error:w,status:te}=await W("/ujalan",{method:"post",headers:{Authorization:`Bearer ${j.value}`,Accept:"application/json"},body:A,retry:0});if(q().loading_full=!1,te.value==="error"){Z().trigger(w);return}l.value.splice(r.value,1),r.value=-1,ee.value=!1};return(A,x)=>{const w=qe,te=tt,o=De,s=Re,L=ze,U=Le,T=He,le=Ie,oe=Me,ae=Ee,ye=Oe,i=il,I=Rl;return u(),_("div",zl,[C(w,{title:"List Ujalan"}),e("div",Ll,[e("div",Hl,[e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:x[0]||(x[0]=c=>D())},[C(te)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:x[1]||(x[1]=c=>v())},[C(o)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:x[2]||(x[2]=c=>G())},[t(r)==-1||t(l)[t(r)].ref_id==null&&t(l)[t(r)].confirmed_by==null?(u(),X(s,{key:0})):(u(),X(L,{key:1}))]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:x[3]||(x[3]=c=>we())},[C(U)]),e("button",{type:"button",name:"button",class:"m-1 text-2xl",onClick:x[4]||(x[4]=c=>me())},[C(T)])]),e("form",Ml,[e("div",El,[Ol,P(e("input",{class:"",type:"text","onUpdate:modelValue":x[5]||(x[5]=c=>Te(a)?a.value=c:null),name:"search",placeholder:"Keyword"},null,512),[[ne,t(a)]])]),e("div",Jl,[Kl,P(e("select",{class:"","onUpdate:modelValue":x[6]||(x[6]=c=>t($).field=c)},Gl,512),[[ce,t($).field]])]),e("div",Ql,[Xl,P(e("select",{class:"","onUpdate:modelValue":x[7]||(x[7]=c=>t($).by=c)},eo,512),[[ce,t($).by]])]),e("div",to,[e("button",{class:"",type:"submit",name:"button",onClick:x[8]||(x[8]=fe(c=>Y(),["prevent"]))},[C(le,{class:"text-2xl"})])])]),e("div",so,[t(l).length==0?(u(),_("div",lo," Maaf Tidak Ada Record ")):(u(),_("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:V,onScroll:K},[e("table",oo,[ao,e("tbody",null,[(u(!0),_(Q,null,ue(t(l),(c,ge)=>(u(),_("tr",{key:ge,onClick:io=>r.value=ge,class:O(t(r)==ge?"active":"")},[e("td",null,[e("div",co,[c.val?(u(),X(ae,{key:1})):(u(),X(oe,{key:0}))])]),e("td",uo,p(c.id),1),e("td",null,p(c.xto),1),e("td",null,p(c.tipe),1),e("td",null,p(c.jenis),1),e("td",null,p(t(n)(c.harga)),1),e("td",null,p(c.created_at?t(H)(c.created_at).format("DD-MM-Y HH:mm:ss"):""),1),e("td",null,p(c.updated_at?t(H)(c.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,no))),128))])])],544))])]),C(ye,{type:"delete",show:t(ee),data:t(de),fnClose:he,fnConfirm:xe},null,8,["show","data"]),C(i,{show:t(z),fnClose:()=>{z.value=!1},id:t(E),p_data:t(l),is_copy:t(b)},null,8,["show","fnClose","id","p_data","is_copy"]),C(I,{show:t(F),fnClose:()=>{F.value=!1},id:t(se),p_data:t(l)},null,8,["show","fnClose","id","p_data"])])}}};export{So as default};
