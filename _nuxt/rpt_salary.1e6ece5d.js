import{_ as I}from"./HeaderPopup.vue.f45ac7d2.js";import{_ as O}from"./client-only.4c937713.js";import{r as N,f as R,G as i,j as H,I as Q,m as W,J as X,o as p,c as d,a as t,b as P,k as e,t as o,w as Z,d as u,F as $,y as tt,l as A,x as et,E as st,A as F,B as G}from"./entry.56f613b3.js";import{u as T}from"./useUtils.e3bba0b1.js";import{u as z}from"./useMyFetch.76faeae6.js";import"./Times.4fc43f42.js";import"./_plugin-vue_export-helper.c27b6911.js";const at={class:"box-fixed"},ot={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},nt={class:"w-full flex flex-col items-center grow overflow-auto"},lt={class:"w-full flex flex-row flex-wrap"},rt={class:"w-1/2 sm:w-4/12 md:w-3/12 lg:w-3/12 flex flex-col flex-wrap p-1"},_t=t("label",{for:""},"Period End",-1),ut={key:0,class:"card-border"},it={key:1},ct={class:"text-red-500"},pt={key:0,class:"w-full flex p-1 justify-between flex-wrap"},dt={class:"w-full",role:"sticky"},mt={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},ht=t("tr",{class:"sticky -top-1 !z-[2]"},[t("td",{colspan:"21",class:"!bg-slate-800 text-white font-bold"}," Detail ")],-1),ft={class:"sticky top-7 !z-[2]"},vt=t("th",{rowspan:"2"},"No",-1),yt=t("th",{rowspan:"2"},"ID",-1),bt=t("th",{rowspan:"2"},"Nama Pekerja",-1),wt=t("th",{rowspan:"2"},"Jabatan",-1),kt=t("th",{rowspan:"2"},"Tmpt Lahir",-1),xt=t("th",{rowspan:"2"},"Tgl Lahir",-1),Ft=t("th",{rowspan:"2"},"TMK",-1),jt=t("th",{rowspan:"2"},"No KTP",-1),gt=t("th",{rowspan:"2"},"Alamat",-1),St=t("th",{rowspan:"2"},"Status",-1),Et=t("th",{rowspan:"2"},"No Rek",-1),Mt=t("th",{rowspan:"2"},"Nama Bank",-1),Bt={colspan:"3"},Dt={class:"text-sm"},Ct={colspan:"3"},Nt={class:"text-sm"},Pt={colspan:"3"},At={class:"text-sm"},Tt={rowspan:"2"},qt={class:"text-sm"},Vt={rowspan:"2"},Ut={class:"text-sm"},$t={rowspan:"2"},Gt={class:"text-sm"},zt=t("th",null,null,-1),Jt={class:"text-sm"},Yt={class:"sticky top-[60px] !z-[2]"},Kt={class:"text-sm"},Lt={class:"text-sm"},It={class:"text-sm"},Ot={class:"text-sm"},Rt={class:"text-sm"},Ht={class:"text-sm"},Qt={class:"text-sm"},Wt={class:"text-sm"},Xt={class:"text-sm"},Zt={ref:"to_move"},te=["data-index"],ee=t("td",null,null,-1),se={class:"w-full flex items-center justify-end"},ie={__name:"rpt_salary",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(v){const m=v,{$moment:y}=st(),{pointFormat:l}=T(),q={id:"",period_end:new Date},r=N({...q}),V=R("token"),b=N({}),_=N([]),J=async()=>{F().loading_full=!0,b.value={};const a=new FormData;a.append("period_end",r.value.period_end?y(r.value.period_end).format("Y-MM"):"");let n="post",c=r.value.id;c==""||(a.append("id",c),a.append("_method","PUT"));const{data:h,error:C,status:s}=await z("/rpt_salary",{method:n,headers:{Authorization:`Bearer ${V.value}`,Accept:"application/json"},body:a,retry:0});if(F().loading_full=!1,s.value==="error"){G().trigger(C,b);return}if(_.value=h.value.details,c<=0)r.value.id=h.value.id,r.value.created_at=h.value.created_at,r.value.updated_at=h.value.updated_at,m.p_data.unshift(r.value);else{r.value.updated_at=h.value.updated_at;let f=m.p_data.map(L=>L.id).indexOf(c);f>=-1&&m.p_data.splice(f,1,{...r.value})}};i(()=>{let a=0;return _.value.forEach(n=>{a+=parseFloat(n.standby_nominal)}),a});const j=i(()=>{let a=0;return _.value.forEach(n=>{a+=parseFloat(n.sb_gaji)}),a}),g=i(()=>{let a=0;return _.value.forEach(n=>{a+=parseFloat(n.sb_makan)}),a}),S=i(()=>{let a=0;return _.value.forEach(n=>{a+=parseFloat(n.sb_dinas)}),a}),w=i(()=>{let a=0;return _.value.forEach(n=>{a+=parseFloat(n.sb_gaji_2)}),a}),k=i(()=>{let a=0;return _.value.forEach(n=>{a+=parseFloat(n.sb_makan_2)}),a}),x=i(()=>{let a=0;return _.value.forEach(n=>{a+=parseFloat(n.sb_dinas_2)}),a}),E=i(()=>{let a=0;return _.value.forEach(n=>{a+=parseFloat(n.uj_gaji)}),a}),M=i(()=>{let a=0;return _.value.forEach(n=>{a+=parseFloat(n.uj_makan)}),a}),B=i(()=>{let a=0;return _.value.forEach(n=>{a+=parseFloat(n.uj_dinas)}),a}),U=i(()=>{let a=0;return _.value.forEach(n=>{a+=parseFloat(n.nominal_cut)}),a}),D=i(()=>{let a=0;return _.value.forEach(n=>{a+=parseFloat(n.salary_bonus_nominal)}),a}),Y=i(()=>r.value.val&&r.value.val1||T().checkPermission("rpt_salary.val")&&r.value.val||T().checkPermission("rpt_salary.val1")&&r.value.val1),K=async()=>{F().loading_full=!0;const{data:a,error:n,status:c}=await z("/rpt_salary",{method:"get",headers:{Authorization:`Bearer ${V.value}`,Accept:"application/json"},params:{id:m.id},retry:0});if(F().loading_full=!1,c.value==="error"){G().trigger(n);return}r.value=a.value.data,m.is_copy&&(r.value.val=0,r.value.val1=0),_.value=a.value.data.details};return H(()=>m.show,(a,n)=>{a==!0&&(r.value={...q},_.value=[],b.value={},m.id!=0&&K())},{immediate:!0}),(a,n)=>{const c=I,h=Q("vue-date-picker"),C=O;return W((p(),d("section",at,[t("div",null,[P(c,{title:"Form Salary Paid",fn:v.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),t("form",ot,[t("div",nt,[t("div",lt,[t("div",rt,[_t,e(r).id?(p(),d("div",ut,o(e(y)(e(r).period_end).format("MM-Y")),1)):(p(),d("div",it,[P(C,null,{default:Z(()=>[P(h,{modelValue:e(r).period_end,"onUpdate:modelValue":n[0]||(n[0]=s=>e(r).period_end=s),format:"MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":"","month-picker":""},null,8,["modelValue"])]),_:1})])),t("p",ct,o(e(b).period_end),1)])]),e(_).length?(p(),d("div",pt,[t("div",dt,[t("table",mt,[t("thead",null,[ht,t("tr",ft,[vt,yt,bt,wt,kt,xt,Ft,jt,gt,St,Et,Mt,t("th",Bt,[u("Standby 1 "),t("span",Dt,"("+o(e(l)(e(j)+e(g)+e(S)||0))+")",1)]),t("th",Ct,[u("Standby 2 "),t("span",Nt,"("+o(e(l)(e(w)+e(k)+e(x)||0))+")",1)]),t("th",Pt,[u("Trip "),t("span",At,"("+o(e(l)(e(E)+e(M)+e(B)||0))+")",1)]),t("th",Tt,[u("Potongan "),t("span",qt,"("+o(e(l)(e(U)||0))+")",1)]),t("th",Vt,[u("U.Kerajinan "),t("span",Ut,"("+o(e(l)(e(D)||0))+")",1)]),t("th",$t,[u("Grand Total "),t("span",Gt,"("+o(e(l)(e(j)+e(g)+e(S)+e(w)+e(k)+e(x)+e(E)+e(M)+e(B)-e(U)+e(D)||0))+")",1)]),zt,t("th",null,[u("Total Periode 2 "),t("span",Jt,"("+o(e(l)(e(w)+e(k)+e(x)+e(D)||0))+")",1)])]),t("tr",Yt,[t("th",null,[u("SB.Gaji "),t("span",Kt,"("+o(e(l)(e(j)||0))+")",1)]),t("th",null,[u("SB.Makan "),t("span",Lt,"("+o(e(l)(e(g)||0))+")",1)]),t("th",null,[u("SB.Dinas "),t("span",It,"("+o(e(l)(e(S)||0))+")",1)]),t("th",null,[u("SB.Gaji "),t("span",Ot,"("+o(e(l)(e(w)||0))+")",1)]),t("th",null,[u("SB.Makan "),t("span",Rt,"("+o(e(l)(e(k)||0))+")",1)]),t("th",null,[u("SB.Dinas "),t("span",Ht,"("+o(e(l)(e(x)||0))+")",1)]),t("th",null,[u("UJ.Gaji "),t("span",Qt,"("+o(e(l)(e(E)||0))+")",1)]),t("th",null,[u("UJ.Makan "),t("span",Wt,"("+o(e(l)(e(M)||0))+")",1)]),t("th",null,[u("UJ.Dinas "),t("span",Xt,"("+o(e(l)(e(B)||0))+")",1)])])]),t("tbody",Zt,[(p(!0),d($,null,tt(e(_),(s,f)=>(p(),d($,{key:f},[s.p_status!="Remove"?(p(),d("tr",{key:0,"data-index":f},[t("td",null,o(f+1)+".",1),t("td",null,o(s.employee_id),1),t("td",null,o(s.employee_name),1),t("td",null,o(s.employee_role),1),t("td",null,o(s.employee_birth_place),1),t("td",null,o(s.employee_birth_date?e(y)(s.employee_birth_date).format("DD-MM-Y"):""),1),t("td",null,o(s.employee_tmk?e(y)(s.employee_tmk).format("DD-MM-Y"):""),1),t("td",null,o(s.employee_ktp_no),1),t("td",null,o(s.employee_address),1),t("td",null,o(s.employee_status),1),t("td",null,o(s.employee_rek_no),1),t("td",null,o(s.employee_bank_name),1),t("td",null,o(e(l)(s.sb_gaji)),1),t("td",null,o(e(l)(s.sb_makan)),1),t("td",null,o(e(l)(s.sb_dinas)),1),t("td",null,o(e(l)(s.sb_gaji_2)),1),t("td",null,o(e(l)(s.sb_makan_2)),1),t("td",null,o(e(l)(s.sb_dinas_2)),1),t("td",null,o(e(l)(s.uj_gaji)),1),t("td",null,o(e(l)(s.uj_makan)),1),t("td",null,o(e(l)(s.uj_dinas)),1),t("td",null,o(e(l)(s.nominal_cut)),1),t("td",null,o(e(l)(s.salary_bonus_nominal)),1),t("td",null,o(e(l)(parseFloat(s.sb_gaji)+parseFloat(s.sb_makan)+parseFloat(s.sb_dinas)+parseFloat(s.sb_gaji_2)+parseFloat(s.sb_makan_2)+parseFloat(s.sb_dinas_2)+parseFloat(s.uj_gaji)+parseFloat(s.uj_makan)+parseFloat(s.uj_dinas)-parseFloat(s.nominal_cut)+parseFloat(s.salary_bonus_nominal))),1),ee,t("td",null,o(e(l)(parseFloat(s.sb_gaji)+parseFloat(s.sb_makan)+parseFloat(s.sb_dinas)+parseFloat(s.sb_gaji_2)+parseFloat(s.sb_makan_2)+parseFloat(s.sb_dinas_2)+parseFloat(s.uj_gaji)+parseFloat(s.uj_makan)+parseFloat(s.uj_dinas)-parseFloat(s.nominal_cut)+parseFloat(s.salary_bonus_nominal))),1)],8,te)):A("",!0)],64))),128))],512)])])])):A("",!0)]),t("div",se,[t("button",{type:"button",name:"button",class:"w-36 m-1",onClick:n[1]||(n[1]=s=>v.fnClose())}," Cancel "),e(Y)?A("",!0):(p(),d("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:n[2]||(n[2]=et(s=>J(),["prevent"]))}," Generate "+o(e(r).id==""?"& Save":""),1))])])])],512)),[[X,v.show]])}}};export{ie as default};
