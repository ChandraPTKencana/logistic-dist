import ue from"./Header.95ec8b6f.js";import ce from"./Plus.1c1ae600.js";import de from"./Edit.6d3c0141.js";import _e from"./Signature.eae93ceb.js";import me from"./Table2Column.9713391b.js";import fe from"./TableUp.15c7c488.js";import pe from"./Line.862a9d1e.js";import ve from"./Check.f152b684.js";import{_ as he}from"./PopupMini.vue.0c8d1d08.js";import ye from"./rpt_salary.34b60c04.js";import ge from"./rpt_salary_validasi.e70ba5ae.js";import ke from"./rpt_salary_check.34527db4.js";import{g as we,h as xe,r as l,B as be,j as I,s as Ce,f as De,c as _,b as m,a as o,l as t,n as y,F as Ae,D as $e,w as Se,q as Te,x as f,y as g,o as i,E as Me,z as j,t as A,d as Fe,k as Pe,A as Be,m as Ee,G as Le}from"./entry.1bbc996f.js";import{u as E}from"./useUtils.b2fe819a.js";import{u as k}from"./useMyFetch.4a8b3833.js";import{u as Re}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.e702a751.js";import"./Exclamation.4aad5258.js";import"./HeaderPopup.vue.8c1f8ae1.js";import"./client-only.260ccb29.js";import"./Refresh.81263602.js";const Ue={class:"w-full h-full flex flex-col"},ze={class:"w-full flex grow flex-col overflow-auto h-0"},Ie={class:"w-full flex"},je={class:"w-full flex justify-center items-center grow h-0 p-1"},Ne={key:0,class:""},He={class:"tacky"},Oe=o("thead",null,[o("tr",{class:"sticky top-0 !z-[2]"},[o("th",null,"Logistik"),o("th",null,"ID"),o("th",null,"Period End"),o("th",null,"Created At"),o("th",null,"Updated At")])],-1),Ve=["onClick"],Ye={class:"flex items-center justify-center"},Je={class:"bold"},qe={class:"grow mb-5"},gt={__name:"rpt",async setup(Ge){let w,L;const{$moment:$}=Le(),d={};d._TimeZoneOffset=new Date().getTimezoneOffset(),d.sort="created_at:desc";const p=we("token"),{data:N}=([w,L]=xe(async()=>Te(async()=>{let e=[];f().loading_full=!0;const{data:a,error:c,status:h}=await k("/rpt_salarys",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:d,retry:0});return f().loading_full=!1,h.value==="error"?(g().trigger(c),{rpt_salarys:e}):(e=a.value.data,{rpt_salarys:e})},"$fWJlXxIgiP")),w=await w,L(),w),s=l(N.value.rpt_salarys);l(""),l({field:"created_at",by:"desc"});const n=l(-1),u=l({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),x=l(null),H=async()=>{f().loading_full=!0,u.value.may_get_data=!1,d.page=u.value.page,d.page==1&&(s.value=[]),d.first_row&&delete d.first_row,d.page>1&&(d.first_row=JSON.stringify(s.value[0]));const{data:e,error:a,status:c}=await k("/rpt_salarys",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:d,retry:0});if(f().loading_full=!1,u.value.may_get_data=!0,c.value==="error"){g().trigger(a);return}u.value.page==1?(s.value=e.value.data,x.value&&(x.value.scrollTop=0)):u.value.page>1&&(s.value=[...s.value,...e.value.data]),e.value.data.length==0&&(u.value.is_last_record=!0)},O=async()=>{if(!u.value.may_get_data)return;let e=x.value;if(e.scrollLeft!=u.value.scrollLeft){u.value.scrollLeft=e.scrollLeft;return}u.value.is_last_record||!(Math.round(e.scrollTop)+e.clientHeight>=e.scrollHeight-1)||(u.value.page++,await H())};be();const b=l(!1),S=l(0),C=l(0),V=()=>{S.value=0,b.value=!0,C.value=!1},{display:T}=I();Ce(I());const Y=()=>{n.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(S.value=s.value[n.value].id,b.value=!0,C.value=!1)},M=l(!1),R=l(0),J=()=>{n.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(R.value=s.value[n.value].id,C.value=!0,M.value=!0)},F=l(!1),q=l({}),D=l(!1),v=l(""),G=async()=>{D.value&&(D.value=!1)};De(()=>v.value,e=>{e.trim().length>0?F.value=!0:F.value=!1},{immediate:!1});const W=async()=>{f().loading_full=!0;const e=new FormData;e.append("id",s.value[n.value].id),e.append("deleted_reason",v.value),e.append("_method","DELETE");const{data:a,error:c,status:h}=await k("/rpt_salary",{method:"post",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},body:e,retry:0});if(f().loading_full=!1,h.value==="error"){g().trigger(c);return}s.value.splice(n.value,1),n.value=-1,D.value=!1},{downloadFile:U,viewFile:We}=Re();l(!1),l({});const X=async()=>{f().loading_full=!0;const{data:e,error:a,status:c}=await k("/rpt_salary/excel_download",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:{id:s.value[n.value].id},retry:0});if(f().loading_full=!1,c.value==="error"){g().trigger(a);return}U(e.value)},Z=async()=>{f().loading_full=!0;const{data:e,error:a,status:c}=await k("/rpt_salary/excel_download2",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:{id:s.value[n.value].id},retry:0});if(f().loading_full=!1,c.value==="error"){g().trigger(a);return}U(e.value)},z=l(0),P=l(!1),K=()=>{n.value==-1?T({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(z.value=s.value[n.value].id,P.value=!0)};return(e,a)=>{const c=ue,h=ce,Q=de,ee=_e,te=me,ae=fe,oe=pe,le=ve,se=he,ne=ye,re=ge,ie=ke;return i(),_("div",Ue,[m(c,{title:"List Salary Report"}),o("div",ze,[o("div",Ie,[("useUtils"in e?e.useUtils:t(E))().checkPermission("rpt_salary.create")?(i(),_("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[0]||(a[0]=r=>V())},[m(h)])):y("",!0),("useUtils"in e?e.useUtils:t(E))().checkPermissions(["rpt_salary.modify"])?(i(),_("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[1]||(a[1]=r=>Y())},[m(Q)])):y("",!0),("useUtils"in e?e.useUtils:t(E))().checkPermissions(["rpt_salary.val1","rpt_salary.val2","rpt_salary.val3"])?(i(),_("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[2]||(a[2]=r=>J())},[m(ee)])):y("",!0),t(n)>-1?(i(),_("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[3]||(a[3]=r=>X())},[m(te)])):y("",!0),o("button",{type:"button",name:"button",class:"m-1 text-xs whitespace-nowrap",onClick:a[4]||(a[4]=r=>K())}," Check Nilai "),t(n)>-1&&t(s)[t(n)].val1==1?(i(),_("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[5]||(a[5]=r=>Z())},[m(ae)])):y("",!0)]),o("div",je,[t(s).length==0?(i(),_("div",Ne," Maaf Tidak Ada Record ")):(i(),_("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:x,onScroll:O},[o("table",He,[Oe,o("tbody",null,[(i(!0),_(Ae,null,$e(t(s),(r,B)=>(i(),_("tr",{key:B,onClick:Xe=>n.value=B,class:Me(t(n)==B?"active":"")},[o("td",null,[o("div",Ye,[r.val1?(i(),j(le,{key:1})):(i(),j(oe,{key:0}))])]),o("td",Je,A(r.id),1),o("td",null,A(r.period_end?t($)(r.period_end).format("MM-Y"):""),1),o("td",null,A(r.created_at?t($)(r.created_at).format("DD-MM-Y HH:mm:ss"):""),1),o("td",null,A(r.updated_at?t($)(r.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,Ve))),128))])])],544))])]),m(se,{type:"delete",show:t(D),data:t(q),fnClose:G,fnConfirm:W,enabledOk:t(F)},{footer:Se(()=>[Fe(" Masukkan Alasan Penghapusan: "),o("div",qe,[Pe(o("textarea",{"onUpdate:modelValue":a[6]||(a[6]=r=>Ee(v)?v.value=r:null)},null,512),[[Be,t(v)]])])]),_:1},8,["show","data","enabledOk"]),m(ne,{show:t(b),fnClose:()=>{b.value=!1},id:t(S),p_data:t(s),is_copy:t(C)},null,8,["show","fnClose","id","p_data","is_copy"]),m(re,{show:t(M),fnClose:()=>{M.value=!1},id:t(R),p_data:t(s)},null,8,["show","fnClose","id","p_data"]),m(ie,{show:t(P),fnClose:()=>{P.value=!1},id:t(z)},null,8,["show","fnClose","id"])])}}};export{gt as default};
