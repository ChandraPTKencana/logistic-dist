import{r as n,f as Y,g as ve,h as fe,i as w,j as q,s as ye,c as D,a as r,b as p,k as G,v as he,l,m as Z,n as T,w as h,F as ge,q as be,x as _,y as B,o as v,z as A,d as $,t as K,A as ke,B as Q,_ as W,p as xe,e as we}from"./entry.2c798c4f.js";import De from"./Header.0187adba.js";import Ae from"./Plus.c2822e5c.js";import Ce from"./Edit.76169185.js";import Se from"./Delete.eb66884c.js";import Oe from"./Line.0d639d98.js";import Pe from"./Check.e6bf60f5.js";import Ie from"./TypeIcon.f3517ce9.js";import Te from"./TableView.2b97c741.js";import{u as E}from"./useMyFetch.79160f08.js";import{u as M}from"./useUtils.437b3e73.js";import{_ as Be}from"./_plugin-vue_export-helper.c27b6911.js";import"./DocJPEG.6538e69f.js";import"./DocJPG.b0bdbb2e.js";import"./DocPNG.87ba9e6a.js";import"./DocPDF.39750824.js";import"./Search.3043f934.js";import"./Adjust.128330ca.js";import"./TableHeaderEye.5e114b42.js";import"./Times.a570b43c.js";import"./ClearAll.82a76196.js";import"./client-only.c834acb6.js";import"./ClearEach.611de72c.js";import"./CaretLeftDoubleBold.718f916e.js";import"./CaretLeftBold.c9427645.js";import"./CaretRightBold.04d147af.js";import"./CaretRightDoubleBold.4149bc18.js";const $e=Q(()=>W(()=>import("./PopupMini.46e51de8.js"),["./PopupMini.46e51de8.js","./PopupMini.vue.ccc5215b.js","./Times.a570b43c.js","./_plugin-vue_export-helper.c27b6911.js","./entry.2c798c4f.js","./entry.493f9183.css","./Exclamation.c2186a38.js"],import.meta.url).then(i=>i.default||i)),Ee=Q(()=>W(()=>import("./vehicle.d77825b5.js"),["./vehicle.d77825b5.js","./HeaderPopup.vue.65f721df.js","./Times.a570b43c.js","./_plugin-vue_export-helper.c27b6911.js","./entry.2c798c4f.js","./entry.493f9183.css","./useMyFetch.79160f08.js"],import.meta.url).then(i=>i.default||i)),V=i=>(xe("data-v-e7c868fc"),i=i(),we(),i),Me={class:"w-full h-full flex flex-col"},Ve={class:"w-full flex grow flex-col overflow-auto h-0"},ze={class:"w-full flex justify-between flex-wrap"},Ne={class:"grow flex"},Fe={class:"m-1"},Le=V(()=>r("option",{value:"available"},"Available",-1)),He=V(()=>r("option",{value:"deleted"},"Trash",-1)),je=V(()=>r("option",{value:"all"},"All",-1)),Re=[Le,He,je],Ue={class:"grow mb-5"},Je={__name:"index",async setup(i){let k,z;const X=t=>t.deleted==1?"!bg-red-400":t.val==0?"!bg-gray-300":"",c=n("available");Y(()=>c.value,t=>{L()},{immediate:!1});const d={};d._TimeZoneOffset=new Date().getTimezoneOffset();const C=ve("token"),{data:s}=([k,z]=fe(async()=>be(async()=>{_().loading_full=!0;const{data:t,error:e,status:f}=await E("/vehicles",{method:"get",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},params:{filter_status:c},retry:0});return _().loading_full=!1,f.value==="error"?(B().trigger(e),[]):t.value.data},"$OEvmawoGm4")),k=await k,z(),k);n("");const S=n({field:"",by:"desc"}),o=n(-1),u=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),N=w(()=>s.value[o.value]),ee=()=>{d.like="";let t=JSON.parse(JSON.stringify(_()._tv.global_keyword));t!=""&&(d.like=`id:%${t}%,no_pol:%${t}%`),d.sort="",S.value.field&&(d.sort=S.value.field+":"+S.value.by),d.filter_model=JSON.stringify(_()._tv.filter_model)},F=async()=>{_().loading_full=!0,u.value.may_get_data=!1,d.page=u.value.page,d.page==1&&(s.value=[]),d.filter_status=c.value;const{data:t,error:e,status:f}=await E("/vehicles",{method:"get",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},params:d,retry:0});if(_().loading_full=!1,u.value.may_get_data=!0,f.value==="error"){B().trigger(e);return}u.value.page==1?s.value=t.value.data:u.value.page>1&&(s.value=[...s.value,...t.value.data]),t.value.data.length==0&&(u.value.is_last_record=!0),_()._tv.filter_box=!1},L=()=>{o.value=-1,u.value.page=1,u.value.is_last_record=!1,ee(),F()},x=n(!1),O=n(0),H=n(!1),te=()=>{O.value=0,H.value=!1,x.value=!0},{display:j}=q();ye(q());const ae=()=>{o.value==-1?j({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(O.value=s.value[o.value].id,H.value=!1,x.value=!0)},P=n(!1),R=n({}),g=n(!1),y=n(""),le=async()=>{g.value&&(g.value=!1)},oe=()=>{o.value==-1?j({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(y.value="",R.value={id:s.value[o.value].id},g.value=!0)};Y(()=>y.value,t=>{t.trim().length>0?P.value=!0:P.value=!1},{immediate:!1});const se=async()=>{_().loading_full=!0;const t=new FormData;t.append("id",s.value[o.value].id),t.append("deleted_reason",y.value),t.append("_method","DELETE");const{data:e,error:f,status:I}=await E("/vehicle",{method:"post",headers:{Authorization:`Bearer ${C.value}`,Accept:"application/json"},body:t,retry:0});if(_().loading_full=!1,I.value==="error"){B().trigger(f);return}let m={...s.value[o.value]};m.deleted=e.value.deleted,m.deleted_user=e.value.deleted_user,m.deleted_at=e.value.deleted_at,m.deleted_by=e.value.deleted_by,m.deleted_reason=e.value.deleted_reason,c.value!="all"?s.value.splice(o.value,1):s.value.splice(o.value,1,{...m}),o.value=-1,g.value=!1},ne=n([{key:"no",label:"No",isai:!0},{key:"id",label:"ID",filter_on:1,type:"number"},{key:"no_pol",label:"No Pol",filter_on:1,type:"string",sort:{priority:1,type:"asc"}},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]),re=w(()=>["available","all","unapprove"].indexOf(c.value)>-1&&M().checkPermission("vehicle.create")),ie=w(()=>o.value>-1&&[void 0,0].indexOf(N.value.deleted)>-1&&M().checkPermissions(["vehicle.modify"])),de=w(()=>o.value>-1&&M().checkPermission("vehicle.remove")&&[void 0,0].indexOf(N.value.deleted)>-1);return(t,e)=>{const f=De,I=Ae,m=Ce,ue=Se,U=Oe,J=Pe,_e=Ie,ce=Te,me=$e,pe=Ee;return v(),D(ge,null,[r("div",Me,[p(f,{title:"List Vehicle"}),r("div",Ve,[r("div",ze,[r("div",Ne,[r("div",Fe,[G(r("select",{class:"","onUpdate:modelValue":e[0]||(e[0]=a=>Z(c)?c.value=a:null)},Re,512),[[he,l(c)]])]),l(re)?(v(),D("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[1]||(e[1]=a=>te())},[p(I)])):T("",!0),l(ie)?(v(),D("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[2]||(e[2]=a=>ae())},[p(m)])):T("",!0),l(de)?(v(),D("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:e[3]||(e[3]=a=>oe())},[p(ue)])):T("",!0)])]),p(ce,{thead:l(ne),selected:l(o),onSetSelected:e[4]||(e[4]=a=>o.value=a),tbody:l(s),fnCallData:F,scrolling:l(u),onSetScrollingPage:e[5]||(e[5]=a=>l(u).page=a),onDoFilter:e[6]||(e[6]=a=>L()),rowBgColor:X},{val:h(({item:a})=>[a.val?(v(),A(J,{key:1})):(v(),A(U,{key:0}))]),val1:h(({item:a})=>[a.val1?(v(),A(J,{key:1})):(v(),A(U,{key:0}))]),bank_code:h(({item:a})=>{var b;return[$(K((b=a.bank)==null?void 0:b.code),1)]}),attachment_1_type:h(({item:a})=>[p(_e,{value:a.attachment_1_type},null,8,["value"])]),deleted_by_username:h(({item:a})=>{var b;return[$(K((b=a.deleted_by)==null?void 0:b.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])])]),p(me,{type:"delete",show:l(g),data:l(R),fnClose:le,fnConfirm:se,enabledOk:l(P)},{footer:h(()=>[$(" Masukkan Alasan Penghapusan: "),r("div",Ue,[G(r("textarea",{"onUpdate:modelValue":e[7]||(e[7]=a=>Z(y)?y.value=a:null)},null,512),[[ke,l(y)]])])]),_:1},8,["show","data","enabledOk"]),p(pe,{show:l(x),fnClose:()=>{x.value=!1},id:l(O),p_data:l(s)},null,8,["show","fnClose","id","p_data"])],64)}}},gt=Be(Je,[["__scopeId","data-v-e7c868fc"]]);export{gt as default};
