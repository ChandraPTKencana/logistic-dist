import{_ as K}from"./HeaderPopup.vue.228b189c.js";import{_ as L}from"./WidthMiniList.vue.2af31354.js";import{_ as M}from"./InputPointFormat.vue.34c7ebca.js";import{r as v,g as z,i as G,f as E,k as m,K as H,o as w,c as x,a as e,b,l as o,A as T,F as j,D,t as _,v as A,x as p,C as Q,y as S,p as W,e as R,H as X}from"./entry.e12e06c3.js";import{u as Y}from"./useUtils.47bd639f.js";import{u as N}from"./useMyFetch.0add3b72.js";import{_ as Z}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.8af2c57c.js";import"./WidthMiniPart.vue.b19f38c9.js";const r=f=>(W("data-v-a966737e"),f=f(),R(),f),ee={class:"box-fixed"},te={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},ae={class:"w-full flex flex-col items-center grow overflow-auto"},oe={class:"w-full flex flex-row flex-wrap"},le={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},se=r(()=>e("label",{for:""},"Tujuan",-1)),ne={id:"xto"},ie={class:"text-red-500"},re={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},ce=r(()=>e("label",{for:""},"Jenis",-1)),de=X('<option value="PK" data-v-a966737e>PK</option><option value="CPO" data-v-a966737e>CPO</option><option value="TBS" data-v-a966737e>TBS</option><option value="TBSK" data-v-a966737e>TBSK</option><option value="LAIN" data-v-a966737e>LAIN</option><option value="TUNGGU" data-v-a966737e>TUNGGU</option>',6),ue=[de],_e={class:"text-red-500"},pe={class:"w-full sm:w-3/12 flex px-2 py-3"},fe={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative items-end"},ve=r(()=>e("div",{class:"absolute bg-white -top-3"}," Peralihan ",-1)),me={class:"w-6/12 flex flex-col flex-wrap p-1"},we=r(()=>e("option",{value:""},null,-1)),xe=r(()=>e("option",{value:"From"},"Dari",-1)),he=r(()=>e("option",{value:"To"},"Ke",-1)),ye=[we,xe,he],ge={class:"text-red-500"},be={class:"w-6/12 flex flex-col flex-wrap p-1"},Se=r(()=>e("option",{value:""},null,-1)),Ne=["value"],Ae={class:"text-red-500"},Ce={class:"w-full sm:w-12/12 flex px-2 py-3"},qe={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative items-start"},Be=r(()=>e("div",{class:"absolute bg-white -top-3"}," Account ",-1)),Ie={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Te=r(()=>e("label",{for:""},"Info",-1)),je={class:"text-red-500"},De={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Oe=r(()=>e("label",{for:""},"Deskripsi",-1)),Ue={class:"text-red-500"},ke={class:"w-full sm:w-4/12 md:w-4/12 lg:w-4/12 flex flex-col flex-wrap p-1"},$e=r(()=>e("label",{for:""},"Nominal",-1)),Fe={class:"w-full"},Je={class:"text-red-500"},Ve={class:"w-full sm:w-4/12 md:w-4/12 lg:w-4/12 flex flex-col flex-wrap p-1"},Pe=r(()=>e("label",{for:""},"Qty",-1)),Ke={class:"w-full"},Le={class:"text-red-500"},Me={class:"w-full sm:w-4/12 md:w-4/12 lg:w-4/12 flex flex-col flex-wrap p-1"},ze=r(()=>e("label",{for:""},"Total",-1)),Ge={class:"w-full card-border"},Ee={class:"w-full flex items-center justify-end"},He={__name:"extra_money",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(f){const d=f,{pointFormat:O}=Y(),C={id:-1,xto:"",jenis:"",transition_target:"",transition_type:"",ac_account_id:"",ac_account_code:"",ac_account_name:"",description:"",nominal:0,qty:1},U=v([]);v({ordinal:0,id:"",tanggal:new Date,note:"",p_status:""});const a=v({...C}),h=z("token"),u=v({}),k=async()=>{p().loading_full=!0,u.value={};const s=new FormData;s.append("xto",a.value.xto),s.append("jenis",a.value.jenis),s.append("transition_target",a.value.transition_target),s.append("transition_type",a.value.transition_type),s.append("ac_account_id",i.value.id),s.append("description",a.value.description),s.append("nominal",a.value.nominal),s.append("qty",a.value.qty);let t="post",c=d.is_copy?0:d.id;c==0||(s.append("id",c),s.append("_method","PUT"));const{data:n,error:g,status:l}=await N("/extra_money",{method:t,headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},body:s,retry:0});if(p().loading_full=!1,l.value==="error"){S().trigger(g,u);return}if(a.value.ac_account_id=i.value._.id.val,a.value.ac_account_name=i.value._.name.val,a.value.ac_account_code=i.value._.code.val,a.value.updated_at=n.value.updated_at,c<=0)a.value.id=n.value.id,a.value.created_at=n.value.created_at,d.p_data.unshift(a.value);else{let I=d.p_data.map(P=>P.id).indexOf(d.id);I>=-1&&d.p_data.splice(I,1,{...a.value})}d.fnClose()},y={_:{id:{tcon:"",text:"ID",val:""},code:{tcon:"",text:"Code",val:""},name:{tcon:"",text:"Name",val:""}},id:"",name:"",title:""},i=v(JSON.parse(JSON.stringify(y))),$=G(()=>{let s=[];return B.value.forEach((t,c)=>{let n=JSON.parse(JSON.stringify(y));n._.id.val=t.AccountID,n._.name.val=t.AccountName,n._.code.val=t.AccountCode,n.id=t.AccountID,n.name=t.AccountCode,n.title=t.AccountName,s.push(JSON.parse(JSON.stringify(n)))}),s}),F=async()=>{p().loading_full=!0;const{data:s,error:t,status:c}=await N("/extra_money",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},params:{id:d.id},retry:0});if(p().loading_full=!1,c.value==="error"){S().trigger(t);return}d.is_copy&&(a.value.val=0,a.value.val1=0);let n=s.value.data;a.value=n,{...n},i.value._.id.val=n.ac_account_id,i.value._.name.val=n.ac_account_name,i.value._.code.val=n.ac_account_code,i.value.id=n.ac_account_id,i.value.name=n.ac_account_code,i.value.title=n.ac_account_name},q=v([]),B=v([]),J=async()=>{p().loading_full=!0;const{data:s,error:t,status:c}=await N("/extra_money_load_local",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},retry:0});if(p().loading_full=!1,c.value==="error"){S().trigger(t);return}q.value=s.value.list_xto},V=async()=>{p().loading_full=!0;const{data:s,error:t,status:c}=await N("/extra_money_load_sqlsrv",{method:"get",headers:{Authorization:`Bearer ${h.value}`,Accept:"application/json"},retry:0});if(p().loading_full=!1,c.value==="error"){S().trigger(t);return}B.value=s.value.list_accs};return E(()=>d.show,async(s,t)=>{s==!0&&(await J(),await V(),a.value={...C},i.value=JSON.parse(JSON.stringify(y)),U.value=[],u.value={},d.id!=0&&F())},{immediate:!0}),(s,t)=>{const c=K,n=L,g=M;return m((w(),x("section",ee,[e("div",null,[b(c,{title:"Form Transaction",fn:f.fnClose,class:"w-full flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",te,[e("div",ae,[e("div",oe,[e("div",le,[se,m(e("input",{type:"text",list:"xto","onUpdate:modelValue":t[0]||(t[0]=l=>o(a).xto=l)},null,512),[[T,o(a).xto]]),e("datalist",ne,[(w(!0),x(j,null,D(o(q),l=>(w(),x("option",null,_(l),1))),256))]),e("p",ie,_(o(u).xto),1)]),e("div",re,[ce,m(e("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>o(a).jenis=l)},ue,512),[[A,o(a).jenis]]),e("p",_e,_(o(u).jenis),1)]),e("div",pe,[e("div",fe,[ve,e("div",me,[m(e("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>o(a).transition_type=l)},ye,512),[[A,o(a).transition_type]]),e("p",ge,_(o(u).transition_type),1)]),e("div",be,[m(e("select",{"onUpdate:modelValue":t[3]||(t[3]=l=>o(a).transition_target=l)},[Se,(w(!0),x(j,null,D(o(p)().list_pabrik,l=>(w(),x("option",{value:l},_(l),9,Ne))),256))],512),[[A,o(a).transition_target]]),e("p",Ae,_(o(u).transition_target),1)])])]),e("div",Ce,[e("div",qe,[Be,e("div",Ie,[Te,b(n,{arr:o($),selected:o(i),pure:y,onSetSelected:t[4]||(t[4]=l=>i.value=l)},null,8,["arr","selected"]),e("p",je,_(o(u).ac_account_id),1)]),e("div",De,[Oe,m(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=l=>o(a).description=l)},null,512),[[T,o(a).description]]),e("p",Ue,_(o(u).description),1)]),e("div",ke,[$e,e("div",Fe,[b(g,{class:"w-full h-full p-1",type:"text",value:o(a).nominal||0,onInput:t[6]||(t[6]=l=>o(a).nominal=l)},null,8,["value"])]),e("p",Je,_(o(u).nominal),1)]),e("div",Ve,[Pe,e("div",Ke,[b(g,{class:"w-full h-full p-1",type:"text",value:o(a).qty||0,onInput:t[7]||(t[7]=l=>o(a).qty=l)},null,8,["value"])]),e("p",Le,_(o(u).qty),1)]),e("div",Me,[ze,e("div",Ge,_(o(O)(o(a).nominal*o(a).qty)),1)])])])])]),e("div",Ee,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:t[8]||(t[8]=l=>f.fnClose())}," Cancel "),e("button",{type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:t[9]||(t[9]=Q(l=>k(),["prevent"]))}," Save ")])])])],512)),[[H,f.show]])}}},ot=Z(He,[["__scopeId","data-v-a966737e"]]);export{ot as default};
