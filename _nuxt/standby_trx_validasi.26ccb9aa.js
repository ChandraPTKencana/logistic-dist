import{_ as Q}from"./HeaderPopup.vue.6db44442.js";import{_ as X}from"./WidthMiniPart.vue.e5b320a5.js";import Z from"./AttachmentSingle.6108e33d.js";import ee from"./Times.3112f93f.js";import te from"./Check.0cb9a1ab.js";import se from"./CaretTop.5dcdfd9d.js";import le from"./CaretDown.84ff177e.js";import{r as p,f as ae,P as oe,G as L,j as ne,m as ie,J as re,o as _,c,a as e,b as h,t as a,k as s,F as q,y as _e,D as J,l as m,x as de,d as ce,E as ve,A as g,B as z,p as ue,e as fe}from"./entry.ee87ecfe.js";import{u as pe}from"./useUtils.52d38825.js";import{u as U}from"./useMyFetch.6728ea6f.js";import{_ as me}from"./_plugin-vue_export-helper.c27b6911.js";import"./PDFJsView.508dc8e3.js";const n=v=>(ue("data-v-6dcbbdfc"),v=v(),fe(),v),we={class:"box-fixed"},xe={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},he={class:"w-full flex flex-col items-center grow overflow-auto"},be={class:"w-full flex flex-row flex-wrap"},ye={class:"w-full sm:w-9/12 flex px-2 py-3"},ke={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},ge=n(()=>e("div",{class:"absolute bg-white -top-3"}," Standby ",-1)),De={class:"w-6/12 sm:w-2/12 flex flex-col flex-wrap p-1"},Se=n(()=>e("label",{for:""},"ID",-1)),Ne={class:"card-border"},Ie={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Ce=n(()=>e("label",{for:""},"Name",-1)),Ae={class:"card-border"},Ye={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Te=n(()=>e("label",{for:""},"Type",-1)),$e={class:"card-border"},Be={class:"w-6/12 sm:w-2/12 flex flex-col flex-wrap p-1"},Fe=n(()=>e("label",{for:""},"Amount",-1)),Pe={class:"card-border"},Me={class:"w-full sm:w-3/12 flex px-2 py-3"},je={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative items-end"},Ve=n(()=>e("div",{class:"absolute bg-white -top-3"}," Peralihan ",-1)),Ee={class:"w-6/12 flex flex-col flex-wrap p-1"},Re={class:"card-border"},He={class:"w-6/12 flex flex-col flex-wrap p-1"},Oe={class:"card-border"},Le={class:"w-full flex flex-wrap"},qe={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Je=n(()=>e("label",{for:""},"Supir",-1)),ze={class:"card-border"},Ue={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Ge=n(()=>e("label",{for:""},"Kernet",-1)),Ke={class:"card-border"},We={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Qe=n(()=>e("label",{for:""},"No Pol",-1)),Xe={class:"card-border"},Ze={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},et=n(()=>e("label",{for:""},"Tujuan",-1)),tt={class:"card-border"},st={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},lt=n(()=>e("label",{for:""},"Note For Remarks",-1)),at={class:"card-border"},ot={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},nt=n(()=>e("label",{for:""},"Referensi",-1)),it={class:"card-border"},rt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},_t={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},dt=n(()=>e("div",{class:"absolute bg-white -top-3"}," Cost Center ",-1)),ct={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},vt=n(()=>e("label",{for:""}," Code",-1)),ut={class:"card-border"},ft={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},pt=n(()=>e("label",{for:""},"Desc",-1)),mt={class:"card-border disabled"},wt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},xt={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},ht=n(()=>e("div",{class:"absolute bg-white -top-3"}," PVR ",-1)),bt={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},yt=n(()=>e("label",{for:""},"No",-1)),kt={class:"card-border disabled"},gt={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Dt=n(()=>e("label",{for:""},"Total",-1)),St={class:"card-border disabled"},Nt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},It={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},Ct=n(()=>e("div",{class:"absolute bg-white -top-3"}," PV ",-1)),At={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},Yt=n(()=>e("label",{for:""},"No",-1)),Tt={class:"card-border disabled"},$t={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Bt=n(()=>e("label",{for:""},"Total",-1)),Ft={class:"card-border disabled"},Pt={class:"w-full flex grow p-1 overflow-auto 2xl:overflow-hidden justify-between flex-wrap"},Mt={class:"w-full",role:"sticky"},jt={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},Vt={class:"sticky -top-1 !z-[2]"},Et=["colspan"],Rt=n(()=>e("tr",{class:"sticky top-7 !z-[2]"},[e("th",{class:"!min-w-[50px] !w-[50px] !max-w-[50px]"},"No"),e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Tanggal"),e("th",{class:"!min-w-[200px] !w-[200px] !max-w-[200px]"},"Foto"),e("th",{class:"!min-w-[200px] !w-[200px] !max-w-[200px]"},"Note"),e("th",{class:"!min-w-[70px] !w-[70px] !max-w-[70px]"},"Dibayar")],-1)),Ht={ref:"to_move"},Ot=["data-index"],Lt={class:"cell"},qt={class:"w-full h-full flex items-center justify-center relative"},Jt={class:"cell"},zt={style:{width:"60vw"},class:"h-full flex items-center justify-center"},Ut={class:"cell"},Gt={class:"h-full flex items-center justify-center"},Kt={class:"cell"},Wt={class:"w-full h-full flex items-center justify-center"},Qt={class:"text-3xl"},Xt={class:"w-full flex items-center justify-end"},Zt={class:"w-full flex flex-wrap p-3 items-center"},es=n(()=>e("div",null," Di Validasi oleh : ",-1)),ts={key:0,class:"border-solid border-2 w-fit p-1 bg-slate-700 text-white text-xs"},ss={key:0},ls={key:1},as={key:2},os={key:0,class:"text-xs font-bold"},ns={__name:"standby_trx_validasi",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_view:{type:Boolean,required:!1,default:!1}},emits:["setID","setIndex"],setup(v,{emit:b}){const r=v,{$moment:y}=ve(),{pointFormat:D}=pe(),B={id:-1,transition_target:"",transition_type:"",standby_mst_id:"",standby_mst_:{name:"",tipe:"",amount:0},supir:"",kernet:"",no_pol:"",xto:"",note_for_remarks:"",ref:"",cost_center_code:"",cost_center_desc:"",pvr_id:"",pvr_no:"",pvr_total:0,pvr_had_detail:0,pv_id:"",pv_no:"",pv_total:0,pv_datetime:"",rv_id:"",rv_no:"",rv_total:0,rv_had_detail:"",details:[],val:0,val_by:{username:""},val_at:"",val1:0,val1_by:{username:""},val1_at:"",val2:0,val2_by:{username:""},val2_at:""},t=p({...B}),F=ae("token"),P=p({}),M=p(null),S=p([]),j={_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:-1,name:"",title:""};let N=o=>{o.key=="ArrowUp"&&E(),o.key=="ArrowDown"&&V()};oe(()=>{document.removeEventListener("keydown",N)});const u=p(JSON.parse(JSON.stringify(j))),f=p(JSON.parse(JSON.stringify(j))),w=p(""),G=async()=>{w.value="PROSES...",g().loading_full=!0,P.value={};const o=new FormData;let i="post",x=r.id;x==0||(o.append("id",x),o.append("_method","PUT"));const{data:l,error:C,status:A}=await U("/standby_trx_validasi",{method:i,headers:{Authorization:`Bearer ${F.value}`,Accept:"application/json"},body:o,retry:0});if(g().loading_full=!1,A.value==="error"){w.value="GAGAL",z().trigger(C,P);return}t.value.val=l.value.val,t.value.val_user=l.value.val_user,t.value.val_by=l.value.val_by,t.value.val_at=l.value.val_at,t.value.val1=l.value.val1,t.value.val1_user=l.value.val1_user,t.value.val1_by=l.value.val1_by,t.value.val1_at=l.value.val1_at,t.value.val2=l.value.val2,t.value.val2_user=l.value.val2_user,t.value.val2_by=l.value.val2_by,t.value.val2_at=l.value.val2_at;let k=r.p_data.map(Y=>Y.id).indexOf(r.id);k>=-1&&r.p_data.splice(k,1,{...t.value}),w.value="BERHASIL"},I=async()=>{w.value="",g().loading_full=!0;const{data:o,error:i,status:x}=await U("/standby_trx",{method:"get",headers:{Authorization:`Bearer ${F.value}`,Accept:"application/json"},params:{id:r.id},retry:0});if(g().loading_full=!1,x.value==="error"){z().trigger(i);return}let l=o.value.data;t.value=l,u.value._.id.val=l.supir_id,u.value._.name.val=l.supir,u.value._.rek_no.val=l.supir_rek_no,u.value._.rek_name.val=l.supir_rek_name,u.value.id=l.supir_id,u.value.name=l.supir,u.value.rek_no=(l.supir_rek_no||"")+" "+(l.supir_rek_name||""),f.value._.id.val=l.kernet_id,f.value._.name.val=l.kernet,f.value._.rek_no.val=l.kernet_rek_no,f.value._.rek_name.val=l.kernet_rek_name,f.value.id=l.kernet_id,f.value.name=l.kernet,f.value.rek_no=(l.kernet_rek_no||"")+" "+(l.kernet_rek_name||""),S.value=o.value.data.details};L(()=>{let o=0;return S.value.forEach(i=>{i.p_status!="Remove"&&(o+=i.amount)}),o});const K=L(()=>t.value.val2==1);ne(()=>r.show,(o,i)=>{o==!0?(document.addEventListener("keydown",N),t.value={...B},r.is_view==!1&&setTimeout(()=>{M.value.focus()},1),I()):document.removeEventListener("keydown",N)},{immediate:!0});const V=()=>{let o=r.p_data.map(i=>i.id).indexOf(r.id);o!=r.p_data.length-1&&(o++,b("setID",r.p_data[o].id),b("setIndex",o),setTimeout(()=>{I()},100))},E=()=>{let o=r.p_data.map(i=>i.id).indexOf(r.id);o!=0&&(o--,b("setID",r.p_data[o].id),b("setIndex",o),setTimeout(()=>{I()},100))};return(o,i)=>{var R,H,O;const x=Q,l=X,C=Z,A=ee,k=te,Y=se,W=le;return ie((_(),c("section",we,[e("div",null,[h(x,{title:"Form Transaction Standby Validation",fn:v.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",xe,[e("div",he,[e("div",be,[e("div",ye,[e("div",ke,[ge,e("div",De,[Se,e("div",Ne,a(s(t).standby_mst_id),1)]),e("div",Ie,[Ce,e("div",Ae,a((R=s(t).standby_mst_)==null?void 0:R.name),1)]),e("div",Ye,[Te,e("div",$e,a((H=s(t).standby_mst_)==null?void 0:H.tipe),1)]),e("div",Be,[Fe,e("div",Pe,a(s(D)((O=s(t).standby_mst_)==null?void 0:O.amount)),1)])])]),e("div",Me,[e("div",je,[Ve,e("div",Ee,[e("div",Re,a(s(t).transition_type),1)]),e("div",He,[e("div",Oe,a(s(t).transition_target),1)])])]),e("div",Le,[e("div",qe,[Je,e("div",ze,[h(l,{selected:s(u)},null,8,["selected"])])]),e("div",Ue,[Ge,e("div",Ke,[h(l,{selected:s(f)},null,8,["selected"])])]),e("div",We,[Qe,e("div",Xe,a(s(t).no_pol),1)]),e("div",Ze,[et,e("div",tt,a(s(t).xto),1)]),e("div",st,[lt,e("div",at,a(s(t).note_for_remarks),1)]),e("div",ot,[nt,e("div",it,a(s(t).ref),1)])]),e("div",rt,[e("div",_t,[dt,e("div",ct,[vt,e("div",ut,a(s(t).cost_center_code),1)]),e("div",ft,[pt,e("div",mt,a(s(t).cost_center_desc),1)])])]),e("div",wt,[e("div",xt,[ht,e("div",bt,[yt,e("div",kt,a(s(t).pvr_no),1)]),e("div",gt,[Dt,e("div",St,a(s(D)(s(t).pvr_total||0)),1)])])]),e("div",Nt,[e("div",It,[Ct,e("div",At,[Yt,e("div",Tt,a(s(t).pv_no),1)]),e("div",$t,[Bt,e("div",Ft,a(s(D)(s(t).pv_total)),1)])])]),e("div",Pt,[e("div",Mt,[e("table",jt,[e("thead",null,[e("tr",Vt,[e("td",{colspan:s(K)?5:6,class:"!bg-slate-800 text-white font-bold"}," Detail Transaction ",8,Et)]),Rt]),e("tbody",Ht,[(_(!0),c(q,null,_e(s(S),(d,T)=>(_(),c(q,{key:T},[d.p_status!="Remove"?(_(),c("tr",{key:0,"data-index":T},[e("td",null,a(T+1)+".",1),e("td",Lt,[e("div",qt,a(s(y)(d.tanggal).format("DD-MM-YYYY")),1)]),e("td",Jt,[e("div",zt,[h(C,{value:d.attachment_1_preview,onSetFile:$=>d.attachment_1=$,onSetPreview:$=>d.attachment_1_preview=$},null,8,["value","onSetFile","onSetPreview"])])]),e("td",Ut,[e("div",Gt,a(d.note),1)]),e("td",Kt,[e("div",Wt,[e("div",Qt,[d.be_paid==0?(_(),J(A,{key:0,class:"text-red-800"})):(_(),J(k,{key:1,class:"text-green-800"}))])])])],8,Ot)):m("",!0)],64))),128))],512)])])])])]),e("div",Xt,[e("div",Zt,[es,s(t).val||s(t).val1||s(t).val2?(_(),c("div",ts,[s(t).val?(_(),c("div",ss," App 1 : "+a(s(t).val_by.username)+" ( "+a(s(t).val_at?s(y)(s(t).val_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0),s(t).val1?(_(),c("div",ls," App 2 : "+a(s(t).val1_by.username)+" ( "+a(s(t).val1_at?s(y)(s(t).val1_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0),s(t).val2?(_(),c("div",as," App 3 : "+a(s(t).val2_by.username)+" ( "+a(s(t).val2_at?s(y)(s(t).val2_at).format("DD-MM-YYYY HH:mm:ss"):"")+" ) ",1)):m("",!0)])):m("",!0)]),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:i[0]||(i[0]=d=>E())},[h(Y,{class:"black"})]),e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:i[1]||(i[1]=d=>v.fnClose())}," Cancel "),v.is_view==0?(_(),c("button",{key:0,ref_key:"it_val",ref:M,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:i[2]||(i[2]=de(d=>G(),["prevent"]))},[ce(" Validasi "),s(w)!=""?(_(),c("div",os,a(s(w)),1)):m("",!0)],512)):m("",!0),e("button",{type:"button",name:"button",class:"w-36 h-9 m-1 grid place-items-center",onClick:i[3]||(i[3]=d=>V())},[h(W,{class:"black"})])])])])],512)),[[re,v.show]])}}},hs=me(ns,[["__scopeId","data-v-6dcbbdfc"]]);export{hs as default};
