import me from"./Header.ba345b02.js";import de from"./Plus.67b979d1.js";import pe from"./Edit.4d66f7b9.js";import ce from"./Eyes.cffe2562.js";import fe from"./Signature.74edd037.js";import ve from"./Line.0d28f826.js";import ye from"./Check.f016c973.js";import ge from"./TableView.7cf7e715.js";import be from"./mst.d686d581.js";import ke from"./validasi.8c7fb12e.js";import{r as a,f as V,g as he,h as we,i as p,B as xe,j as z,s as De,c as w,b as m,a as _,k as Pe,v as Se,l,m as Ce,n as P,w as S,q as Ae,x as c,y as J,o as u,z as C,d as E,t as R}from"./entry.fa369e0d.js";import{u as f}from"./useUtils.9e7b4deb.js";import{u as L}from"./useMyFetch.c3981d40.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Search.d82f9cc4.js";import"./Adjust.b0fe8a79.js";import"./TableHeaderEye.914ecbcd.js";import"./Times.da78eaa7.js";import"./ClearAll.5136f4dc.js";import"./client-only.9a731e20.js";import"./ClearEach.82e6b7a4.js";import"./CaretLeftDoubleBold.2d0b1871.js";import"./CaretLeftBold.48112c8a.js";import"./CaretRightBold.2ecf1951.js";import"./CaretRightDoubleBold.0ddce6d7.js";import"./HeaderPopup.vue.46d7f32b.js";import"./WidthMiniList.vue.e015014f.js";import"./WidthMiniPart.vue.f0a4ac68.js";import"./InputPointFormat.vue.b1a6ebfa.js";import"./AttachmentSingle.f1fe19ed.js";import"./PDFJsView.c5aa5895.js";import"./part.8bab0e97.js";import"./Delete.687f1b5c.js";import"./Calculator.55c4c274.js";import"./trx.4749ff45.js";import"./trx_validasi.a8bf85df.js";const $e={class:"w-full h-full flex flex-col"},Oe={class:"w-full flex grow flex-col overflow-auto h-0"},je={class:"w-full flex justify-between flex-wrap"},Ne={class:"grow flex"},Be={class:"m-1"},Me=_("option",{value:"undone"},"Undone",-1),Te=_("option",{value:"done"},"Done",-1),He=_("option",{value:"deleted"},"Trash",-1),Fe=_("option",{value:"all"},"All",-1),Ie=[Me,Te,He,Fe],wt={__name:"index",async setup(Ue){let x,N;const Y=e=>e.deleted==1?"!bg-red-400":e.val>0&&e.val1>0&&e.remaining_cut==0?"!bg-blue-300":"",d=a("undone");V(()=>d.value,e=>{T()},{immediate:!1});const n={};n._TimeZoneOffset=new Date().getTimezoneOffset(),n.sort="created_at:desc";const B=he("token"),{data:q}=([x,N]=we(async()=>Ae(async()=>{let e=[];c().loading_full=!0;const{data:t,error:k,status:j}=await L("/potongan_msts",{method:"get",headers:{Authorization:`Bearer ${B.value}`,Accept:"application/json"},params:{filter_status:d},retry:0});return c().loading_full=!1,j.value==="error"?(J().trigger(k),{potongan_msts:e}):(e=t.value.data,{potongan_msts:e})},"$4H5grU4zhJ")),x=await x,N(),x),r=a(q.value.potongan_msts);a("");const A=a({field:"created_at",by:"desc"}),s=a(-1),i=a({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),v=p(()=>r.value[s.value]),K=()=>{n.like="";let e=JSON.parse(JSON.stringify(c()._tv.global_keyword));e!=""&&(n.like=`id:%${e}%,employee_name:%${e}%,no_pol:%${e}%,kejadian:%${e}%,status:%${e}%`),n.sort="",A.value.field&&(n.sort=A.value.field+":"+A.value.by),n.filter_model=JSON.stringify(c()._tv.filter_model)};a(null);const M=async()=>{c().loading_full=!0,i.value.may_get_data=!1,n.page=i.value.page,n.page==1&&(r.value=[]),n.first_row&&delete n.first_row,n.page>1&&(n.first_row=JSON.stringify(r.value[0])),n.filter_status=d.value;const{data:e,error:t,status:k}=await L("/potongan_msts",{method:"get",headers:{Authorization:`Bearer ${B.value}`,Accept:"application/json"},params:n,retry:0});if(c().loading_full=!1,i.value.may_get_data=!0,k.value==="error"){J().trigger(t);return}i.value.page==1?r.value=e.value.data:i.value.page>1&&(r.value=[...r.value,...e.value.data]),e.value.data.length==0&&(i.value.is_last_record=!0),c()._tv.filter_box=!1},T=()=>{s.value=-1,i.value.page=1,i.value.is_last_record=!1,K(),M()};xe();const y=a(!1),D=a(0),g=a(0),b=a(!1),Z=()=>{D.value=0,b.value=!1,g.value=!1,y.value=!0},{display:$}=z();De(z());const G=()=>{s.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(D.value=r.value[s.value].id,b.value=!1,g.value=!1,y.value=!0)},O=a(!1),H=a(0),Q=()=>{s.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(H.value=r.value[s.value].id,b.value=!0,g.value=!1,O.value=!0)},W=()=>{s.value==-1?$({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(D.value=r.value[s.value].id,b.value=!0,g.value=!1,y.value=!0)},F=a(!1);a({}),a(!1);const X=a("");V(()=>X.value,e=>{e.trim().length>0?F.value=!0:F.value=!1},{immediate:!1});const ee=a([{key:"no",label:"No",isai:!0},{key:"valx",label:"APP",childs:[{key:"val",label:"App 1",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]},{key:"val1",label:"App 2",filter_on:1,type:"select",select_item:[{k:"1",v:"Approve"},{k:"0",v:"Unapprove"}]}]},{key:"id",label:"ID",filter_on:1,type:"number",sort:{priority:1,type:"desc"}},{key:"employee_name",label:"Nama Pekerja",freeze:1,filter_on:1,type:"string"},{key:"no_pol",label:"No Pol",filter_on:1,type:"string"},{key:"kejadian",label:"Kejadian",filter_on:1,type:"string"},{key:"nominal",label:"Nominal",class:" justify-end",type:"number"},{key:"nominal_cut",label:"Nominal Potongan",class:" justify-end",type:"number"},{key:"remaining_cut",label:"Sisa Potongan",class:" justify-end",type:"number"},{key:"status",label:"Status",class:" justify-end",type:"number"},{key:"created_at",label:"Created At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"updated_at",label:"Updated At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1},{key:"deleted_by_username",label:"Deleted By",tbl_show:1},{key:"deleted_at",label:"Deleted At",type:"datetime",dateformat:"DD-MM-Y HH:mm:ss",filter_on:1,tbl_show:1},{key:"deleted_reason",label:"Deleted Reason",tbl_show:1,type:"string",filter_on:1}]);p(()=>s.value>-1&&[void 0,0].indexOf(v.value.deleted)>-1&&f().checkPermission("potongan_mst.create"));const te=p(()=>["undone","done","deleted","all"].indexOf(d.value)>-1&&f().checkPermission("potongan_mst.create")),oe=p(()=>s.value>-1&&f().checkPermission("potongan_mst.view")),ae=p(()=>s.value>-1&&[void 0,0].indexOf(v.value.deleted)>-1&&f().checkPermissions(["potongan_mst.modify","potongan_trx.create","potongan_trx.modify","potongan_trx.remove"])),le=p(()=>s.value>-1&&[void 0,0].indexOf(v.value.deleted)>-1&&(f().checkPermission("potongan_mst.val")&&[void 0,0].indexOf(v.value.val)>-1||f().checkPermission("potongan_mst.val1")&&[void 0,0].indexOf(v.value.val1)>-1));return p(()=>s.value>-1&&f().checkPermission("potongan_mst.remove")&&[void 0,0].indexOf(v.value.deleted)>-1),(e,t)=>{const k=me,j=de,ne=pe,se=ce,re=fe,I=ve,U=ye,ie=ge,ue=be,_e=ke;return u(),w("div",$e,[m(k,{title:"List Potongan"}),_("div",Oe,[_("div",je,[_("div",Ne,[_("div",Be,[Pe(_("select",{class:"","onUpdate:modelValue":t[0]||(t[0]=o=>Ce(d)?d.value=o:null)},Ie,512),[[Se,l(d)]])]),l(te)?(u(),w("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[1]||(t[1]=o=>Z())},[m(j)])):P("",!0),l(ae)?(u(),w("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[2]||(t[2]=o=>G())},[m(ne)])):P("",!0),l(oe)?(u(),w("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[3]||(t[3]=o=>W())},[m(se)])):P("",!0),l(le)?(u(),w("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:t[4]||(t[4]=o=>Q())},[m(re)])):P("",!0)])]),m(ie,{thead:l(ee),selected:l(s),onSetSelected:t[5]||(t[5]=o=>s.value=o),tbody:l(r),fnCallData:M,scrolling:l(i),onSetScrollingPage:t[6]||(t[6]=o=>l(i).page=o),onDoFilter:t[7]||(t[7]=o=>T()),rowBgColor:Y},{val:S(({item:o})=>[o.val?(u(),C(U,{key:1})):(u(),C(I,{key:0}))]),val1:S(({item:o})=>[o.val1?(u(),C(U,{key:1})):(u(),C(I,{key:0}))]),employee_name:S(({item:o})=>{var h;return[E(R((h=o.employee)==null?void 0:h.name),1)]}),deleted_by_username:S(({item:o})=>{var h;return[E(R((h=o.deleted_by)==null?void 0:h.username),1)]}),_:2},1032,["thead","selected","tbody","scrolling"])]),m(ue,{show:l(y),fnClose:()=>{y.value=!1},id:l(D),p_data:l(r),is_copy:l(g),is_view:l(b)},null,8,["show","fnClose","id","p_data","is_copy","is_view"]),m(_e,{show:l(O),fnClose:()=>{O.value=!1},id:l(H),p_data:l(r)},null,8,["show","fnClose","id","p_data"])])}}};export{wt as default};
