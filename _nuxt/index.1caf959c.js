import ie from"./Header.e60776c7.js";import ue from"./Plus.369225d7.js";import de from"./Edit.2abbd626.js";import ce from"./Signature.4940e2cf.js";import _e from"./Table2Column.77993c91.js";import fe from"./TableUp.e8c0fbf6.js";import me from"./Line.7e2014f4.js";import pe from"./Check.2249bde8.js";import{_ as ve}from"./PopupMini.vue.0f457bbe.js";import ye from"./salary_paid.ed889407.js";import he from"./salary_paid_validasi.7929589f.js";import{_ as ge}from"./PDFView.vue.df9c9126.js";import{g as we,h as ke,r as n,B as xe,j,s as be,f as Ce,c as _,b as f,a as o,l as t,n as h,F as De,D as Ae,w as $e,q as Pe,x as m,y as g,o as i,E as Me,z as I,t as w,d as Te,k as Se,A as Be,m as Fe,G as ze}from"./entry.12456dc3.js";import{u as F}from"./useUtils.14609047.js";import{u as k}from"./useMyFetch.0e9cdda8.js";import{u as Ee}from"./useDownload.174f4da2.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./Times.6d2fb864.js";import"./Exclamation.d9d2fba8.js";import"./HeaderPopup.vue.82cb158a.js";import"./client-only.666fe170.js";const Le={class:"w-full h-full flex flex-col"},Ue={class:"w-full flex grow flex-col overflow-auto h-0"},je={class:"w-full flex"},Ie={class:"w-full flex justify-center items-center grow h-0 p-1"},Ve={key:0,class:""},He={class:"tacky"},Ne=o("thead",null,[o("tr",{class:"sticky top-0 !z-[2]"},[o("th",null,"Logistik"),o("th",null,"ID"),o("th",null,"Period End"),o("th",null,"Period Part"),o("th",null,"Created At"),o("th",null,"Updated At")])],-1),Oe=["onClick"],Re={class:"flex items-center justify-center"},Ye={class:"bold"},qe={class:"grow mb-5"},yt={__name:"index",async setup(Ge){let x,z;const{$moment:$}=ze(),c={};c._TimeZoneOffset=new Date().getTimezoneOffset(),c.sort="created_at:desc";const p=we("token"),{data:V}=([x,z]=ke(async()=>Pe(async()=>{let e=[];m().loading_full=!0;const{data:a,error:d,status:y}=await k("/salary_paids",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:c,retry:0});return m().loading_full=!1,y.value==="error"?(g().trigger(d),{salary_paids:e}):(e=a.value.data,{salary_paids:e})},"$5DNPjgzs1s")),x=await x,z(),x),l=n(V.value.salary_paids);n(""),n({field:"created_at",by:"desc"});const r=n(-1),u=n({page:1,is_last_record:!1,scrollLeft:0,may_get_data:!0}),b=n(null),H=async()=>{m().loading_full=!0,u.value.may_get_data=!1,c.page=u.value.page,c.page==1&&(l.value=[]),c.first_row&&delete c.first_row,c.page>1&&(c.first_row=JSON.stringify(l.value[0]));const{data:e,error:a,status:d}=await k("/salary_paids",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:c,retry:0});if(m().loading_full=!1,u.value.may_get_data=!0,d.value==="error"){g().trigger(a);return}u.value.page==1?(l.value=e.value.data,b.value&&(b.value.scrollTop=0)):u.value.page>1&&(l.value=[...l.value,...e.value.data]),e.value.data.length==0&&(u.value.is_last_record=!0)},N=async()=>{if(!u.value.may_get_data)return;let e=b.value;if(e.scrollLeft!=u.value.scrollLeft){u.value.scrollLeft=e.scrollLeft;return}u.value.is_last_record||!(Math.round(e.scrollTop)+e.clientHeight>=e.scrollHeight-1)||(u.value.page++,await H())};xe();const C=n(!1),P=n(0),D=n(0),O=()=>{P.value=0,C.value=!0,D.value=!1},{display:E}=j();be(j());const R=()=>{r.value==-1?E({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(P.value=l.value[r.value].id,C.value=!0,D.value=!1)},M=n(!1),L=n(0),Y=()=>{r.value==-1?E({show:!0,status:"Failed",message:"Silahkan Pilih Data Terlebih Dahulu"}):(L.value=l.value[r.value].id,D.value=!1,M.value=!0)},T=n(!1),q=n({}),A=n(!1),v=n(""),G=async()=>{A.value&&(A.value=!1)};Ce(()=>v.value,e=>{e.trim().length>0?T.value=!0:T.value=!1},{immediate:!1});const J=async()=>{m().loading_full=!0;const e=new FormData;e.append("id",l.value[r.value].id),e.append("deleted_reason",v.value),e.append("_method","DELETE");const{data:a,error:d,status:y}=await k("/salary_paid",{method:"post",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},body:e,retry:0});if(m().loading_full=!1,y.value==="error"){g().trigger(d);return}l.value.splice(r.value,1),r.value=-1,A.value=!1},{downloadFile:U,viewFile:Je}=Ee(),S=n(!1),Z=n({}),K=async()=>{m().loading_full=!0;const{data:e,error:a,status:d}=await k("/salary_paid/excel_download",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:{id:l.value[r.value].id},retry:0});if(m().loading_full=!1,d.value==="error"){g().trigger(a);return}U(e.value)},Q=async()=>{m().loading_full=!0;const{data:e,error:a,status:d}=await k("/salary_paid/excel_download2",{method:"get",headers:{Authorization:`Bearer ${p.value}`,Accept:"application/json"},params:{id:l.value[r.value].id},retry:0});if(m().loading_full=!1,d.value==="error"){g().trigger(a);return}U(e.value)};return(e,a)=>{const d=ie,y=ue,W=de,X=ce,ee=_e,te=fe,ae=me,oe=pe,le=ve,se=ye,ne=he,re=ge;return i(),_("div",Le,[f(d,{title:"List Salary Paid"}),o("div",Ue,[o("div",je,[("useUtils"in e?e.useUtils:t(F))().checkPermission("salary_paid.create")?(i(),_("button",{key:0,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[0]||(a[0]=s=>O())},[f(y)])):h("",!0),("useUtils"in e?e.useUtils:t(F))().checkPermissions(["salary_paid.modify"])?(i(),_("button",{key:1,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[1]||(a[1]=s=>R())},[f(W)])):h("",!0),("useUtils"in e?e.useUtils:t(F))().checkPermissions(["salary_paid.val1","salary_paid.val2","salary_paid.val3"])?(i(),_("button",{key:2,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[2]||(a[2]=s=>Y())},[f(X)])):h("",!0),t(r)>-1&&t(l)[t(r)].val1==1?(i(),_("button",{key:3,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[3]||(a[3]=s=>K())},[f(ee)])):h("",!0),t(r)>-1&&t(l)[t(r)].val1==1?(i(),_("button",{key:4,type:"button",name:"button",class:"m-1 text-2xl",onClick:a[4]||(a[4]=s=>Q())},[f(te)])):h("",!0)]),o("div",Ie,[t(l).length==0?(i(),_("div",Ve," Maaf Tidak Ada Record ")):(i(),_("div",{key:1,class:"w-full h-full overflow-auto",role:"sticky",ref_key:"loadRef",ref:b,onScroll:N},[o("table",He,[Ne,o("tbody",null,[(i(!0),_(De,null,Ae(t(l),(s,B)=>(i(),_("tr",{key:B,onClick:Ze=>r.value=B,class:Me(t(r)==B?"active":"")},[o("td",null,[o("div",Re,[s.val1?(i(),I(oe,{key:1})):(i(),I(ae,{key:0}))])]),o("td",Ye,w(s.id),1),o("td",null,w(s.period_end?t($)(s.period_end).format("MM-Y"):""),1),o("td",null,w(s.period_part),1),o("td",null,w(s.created_at?t($)(s.created_at).format("DD-MM-Y HH:mm:ss"):""),1),o("td",null,w(s.updated_at?t($)(s.updated_at).format("DD-MM-Y HH:mm:ss"):""),1)],10,Oe))),128))])])],544))])]),f(le,{type:"delete",show:t(A),data:t(q),fnClose:G,fnConfirm:J,enabledOk:t(T)},{footer:$e(()=>[Te(" Masukkan Alasan Penghapusan: "),o("div",qe,[Se(o("textarea",{"onUpdate:modelValue":a[5]||(a[5]=s=>Fe(v)?v.value=s:null)},null,512),[[Be,t(v)]])])]),_:1},8,["show","data","enabledOk"]),f(se,{show:t(C),fnClose:()=>{C.value=!1},id:t(P),p_data:t(l),is_copy:t(D)},null,8,["show","fnClose","id","p_data","is_copy"]),f(ne,{show:t(M),fnClose:()=>{M.value=!1},id:t(L),p_data:t(l)},null,8,["show","fnClose","id","p_data"]),f(re,{show:t(S),pdfContent:t(Z),onClose:a[6]||(a[6]=s=>S.value=!t(S))},null,8,["show","pdfContent"])])}}};export{yt as default};
