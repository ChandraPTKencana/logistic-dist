import{_ as $}from"./HeaderPopup.vue.95b98fc5.js";import{_ as q}from"./InputPointFormat.vue.e8f6f284.js";import{_ as F}from"./WidthMiniList.vue.fb737234.js";import{r as h,g as M,i as C,f as L,k as P,L as V,o as k,c as S,a as e,b as w,t as d,l as o,A as z,n as U,D as E,x as m,y as j,p as R,e as H}from"./entry.c948bf9c.js";import{u as b}from"./useUtils.ae6ca43e.js";import{u as B}from"./useMyFetch.1a05feaf.js";import{_ as W}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.187abd52.js";import"./WidthMiniPart.vue.d6586ae3.js";const p=c=>(R("data-v-c4e3158e"),c=c(),H(),c),G={class:"box-fixed"},Q={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},X={class:"w-full flex flex-col items-center grow overflow-auto"},Y={class:"w-full flex flex-row flex-wrap"},Z={class:"w-full sm:w-8/12 md:w-6/12 lg:w-5/12 flex flex-col flex-wrap p-1"},ee=p(()=>e("label",{for:""},"To",-1)),te={class:"card-border disabled"},se={class:"w-1/2 sm:w-4/12 md:w-3/12 lg:w-1/12 flex flex-col flex-wrap p-1"},ae=p(()=>e("label",{for:""},"Jenis",-1)),oe={class:"card-border disabled"},ie={class:"w-1/2 sm:w-4/12 md:w-3/12 lg:w-2/12 flex flex-col flex-wrap p-1"},ne=p(()=>e("label",{for:""},"Trip Bonus Supir",-1)),le={class:"w-full"},re={class:"text-red-500"},_e={class:"w-1/2 sm:w-3/12 md:w-3/12 lg:w-2/12 flex flex-col flex-wrap p-1"},ue=p(()=>e("label",{for:""},"Trip Bonus Kernet",-1)),de={class:"w-full"},pe={class:"text-red-500"},ce={class:"w-1/2 sm:w-3/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},fe=p(()=>e("label",{for:""},"KM Range",-1)),me={class:"w-full"},ve={class:"text-red-500"},we={class:"w-1/2 sm:w-3/12 md:w-3/12 lg:w-2/12 flex flex-col flex-wrap p-1"},be=p(()=>e("label",{for:""},"Asal Peralihan",-1)),xe={class:"card-border disabled"},he={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},ge=p(()=>e("label",{for:""},"Tipe",-1)),ye={class:"card-border disabled"},ke={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Se=p(()=>e("label",{for:""},"Ket. Untuk Remarks",-1)),je={class:"card-border disabled"},Be={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},Ne=p(()=>e("label",{for:""},"Dest. Location",-1)),Te={class:"text-red-500"},Oe={key:0,class:"w-1/2 sm:w-3/12 md:w-2/12 lg:w-2/12 flex flex-col flex-wrap p-1"},Ce=p(()=>e("label",{for:""},"Batas % Susut",-1)),Pe={class:"w-full"},Ue={class:"text-red-500"},Ie={class:"w-full flex items-center justify-end"},Je={__name:"ujalan_change_some",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnSelect:{type:Function,required:!1},excludes:{type:String,required:!1},exclude_lists:{type:Array,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},is_copy:{type:[Boolean,Number],required:!0,default:!1}},setup(c){const u=c,{pointFormat:n}=b(),N={id:-1,xto:"",km_range:0,bonus_trip_supir:0,bonus_trip_kernet:0,batas_persen_susut:"",tipe:"",jenis:"",harga:0,note_for_remarks:"",transition_from:""},a=h({...N}),g=M("token"),f=h({}),I=async()=>{m().loading_full=!0,f.value={};const i=new FormData;i.append("batas_persen_susut",a.value.batas_persen_susut),i.append("bonus_trip_supir",a.value.bonus_trip_supir),i.append("bonus_trip_kernet",a.value.bonus_trip_kernet),i.append("km_range",a.value.km_range),i.append("jenis",a.value.jenis),i.append("destination_location_id",l.value.id);let t="post",_=u.is_copy?0:u.id;_==0||(i.append("id",_),i.append("_method","PUT"));const{data:s,error:y,status:r}=await B("/ujalan/change_some",{method:t,headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},body:i,retry:0});if(m().loading_full=!1,r.value==="error"){j().trigger(y,f);return}if(a.value.destination_location=JSON.parse(JSON.stringify(l.value._raw)),_<=0)a.value.id=s.value.id,a.value.created_at=s.value.created_at,a.value.updated_at=s.value.updated_at,u.p_data.unshift(a.value);else{a.value.updated_at=s.value.updated_at;let O=u.p_data.map(D=>D.id).indexOf(_);O>-1&&u.p_data.splice(O,1,{...a.value})}u.fnClose()},v=C(()=>!1),J=async()=>{m().loading_full=!0;const{data:i,error:t,status:_}=await B("/ujalan_",{method:"get",headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},params:{id:u.id},retry:0});if(m().loading_full=!1,_.value==="error"){j().trigger(t);return}a.value=i.value.data;let s=i.value.data;u.is_copy&&(a.value.val=0,a.value.val1=0),l.value._raw=s.destination_location,l.value._.id.val=s.destination_location.id,l.value._.xto.val=s.destination_location.xto,l.value._.min_trip.val=n(s.destination_location.min_trip),l.value._.bonus_trip_supir.val=n(s.destination_location.bonus_trip_supir),l.value._.bonus_next_trip_supir.val=n(s.destination_location.bonus_next_trip_supir),l.value._.bonus_trip_kernet.val=n(s.destination_location.bonus_trip_kernet),l.value._.bonus_next_trip_kernet.val=n(s.destination_location.bonus_next_trip_kernet),l.value.id=s.destination_location.id,l.value.name=s.destination_location.xto,l.value.title=n(s.destination_location.total)||""},x={_raw:{},_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},xto:{tcon:"IconsLocationOn",text:"Tujuan",val:""},min_trip:{tcon:"",text:"Min Trip",val:""},bonus_trip_supir:{tcon:"",text:"Bonus Trip Supir",val:""},bonus_next_trip_supir:{tcon:"",text:"Bonus Next Trip Supir",val:""},bonus_trip_kernet:{tcon:"",text:"Bonus Trip Kernet",val:""},bonus_next_trip_kernet:{tcon:"",text:"Bonus Next Trip Kernet",val:""}},id:"",name:"",title:"",note:""},l=h(JSON.parse(JSON.stringify(x))),T=h([]),A=async()=>{m().loading_full=!0;const{data:i,error:t,status:_}=await B("/ujalan/load_local",{method:"get",headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},retry:0});if(m().loading_full=!1,_.value==="error"){j().trigger(t);return}T.value=i.value.list_destination_location},K=C(()=>{let i=[];return T.value.forEach((t,_)=>{let s=JSON.parse(JSON.stringify(x));s._.id.val=t.id,s._.xto.val=t.xto,s._.min_trip.val=n(t.minimal_trip),s._.bonus_trip_supir.val=n(t.bonus_trip_supir),s._.bonus_next_trip_supir.val=n(t.bonus_next_trip_supir),s._.bonus_trip_kernet.val=n(t.bonus_trip_kernet),s._.bonus_next_trip_kernet.val=n(t.bonus_next_trip_kernet),s.id=t.id,s.name=t.xto,s.title="Min Trip:"+(n(t.minimal_trip)||"")+" | Bonus Trip Supir:"+(n(t.bonus_trip_supir)||"")+" | Bonus Next Trip Supir:"+(n(t.bonus_next_trip_supir)||"")+" | Bonus Trip Kernet:"+(n(t.bonus_trip_kernet)||"")+" | Bonus Next Trip Kernet:"+(n(t.bonus_next_trip_kernet)||""),s._raw=t,i.push(JSON.parse(JSON.stringify(s)))}),i});return L(()=>u.show,async(i,t)=>{i==!0&&(await A(),a.value={...N},l.value=JSON.parse(JSON.stringify(x)),u.id!=0&&J())},{immediate:!0}),(i,t)=>{const _=$,s=q,y=F;return P((k(),S("section",G,[e("div",null,[w(_,{title:"Form Change Some",fn:c.fnClose,class:"w-100 flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",Q,[e("div",X,[e("div",Y,[e("div",Z,[ee,e("div",te,d(o(a).xto),1)]),e("div",se,[ae,e("div",oe,d(o(a).jenis),1)]),e("div",ie,[ne,e("div",le,[w(s,{class:"w-full h-full p-1",type:"text",value:o(a).bonus_trip_supir||0,onInput:t[0]||(t[0]=r=>o(a).bonus_trip_supir=r),disabled:!("useUtils"in i?i.useUtils:o(b))().checkPermissions(["ujalan.create","ujalan.modify"])||o(v)||["CPO","PK"].indexOf(o(a).jenis)==-1},null,8,["value","disabled"])]),e("p",re,d(o(f).bonus_trip_supir),1)]),e("div",_e,[ue,e("div",de,[w(s,{class:"w-full h-full p-1",type:"text",value:o(a).bonus_trip_kernet||0,onInput:t[1]||(t[1]=r=>o(a).bonus_trip_kernet=r),disabled:!("useUtils"in i?i.useUtils:o(b))().checkPermissions(["ujalan.create","ujalan.modify"])||o(v)||["CPO","PK"].indexOf(o(a).jenis)==-1},null,8,["value","disabled"])]),e("p",pe,d(o(f).bonus_trip_kernet),1)]),e("div",ce,[fe,e("div",me,[w(s,{class:"w-full h-full p-1",type:"text",value:o(a).km_range||0,onInput:t[2]||(t[2]=r=>o(a).km_range=r),disabled:!("useUtils"in i?i.useUtils:o(b))().checkPermissions(["ujalan.create","ujalan.modify"])||o(v)},null,8,["value","disabled"])]),e("p",ve,d(o(f).km_range),1)]),e("div",we,[be,e("div",xe,d(o(a).transition_from),1)]),e("div",he,[ge,e("div",ye,d(o(a).tipe),1)]),e("div",ke,[Se,e("div",je,d(o(a).note_for_remarks),1)]),e("div",Be,[Ne,w(y,{arr:o(K),selected:o(l),pure:x,onSetSelected:t[3]||(t[3]=r=>l.value=r),disabled:o(v)||["TBS","TBSK"].indexOf(o(a).jenis)==-1},null,8,["arr","selected","disabled"]),e("p",Te,d(o(f).destination_location_id),1)]),("useUtils"in i?i.useUtils:o(b))().checkPermissions(["ujalan.batas_persen_susut.full_act"])?(k(),S("div",Oe,[Ce,e("div",Pe,[P(e("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>o(a).batas_persen_susut=r)},null,512),[[z,o(a).batas_persen_susut]])]),e("p",Ue,d(o(f).batas_persen_susut),1)])):U("",!0)])]),e("div",Ie,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:t[5]||(t[5]=r=>c.fnClose())}," Cancel "),o(v)?U("",!0):(k(),S("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:t[6]||(t[6]=E(r=>I(),["prevent"]))}," Save "))])])])],512)),[[V,c.show]])}}},ze=W(Je,[["__scopeId","data-v-c4e3158e"]]);export{ze as default};
