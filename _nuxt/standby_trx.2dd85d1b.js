import{_ as pe}from"./HeaderPopup.vue.132f678e.js";import{_ as ve}from"./WidthMiniList.vue.b7d1cf66.js";import fe from"./Tools.0f64b74d.js";import{_ as me}from"./client-only.c5cffc6d.js";import we from"./Plus.6c1db6ac.js";import xe from"./ToolsPopup.3f7ac11a.js";import{r as w,h as he,z as be,K as se,I as R,x as k,M as ye,o as _,c as r,n as h,v as ge,a as e,b as S,m as s,q as D,F as N,D as A,t as d,C as oe,G as I,w as ke,s as Se,y as z,p as Ne,e as Ce,H as De}from"./entry.9b8fbe30.js";import{u as Ve}from"./useUtils.f37c7c08.js";import{u as L}from"./useMyFetch.a6b0cb71.js";import{_ as Ae}from"./_plugin-vue_export-helper.c27b6911.js";import"./Times.30ad854a.js";import"./WidthMiniPart.vue.661336b1.js";const i=b=>(Ne("data-v-99ca7770"),b=b(),Ce(),b),Oe={class:"box-fixed"},Te={action:"#",class:"w-full flex grow flex-col h-0 overflow-auto bg-white"},Ue={class:"w-full flex flex-col items-center grow overflow-auto"},Ie={class:"w-full flex flex-row flex-wrap"},Je={class:"w-full sm:w-9/12 flex px-2 py-3"},Be={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},Fe=i(()=>e("div",{class:"absolute bg-white -top-3"}," Standby ",-1)),Me={class:"w-6/12 sm:w-2/12 flex flex-col flex-wrap p-1"},Pe=i(()=>e("label",{for:""},"ID",-1)),$e=["disabled"],je={id:"standby_mst"},qe=["value"],Re={class:"text-red-500"},ze={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},Le=i(()=>e("label",{for:""},"Name",-1)),Ee={class:"card-border disabled"},Ke={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},He=i(()=>e("label",{for:""},"Type",-1)),Ye={class:"card-border disabled"},Ge={class:"w-6/12 sm:w-2/12 flex flex-col flex-wrap p-1"},We=i(()=>e("label",{for:""},"Amount",-1)),Xe={class:"card-border disabled"},Qe={class:"w-full sm:w-3/12 flex px-2 py-3"},Ze={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative items-end"},et=i(()=>e("div",{class:"absolute bg-white -top-3"}," Peralihan ",-1)),tt={class:"w-6/12 flex flex-col flex-wrap p-1"},st=["disabled"],ot=i(()=>e("option",{value:""},null,-1)),lt=i(()=>e("option",{value:"From"},"Dari",-1)),at=i(()=>e("option",{value:"To"},"Ke",-1)),nt=[ot,lt,at],it={class:"text-red-500"},dt={class:"w-6/12 flex flex-col flex-wrap p-1"},_t=["disabled"],rt=i(()=>e("option",{value:""},null,-1)),ct=["value"],ut={class:"text-red-500"},pt={class:"w-full flex flex-wrap"},vt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},ft=i(()=>e("label",{for:""},"Supir",-1)),mt={class:"text-red-500"},wt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-6/12 flex flex-col flex-wrap p-1"},xt=i(()=>e("label",{for:""},"Kernet",-1)),ht={class:"text-red-500"},bt={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},yt=i(()=>e("label",{for:""},"No Pol",-1)),gt=["disabled"],kt={id:"vehicle"},St=["value"],Nt={class:"text-red-500"},Ct={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Dt=i(()=>e("label",{for:""},"Tujuan",-1)),Vt=["disabled"],At={id:"xto"},Ot={class:"text-red-500"},Tt={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ut=i(()=>e("label",{for:""},"Note For Remarks",-1)),It=["disabled"],Jt={class:"text-red-500"},Bt={class:"w-6/12 sm:w-4/12 md:w-4/12 lg:w-3/12 flex flex-col flex-wrap p-1"},Ft=i(()=>e("label",{for:""},"Referensi",-1)),Mt=["disabled"],Pt={class:"text-red-500"},$t={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},jt={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},qt=i(()=>e("div",{class:"absolute bg-white -top-3"}," Cost Center ",-1)),Rt={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},zt=i(()=>e("label",{for:""}," Code",-1)),Lt=["disabled"],Et={id:"cost_center"},Kt=["value"],Ht={class:"text-red-500"},Yt={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},Gt=i(()=>e("label",{for:""},"Desc",-1)),Wt={class:"card-border disabled"},Xt={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},Qt={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},Zt=i(()=>e("div",{class:"absolute bg-white -top-3"}," PVR ",-1)),es={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},ts=i(()=>e("label",{for:""},"No",-1)),ss={class:"card-border disabled"},os={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},ls=i(()=>e("label",{for:""},"Total",-1)),as={class:"card-border disabled"},ns={class:"w-full sm:w-6/12 md:w-6/12 lg:w-4/12 flex px-2 py-3"},is={class:"w-full flex flex-wrap ring-1 ring-gray-500 p-2 relative"},ds=i(()=>e("div",{class:"absolute bg-white -top-3"}," PV ",-1)),_s={class:"w-6/12 sm:w-8/12 flex flex-col flex-wrap p-1"},rs=i(()=>e("label",{for:""},"No",-1)),cs={class:"card-border disabled"},us={class:"w-6/12 sm:w-4/12 flex flex-col flex-wrap p-1"},ps=i(()=>e("label",{for:""},"Total",-1)),vs={class:"card-border disabled"},fs={class:"w-full flex grow p-1 overflow-auto 2xl:overflow-hidden justify-between flex-wrap"},ms={class:"w-full",role:"sticky"},ws={class:"tacky w-full !table-auto",style:{"white-space":"normal"}},xs={class:"sticky -top-1 !z-[2]"},hs=["colspan"],bs={class:"sticky top-7 !z-[2]"},ys={key:0,class:"!min-w-[30px] !w-[30px] !max-w-[30px]"},gs=i(()=>e("th",{class:"!min-w-[50px] !w-[50px] !max-w-[50px]"},"No",-1)),ks=i(()=>e("th",{class:"!min-w-[150px] !w-[150px] !max-w-[150px]"},"Tanggal",-1)),Ss=i(()=>e("th",{class:"!min-w-[200px] !w-[200px] !max-w-[200px]"},"Keterangan",-1)),Ns={ref:"to_move"},Cs=["data-index"],Ds={key:0,class:"tools cell"},Vs={class:"w-full h-full flex items-center justify-center"},As=["onClick"],Os={class:"cell"},Ts={class:"w-full h-full flex items-center justify-center relative"},Us={class:"cell"},Is={class:"w-full h-full flex items-center justify-center"},Js=["disabled","onUpdate:modelValue"],Bs={key:0},Fs={class:"tools cell"},Ms={class:"w-full flex items-center justify-end"},Ps={__name:"standby_trx",props:{show:{type:Boolean,required:!0},fnClose:{type:Function,required:!1},fnLoadDBData:{type:Function,required:!1},id:{type:Number,required:!1,default:0},p_data:{type:Array,required:!0,default:[]},list_cost_center:{type:Array,required:!0,default:[]},online_status:{type:Boolean,required:!0,default:!1}},setup(b){const f=b,{$moment:le}=De(),{pointFormat:J}=Ve(),M={id:-1,transition_target:"",transition_type:"",standby_mst_id:"",standby_mst_:{name:"",tipe:"",amount:0,is_transition:0},supir:"",kernet:"",no_pol:"",xto:"",note_for_remarks:"",ref:"",cost_center_code:"",cost_center_desc:"",pvr_id:"",pvr_no:"",pvr_total:0,pvr_had_detail:0,pv_id:"",pv_no:"",pv_total:0,pv_datetime:"",rv_id:"",rv_no:"",rv_total:0,rv_had_detail:"",details:[]},c=w([]),E=w({ordinal:0,id:"",tanggal:new Date,note:"",p_status:""});let O={...M};const t=w({...M}),P=he("token"),m=w({});be();const ae=async()=>{k().loading_full=!0,m.value={};const a=new FormData;a.append("transition_target",t.value.transition_target),a.append("transition_type",t.value.transition_type),a.append("standby_mst_id",t.value.standby_mst_id),a.append("supir_id",u.value.id),a.append("kernet_id",p.value.id),a.append("no_pol",t.value.no_pol),a.append("xto",t.value.xto),a.append("note_for_remarks",t.value.note_for_remarks),a.append("ref",t.value.ref),a.append("cost_center_code",t.value.cost_center_code),a.append("online_status",f.online_status);let o=[...c.value];o=o.map(y=>(y.tanggal=y.tanggal?le(y.tanggal).format("Y-MM-DD"):"",y)),a.append("details",JSON.stringify(o));let v="post",n=f.id;n==0||(a.append("id",n),a.append("_method","PUT"));const{data:C,error:g,status:j}=await L("/standby_trx",{method:v,headers:{Authorization:`Bearer ${P.value}`,Accept:"application/json"},body:a,retry:0});if(k().loading_full=!1,j.value==="error"){z().trigger(g,m);return}if(t.value.supir=u.value.name,t.value.supir_rek_no=u.value._.rek_no.val,t.value.supir_rek_name=u.value._.rek_name.val,t.value.kernet=p.value.name,t.value.kernet_rek_no=p.value._.rek_no.val,t.value.kernet_rek_name=p.value._.rek_name.val,t.value.updated_at=C.value.updated_at,f.id<=0)t.value.id=C.value.id,t.value.created_at=C.value.created_at,f.p_data.unshift(t.value);else{let y=f.p_data.map(q=>q.id).indexOf(f.id);y>=-1&&f.p_data.splice(y,1,{...t.value})}f.fnClose()},T={_:{id:{tcon:"IconsBaselineNumbers",text:"ID",val:""},name:{tcon:"IconsPerson",text:"Nama",val:""},rek_no:{tcon:"IconsNumber",text:"No Rek",val:""},rek_name:{tcon:"IconsCreditCard",text:"Nama Rek",val:""}},id:"",name:"",title:""},u=w(JSON.parse(JSON.stringify(T))),p=w(JSON.parse(JSON.stringify(T))),K=se(()=>{let a=[];return G.value.forEach((o,v)=>{let n=JSON.parse(JSON.stringify(T));n._.id.val=o.id,n._.name.val=o.name,n._.rek_no.val=o.rek_no,n._.rek_name.val=o.rek_name,n.id=o.id,n.name=o.name,n.title=(o.rek_no||"")+" "+(o.rek_name||""),a.push(JSON.parse(JSON.stringify(n)))}),a}),V=se(()=>!1),ne=async()=>{k().loading_full=!0;const{data:a,error:o,status:v}=await L("/standby_trx",{method:"get",headers:{Authorization:`Bearer ${P.value}`,Accept:"application/json"},params:{id:f.id},retry:0});if(k().loading_full=!1,v.value==="error"){z().trigger(o);return}let n=a.value.data;t.value=n,O={...n},u.value._.id.val=n.supir_id,u.value._.name.val=n.supir,u.value._.rek_no.val=n.supir_rek_no,u.value._.rek_name.val=n.supir_rek_name,u.value.id=n.supir_id,u.value.name=n.supir,u.value.rek_no=(n.supir_rek_no||"")+" "+(n.supir_rek_name||""),p.value._.id.val=n.kernet_id,p.value._.name.val=n.kernet,p.value._.rek_no.val=n.kernet_rek_no,p.value._.rek_name.val=n.kernet_rek_name,p.value.id=n.kernet_id,p.value.name=n.kernet,p.value.rek_no=(n.kernet_rek_no||"")+" "+(n.kernet_rek_name||"");let C="Edit";c.value=a.value.data.details.map(g=>(g.p_status=C,g.key=g.ordinal,g))},$=w([]),H=w([]),Y=w([]),G=w([]),ie=async()=>{k().loading_full=!0;const{data:a,error:o,status:v}=await L("/standby_trx_load_local",{method:"get",headers:{Authorization:`Bearer ${P.value}`,Accept:"application/json"},retry:0});if(k().loading_full=!1,v.value==="error"){z().trigger(o);return}$.value=a.value.list_standby_mst,H.value=a.value.list_xto,Y.value=a.value.list_vehicle,G.value=a.value.list_employee},x=w(-1),B=w(!1),W=w({left:0,top:0}),de=(a,o)=>{x.value=o,B.value=!0,W.value={left:a.clientX,top:a.clientY}},_e=()=>{c.value.push({...E.value,p_status:"Add"})},re=()=>{B.value=!1},ce=(a="")=>{if(a=="insert")c.value.splice(x.value,0,{...E.value,p_status:"Add"});else if(a=="delete")c.value[x.value].p_status=="Edit"?c.value[x.value].p_status="Remove":c.value.splice(x.value,1);else if(a=="move_top"){let o=c.value[x.value];c.value.splice(x.value,1),c.value.splice(x.value-1,0,{...o})}else if(a=="move_bottom"){let o=c.value[x.value];c.value.splice(x.value,1),c.value.splice(x.value+1,0,{...o})}B.value=!1};R(()=>f.show,async(a,o)=>{a==!0&&(await ie(),await f.fnLoadDBData(),t.value={...M},u.value=JSON.parse(JSON.stringify(T)),p.value=JSON.parse(JSON.stringify(T)),c.value=[],m.value={},f.id!=0&&ne())},{immediate:!0});let ue={name:"",tipe:"",amount:0,is_transition:0};return R(()=>t.value.standby_mst_id,(a,o)=>{if(k().loading_full==!1&&(a==""||a!="")){let v=$.value.filter(n=>n.id==a);v.length>0?t.value.standby_mst_={...v[0]}:t.value.standby_mst_id==O.standby_mst_id?t.value.standby_mst_={...O.standby_mst_}:t.value.standby_mst_={...ue},t.value.standby_mst_.is_transition||(t.value.transition_target="",t.value.transition_type="")}},{}),R(()=>t.value.cost_center_code,(a,o)=>{if(a==""&&(t.value.cost_center_desc=""),a){let v=f.list_cost_center.filter(n=>n.CostCenter==a);v.length>0?t.value.cost_center_desc=v[0].Description:t.value.cost_center_code==O.cost_center_code&&(t.value.cost_center_desc=O.cost_center_desc)}},{deep:!0,immediate:!0}),(a,o)=>{var X,Q,Z,ee,te;const v=pe,n=ve,C=fe,g=ye("vue-date-picker"),j=me,y=we,q=xe;return _(),r(N,null,[h(e("section",Oe,[e("div",null,[S(v,{title:"Form Transaction",fn:b.fnClose,class:"w-full flex align-items-center",style:{color:"white"}},null,8,["fn"]),e("form",Te,[e("div",Ue,[e("div",Ie,[e("div",Je,[e("div",Be,[Fe,e("div",Me,[Pe,h(e("input",{type:"text",list:"standby_mst","onUpdate:modelValue":o[0]||(o[0]=l=>s(t).standby_mst_id=l),disabled:s(t).pvr_no!=""},null,8,$e),[[D,s(t).standby_mst_id]]),e("datalist",je,[(_(!0),r(N,null,A(s($),l=>(_(),r("option",{value:l.id},d(l.name+"-"+l.tipe+"-"+s(J)(l.amount||0)),9,qe))),256))]),e("p",Re,d(s(m).standby_mst_id),1)]),e("div",ze,[Le,e("div",Ee,d((X=s(t).standby_mst_)==null?void 0:X.name),1)]),e("div",Ke,[He,e("div",Ye,d((Q=s(t).standby_mst_)==null?void 0:Q.tipe),1)]),e("div",Ge,[We,e("div",Xe,d(s(J)((Z=s(t).standby_mst_)==null?void 0:Z.amount)),1)])])]),e("div",Qe,[e("div",Ze,[et,e("div",tt,[h(e("select",{"onUpdate:modelValue":o[1]||(o[1]=l=>s(t).transition_type=l),disabled:((ee=s(t).standby_mst_)==null?void 0:ee.is_transition)==0},nt,8,st),[[oe,s(t).transition_type]]),e("p",it,d(s(m).transition_type),1)]),e("div",dt,[h(e("select",{"onUpdate:modelValue":o[2]||(o[2]=l=>s(t).transition_target=l),disabled:((te=s(t).standby_mst_)==null?void 0:te.is_transition)==0},[rt,(_(!0),r(N,null,A(s(k)().list_pabrik,l=>(_(),r("option",{value:l},d(l),9,ct))),256))],8,_t),[[oe,s(t).transition_target]]),e("p",ut,d(s(m).transition_target),1)])])]),e("div",pt,[e("div",vt,[ft,S(n,{arr:s(K),selected:s(u),onSetSelected:o[3]||(o[3]=l=>u.value=l)},null,8,["arr","selected"]),e("p",mt,d(s(m).supir_id),1)]),e("div",wt,[xt,S(n,{arr:s(K),selected:s(p),onSetSelected:o[4]||(o[4]=l=>p.value=l)},null,8,["arr","selected"]),e("p",ht,d(s(m).kernet_id),1)]),e("div",bt,[yt,h(e("input",{type:"text",list:"vehicle","onUpdate:modelValue":o[5]||(o[5]=l=>s(t).no_pol=l),disabled:s(t).pvr_no!=""},null,8,gt),[[D,s(t).no_pol]]),e("datalist",kt,[(_(!0),r(N,null,A(s(Y),l=>(_(),r("option",{value:l.no_pol},d(l.no_pol),9,St))),256))]),e("p",Nt,d(s(m).no_pol),1)]),e("div",Ct,[Dt,h(e("input",{type:"text",list:"xto","onUpdate:modelValue":o[6]||(o[6]=l=>s(t).xto=l),disabled:s(t).pvr_no!=""},null,8,Vt),[[D,s(t).xto]]),e("datalist",At,[(_(!0),r(N,null,A(s(H),l=>(_(),r("option",null,d(l),1))),256))]),e("p",Ot,d(s(m).xto),1)]),e("div",Tt,[Ut,h(e("textarea",{"onUpdate:modelValue":o[7]||(o[7]=l=>s(t).note_for_remarks=l),disabled:s(t).pvr_no!=""}," ",8,It),[[D,s(t).note_for_remarks]]),e("p",Jt,d(s(m).note_for_remarks),1)]),e("div",Bt,[Ft,h(e("input",{type:"text","onUpdate:modelValue":o[8]||(o[8]=l=>s(t).ref=l),disabled:s(t).pvr_no!=""},null,8,Mt),[[D,s(t).ref]]),e("p",Pt,d(s(m).ref),1)])]),e("div",$t,[e("div",jt,[qt,e("div",Rt,[zt,h(e("input",{list:"cost_center","onUpdate:modelValue":o[9]||(o[9]=l=>s(t).cost_center_code=l),disabled:s(t).pvr_no!=""},null,8,Lt),[[D,s(t).cost_center_code]]),e("datalist",Et,[(_(!0),r(N,null,A(b.list_cost_center,l=>(_(),r("option",{value:l.CostCenter},d(l.CostCenter+"-"+l.Description),9,Kt))),256))]),e("p",Ht,d(s(m).cost_center_code),1)]),e("div",Yt,[Gt,e("div",Wt,d(s(t).cost_center_desc),1)])])]),e("div",Xt,[e("div",Qt,[Zt,e("div",es,[ts,e("div",ss,d(s(t).pvr_no),1)]),e("div",os,[ls,e("div",as,d(s(J)(s(t).pvr_total||0)),1)])])]),e("div",ns,[e("div",is,[ds,e("div",_s,[rs,e("div",cs,d(s(t).pv_no),1)]),e("div",us,[ps,e("div",vs,d(s(J)(s(t).pv_total)),1)])])]),e("div",fs,[e("div",ms,[e("table",ws,[e("thead",null,[e("tr",xs,[e("td",{colspan:s(V)?3:4,class:"!bg-slate-800 text-white font-bold"}," Detail Transaction ",8,hs)]),e("tr",bs,[s(V)?I("",!0):(_(),r("th",ys)),gs,ks,Ss])]),e("tbody",Ns,[(_(!0),r(N,null,A(s(c),(l,F)=>(_(),r(N,{key:F},[l.p_status!="Remove"?(_(),r("tr",{key:0,"data-index":F},[s(V)?I("",!0):(_(),r("td",Ds,[e("div",Vs,[e("button",{type:"button",name:"button",onClick:U=>de(U,F)},[S(C)],8,As)])])),e("td",null,d(F+1)+".",1),e("td",Os,[e("div",Ts,[S(j,null,{default:ke(()=>[S(g,{modelValue:l.tanggal,"onUpdate:modelValue":U=>l.tanggal=U,type:"datetime",format:"dd-MM-yyyy","enable-time-picker":!1,"text-input":"","teleport-center":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)])]),e("td",Us,[e("div",Is,[h(e("textarea",{disabled:s(V),class:"p-1 w-full","onUpdate:modelValue":U=>l.note=U,cols:"7",rows:"2"},null,8,Js),[[D,l.note]])])])],8,Cs)):I("",!0)],64))),128)),s(V)?I("",!0):(_(),r("tr",Bs,[e("td",Fs,[e("button",{type:"button",name:"button",onClick:o[10]||(o[10]=l=>_e())},[S(y)])])]))],512)])])])])]),e("div",Ms,[e("button",{type:"button",name:"button",class:"w-36 m-1",onClick:o[11]||(o[11]=l=>b.fnClose())}," Cancel "),s(V)?I("",!0):(_(),r("button",{key:0,type:"submit",name:"button",class:"w-36 m-1 bg-blue-600 text-white rounded-sm",onClick:o[12]||(o[12]=Se(l=>ae(),["prevent"]))}," Save "))])])])],512),[[ge,b.show]]),S(q,{show:s(B),coor:s(W),fn:re,data:s(c),data_index:s(x),onReplyAct:o[13]||(o[13]=l=>ce(l))},null,8,["show","coor","data","data_index"])],64)}}},Xs=Ae(Ps,[["__scopeId","data-v-99ca7770"]]);export{Xs as default};
